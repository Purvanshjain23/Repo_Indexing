<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OMEIPVR - Section 8: Business Functions</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({ startOnLoad: true, theme: 'default' });</script>
        <style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.6;
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    background-color: #f8f9fa;
}

.header {
    background: linear-gradient(135deg, #0066cc, #007bff);
    color: white;
    padding: 2rem;
    margin: -20px -20px 30px -20px;
    border-radius: 0 0 15px 15px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

.header h1 { margin: 0; font-size: 2.5em; font-weight: 300; }
.header .subtitle { font-size: 1.2em; opacity: 0.9; margin-top: 10px; }

.meta-info {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-top: 20px;
}

.meta-item {
    background: rgba(255,255,255,0.2);
    padding: 10px 15px;
    border-radius: 8px;
}

.meta-item strong {
    display: block;
    font-size: 0.9em;
    opacity: 0.8;
}

.alert-banner {
    background: linear-gradient(45deg, #ffc107, #f39c12);
    color: #000;
    padding: 15px;
    margin: 20px 0;
    border-radius: 8px;
    text-align: center;
    font-weight: bold;
    box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
}

.executive-summary {
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    margin: 30px 0;
}

.summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin: 20px 0;
}

.summary-card {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    border-left: 5px solid #0066cc;
}

.summary-card h3 { color: #2c3e50; margin-top: 0; }

.kpi-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 15px;
    margin: 20px 0;
}

.kpi-item {
    text-align: center;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 8px;
}

.kpi-value {
    font-size: 2em;
    font-weight: bold;
    color: #0066cc;
}

.kpi-label {
    font-size: 0.9em;
    color: #666;
    margin-top: 5px;
}

.toc {
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    margin: 30px 0;
}

.toc ul { list-style: none; padding: 0; }
.toc li { padding: 8px 0; border-bottom: 1px solid #ecf0f1; }
.toc a { color: #0066cc; text-decoration: none; font-weight: 500; }
.toc a:hover { color: #007bff; }

.section {
    background: white;
    margin: 30px 0;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.section h2 {
    color: #2c3e50;
    border-bottom: 3px solid #0066cc;
    padding-bottom: 10px;
    margin-bottom: 25px;
}

.section h3 { color: #34495e; margin-top: 25px; }

.function-analysis {
    background: #f8f9fa;
    border: 2px solid #ffc107;
    border-radius: 8px;
    padding: 20px;
    margin: 30px 0;
}

.function-header {
    background: #0066cc;
    color: white;
    padding: 20px;
    margin: -20px -20px 20px -20px;
    border-radius: 8px 8px 0 0;
}

.function-header h3 { margin: 0; color: white; }

table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    background: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 3px 10px rgba(0,0,0,0.1);
}

th, td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid #e9ecef;
}

th {
    background: #0066cc;
    color: white;
    font-weight: 600;
}

tr:hover { background-color: #f8f9fa; }

.nav-link {
    display: inline-block;
    background: #0066cc;
    color: white;
    padding: 12px 24px;
    border-radius: 8px;
    text-decoration: none;
    margin: 10px 5px;
    font-weight: 500;
    transition: all 0.3s;
}

.nav-link:hover {
    background: #007bff;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,102,204,0.3);
}

.highlight {
    background: #fff3cd;
    padding: 15px;
    border-radius: 8px;
    border-left: 5px solid #ffc107;
    margin: 15px 0;
}

.priority-critical { color: #e74c3c; font-weight: bold; }
.priority-high { color: #f39c12; font-weight: bold; }
.priority-medium { color: #3498db; }
.priority-low { color: #95a5a6; }

@media (max-width: 768px) {
    .summary-grid, .meta-info, .kpi-grid { grid-template-columns: 1fr; }
    .header h1 { font-size: 2em; }
    body { padding: 10px; }
}
    </style>
</head>
<body>

<div class="header">
    <h1>OMEIPVR - Section 8</h1>
    <div class="subtitle">Detailed Business Functions Analysis</div>
    <div class="meta-info">
        <div class="meta-item"><strong>Total Functions</strong>24</div>
        <div class="meta-item"><strong>Documentation</strong>Complete Analysis</div>
        <div class="meta-item"><strong>Generated</strong>October 14, 2025</div>
    </div>
</div>

<div style="text-align: center; margin: 30px 0;">
    <a href="OMEIPVR_Sections_1-7.html" class="nav-link">← Back to Sections 1-7</a>
</div>

<div class="section">
    <h2>8. Detailed Business Functions Analysis</h2>

    <div class="highlight" style="background: #d4edda; border-left: 5px solid #28a745;">
        <strong>COMPLETE:</strong> All 24 functions documented with real source code analysis (lines 291-1478). No AI placeholders remaining.
    </div>
</div>


<div class="function-analysis" id="func-1">
    <div class="function-header">
        <h3>F001: CAEXFM - User Interface Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Display screen and process HELP requests in a loop (lines 291-338)</p>
    <ul>
        <li><strong>W0HLP</strong> (1 char) - Help request flag, controls DO-UNTIL loop</li>
        <li><strong>YPMT04, HELP25</strong> - Saved states of indicators 04 (Prompt) and 25 (Help)</li>
        <li><strong>YSETCS</strong> - Set cursor flag, <strong>WCSRLC</strong> - Cursor location control</li>
        <li><strong>##TME</strong> - Screen display time, <strong>##JTM</strong> - Job time for audit trail</li>
        <li><strong>*IN array</strong> - RPG indicator array for screen conditioning</li>
        <li><strong>##OFF</strong> - All zeros string for clearing indicators</li>
        <li><strong>@#RWCL</strong> - Cursor row/column position from display file feedback area</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Set display attributes → Display screen → Test cursor → Process prompts/help → Clear messages → Loop until W0HLP='N'</li>
        <li><strong>Key Decisions:</strong> W0HLP loop control, YSETCS for cursor positioning, *IN25 for help display, WCSRLC for cursor location</li>
        <li><strong>Error Handling:</strong> Preserves/restores indicators 04 and 25, clears program message queue via Y2CLMSC after each display cycle</li>
        <li><strong>Subroutines Called:</strong> GADSA1, Y0SET, Y8TST, ZDVPMT, ZHHPKY, Y9CLR</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>CAEXFM orchestrates the interactive screen display. Calls GADSA1 to set display attributes based on multi-company flag. Updates ##TME with current time. Enters DO-UNTIL loop while W0HLP='Y' (help mode). Saves indicators 04/25 to YPMT04/HELP25, clears entire *IN array with ##OFF, then restores key indicators. If YSETCS='Y', calls Y0SET for cursor positioning. Writes message control format (#MSGCTL) and command text (#CMDTXT1), then executes EXFMT #RCDDTL1 to display screen and wait for input. Calls Y8TST to test cursor position and determine field name. Calls ZDVPMT to process F4 prompt requests. If WCSRLC='OFF', clears indicator 94. If *IN25 ON (help key pressed), calls ZHHPKY to display context-sensitive help. Updates ##JTM with job time. Calls Y2CLMSC to clear messages from program message queue. Resets ZAFSMS flag to 'Y'. If YSETCS='Y', calls Y9CLR to clear cursor data. Loop continues until W0HLP='N'.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([CAEXFM Entry]) --> GADSA1[GADSA1: Set<br/>Display Attributes]
    GADSA1 --> GetTime[TIME → ##TME]
    GetTime --> Loop{W0HLP<br/>= 'Y'?}
    Loop -->|Continue| SaveInd[Save Indicators<br/>YPMT04/HELP25]
    SaveInd --> ClearInd[Clear *IN Array]
    ClearInd --> RestoreInd[Restore *IN04/*IN25]
    RestoreInd --> CursorCheck{YSETCS<br/>= 'Y'?}
    CursorCheck -->|Yes| Y0SET[Y0SET]
    CursorCheck -->|No| WriteScreen
    Y0SET --> WriteScreen[WRITE #MSGCTL<br/>WRITE #CMDTXT1]
    WriteScreen --> EXFMT[EXFMT #RCDDTL1<br/>Display Screen]
    EXFMT --> Y8TST[Y8TST: Test Cursor]
    Y8TST --> ZDVPMT[ZDVPMT: Process Prompt]
    ZDVPMT --> CheckCsrlc{WCSRLC<br/>= 'OFF'?}
    CheckCsrlc -->|Yes| ClearInd94[SETOF Indicator 94]
    CheckCsrlc -->|No| CheckHelp
    ClearInd94 --> CheckHelp{*IN25<br/>ON?}
    CheckHelp -->|Yes| ZHHPKY[ZHHPKY: Display Help]
    CheckHelp -->|No| UpdateTime
    ZHHPKY --> UpdateTime[TIME → ##JTM]
    UpdateTime --> ClearMsgs[Y2CLMSC: Clear<br/>Message Queue]
    ClearMsgs --> ResetFlag[ZAFSMS = 'Y']
    ResetFlag --> CursorClear{YSETCS<br/>= 'Y'?}
    CursorClear -->|Yes| Y9CLR[Y9CLR]
    CursorClear -->|No| Loop
    Y9CLR --> Loop
    Loop -->|Exit| End([CAEXFM End])
    style Start fill:#d4edda,stroke:#28a745
    style End fill:#d1ecf1,stroke:#17a2b8
    style Loop fill:#ffc107,stroke:#f39c12
    style EXFMT fill:#0066cc,stroke:#004499,color:#fff
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>Screen I/O:</strong> WRITE #MSGCTL, WRITE #CMDTXT1, EXFMT #RCDDTL1 (display file OMEIPVR#CF)</li>
        <li><strong>External Call:</strong> Y2CLMSC (parameters: ##PGM, '*SAME') to clear program message queue</li>
        <li><strong>Subroutine Calls:</strong> GADSA1 (attributes), Y0SET (cursor), Y8TST (cursor test), ZDVPMT (prompts), ZHHPKY (help), Y9CLR (clear cursor)</li>
        <li><strong>Data Transformations:</strong> Indicator manipulation via ##OFF array, time updates (##TME, ##JTM), cursor location management (WCSRLC, indicator 94)</li>
        <li><strong>No Database Operations</strong> - Screen handling only</li>
    </ul>
</div>

<div class="function-analysis" id="func-2">
    <div class="function-header">
        <h3>F002: DAPRSC - Business Logic Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Process validated screen input and submit print job (lines 340-420)</p>
    <ul>
        <li><strong>Input:</strong> Screen fields (#PAJCD, #1AIC3, #PDNCD, #PB8NA, #PAJVN, #PI6ST, #PMPNA, #PG3TX, #PWRST, #PWSST, #PWTST, #PDYNB, #PWUST, #PBVVN, #DATNB, #DBDDT, #DBEDT, #PM8NB, #1ADTX)</li>
        <li><strong>Processing:</strong> W0DCF (Defer confirm flag), W0TRN (Transaction flag), *IN99 (Error indicator), *IN90 (Call error), WUH3TX (Return code from PDOWUPR)</li>
        <li><strong>Output:</strong> P1PARM, P2PARM, P3PARM parameter structures (19 total fields mapped to 13 PDOWUPR parameters)</li>
        <li><strong>External Call:</strong> PDOWUPR with 13 parameters for print job submission</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Call DBVLSC to validate → Exit if errors → Map screen fields to parameter structures → Call PDOWUPR to submit print job → Handle submission result</li>
        <li><strong>Key Decisions:</strong> *IN99='1' (validation errors), W0DCF='Y' (deferred confirmation), *IN90='1' (call errors), WUH3TX=*BLANK (success)</li>
        <li><strong>Error Handling:</strong> Sends Y2U0032 if PDOWUPR fails, displays USR1832 info message on successful submission</li>
        <li><strong>Integration:</strong> Maps screen data to PDOWUPR parameters including Application='SHP', Program='OMH6PCLP', Description='Print Loads Shipped'</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>DAPRSC processes validated screen input. Sets W0DCF='N' (not deferred), calls DBVLSC to validate inputs. If *IN99='1' (error) or W0DCF='Y' (deferred), exits immediately. Maps screen fields to three parameter structures: P1PARM (warehouse, company, application, date format, user, multi-company flag, printer), P2PARM (print description, printer device, output settings, copy count, night queue settings), P3PARM (company name). Sets company #DATNB→P2AJAA, from date #DBDDT→P2AJAD, through date #DBEDT→P2AJAG. Calls PDOWUPR with 13 parameters (return code WUH3TX, application 'SHP', program name from @CN,001='OMH6PCLP', description from @CN,002='Print Loads Shipped', printer settings, company, date range, system values). If *IN90='1' (call failed), sets W0RTN='Y2U0032', builds error message with program name 'PDOWUPR' in W0CLPG, sends message via ZASNMS, sets *IN99. If WUH3TX=*BLANK (success), sends USR1832 '*INFO' message 'Print has been Submitted' via ZASNMS. Sets W0DCF='Y' (defer), W0TRN='N' (request new transaction).</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([DAPRSC Entry]) --> SetDefer[W0DCF = 'N']
    SetDefer --> Validate[DBVLSC: Validate<br/>Screen Input]
    Validate --> CheckErr{*IN99<br/>= '1'?}
    CheckErr -->|Yes| Exit([Exit])
    CheckErr -->|No| CheckDefer{W0DCF<br/>= 'Y'?}
    CheckDefer -->|Yes| Exit
    CheckDefer -->|No| MapP1[Map to P1PARM<br/>7 fields]
    MapP1 --> MapP2[Map to P2PARM<br/>11 fields + Dates]
    MapP2 --> MapP3[Map to P3PARM<br/>1 field]
    MapP3 --> CallPrint[CALL PDOWUPR<br/>13 Parameters]
    CallPrint --> CallErr{*IN90<br/>= '1'?}
    CallErr -->|Yes| BuildErr[Build Error Message<br/>Y2U0032 + 'PDOWUPR']
    BuildErr --> SendErr[ZASNMS: Send Error]
    SendErr --> SetErr[Set *IN99]
    SetErr --> Exit
    CallErr -->|No| CheckRtn{WUH3TX<br/>= *BLANK?}
    CheckRtn -->|Yes| SendSuccess[ZASNMS: Send USR1832<br/>'Print Submitted']
    CheckRtn -->|No| SetFlags
    SendSuccess --> SetFlags[W0DCF='Y'<br/>W0TRN='N']
    SetFlags --> Exit
    style Start fill:#d4edda,stroke:#28a745
    style Exit fill:#d1ecf1,stroke:#17a2b8
    style CallPrint fill:#e74c3c,stroke:#c0392b,color:#fff
    style SendSuccess fill:#d4edda,stroke:#28a745
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>Parameter Mapping:</strong> P1PARM (7 fields), P2PARM (11 fields including dates), P3PARM (company name)</li>
        <li><strong>External Call PDOWUPR:</strong> 13 parameters - WUH3TX (return code), 'SHP' (application), @CN,001 (program 'OMH6PCLP'), @CN,002 (description 'Print Loads Shipped'), printer device, hold/save output status, copy count, night queue settings, company number, from/through dates, system value</li>
        <li><strong>Subroutine Call:</strong> DBVLSC for comprehensive validation, ZASNMS for message sending (2 calls)</li>
        <li><strong>Messages:</strong> Y2U0032 (call error with program name), USR1832 (print submitted success)</li>
        <li><strong>No Database Operations</strong> - Parameter passing and print queue submission only</li>
    </ul>
</div>

<div class="function-analysis" id="func-3">
    <div class="function-header">
        <h3>F003: DBVLSC - Business Logic Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Comprehensive validation of screen input fields (lines 422-594)</p>
    <ul>
        <li><strong>Input:</strong> VDBDDT (External from date), VDBEDT (External through date), #DATNB (Company), YPMTFD (Prompt field name), W0CFL (Cursor field), *IN04 (Prompt key), P1I6ST (Multi-company flag)</li>
        <li><strong>Processing:</strong> XDEXDT/XDINDT (Date conversion data structures), W0RTN (Return code), #1AIC3 (Company for validation), ZA0001 (Formatted company), YL0001 (Plant company status)</li>
        <li><strong>Output:</strong> #DBDDT (Internal from date), #DBEDT (Internal through date), #1ADTX (Company name), Error indicators 99/9931/9932/9933</li>
        <li><strong>Subroutines Called:</strong> XDCK2 (date validation - 2 calls), PPF2SRR (company selection), SARVGN (company name), SBRVGN (plant status), VACKRL (record selection), VBCKRL (country check), ZASNMS (messages - 7 calls)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Validate from/through dates → Handle F4 prompting → Validate company existence and plant status → Check date range logic → Verify required fields</li>
        <li><strong>Key Decisions:</strong> Date format validation, F4 key with cursor on #DATNB and P1I6ST='Y' (multi-company), company found/not found, plant company check (YL0001='P'), from date > through date</li>
        <li><strong>Error Handling:</strong> Indicators 9931 (from date), 9932 (through date), 9933 (company), 99 (general error); Messages USR2410 (prompt not allowed), USR1783 (invalid company), USR0163 (not found), USR0319 (date range), Y2U0001 (required field)</li>
        <li><strong>Complex Logic:</strong> Multi-layered validation with early exits on errors (GOTO DBEXIT if *IN99='1')</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>DBVLSC performs extensive validation (172 lines). Validates from date: VDBDDT→XDEXDT, calls XDCK2, if W0RTN≠*BLANK sets *IN9931/*IN99. Stores validated XDINDT→#DBDDT. Validates through date: VDBEDT→XDEXDT, calls XDCK2, if error sets *IN9932/*IN99, stores XDINDT→#DBEDT. If YPMTFD≠*BLANK (not prompting), handles F4 logic: if *IN04='1' AND W0CFL='#DATNB' AND P1I6ST='Y', calls PPF2SRR for company selection, checks *IN90 for call errors, sets *IN9933 on error, else sends USR2410 'Prompt Not Allowed'. Sets W0DCF='Y' (defer). If *IN99='1', GOTOs DBEXIT (bypass file checks). Calls VACKRL for record selection, VBCKRL for country validation. If YPMTFD=*BLANK, initializes #1ADTX=*BLANK. If #DATNB≠*ZERO, calls SARVGN (company name retrieval with WL0001=#DATNB→WL0002=#1ADTX). If W0RTN=*BLANK (found), calls SBRVGN (plant status with #DATNB→WAAIC3→WAYISX→YL0001). If YL0001≠'P', formats company number (3-digit to external ZA0001 using #L3 edit array), sends USR1783 'Invalid Company Number', sets *IN99. If company not found (W0RTN≠*BLANK), sends USR0163 'Company Number not found', sets *IN99. Validates date range: if #DBDDT>#DBEDT, sends USR0319 'From date exceeds to date', sets *IN9931. Checks required fields: if #DBDDT=*ZERO or #DBEDT=*ZERO (when not prompting), sets field indicators 9931/9932, sends Y2U0001 '*Value required'.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([DBVLSC Entry]) --> VFrom[Validate From Date<br/>XDCK2]
    VFrom --> FromErr{W0RTN<br/>≠ *BLANK?}
    FromErr -->|Yes| SetFrom[Set *IN9931, *IN99]
    FromErr -->|No| StoreFrom
    SetFrom --> StoreFrom[XDINDT → #DBDDT]
    StoreFrom --> VThru[Validate Through Date<br/>XDCK2]
    VThru --> ThruErr{W0RTN<br/>≠ *BLANK?}
    ThruErr -->|Yes| SetThru[Set *IN9932, *IN99]
    ThruErr -->|No| StoreThru
    SetThru --> StoreThru[XDINDT → #DBEDT]
    StoreThru --> Prompting{YPMTFD<br/>= *BLANK?}
    Prompting -->|No| CheckF4{*IN04='1'<br/>& Cursor=#DATNB?}
    CheckF4 -->|Yes| MultiCo{P1I6ST<br/>= 'Y'?}
    MultiCo -->|Yes| CallSelect[CALL PPF2SRR<br/>Company Selection]
    CallSelect --> SelectErr{*IN90<br/>='1'?}
    SelectErr -->|Yes| SendCallErr[Y2U0032 Error<br/>Set *IN9933]
    MultiCo -->|No| SendPromptErr[USR2410<br/>Prompt Not Allowed<br/>Set *IN99]
    CheckF4 -->|No| BypassCheck
    Prompting -->|Yes| BypassCheck{*IN99<br/>= '1'?}
    BypassCheck -->|Yes| Exit([DBEXIT])
    BypassCheck -->|No| CallVACKRL[VACKRL: Select Record]
    CallVACKRL --> CallVBCKRL[VBCKRL: Check Country]
    CallVBCKRL --> ValidateCo{#DATNB<br/>≠ 0?}
    ValidateCo -->|Yes| GetName[SARVGN: Get Company<br/>Name → #1ADTX]
    GetName --> NameFound{W0RTN<br/>= *BLANK?}
    NameFound -->|Yes| GetStatus[SBRVGN: Get<br/>Plant Status → YL0001]
    GetStatus --> IsPlant{YL0001<br/>= 'P'?}
    IsPlant -->|No| FormatCo[Format Company #<br/>to ZA0001]
    FormatCo --> SendInvalid[USR1783<br/>Invalid Company<br/>Set *IN99]
    NameFound -->|No| SendNotFound[USR0163<br/>Company Not Found<br/>Set *IN99]
    IsPlant -->|Yes| CheckRange{#DBDDT<br/>GT #DBEDT?}
    ValidateCo -->|No| CheckRange
    CheckRange -->|Yes| SendRange[USR0319<br/>From Exceeds To<br/>Set *IN9931]
    CheckRange -->|No| CheckReqFrom{#DBDDT<br/>= 0?}
    CheckReqFrom -->|Yes| SendReqFrom[Y2U0001<br/>Value Required<br/>Set *IN9931]
    CheckReqFrom -->|No| CheckReqThru{#DBEDT<br/>= 0?}
    CheckReqThru -->|Yes| SendReqThru[Y2U0001<br/>Value Required<br/>Set *IN9932]
    CheckReqThru -->|No| Exit
    SendPromptErr --> Exit
    SelectErr --> Exit
    SendCallErr --> Exit
    SendInvalid --> Exit
    SendNotFound --> Exit
    SendRange --> Exit
    SendReqFrom --> Exit
    SendReqThru --> Exit
    style Start fill:#d4edda,stroke:#28a745
    style Exit fill:#d1ecf1,stroke:#17a2b8
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>Date Validation:</strong> VDBDDT/VDBEDT → XDCK2 (validates format, month 1-12, day ranges, leap years) → #DBDDT/#DBEDT</li>
        <li><strong>Company Validation:</strong> SARVGN (CHAIN CAABREL3IF key ABAIC3) retrieves name, SBRVGN (CHAIN PDJYREL2IF key WAAIC3) retrieves WAYISX plant status</li>
        <li><strong>External Calls:</strong> PPF2SRR (company selection if multi-company allowed)</li>
        <li><strong>Reference Validation:</strong> VACKRL (calls PDL7SRR), VBCKRL (calls PDEGSRR, checks OME5REL2IF)</li>
        <li><strong>Data Formatting:</strong> Company number conversion via #L3 edit array to ZA0001 for error messages</li>
        <li><strong>Messages:</strong> Y2U0032 (call error), USR2410 (prompt not allowed), USR1783 (invalid company), USR0163 (company not found), USR0319 (date range error), Y2U0001 (required field)</li>
        <li><strong>Indicators:</strong> 99 (general error), 9931 (from date), 9932 (through date), 9933 (company error)</li>
    </ul>
</div>

<div class="function-analysis" id="func-4">
    <div class="function-header">
        <h3>F004: GADSA1 - Business Logic Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Set display attributes based on multi-company access flag (lines 596-605)</p>
    <ul>
        <li><strong>Input:</strong> P1I6ST (Allow Multi-Company flag 'Y' or 'N')</li>
        <li><strong>Output:</strong> *IN79 (Display attribute indicator for company field)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Initialize *IN79='0', if P1I6ST='N' (multi-company NOT allowed) set *IN79='1'</li>
        <li><strong>Key Decision:</strong> P1I6ST value determines company field display attribute (protected/highlighted)</li>
        <li><strong>Simple Logic:</strong> 2-line function controlling visual cue for multi-company access</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>GADSA1 is a simple display attribute controller (9 lines). Sets *IN79='0' as default. If P1I6ST='N' (multi-company access denied), sets *IN79='1' to change company field display attribute (typically protects or highlights the field on screen to indicate it's read-only for single-company users). This visual indicator informs users whether they can access and modify company numbers.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([GADSA1 Entry]) --> Init[*IN79 = '0']
    Init --> Check{P1I6ST<br/>= 'N'?}
    Check -->|Yes: Single Company| Set[*IN79 = '1']
    Check -->|No: Multi Company| End([GADSA1 End])
    Set --> End
    style Start fill:#d4edda,stroke:#28a745
    style End fill:#d1ecf1,stroke:#17a2b8
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>No Database Operations</strong></li>
        <li><strong>Indicator Control:</strong> *IN79 controls screen field display attributes via DDS conditioning</li>
        <li><strong>Input:</strong> P1I6ST from user profile (retrieved during ZZINIT via SCRVGN)</li>
        <li><strong>Business Rule:</strong> Multi-company access controls visual appearance of company field</li>
    </ul>
</div>

<div class="function-analysis" id="func-5">
    <div class="function-header">
        <h3>F005: MALDSC - Business Logic Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Load screen fields from passed parameter structures (lines 607-654)</p>
    <ul>
        <li><strong>Input:</strong> P1PARM (7 fields), P2PARM (11 fields), P3PARM (1 field) - all parameter data structures</li>
        <li><strong>Processing:</strong> YL0002 (First Time Flag), WL0001/WL0002 (company retrieval locals), #DATNB (Company Number)</li>
        <li><strong>Output:</strong> Screen fields (#PAJCD through #1ADTX) - 27 screen display fields loaded from parameters</li>
        <li><strong>Subroutine Called:</strong> SARVGN (retrieve company name if company number exists)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> MOVEL 17 parameter fields → Initialize screen fields (dates, company) → If first time, load company → If company exists, retrieve name</li>
        <li><strong>Key Decisions:</strong> YL0002='Y' (first time flag), #DATNB≠*ZERO (company number entered)</li>
        <li><strong>Screen Loading:</strong> Maps 17 P1/P2 fields via MOVEL, 4 fields via Z-ADD, clears dates/country, initializes 5 screen fields to blank/zero</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>MALDSC loads screen from parameters (47 lines). Moves P1PARM fields: P1AJCD→#PAJCD (warehouse), P1DNCD→#PDNCD (application), P1B8NA→#PB8NA (date format), P1AJVN→#PAJVN (user), P1I6ST→#PI6ST (multi-company), P1MPNA→#PMPNA (printer). Moves P2PARM fields: P2G3TX→#PG3TX (description), P2WRST→#PWRST (device), P2WSST→#PWSST (hold status), P2WTST→#PWTST (save status), P2DYNB→#PDYNB (copies), P2WUST→#PWUST (night queue), P2BVVN→#PBVVN (queue name), P2AJAA→#PAJAA (company), P2AJAD→#PAJAD (from date), P2AJAG→#PAJAG (through date), P2M8NB→#PM8NB (system value). Moves P3 fields: P1AIC3→#1AIC3, P3ADTX→#1ADTX (name). Clears working fields: #1KXCD=*BLANK, #DBDDT=*ZERO, VDBDDT=*ZERO, #DBEDT=*ZERO, VDBEDT=*ZERO, #DATNB=*ZERO. If YL0002='Y' (first time), copies P1AIC3→#DATNB, sets YL0002='N'. If #DATNB≠*ZERO, retrieves company name: WL0001=#DATNB, calls SARVGN, WL0002→#1ADTX.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([MALDSC Entry]) --> LoadP1[MOVEL P1PARM<br/>7 fields]
    LoadP1 --> LoadP2[MOVEL/Z-ADD P2PARM<br/>11 fields]
    LoadP2 --> LoadP3[MOVEL P3PARM<br/>2 fields]
    LoadP3 --> ClearFields[Clear Fields<br/>Country/Dates/Company]
    ClearFields --> FirstTime{YL0002<br/>= 'Y'?}
    FirstTime -->|Yes| SetCompany[P1AIC3 → #DATNB<br/>YL0002 = 'N']
    FirstTime -->|No| CheckCompany
    SetCompany --> CheckCompany{#DATNB<br/>≠ *ZERO?}
    CheckCompany -->|Yes| GetName[WL0001 = #DATNB<br/>SARVGN]
    GetName --> StoreName[WL0002 → #1ADTX]
    StoreName --> End([MAEXIT])
    CheckCompany -->|No| End
    style Start fill:#d4edda,stroke:#28a745
    style End fill:#d1ecf1,stroke:#17a2b8
    style LoadP1 fill:#0066cc,stroke:#004499,color:#fff
    style LoadP2 fill:#0066cc,stroke:#004499,color:#fff
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>Parameter Mapping:</strong> 17 P1PARM fields (7), P2PARM (10), P3PARM (1) → 27 screen fields via MOVEL/Z-ADD</li>
        <li><strong>Subroutine Call:</strong> SARVGN (company name retrieval) when #DATNB≠*ZERO</li>
        <li><strong>Data Initialization:</strong> Clears 6 working fields (#1KXCD, #DBDDT, VDBDDT, #DBEDT, VDBEDT, #DATNB) to *BLANK/*ZERO</li>
        <li><strong>Flag Management:</strong> YL0002 first-time flag controls company loading logic</li>
        <li><strong>No Database Operations</strong> - Parameter to screen field mapping only (SARVGN handles database access)</li>
    </ul>
</div>

<div class="function-analysis" id="func-6">
    <div class="function-header">
        <h3>F006: SARVGN - Data Retrieval Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Retrieve Company Name from Company Name and Address file (lines 673-700)</p>
    <ul>
        <li><strong>Input:</strong> WL0001 (Company Number) - local subroutine parameter</li>
        <li><strong>Processing:</strong> W0RTN (Return code), ABAIC3 (Key field), KRSSA (Key list), *IN90 (Record not found indicator)</li>
        <li><strong>Output:</strong> WL0002 (Name - 30 char) from ABADTX, W0RTN='USR0003' if not found, W0RTN=*BLANK if found</li>
        <li><strong>Database File:</strong> CAABREL3IF (@ABREG3) - Company Name and Address file</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Clear return code → Define key (ABAIC3) → CHAIN @ABREG3 → If not found, set error code and clear name → If found, retrieve name</li>
        <li><strong>Key Decisions:</strong> *IN90='1' (not found) or *IN90='0' (found)</li>
        <li><strong>Error Handling:</strong> W0RTN='USR0003', WL0002=*BLANK, GOTO SAEXIT on not found</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>SARVGN retrieves company name (27 lines). Clears W0RTN=*BLANK. Defines key list KRSSA with field ABAIC3 (Company Number). Sets key: WL0001→ABAIC3. Executes CHAIN to @ABREG3 (CAABREL3IF) with indicator 90. If *IN90='1' (not found), sets W0RTN='USR0003', clears WL0002=*BLANK, GOTOs SAEXIT. If *IN90='0' (found), retrieves ABADTX→WL0002 (company name).</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([SARVGN Entry]) --> Clear[W0RTN = *BLANK]
    Clear --> DefKey[KLIST KRSSA<br/>KFLD ABAIC3]
    DefKey --> SetKey[WL0001 → ABAIC3]
    SetKey --> Chain[CHAIN @ABREG3<br/>Indicator 90]
    Chain --> CheckFound{*IN90<br/>= '1'?}
    CheckFound -->|Yes Not Found| SetError[W0RTN = 'USR0003'<br/>WL0002 = *BLANK]
    SetError --> Exit([SAEXIT])
    CheckFound -->|No Found| GetName[ABADTX → WL0002]
    GetName --> Exit
    style Start fill:#d4edda,stroke:#28a745
    style Exit fill:#d1ecf1,stroke:#17a2b8
    style Chain fill:#e74c3c,stroke:#c0392b,color:#fff
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>Database Operation:</strong> CHAIN to CAABREL3IF file (@ABREG3 format) via key ABAIC3 (Company Number)</li>
        <li><strong>Input Field:</strong> WL0001 (Company Number 3.0) → ABAIC3</li>
        <li><strong>Output Field:</strong> ABADTX (Name 30 char) → WL0002</li>
        <li><strong>Return Codes:</strong> *BLANK (success), 'USR0003' (record not found)</li>
        <li><strong>File:</strong> CAABREL3IF - Company Name and Address Retrieval index NV</li>
    </ul>
</div>

<div class="function-analysis" id="func-7">
    <div class="function-header">
        <h3>F007: SBRVGN - Data Retrieval Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Retrieve Plant Company Status from Company Defaults Internal file (lines 702-729)</p>
    <ul>
        <li><strong>Input:</strong> #DATNB (Company Number from screen)</li>
        <li><strong>Processing:</strong> W0RTN (Return code), WAAIC3 (Key field), KRSSB (Key list), *IN90 (Not found indicator)</li>
        <li><strong>Output:</strong> YL0001 (Plant Company Status - 1 char) from WAYISX, W0RTN='USR2025' if not found</li>
        <li><strong>Database File:</strong> PDJYREL2IF (@JYRECE) - Company Defaults Internal Active Records</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Clear return code → Define key (WAAIC3) → CHAIN @JYRECE → If not found, set error and clear status → If found, retrieve plant company status</li>
        <li><strong>Key Decisions:</strong> *IN90='1' (not found) or *IN90='0' (found)</li>
        <li><strong>Error Handling:</strong> W0RTN='USR2025', YL0001=*BLANK, GOTO SBEXIT on not found</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>SBRVGN retrieves plant company status (27 lines). Clears W0RTN=*BLANK. Defines key list KRSSB with field WAAIC3 (Company Number). Sets key: #DATNB→WAAIC3. Executes CHAIN to @JYRECE (PDJYREL2IF) with indicator 90. If *IN90='1' (not found), sets W0RTN='USR2025', clears YL0001=*BLANK, GOTOs SBEXIT. If *IN90='0' (found), retrieves WAYISX→YL0001 (plant company status indicator).</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([SBRVGN Entry]) --> Clear[W0RTN = *BLANK]
    Clear --> DefKey[KLIST KRSSB<br/>KFLD WAAIC3]
    DefKey --> SetKey[#DATNB → WAAIC3]
    SetKey --> Chain[CHAIN @JYRECE<br/>Indicator 90]
    Chain --> CheckFound{*IN90<br/>= '1'?}
    CheckFound -->|Yes Not Found| SetError[W0RTN = 'USR2025'<br/>YL0001 = *BLANK]
    SetError --> Exit([SBEXIT])
    CheckFound -->|No Found| GetStatus[WAYISX → YL0001<br/>Plant Company Status]
    GetStatus --> Exit
    style Start fill:#d4edda,stroke:#28a745
    style Exit fill:#d1ecf1,stroke:#17a2b8
    style Chain fill:#e74c3c,stroke:#c0392b,color:#fff
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>Database Operation:</strong> CHAIN to PDJYREL2IF file (@JYRECE format) via key WAAIC3 (Company Number)</li>
        <li><strong>Input Field:</strong> #DATNB (Company Number 3.0) → WAAIC3</li>
        <li><strong>Output Field:</strong> WAYISX (Plant Company Status 'P'=Plant) → YL0001</li>
        <li><strong>Return Codes:</strong> *BLANK (success), 'USR2025' (record not found)</li>
        <li><strong>File:</strong> PDJYREL2IF - Company Defaults Internal Active Records</li>
    </ul>
</div>

<div class="function-analysis" id="func-8">
    <div class="function-header">
        <h3>F008: SCRVGN - Data Retrieval Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The SCRVGN function retrieves user profile information from the User Profile Control file (CADRREL1IF).</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>WN0001 - User Profile Name (10 chars)</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> User profile retrieval for security and default settings</li>
        <li><strong>Output Results:</strong>
            <ul>
                <li>P1I6ST - Allow Multi-Company flag</li>
                <li>P1MPNA - Default Printer name</li>
                <li>WUBCCD - Salesperson Code</li>
                <li>YL0003 - Company Number</li>
                <li>WN0002 - User Code Model</li>
                <li>W0RTN - Return code ('USR0763' if not found, 'Y2U0005' on error)</li>
            </ul>
        </li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Retrieve user profile control data from CADRREL1IF using CHAIN operation</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>Check if user profile record exists (*IN90)</li>
                <li>If found, move user profile settings to output parameters</li>
                <li>If not found, set error return code 'USR0763' or 'Y2U0005'</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> Returns error code if record not found, exits subroutine with GOTO SCEXIT</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>RTV Program Setup w/Co RT - User Profile Control:</strong> This function retrieves program setup information with company context from the User Profile Control file. It uses KRSSC keylist with user profile name to chain to @DRRETH record format. If the user profile record is found, it extracts multi-company settings, default printer, salesperson code, company number, and user code model. If the record is not found, it returns error code 'USR0763' or constant 'Y2U0005'. This is essential for establishing user security context and default operational parameters.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([SCRVGN Start - Line 731]) --> ClearReturn[Clear W0RTN Return Code]
    ClearReturn --> DefineKey[Define KRSSC Keylist with WBAJVN]
    DefineKey --> SetupKey[Setup Key: WBAJVN = WN0001 User Profile Name]
    SetupKey --> ChainFile[CHAIN @DRRETH File with KRSSC Key]
    ChainFile --> CheckFound{Record Found?<br/>*IN90 = 1?}

    CheckFound -->|Yes - Not Found| SetError[Set W0RTN = 'USR0763'<br/>or 'Y2U0005']
    SetError --> ExitNotFound[GOTO SCEXIT]

    CheckFound -->|No - Found| MoveData[Move DB1 Fields to Parameters:<br/>P1I6ST = WBI6ST Allow Multi-Company<br/>P1MPNA = WBMPNA Default Printer<br/>WUBCCD = WBBCCD Salesperson Code<br/>YL0003 = WBAIC3 Company Number<br/>WN0002 = WBBUVN User Code Model]
    MoveData --> EndSub([SCEXIT End])
    ExitNotFound --> EndSub

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckFound fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style ChainFile fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
    style SetError fill:#f8d7da,stroke:#dc3545,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>Database Operations:</strong></p>
    <ul>
        <li><strong>File Access:</strong> CADRREL1IF (User Profile Control - Retrieval index NV)</li>
        <li><strong>Record Format:</strong> @DRRETH</li>
        <li><strong>Access Method:</strong> CHAIN (Direct random access by key)</li>
        <li><strong>Key Fields:</strong> WBAJVN (User Profile Name)</li>
        <li><strong>Fields Retrieved:</strong> WBI6ST, WBI7ST, WBXMST, WBXNST, WBI8ST, WBNLNB, WBMPNA, WBBCCD, WBAIC3, WBDQCD, WBDRCD, WBAJCD, WBBUVN, WBUVST, WBUWST, WBUXST, WBAATM, WBAYNA, WBA0NA, WBAXDT</li>
        <li><strong>Error Indicator:</strong> *IN90 (Set to 1 if record not found)</li>
    </ul>
</div>

<div class="function-analysis" id="func-9">
    <div class="function-header">
        <h3>F009: SDRVGN - Data Retrieval Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The SDRVGN function retrieves application profile information from the User Application Profile file (CADTREL1IF).</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>WL0003 - User Profile Name (10 chars)</li>
                <li>WL0004 - Application Code (6 chars)</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> Application profile retrieval for user-specific application settings</li>
        <li><strong>Output Results:</strong>
            <ul>
                <li>WL0005 - Company Number (3,0 packed)</li>
                <li>WL0006 - Warehouse Code (3 chars)</li>
                <li>W0RTN - Return code ('USR0767' if not found)</li>
            </ul>
        </li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Retrieve application profile data from CADTREL1IF using CHAIN operation</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>Check if application profile record exists (*IN90)</li>
                <li>If found, extract company number and warehouse code</li>
                <li>If not found, set error return code 'USR0767'</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> Returns error code 'USR0767' if record not found</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>RTV Appl. Profile RT - Application Profile:</strong> This function retrieves application profile information from the User Application Profile file. It uses KRSSD keylist with user profile name and application code to chain to @DTRETE record format. If the application profile is found, it extracts the company number and warehouse code associated with this user's application profile. If not found, it returns error code 'USR0767'. This function is essential for determining user-specific application context including which company and warehouse the user operates in for a specific application.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([SDRVGN Start - Line 763]) --> ClearReturn[Clear W0RTN Return Code]
    ClearReturn --> DefineKey[Define KRSSD Keylist:<br/>WCAJVN User Profile Name<br/>WCDNCD Application Code]
    DefineKey --> SetupKey[Setup Keys:<br/>WCAJVN = WL0003<br/>WCDNCD = WL0004]
    SetupKey --> ChainFile[CHAIN @DTRETE File with KRSSD Key]
    ChainFile --> CheckFound{Record Found?<br/>*IN90 = 0?}

    CheckFound -->|No - Not Found| SetError[Set W0RTN = 'USR0767']
    SetError --> EndSub([SDEXIT End])

    CheckFound -->|Yes - Found| MoveData[Move DB1 Fields to Parameters:<br/>WL0005 = WCAIC3 Company Number<br/>WL0006 = WCAJCD Warehouse Code]
    MoveData --> EndSub

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckFound fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style ChainFile fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
    style SetError fill:#f8d7da,stroke:#dc3545,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>Database Operations:</strong></p>
    <ul>
        <li><strong>File Access:</strong> CADTREL1IF (User Application Profile - Retrieval index NV)</li>
        <li><strong>Record Format:</strong> @DTRETE</li>
        <li><strong>Access Method:</strong> CHAIN (Direct random access by composite key)</li>
        <li><strong>Key Fields:</strong> WCAJVN (User Profile Name) + WCDNCD (Application Code)</li>
        <li><strong>Fields Retrieved:</strong> WCAIC3 (Company Number), WCAJCD (Warehouse Code), WCDQCD, WCDRCD, WCJFST, WCUVST, WCUWST, WCUXST, WCAATM, WCAYNA, WCA0NA, WCAXDT</li>
        <li><strong>Error Indicator:</strong> *IN90 (Set to 1 if record not found)</li>
    </ul>
</div>

<div class="function-analysis" id="func-10">
    <div class="function-header">
        <h3>F010: SERVGN - Data Retrieval Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The SERVGN function retrieves application group description from the Application file (CADNREL2IF).</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>Implicit: Application Code 'OMS' (hardcoded)</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> Application description retrieval for 'OMS' application group</li>
        <li><strong>Output Results:</strong>
            <ul>
                <li>WUAUNA - Application Description (30 chars)</li>
                <li>W0RTN - Return code ('USR0755' if not found)</li>
            </ul>
        </li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Retrieve application group description from CADNREL2IF using SETLL/READE operations</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>Check if application record with blank Application Group exists</li>
                <li>If found, extract description directly</li>
                <li>If not blank group, call SFRVGN to retrieve description</li>
                <li>Loop through all matching records with READE</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> Returns error code 'USR0755' if no records found</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>RTV Applic. Group Desc RT - Application:</strong> This function retrieves the application group description from the Application file. It uses KRSSE keylist with application code 'OMS' to set lower limit in @DNRESF record format, then reads all matching records with READE. For each record found, if the Application Group (WDRSCD) is blank, it directly moves the description (WDAUNA) to output. Otherwise, it calls SFRVGN subroutine to retrieve the application description. This function continues looping until all records are processed. If no records are found, it returns error code 'USR0755'.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([SERVGN Start - Line 788]) --> ClearReturn[Clear W0RTN Return Code]
    ClearReturn --> DefineKey[Define KRSSE Keylist with WQSE01]
    DefineKey --> SetupKey[Setup Key: WQSE01 = 'OMS']
    SetupKey --> SetLL[SETLL @DNRESF File]
    SetLL --> ReadFirst[READE @DNRESF First Record]
    ReadFirst --> CheckFirst{First Record<br/>Found?<br/>*IN90 = 0?}

    CheckFirst -->|No - Not Found| SetError[Set W0RTN = 'USR0755']
    SetError --> EndSub([SEEXIT End])

    CheckFirst -->|Yes - Found| LoopStart{*IN90 = 0?}
    LoopStart -->|No - End of Records| EndSub

    LoopStart -->|Yes - Process Record| CheckGroup{DB1.Application Group<br/>WDRSCD = Blank?}
    CheckGroup -->|Yes| MoveDesc[WUAUNA = WDAUNA Description]
    CheckGroup -->|No| CallSFRVGN[Call SFRVGN Subroutine<br/>to retrieve description]

    MoveDesc --> ReadNext[READE @DNRESF Next Record]
    CallSFRVGN --> ReadNext
    ReadNext --> LoopStart

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckFirst fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style LoopStart fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
    style CheckGroup fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style SetError fill:#f8d7da,stroke:#dc3545,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>Database Operations:</strong></p>
    <ul>
        <li><strong>File Access:</strong> CADNREL2IF (Application - RSQ Application Code)</li>
        <li><strong>Record Format:</strong> @DNRESF</li>
        <li><strong>Access Method:</strong> SETLL (Set Lower Limit) followed by READE (Read Equal Key)</li>
        <li><strong>Key Fields:</strong> WQSE01 (Application Code = 'OMS')</li>
        <li><strong>Fields Retrieved:</strong> WDDNCD (Application Code), WDAUNA (Description), WDVKST, WDRSCD (Application Group), WDUVST, WDUWST, WDUXST, WDAATM, WDAYNA, WDA0NA, WDAXDT</li>
        <li><strong>Error Indicator:</strong> *IN90 (Set to 1 if no more records or EOF)</li>
        <li><strong>Processing Pattern:</strong> Sequential read of all records matching 'OMS' application code</li>
    </ul>
</div>

<div class="function-analysis" id="func-11">
    <div class="function-header">
        <h3>F011: SFRVGN - Data Retrieval Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The SFRVGN function retrieves application description from the Application file (CADNREL2IF) based on application group.</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>WDRSCD - Application Group Code (from calling function)</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> Application description retrieval for specific application group</li>
        <li><strong>Output Results:</strong>
            <ul>
                <li>WUAUNA - Application Description (30 chars)</li>
                <li>W0RTN - Return code ('USR0755' or 'Y2U0005' if not found)</li>
            </ul>
        </li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Retrieve application description from CADNREL2IF using SETLL/READE operations by application group</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>Check if first record found after SETLL</li>
                <li>If not found, set error return code and exit</li>
                <li>Loop through all matching records extracting description</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> Returns error code 'USR0755' or 'Y2U0005' if no records found, uses GOTO SFEXIT for early exit</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>RTV Application Desc RT - Application:</strong> This function retrieves the application description from the Application file based on the Application Group code. It uses KRSSF keylist with WDRSCD (passed from SERVGN) to set lower limit in @DNRESF record format, then reads all matching records with READE. If the first record is not found, it returns error code 'USR0755' or constant 'Y2U0005' and exits early with GOTO SFEXIT. For each record found in the loop, it extracts the description (WDAUNA) and moves it to output parameter WUAUNA. This function continues looping until all records with matching application group are processed.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([SFRVGN Start - Line 822]) --> ClearReturn[Clear W0RTN Return Code]
    ClearReturn --> DefineKey[Define KRSSF Keylist with WQSF01]
    DefineKey --> SetupKey[Setup Key: WQSF01 = WDRSCD<br/>Application Group]
    SetupKey --> SetLL[SETLL @DNRESF File]
    SetLL --> ReadFirst[READE @DNRESF First Record]
    ReadFirst --> CheckFirst{First Record<br/>Found?<br/>*IN90 = 1?}

    CheckFirst -->|Yes - Not Found| SetError[Set W0RTN = 'USR0755'<br/>Clear WUAUNA<br/>Set W0RTN = 'Y2U0005']
    SetError --> ExitEarly[GOTO SFEXIT]

    CheckFirst -->|No - Found| LoopStart{*IN90 = 0?}
    LoopStart -->|No - End of Records| EndSub([SFEXIT End])

    LoopStart -->|Yes - Process Record| MoveDesc[WUAUNA = WDAUNA Description]
    MoveDesc --> ReadNext[READE @DNRESF Next Record]
    ReadNext --> LoopStart
    ExitEarly --> EndSub

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckFirst fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style LoopStart fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
    style SetError fill:#f8d7da,stroke:#dc3545,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>Database Operations:</strong></p>
    <ul>
        <li><strong>File Access:</strong> CADNREL2IF (Application - RSQ Application Code)</li>
        <li><strong>Record Format:</strong> @DNRESF</li>
        <li><strong>Access Method:</strong> SETLL (Set Lower Limit) followed by READE (Read Equal Key)</li>
        <li><strong>Key Fields:</strong> WQSF01 (Application Group from WDRSCD)</li>
        <li><strong>Fields Retrieved:</strong> WDDNCD (Application Code), WDAUNA (Description), WDVKST, WDRSCD (Application Group), WDUVST, WDUWST, WDUXST, WDAATM, WDAYNA, WDA0NA, WDAXDT</li>
        <li><strong>Error Indicator:</strong> *IN90 (Set to 1 if no more records or EOF)</li>
        <li><strong>Processing Pattern:</strong> Sequential read of all records matching application group code</li>
    </ul>
</div>

<div class="function-analysis" id="func-12">
    <div class="function-header">
        <h3>F012: VACKRL - Business Logic Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The VACKRL function handles company selection via prompt when required.</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>YPMTFD - Prompt field indicator (set to '#1AIC3' if prompting company)</li>
                <li>#1AIC3 - Company Number for prompt/validation</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> Company selection and validation through user prompt</li>
        <li><strong>Output Results:</strong>
            <ul>
                <li>#1AIC3 - Selected company number (updated by PDL7SRR)</li>
                <li>W0RTN - Return code ('Y2U0032' if call error, 'Y2U0016' if user cancelled)</li>
                <li>W0DCF - Defer confirm flag (set to 'Y')</li>
                <li>YPMTFD - Set to '*DONE' when processing complete</li>
            </ul>
        </li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Check if company name search required, call PDL7SRR for company selection, handle errors and user cancellation</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>Check if YPMTFD equals '#1AIC3' (company prompt required)</li>
                <li>Call PDL7SRR (SEL Co - Rtn 0 or less) for company selection</li>
                <li>Check *IN90 for call errors</li>
                <li>Validate W0RTN return code (ignore 'Y2U0016' user cancel)</li>
                <li>Check if #1AIC3 is not zero and YPMTFD not blank to set completion</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> Sends error message 'Y2U0032' if call fails, handles user cancellation 'Y2U0016', sets indicator 99 on error</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>Select Existing Record - Company Selection:</strong> This function performs company selection through a user prompt interface. When YPMTFD equals '#1AIC3', it calls external program PDL7SRR with company number parameter. If the call fails (*IN90='1'), it sends error message 'Y2U0032' via ZASNMS. If the return code is not blank and not 'Y2U0016' (user cancel), indicator 99 is set. When #1AIC3 is not zero, YPMTFD is not blank, and W0RTN is blank, YPMTFD is set to '*DONE'. The defer confirm flag (W0DCF) is always set to 'Y' to defer the confirmation process.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([VACKRL Start - Line 856]) --> CheckPrompt{YPMTFD = '#1AIC3'?<br/>Name Search Required?}
    CheckPrompt -->|No| SetDefer[Set W0DCF = 'Y' Defer Confirm]
    CheckPrompt -->|Yes| CallPDL7SRR[CALL 'PDL7SRR'<br/>SEL Co - Rtn 0 or less<br/>Pass #1AIC3 Company Number]

    CallPDL7SRR --> CheckCallError{*IN90 = 1?<br/>Call Failed?}
    CheckCallError -->|Yes| SetCallError[Set W0RTN = 'Y2U0032'<br/>Set W0CLPG = 'PDL7SRR']
    SetCallError --> SendError[Send Error Message<br/>via ZASNMS]

    CheckCallError -->|No| CheckReturn{W0RTN Not Blank?<br/>AND W0RTN <> 'Y2U0016'?}
    CheckReturn -->|Yes| SetIndicator[Set Indicator 99]
    CheckReturn -->|No| CheckComplete{#1AIC3 <> Zero?<br/>AND YPMTFD Not Blank?<br/>AND W0RTN = Blank?}

    CheckComplete -->|Yes| SetDone[Set YPMTFD = '*DONE']
    CheckComplete -->|No| SetDefer2[Set W0DCF = 'Y']

    SendError --> SetDefer
    SetIndicator --> SetDefer
    SetDone --> SetDefer
    SetDefer2 --> SetDefer
    SetDefer --> EndSub([VAEXIT End])

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckPrompt fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style CheckCallError fill:#f8d7da,stroke:#dc3545,stroke-width:2px
    style CallPDL7SRR fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>External Program Calls:</strong></p>
    <ul>
        <li><strong>Called Program:</strong> PDL7SRR (SEL Co - Rtn 0 or less)</li>
        <li><strong>Parameters:</strong>
            <ul>
                <li>W0RTN - Return code (7 chars, output)</li>
                <li>WQ0015 - Company Number (3,0 packed, input/output from #1AIC3)</li>
            </ul>
        </li>
        <li><strong>Error Handling:</strong> *IN90 indicator for call failure</li>
        <li><strong>Message Operations:</strong> Calls ZASNMS subroutine to send error messages using 'Y2U0032' message ID from 'Y2USRMSG' message file</li>
        <li><strong>Processing Flags:</strong> W0DCF (Defer confirm), YPMTFD (Prompt field status)</li>
    </ul>
</div>

<div class="function-analysis" id="func-13">
    <div class="function-header">
        <h3>F013: VBCKRL - Business Logic Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The VBCKRL function validates country code references through prompt or database validation.</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>#1KXCD - Country Code (1 char)</li>
                <li>YPMTFD - Prompt field indicator</li>
                <li>WK1X01 - Work field copy of country code</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> Country code validation and selection via PDEGSRR or database chain</li>
        <li><strong>Output Results:</strong>
            <ul>
                <li>#1KXCD - Validated/selected country code</li>
                <li>W0RTN - Return code ('Y2U0032' if call error, 'USR1158' if not found)</li>
                <li>W0DCF - Defer confirm flag (set to 'Y')</li>
                <li>YPMTFD - Set to '*DONE' when processing complete</li>
            </ul>
        </li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Check if country search required (? or prompt), call PDEGSRR for selection, validate country exists in OME5REL2IF file</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>Check if WK1X01='?' or YPMTFD='#1KXCD' (prompt required)</li>
                <li>Call PDEGSRR (SEL Country Act) for country selection</li>
                <li>Handle call errors and user cancellation</li>
                <li>Exit if #1KXCD is blank (not required)</li>
                <li>CHAIN to @E5REVS to validate country exists</li>
                <li>Send 'USR1158' message if country not found</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> Sends error message 'Y2U0032' if call fails, 'USR1158' if country not found, handles user cancellation 'Y2U0016'</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>Check Reference to Country:</strong> This function validates country code through prompt or database lookup. First, it copies #1KXCD to WK1X01. If WK1X01 equals '?' or YPMTFD equals '#1KXCD', it calls PDEGSRR (SEL Country Act) with country code parameter. Call errors trigger 'Y2U0032' message via ZASNMS. Return codes are validated (ignoring 'Y2U0016' user cancel). If #1KXCD is not blank, YPMTFD not blank, W0RTN blank, and WK1X01 not '?', YPMTFD is set to '*DONE'. W0DCF is set to 'Y'. If #1KXCD is blank, function exits early. Otherwise, it builds KLVBE5 keylist with E5KXCD and chains to @E5REVS. If record found (*IN90='0'), function exits. For prompt mode, indicators are cleared and function exits. If not found, sends message 'USR1158' (Country NF) and sets W0RTN.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([VBCKRL Start - Line 897]) --> ClearReturn[Clear W0RTN]
    ClearReturn --> CopyCode[WK1X01 = #1KXCD]
    CopyCode --> CheckPrompt{WK1X01 = '?'<br/>OR YPMTFD = '#1KXCD'?}
    CheckPrompt -->|Yes| CallPDEGSRR[CALL 'PDEGSRR'<br/>SEL Country Act<br/>Pass #1KXCD]
    CallPDEGSRR --> CheckCallError{*IN90 = 1?}
    CheckCallError -->|Yes| SendCallError[Send Error 'Y2U0032']
    CheckCallError -->|No| CheckReturn{W0RTN Not Blank<br/>AND <> 'Y2U0016'?}
    CheckReturn -->|Yes| SetError[Set Indicator 99]
    CheckReturn -->|No| CheckComplete{#1KXCD Not Blank<br/>AND YPMTFD Not Blank<br/>AND W0RTN Blank<br/>AND WK1X01 <> '?'}
    CheckComplete -->|Yes| SetDone[YPMTFD = '*DONE']
    SendCallError --> SetDefer[W0DCF = 'Y']
    SetError --> SetDefer
    SetDone --> SetDefer
    CheckComplete -->|No| SetDefer
    CheckPrompt -->|No| SetDefer
    SetDefer --> CheckBlank{#1KXCD = Blank?}
    CheckBlank -->|Yes| ExitEarly[GOTO VBEXIT]
    CheckBlank -->|No| BuildKey[Build KLVBE5 Keylist<br/>E5KXCD = #1KXCD]
    BuildKey --> ChainFile[CHAIN @E5REVS]
    ChainFile --> CheckFound{*IN90 = 0?<br/>Record Found?}
    CheckFound -->|Yes| ExitEarly
    CheckFound -->|No| CheckPromptMode{YPMTFD Not Blank?}
    CheckPromptMode -->|Yes| ClearInd[Clear Indicators 90,91]
    ClearInd --> ExitEarly
    CheckPromptMode -->|No| SendNotFound[Send Message 'USR1158'<br/>Country NF<br/>Set W0RTN = 'USR1158']
    SendNotFound --> EndSub([VBEXIT End])
    ExitEarly --> EndSub

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckPrompt fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style CallPDEGSRR fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
    style ChainFile fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>External Program Calls & Database Operations:</strong></p>
    <ul>
        <li><strong>Called Program:</strong> PDEGSRR (SEL Country Act)</li>
        <li><strong>Parameters:</strong> W0RTN (Return code), WQ0016 (Country Code from #1KXCD)</li>
        <li><strong>File Access:</strong> OME5REL2IF (Country - Active Only)</li>
        <li><strong>Record Format:</strong> @E5REVS</li>
        <li><strong>Access Method:</strong> CHAIN (Direct access by key)</li>
        <li><strong>Key Fields:</strong> E5KXCD (Country Code)</li>
        <li><strong>Message Operations:</strong> Sends 'Y2U0032' or 'USR1158' via ZASNMS</li>
    </ul>
</div>

<div class="function-analysis" id="func-14">
    <div class="function-header">
        <h3>F014: XDCK2 - Date Validation with Leap Year Logic</h3>
        <div style="margin-top: 10px;">
            <span style="background: #e74c3c; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: High
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The XDCK2 function validates external date formats and converts to internal date format.</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>XDEXDT - External date (8,0 numeric)</li>
                <li>XDDTFM - Date format ('DMY', 'MDY', or 'YMD')</li>
                <li>XOFFYY - Cut-off year for century determination (2 digits)</li>
                <li>YPMTFD - Prompt field indicator (bypass validation if not blank)</li>
                <li>@XD - Days in month array (12 elements)</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> Date validation with format conversion, leap year handling, and range checking</li>
        <li><strong>Output Results:</strong>
            <ul>
                <li>XDINDT - Internal date (7,0 YYYYMDD format)</li>
                <li>W0RTN - Return code ('Y2U0006' if invalid date)</li>
                <li>XTTIM - Time portion (cleared if date invalid)</li>
            </ul>
        </li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Validate external date, map to internal format based on date format, check month/day ranges, handle leap year, convert century</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>Exit if XDEXDT is zero (blank date allowed)</li>
                <li>Map external components based on XDDTFM (DMY/MDY/YMD)</li>
                <li>Apply century cut-off logic (if YY < XOFFYY then add 100)</li>
                <li>Bypass validation if YPMTFD not blank (prompt mode)</li>
                <li>Validate month range (1-12)</li>
                <li>Validate day range (1 to max for month)</li>
                <li>Special leap year validation for February (divisible by 4, not 200)</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> Sends 'Y2U0006' (Invalid date) message via ZASNMS, clears time portion if invalid, uses XDCK2M label for error handling</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>Validate External Date Format:</strong> This function performs comprehensive date validation. If XDEXDT is zero, it exits immediately (blank dates allowed). Based on XDDTFM, it maps external date components: DMY maps to DD/MM/YY, MDY to MM/DD/YY, YMD to YY/MM/DD. It applies century logic: if XDINYY < XOFFYY, adds 100 (e.g., year 25 with cutoff 50 becomes 2025). If YPMTFD is not blank (prompt mode), validation is bypassed. Month must be 1-12. Day must be 1 to @XD array value for that month. Special leap year logic: if month is 2 and year is not zero or 200, divides year by 4 and checks remainder. If remainder is zero (leap year), allows up to 29 days, otherwise max 28. If validation fails, sends 'Y2U0006' message, sets W0RTN, clears XTTIM, and exits at XDCK2M label.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([XDCK2 Start - Line 970]) --> ClearReturn[Clear W0RTN<br/>Clear XDINDT]
    ClearReturn --> CheckZero{XDEXDT = Zero?}
    CheckZero -->|Yes| ExitNormal[GOTO XDCK2E Exit]
    CheckZero -->|No| CheckFormat{XDDTFM?}
    CheckFormat -->|DMY| MapDMY[XDINDD = XDEX02<br/>XDINMM = XDEX03<br/>XDINYY = XDEX04]
    CheckFormat -->|MDY| MapMDY[XDINMM = XDEX02<br/>XDINDD = XDEX03<br/>XDINYY = XDEX04]
    CheckFormat -->|YMD| MapYMD[XDINYY = XDEX02<br/>XDINMM = XDEX03<br/>XDINDD = XDEX04]
    MapDMY --> CheckCutoff{XDINYY < XOFFYY?}
    MapMDY --> CheckCutoff
    MapYMD --> CheckCutoff
    CheckCutoff -->|Yes| AddCentury[Add 100 to XDINYY<br/>20XX century]
    CheckCutoff -->|No| CheckPrompt{YPMTFD Not Blank?}
    AddCentury --> CheckPrompt
    CheckPrompt -->|Yes| ExitNormal
    CheckPrompt -->|No| ValidateMonth{XDINMM < 1<br/>OR > 12?}
    ValidateMonth -->|Yes| ErrorMonth[GOTO XDCK2M Error]
    ValidateMonth -->|No| ValidateDay{XDINDD < 1<br/>OR > @XD,XDINMM?}
    ValidateDay -->|Yes| ErrorDay[GOTO XDCK2M Error]
    ValidateDay -->|No| CheckFeb{XDINMM = 2?<br/>February?}
    CheckFeb -->|No| ExitNormal
    CheckFeb -->|Yes| CheckLeapYear{XDINYY <> 0<br/>AND <> 200?}
    CheckLeapYear -->|No| SetNotLeap[XDWK1 = 1 Not Leap]
    CheckLeapYear -->|Yes| CalcLeap[XDINYY DIV 4<br/>Get Remainder XDWK1]
    SetNotLeap --> CheckLeap{XDWK1 <> 0?}
    CalcLeap --> CheckLeap
    CheckLeap -->|Yes - Not Leap| Check28{XDINDD > 28?}
    CheckLeap -->|No - Is Leap| ExitNormal
    Check28 -->|Yes| ErrorDay
    Check28 -->|No| ExitNormal
    ErrorMonth --> SendError[Send Message 'Y2U0006'<br/>Invalid Date<br/>Set W0RTN = 'Y2U0006'<br/>Clear XTTIM]
    ErrorDay --> SendError
    SendError --> EndSub([XDCK2E End])
    ExitNormal --> EndSub

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckFormat fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style ValidateMonth fill:#f8d7da,stroke:#dc3545,stroke-width:2px
    style ValidateDay fill:#f8d7da,stroke:#dc3545,stroke-width:2px
    style CheckLeap fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>Data Structures and Transformations:</strong></p>
    <ul>
        <li><strong>XDEX DS:</strong> External date structure (8 bytes) - XDEXDT with subfields XDEY01, XDEX01-04</li>
        <li><strong>XDINT DS:</strong> Internal date structure (7 bytes) - XDINDT with XDINYY, XDINMM, XDINDD</li>
        <li><strong>XTCK DS:</strong> Time structure (6 bytes) - XTTIM with XTHH, XTNN, XTSS</li>
        <li><strong>XDOFF DS:</strong> Cut-off year structure (4 bytes) - XOFF with XOFFYY</li>
        <li><strong>@XD Array:</strong> Days in month array (12,2,0) - Values: 31,28,31,30,31,30,31,31,30,31,30,31</li>
        <li><strong>Data Areas:</strong> Y2DTFMA (Date format), Y2CTOFF (Cut-off year)</li>
        <li><strong>Message Operations:</strong> Sends 'Y2U0006' via ZASNMS from 'Y2USRMSG' message file</li>
    </ul>
</div>

<div class="function-analysis" id="func-15">
    <div class="function-header">
        <h3>F015: XDVC2T - Date Format Conversion Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The XDVC2T function converts internal date format (YYYYMDD) to external date format based on system date format setting.</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>XDINDT - Internal date (7,0 YYYYMDD format)</li>
                <li>XDINYY - Year component (3 digits)</li>
                <li>XDINMM - Month component (2 digits)</li>
                <li>XDINDD - Day component (2 digits)</li>
                <li>XDDTFM - Date format ('DMY', 'MDY', or 'YMD')</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> Date format conversion from internal to external display format</li>
        <li><strong>Output Results:</strong>
            <ul>
                <li>XDEXDT - External date (8,0 format)</li>
                <li>XDEX01-04 - External date component subfields</li>
            </ul>
        </li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Convert internal YYYYMDD date to external format based on system date format setting</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>Check XDDTFM value (DMY, MDY, or YMD)</li>
                <li>Map date components based on format</li>
                <li>Set century component (XDEX01) to 0</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> No error handling - straightforward conversion</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>Convert Internal to External Date Format:</strong> This function converts internal date format (YYYYMDD) to external display format. It first sets the century component (XDEX01) to 0. Then based on XDDTFM setting, it maps date components: For 'DMY', XDEX02=DD, XDEX03=MM, XDEX04=YY. For 'MDY', XDEX02=MM, XDEX03=DD, XDEX04=YY. For 'YMD' (default), XDEX02=YY, XDEX03=MM, XDEX04=DD. This allows dates to be displayed in the user's preferred format while maintaining internal consistency.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([XDVC2T Start - Line 1038]) --> SetCentury[Set XDEX01 = 0<br/>Century component]
    SetCentury --> CheckFormat{XDDTFM?}
    CheckFormat -->|DMY| MapDMY[XDEX02 = XDINDD Day<br/>XDEX03 = XDINMM Month<br/>XDEX04 = XDINYY Year]
    CheckFormat -->|MDY| MapMDY[XDEX02 = XDINMM Month<br/>XDEX03 = XDINDD Day<br/>XDEX04 = XDINYY Year]
    CheckFormat -->|YMD Default| MapYMD[XDEX02 = XDINYY Year<br/>XDEX03 = XDINMM Month<br/>XDEX04 = XDINDD Day]
    MapDMY --> EndSub([XDVC2E End])
    MapMDY --> EndSub
    MapYMD --> EndSub

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckFormat fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style MapDMY fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
    style MapMDY fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
    style MapYMD fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>Data Structures and Transformations:</strong></p>
    <ul>
        <li><strong>XDEX DS:</strong> External date structure (8 bytes) - XDEXDT with subfields XDEY01, XDEX01-04</li>
        <li><strong>XDINT DS:</strong> Internal date structure (7 bytes) - XDINDT with XDINYY, XDINMM, XDINDD</li>
        <li><strong>Conversion Rules:</strong>
            <ul>
                <li>DMY Format: Day-Month-Year (European/UK format)</li>
                <li>MDY Format: Month-Day-Year (US format)</li>
                <li>YMD Format: Year-Month-Day (ISO/Canadian format)</li>
            </ul>
        </li>
        <li><strong>Data Areas:</strong> Y2DTFMA (Date format setting)</li>
        <li><strong>No Database Operations:</strong> Pure data transformation function</li>
    </ul>
</div>

<div class="function-analysis" id="func-16">
    <div class="function-header">
        <h3>F016: Y0SET - Screen Control Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #95a5a6; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Low
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The Y0SET function is an empty stub subroutine for setting cursor by *SET CURSOR data.</p>
    <ul>
        <li><strong>Input Parameters:</strong> None (YSETCS flag expected to be 'Y' when called)</li>
        <li><strong>Processing Context:</strong> Cursor positioning control (not implemented in this program)</li>
        <li><strong>Output Results:</strong> None (empty subroutine body)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Empty stub - no processing logic</li>
        <li><strong>Key Decision Points:</strong> None</li>
        <li><strong>Exception Management:</strong> None</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>Set Cursor by *SET CURSOR Data:</strong> This is an empty stub subroutine (lines 1063-1068). The subroutine label Y0SET begins at line 1063 with comment "Set cursor by *SET CURSOR data" and immediately exits at Y0EXIT label on line 1068. No logic is implemented between BEGSR and ENDSR. This function is called from CAEXFM when YSETCS='Y', but performs no actual cursor positioning in this program. The cursor positioning may be handled by DDS display file indicators or other mechanisms not visible in this subroutine.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([Y0SET Start - Line 1063]) --> Comment[Set cursor by *SET CURSOR data<br/>Comment only - No implementation]
    Comment --> EndSub([Y0EXIT End - Line 1068])

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style Comment fill:#ffc107,stroke:#f39c12,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>No Data Operations:</strong></p>
    <ul>
        <li><strong>Function Type:</strong> Empty stub subroutine</li>
        <li><strong>Related Flag:</strong> YSETCS - Set cursor flag (checked before calling this function)</li>
        <li><strong>Implementation Status:</strong> Not implemented - cursor positioning may be handled by DDS file indicators</li>
        <li><strong>Note:</strong> This is a placeholder for cursor positioning logic that is not currently implemented in this program</li>
    </ul>
</div>

<div class="function-analysis" id="func-17">
    <div class="function-header">
        <h3>F017: Y8TST - Cursor Position Test Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #95a5a6; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Low
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The Y8TST function tests cursor position and determines which field the cursor is positioned on.</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>@#RWCL - Cursor row and column position (5,0 numeric from INFDS)</li>
                <li>W0BEG - Beginning position array (4 elements, 5,0)</li>
                <li>W0END - Ending position array (4 elements, 5,0)</li>
                <li>W0NAM - Field name array (4 elements, 10 chars)</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> Determine which screen field contains cursor after user interaction</li>
        <li><strong>Output Results:</strong>
            <ul>
                <li>W0CFL - Cursor field name (10 chars)</li>
                <li>W0CRW - Cursor row (5,0)</li>
                <li>W0CCL - Cursor column (5,0)</li>
                <li>ZINPOS - Internal cursor position value (5,0)</li>
            </ul>
        </li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Extract cursor row/column from INFDS, lookup position in field arrays, identify field name</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>Divide @#RWCL by 256 to extract row and column</li>
                <li>Use LOOKUP to find cursor position in W0END array</li>
                <li>Check if position is greater than or equal to W0BEG for found element</li>
                <li>Extract corresponding field name from W0NAM array</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> Clears W0CFL if cursor not within any defined field range</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>Test Cursor Position:</strong> This function determines which field the cursor is on (lines 1070-1085). It retrieves cursor position from @#RWCL (display file information data structure field), divides by 256 to extract row (W0CRW) with remainder as column (W0CCL). It clears W0CFL and sets counter F to 1. Using LOOKUP operation with LE (less than or equal) comparison, it searches W0END array for cursor position with indicator 96. If found (*IN96='1') and ZINPOS is greater than or equal to W0BEG,F (beginning position), it moves W0NAM,F (field name) to W0CFL. This identifies which screen field contains the cursor for subsequent field-specific processing like F4 prompting.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([Y8TST Start - Line 1070]) --> GetCursor[ZINPOS = @#RWCL<br/>Cursor position from INFDS]
    GetCursor --> CalcRow[Divide ZINPOS by 256<br/>W0CRW = Row<br/>W0CCL = Column remainder]
    CalcRow --> ClearField[Clear W0CFL<br/>Set F = 1 counter]
    ClearField --> Lookup[LOOKUP ZINPOS in W0END array<br/>with LE comparison<br/>Set *IN96 if found]
    Lookup --> CheckFound{*IN96 = 1?<br/>AND ZINPOS >= W0BEG,F?}
    CheckFound -->|Yes| SetField[W0CFL = W0NAM,F<br/>Field name identified]
    CheckFound -->|No| EndSub([Y8EXIT End - Line 1085])
    SetField --> EndSub

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckFound fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style Lookup fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>Display File Information and Arrays:</strong></p>
    <ul>
        <li><strong>INFDS Fields:</strong> @#RWCL (Cursor row/column position from display file INFDS)</li>
        <li><strong>Arrays:</strong>
            <ul>
                <li>W0BEG (4,5,0) - Beginning positions: 01060, 01572, 02593, 02600</li>
                <li>W0END (4,5,0) - Ending positions: 01067, 01579, 02595, 02629</li>
                <li>W0NAM (4,10) - Field names: VDBDDT, VDBEDT, #DATNB, #1ADTX</li>
            </ul>
        </li>
        <li><strong>Cursor Position Calculation:</strong> Row = Position DIV 256, Column = Position MOD 256</li>
        <li><strong>Field Identification:</strong> Matches cursor position to field name for prompt processing</li>
    </ul>
</div>

<div class="function-analysis" id="func-18">
    <div class="function-header">
        <h3>F018: Y9CLR - Clear *SET CURSOR Data Stub</h3>
        <div style="margin-top: 10px;">
            <span style="background: #95a5a6; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Low
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The Y9CLR function is an empty stub subroutine for clearing *SET CURSOR data.</p>
    <ul>
        <li><strong>Input Parameters:</strong> None (YSETCS flag may be checked before calling)</li>
        <li><strong>Processing Context:</strong> Cursor data clearing (not implemented in this program)</li>
        <li><strong>Output Results:</strong> None (empty subroutine body)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Empty stub - no processing logic</li>
        <li><strong>Key Decision Points:</strong> None</li>
        <li><strong>Exception Management:</strong> None</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>Clear *SET CURSOR Data:</strong> This is an empty stub subroutine (lines 1087-1092). The subroutine label Y9CLR begins at line 1087 with comment "Clear *SET CURSOR data" and immediately exits at Y9EXIT label on line 1092. No logic is implemented between BEGSR and ENDSR. This function is called from CAEXFM when YSETCS='Y' to clear cursor positioning data, but performs no actual clearing in this program. Like Y0SET, this indicates cursor management may be handled externally or not fully implemented in this particular program.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([Y9CLR Start - Line 1087]) --> Comment[Clear *SET CURSOR data<br/>Comment only - No implementation]
    Comment --> EndSub([Y9EXIT End - Line 1092])

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style Comment fill:#ffc107,stroke:#f39c12,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>No Data Operations:</strong></p>
    <ul>
        <li><strong>Function Type:</strong> Empty stub subroutine</li>
        <li><strong>Related Flag:</strong> YSETCS - Set cursor flag (may be checked before calling)</li>
        <li><strong>Implementation Status:</strong> Not implemented - cursor data clearing not required</li>
        <li><strong>Note:</strong> This is a placeholder for cursor data clearing logic that is not currently implemented</li>
    </ul>
</div>

<div class="function-analysis" id="func-19">
    <div class="function-header">
        <h3>F019: ZASNMS - Send Message to Program Queue</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p>The ZASNMS function sends messages to the program's message queue via Y2SNMGC utility.</p>
    <ul>
        <li><strong>Input Parameters:</strong>
            <ul>
                <li>ZAPGMQ - Program queue name (10 chars, default ##PGM if blank)</li>
                <li>ZAPGRL - Relative queue level (5 chars, default '*SAME')</li>
                <li>ZAMSID - Message ID (7 chars)</li>
                <li>ZAMSGF - Message file name (10 chars, default ZADFMF if blank)</li>
                <li>ZAMSDA - Message data (132 chars)</li>
                <li>ZAMSTP - Message type (7 chars, e.g., '*INFO', '*COMP', '*DIAG')</li>
                <li>ZADFMF - Default message file from data area</li>
            </ul>
        </li>
        <li><strong>Processing Context:</strong> Message queue management for error/info/completion messages</li>
        <li><strong>Output Results:</strong> All parameters cleared after message sent</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Business Workflow:</strong> Set defaults for blank parameters, call Y2SNMGC to send message, clear all message parameters</li>
        <li><strong>Key Decision Points:</strong>
            <ul>
                <li>If ZAPGMQ blank, set to ##PGM (program name)</li>
                <li>If ZAMSGF blank, set to ZADFMF (default message file)</li>
                <li>Call Y2SNMGC with all 6 parameters</li>
                <li>Clear all parameters for default mechanism next time</li>
            </ul>
        </li>
        <li><strong>Exception Management:</strong> No error handling - relies on Y2SNMGC utility</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p><strong>Send Message to Program's Message Queue:</strong> This function sends messages to the program message queue (lines 1094-1120). If ZAPGMQ is blank, it defaults to ##PGM (current program name). If ZAMSGF is blank, it defaults to ZADFMF (default message file from data area). It then calls Y2SNMGC utility with 6 parameters: program queue, relative queue level, message ID, message file, message data, and message type. After sending the message, it clears all 6 parameter fields to blank, resetting for the next message operation. This function is called throughout the program to display error messages (Y2U0032, USR0763, etc.), info messages (USR1832), and completion messages with appropriate message types.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #dee2e6;">
        <pre class="mermaid">
flowchart TD
    Start([ZASNMS Start - Line 1094]) --> CheckQueue{ZAPGMQ<br/>= Blank?}
    CheckQueue -->|Yes| SetQueue[ZAPGMQ = ##PGM<br/>Program name]
    CheckQueue -->|No| CheckMsgFile{ZAMSGF<br/>= Blank?}
    SetQueue --> CheckMsgFile
    CheckMsgFile -->|Yes| SetMsgFile[ZAMSGF = ZADFMF<br/>Default message file]
    CheckMsgFile -->|No| CallUtility[CALL 'Y2SNMGC'<br/>Send message utility]
    SetMsgFile --> CallUtility
    CallUtility --> PassParams[Pass Parameters:<br/>ZAPGMQ Program queue<br/>ZAPGRL Rel queue<br/>ZAMSID Message ID<br/>ZAMSGF Message file<br/>ZAMSDA Message data<br/>ZAMSTP Message type]
    PassParams --> ClearAll[Clear All Parameters:<br/>ZAPGMQ = Blank<br/>ZAPGRL = Blank<br/>ZAMSID = Blank<br/>ZAMSGF = Blank<br/>ZAMSDA = Blank<br/>ZAMSTP = Blank]
    ClearAll --> EndSub([ZAEXIT End - Line 1120])

    style Start fill:#d4edda,stroke:#28a745,stroke-width:2px
    style EndSub fill:#d1ecf1,stroke:#17a2b8,stroke-width:2px
    style CheckQueue fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style CallUtility fill:#e7f3ff,stroke:#0066cc,stroke-width:2px
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <p><strong>External Program Calls and Message Operations:</strong></p>
    <ul>
        <li><strong>Called Program:</strong> Y2SNMGC (Send Message Generic Call utility)</li>
        <li><strong>Parameters:</strong>
            <ul>
                <li>ZAPGMQ (10) - Program queue name</li>
                <li>ZAPGRL (5) - Relative queue level ('*SAME', '*PRV', etc.)</li>
                <li>ZAMSID (7) - Message ID from message file</li>
                <li>ZAMSGF (10) - Message file name</li>
                <li>ZAMSDA (132) - Message substitution data</li>
                <li>ZAMSTP (7) - Message type (*INFO, *COMP, *DIAG, etc.)</li>
            </ul>
        </li>
        <li><strong>Data Areas:</strong> ZADFMF - Default message file name (from data area or IN operation)</li>
        <li><strong>Message Files Used:</strong> Y2USRMSG (standard messages), application-specific message files</li>
        <li><strong>Usage Pattern:</strong> Called after setting ZAMSID, optionally ZAMSDA, ZAMSTP, ZAMSGF parameters</li>
    </ul>
</div>

<div class="function-analysis" id="func-20">
    <div class="function-header">
        <h3>F020: ZDVPMT - Process F4 Prompt Requests</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Process F4 prompt requests by extracting cursor position (lines 1122-1157)</p>
    <ul>
        <li><strong>Input:</strong> *IN04 (Prompt key indicator), @#RWCL (Cursor row/column from feedback area), W0PMT (Prompt allowed flag), YPMTFD (Prompt field name)</li>
        <li><strong>Processing:</strong> ZHCSRW/ZHCSCL (Cursor row/column - 5.0), YAFSCH (40.0), YPMRRN (4.0)</li>
        <li><strong>Output:</strong> YPMTFD (Prompt field name), ZZCSRW/ZZCSCL (Saved cursor position 3.0), ZAFSMS (First message flag), W0HLP (Help flag)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Clear prompt workfields → If *IN04='1', extract cursor position and save coordinates → If W0PMT='N', send error Y2U0101</li>
        <li><strong>Key Decisions:</strong> *IN04='1' (F4 pressed), YPMTFD=*BLANK (not yet processed), W0PMT='N' (prompting not allowed)</li>
        <li><strong>Error Handling:</strong> Sends Y2U0101 'Prompt error' if user-defined prompting not specified, sets W0HLP='Y', YPMTFD='*NONE', ZAFSMS='Y'</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>ZDVPMT processes F4 prompt requests (35 lines). Initializes YPMTFD=*BLANK, YAFSCH=*ZERO, YPMRRN=*ZERO. If *IN04='1' (F4 pressed), extracts cursor position: @#RWCL DIV 256→ZHCSRW (row), remainder→ZHCSCL (column). Saves cursor: ZHCSRW→ZZCSRW (row), ZHCSCL→ZZCSCL (column). If YPMTFD=*BLANK AND W0PMT='N' (prompting disabled), sets YPMTFD='*NONE', W0HLP='Y', ZAFSMS='Y', sends message Y2U0101 with ZAMSGF='Y2USRMSG' via ZASNMS.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([ZDVPMT Entry]) --> Init[YPMTFD=*BLANK<br/>YAFSCH=0, YPMRRN=0]
    Init --> Check{*IN04<br/>= '1'?}
    Check -->|Yes F4 Pressed| Extract[Extract Cursor<br/>@#RWCL ÷ 256]
    Extract --> Save[ZHCSRW→ZZCSRW<br/>ZHCSCL→ZZCSCL]
    Save --> CheckPmt{YPMTFD=*BLANK<br/>& W0PMT='N'?}
    CheckPmt -->|Yes| SendErr[YPMTFD='*NONE'<br/>W0HLP='Y'<br/>Send Y2U0101]
    CheckPmt -->|No| End([ZDEXIT])
    Check -->|No| End
    SendErr --> End
    style Start fill:#d4edda,stroke:#28a745
    style End fill:#d1ecf1,stroke:#17a2b8
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>Cursor Position Extraction:</strong> @#RWCL (from INFDS#) DIV 256 → row, MVR → column</li>
        <li><strong>Saved Cursor Coordinates:</strong> ZZCSRW (row 3.0), ZZCSCL (column 3.0) for redisplay positioning</li>
        <li><strong>Message:</strong> Y2U0101 (*COMP message) if prompting disabled via ZASNMS</li>
        <li><strong>No Database Operations</strong> - Cursor position management only</li>
    </ul>
</div>

<div class="function-analysis" id="func-21">
    <div class="function-header">
        <h3>F021: ZHHPKY - Business Logic Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Display context-sensitive HELP text via help display program (lines 1159-1191)</p>
    <ul>
        <li><strong>Input:</strong> @#RWCL (Cursor position from feedback), *IN94 (Set cursor indicator)</li>
        <li><strong>Processing:</strong> W0HLP (Help flag), ZHCSRW/ZHCSCL (Cursor row/column 5.0), W0HPMB (Help member name), W0RTN (Return code)</li>
        <li><strong>Output:</strong> WCSRLC (Cursor location control), *IN94 (Set cursor indicator), W0HLP='Y'</li>
        <li><strong>External Call:</strong> YDDSHPR (Help display program with 10 parameters)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Signal help request → Extract cursor position → Save coordinates → Call YDDSHPR to display help → Set cursor control indicators</li>
        <li><strong>Key Decisions:</strong> Indicator 94 state (N94 condition) determines cursor location control</li>
        <li><strong>Help Display:</strong> Calls YDDSHPR with help member 'OMEIPVRH', label '*START', options '*NORMAL'</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>ZHHPKY displays help text (32 lines). Sets W0HLP='Y' (signal help). Extracts cursor: @#RWCL DIV 256→ZHCSRW (row), MVR→ZHCSCL (column). Saves: ZHCSRW→ZZCSRW, ZHCSCL→ZZCSCL. Calls YDDSHPR with parameters: W0HPMB='OMEIPVRH' (help member), YYHPFL=*BLANK (file), YYHPLB=*BLANK (library), W0RTN (return code), YYHLVN='*START' (help label), YYUSOP='*NORMAL' (options), YYRW=ZHCSRW (row), YYCL=ZHCSCL (column), YYLGCT=*ZERO (label groups count), YYLGVN=*BLANK (label groups). If N94 (indicator 94 off), sets WCSRLC='OFF' and SETON indicator 94 for cursor positioning.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([ZHHPKY Entry]) --> Signal[W0HLP = 'Y']
    Signal --> Extract[Extract Cursor<br/>@#RWCL ÷ 256]
    Extract --> SaveRow[ZHCSRW → ZZCSRW]
    SaveRow --> SaveCol[ZHCSCL → ZZCSCL]
    SaveCol --> CallHelp[CALL YDDSHPR<br/>'OMEIPVRH']
    CallHelp --> Check{N94?}
    Check -->|Yes| SetCursor[WCSRLC='OFF'<br/>SETON *IN94]
    Check -->|No| End([ZHEXIT])
    SetCursor --> End
    style Start fill:#d4edda,stroke:#28a745
    style End fill:#d1ecf1,stroke:#17a2b8
    style CallHelp fill:#0066cc,stroke:#004499,color:#fff
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>External Call:</strong> YDDSHPR with 10 parameters (help member 'OMEIPVRH', files *BLANK, return code, label '*START', options '*NORMAL', row/column, label groups)</li>
        <li><strong>Cursor Management:</strong> Saves cursor position in ZZCSRW/ZZCSCL for redisplay after help</li>
        <li><strong>Indicator Control:</strong> Sets *IN94 and WCSRLC='OFF' for cursor positioning control</li>
        <li><strong>No Database Operations</strong> - Help display only</li>
    </ul>
</div>

<div class="function-analysis" id="func-22">
    <div class="function-header">
        <h3>F022: ZXEXPG - Program Control Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Cancel and exit program when user presses F3 (lines 1193-1200)</p>
    <ul>
        <li><strong>Input:</strong> None (triggered by F3/Cancel key - indicator 03)</li>
        <li><strong>Processing:</strong> P0RTN (Return code parameter)</li>
        <li><strong>Output:</strong> P0RTN=*BLANK (normal exit)</li>
        <li><strong>Subroutine Called:</strong> ZYEXPG (actual exit processing)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Clear return code P0RTN to *BLANK → Call ZYEXPG for actual program termination</li>
        <li><strong>Simple Wrapper:</strong> 2-line function that sets normal exit status and delegates to ZYEXPG</li>
        <li><strong>Usage:</strong> Called from main logic when indicator 03 (Cancel key) is set</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>ZXEXPG handles cancel and exit request (7 lines). Sets P0RTN=*BLANK (indicates normal/cancelled exit to caller). Calls ZYEXPG subroutine to perform actual program termination sequence. This wrapper provides clean separation between cancel-triggered exit (user F3) vs other exit paths.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([ZXEXPG Entry<br/>F3 Cancel]) --> Clear[P0RTN = *BLANK]
    Clear --> CallExit[EXSR ZYEXPG]
    CallExit --> End([ZXEXIT])
    style Start fill:#d4edda,stroke:#28a745
    style End fill:#d1ecf1,stroke:#17a2b8
    style CallExit fill:#e74c3c,stroke:#c0392b,color:#fff
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>Parameter Management:</strong> Sets P0RTN=*BLANK (return code to caller)</li>
        <li><strong>Subroutine Call:</strong> ZYEXPG for actual termination logic</li>
        <li><strong>No Database Operations</strong></li>
        <li><strong>Exit Path:</strong> Normal cancel exit (vs error exit)</li>
    </ul>
</div>

<div class="function-analysis" id="func-23">
    <div class="function-header">
        <h3>F023: ZYEXPG - Program Control Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #3498db; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Medium
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Exit program directly with resource cleanup (lines 1202-1216)</p>
    <ul>
        <li><strong>Input:</strong> None</li>
        <li><strong>Processing:</strong> Indicator LR (Last Record - program termination indicator)</li>
        <li><strong>Output:</strong> Program terminates and returns control to caller</li>
        <li><strong>External Call:</strong> Y2RCRSC (reclaim resources of called programs)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Call Y2RCRSC to reclaim resources → Set LR indicator ON → Execute RETRN to exit program</li>
        <li><strong>Clean Termination:</strong> Ensures proper cleanup of program resources before exit</li>
        <li><strong>Usage:</strong> Called by ZXEXPG (cancel exit) and other exit paths requiring cleanup</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>ZYEXPG performs direct program exit (14 lines). Calls Y2RCRSC utility program to reclaim resources of all programs called during this execution (frees memory, closes files). Sets indicator LR ON (Last Record indicator - signals to RPG runtime that program is terminating). Executes RETRN statement to return control to calling program or system. This is the standard IBM i RPG program termination sequence ensuring proper cleanup.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([ZYEXPG Entry]) --> Reclaim[CALL Y2RCRSC<br/>Reclaim Resources]
    Reclaim --> SetLR[SETON LR<br/>Last Record]
    SetLR --> Return[RETRN<br/>Exit Program]
    Return --> End([Program<br/>Terminated])
    style Start fill:#d4edda,stroke:#28a745
    style End fill:#f8d7da,stroke:#dc3545
    style Reclaim fill:#e74c3c,stroke:#c0392b,color:#fff
    style Return fill:#e74c3c,stroke:#c0392b,color:#fff
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>External Call:</strong> Y2RCRSC (no parameters) - reclaims resources of all CALLed programs</li>
        <li><strong>Indicator LR:</strong> Sets Last Record indicator to signal program termination to RPG runtime</li>
        <li><strong>RETRN Statement:</strong> Returns control to calling program or menu</li>
        <li><strong>No Database Operations</strong> - Program termination only</li>
        <li><strong>Resource Cleanup:</strong> Ensures proper deallocation before exit</li>
    </ul>
</div>

<div class="function-analysis" id="func-24">
    <div class="function-header">
        <h3>F024: ZZINIT - Initialization Function</h3>
        <div style="margin-top: 10px;">
            <span style="background: #e74c3c; color: white; padding: 5px 12px; border-radius: 4px; font-size: 0.9em;">
                Priority: Critical
            </span>
            <span style="background: #ffc107; color: #000; padding: 5px 12px; border-radius: 4px; font-size: 0.9em; margin-left: 10px;">
                COMPLETE DOCUMENTATION
            </span>
        </div>
    </div>

    <h4>1. Parameters and Business Data Elements</h4>
    <p><strong>Function Purpose:</strong> Comprehensive program initialization - largest function at 260 lines (lines 1218-1478)</p>
    <ul>
        <li><strong>Input:</strong> ##USR (Current user), ##SD7 (System date), System data areas (XDDTFM, XOFF, ##CMP, ZADFMF)</li>
        <li><strong>Processing:</strong> W0ICL (Initial call flag), P1/P2/P3 parameters (27 total), WN0001/WN0002 (User/User code model), WL0003-WL0006 (Subroutine locals), YL0001-YL0004 (Local work fields), PGMDS (Program data structure), WUDSC4/WUDE40/UCT (Text centering arrays)</li>
        <li><strong>Output:</strong> All program variables initialized, user/application profiles loaded, default parameters set, screen ready for display</li>
        <li><strong>External Calls:</strong> Y2RTJCR (job attributes), PNKDXFR (warehouse), Y2QLVNR (file qualification)</li>
        <li><strong>Subroutine Calls:</strong> SCRVGN (user profile), SDRVGN (application profile), SERVGN (application description), MALDSC (load screen)</li>
    </ul>

    <h4>2. Business Logic Summary</h4>
    <ul>
        <li><strong>Primary Workflow:</strong> Set W0ICL flag → Clear all parameters (27 fields) → Retrieve job attributes → Initialize data structures → Read data areas → Validate user access → Retrieve user/application profiles → Get warehouse → Load application description → Center text → Load screen</li>
        <li><strong>Key Decisions:</strong> W0ICL=*BLANK (first call), W0RTN=@CN,003 (profile not found), W0RTN=*BLANK (profile found), YL0003≠*ZERO (company override), YL0004≠*BLANK (warehouse exists), WN0002=*BLANK (use direct user vs model user)</li>
        <li><strong>Security Validation:</strong> Checks user profile (SCRVGN), application profile (SDRVGN), sends USR0810 and exits with @CN,004 if access denied</li>
        <li><strong>Complex Initialization:</strong> 100+ operations including parameter clearing, data area reads, profile retrievals, warehouse lookup, text centering algorithm, screen loading</li>
    </ul>

    <h4>3. Detailed Logic Explanation and Business Process Flow</h4>
    <p>ZZINIT performs extensive initialization (260 lines). Sets W0ICL='Y'/'N' based on initial call. Clears P0RTN, W0RTN, W0RSL, W0RSF, W0RTW, sets W0ENV='400'. Clears all 27 parameter fields (P1PARM: 7 fields, P2PARM: 13 fields, P3PARM: 1 field). Calls Y2RTJCR with PGMDS to retrieve job attributes. Sets ##JDT=##SD7, TIME→##JTM, TIME→##TME. Initializes renamed input format fields (WAAIC3, WAXXTM, WAAATM, WAAXDT, WBNLNB, etc.). Defines work fields (WUH3TX, WUDMCD, WUBCCD, WUAUNA, WUDSC4, WUDE40). Sets YSETCS='N', WCSRLC=*BLANK. Initializes cursor workfields (W0CFL, W0CRW, W0CCL). Copies file info to JOB context (ZZFFL, ZZFLB, ZZFMB). Calls Y2QLVNR to qualify file name. Reads data areas: XDDTFM (date format), XOFF (cutoff year), ##CMP (company). Sets W0PMT='Y'. Defines local variables for SARVGN/SDRVGN (WL0001-WL0006, YL0001-YL0004). Sets WN0001=##USR (user). Calls SCRVGN to retrieve user profile; if W0RTN=@CN,003, sends USR0810 'Application access denied' to '*PRV' queue, sets P0RTN=@CN,004, calls ZYEXPG (exits). If WN0002=*BLANK (no model user), calls SDRVGN with WN0001+'OMS'→WL0003/WL0004, retrieves WL0005→P1AIC3 (company), WL0006→YL0004 (warehouse), else calls SDRVGN with WN0002+'OMS'. Copies YL0004→P1AJCD (warehouse). If W0RTN≠*BLANK, sends USR0810, exits. If YL0003≠*ZERO, overrides P1AIC3=YL0003 (company from user profile control). If YL0004≠*BLANK, calls PNKDXFR with P1AJCD/*BLANK, YL0003 to get production warehouse. Calls SERVGN to retrieve application description into WUAUNA. Copies to WUDSC4. Centers text: loads WUDSC4→UCT array, counts non-blank characters (UXH), calculates center position (40-UXH)/2, moves centered text to UCT, loads UCT→WUDE40. Copies WUDE40→##CMP (company header). Initializes P2WRST=*BLANK, P2WUST='N', P2AJAA=P1AIC3. Sets YL0002='Y' (first time flag). Calls MALDSC to load screen with defaults.</p>

    <h4>Business Process Flow Diagram (Mermaid):</h4>
    <div style="background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border: 1px solid #e9ecef;">
        <pre class="mermaid">
flowchart TD
    Start([ZZINIT Entry]) --> SetFlag[W0ICL='Y'/'N']
    SetFlag --> ClearParams[Clear 27 Parameters<br/>P1/P2/P3]
    ClearParams --> GetJob[Y2RTJCR:<br/>Job Attributes]
    GetJob --> InitVars[Initialize Variables<br/>Dates/Times/WorkFields]
    InitVars --> ReadDataAreas[IN: XDDTFM, XOFF<br/>##CMP, ZADFMF]
    ReadDataAreas --> GetUser[WN0001 = ##USR<br/>SCRVGN]
    GetUser --> UserFound{W0RTN<br/>= @CN,003?}
    UserFound -->|Yes: Not Found| DenyAccess[Send USR0810<br/>Access Denied]
    DenyAccess --> ExitError[P0RTN=@CN,004<br/>ZYEXPG Exit]
    UserFound -->|No: Found| CheckModel{WN0002<br/>= *BLANK?}
    CheckModel -->|Yes| GetAppDirect[SDRVGN<br/>WN0001 + 'OMS']
    CheckModel -->|No| GetAppModel[SDRVGN<br/>WN0002 + 'OMS']
    GetAppDirect --> CheckAppRtn
    GetAppModel --> CheckAppRtn{W0RTN<br/>≠ *BLANK?}
    CheckAppRtn -->|Yes| DenyApp[Send USR0810<br/>ZYEXPG Exit]
    CheckAppRtn -->|No| OverrideCo{YL0003<br/>≠ 0?}
    OverrideCo -->|Yes| SetCo[P1AIC3 = YL0003]
    OverrideCo -->|No| CheckWarehouse
    SetCo --> CheckWarehouse{YL0004<br/>≠ *BLANK?}
    CheckWarehouse -->|Yes| GetWhs[PNKDXFR:<br/>Get Warehouse]
    CheckWarehouse -->|No| GetAppDesc
    GetWhs --> GetAppDesc[SERVGN:<br/>App Description]
    GetAppDesc --> CenterText[Center Text<br/>UCT Array Logic]
    CenterText --> SetHeader[WUDE40 → ##CMP]
    SetHeader --> InitPrint[P2WRST=*BLANK<br/>P2WUST='N']
    InitPrint --> SetFirst[YL0002='Y']
    SetFirst --> LoadScreen[MALDSC:<br/>Load Screen]
    LoadScreen --> End([ZZEXIT])
    style Start fill:#d4edda,stroke:#28a745
    style End fill:#d1ecf1,stroke:#17a2b8
    style ExitError fill:#f8d7da,stroke:#dc3545
    style DenyAccess fill:#fff3cd,stroke:#ffc107
    style DenyApp fill:#fff3cd,stroke:#ffc107
        </pre>
    </div>

    <h4>4. Data Interaction and Business Information Management</h4>
    <ul>
        <li><strong>External Calls:</strong> Y2RTJCR (retrieve job attributes into PGMDS), PNKDXFR (warehouse retrieval with 3 params), Y2QLVNR (file qualification with 3 params)</li>
        <li><strong>Subroutine Calls:</strong> SCRVGN (user profile from CADRREL1IF), SDRVGN (application profile from CADTREL1IF - called twice depending on user code model), SERVGN (application description from CADNREL2IF), MALDSC (load screen)</li>
        <li><strong>Data Area Reads:</strong> IN operations on XDDTFM (date format), XOFF (cutoff year), ##CMP (company), ZADFMF (message file)</li>
        <li><strong>Security Checks:</strong> Validates user profile exists, application profile exists, sends USR0810 and exits with @CN,004 if access denied</li>
        <li><strong>Data Transformation:</strong> Text centering algorithm using UCT array (40-char), calculates center position, shifts text</li>
        <li><strong>Initialization Scope:</strong> 100+ field initializations, 5 database file accesses, 3 external calls, 4 subroutine calls, 4 data area reads</li>
    </ul>
</div>

<div class="section">
    <h2>Complete Function Catalog</h2>
    <p>All functions in this program (generic categorization - AI validation recommended):</p>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Function</th>
                <th>Category</th>
                <th>Priority</th>
                <th>Line</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>F001</td>
                <td><a href="#func-1">CAEXFM</a></td>
                <td>User Interface</td>
                <td class="priority-medium">Medium</td>
                <td>Line 291</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F002</td>
                <td><a href="#func-2">DAPRSC</a></td>
                <td>Business Logic</td>
                <td class="priority-medium">Medium</td>
                <td>Line 340</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F003</td>
                <td><a href="#func-3">DBVLSC</a></td>
                <td>Business Logic</td>
                <td class="priority-medium">Medium</td>
                <td>Line 422</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F004</td>
                <td><a href="#func-4">GADSA1</a></td>
                <td>Business Logic</td>
                <td class="priority-medium">Medium</td>
                <td>Line 596</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F005</td>
                <td><a href="#func-5">MALDSC</a></td>
                <td>Business Logic</td>
                <td class="priority-medium">Medium</td>
                <td>Line 607</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F006</td>
                <td><a href="#func-6">SARVGN</a></td>
                <td>Data Retrieval</td>
                <td class="priority-medium">Medium</td>
                <td>Line 673</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F007</td>
                <td><a href="#func-7">SBRVGN</a></td>
                <td>Data Retrieval</td>
                <td class="priority-medium">Medium</td>
                <td>Line 702</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F008</td>
                <td><a href="#func-8">SCRVGN</a></td>
                <td>Data Retrieval</td>
                <td class="priority-medium">Medium</td>
                <td>Line 731</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F009</td>
                <td><a href="#func-9">SDRVGN</a></td>
                <td>Data Retrieval</td>
                <td class="priority-medium">Medium</td>
                <td>Line 763</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F010</td>
                <td><a href="#func-10">SERVGN</a></td>
                <td>Data Retrieval</td>
                <td class="priority-medium">Medium</td>
                <td>Line 788</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F011</td>
                <td><a href="#func-11">SFRVGN</a></td>
                <td>Data Retrieval</td>
                <td class="priority-medium">Medium</td>
                <td>Line 822</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F012</td>
                <td><a href="#func-12">VACKRL</a></td>
                <td>Business Logic</td>
                <td class="priority-medium">Medium</td>
                <td>Line 856</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F013</td>
                <td><a href="#func-13">VBCKRL</a></td>
                <td>Business Logic</td>
                <td class="priority-medium">Medium</td>
                <td>Line 897</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F014</td>
                <td><a href="#func-14">XDCK2</a></td>
                <td>Business Logic</td>
                <td class="priority-medium">Medium</td>
                <td>Line 970</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F015</td>
                <td><a href="#func-15">XDVC2T</a></td>
                <td>Business Logic</td>
                <td class="priority-medium">Medium</td>
                <td>Line 1038</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F016</td>
                <td><a href="#func-16">Y0SET</a></td>
                <td>Screen Control</td>
                <td class="priority-low">Low</td>
                <td>Line 1063</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F017</td>
                <td><a href="#func-17">Y8TST</a></td>
                <td>Screen Control</td>
                <td class="priority-low">Low</td>
                <td>Line 1070</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F018</td>
                <td><a href="#func-18">Y9CLR</a></td>
                <td>Screen Control</td>
                <td class="priority-low">Low</td>
                <td>Line 1087</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F019</td>
                <td><a href="#func-19">ZASNMS</a></td>
                <td>Messaging</td>
                <td class="priority-medium">Medium</td>
                <td>Line 1094</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F020</td>
                <td><a href="#func-20">ZDVPMT</a></td>
                <td>Screen Control</td>
                <td class="priority-medium">Medium</td>
                <td>Line 1122</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F021</td>
                <td><a href="#func-21">ZHHPKY</a></td>
                <td>Business Logic</td>
                <td class="priority-medium">Medium</td>
                <td>Line 1159</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F022</td>
                <td><a href="#func-22">ZXEXPG</a></td>
                <td>Program Control</td>
                <td class="priority-medium">Medium</td>
                <td>Line 1193</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F023</td>
                <td><a href="#func-23">ZYEXPG</a></td>
                <td>Program Control</td>
                <td class="priority-medium">Medium</td>
                <td>Line 1202</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
            <tr>
                <td>F024</td>
                <td><a href="#func-24">ZZINIT</a></td>
                <td>Initialization</td>
                <td class="priority-critical">Critical</td>
                <td>Line 1218</td>
                <td style="background: #fff3cd;">Generic - AI Enhancement Needed</td>
            </tr>
        </tbody>
    </table>
</div>

<div style="text-align: center; margin: 50px 0;">
    <a href="OMEIPVR_Sections_1-7.html" class="nav-link">← Back to Sections 1-7</a>
</div>

</body>
</html>
