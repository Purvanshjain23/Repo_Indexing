     H/TITLE Bld SAC/G72 Rcds/855  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSZURN
     H* Date          : 07/21/16  Time  : 15:09:15
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPBCZCPL3IF  E           K        DISK
      * RSQ : Order Detail Accrual 855  ODA 855 w/sel PRT Type I
      *
     FPBAWREL1IF  E           K        DISK
      * RTV : EDI Accrual Cde x-ref     Retrieval index
      *
     FPBAVCPL1IF  E           K        DISK
      * RTV : EDI Seg/Elem Map Values   Retrieval index
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FPBCZCPL2IF  E           K        DISK
      * RSQ : Order Detail Accrual 855  ODA 855 w/sel PRT Type I
      *
     FECP033D0IF  E           K        DISK                      A
      * UPD : EDI PO Ack SAC AL/CHG DTL Update index
      *
     FECP032D0IF  E           K        DISK                      A
      * UPD : EDI PO Ack SAC AL/CHG HDR Update index
      *
     I@CZCPYH
      * Order Detail Accrual 855  ODA 855 w/sel PRT Type I
      * Renamed input format fields
     I              CZAIC3                          WAAIC3
     I              CZC4NB                          WAC4NB
     I              CZDPNB                          WADPNB
     I              CZUENB                          WAUENB
     I              CZDXNB                          WADXNB
     I              CZBKPR                          WABKPR
     I              CZC5PC                          WAC5PC
     I              CZAYVA                          WAAYVA
     I              CZHGCD                          WAHGCD
     I              CZBKC7                          WABKC7
     I              CZDUC7                          WADUC7
     I              CZAODT                          WAAODT
     I              CZD0WG                          WAD0WG
     I              CZAVQT                          WAAVQT
     I              CZOKCD                          WAOKCD
     I              CZTQST                          WATQST
     I              CZFGTX                          WAFGTX
     I              CZQRDT                          WAQRDT
     I              CZQSDT                          WAQSDT
     I              CZHBVL                          WAHBVL
     I              CZHCVL                          WAHCVL
     I              CZSHSX                          WASHSX
     I              CZOJCD                          WAOJCD
     I              CZHPAA                          WAHPAA
     I              CZBCNA                          WABCNA
     I              CZP4AA                          WAP4AA
     I              CZP5AA                          WAP5AA
     I              CZUNU2                          WAUNU2
     I              CZUNU3                          WAUNU3
     I              CZVSST                          WAVSST
     I              CZMJDT                          WAMJDT
     I              CZBETM                          WABETM
     I              CZCCVN                          WACCVN
     I              CZCDVN                          WACDVN
     I              CZMKDT                          WAMKDT
     I              CZBFTM                          WABFTM
     I              CZCEVN                          WACEVN
     I              CZCFVN                          WACFVN
      *
     I@AWREPF
      * EDI Accrual Cde x-ref     Retrieval index
      * Renamed input format fields
     I              AWOJCD                          WBOJCD
     I              AWQBAA                          WBQBAA
     I              AWQCAA                          WBQCAA
     I              AWQDAA                          WBQDAA
      *
     I@AVCPPC
      * EDI Seg/Elem Map Values   Retrieval index
      * Renamed input format fields
     I              AVQBAA                          WCQBAA
     I              AVQCAA                          WCQCAA
     I              AVQDAA                          WCQDAA
     I              AVZ6T1                          WCZ6T1
      *
     I@HLREK4
      * Accrual Program           Retrieval index
      * Renamed input format fields
     I              HLOJCD                          WDOJCD
     I              HLLENA                          WDLENA
     I              HLTOST                          WDTOST
     I              HLTQST                          WDTQST
     I              HLTRST                          WDTRST
     I              HLTSST                          WDTSST
     I              HLOKCD                          WDOKCD
     I              HLTYST                          WDTYST
     I              HLOQCD                          WDOQCD
     I              HLHHCD                          WDHHCD
     I              HLI2TX                          WDI2TX
     I              HLJFTX                          WDJFTX
     I              HLI3TX                          WDI3TX
     I              HLJGTX                          WDJGTX
     I              HLLEDG                          WDLEDG
     I              HLTTST                          WDTTST
     I              HLBKPR                          WDBKPR
     I              HLSHSX                          WDSHSX
     I              HLQFSX                          WDQFSX
     I              HLFDTX                          WDFDTX
     I              HLFETX                          WDFETX
     I              HLFFTX                          WDFFTX
     I              HLFGTX                          WDFGTX
     I              HLHQVL                          WDHQVL
     I              HLFHTX                          WDFHTX
     I              HLUVST                          WDUVST
     I              HLUWST                          WDUWST
     I              HLUXST                          WDUXST
     I              HLVSST                          WDVSST
     I              HLAATM                          WDAATM
     I              HLAYNA                          WDAYNA
     I              HLA0NA                          WDA0NA
     I              HLAXDT                          WDAXDT
      *
     I@CLCPWQ
      * EDI PO Ack SAC AL/CHG DTL Update index
      * Renamed input format fields
     I              CLH9NY                          WEH9NY
     I              CLSEQX                          WESEQX
     I              CLYFNY                          WEYFNY
     I              CLQVST                          WEQVST
     I              CLQHAA                          WEQHAA
     I              CLQIAA                          WEQIAA
     I              CLZ8T1                          WEZ8T1
     I              CLMQVL                          WEMQVL
     I              CLQKAA                          WEQKAA
     I              CLG6PC                          WEG6PC
     I              CLMTVL                          WEMTVL
     I              CLC2C3                          WEC2C3
     I              CLMSVL                          WEMSVL
     I              CLQXQT                          WEQXQT
     I              CLQEAA                          WEQEAA
     I              CLZ9T1                          WEZ9T1
     I              CLZ9T2                          WEZ9T2
     I              CLUHNA                          WEUHNA
     I              CLUINA                          WEUINA
     I              CLXHNY                          WEXHNY
     I              CLXINY                          WEXINY
     I              CLMUVL                          WEMUVL
      *
     I@CZCPYG
      * Order Detail Accrual 855  ODA 855 w/sel PRT Type I
      * Renamed input format fields
     I              CZAIC3                          WFAIC3
     I              CZC4NB                          WFC4NB
     I              CZDPNB                          WFDPNB
     I              CZUENB                          WFUENB
     I              CZDXNB                          WFDXNB
     I              CZBKPR                          WFBKPR
     I              CZC5PC                          WFC5PC
     I              CZAYVA                          WFAYVA
     I              CZHGCD                          WFHGCD
     I              CZBKC7                          WFBKC7
     I              CZDUC7                          WFDUC7
     I              CZAODT                          WFAODT
     I              CZD0WG                          WFD0WG
     I              CZAVQT                          WFAVQT
     I              CZOKCD                          WFOKCD
     I              CZTQST                          WFTQST
     I              CZFGTX                          WFFGTX
     I              CZQRDT                          WFQRDT
     I              CZQSDT                          WFQSDT
     I              CZHBVL                          WFHBVL
     I              CZHCVL                          WFHCVL
     I              CZSHSX                          WFSHSX
     I              CZOJCD                          WFOJCD
     I              CZHPAA                          WFHPAA
     I              CZBCNA                          WFBCNA
     I              CZP4AA                          WFP4AA
     I              CZP5AA                          WFP5AA
     I              CZUNU2                          WFUNU2
     I              CZUNU3                          WFUNU3
     I              CZVSST                          WFVSST
     I              CZMJDT                          WFMJDT
     I              CZBETM                          WFBETM
     I              CZCCVN                          WFCCVN
     I              CZCDVN                          WFCDVN
     I              CZMKDT                          WFMKDT
     I              CZBFTM                          WFBFTM
     I              CZCEVN                          WFCEVN
     I              CZCFVN                          WFCFVN
      *
     I@CKCPWT
      * EDI PO Ack SAC AL/CHG HDR Update index
      * Renamed input format fields
     I              CKH9NY                          WGH9NY
     I              CKUONY                          WGUONY
     I              CKQHAA                          WGQHAA
     I              CKQEAA                          WGQEAA
     I              CKQVST                          WGQVST
     I              CKQIAA                          WGQIAA
     I              CKZ8T1                          WGZ8T1
     I              CKMQVL                          WGMQVL
     I              CKQKAA                          WGQKAA
     I              CKG6PC                          WGG6PC
     I              CKMTVL                          WGMTVL
     I              CKC2C3                          WGC2C3
     I              CKMSVL                          WGMSVL
     I              CKQXQT                          WGQXQT
     I              CKUHNA                          WGUHNA
     I              CKZ9T1                          WGZ9T1
     I              CKZ9T2                          WGZ9T2
     I              CKUINA                          WGUINA
     I              CKXHNY                          WGXHNY
     I              CKXINY                          WGXINY
     I              CKMUVL                          WGMUVL
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQECP01    E DSECP033D0
      * UPD : EDI PO Ack SAC AL/CHG DTL Update index
      * Renamed input format fields
     I              CLH9NY                          WEH9NY
     I              CLSEQX                          WESEQX
     I              CLYFNY                          WEYFNY
     I              CLQVST                          WEQVST
     I              CLQHAA                          WEQHAA
     I              CLQIAA                          WEQIAA
     I              CLZ8T1                          WEZ8T1
     I              CLMQVL                          WEMQVL
     I              CLQKAA                          WEQKAA
     I              CLG6PC                          WEG6PC
     I              CLMTVL                          WEMTVL
     I              CLC2C3                          WEC2C3
     I              CLMSVL                          WEMSVL
     I              CLQXQT                          WEQXQT
     I              CLQEAA                          WEQEAA
     I              CLZ9T1                          WEZ9T1
     I              CLZ9T2                          WEZ9T2
     I              CLUHNA                          WEUHNA
     I              CLUINA                          WEUINA
     I              CLXHNY                          WEXHNY
     I              CLXINY                          WEXINY
     I              CLMUVL                          WEMUVL
      *
     IQECP02    E DSECP032D0
      * UPD : EDI PO Ack SAC AL/CHG HDR Update index
      * Renamed input format fields
     I              CKH9NY                          WGH9NY
     I              CKUONY                          WGUONY
     I              CKQHAA                          WGQHAA
     I              CKQEAA                          WGQEAA
     I              CKQVST                          WGQVST
     I              CKQIAA                          WGQIAA
     I              CKZ8T1                          WGZ8T1
     I              CKMQVL                          WGMQVL
     I              CKQKAA                          WGQKAA
     I              CKG6PC                          WGG6PC
     I              CKMTVL                          WGMTVL
     I              CKC2C3                          WGC2C3
     I              CKMSVL                          WGMSVL
     I              CKQXQT                          WGQXQT
     I              CKUHNA                          WGUHNA
     I              CKZ9T1                          WGZ9T1
     I              CKZ9T2                          WGZ9T2
     I              CKUINA                          WGUINA
     I              CKXHNY                          WGXHNY
     I              CKXINY                          WGXINY
     I              CKMUVL                          WGMUVL
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I : RST Company
     I                                    P   1   20P1BNC3
     IP2PARM      DS
      * I : RST Order Number
     I                                    P   1   40P2C4NB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BNC3    PARM           WP0001  30       Company
     C           P2C4NB    PARM           WP0002  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld SAC/G72 Rcds/855  XF
      * Maintenance
      * 07/08/16 SAZ New install
      * Process all Invoice Detail Accruals  Inv print type = "IT"
      * Rtv/Crt 855 SAC Dtl   RT - Order Detail Accrual 855  * 
     C                     EXSR SARVGN
      * Process all Invoice Total Accruals  Inv print type = "IN"
      * Rtv/Crt 855 SAC Tot   RT - Order Detail Accrual 855  * 
     C                     EXSR SFRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv/Crt 855 SAC Dtl   RT - Order Detail Accrual 855  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Order Sequence
     C                     Z-ADD*ZERO     WN0002  30       Order Secondary
     C                     Z-ADD*ZERO     WN0003  30       Sequence Number
     C                     Z-ADD*ZERO     WN0004  90       EDI SURROGATE N
     C                     Z-ADD*ZERO     WN0005  30       ITEM SEQUENCE N
     C                     Z-ADD*ZERO     WN0006  50       Item Secondary
     C                     MOVEL*BLANK    WN0007  1        S1 Allow/Chg In
     C                     MOVEL*BLANK    WN0008  4        S2/G1 Allow/Chg
     C                     MOVEL*BLANK    WN0009  2        S3 Agency Quali
     C                     MOVEL*BLANK    WN0010 10        S4 Agency Servc
     C                     Z-ADD*ZERO     WN0011 152       S5/G8 Amount
     C                     MOVEL*BLANK    WN0012  6        S6 Allow/Chrge
     C                     Z-ADD*ZERO     WN0013  52       S7/G9 Percent
     C                     Z-ADD*ZERO     WN0014 112       S8/G5 Rate
     C                     Z-ADD*ZERO     WN0015  30       S9/G7 Unit or B
     C                     Z-ADD*ZERO     WN0016 150       S10/G6 Quantity
     C                     Z-ADD*ZERO     WN0017 150       S11 Quantity
     C                     MOVEL*BLANK    WN0018  2        S12/G2 All/Chg
     C                     MOVEL*BLANK    WN0019 30        S13 Ref ID
     C                     MOVEL*BLANK    WN0020 20        S14/G11 Option
     C                     MOVEL*BLANK    WN0021 25        S15 Allow/Chg D
     C                     MOVEL*BLANK    WN0022  3        S16 Language Co
     C                     MOVEL*BLANK    WN0023 16        G3 Allow/Chg NB
     C                     Z-ADD*ZERO     WN0024 160       G4 Exception Nb
     C                     Z-ADD*ZERO     WN0025  90       G10 Dollar Basi
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Maintenance:
      * 6/30/15 New install
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADDP1BNC3    WQSA01           Company Number
     C                     Z-ADDP2C4NB    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@CZCPYH                    *
     C           KRSSA     READE@CZCPYH                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4947' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Order Sequence
     C                     Z-ADD*ZERO     WN0002           Order Secondary
     C                     Z-ADD*ZERO     WN0003           Sequence Number
     C                     Z-ADD*ZERO     WN0004           EDI SURROGATE N
     C                     Z-ADD*ZERO     WN0005           ITEM SEQUENCE N
     C                     Z-ADD*ZERO     WN0006           Item Secondary
     C                     MOVEL*BLANK    WN0007           S1 Allow/Chg In
     C                     MOVEL*BLANK    WN0008           S2/G1 Allow/Chg
     C                     MOVEL*BLANK    WN0009           S3 Agency Quali
     C                     MOVEL*BLANK    WN0010           S4 Agency Servc
     C                     Z-ADD*ZERO     WN0011           S5/G8 Amount
     C                     MOVEL*BLANK    WN0012           S6 Allow/Chrge
     C                     Z-ADD*ZERO     WN0013           S7/G9 Percent
     C                     Z-ADD*ZERO     WN0014           S8/G5 Rate
     C                     Z-ADD*ZERO     WN0015           S9/G7 Unit or B
     C                     Z-ADD*ZERO     WN0016           S10/G6 Quantity
     C                     Z-ADD*ZERO     WN0017           S11 Quantity
     C                     MOVEL*BLANK    WN0018           S12/G2 All/Chg
     C                     MOVEL*BLANK    WN0019           S13 Ref ID
     C                     MOVEL*BLANK    WN0020           S14/G11 Option
     C                     MOVEL*BLANK    WN0021           S15 Allow/Chg D
     C                     MOVEL*BLANK    WN0022           S16 Language Co
     C                     MOVEL*BLANK    WN0023           G3 Allow/Chg NB
     C                     Z-ADD*ZERO     WN0024           G4 Exception Nb
     C                     Z-ADD*ZERO     WN0025           G10 Dollar Basi
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * S2/G1 All/Chg Code
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAOJCD    WL0001    P      Accrual Code
     C                     MOVEL'SAC'     WL0002    P      Segment
     C                     Z-ADD2         WL0003           Element Positio
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0001    P      Element Value
      * Get Allow/Charge Description
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'SAC'     WL0005    P      Segment
     C                     Z-ADD2         WL0006           Element Positio
     C                     MOVELYL0001    WL0007    P      Element Value
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YL0002    P      Element Value D
      * S12/G2 All/Chg Method
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAOJCD    WL0001    P      Accrual Code
     C                     MOVEL'SAC'     WL0002    P      Segment
     C                     Z-ADD12        WL0003           Element Positio
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0003    P      Element Value
      * RTV Accrual Info       RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAOJCD    WL0009    P      Accrual Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YN0001    P      Accrual Descrip
     C                     MOVELWL0011    YN0002    P      Automatic Accru
     C                     MOVELWL0012    YN0003    P      Print On Invoic
     C                     MOVELWL0013    YN0004    P      Rate Usage
     C                     MOVELWL0014    YL0004    P      Add-on/Allowanc
     C                     MOVELWL0015    YN0005    P      Accrual Type
     C                     MOVELWL0016    YN0006    P      Sub Ledger Code
     C                     MOVELWL0017    YN0007    P      Reverse Accrual
     C                     MOVELWL0018    YN0008    P      U/M - Primary D
     C                     MOVELWL0019    YN0009    P      Affect Invoice
      * CASE: LCL.Add-on/Allowance is Add-on
     C           YL0004    IFEQ 'A'                        *IF
     C                     MOVEL'C'       YL0005           S1 Allow/Chg In
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0004    IFEQ 'S'                        *IF
     C                     MOVEL'A'       YL0005           S1 Allow/Chg In
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWAAYVA    WN0011           S5/G8 Amount
      * Crt EDI PO Ack SAC AL/ CR - EDI PO Ack SAC AL/CHG DTL  * 
     C                     EXSR SECRRC
     C           KRSSA     READE@CZCPYH                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBOJCD    WQSB01           Accrual Code
     C           *LIKE     DEFN WBQBAA    WQSB02           Segment
     C           *LIKE     DEFN WBQCAA    WQSB03           Element Positio
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Accrual Code
     C                     KFLD           WQSB02           Segment
     C                     KFLD           WQSB03           Element Positio
      * Setup key
     C                     MOVELWL0001    WQSB01           Accrual Code
     C                     MOVELWL0002    WQSB02           Segment
     C                     Z-ADDWL0003    WQSB03           Element Positio
      * Establish starting position
     C           KRSSB     SETLL@AWREPF                    *
     C           KRSSB     READE@AWREPF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4577' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Element Value
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBQDAA    WL0004           Element Value
     C           KRSSB     READE@AWREPF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCQBAA           Segment
     C                     KFLD           WCQCAA           Element Positio
     C                     KFLD           WCQDAA           Element Value
      * Setup key
     C                     MOVELWL0005    WCQBAA           Segment
     C                     Z-ADDWL0006    WCQCAA           Element Positio
     C                     MOVELWL0007    WCQDAA           Element Value
      * Establish starting position
     C           KRSSC     CHAIN@AVCPPC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4573' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           Element Value D
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCZ6T1    WL0008           Element Value D
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Accrual Info       RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDOJCD           Accrual Code
      * Setup key
     C                     MOVELWL0009    WDOJCD           Accrual Code
      * Establish starting position
     C           KRSSD     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Accrual Descrip
     C                     MOVEL*BLANK    WL0011           Automatic Accru
     C                     MOVEL*BLANK    WL0012           Print On Invoic
     C                     MOVEL*BLANK    WL0013           Rate Usage
     C                     MOVEL*BLANK    WL0014           Add-on/Allowanc
     C                     MOVEL*BLANK    WL0015           Accrual Type
     C                     MOVEL*BLANK    WL0016           Sub Ledger Code
     C                     MOVEL*BLANK    WL0017           Reverse Accrual
     C                     MOVEL*BLANK    WL0018           U/M - Primary D
     C                     MOVEL*BLANK    WL0019           Affect Invoice
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWDLENA    WL0010           Accrual Descrip
     C                     MOVELWDTOST    WL0011           Automatic Accru
     C                     MOVELWDTQST    WL0012           Print On Invoic
     C                     MOVELWDTRST    WL0013           Rate Usage
     C                     MOVELWDTSST    WL0014           Add-on/Allowanc
     C                     MOVELWDOKCD    WL0015           Accrual Type
     C                     MOVELWDTYST    WL0016           Sub Ledger Code
     C                     MOVELWDOQCD    WL0017           Reverse Accrual
     C                     MOVELWDHHCD    WL0018           U/M - Primary D
     C                     MOVELWDFFTX    WL0019           Affect Invoice
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt EDI PO Ack SAC AL/ CR - EDI PO Ack SAC AL/CHG DTL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CLCPWQ
     C                     Z-ADDP2C4NB    WEH9NY           EDI SURROGATE N
     C                     Z-ADDWADPNB    WESEQX           ITEM SEQUENCE N
     C                     Z-ADDWAUENB    WEYFNY           Item Secondary
     C                     MOVELYL0005    WEQVST           S1 Allow/Chg In
     C                     MOVELYL0001    WEQHAA           S2/G1 Allow/Chg
     C                     MOVEL*BLANK    WEQIAA           S3 Agency Quali
     C                     MOVEL*BLANK    WEZ8T1           S4 Agency Servc
     C                     Z-ADDWN0011    WEMQVL           S5/G8 Amount
     C                     MOVEL*BLANK    WEQKAA           S6 Allow/Chrge
     C                     Z-ADD0         WEG6PC           S7/G9 Percent
     C                     Z-ADDWABKPR    WEMTVL           S8/G5 Rate
     C                     Z-ADD0         WEC2C3           S9/G7 Unit or B
     C                     Z-ADD0         WEMSVL           S10/G6 Quantity
     C                     Z-ADD0         WEQXQT           S11 Quantity
     C                     MOVELYL0003    WEQEAA           S12/G2 All/Chg
     C                     MOVEL*BLANK    WEZ9T1           S13 Ref ID
     C                     MOVEL*BLANK    WEZ9T2           S14/G11 Option
     C                     MOVELYL0002    WEUHNA           S15 Allow/Chg D
     C                     MOVEL*BLANK    WEUINA           S16 Language Co
     C                     MOVEL*BLANK    WEXHNY           G3 Allow/Chg NB
     C                     Z-ADD0         WEXINY           G4 Exception Nb
     C                     Z-ADD0         WEMUVL           G10 Dollar Basi
      *
     C           KLCRSE    KLIST
     C                     KFLD           WEH9NY           EDI SURROGATE N
     C                     KFLD           WESEQX           ITEM SEQUENCE N
     C                     KFLD           WEYFNY           Item Secondary
      * Check for duplicate primary key
     C           KLCRSE    SETLL@CLCPWQ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4902' W0RTN   7
      * Send message 'EDI PO Ack SAC 2119832'
     C                     MOVEL'USR4902' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@CLCPWQ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv/Crt 855 SAC Tot   RT - Order Detail Accrual 855  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0026  30       Order Sequence
     C                     Z-ADD*ZERO     WN0027  30       Order Secondary
     C                     Z-ADD*ZERO     WN0028  30       Sequence Number
     C                     Z-ADD*ZERO     WN0029  90       EDI SURROGATE N
     C                     Z-ADD*ZERO     WN0030  60       ENT01-SEQUENCE
     C                     MOVEL*BLANK    WN0031  4        S2/G1 Allow/Chg
     C                     MOVEL*BLANK    WN0032  2        S12/G2 All/Chg
     C                     MOVEL*BLANK    WN0033  1        S1 Allow/Chg In
     C                     MOVEL*BLANK    WN0034  2        S3 Agency Quali
     C                     MOVEL*BLANK    WN0035 10        S4 Agency Servc
     C                     Z-ADD*ZERO     WN0036 152       S5/G8 Amount
     C                     MOVEL*BLANK    WN0037  6        S6 Allow/Chrge
     C                     Z-ADD*ZERO     WN0038  52       S7/G9 Percent
     C                     Z-ADD*ZERO     WN0039 112       S8/G5 Rate
     C                     Z-ADD*ZERO     WN0040  30       S9/G7 Unit or B
     C                     Z-ADD*ZERO     WN0041 150       S10/G6 Quantity
     C                     Z-ADD*ZERO     WN0042 150       S11 Quantity
     C                     MOVEL*BLANK    WN0043 25        S15 Allow/Chg D
     C                     MOVEL*BLANK    WN0044 30        S13 Ref ID
     C                     MOVEL*BLANK    WN0045 20        S14/G11 Option
     C                     MOVEL*BLANK    WN0046  3        S16 Language Co
     C                     MOVEL*BLANK    WN0047 16        G3 Allow/Chg NB
     C                     Z-ADD*ZERO     WN0048 160       G4 Exception Nb
     C                     Z-ADD*ZERO     WN0049  90       G10 Dollar Basi
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Maintenance:
      * 6/30/15 New install
     C                     MOVEL'Y'       YL0006           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSF02           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDP1BNC3    WQSF01           Company Number
     C                     Z-ADDP2C4NB    WQSF02           Order Number
      * Establish starting position
     C           KRSSF     SETLL@CZCPYG                    *
     C           KRSSF     READE@CZCPYG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4947' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0026           Order Sequence
     C                     Z-ADD*ZERO     WN0027           Order Secondary
     C                     Z-ADD*ZERO     WN0028           Sequence Number
     C                     Z-ADD*ZERO     WN0029           EDI SURROGATE N
     C                     Z-ADD*ZERO     WN0030           ENT01-SEQUENCE
     C                     MOVEL*BLANK    WN0031           S2/G1 Allow/Chg
     C                     MOVEL*BLANK    WN0032           S12/G2 All/Chg
     C                     MOVEL*BLANK    WN0033           S1 Allow/Chg In
     C                     MOVEL*BLANK    WN0034           S3 Agency Quali
     C                     MOVEL*BLANK    WN0035           S4 Agency Servc
     C                     Z-ADD*ZERO     WN0036           S5/G8 Amount
     C                     MOVEL*BLANK    WN0037           S6 Allow/Chrge
     C                     Z-ADD*ZERO     WN0038           S7/G9 Percent
     C                     Z-ADD*ZERO     WN0039           S8/G5 Rate
     C                     Z-ADD*ZERO     WN0040           S9/G7 Unit or B
     C                     Z-ADD*ZERO     WN0041           S10/G6 Quantity
     C                     Z-ADD*ZERO     WN0042           S11 Quantity
     C                     MOVEL*BLANK    WN0043           S15 Allow/Chg D
     C                     MOVEL*BLANK    WN0044           S13 Ref ID
     C                     MOVEL*BLANK    WN0045           S14/G11 Option
     C                     MOVEL*BLANK    WN0046           S16 Language Co
     C                     MOVEL*BLANK    WN0047           G3 Allow/Chg NB
     C                     Z-ADD*ZERO     WN0048           G4 Exception Nb
     C                     Z-ADD*ZERO     WN0049           G10 Dollar Basi
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag is Yes
     C           YL0006    IFEQ 'Y'                        *IF
     C                     MOVELWFOJCD    YL0007           Accrual Code
     C                     MOVEL'N'       YL0006           First Time Flag
     C                     END                             *FI
      * Break on the Accrual Code
      * CASE: LCL.Accrual Code NE DB1.Accrual Code
     C           YL0007    IFNE WFOJCD                     *IF
      * S2/G1 All/Chg Code for example D240
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0007    WL0001    P      Accrual Code
     C                     MOVEL'SAC'     WL0002    P      Segment
     C                     Z-ADD2         WL0003           Element Positio
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0008    P      Element Value
      * Get Allow/Charge Description
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'SAC'     WL0005    P      Segment
     C                     Z-ADD2         WL0006           Element Positio
     C                     MOVELYL0008    WL0007    P      Element Value
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YL0009    P      Element Value D
      * S12/G2 All/Chg Method  02=off inv, 06=charge to be paid by Cust
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0007    WL0001    P      Accrual Code
     C                     MOVEL'SAC'     WL0002    P      Segment
     C                     Z-ADD12        WL0003           Element Positio
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0010    P      Element Value
      * Get Add-on/Allowance code
      * RTV Accrual Info       RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0007    WL0009    P      Accrual Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YN0010    P      Accrual Descrip
     C                     MOVELWL0011    YN0011    P      Automatic Accru
     C                     MOVELWL0012    YN0012    P      Print On Invoic
     C                     MOVELWL0013    YN0013    P      Rate Usage
     C                     MOVELWL0014    YL0011    P      Add-on/Allowanc
     C                     MOVELWL0015    YN0014    P      Accrual Type
     C                     MOVELWL0016    YN0015    P      Sub Ledger Code
     C                     MOVELWL0017    YN0016    P      Reverse Accrual
     C                     MOVELWL0018    YN0017    P      U/M - Primary D
     C                     MOVELWL0019    YN0018    P      Affect Invoice
      * CASE: LCL.Add-on/Allowance is Add-on
     C           YL0011    IFEQ 'A'                        *IF
     C                     MOVEL'C'       YL0012           S1 Allow/Chg In
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0011    IFEQ 'S'                        *IF
     C                     MOVEL'A'       YL0012           S1 Allow/Chg In
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0013           ENT01-SEQUENCE
     C                     Z-ADDYL0013    WN0030           ENT01-SEQUENCE
     C                     Z-ADDYL0014    WN0036           S5/G8 Amount
      * Crt EDI PO Ack SAC AL/ CR - EDI PO Ack SAC AL/CHG HDR  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2C4NB    WL0020           EDI SURROGATE N
     C                     Z-ADDWN0030    WL0021           ENT01-SEQUENCE
     C                     MOVELYL0008    WL0022    P      S2/G1 Allow/Chg
     C                     MOVELYL0010    WL0023    P      S12/G2 All/Chg
     C                     MOVELYL0012    WL0024    P      S1 Allow/Chg In
     C                     MOVEL*BLANK    WL0025           S3 Agency Quali
     C                     MOVEL*BLANK    WL0026           S4 Agency Servc
     C                     Z-ADDWN0036    WL0027           S5/G8 Amount
     C                     MOVEL*BLANK    WL0028           S6 Allow/Chrge
     C                     Z-ADD0         WL0029           S7/G9 Percent
     C                     Z-ADD0         WL0030           S8/G5 Rate
     C                     Z-ADD0         WL0031           S9/G7 Unit or B
     C                     Z-ADD0         WL0032           S10/G6 Quantity
     C                     Z-ADD0         WL0033           S11 Quantity
     C                     MOVELYL0009    WL0034    P      S15 Allow/Chg D
     C                     MOVEL*BLANK    WL0035           S13 Ref ID
     C                     MOVEL*BLANK    WL0036           S14/G11 Option
     C                     MOVEL*BLANK    WL0037           S16 Language Co
     C                     MOVEL*BLANK    WL0038           G3 Allow/Chg NB
     C                     Z-ADD0         WL0039           G4 Exception Nb
     C                     Z-ADD0         WL0040           G10 Dollar Basi
     C                     EXSR SGCRRC
     C                     Z-ADD0         YL0014           Extended Amount
     C                     MOVELWFOJCD    YL0007           Accrual Code
     C                     END                             *FI
     C                     ADD  WFAYVA    YL0014           Extended Amount
     C           KRSSF     READE@CZCPYG                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.First Time Flag is NO
     C           YL0006    IFEQ 'N'                        *IF
      * S2/G1 All/Chg Code
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0007    WL0001    P      Accrual Code
     C                     MOVEL'SAC'     WL0002    P      Segment
     C                     Z-ADD2         WL0003           Element Positio
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0008    P      Element Value
      * Get Allow/Charge Description
      * Rtv AccrSeg/Elem Val  RT - EDI Seg/Elem Map Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'SAC'     WL0005    P      Segment
     C                     Z-ADD2         WL0006           Element Positio
     C                     MOVELYL0008    WL0007    P      Element Value
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YL0009    P      Element Value D
      * S12/G2 All/Chg Method
      * RTV EDI Accrual X-Ref RT - EDI Accrual Cde x-ref  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0007    WL0001    P      Accrual Code
     C                     MOVEL'SAC'     WL0002    P      Segment
     C                     Z-ADD12        WL0003           Element Positio
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0010    P      Element Value
      * Get Add-on/Allowance code
      * RTV Accrual Info       RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0007    WL0009    P      Accrual Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YN0010    P      Accrual Descrip
     C                     MOVELWL0011    YN0011    P      Automatic Accru
     C                     MOVELWL0012    YN0012    P      Print On Invoic
     C                     MOVELWL0013    YN0013    P      Rate Usage
     C                     MOVELWL0014    YL0011    P      Add-on/Allowanc
     C                     MOVELWL0015    YN0014    P      Accrual Type
     C                     MOVELWL0016    YN0015    P      Sub Ledger Code
     C                     MOVELWL0017    YN0016    P      Reverse Accrual
     C                     MOVELWL0018    YN0017    P      U/M - Primary D
     C                     MOVELWL0019    YN0018    P      Affect Invoice
      * CASE: LCL.Add-on/Allowance is Add-on
     C           YL0011    IFEQ 'A'                        *IF
     C                     MOVEL'C'       YL0012           S1 Allow/Chg In
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Add-on/Allowance is Allowance
     C           YL0011    IFEQ 'S'                        *IF
     C                     MOVEL'A'       YL0012           S1 Allow/Chg In
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0013           ENT01-SEQUENCE
     C                     Z-ADDYL0014    WN0036           S5/G8 Amount
     C                     Z-ADDYL0013    WN0030           ENT01-SEQUENCE
      * Crt EDI PO Ack SAC AL/ CR - EDI PO Ack SAC AL/CHG HDR  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2C4NB    WL0020           EDI SURROGATE N
     C                     Z-ADDWN0030    WL0021           ENT01-SEQUENCE
     C                     MOVELYL0008    WL0022    P      S2/G1 Allow/Chg
     C                     MOVELYL0010    WL0023    P      S12/G2 All/Chg
     C                     MOVELYL0012    WL0024    P      S1 Allow/Chg In
     C                     MOVEL*BLANK    WL0025           S3 Agency Quali
     C                     MOVEL*BLANK    WL0026           S4 Agency Servc
     C                     Z-ADDWN0036    WL0027           S5/G8 Amount
     C                     MOVEL*BLANK    WL0028           S6 Allow/Chrge
     C                     Z-ADD0         WL0029           S7/G9 Percent
     C                     Z-ADD0         WL0030           S8/G5 Rate
     C                     Z-ADD0         WL0031           S9/G7 Unit or B
     C                     Z-ADD0         WL0032           S10/G6 Quantity
     C                     Z-ADD0         WL0033           S11 Quantity
     C                     MOVELYL0009    WL0034    P      S15 Allow/Chg D
     C                     MOVEL*BLANK    WL0035           S13 Ref ID
     C                     MOVEL*BLANK    WL0036           S14/G11 Option
     C                     MOVEL*BLANK    WL0037           S16 Language Co
     C                     MOVEL*BLANK    WL0038           G3 Allow/Chg NB
     C                     Z-ADD0         WL0039           G4 Exception Nb
     C                     Z-ADD0         WL0040           G10 Dollar Basi
     C                     EXSR SGCRRC
     C                     END                             *FI
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt EDI PO Ack SAC AL/ CR - EDI PO Ack SAC AL/CHG HDR  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CKCPWT
     C                     Z-ADDWL0020    WGH9NY           EDI SURROGATE N
     C                     Z-ADDWL0021    WGUONY           ENT01-SEQUENCE
     C                     MOVELWL0022    WGQHAA           S2/G1 Allow/Chg
     C                     MOVELWL0023    WGQEAA           S12/G2 All/Chg
     C                     MOVELWL0024    WGQVST           S1 Allow/Chg In
     C                     MOVELWL0025    WGQIAA           S3 Agency Quali
     C                     MOVELWL0026    WGZ8T1           S4 Agency Servc
     C                     Z-ADDWL0027    WGMQVL           S5/G8 Amount
     C                     MOVELWL0028    WGQKAA           S6 Allow/Chrge
     C                     Z-ADDWL0029    WGG6PC           S7/G9 Percent
     C                     Z-ADDWL0030    WGMTVL           S8/G5 Rate
     C                     Z-ADDWL0031    WGC2C3           S9/G7 Unit or B
     C                     Z-ADDWL0032    WGMSVL           S10/G6 Quantity
     C                     Z-ADDWL0033    WGQXQT           S11 Quantity
     C                     MOVELWL0034    WGUHNA           S15 Allow/Chg D
     C                     MOVELWL0035    WGZ9T1           S13 Ref ID
     C                     MOVELWL0036    WGZ9T2           S14/G11 Option
     C                     MOVELWL0037    WGUINA           S16 Language Co
     C                     MOVELWL0038    WGXHNY           G3 Allow/Chg NB
     C                     Z-ADDWL0039    WGXINY           G4 Exception Nb
     C                     Z-ADDWL0040    WGMUVL           G10 Dollar Basi
      *
     C           KLCRSG    KLIST
     C                     KFLD           WGH9NY           EDI SURROGATE N
     C                     KFLD           WGUONY           ENT01-SEQUENCE
      * Check for duplicate primary key
     C           KLCRSG    SETLL@CKCPWT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4900' W0RTN   7
      * Send message 'EDI PO Ack SAC AL/CHG  EX'
     C                     MOVEL'USR4900' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@CKCPWT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WABKPR           Accrual Rate
     C                     Z-ADD*ZERO     WAC5PC           Accrual Percent
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WADUC7           A/R Customer
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAQRDT           Unused Date
     C                     Z-ADD*ZERO     WAQSDT           Unused Date 2
     C                     Z-ADD*ZERO     WAHBVL           Unused Value 1-
     C                     Z-ADD*ZERO     WAHCVL           Unused Value 2-
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBQCAA           Element Positio
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCQCAA           Element Positio
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WDHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WESEQX           ITEM SEQUENCE N
     C                     Z-ADD*ZERO     WEYFNY           Item Secondary
     C                     Z-ADD*ZERO     WEMQVL           S5/G8 Amount
     C                     Z-ADD*ZERO     WEG6PC           S7/G9 Percent
     C                     Z-ADD*ZERO     WEMTVL           S8/G5 Rate
     C                     Z-ADD*ZERO     WEC2C3           S9/G7 Unit or B
     C                     Z-ADD*ZERO     WEMSVL           S10/G6 Quantity
     C                     Z-ADD*ZERO     WEQXQT           S11 Quantity
     C                     Z-ADD*ZERO     WEXINY           G4 Exception Nb
     C                     Z-ADD*ZERO     WEMUVL           G10 Dollar Basi
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WGUONY           ENT01-SEQUENCE
     C                     Z-ADD*ZERO     WGMQVL           S5/G8 Amount
     C                     Z-ADD*ZERO     WGG6PC           S7/G9 Percent
     C                     Z-ADD*ZERO     WGMTVL           S8/G5 Rate
     C                     Z-ADD*ZERO     WGC2C3           S9/G7 Unit or B
     C                     Z-ADD*ZERO     WGMSVL           S10/G6 Quantity
     C                     Z-ADD*ZERO     WGQXQT           S11 Quantity
     C                     Z-ADD*ZERO     WGXINY           G4 Exception Nb
     C                     Z-ADD*ZERO     WGMUVL           G10 Dollar Basi
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  6
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0005  3
     C                     Z-ADD*ZERO     WL0006  30
     C                     MOVEL*BLANK    WL0007  6
     C                     MOVEL*BLANK    WL0008 50
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010 30
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  2
     C                     MOVEL*BLANK    WL0016  2
     C                     MOVEL*BLANK    WL0017  3
     C                     MOVEL*BLANK    WL0018  2
     C                     MOVEL*BLANK    WL0019  1
      * Define local variables for subroutine SGCRRC.
     C                     Z-ADD*ZERO     WL0020  90
     C                     Z-ADD*ZERO     WL0021  60
     C                     MOVEL*BLANK    WL0022  4
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  2
     C                     MOVEL*BLANK    WL0026 10
     C                     Z-ADD*ZERO     WL0027 152
     C                     MOVEL*BLANK    WL0028  6
     C                     Z-ADD*ZERO     WL0029  52
     C                     Z-ADD*ZERO     WL0030 112
     C                     Z-ADD*ZERO     WL0031  30
     C                     Z-ADD*ZERO     WL0032 150
     C                     Z-ADD*ZERO     WL0033 150
     C                     MOVEL*BLANK    WL0034 25
     C                     MOVEL*BLANK    WL0035 30
     C                     MOVEL*BLANK    WL0036 20
     C                     MOVEL*BLANK    WL0037  3
     C                     MOVEL*BLANK    WL0038 16
     C                     Z-ADD*ZERO     WL0039 160
     C                     Z-ADD*ZERO     WL0040  90
      * Define local work field S2/G1 Allow/Chg cde
     C                     MOVEL*BLANK    YL0001  4
      * Define local work field Element Value Definition
     C                     MOVEL*BLANK    YL0002 50
      * Define local work field S12/G2 All/Chg Method
     C                     MOVEL*BLANK    YL0003  2
      * Define null work field Accrual Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Automatic Accrual (Y/N)
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Print On Invoice (Y/N)
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Rate Usage
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Add-on/Allowance
     C                     MOVEL*BLANK    YL0004  1
      * Define null work field Accrual Type
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field Sub Ledger Code
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field Reverse Accrual Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field U/M - Primary Dft
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Affect Invoice Price
     C                     MOVEL*BLANK    YN0009  1
      * Define local work field S1 Allow/Chg Indicator
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Accrual Code
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field S2/G1 Allow/Chg cde
     C                     MOVEL*BLANK    YL0008  4
      * Define local work field Element Value Definition
     C                     MOVEL*BLANK    YL0009 50
      * Define local work field S12/G2 All/Chg Method
     C                     MOVEL*BLANK    YL0010  2
      * Define null work field Accrual Description
     C                     MOVEL*BLANK    YN0010 30
      * Define null work field Automatic Accrual (Y/N)
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Print On Invoice (Y/N)
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Rate Usage
     C                     MOVEL*BLANK    YN0013  1
      * Define local work field Add-on/Allowance
     C                     MOVEL*BLANK    YL0011  1
      * Define null work field Accrual Type
     C                     MOVEL*BLANK    YN0014  2
      * Define null work field Sub Ledger Code
     C                     MOVEL*BLANK    YN0015  2
      * Define null work field Reverse Accrual Code
     C                     MOVEL*BLANK    YN0016  3
      * Define null work field U/M - Primary Dft
     C                     MOVEL*BLANK    YN0017  2
      * Define null work field Affect Invoice Price
     C                     MOVEL*BLANK    YN0018  1
      * Define local work field S1 Allow/Chg Indicator
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field ENT01-SEQUENCE #
     C                     Z-ADD*ZERO     YL0013  60
      * Define local work field Extended Amount
     C                     Z-ADD*ZERO     YL0014 112
      *================================================================
     CSR         ZZEXIT    ENDSR
