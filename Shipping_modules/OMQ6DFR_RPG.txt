     H/TITLE Edt Load Plan          DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/09/21  Time  : 09:14:30
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FOMQ6DFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Edt Load Plan          DF Display file
      *
     FOPBFCPL7IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          Allow for Load Planning
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FPNFOREL1IF  E           K        DISK
      * RTV : User Application Whs      Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FPDKGREL2IF  E           K        DISK
      * RSQ : Region Definition         Co, State, Region
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State                     Retrieval index       NV
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDKFREL2IF  E           K        DISK
      * RTV : Region                    Active Records
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier                   Active records
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : Order Header TRG          Load(Desc) not bl
      *
     FOPBFCPL6IF  E           K        DISK
      * RSQ : Order Header TRG          Load Exports
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPEYCPL5IF  E           K        DISK
      * RSQ : Order Events              Customer/Order/Event   N
      *
     FOPEYCPL7IF  E           K        DISK
      * RSQ : Order Events              Customer/Order/Event Cod
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FOMFJCPL1UF  E           K        DISK                      A
      * UPD : Load Header               Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFLCPL0UF  E           K        DISK                      A
      * UPD : Load Detail               Update index
      *
     FOPEYCPL0UF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     E                    #L7         7  1
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 060  5 0A
     E                    W0END   7 060  5 0A
     E                    W0NAM   7 060 10
      * Long constants
     E                    @CN#    1  13  6   @CN    25
     E                    YK01      100 10  A            Load Planning S
      *
     E                    YDOW        7  1               *Days of week
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WFRMNB
     I              FLRUNB                          WFRUNB
     I              FLRVNB                          WFRVNB
     I              FLDQTX                          WFDQTX
     I              FLRWNB                          WFRWNB
     I              FLRXNB                          WFRXNB
     I              FLSQNB                          WFSQNB
     I              FLT0NB                          WFT0NB
     I              FLT1NB                          WFT1NB
     I              FLR1NB                          WFR1NB
     I              FLAIC3                          WFAIC3
     I              FLC4NB                          WFC4NB
     I              FLVCST                          WFVCST
     I              FLKEDT                          WFKEDT
     I              FLSXNB                          WFSXNB
     I              FLKFDT                          WFKFDT
     I              FLACTM                          WFACTM
     I              FLK5TX                          WFK5TX
     I              FLW5CD                          WFW5CD
     I              FLEJDT                          WFEJDT
     I              FLAGTM                          WFAGTM
     I              FLKJDT                          WFKJDT
     I              FLATTM                          WFATTM
     I              FLHDDT                          WFHDDT
     I              FLAUTM                          WFAUTM
     I              FLKKDT                          WFKKDT
     I              FLAVTM                          WFAVTM
     I              FLZ4NB                          WFZ4NB
     I              FLY7ST                          WFY7ST
     I              FLY2ST                          WFY2ST
     I              FLWHTX                          WFWHTX
     I              FLWITX                          WFWITX
     I              FLWJTX                          WFWJTX
     I              FLWKTX                          WFWKTX
     I              FLWLTX                          WFWLTX
     I              FLN7DT                          WFN7DT
     I              FLN8DT                          WFN8DT
     I              FLN9DT                          WFN9DT
     I              FLB3TM                          WFB3TM
     I              FLB4TM                          WFB4TM
     I              FLB5TM                          WFB5TM
     I              FLIASX                          WFIASX
     I              FLIBSX                          WFIBSX
     I              FLICSX                          WFICSX
     I              FLWVTX                          WFWVTX
     I              FLWWTX                          WFWWTX
     I              FLWXTX                          WFWXTX
     I              FLUVST                          WFUVST
     I              FLUWST                          WFUWST
     I              FLUXST                          WFUXST
     I              FLAATM                          WFAATM
     I              FLAYNA                          WFAYNA
     I              FLA0NA                          WFA0NA
     I              FLAXDT                          WFAXDT
      *
     I@FFREUG
      * Carrier                   Active records
      * Renamed input format fields
     I              FFBZNA                          WGBZNA
     I              FFADTX                          WGADTX
     I              FFACNA                          WGACNA
     I              FFADNA                          WGADNA
     I              FFAENA                          WGAENA
     I              FFAJNA                          WGAJNA
     I              FFBTTX                          WGBTTX
     I              FFEZNB                          WGEZNB
     I              FFBGCD                          WGBGCD
     I              FFEEDT                          WGEEDT
     I              FFDUTX                          WGDUTX
     I              FFNRVA                          WGNRVA
     I              FFNSVA                          WGNSVA
     I              FFNTVA                          WGNTVA
     I              FFNUVA                          WGNUVA
     I              FFP1ST                          WGP1ST
     I              FFDVTX                          WGDVTX
     I              FFDWTX                          WGDWTX
     I              FFLVCD                          WGLVCD
     I              FFS8NB                          WGS8NB
     I              FFS9NB                          WGS9NB
     I              FFNMVA                          WGNMVA
     I              FFNOVA                          WGNOVA
     I              FFNPVA                          WGNPVA
     I              FFNQVA                          WGNQVA
     I              FFMFCD                          WGMFCD
     I              FFQXNB                          WGQXNB
     I              FFQ1NB                          WGQ1NB
     I              FFMRNG                          WGMRNG
     I              FFMRNE                          WGMRNE
     I              FFRFNB                          WGRFNB
     I              FFMREG                          WGMREG
     I              FFBQPR                          WGBQPR
     I              FFBRPR                          WGBRPR
     I              FFBSPR                          WGBSPR
     I              FFBTPR                          WGBTPR
     I              FFBUPR                          WGBUPR
     I              FFBVPR                          WGBVPR
     I              FFDJWG                          WGDJWG
     I              FFDKWG                          WGDKWG
     I              FFDLWG                          WGDLWG
     I              FFDMWG                          WGDMWG
     I              FFDNWG                          WGDNWG
     I              FFDOWG                          WGDOWG
     I              FFB2PR                          WGB2PR
     I              FFB3PR                          WGB3PR
     I              FFB4PR                          WGB4PR
     I              FFB5PR                          WGB5PR
     I              FFB6PR                          WGB6PR
     I              FFB7PR                          WGB7PR
     I              FFAAC7                          WGAAC7
     I              FFCOFI                          WGCOFI
     I              FFK6TX                          WGK6TX
     I              FFOCNA                          WGOCNA
     I              FFODNA                          WGODNA
     I              FFW7CD                          WGW7CD
     I              FFK7TX                          WGK7TX
     I              FFTENO                          WGTENO
     I              FFK8TX                          WGK8TX
     I              FFAOFC                          WGAOFC
     I              FFAOLI                          WGAOLI
     I              FFKHDT                          WGKHDT
     I              FFUNUS                          WGUNUS
     I              FFUNU2                          WGUNU2
     I              FFUNU3                          WGUNU3
     I              FFUVST                          WGUVST
     I              FFUWST                          WGUWST
     I              FFUXST                          WGUXST
     I              FFVSST                          WGVSST
     I              FFAATM                          WGAATM
     I              FFAYNA                          WGAYNA
     I              FFA0NA                          WGA0NA
     I              FFAXDT                          WGAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WHAIC3
     I              BEC4NB                          WHC4NB
     I              BEJNCD                          WHJNCD
     I              BEANC7                          WHANC7
     I              BEBKC7                          WHBKC7
     I              BEBRTX                          WHBRTX
     I              BEHMNA                          WHHMNA
     I              BEHONA                          WHHONA
     I              BEHPNA                          WHHPNA
     I              BEHNNA                          WHHNNA
     I              BEDBCD                          WHDBCD
     I              BECKTX                          WHCKTX
     I              BEB0C7                          WHB0C7
     I              BEAETX                          WHAETX
     I              BEB1NA                          WHB1NA
     I              BEB3NA                          WHB3NA
     I              BEB4NA                          WHB4NA
     I              BEB2NA                          WHB2NA
     I              BEBHCD                          WHBHCD
     I              BEC8TX                          WHC8TX
     I              BEBCNA                          WHBCNA
     I              BEA0DT                          WHA0DT
     I              BEA5DT                          WHA5DT
     I              BEGNDT                          WHGNDT
     I              BEACDT                          WHACDT
     I              BEAQCD                          WHAQCD
     I              BEB6NA                          WHB6NA
     I              BEBYNA                          WHBYNA
     I              BEBZNA                          WHBZNA
     I              BEGTST                          WHGTST
     I              BEGVST                          WHGVST
     I              BEGUST                          WHGUST
     I              BEQFST                          WHQFST
     I              BECQCD                          WHCQCD
     I              BEGJST                          WHGJST
     I              BEGWST                          WHGWST
     I              BEGXST                          WHGXST
     I              BEGYST                          WHGYST
     I              BEAODT                          WHAODT
     I              BEAIVN                          WHAIVN
     I              BECXDT                          WHCXDT
     I              BEJZVA                          WHJZVA
     I              BEA1WG                          WHA1WG
     I              BEXIST                          WHXIST
     I              BEXJST                          WHXJST
     I              BEXKST                          WHXKST
     I              BEEIDT                          WHEIDT
     I              BEAFTM                          WHAFTM
     I              BEE8CD                          WHE8CD
     I              BEE9CD                          WHE9CD
     I              BERMNB                          WHRMNB
     I              BETBNB                          WHTBNB
     I              BER1NB                          WHR1NB
     I              BEPJST                          WHPJST
     I              BEU0ST                          WHU0ST
     I              BEU1ST                          WHU1ST
     I              BEQ2CD                          WHQ2CD
     I              BEU2ST                          WHU2ST
     I              BEVEST                          WHVEST
     I              BEVFST                          WHVFST
     I              BEVGST                          WHVGST
     I              BERPCD                          WHRPCD
     I              BERNNB                          WHRNNB
     I              BEVDST                          WHVDST
     I              BEATIN                          WHATIN
     I              BEU4ST                          WHU4ST
     I              BEU5ST                          WHU5ST
     I              BERSRN                          WHRSRN
     I              BEMHNA                          WHMHNA
     I              BEMINA                          WHMINA
     I              BEWBST                          WHWBST
     I              BER4CD                          WHR4CD
     I              BEBFCD                          WHBFCD
     I              BEQ4CD                          WHQ4CD
     I              BET3NB                          WHT3NB
     I              BESICD                          WHSICD
     I              BECONB                          WHCONB
     I              BECEST                          WHCEST
     I              BEAWDT                          WHAWDT
     I              BEJPCD                          WHJPCD
     I              BEXUST                          WHXUST
     I              BEZ1ST                          WHZ1ST
     I              BEVRVA                          WHVRVA
     I              BEOBST                          WHOBST
     I              BEBCST                          WHBCST
     I              BEBDST                          WHBDST
     I              BEB7VL                          WHB7VL
     I              BEGASX                          WHGASX
     I              BEGBSX                          WHGBSX
     I              BEGCSX                          WHGCSX
     I              BEGDSX                          WHGDSX
     I              BEFNSX                          WHFNSX
     I              BEFOSX                          WHFOSX
     I              BEFPSX                          WHFPSX
     I              BEFQSX                          WHFQSX
     I              BEFRSX                          WHFRSX
     I              BEFSSX                          WHFSSX
     I              BEFTSX                          WHFTSX
     I              BEFUSX                          WHFUSX
     I              BEFVSX                          WHFVSX
     I              BEFWSX                          WHFWSX
     I              BEFXSX                          WHFXSX
     I              BEFYSX                          WHFYSX
     I              BENODT                          WHNODT
     I              BENPDT                          WHNPDT
     I              BENQDT                          WHNQDT
     I              BENRDT                          WHNRDT
     I              BENSDT                          WHNSDT
     I              BEBPTM                          WHBPTM
     I              BEBQTM                          WHBQTM
     I              BEBRTM                          WHBRTM
     I              BEBSTM                          WHBSTM
     I              BEBTTM                          WHBTTM
     I              BEH0NX                          WHH0NX
     I              BEH1NX                          WHH1NX
     I              BEH2NX                          WHH2NX
     I              BEH3NX                          WHH3NX
     I              BEH4NX                          WHH4NX
     I              BEC0C7                          WHC0C7
     I              BEUVST                          WHUVST
     I              BEUWST                          WHUWST
     I              BEUXST                          WHUXST
     I              BEAATM                          WHAATM
     I              BEAYNA                          WHAYNA
     I              BEA0NA                          WHA0NA
     I              BEAXDT                          WHAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WORMNB
     I              FLRUNB                          WORUNB
     I              FLRVNB                          WORVNB
     I              FLDQTX                          WODQTX
     I              FLRWNB                          WORWNB
     I              FLRXNB                          WORXNB
     I              FLSQNB                          WOSQNB
     I              FLT0NB                          WOT0NB
     I              FLT1NB                          WOT1NB
     I              FLR1NB                          WOR1NB
     I              FLAIC3                          WOAIC3
     I              FLC4NB                          WOC4NB
     I              FLVCST                          WOVCST
     I              FLKEDT                          WOKEDT
     I              FLSXNB                          WOSXNB
     I              FLKFDT                          WOKFDT
     I              FLACTM                          WOACTM
     I              FLK5TX                          WOK5TX
     I              FLW5CD                          WOW5CD
     I              FLEJDT                          WOEJDT
     I              FLAGTM                          WOAGTM
     I              FLKJDT                          WOKJDT
     I              FLATTM                          WOATTM
     I              FLHDDT                          WOHDDT
     I              FLAUTM                          WOAUTM
     I              FLKKDT                          WOKKDT
     I              FLAVTM                          WOAVTM
     I              FLZ4NB                          WOZ4NB
     I              FLY7ST                          WOY7ST
     I              FLY2ST                          WOY2ST
     I              FLWHTX                          WOWHTX
     I              FLWITX                          WOWITX
     I              FLWJTX                          WOWJTX
     I              FLWKTX                          WOWKTX
     I              FLWLTX                          WOWLTX
     I              FLN7DT                          WON7DT
     I              FLN8DT                          WON8DT
     I              FLN9DT                          WON9DT
     I              FLB3TM                          WOB3TM
     I              FLB4TM                          WOB4TM
     I              FLB5TM                          WOB5TM
     I              FLIASX                          WOIASX
     I              FLIBSX                          WOIBSX
     I              FLICSX                          WOICSX
     I              FLWVTX                          WOWVTX
     I              FLWWTX                          WOWWTX
     I              FLWXTX                          WOWXTX
     I              FLUVST                          WOUVST
     I              FLUWST                          WOUWST
     I              FLUXST                          WOUXST
     I              FLAATM                          WOAATM
     I              FLAYNA                          WOAYNA
     I              FLA0NA                          WOA0NA
     I              FLAXDT                          WOAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     I@BFCPNQ
      * Order Header TRG          Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          WSAIC3
     I              BEC4NB                          WSC4NB
     I              BEJNCD                          WSJNCD
     I              BEANC7                          WSANC7
     I              BEBKC7                          WSBKC7
     I              BEBRTX                          WSBRTX
     I              BEHMNA                          WSHMNA
     I              BEHONA                          WSHONA
     I              BEHPNA                          WSHPNA
     I              BEHNNA                          WSHNNA
     I              BEDBCD                          WSDBCD
     I              BECKTX                          WSCKTX
     I              BEB0C7                          WSB0C7
     I              BEAETX                          WSAETX
     I              BEB1NA                          WSB1NA
     I              BEB3NA                          WSB3NA
     I              BEB4NA                          WSB4NA
     I              BEB2NA                          WSB2NA
     I              BEBHCD                          WSBHCD
     I              BEC8TX                          WSC8TX
     I              BEBCNA                          WSBCNA
     I              BEA0DT                          WSA0DT
     I              BEA5DT                          WSA5DT
     I              BEGNDT                          WSGNDT
     I              BEACDT                          WSACDT
     I              BEAQCD                          WSAQCD
     I              BEB6NA                          WSB6NA
     I              BEBYNA                          WSBYNA
     I              BEBZNA                          WSBZNA
     I              BEGTST                          WSGTST
     I              BEGVST                          WSGVST
     I              BEGUST                          WSGUST
     I              BEQFST                          WSQFST
     I              BECQCD                          WSCQCD
     I              BEGJST                          WSGJST
     I              BEGWST                          WSGWST
     I              BEGXST                          WSGXST
     I              BEGYST                          WSGYST
     I              BEAODT                          WSAODT
     I              BEAIVN                          WSAIVN
     I              BECXDT                          WSCXDT
     I              BEJZVA                          WSJZVA
     I              BEA1WG                          WSA1WG
     I              BEXIST                          WSXIST
     I              BEXJST                          WSXJST
     I              BEXKST                          WSXKST
     I              BEEIDT                          WSEIDT
     I              BEAFTM                          WSAFTM
     I              BEE8CD                          WSE8CD
     I              BEE9CD                          WSE9CD
     I              BERMNB                          WSRMNB
     I              BETBNB                          WSTBNB
     I              BER1NB                          WSR1NB
     I              BEPJST                          WSPJST
     I              BEU0ST                          WSU0ST
     I              BEU1ST                          WSU1ST
     I              BEQ2CD                          WSQ2CD
     I              BEU2ST                          WSU2ST
     I              BEVEST                          WSVEST
     I              BEVFST                          WSVFST
     I              BEVGST                          WSVGST
     I              BERPCD                          WSRPCD
     I              BERNNB                          WSRNNB
     I              BEVDST                          WSVDST
     I              BEATIN                          WSATIN
     I              BEU4ST                          WSU4ST
     I              BEU5ST                          WSU5ST
     I              BERSRN                          WSRSRN
     I              BEMHNA                          WSMHNA
     I              BEMINA                          WSMINA
     I              BEWBST                          WSWBST
     I              BER4CD                          WSR4CD
     I              BEBFCD                          WSBFCD
     I              BEQ4CD                          WSQ4CD
     I              BET3NB                          WST3NB
     I              BESICD                          WSSICD
     I              BECONB                          WSCONB
     I              BECEST                          WSCEST
     I              BEAWDT                          WSAWDT
     I              BEJPCD                          WSJPCD
     I              BEXUST                          WSXUST
     I              BEZ1ST                          WSZ1ST
     I              BEVRVA                          WSVRVA
     I              BEOBST                          WSOBST
     I              BEBCST                          WSBCST
     I              BEBDST                          WSBDST
     I              BEB7VL                          WSB7VL
     I              BEGASX                          WSGASX
     I              BEGBSX                          WSGBSX
     I              BEGCSX                          WSGCSX
     I              BEGDSX                          WSGDSX
     I              BEFNSX                          WSFNSX
     I              BEFOSX                          WSFOSX
     I              BEFPSX                          WSFPSX
     I              BEFQSX                          WSFQSX
     I              BEFRSX                          WSFRSX
     I              BEFSSX                          WSFSSX
     I              BEFTSX                          WSFTSX
     I              BEFUSX                          WSFUSX
     I              BEFVSX                          WSFVSX
     I              BEFWSX                          WSFWSX
     I              BEFXSX                          WSFXSX
     I              BEFYSX                          WSFYSX
     I              BENODT                          WSNODT
     I              BENPDT                          WSNPDT
     I              BENQDT                          WSNQDT
     I              BENRDT                          WSNRDT
     I              BENSDT                          WSNSDT
     I              BEBPTM                          WSBPTM
     I              BEBQTM                          WSBQTM
     I              BEBRTM                          WSBRTM
     I              BEBSTM                          WSBSTM
     I              BEBTTM                          WSBTTM
     I              BEH0NX                          WSH0NX
     I              BEH1NX                          WSH1NX
     I              BEH2NX                          WSH2NX
     I              BEH3NX                          WSH3NX
     I              BEH4NX                          WSH4NX
     I              BEC0C7                          WSC0C7
     I              BEUVST                          WSUVST
     I              BEUWST                          WSUWST
     I              BEUXST                          WSUXST
     I              BEAATM                          WSAATM
     I              BEAYNA                          WSAYNA
     I              BEA0NA                          WSA0NA
     I              BEAXDT                          WSAXDT
      *
     I@BFCPMC
      * Order Header TRG          Load Exports
      * Renamed input format fields
     I              BEAIC3                          WTAIC3
     I              BEC4NB                          WTC4NB
     I              BEJNCD                          WTJNCD
     I              BEANC7                          WTANC7
     I              BEBKC7                          WTBKC7
     I              BEBRTX                          WTBRTX
     I              BEHMNA                          WTHMNA
     I              BEHONA                          WTHONA
     I              BEHPNA                          WTHPNA
     I              BEHNNA                          WTHNNA
     I              BEDBCD                          WTDBCD
     I              BECKTX                          WTCKTX
     I              BEB0C7                          WTB0C7
     I              BEAETX                          WTAETX
     I              BEB1NA                          WTB1NA
     I              BEB3NA                          WTB3NA
     I              BEB4NA                          WTB4NA
     I              BEB2NA                          WTB2NA
     I              BEBHCD                          WTBHCD
     I              BEC8TX                          WTC8TX
     I              BEBCNA                          WTBCNA
     I              BEA0DT                          WTA0DT
     I              BEA5DT                          WTA5DT
     I              BEGNDT                          WTGNDT
     I              BEACDT                          WTACDT
     I              BEAQCD                          WTAQCD
     I              BEB6NA                          WTB6NA
     I              BEBYNA                          WTBYNA
     I              BEBZNA                          WTBZNA
     I              BEGTST                          WTGTST
     I              BEGVST                          WTGVST
     I              BEGUST                          WTGUST
     I              BEQFST                          WTQFST
     I              BECQCD                          WTCQCD
     I              BEGJST                          WTGJST
     I              BEGWST                          WTGWST
     I              BEGXST                          WTGXST
     I              BEGYST                          WTGYST
     I              BEAODT                          WTAODT
     I              BEAIVN                          WTAIVN
     I              BECXDT                          WTCXDT
     I              BEJZVA                          WTJZVA
     I              BEA1WG                          WTA1WG
     I              BEXIST                          WTXIST
     I              BEXJST                          WTXJST
     I              BEXKST                          WTXKST
     I              BEEIDT                          WTEIDT
     I              BEAFTM                          WTAFTM
     I              BEE8CD                          WTE8CD
     I              BEE9CD                          WTE9CD
     I              BERMNB                          WTRMNB
     I              BETBNB                          WTTBNB
     I              BER1NB                          WTR1NB
     I              BEPJST                          WTPJST
     I              BEU0ST                          WTU0ST
     I              BEU1ST                          WTU1ST
     I              BEQ2CD                          WTQ2CD
     I              BEU2ST                          WTU2ST
     I              BEVEST                          WTVEST
     I              BEVFST                          WTVFST
     I              BEVGST                          WTVGST
     I              BERPCD                          WTRPCD
     I              BERNNB                          WTRNNB
     I              BEVDST                          WTVDST
     I              BEATIN                          WTATIN
     I              BEU4ST                          WTU4ST
     I              BEU5ST                          WTU5ST
     I              BERSRN                          WTRSRN
     I              BEMHNA                          WTMHNA
     I              BEMINA                          WTMINA
     I              BEWBST                          WTWBST
     I              BER4CD                          WTR4CD
     I              BEBFCD                          WTBFCD
     I              BEQ4CD                          WTQ4CD
     I              BET3NB                          WTT3NB
     I              BESICD                          WTSICD
     I              BECONB                          WTCONB
     I              BECEST                          WTCEST
     I              BEAWDT                          WTAWDT
     I              BEJPCD                          WTJPCD
     I              BEXUST                          WTXUST
     I              BEZ1ST                          WTZ1ST
     I              BEVRVA                          WTVRVA
     I              BEOBST                          WTOBST
     I              BEBCST                          WTBCST
     I              BEBDST                          WTBDST
     I              BEB7VL                          WTB7VL
     I              BEGASX                          WTGASX
     I              BEGBSX                          WTGBSX
     I              BEGCSX                          WTGCSX
     I              BEGDSX                          WTGDSX
     I              BEFNSX                          WTFNSX
     I              BEFOSX                          WTFOSX
     I              BEFPSX                          WTFPSX
     I              BEFQSX                          WTFQSX
     I              BEFRSX                          WTFRSX
     I              BEFSSX                          WTFSSX
     I              BEFTSX                          WTFTSX
     I              BEFUSX                          WTFUSX
     I              BEFVSX                          WTFVSX
     I              BEFWSX                          WTFWSX
     I              BEFXSX                          WTFXSX
     I              BEFYSX                          WTFYSX
     I              BENODT                          WTNODT
     I              BENPDT                          WTNPDT
     I              BENQDT                          WTNQDT
     I              BENRDT                          WTNRDT
     I              BENSDT                          WTNSDT
     I              BEBPTM                          WTBPTM
     I              BEBQTM                          WTBQTM
     I              BEBRTM                          WTBRTM
     I              BEBSTM                          WTBSTM
     I              BEBTTM                          WTBTTM
     I              BEH0NX                          WTH0NX
     I              BEH1NX                          WTH1NX
     I              BEH2NX                          WTH2NX
     I              BEH3NX                          WTH3NX
     I              BEH4NX                          WTH4NX
     I              BEC0C7                          WTC0C7
     I              BEUVST                          WTUVST
     I              BEUWST                          WTUWST
     I              BEUXST                          WTUXST
     I              BEAATM                          WTAATM
     I              BEAYNA                          WTAYNA
     I              BEA0NA                          WTA0NA
     I              BEAXDT                          WTAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WVAIC3
     I              EYC4NB                          WVC4NB
     I              EYQ2NB                          WVQ2NB
     I              EYJPCD                          WVJPCD
     I              EYAUC3                          WVAUC3
     I              EYQ7NB                          WVQ7NB
     I              EYOMST                          WVOMST
     I              EYD2DT                          WVD2DT
     I              EYONST                          WVONST
     I              EYOOST                          WVOOST
     I              EYOPST                          WVOPST
     I              EYAWC3                          WVAWC3
     I              EYQ8NB                          WVQ8NB
     I              EYQ9NB                          WVQ9NB
     I              EYBKC7                          WVBKC7
     I              EYUVST                          WVUVST
     I              EYUWST                          WVUWST
     I              EYUXST                          WVUXST
     I              EYAATM                          WVAATM
     I              EYAYNA                          WVAYNA
     I              EYA0NA                          WVA0NA
     I              EYAXDT                          WVAXDT
      *
     I@EYCPZR
      * Order Events              Customer/Order/Event   N
      * Renamed input format fields
     I              EYAIC3                          WWAIC3
     I              EYC4NB                          WWC4NB
     I              EYQ2NB                          WWQ2NB
     I              EYJPCD                          WWJPCD
     I              EYAUC3                          WWAUC3
     I              EYQ7NB                          WWQ7NB
     I              EYOMST                          WWOMST
     I              EYD2DT                          WWD2DT
     I              EYONST                          WWONST
     I              EYOOST                          WWOOST
     I              EYOPST                          WWOPST
     I              EYAWC3                          WWAWC3
     I              EYQ8NB                          WWQ8NB
     I              EYQ9NB                          WWQ9NB
     I              EYBKC7                          WWBKC7
     I              EYUVST                          WWUVST
     I              EYUWST                          WWUWST
     I              EYUXST                          WWUXST
     I              EYAATM                          WWAATM
     I              EYAYNA                          WWAYNA
     I              EYA0NA                          WWA0NA
     I              EYAXDT                          WWAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WXAIC3
     I              EYC4NB                          WXC4NB
     I              EYQ2NB                          WXQ2NB
     I              EYJPCD                          WXJPCD
     I              EYAUC3                          WXAUC3
     I              EYQ7NB                          WXQ7NB
     I              EYOMST                          WXOMST
     I              EYD2DT                          WXD2DT
     I              EYONST                          WXONST
     I              EYOOST                          WXOOST
     I              EYOPST                          WXOPST
     I              EYAWC3                          WXAWC3
     I              EYQ8NB                          WXQ8NB
     I              EYQ9NB                          WXQ9NB
     I              EYBKC7                          WXBKC7
     I              EYUVST                          WXUVST
     I              EYUWST                          WXUWST
     I              EYUXST                          WXUXST
     I              EYAATM                          WXAATM
     I              EYAYNA                          WXAYNA
     I              EYA0NA                          WXA0NA
     I              EYAXDT                          WXAXDT
      *
     I@EYCPEH
      * Order Events              Customer/Order/Event Cod
      * Renamed input format fields
     I              EYAIC3                          WYAIC3
     I              EYC4NB                          WYC4NB
     I              EYQ2NB                          WYQ2NB
     I              EYJPCD                          WYJPCD
     I              EYAUC3                          WYAUC3
     I              EYQ7NB                          WYQ7NB
     I              EYOMST                          WYOMST
     I              EYD2DT                          WYD2DT
     I              EYONST                          WYONST
     I              EYOOST                          WYOOST
     I              EYOPST                          WYOPST
     I              EYAWC3                          WYAWC3
     I              EYQ8NB                          WYQ8NB
     I              EYQ9NB                          WYQ9NB
     I              EYBKC7                          WYBKC7
     I              EYUVST                          WYUVST
     I              EYUWST                          WYUWST
     I              EYUXST                          WYUXST
     I              EYAATM                          WYAATM
     I              EYAYNA                          WYAYNA
     I              EYA0NA                          WYA0NA
     I              EYAXDT                          WYAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          TAAIC3
     I              ASAXNB                          TAAXNB
     I              ASNGNB                          TANGNB
     I              ASBZNB                          TABZNB
     I              ASC5NB                          TAC5NB
     I              ASC3NB                          TAC3NB
     I              ASCYNB                          TACYNB
     I              ASIONB                          TAIONB
     I              ASI6NB                          TAI6NB
     I              ASDCNB                          TADCNB
     I              ASC7NB                          TAC7NB
     I              ASC2NB                          TAC2NB
     I              ASC1NB                          TAC1NB
     I              ASL8NB                          TAL8NB
     I              ASBANB                          TABANB
     I              ASCHST                          TACHST
     I              ASCKST                          TACKST
     I              ASCIST                          TACIST
     I              ASCGST                          TACGST
     I              ASAIPC                          TAAIPC
     I              ASASPC                          TAASPC
     I              ASA2VA                          TAA2VA
     I              ASC2ST                          TAC2ST
     I              ASD8ST                          TAD8ST
     I              ASD7ST                          TAD7ST
     I              ASA8NA                          TAA8NA
     I              ASA9NA                          TAA9NA
     I              ASBANA                          TABANA
     I              ASBBNA                          TABBNA
     I              ASEUST                          TAEUST
     I              ASAADY                          TAAADY
     I              ASABDY                          TAABDY
     I              ASACDY                          TAACDY
     I              ASADDY                          TAADDY
     I              ASAEDY                          TAAEDY
     I              ASAFDY                          TAAFDY
     I              ASAGDY                          TAAGDY
     I              ASAHDY                          TAAHDY
     I              ASAENB                          TAAENB
     I              ASALNB                          TAALNB
     I              ASEVNB                          TAEVNB
     I              ASRPOP                          TARPOP
     I              ASDWNB                          TADWNB
     I              ASR3NB                          TAR3NB
     I              ASPNST                          TAPNST
     I              ASR4NB                          TAR4NB
     I              ASPOST                          TAPOST
     I              ASSCNB                          TASCNB
     I              ASVIST                          TAVIST
     I              ASVJST                          TAVJST
     I              ASBVVN                          TABVVN
     I              ASUVST                          TAUVST
     I              ASUWST                          TAUWST
     I              ASUXST                          TAUXST
     I              ASVSST                          TAVSST
     I              ASAATM                          TAAATM
     I              ASAYNA                          TAAYNA
     I              ASA0NA                          TAA0NA
     I              ASAXDT                          TAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IYD01        DS
     I                                        1   50YI0101
     I                                        6  100YI01
      *
     IYM01        DS                        100
     I                                        1   50WCRVNB
     I                                        6  120WCBKC7
      *
     IYW01        DS
     I                                        1   50XARVNB
     I                                        6  120XABKC7
      *
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                              8
      * KEY : Order Header TRG          Load Id/Order Num
      * I : RST Load ID
     I                                    P   1   40PARMNB
      * I :  Order Number
     I                                    P   5   80PAC4NB
      *
      * Outward parameters
     IPBRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I : RST Load ID
     I                                    P   1   40PBRMNB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPCRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PCDXNB
      * I :  Load ID
     I                                    P  11  140PCRMNB
      * I :  Stop/Drop
     I                                    P  15  170PCRVNB
      * I :  Load Change Type
     I                                       18  23 PCRVST
      * I :  Department Control Code
     I                                       24  26 PCUJST
      * I :  Change Log Prior Value
     I                                       27  38 PCMNTX
      * I :  Change Log New Value
     I                                       39  50 PCMOTX
      * I :  User Id
     I                                       51  60 PCAYNA
      * I :  Job Name
     I                                       61  70 PCA0NA
      * I :  Carrier Code
     I                                       71  73 PCBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PCXMCD
      * I :  Company Number
     I                                    P  77  780PCAIC3
      * I :  Order Number
     I                                    P  79  820PCC4NB
      *
      * Outward parameters
     IPDRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PDRMNB
      *
     IYBRDCS      DS                            793
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     IYCRDCS      DS                            525
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     IYDRDCS      DS                            779
      * Outward parameters
     IPERC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PEAIC3
      * I :  Order Number
     I                                    P   3   60PEC4NB
      * I :  Order Type - Sales
     I                                        7   8 PEJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PEANC7
      * I :  Ship To Customer
     I                                    P  13  160PEBKC7
      * I :  Ship To Name
     I                                       17  46 PEBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PEHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PEHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PEHPNA
      * I :  Ship To City
     I                                      137 156 PEHNNA
      * I :  Ship To State Code
     I                                      157 158 PEDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PECKTX
      * I :  Bill to Customer
     I                                    P 170 1730PEB0C7
      * I :  Bill to Name
     I                                      174 203 PEAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PEB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PEB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PEB4NA
      * I :  Bill to City
     I                                      294 313 PEB2NA
      * I :  Bill to State Code
     I                                      314 315 PEBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PEC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PEBCNA
      * I :  Order Date
     I                                    P 342 3450PEA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PEA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PEGNDT
      * I :  Cancel Date
     I                                    P 354 3570PEACDT
      * I :  Terms Code
     I                                      358 359 PEAQCD
      * I :  Special Instructions
     I                                      360 399 PEB6NA
      * I :  Special Instructions 2
     I                                      400 439 PEBYNA
      * I :  Carrier Code
     I                                      440 442 PEBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PEGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PEGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PEGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PEQFST
      * I :  Reason Code
     I                                      447 449 PECQCD
      * I :  Order in Use
     I                                      450 450 PEGJST
      * I :  Header Status
     I                                      451 451 PEGWST
      * I :  Header Status Last
     I                                      452 452 PEGXST
      * I :  Order Type Print Status
     I                                      453 453 PEGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PEAODT
      * I :  User Original Entry
     I                                      458 467 PEAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PECXDT
      * I :  Order Value Total
     I                                    P 472 4772PEJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PEA1WG
      * I :  Credit Hold
     I                                      484 484 PEXIST
      * I :  Production Hold
     I                                      485 485 PEXJST
      * I :  New Customer Hold
     I                                      486 486 PEXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PEEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PEAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PEE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PEE9CD
      * I :  Load ID
     I                                    P 510 5130PERMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PETBNB
      * I :  Rated Freight
     I                                    P 517 5222PER1NB
      * I :  LTL Flag
     I                                      523 523 PEPJST
      * I :  Price Audit
     I                                      524 524 PEU0ST
      * I :  Price Status
     I                                      525 525 PEU1ST
      * I :  Shipping Method
     I                                      526 527 PEQ2CD
      * I :  Export Status
     I                                      528 528 PEU2ST
      * I :  Palletize
     I                                      529 529 PEVEST
      * I :  Shrink Wrap
     I                                      530 530 PEVFST
      * I :  Slip Sheet
     I                                      531 531 PEVGST
      * I :  Age Code
     I                                      532 532 PERPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PERNNB
      * I :  Load Type
     I                                      536 536 PEVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PEATIN
      * I :  Load Plan Order
     I                                      541 541 PEU4ST
      * I :  Print Pick Slip
     I                                      542 542 PEU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PERSRN
      * I :  Special Comment 1
     I                                      547 576 PEMHNA
      * I :  Special Comment 2
     I                                      577 606 PEMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PEWBST
      * I :  Sales Route Code
     I                                      608 610 PER4CD
      * I :  Manager Level Code
     I                                      611 612 PEBFCD
      * I :  VP Level Code
     I                                      613 615 PEQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PET3NB
      * I :  Reason for Price Audit
     I                                      620 622 PESICD
      * I :  Invoice Number
     I                                    P 623 6260PECONB
      * I :  Invoice Suffix
     I                                      627 628 PECEST
      * I :  Invoice Date
     I                                    P 629 6320PEAWDT
      * I :  Event Code
     I                                      633 634 PEJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PEXUST
      * I :  Modified Flag
     I                                      636 636 PEZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PEVRVA
      * I :  Billing Activity Type
     I                                      643 643 PEOBST
      * I :  Block Order Flag
     I                                      644 644 PEBCST
      * I :  Order Certification Flag
     I                                      645 645 PEBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PEB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PEGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PEGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PEGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PEGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PEFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PEFOSX
      * I :  Order Emailed
     I                                      658 658 PEFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PEFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PEFRSX
      * I :  Broker Order Status
     I                                      661 661 PEFSSX
      * I :  Air Freight Order
     I                                      662 662 PEFTSX
      * I :  Order Requires Review
     I                                      663 664 PEFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PEFVSX
      * I :  Export USDA Approved
     I                                      667 668 PEFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PEFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PEFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PENODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PENPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PENQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PENRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PENSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PEBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PEBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PEBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PEBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PEBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PEH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PEH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PEH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PEH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PEH4NX
      * I :  Claim Number
     I                                    P 745 7480PEC0C7
      * I :  EDI Status 1
     I                                      749 749 PEUVST
      * I :  EDI Status 2
     I                                      750 750 PEUWST
      * I :  EDI Status 3
     I                                      751 751 PEUXST
      * I :  Job Time
     I                                    P 752 7550PEAATM
      * I :  User Id
     I                                      756 765 PEAYNA
      * I :  Job Name
     I                                      766 775 PEA0NA
      * I :  Job Date
     I                                    P 776 7790PEAXDT
      *
      * Outward parameters
     IPFRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PFRMNB
      *
     IYERDCS      DS                            793
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYFRDCS      DS                            793
     IYGRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     IYHRDCS      DS                            367
     IYIRDCS      DS                            779
     IYJRDCS      DS                            525
     IYKRDCS      DS                            525
     IYLRDCS      DS                            779
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WXAIC3
     I              EYC4NB                          WXC4NB
     I              EYQ2NB                          WXQ2NB
     I              EYJPCD                          WXJPCD
     I              EYAUC3                          WXAUC3
     I              EYQ7NB                          WXQ7NB
     I              EYOMST                          WXOMST
     I              EYD2DT                          WXD2DT
     I              EYONST                          WXONST
     I              EYOOST                          WXOOST
     I              EYOPST                          WXOPST
     I              EYAWC3                          WXAWC3
     I              EYQ8NB                          WXQ8NB
     I              EYQ9NB                          WXQ9NB
     I              EYBKC7                          WXBKC7
     I              EYUVST                          WXUVST
     I              EYUWST                          WXUWST
     I              EYUXST                          WXUXST
     I              EYAATM                          WXAATM
     I              EYAYNA                          WXAYNA
     I              EYA0NA                          WXA0NA
     I              EYAXDT                          WXAXDT
      *
      * Outward parameters
     IPGRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PGDXNB
      * I :  Load ID
     I                                    P  11  140PGRMNB
      * I :  Stop/Drop
     I                                    P  15  170PGRVNB
      * I :  Load Change Type
     I                                       18  23 PGRVST
      * I :  Department Control Code
     I                                       24  26 PGUJST
      * I :  Change Log Prior Value
     I                                       27  38 PGMNTX
      * I :  Change Log New Value
     I                                       39  50 PGMOTX
      * I :  User Id
     I                                       51  60 PGAYNA
      * I :  Job Name
     I                                       61  70 PGA0NA
      * I :  Carrier Code
     I                                       71  73 PGBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PGXMCD
      * I :  Company Number
     I                                    P  77  780PGAIC3
      * I :  Order Number
     I                                    P  79  820PGC4NB
      *
     IYMRDCS      DS                            525
     IYNRDCS      DS                            793
     IYORDCS      DS                            367
     IYPRDCS      DS                            793
     IYQRDCS      DS                            367
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          TAAIC3
     I              ASAXNB                          TAAXNB
     I              ASNGNB                          TANGNB
     I              ASBZNB                          TABZNB
     I              ASC5NB                          TAC5NB
     I              ASC3NB                          TAC3NB
     I              ASCYNB                          TACYNB
     I              ASIONB                          TAIONB
     I              ASI6NB                          TAI6NB
     I              ASDCNB                          TADCNB
     I              ASC7NB                          TAC7NB
     I              ASC2NB                          TAC2NB
     I              ASC1NB                          TAC1NB
     I              ASL8NB                          TAL8NB
     I              ASBANB                          TABANB
     I              ASCHST                          TACHST
     I              ASCKST                          TACKST
     I              ASCIST                          TACIST
     I              ASCGST                          TACGST
     I              ASAIPC                          TAAIPC
     I              ASASPC                          TAASPC
     I              ASA2VA                          TAA2VA
     I              ASC2ST                          TAC2ST
     I              ASD8ST                          TAD8ST
     I              ASD7ST                          TAD7ST
     I              ASA8NA                          TAA8NA
     I              ASA9NA                          TAA9NA
     I              ASBANA                          TABANA
     I              ASBBNA                          TABBNA
     I              ASEUST                          TAEUST
     I              ASAADY                          TAAADY
     I              ASABDY                          TAABDY
     I              ASACDY                          TAACDY
     I              ASADDY                          TAADDY
     I              ASAEDY                          TAAEDY
     I              ASAFDY                          TAAFDY
     I              ASAGDY                          TAAGDY
     I              ASAHDY                          TAAHDY
     I              ASAENB                          TAAENB
     I              ASALNB                          TAALNB
     I              ASEVNB                          TAEVNB
     I              ASRPOP                          TARPOP
     I              ASDWNB                          TADWNB
     I              ASR3NB                          TAR3NB
     I              ASPNST                          TAPNST
     I              ASR4NB                          TAR4NB
     I              ASPOST                          TAPOST
     I              ASSCNB                          TASCNB
     I              ASVIST                          TAVIST
     I              ASVJST                          TAVJST
     I              ASBVVN                          TABVVN
     I              ASUVST                          TAUVST
     I              ASUWST                          TAUWST
     I              ASUXST                          TAUXST
     I              ASVSST                          TAVSST
     I              ASAATM                          TAAATM
     I              ASAYNA                          TAAYNA
     I              ASA0NA                          TAA0NA
     I              ASAXDT                          TAAXDT
      *
     IYRRDCS      DS                            278
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : MAP Company Number
     I                                    P   1   20P1AIC3
      * N :  Order Number
     I                                    P   3   60P1C4NB
      * N :  Ship To Customer
     I                                    P   7  100P1BKC7
      * N :  Ship To Name
     I                                       11  40 P1BRTX
      * N :  Ship To Address Line 1
     I                                       41  70 P1HMNA
      * N :  Ship To Address Line 2
     I                                       71 100 P1HONA
      * N :  Ship To Address Line 3
     I                                      101 130 P1HPNA
      * N :  Header Status
     I                                      131 131 P1GWST
      * N :  Scheduled Ship Date
     I                                    P 132 1350P1AODT
      * N :  Requested Delivery Date
     I                                    P 136 1390P1EIDT
      * B : MAP Load ID
     I                                    P 140 1430P1RMNB
      * N :  LTL Flag
     I                                      144 144 P1PJST
      * N :  Export Status
     I                                      145 145 P1U2ST
      * N :  Load Type
     I                                      146 146 P1VDST
      * N :  Trans Contol AS400/Plant
     I                                      147 147 P1XUST
     IP2PARM      DS
      * FLD: Load Header
      * I : MAP Load Status
     I                                        1   1 P2PKST
      * N :  Total Load Order Weight
     I                                    P   2   50P2RPNB
      * N : MAP Flat Amount
     I                                    P   6  112P2FLAM
      * N : MAP Allocate Pounds/Miles
     I                                       12  12 P2XQST
      * N :  Carrier Code
     I                                       13  15 P2BZNA
      * N :  Truck Size
     I                                       16  22 P2RONB
      * N :  Load Carrier Pay Amt
     I                                    P  23  282P2DGWG
      * N :  Trailer IN Weight
     I                                    P  29  342P2DHWG
      * N :  Trailer OUT Weight
     I                                    P  35  402P2DIWG
      * N :  Schedule Sequence Number
     I                                    P  41  430P2T4NB
      * N :  Total Load Miles
     I                                    P  44  470P2TLMI
      * N :  Shipping Method
     I                                       48  49 P2Q2CD
      * N :  Shipping Line
     I                                       50  52 P2XACD
      * N :  Port Delv Terminal
     I                                       53  72 P2OANA
      * N :  Override Total Load Miles
     I                                    P  73  760P2K2DT
     IP3PARM      DS
      * FLD: *Arrays
      * N :  USR Weight, 9.0
     I                                    P   1   50P3BUNB
      * N :  Auto Load Numbering?
     I                                        6   6 P3PNST
      * N :  Maximum pounds
     I                                    P   7  100P3RSNB
      * N :  Minimum pounds
     I                                    P  11  140P3TANB
      * N :  Display Flag
     I                                       15  15 P3QKST
      * B : MAP USR Update Flag
     I                                       16  16 P3R4ST
      * N : MAP Total Freight
     I                                    P  17  222P3RQNB
      * N :  Deadline Depart Date LH
     I                                    P  23  260P3NVDT
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P4AJCD
      * N :  Application Code
     I                                        4   9 P4DNCD
      * N :  Salesperson Code
     I                                       10  12 P4BCCD
      * N :  System Date Format
     I                                       13  15 P4B8NA
      * N :  Allow Multi-Company
     I                                       16  16 P4I6ST
      * N :  Default Printer
     I                                       17  26 P4MPNA
      * N :  First Time Flag
     I                                       27  27 P4TAST
      * I :  Access Limited Sts USR
     I                                       28  28 P4HHST
     IP5PARM      DS
      * FLD: *Arrays
      * N :  Weight Adjust
     I                                    P   1   40P5DTWG
      * N :  USR Stop
     I                                    P   5   60P5TENB
      * N :  USR Check Y/N Status
     I                                        7   7 P5JDST
      * N :  USR Julian - Current
     I                                    P   8  100P5JLCR
      * N : MAP USR Weight Accumulated
     I                                    P  11  162P5CDWG
      * N :  Load Change Type
     I                                       17  22 P5RVST
      * N :  Record Found USR
     I                                       23  23 P5WXST
     IP6PARM      DS
      * B : MAP Job Name CDE
     I                                        1  10 P6B2VN
     IP7PARM      DS
      * N : MAP Stop/Drop
     I                                    P   1   30P7RVNB
     IP8PARM      DS
      * N :  Change Log Prior Value
     I                                        1  12 P8MNTX
     IP9PARM      DS
      * N :  Hold Stop/Drop         .U
     I                                    P   1   30P9LMNB
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Invalid Dt Chg-DDD/T err2'
      * Scheduled Delivery Time
     I                                    P   1   40ZA0001
      * Message data for 'Invalid Deadln Dt/Tm'
      * Requested Delivery Date
     I                                    P   1   40ZA0002
      * Message data for 'Stop Must be Entered'
      * USR Stop
     I                                    P   1   20ZA0003
      * Message data for 'Order load type NE Load'
      * Order Number
     I                                        1   7 ZA0004
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Auto load # not in effect'
      * Load ID
     I                                    P   1   40ZA0005
      * Message data for 'Load ID already exists'
      * Load ID
     I                                    P   1   40ZA0006
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0007
      * Message data for 'Truck size doesn't exists'
      * Truck Size
     I                                        1   7 ZA0008
      * Message data for 'Truck size must be enter'
      * Truck Size
     I                                        1   7 ZA0009
      * Load ID
     I                                    P   8  110ZA0010
      * Message data for 'State file not found'
      * State Code
     I                                        1   2 ZA0011
      * Message data for 'State file not found'
      * State Code
     I                                        1   2 ZA0012
      * Message data for 'PD Region not found'
      * Company Number
     I                                        1   3 ZA0013
      * Region Code
     I                                        4   7 ZA0014
      * Message data for 'Load Type Must be Entered'
      * Load Type
     I                                        1   1 ZA0015
      * Message data for 'Carrier broker not found'
      * Carrier Broker
     I                                        1   3 ZA0016
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0017
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0018
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0019
      * Warehouse Code
     I                                       11  13 ZA0020
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0021
      * Message data for 'No Orders Assigned'
      * Load ID
     I                                    P   1   40ZA0022
      * *SFLSEL
     I                                        5   5 ZA0023
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0024
      * Load ID
     I                                    P   2   50ZA0025
      * Message data for 'Load Cant be Locked'
      * *SFLSEL
     I                                        1   1 ZA0026
      * Load ID
     I                                    P   2   50ZA0027
      * Message data for 'Carrier must be entered'
      * Carrier Code
     I                                        1   3 ZA0028
      * Load ID
     I                                    P   4   70ZA0029
      * Message data for 'Truck size must be enter'
      * Truck Size
     I                                        1   7 ZA0030
      * Load ID
     I                                    P   8  110ZA0031
      * Message data for 'Shipping Method required'
      * Shipping Method
     I                                        1   2 ZA0032
      * Message data for 'Load has orders w/o stop'
      * Load ID
     I                                    P   1   40ZA0033
      * Message data for 'Load is not accepted'
      * Load ID
     I                                    P   1   40ZA0034
      * Message data for 'Load has Orders on Hold'
      * Load ID
     I                                    P   1   40ZA0035
      * *SFLSEL
     I                                        5   5 ZA0036
      * Message data for 'Load has Cancelled Orders'
      * Load ID
     I                                    P   1   40ZA0037
      * *SFLSEL
     I                                        5   5 ZA0038
      * Message data for 'Load has Orders in Use'
      * *SFLSEL
     I                                        1   1 ZA0039
      * Load ID
     I                                    P   2   50ZA0040
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0041
      * Load ID
     I                                    P   2   50ZA0042
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0043
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0044
      * Load ID
     I                                    P   2   50ZA0045
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0046
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0047
      * Message data for 'Unlock Inval, close exist'
      * *SFLSEL
     I                                        1   1 ZA0048
      * Message data for 'Freight Recover not Allow'
      * Load Status
     I                                        1   1 ZA0049
      * Message data for 'Ship to State required'
      * Ship To State Code
     I                                        1   2 ZA0050
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0051
      * Message data for 'Rated Frt cant be calc'd'
      * Carrier Code
     I                                        1   3 ZA0052
      * Message data for 'Order nf matching ld strt'
      * Company Number
     I                                        1   3 ZA0053
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0054
      * Message data for 'Value Required (numeric)'
      * @Numeric 15.2
     I                                    P   1   82ZA0055
      * Message data for 'This order cannot arrive'
      * USR Stop
     I                                    P   1   20ZA0056
      * Message data for 'Load Locked Can't Change'
      * Load Status
     I                                        1   1 ZA0057
      * USR Stop
     I                                    P   2   30ZA0058
      * Message data for 'Stop # not entered'
      * USR Stop
     I                                    P   1   20ZA0059
      * Message data for 'Order assigned another ld'
      * *SFLSEL
     I                                        1   1 ZA0060
      * Order Number
     I                                        2   8 ZA0061
      * Message data for 'Load Type Mismatch'
      * *SFLSEL
     I                                        1   1 ZA0062
      * Stop/Drop
     I                                    P   2   40ZA0063
      * Message data for 'Shipping Method mismatch'
      * *SFLSEL
     I                                        1   1 ZA0064
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0065
      * Order Number
     I                                        2   8 ZA0066
      * Message data for 'Ord Schd Shp Dt NE LD Shp'
      * *SFLSEL
     I                                        1   1 ZA0067
      * Message data for 'Customer mismatch'
      * *SFLSEL
     I                                        1   1 ZA0068
      * Message data for 'Customer mismatch'
      * *SFLSEL
     I                                        1   1 ZA0069
      * Message data for 'Requested Ship Date can n'
      * Must Ship Date        USR
     I                                    P   1   40ZA0070
      * Message data for 'Load Locked Can't Delete'
      * Load Status
     I                                        1   1 ZA0071
      * USR Stop
     I                                    P   2   30ZA0072
      * Message data for 'Order in use detail'
      * *SFLSEL
     I                                        1   1 ZA0073
      * Order Number
     I                                        2   8 ZA0074
      * Message data for 'Invalid option f/picked o'
      * *SFLSEL
     I                                        1   1 ZA0075
      * Message data for 'Order Not Assign to Load'
      * USR Stop
     I                                    P   1   20ZA0076
      * Message data for 'Order Not Assign to Load'
      * USR Stop
     I                                    P   1   20ZA0077
      * Message data for 'Customer Mismatch Inf'
      * *SFLSEL
     I                                        1   1 ZA0078
      * Message data for 'Customer Mismatch Inf'
      * *SFLSEL
     I                                        1   1 ZA0079
      * Message data for 'Stop Must be Entered'
      * USR Stop
     I                                    P   1   20ZA0080
      * Message data for 'Invalid Dt Chg-DDD/T err2'
      * Scheduled Delivery Time
     I                                    P   1   40ZA0081
      * Message data for 'Invalid Deadln Dt/Tm'
      * Requested Delivery Date
     I                                    P   1   40ZA0082
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0083
      * USR CDE Parm 1
     I                                        4   6 ZA0084
      * USR CDE Parm 2
     I                                        7   9 ZA0085
      * USR CDE Parm 3
     I                                       10  12 ZA0086
      * USR CDE Parm 4
     I                                       13  15 ZA0087
      * USR CDE Parm 5
     I                                       16  18 ZA0088
      * USR CDE Parm 6
     I                                       19  21 ZA0089
      * USR CDE Parm 7
     I                                       22  24 ZA0090
      * USR CDE Parm 8
     I                                       25  27 ZA0091
      * USR CDE Parm 9
     I                                       28  30 ZA0092
      * Message data for 'Load Created -Cur Dte'
      * Load ID
     I                                    P   1   40ZA0093
      * *USER
     I                                        5  14 ZA0094
      * Dsp Date (99/99/99)   USR
     I                                       15  22 ZA0095
      * Company Number CDE
     I                                    P  23  240ZA0096
      * Message data for 'This order cannot arrive'
      * USR Stop
     I                                    P   1   20ZA0097
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0098
      * Application Code
     I                                       11  16 ZA0099
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0100
      * Application Code
     I                                       11  16 ZA0101
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1RMNB    PARM P1RMNB    WP0002  70       Load ID
     C           P2PKST    PARM           WP0003  1        Load Status
     C           P3R4ST    PARM P3R4ST    WP0004  1        USR Update Flag
     C           P4HHST    PARM           WP0005  1        Access Limited
     C           P6B2VN    PARM P6B2VN    WP0006 10        Job Name CDE
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CTL.Condition Desc. 1  USR = Condition name of WRK.Display File A
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1197455   Y2LSNO  70       List number
     C                     PARM WUQSST    W0INVL 25        Display File Ad
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     MOVEL'0'       WUFUST           Load Added/Dele
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * If change mode, update control fields with load header info
      * CASE: WRK.Display File Add/Change is Change
     C           WUQSST    IFEQ 'C'                        *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - PD Order Header  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0001  70       Load ID
     C           P2RPNB    PARM P2RPNB    WQ0002  70       Total Load Orde
     C           #CVUNB    PARM #CVUNB    WQ0003 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * ** Add Override Total Load Miles to the parameters   E00207
      * ** Rtv total load miles into total miles field       E00207
      * RTV Load for Load Plan RT - Load Header  * 
     C                     EXSR SARVGN
      * ** If Override TLM are entered, put on the screen, else use TLM
      * CASE: PAR.Override Total Load Miles is Entered
     C           P2K2DT    IFNE *ZERO                      *IF
     C                     Z-ADDP2K2DT    #CTLMI           Total Load Mile
      * ** Highlight the display field if it was replaced
     C                     MOVEL'Y'       P3QKST           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTKNB    #CTLMI           Total Load Mile
     C                     END                             *FI
      * 9/5/2007 slm Populate CTL.Carrier Code
     C                     MOVEL#CR6CD    #2BZNA           Carrier Code
     C                     MOVELWUWRTX    #2FRSX           Shipping Temp C
     C                     Z-ADDP2RPNB    #CVTNB           USR Total Weigh
     C                     MOVEL#CWNST    P1VDST           Load Type
      * carrier:
      * RTV Name, Status       RT - OM Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CR6CD    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CGVTX    P      Name
     C                     MOVELWL0003    WUVSST    P      Record Status
      * broker:
      * RTV Name, Status       RT - OM Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CXCCD    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CADTX    P      Name
     C                     MOVELWL0003    WUVSST    P      Record Status
     C                     Z-ADD#CVTNB    #CASWG           USR Weight
     C                     Z-ADD#CVUNB    #PRQNB           Total Freight
      * ** Retrieve DDD/T if on a load                        W288
      * RTV Deadln DepartDT/TM RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0004           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #CNVDT           Deadline Depart
     C                     Z-ADDWL0006    #CBUTM           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Add mode
     C                     MOVEL'U'       #PPKST           Load Status
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0004  30       Company Number
     C           WUG0TX    PARM *BLANK    WQ0005  2        Shipping Method
     C           #CWNST    PARM *BLANK    WQ0006  1        Load Type Dft
     C           WUG0TX    PARM *BLANK    WQ0007  1        LTL Flag Dft
     C           WUG0TX    PARM *BLANK    WQ0008  1        Export Status D
     C           WUG0TX    PARM *BLANK    WQ0009  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0010  40       Departure Time
     C           WUG0TX    PARM *BLANK    WQ0011  6        Export Code Dft
     C           WUG0TX    PARM *BLANK    WQ0012  1        Allow Mult Whse
     C           WUG0TX    PARM *BLANK    WQ0013  1        Allow Multi Exp
     C           WUG0TX    PARM *BLANK    WQ0014  1        Slip Sheet Dft
     C           WUG0TX    PARM *BLANK    WQ0015  1        Palletize Dft
     C                     PARM *BLANK    WQ0016  1        Plant Company S
     C                     PARM *BLANK    WQ0017  1        Company Organiz
     C                     PARM *BLANK    WQ0018  1        CDI Valuation G
     C                     PARM *BLANK    WQ0019  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0020  2        CDI Shipper
     C                     PARM *BLANK    WQ0021  2        CDI Produced by
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
      * Default rated freight allocation method
      * CASE: CTL.USR Load Type is Regular
     C           #CWNST    IFEQ 'R'                        *IF
     C                     MOVEL'M'       #PXQST           Allocate Pounds
     C                     ELSE
      * CASE: CTL.USR Load Type is Bulk
     C           #CWNST    IFEQ 'B'                        *IF
     C                     MOVEL'T'       #PXQST           Allocate Pounds
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       #PXQST           Allocate Pounds
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * DEFAULT: CTL.USR Warehouse Code & USR Load Type
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CASE: CTL.USR Warehouse Code is Blanks
     C           #CCPCD    IFEQ *BLANK                     *IF
      * Rtv 1st Warehouse     RT - User Application Whs  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * RTV WhsTyp/Ctrl/LdTyp RT - Warehouse  * 
     C                     EXSR SERVGN
     C                     END                             *FI
      * If truck size is blank default it
      * CASE: CTL.USR Truck Size is Not Entered
     C           #CTECD    IFEQ *BLANK                     *IF
      * Set truck default according to load type default
      * CASE: CTL.USR Load Type is Regular
     C           #CWNST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    #CTECD           USR Truck Size
     C                     MOVEL'T'       #CTECD           USR Truck Size
     C                     ELSE
      * CASE: CTL.USR Load Type is Bulk
     C           #CWNST    IFEQ 'B'                        *IF
     C                     MOVEL*BLANK    #CTECD           USR Truck Size
     C                     MOVEL'B'       #CTECD           USR Truck Size
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CTECD    WL0007    P      Truck Size
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    P3RSNB           Maximum pounds
     C                     Z-ADDWL0009    P3TANB           Minimum pounds
      * ** Retrieve Export Info from the Order Header Extension  FP1101 7
      * RTV ExpOrd Info for LD XF - Order Header TRG  * 
     C                     CALL 'PMJMXFR'              90  RTV ExpOrd Info
     C                     PARM *BLANK    W0RTN   7
     C           YL0002    PARM *ZERO     WQ0022  70       Order Number
     C           YL0003    PARM *ZERO     WQ0023  70       Ship To Custome
     C           YL0004    PARM *BLANK    WQ0024 30        Ship To Name
     C           YL0005    PARM *BLANK    WQ0025 30        Ship To Address
     C           YL0006    PARM *BLANK    WQ0026 30        Ship To Address
     C           YL0007    PARM *BLANK    WQ0027 30        Ship To Address
     C           YL0008    PARM *BLANK    WQ0028 20        Ship To City
     C           YL0009    PARM *BLANK    WQ0029  2        Ship To State C
     C           YL0010    PARM *BLANK    WQ0030 11        Ship To Zip/Pos
     C           YL0011    PARM *BLANK    WQ0031  3        Carrier Code
     C                     PARM #2RMNB    WQ0032  70       Load ID
     C           #2U2ST    PARM *BLANK    WQ0033  1        Export Status
     C           YL0012    PARM *BLANK    WQ0034  1        Export Docs Go
     C           YL0013    PARM *BLANK    WQ0035  1        Air Freight Ord
     C           YL0014    PARM *BLANK    WQ0036  2        Export USDA App
     C           YL0015    PARM *ZERO     WQ0037  30       Company Number
     C           YL0016    PARM *ZERO     WQ0038  50       Stop/Drop Seque
     C           #CXACD    PARM *BLANK    WQ0039  3        Shipping Line
     C           #COANA    PARM *BLANK    WQ0040 20        Port Delv Termi
     C           YL0017    PARM *BLANK    WQ0041 25        OHE City
     C           YL0018    PARM *BLANK    WQ0042 30        OHE Vessel/Airl
     C           YL0019    PARM *BLANK    WQ0043 15        OHE Voyage/Flig
     C           YL0020    PARM *BLANK    WQ0044 15        OHE Booking Num
     C           YL0021    PARM *BLANK    WQ0045 20        OHE Discharge P
     C           YL0022    PARM *ZERO     WQ0046  70       OHE Sail/Flight
     C           YL0023    PARM *ZERO     WQ0047  70       OHE Port Cut Da
     C           YL0024    PARM *ZERO     WQ0048  70       OHE Arrival Dat
     C           YL0025    PARM *BLANK    WQ0049  3        OHE Late Delive
     C           YL0026    PARM *BLANK    WQ0050  1        OHE Ship Status
     C           YL0027    PARM *BLANK    WQ0051 12        OHE Container N
     C           YL0028    PARM *BLANK    WQ0052 35        OHE Comment 1
     C           YL0029    PARM *BLANK    WQ0053 75        OHE Comment 2
     C           #2HNNA    PARM *BLANK    WQ0054 25        Port City
     C           YL0030    PARM *BLANK    WQ0055 25        Port Address Li
     C           YL0031    PARM *BLANK    WQ0056 25        Port Address Li
     C           #CV9CD    PARM *BLANK    WQ0057  2        Sail Port State
     C           YL0032    PARM *BLANK    WQ0058 11        Port Zip/Postal
     C           YL0033    PARM *ZERO     WQ0059 110       Port Phone Numb
     C           YL0034    PARM *BLANK    WQ0060 25        Port Fax Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMJMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993138*
     C                     END
      * Edit gross weight
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
     C                     EXSR SGRVGN
     C                     Z-ADDP2DHWG    #CDTWG           Weight Adjust
      * Maximum message
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.Weight Adjust GT PAR.Maximum pounds
      *   |- c2    : PAR.Maximum pounds NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CDTWG    IFGT P3RSNB                     *IF
     C           P3RSNB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Load Weight GT Maximum'
     C                     MOVEL'USR1261' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     Z-ADD#CTENB    P5TENB           USR Stop
     C                     Z-ADD#CBUNB    P3BUNB           USR Weight, 9.0
     C                     Z-ADD#CT4NB    P2T4NB           Schedule Sequen
     C                     MOVEL#CR6CD    P2BZNA           Carrier Code
      * ** Deadline Departure Date/Time Restrictions          W288
      * CASE: PAR.Access Limited Sts USR is yes
     C           P4HHST    IFEQ 'Y'                        *IF
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0068  30       Company Number
     C           WUG0TX    PARM *BLANK    WQ0069  2        Shipping Method
     C           WUG0TX    PARM *BLANK    WQ0070  1        Load Type Dft
     C           WUG0TX    PARM *BLANK    WQ0071  1        LTL Flag Dft
     C           WUG0TX    PARM *BLANK    WQ0072  1        Export Status D
     C           WUG0TX    PARM *BLANK    WQ0073  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0074  40       Departure Time
     C           WUG0TX    PARM *BLANK    WQ0075  6        Export Code Dft
     C           WUG0TX    PARM *BLANK    WQ0076  1        Allow Mult Whse
     C           WUG0TX    PARM *BLANK    WQ0077  1        Allow Multi Exp
     C           WUG0TX    PARM *BLANK    WQ0078  1        Slip Sheet Dft
     C           WUG0TX    PARM *BLANK    WQ0079  1        Palletize Dft
     C                     PARM *BLANK    WQ0080  1        Plant Company S
     C           YL0039    PARM *BLANK    WQ0081  1        Company Organiz
     C                     PARM *BLANK    WQ0082  1        CDI Valuation G
     C                     PARM *BLANK    WQ0083  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0084  2        CDI Shipper
     C                     PARM *BLANK    WQ0085  2        CDI Produced by
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Seaboard only
      * CASE: LCL.Company Organization is Seaboard
     C           YL0039    IFEQ 'S'                        *IF
      * ** Retrieve the hours that Shipping is restricted from loading
      * RTV Dock Unavail Range XF - Warehouse Control  * 
     C                     CALL 'PNNIXFR'              90  RTV Dock Unavai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CVPCD    WQ0086  3        Warehouse Code
     C           WUDPTM    PARM *ZERO     WQ0087  60       Dock Unavail St
     C           WUDQTM    PARM *ZERO     WQ0088  60       Dock Unavail En
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Retrieve Deadline Departure Date/Time from Load Header
      * RTV Deadln DepartDT/TM RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0004           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WUNVDT           Deadline Depart
     C                     Z-ADDWL0006    WUBUTM           Deadline Depart
      * ** Validate if hours are entered for a warehouse
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      *       skip - not an error if no record
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Dock Unavail Start Time is Zeros
      *   |- c2    : WRK.Dock Unavail End Time is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDPTM    IFEQ *ZERO                      *IF
     C           WUDQTM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *       skip - not an error if times are zeros
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If SSD = DDD then enforce Restricted Time Range    W288
      * CASE: WRK.Deadline Depart Date LH EQ CTL.Scheduled Ship Date USR
     C           WUNVDT    IFEQ #CHODT                     *IF
      * ** Error if DDT is during restriced hours             W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Deadline Depart Time LH GE WRK.Dock Unavail Star
      *   |- c2    : WRK.Deadline Depart Time LH LE WRK.Dock Unavail End
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBUTM    IFGE WUDPTM                     *IF
     C           WUBUTM    IFLE WUDQTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Invalid Dt Chg-DDD/T err2'
     C                     MOVEL'USR4223' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
      * Edt Load/Orders        DF - Order Header TRG  * 
     C                     CALL 'PDLTDFR'              90  Edt Load/Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2C4NB    WQ0089  70       Order Number
     C                     PARM #2RMNB    WQ0090  70       Load ID
     C                     PARM #CHODT    WQ0091  70       Scheduled Ship
     C                     PARM WUADTX    WQ0092 30        Name
     C                     PARM P4HHST    WQ0093  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     994131*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Error if date puts DDD/T in the past. Truck will not have
      * ** time to load and leave. Send an error message.
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0094 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0095 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Error if DDD = Today & DDT is before system time   W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Deadline Depart Date LH EQ WRK.Current System Da
      *   |- c2    : WRK.Deadline Depart Time LH LE WRK.Current System Ti
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUNVDT    IFEQ WUSDTE                     *IF
     C           WUBUTM    IFLE WUZHNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Send message 'Invalid Deadln Dt/Tm'
     C                     MOVEL'USR4233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
      * Edt Load/Orders        DF - Order Header TRG  * 
     C                     CALL 'PDLTDFR'              90  Edt Load/Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2C4NB    WQ0096  70       Order Number
     C                     PARM #2RMNB    WQ0097  70       Load ID
     C                     PARM #CHODT    WQ0098  70       Scheduled Ship
     C                     PARM WUADTX    WQ0099 30        Name
     C                     PARM P4HHST    WQ0100  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     994131*
     C                     END
     C                     END                             *FI
      * RTV Deadln DepartDT/TM RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0004           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    #CNVDT           Deadline Depart
     C                     Z-ADDWL0006    #CBUTM           Deadline Depart
     C                     END                             *FI
     C                     END                             *FI
      * If there are orders on load, cannot change load type
      * RTV Chk any ords on Ld RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0014           Load ID
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    P5JDST    P      USR Check Y/N S
      * Can't change to load type/ship mth if locked load (always)
      * CASE: CTL.Load Status is Lock
     C           #PPKST    IFEQ 'L'                        *IF
     C                     MOVEL'Y'       P5JDST           USR Check Y/N S
     C                     END                             *FI
      * CTL.Status Description = Condition name of CTL.Load Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70       List number
     C                     PARM #PPKST    W0INVL 25        Load Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CHKNA    PARM           W0CNNM 25        Status Descript
      *
      * Set CTL stops (first time only)
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     Z-ADD#CHODT    #2AODT           Scheduled Ship
     C                     Z-ADD#CHODT    WUAODT           Scheduled Ship
      * If change mode update CTL Load fields
      * CASE: WRK.Display File Add/Change is Change
     C           WUQSST    IFEQ 'C'                        *IF
     C                     MOVEL#CR6CD    WUR6CD           USR Carrier Cod
     C                     MOVEL#CTECD    WUTECD           USR Truck Size
     C                     MOVEL#CWNST    WUWNST           USR Load Type
     C                     MOVEL#CCUST    WUCUST           USR Shipping Me
     C                     Z-ADD#CT4NB    WUT4NB           Schedule Sequen
     C                     MOVEL#CV9CD    WUV9CD           USR State Code
     C                     END                             *FI
      * CASE: Not from OE & has orders assigned
      *  - c2 AND c3
      *   |- c2    : PAR.USR Check Y/N Status is yes
      *   |- c3    : WRK.USR Assigned This Load is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5JDST    IFEQ 'Y'                        *IF
     C           WUQZST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         #CTENB           USR Stop
     C                     Z-ADD#CTENB    P5TENB           USR Stop
     C                     Z-ADD#CTENB    WUTENB           USR Stop
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD*ZERO     #CJ0VA           USR Order Value
     C                     MOVEL'N'       WUE5ST           USR Output Only
      * Carrier is output only if Locked-Invoiced or a Trailer is on the
      * CASE: CTL.Load Status is Locked thru Invoiced
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'L'
     C           #PPKST    OREQ 'S'
     C                     MOVEL'Y'       WUE5ST           USR Output Only
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Trailer Number     RT - Load Header  * 
     C                     EXSR SJRVGN
      * CASE: WRK.Trailer Id NE WRK.BLANK
     C           WUDXTX    IFNE WUGSTX                     *IF
     C                     MOVEL'Y'       WUE5ST           USR Output Only
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #2HNNA           Ship To City
     C                     MOVEL#CMPT1    #2HNNA           Ship To City
      * check plant
      * CASE: LCL.First time flag 2     USR is Yes
     C           YL0040    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0040           First time flag
      * CASE: CTL.USR Warehouse Code is Warehouse Code Blank
     C           #CCPCD    IFEQ *BLANK                     *IF
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0101  30       Company Number
     C           YL0041    PARM *BLANK    WQ0102  1        Plant Company S
     C           YL0039    PARM *BLANK    WQ0103  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Company Organization is Daily's
     C           YL0039    IFEQ 'D'                        *IF
     C                     MOVELP4AJCD    #CCPCD           USR Warehouse C
     C                     MOVELP4AJCD    WUCPCD           USR Warehouse C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 02/09/09 PKD S00660 Initialize Earliest Deadline Departure Date
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEAODT           Scheduled Ship
     C                     KFLD           BEC4NB           Order Number
     C                     KFLD           BEAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AODT    BEAODT
     C                     Z-ADD#2C4NB    BEC4NB
     C                     Z-ADD#2AIC3    BEAIC3
     C           KPOS      SETLL@BFCPJB
     C                     READ @BFCPJB                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type - Sa
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
     C           *LIKE     DEFN #2U2ST    WZU2ST
     C                     MOVEL#2U2ST    WZU2ST           Export Status
     C           *LIKE     DEFN #2A0DT    WZA0DT
     C                     MOVEL#2A0DT    WZA0DT           Order Date
     C           *LIKE     DEFN #2ACDT    WZACDT
     C                     MOVEL#2ACDT    WZACDT           Cancel Date
     C           *LIKE     DEFN #2AQCD    WZAQCD
     C                     MOVEL#2AQCD    WZAQCD           Terms Code
     C           *LIKE     DEFN #2AATM    WZAATM
     C                     MOVEL#2AATM    WZAATM           Job Time
     C           *LIKE     DEFN #2AYNA    WZAYNA
     C                     MOVEL#2AYNA    WZAYNA           User Id
     C           *LIKE     DEFN #2A0NA    WZA0NA
     C                     MOVEL#2A0NA    WZA0NA           Job Name
     C           *LIKE     DEFN #2AXDT    WZAXDT
     C                     MOVEL#2AXDT    WZAXDT           Job Date
     C           *LIKE     DEFN #2RNNB    WZRNNB
     C                     MOVEL#2RNNB    WZRNNB           Reefer Temperat
     C           *LIKE     DEFN #2A5DT    WZA5DT
     C                     MOVEL#2A5DT    WZA5DT           Requested Ship
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2A1WG    WZA1WG
     C                     MOVEL#2A1WG    WZA1WG           Order Weight To
     C           *LIKE     DEFN #2HNNA    WZHNNA
     C                     MOVEL#2HNNA    WZHNNA           Ship To City
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2BCNA    WZBCNA
     C                     MOVEL#2BCNA    WZBCNA           Customer Purcha
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2FRSX    WZFRSX
     C                     MOVEL#2FRSX    WZFRSX           Shipping Temp C
     C           *LIKE     DEFN #2R1NB    WZR1NB
     C                     MOVEL#2R1NB    WZR1NB           Rated Freight
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2PJST    WZPJST
     C                     MOVEL#2PJST    WZPJST           LTL Flag
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2AFTM    WZAFTM
     C                     MOVEL#2AFTM    WZAFTM           Requested Deliv
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2HNNA    WQHNNA           Ship To City
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 20        WQA5N   50
     C                     PARM #2HNNA    WQHNNA           Ship To City
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPJB                  90*
     C  N82                READ @BFCPJB                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  2
     C                     MOVEAWKIND0    *IN,50
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AATM    IFNE *ZERO                      Job Time
     C           BEAATM    CABNE#2AATM    BB020            Job Time
     C                     END
     C           #2AYNA    IFNE *BLANK                     User Id
     C           BEAYNA    CABNE#2AYNA    BB020            User Id
     C                     END
     C           #2A0NA    IFNE *BLANK                     Job Name
     C           BEA0NA    CABNE#2A0NA    BB020            Job Name
     C                     END
     C           #2AXDT    IFNE *ZERO                      Job Date
     C           BEAXDT    CABNE#2AXDT    BB020            Job Date
     C                     END
     C           #2RNNB    IFNE *ZERO                      Reefer Temperat
     C           BERNNB    CABNE#2RNNB    BB020            Reefer Temperat
     C                     END
     C           #2A5DT    IFNE *ZERO                      Requested Ship
     C           BEA5DT    CABNE#2A5DT    BB020            Requested Ship
     C                     END
     C           #2A1WG    IFNE *ZERO                      Order Weight To
     C           BEA1WG    CABGT#2A1WG    BB020            Order Weight To
     C                     END
     C           #2HNNA    IFNE *BLANK                     Ship To City
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           BEHNNA           Ship To City
      * Length
     C                     PARM 20        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQHNNA
      * Length
     C                     PARM 20        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           BEQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
     C           #2GWST    IFNE *BLANK                     Header Status
     C           BEGWST    CABNE#2GWST    BB020            Header Status
     C                     END
     C           #2BCNA    IFNE *BLANK                     Customer Purcha
     C           BEBCNA    CABNE#2BCNA    BB020            Customer Purcha
     C                     END
     C           #2FRSX    IFNE *BLANK                     Shipping Temp C
     C           BEFRSX    CABNE#2FRSX    BB020            Shipping Temp C
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           BEC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2PJST    IFNE *BLANK                     LTL Flag
     C           BEPJST    CABNE#2PJST    BB020            LTL Flag
     C                     END
     C           #2AFTM    IFNE *ZERO                      Requested Deliv
     C           BEAFTM    CABNE#2AFTM    BB020            Requested Deliv
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Setoff indicator 48 - /UT User Source  * 
     C                     SETOF                     48    SETOFF INDICATO
     C                     MOVEL'N'       #RE6ST           USR Status (Y/N
      * RCD.Month/Day Display     USR = DB1.Requested Delivery Date
     C                     Z-ADDBEEIDT    #RMDDI           Month/Day Displ
      * If add mode only bring in orders that aren't assigned to loads
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Display File Add/Change is Add
      *   |- c2    : DB1.Load ID is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUQSST    IFEQ 'A'                        *IF
     C           BERMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
      * If change bring in orders that aren't assigned, and orders for th
      * CASE: WRK.Display File Add/Change is Change
     C           WUQSST    IFEQ 'C'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Load ID is Blank
      *   |- c2    : CTL.Load ID EQ DB1.Load ID
      *   '-
     C           BERMNB    IFEQ *ZERO                      *IF
     C           #2RMNB    OREQ BERMNB                     *OR
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * RMC --9/26/07 save to test that one order exists with the load st
      * CASE:
      *  - c2 AND c1
      *   |- c2    : RCD.Company Number EQ CTL.Company Number
      *   |- c1    : WRK.Status Flag 3  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AIC3    IFEQ #2AIC3                     *IF
     C           WUQ3ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUQ3ST           Status Flag 3
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Exclude if Order is Confirmed, Complete, or Cancelled
      * CASE: DB1.Header Status is Conf/Comp/Canc
     C           BEGWST    IFEQ 'X'                        *IF
     C           BEGWST    OREQ 'C'
     C           BEGWST    OREQ 'R'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Exclude orders set to "Non Load"
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Load Plan Order is no
      *   |- c2    : DB1.Load ID is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEU4ST    IFEQ 'N'                        *IF
     C           BERMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Exclude orders whose load types don't match existing load type
      * CASE: CTL.USR Load Type is Bulk & Regular
     C           #CWNST    IFEQ 'B'                        *IF
     C           #CWNST    OREQ 'R'
      * CASE: DB1.Load Type NE CTL.USR Load Type
     C           BEVDST    IFNE #CWNST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Exclude Block Orders
      * CASE: DB1.Block Order Flag is Block Order
     C           BEBCST    IFEQ 'B'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * ALWAYS select orders on load
      * CASE: DB1.Load ID EQ CTL.Load ID
     C           BERMNB    IFEQ #2RMNB                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
      * If record is selected, retv. stop #
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * If order Load ID is not zero, retrieve stop number
      * CASE: DB1.Load ID is NE Blank
     C           BERMNB    IFNE *ZERO                      *IF
      * RTV Stop Number       RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0016           Load ID
     C                     Z-ADD#1C4NB    WL0018           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    #RTENB           Stop/Drop
     C                     Z-ADDWL0019    WUNFNN           Appointment Con
     C                     Z-ADDWL0020    WUNFNN           Appointment Con
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         #RTENB           USR Stop
     C                     END                             *FI
      * RTV Region for State   RT - Region Definition  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      * If control stop is entered, select stop GE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.USR Stop is Entered
      *   |- c2    : RCD.USR Stop LT CTL.USR Stop
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CTENB    IFNE *ZERO                      *IF
     C           #RTENB    IFLT #CTENB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     Z-ADDBEA1WG    #RYGNX           USR Weight, 5.0
      * If control weight is entered, select only weight LE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.USR Weight, 5.0 is NE Zeros
      *   |- c2    : RCD.USR Weight, 5.0 GT CTL.USR Weight, 5.0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CYGNX    IFNE *ZERO                      *IF
     C           #RYGNX    IFGT #CYGNX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If control region code is entered, then select regions equal to
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Region Code is Entered
      *   |- c2    : RCD.Region Code NE CTL.Region Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CV1CD    IFNE *BLANK                     *IF
     C           #RV1CD    IFNE #CV1CD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * RTV 1st Warehouse      RT - Order Detail  * 
     C                     EXSR SMRVGN
      * E01488 RMC 5/19/11 rtv appt cnfm flds
      * RTV OHE Appt Cnfrm fld XF - Order Header Extension  * 
     C                     CALL 'PNXQXFR'              90  RTV OHE Appt Cn
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0104  30       Company Number
     C                     PARM #1C4NB    WQ0105  70       Order Number
     C           #RV5T1    PARM *BLANK    WQ0106 10        OHE Appt Confir
     C           #RWBT1    PARM *BLANK    WQ0107 30        OHE Appt Confir
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNXQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Select Warehouse  TRF011  7/27/06
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.USR Warehouse Code is Warehouse Code not Blank
      *   |- c2    : CTL.USR Warehouse Code NE RCD.Warehouse Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CCPCD    IFNE *BLANK                     *IF
     C           #CCPCD    IFNE #RAJCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select ship to state code PKTR01 8/4/04
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Ship To State Code NE CTL.Ship To State Code
      *   |- c2    : CTL.Ship To State Code is State code not Blanks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEDBCD    IFNE #2DBCD                     *IF
     C           #2DBCD    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * If live with tpm, domestic only..,,. then only select INTL orders
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Live with TPM is Yes
      *   |- c2    : LCL.PFS AccuSort Active is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0042    IFEQ 'Y'                        *IF
     C           YL0043    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Type              RT - Order Header Extension  * 
     C                     EXSR SNRVGN
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.OHE Override Type Code is ES
      *   |- c2    : RCD.Load ID EQ CTL.Load ID
      *   '-
     C           YL0044    IFEQ 'ES'                       *IF
     C           #1RMNB    OREQ #2RMNB                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #RLSNA           USR Picked
      * record selected - additional checks
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV State Description  RT - State  * 
     C                     EXSR SORVGN
      * RTV Check Pick Event   RT - OP Order Events  * 
     C                     EXSR SPRVGN
      * If Order has been picked, then mark as picked
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL@CN,002   #RLSNA           USR Picked
     C                     END                             *FI
      * Issue error message if order on load, but no stop
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * If order Load ID is not zero, retrieve stop number
      * CASE: DB1.Load ID is NE Blank
     C           BERMNB    IFNE *ZERO                      *IF
      * CASE: RCD.USR Stop is Entered
     C           #RTENB    IFNE *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#RTENB    ZA0003           USR Stop
      * Send message 'Stop Must be Entered'
     C                     MOVEL'USR1263' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9851  *
      *
     C                     MOVEL'1'       *IN84            *Re-read Subfil
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Issue error message if load type on existing order <> ctl load ty
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Load Type NE CTL.USR Load Type
      *   |- c2    : DB1.Load ID EQ CTL.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEVDST    IFNE #CWNST                     *IF
     C           BERMNB    IFEQ #2RMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order load type NE Load'
     C                     MOVEL'USR1876' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #RR4ST           USR Update Flag
      * Load up stop customer array
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.USR Stop NE WRK.ZERO
      *   |- c2    : PGM.*Record selected is *YES
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RTENB    IFNE WUW0NB                     *IF
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CRT Load Plan Stop Cst CR - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RTENB    WL0021           Stop/Drop
     C                     Z-ADD#1BKC7    WL0022           Ship To Custome
     C                     EXSR SQCRRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
     C                     MOVEL*BLANK    #RB7SX           Must Ship Error
      * -----------------------------------------------------------------
      * C7111: If we do not want to allow stop changes from this program,
      *     a) comment the following code.
     C                     Z-ADD#RTENB    #RRVNB           Stop/Drop
      * C7111: End ------------------------------------------------------
      * SFL Fold/Drop  RPG 2  US - /UT User Source  * 
     C           MODE      IFEQ '0'
     C                     SETON                     89
     C                     ELSE
     C                     SETOF                     89
     C                     ENDIF
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPJB                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate USR Load Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CWNST'  IFEQ YPMTFD
      * USR Load Type
     C                     MOVEL#CWNST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFWNST
     C                     SELEC
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD1         ZFWNST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD2         ZFWNST
     C                     ENDSL
     C                     EXFMTZEWNST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFWNST    WHEQ 1
     C                     MOVEL'B'       W0INVL           B
     C           ZFWNST    WHEQ 2
     C                     MOVEL'R'       W0INVL           R
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CWNST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate USR Shipping Method
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CCUST'  IFEQ YPMTFD
      * USR Shipping Method
     C                     MOVEL#CCUST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFCUST
     C                     SELEC
     C           W0INVL    WHEQ 'CR'                       CR
     C                     Z-ADD1         ZFCUST
     C           W0INVL    WHEQ 'CT'                       CT
     C                     Z-ADD2         ZFCUST
     C           W0INVL    WHEQ 'PR'                       PR
     C                     Z-ADD3         ZFCUST
     C           W0INVL    WHEQ 'PT'                       PT
     C                     Z-ADD4         ZFCUST
     C                     ENDSL
     C                     EXFMTZECUST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFCUST    WHEQ 1
     C                     MOVEL'CR'      W0INVL           CR
     C           ZFCUST    WHEQ 2
     C                     MOVEL'CT'      W0INVL           CT
     C           ZFCUST    WHEQ 3
     C                     MOVEL'PR'      W0INVL           PR
     C           ZFCUST    WHEQ 4
     C                     MOVEL'PT'      W0INVL           PT
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CCUST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate LTL Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2PJST'  IFEQ YPMTFD
      * LTL Flag
     C                     MOVEL#2PJST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFPJST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZFPJST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZFPJST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZFPJST
     C                     ENDSL
     C                     EXFMTZEPJST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFPJST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFPJST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZFPJST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2PJST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9945  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * Must enter load # if auto numbering = no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Auto Load Numbering? is No
      *   |- c2    : WRK.Display File Add/Change is Add
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3PNST    IFEQ 'N'                        *IF
     C           WUQSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: CTL.Load ID is Blank
     C           #2RMNB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0005           Load ID
      * Send message 'Auto load # not in effect'
     C                     MOVEL'USR1249' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Load Exist        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0023           Load ID
     C                     EXSR SRRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0006           Load ID
      * Send message 'Load ID already exists'
     C                     MOVEL'USR1251' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Prompt processing
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * Carrier
      * CASE: PGM.*Cursor field <IS> CTL.USR Carrier Code
     C           W0CFL     IFEQ '#CR6CD'                   *IF
      * SEL Active Carrier     SR - OM Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #CR6CD    PARM #CR6CD    WQ0108  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
      * usr warehouse code TRF011
      * CASE: PGM.*Cursor field <IS> CTL.USR Warehouse Code
     C           W0CFL     IFEQ '#CCPCD'                   *IF
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Sel User Appl Whs     SR - User Application Whs  * 
     C                     CALL 'PNMMSRR'              90  Sel User Appl W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0109 10        User Profile Na
     C                     PARM 'TRF'     WQ0110  6        Application Cod
     C           #CCPCD    PARM #CCPCD    WQ0111  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9942  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #CCPCD    PARM #CCPCD    WQ0112  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9942  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Ship to Customer
      * CASE: PGM.*Cursor field <IS> CTL.Ship To Customer
     C           W0CFL     IFEQ 'V2BKC7'                   *IF
      * SEL Cust/ShpTo Flag 'Y'SR - Customer  * 
     C                     CALL 'PDYSSRR'              90  SEL Cust/ShpTo
     C                     PARM *BLANK    W0RTN   7
     C           #2BKC7    PARM #2BKC7    WQ0113  70       Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9946  *
     C                     END
     C                     END                             *FI
      * Ship to State (Selector field for subfile)
      * CASE: PGM.*Cursor field <IS> CTL.Ship To State Code
     C           W0CFL     IFEQ '#2DBCD'                   *IF
      * SEL State              SR - State  * 
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #2DBCD    PARM #2DBCD    WQ0114  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9948  *
     C                     END
     C                     END                             *FI
      * Carrier broker
      * CASE: PGM.*Cursor field <IS> CTL.Carrier Broker
     C           W0CFL     IFEQ '#CXCCD'                   *IF
      * SEL Active Carrier     SR - OM Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #CXCCD    PARM #CXCCD    WQ0115  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     END                             *FI
      * Truck size
      * CASE: PGM.*Cursor field <IS> CTL.USR Truck Size
     C           W0CFL     IFEQ '#CTECD'                   *IF
      * SEL Truck Size Active  SR - OM Truck Size  * 
     C                     CALL 'PDEPSRR'              90  SEL Truck Size
     C                     PARM *BLANK    W0RTN   7
     C           #CTECD    PARM #CTECD    WQ0116  7        Truck Size
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     END                             *FI
      * Ship to State (displayed in the control record)
      * CASE: PGM.*Cursor field <IS> CTL.USR State Code
     C           W0CFL     IFEQ '#CV9CD'                   *IF
      * SEL State              SR - State  * 
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #CV9CD    PARM #CV9CD    WQ0117  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9938  *
     C                     END
     C                     END                             *FI
      * Region code
      * CASE: PGM.*Cursor field <IS> CTL.Region Code
     C           W0CFL     IFEQ '#CV1CD'                   *IF
      * SEL Active Region      SR - PD Region  * 
     C                     CALL 'PDDOSRR'              90  SEL Active Regi
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0118  30       Company Number
     C           #CV1CD    PARM #CV1CD    WQ0119  4        Region Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9944  *
     C                     END
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Validate usr warehouse  TFS011      7/27/06 RMC
      * CASE: CTL.USR Warehouse Code is Warehouse Code not Blank
     C           #CCPCD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CCPCD    WL0024    P      Warehouse Code
     C                     EXSR SSRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#CCPCD    ZA0007           USR Warehouse C
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate truck size
      * CASE: CTL.USR Truck Size is Entered
     C           #CTECD    IFNE *BLANK                     *IF
      * Val Truck Size        RT - OM Truck Size  * 
     C                     EXSR STRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#CTECD    ZA0008           USR Truck Size
      * Send message 'Truck size doesn't exists'
     C                     MOVEL'USR1254' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#CTECD    ZA0009           USR Truck Size
     C                     Z-ADD#2RMNB    ZA0010           Load ID
      * Send message 'Truck size must be enter'
     C                     MOVEL'USR1255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993431*
      *
     C                     END                             *FI
      * Validate ship to state (selector for subfile)
      * CASE: CTL.Ship To State Code NE WRK.BLANK
     C           #2DBCD    IFNE WUGSTX                     *IF
      * RTV Validate State Cd  RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2DBCD    WL0025    P      State Code
     C                     EXSR SURVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#2DBCD    ZA0011           Ship To State C
      * Send message 'State file not found'
     C                     MOVEL'USR1838' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9948  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate usr ship to state (displayed in control record)
      * CASE: CTL.USR State Code NE WRK.BLANK
     C           #CV9CD    IFNE WUGSTX                     *IF
      * RTV Validate State Cd  RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CV9CD    WL0025    P      State Code
     C                     EXSR SURVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#CV9CD    ZA0012           USR State Code
      * Send message 'State file not found'
     C                     MOVEL'USR1838' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate region code
      * CASE: CTL.Region Code is Entered
     C           #CV1CD    IFNE *BLANK                     *IF
      * VAL Active Region      RT - PD Region  * 
     C                     EXSR SVRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0013           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0013           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#CV1CD    ZA0014           Region Code
      * Send message 'PD Region not found'
     C                     MOVEL'USR2225' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Load type cannot be blank
      * CASE: CTL.USR Load Type is Blank
     C           #CWNST    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CWNST    ZA0015           USR Load Type
      * Send message 'Load Type Must be Entered'
     C                     MOVEL'USR1813' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     Z-ADD#CHODT    P1AODT           Scheduled Ship
     C                     MOVEL*BLANK    WUQZST           USR Assigned Th
      * If carrier is entered and broker is not defaul broker
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.USR Carrier Code is entered
      *   |- c2    : CTL.Carrier Broker is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CR6CD    IFNE *BLANK                     *IF
     C           #CXCCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL#CR6CD    #CXCCD           Carrier Broker
     C                     END                             *FI
      * Validate carrier broker
      * CASE: CTL.Carrier Broker is entered
     C           #CXCCD    IFNE *BLANK                     *IF
      * Val Carrier           RT - OM Carrier  * 
     C                     EXSR SWRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#CXCCD    ZA0016           Carrier Broker
      * Send message 'Carrier broker not found'
     C                     MOVEL'USR2428' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * carrier:
      * RTV Name, Status       RT - OM Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CR6CD    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CGVTX    P      Name
     C                     MOVELWL0003    WUVSST    P      Record Status
      * broker:
      * RTV Name, Status       RT - OM Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CXCCD    WL0001    P      Carrier Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CADTX    P      Name
     C                     MOVELWL0003    WUVSST    P      Record Status
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZPJST    CASNE#2PJST    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C           WZDBCD    CASNE#2DBCD    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * 11/04/09 PKD E00519 Access by Warehouse
      * VAL: CTL.USR Warehouse Code
      * CASE: LCL.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CASE: CTL.USR Warehouse Code is Blanks
     C           #CCPCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CCPCD    ZA0017           USR Warehouse C
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Val Warehouse         IF
      * VAL: Warehouse Code
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CASE: PAR.Warehouse Code is Blanks
     C           #CCPCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CCPCD    ZA0018           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0120 10        User Profile Na
     C                     PARM 'TRF'     WQ0121  6        Application Cod
     C                     PARM #CCPCD    WQ0122  3        Warehouse Code
     C                     PARM *ZERO     WQ0123  70       Item Code
     C           YL0045    PARM *BLANK    WQ0124  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9942  *
     C                     END
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0045    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0019           *USER
     C                     MOVEL#CCPCD    ZA0020           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code is Not Blanks
     C           #CCPCD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CCPCD    WL0024    P      Warehouse Code
     C                     EXSR SSRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#CCPCD    ZA0021           Warehouse Code
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL#CCUST    P2Q2CD           Shipping Method
      * Reload if CTL positioners/selectors changed
      * CASE: CTL.Order Number NE WRK.Order Number
     C           #2C4NB    IFNE WUC4NB                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.USR Warehouse Code NE WRK.USR Warehouse Code
     C           #CCPCD    IFNE WUCPCD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.USR Stop NE WRK.USR Stop
     C           #CTENB    IFNE WUTENB                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Scheduled Ship Date NE WRK.Scheduled Ship Date
     C           #2AODT    IFNE WUAODT                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.USR Weight, 5.0 NE WRK.USR Weight, 5.0
     C           #CYGNX    IFNE WUYGNX                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.LTL Flag NE PAR.LTL Flag
     C           #2PJST    IFNE P1PJST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Region Code NE WRK.Region Code
     C           #CV1CD    IFNE WUV1CD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Reefer Temperature NE WRK.Reefer Temperature
     C           #2RNNB    IFNE WURNNB                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Header Status NE WRK.Header Status
     C           #2GWST    IFNE WUGWST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Shipping Method NE WRK.Shipping Method
     C           #2Q2CD    IFNE WUQ2CD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Ship To Customer NE WRK.Ship To Customer
     C           #2BKC7    IFNE WUBKC7                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Ship To State Code NE WRK.Ship To State Code
     C           #2DBCD    IFNE WUDBCD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.Customer Purchase Order # NE WRK.Customer Purchase Orde
     C           #2BCNA    IFNE WUBCNA                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: CTL.City 11 USR NE CTL.Ship To City
     C           #CMPT1    IFNE #2HNNA                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update "last" ctl fields
     C                     EXSR UBSUBR                     Update "last" c
      * Reconfirm if Load Control fields change
      * CASE: CTL.USR Carrier Code NE WRK.USR Carrier Code
     C           #CR6CD    IFNE WUR6CD                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: CTL.Carrier Broker NE WRK.Carrier Broker
     C           #CXCCD    IFNE WUXCCD                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: CTL.USR Truck Size NE WRK.USR Truck Size
     C           #CTECD    IFNE WUTECD                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: CTL.USR Load Type NE WRK.USR Load Type
     C           #CWNST    IFNE WUWNST                     *IF
      * oms132:  default to Pounds for Bulk loads, Miles for regular load
      * Default rated freight allocation method
      * CASE: CTL.USR Load Type is Regular
     C           #CWNST    IFEQ 'R'                        *IF
     C                     MOVEL'M'       #PXQST           Allocate Pounds
     C                     ELSE
      * CASE: CTL.USR Load Type is Bulk
     C           #CWNST    IFEQ 'B'                        *IF
     C                     MOVEL'T'       #PXQST           Allocate Pounds
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       #PXQST           Allocate Pounds
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: CTL.USR Shipping Method NE WRK.USR Shipping Method
     C           #CCUST    IFNE WUCUST                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: CTL.Schedule Sequence Number NE WRK.Schedule Sequence Numbe
     C           #CT4NB    IFNE WUT4NB                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: CTL.Total Load Miles NE WRK.Total Load Miles
     C           #CTLMI    IFNE WUTLMI                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: CTL.USR State Code NE WRK.USR State Code
     C           #CV9CD    IFNE WUV9CD                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: CTL.Flat Amount NE LCL.Flat Amount
     C           #PFLAM    IFNE YL0046                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Update "last" ctl load fields
     C                     EXSR UCSUBR                     Update "last" c
      * Reset total weight, total freight and temp
     C                     Z-ADD#PRQNB    #CVUNB           USR Total Freig
     C                     Z-ADD#CVTNB    #CASWG           USR Weight
     C                     Z-ADD*ZERO     P2DIWG           Trailer OUT Wei
      * Reset gross weight
     C                     Z-ADD#CDTWG    P5DTWG           Weight Adjust
      * F15=If lock load request, check for errors ><
      * CASE: CTL.*CMD key is *Lock Load
     C           *IN15     IFEQ '1'                        *IF
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0026           Load ID
     C                     MOVELWUBCST    WL0028    P      Block Order Fla
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0027    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0028    WUBCST    P      Block Order Fla
      * ** Don't allow lock if errors pending in Order Detail   P001251
      *
     C                     Z-ADD*ZERO     WN0001  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0002  70       Minimum pounds
     C                     MOVEL*BLANK    WN0003  1        USR Orders on L
     C                     MOVEL*BLANK    WN0004  1        Order in Use
     C                     MOVEL*BLANK    WN0005  1        Header Status
     C                     MOVEL*BLANK    WN0006  1        Access Denied (
      *
      * EDT Lock Load Edits    IF
      * assume will have error
     C                     MOVEL'Y'       WUECST           Error Status
      *
     C                     MOVEL*BLANK    WN0007 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0007           User Profile Na
      *
     C                     MOVEL*BLANK    WN0008 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0007    WL0029    P      User Profile Na
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUG0TX    P      Allow Multi-Com
     C                     MOVELWL0031    WUG0TX    P      Default Printer
     C                     MOVELWL0032    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0033    YL0047           Company Number
     C                     MOVELWL0034    WN0008    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0008    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0007    WL0035    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0036    P      Application Cod
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    WUAIC3           Company Number
     C                     MOVELWL0038    YL0048    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0008    WL0035    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0036    P      Application Cod
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    WUAIC3           Company Number
     C                     MOVELWL0038    YL0048    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0048    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0047    IFGT 0                          *IF
     C                     Z-ADDYL0047    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0048    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0049    WL0040           Shipping Compan
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0006           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0041           Company Number
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    WUG0TX    P      Name
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0006    IFEQ 'Y'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
     C                     EXSR TCRVGN
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0022           Load ID
     C                     MOVELWUSEL     ZA0023           *SFLSEL
      * Send message 'No Orders Assigned'
     C                     MOVEL'USR1276' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           WUBCST    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0024           *SFLSEL
     C                     Z-ADD#2RMNB    ZA0025           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'L'
     C           #PPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVELWUSEL     ZA0026           *SFLSEL
     C                     Z-ADD#2RMNB    ZA0027           Load ID
      * Send message 'Load Cant be Locked'
     C                     MOVEL'USR2189' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.Carrier Code EQ WRK.BLANK
     C           #CR6CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#CR6CD    ZA0028           Carrier Code
     C                     Z-ADD#2RMNB    ZA0029           Load ID
      * Send message 'Carrier must be entered'
     C                     MOVEL'USR1253' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993231*
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           #CTECD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#CTECD    ZA0030           Truck Size
     C                     Z-ADD#2RMNB    ZA0031           Load ID
      * Send message 'Truck size must be enter'
     C                     MOVEL'USR1255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993431*
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           #CCUST    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#CCUST    ZA0032           Shipping Method
      * Send message 'Shipping Method required'
     C                     MOVEL'USR2197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0003    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0033           Load ID
      * Send message 'Load has orders w/o stop'
     C                     MOVEL'USR2196' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           #CRMST    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0034           Load ID
      * Send message 'Load is not accepted'
     C                     MOVEL'USR2514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - OP Order Header  * 
     C                     EXSR TDRVGN
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0005    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0035           Load ID
     C                     MOVELWUSEL     ZA0036           *SFLSEL
      * Send message 'Load has Orders on Hold'
     C                     MOVEL'USR1921' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0005    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0037           Load ID
     C                     MOVELWUSEL     ZA0038           *SFLSEL
      * Send message 'Load has Cancelled Orders'
     C                     MOVEL'USR2236' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0004    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0039           *SFLSEL
     C                     Z-ADD#2RMNB    ZA0040           Load ID
      * Send message 'Load has Orders in Use'
     C                     MOVEL'USR2280' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Check if Export Order Automation Upload had errors  P001251
      * RTV Ord Requires Revw RT - Order Header TRG  * 
     C                     EXSR TERVGN
      * ** Cannot lock if Upload had errors                  P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0050    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0041           *SFLSEL
     C                     Z-ADD#2RMNB    ZA0042           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CTECD    WL0007    P      Truck Size
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    WN0001           Maximum pounds
     C                     Z-ADDWL0009    WN0002           Minimum pounds
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           #CVTNB    IFLT WN0002                     *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0043           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           #CVTNB    IFGT WN0001                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
      * CASE: WRK.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * F16=If unlock load request, check for errors ><
      * CASE: CTL.*CMD key is *Unlock Load
     C           *IN16     IFEQ '1'                        *IF
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0026           Load ID
     C                     MOVELWUBCST    WL0028    P      Block Order Fla
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0027    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0028    WUBCST    P      Block Order Fla
      * RMC PFs017 new par Allow Unlock if Picked = N
      *
     C                     MOVEL*BLANK    WN0009  1        Access Denied (
      *
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       WUECST           Error Status
      *
     C                     MOVEL*BLANK    WN0010 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0010           User Profile Na
      *
     C                     MOVEL*BLANK    WN0011 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0010    WL0029    P      User Profile Na
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUG0TX    P      Allow Multi-Com
     C                     MOVELWL0031    WUG0TX    P      Default Printer
     C                     MOVELWL0032    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0033    YL0047           Company Number
     C                     MOVELWL0034    WN0011    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0011    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0010    WL0035    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0036    P      Application Cod
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    WUAIC3           Company Number
     C                     MOVELWL0038    YL0048    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0011    WL0035    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0036    P      Application Cod
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    WUAIC3           Company Number
     C                     MOVELWL0038    YL0048    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0048    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0047    IFGT 0                          *IF
     C                     Z-ADDYL0047    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0048    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0049    WL0040           Shipping Compan
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0009           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0041           Company Number
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    WUG0TX    P      Name
     C                     END                             *FI
      * check the entry control field too.  4/28/05 so christa can do.
      * Rtv Unlock Load Authr RT - Entry Control  * 
     C                     EXSR TFRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : WRK.Unlock Load Authority is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0009    IFEQ 'Y'                        *IF
     C           WUHTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't unlock. RMC Chg for picked 5/31/0
      * CASE: PAR.Block Order Flag is Block Order
     C           WUBCST    IFEQ 'B'                        *IF
      *   (load contains a block order)
      * Setup message data for message
     C                     MOVELWUSEL     ZA0044           *SFLSEL
     C                     Z-ADD#2RMNB    ZA0045           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#PPKST    ZA0046           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Do this one if par is NO. We dont want an UNLOCK if there are XOx
      *   and it isnt shipping doing it.
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0125  70       Load ID
     C                     PARM #2AIC3    WQ0126  30       Company Number
     C           WUZMST    PARM WUZMST    WQ0127  1        Pick Status USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0043           PFS Load ID
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WUZMST    P      Pick Status USR
     C                     END                             *FI
      * Allow if picked but not Close Order or Close Truck  5/31/06
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#PPKST    ZA0047           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Close Ord/Trk XF - PFS Ship Load/Order Sts  * 
     C                     CALL 'PPYIXFR'              90  PFS Val Close O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0128  70       Load ID
     C           WUB8ST    PARM *BLANK    WQ0129  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0048           *SFLSEL
      * Send message 'Unlock Inval, close exist'
     C                     MOVEL'USR3629' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * F18 = Rated Freight, If freight recovery request, check for error
      * CASE: CTL.*CMD key is *Freight Recovery
     C           *IN18     IFEQ '1'                        *IF
      * Load must be locked
      * CASE: CTL.Load Status is Not Locked
     C           #PPKST    IFEQ 'E'                        *IF
     C           #PPKST    OREQ 'S'
     C           #PPKST    OREQ 'U'
     C           #PPKST    OREQ 'C'
     C           #PPKST    OREQ 'I'
      * Setup message data for message
     C                     MOVEL#PPKST    ZA0049           Load Status
      * Send message 'Freight Recover not Allow'
     C                     MOVEL'USR1285' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: CTL.USR State Code EQ WRK.BLANK
     C           #CV9CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#CV9CD    ZA0050           USR State Code
      * Send message 'Ship to State required'
     C                     MOVEL'USR2229' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Calc freight using miles on the screen (CTL)   E00207
      * EDT Calc Rated Freight ET - Load Header  * 
     C                     CALL 'PDYLETR'              90  EDT Calc Rated
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0130  70       Load ID
     C                     PARM P2RPNB    WQ0131  70       Total Load Orde
     C           #PFLAM    PARM #PFLAM    WQ0132 112       Flat Amount
     C           #PXQST    PARM #PXQST    WQ0133  1        Allocate Pounds
     C                     PARM #CR6CD    WQ0134  3        Carrier Code
     C           #2R1NB    PARM #2R1NB    WQ0135 112       Rated Freight
     C           #CTLMI    PARM #CTLMI    WQ0136  70       Total Load Mile
     C                     PARM #CVPCD    WQ0137  3        Ship From Wareh
     C                     PARM #CV9CD    WQ0138  2        Ship To State C
     C                     PARM #CXCCD    WQ0139  3        Carrier Broker
     C           P2K2DT    PARM P2K2DT    WQ0140  70       Override Total
     C                     PARM #CGVTX    WQ0141 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYLETR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993139*
     C                     SETON                     323833*
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Carrier
      * CASE: CTL.USR Carrier Code is entered
     C           #CR6CD    IFNE *BLANK                     *IF
      * Val Carrier Active     RT - OM Carrier  * 
     C                     EXSR THRVGN
      * Record not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#CR6CD    ZA0051           USR Carrier Cod
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Can Rated Frt be calc'd for carrier        RMC TRF011 7/27/
      * CASE: CTL.USR Carrier Code is entered
     C           #CR6CD    IFNE *BLANK                     *IF
      * only if it changed                  RMC 9/14/06
      * CASE: CTL.USR Carrier Code NE CTL.Carrier Code
     C           #CR6CD    IFNE #2BZNA                     *IF
      * TPA 09/18/07  PAR.Carrier Code Changed to CTL Carrier Code
      * TPA 09/20/07  Skip Rated Freight check if Flat Rate entered or
      * if the Carrier Code is Buyer's truck
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Flat Amount is GT Zero
      *   |- c2    : CTL.USR Carrier Code is Buyer's Truck
      *   '-
     C           #PFLAM    IFGT *ZERO                      *IF
     C           #CR6CD    OREQ 'BUY'                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Override TLM will be in CTL context if it was entered
      * ** use saved miles since function selects the correct field
      * Clc Rated Freight     XF - Load Header  * 
     C                     CALL 'PLAFXFR'              90  Clc Rated Freig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0142  70       Load ID
     C                     PARM #CR6CD    WQ0143  3        Carrier Code
     C                     PARM #CTLMI    WQ0144  70       Total Load Mile
     C                     PARM #CVPCD    WQ0145  3        Ship From Wareh
     C                     PARM #CV9CD    WQ0146  2        Ship To State C
     C                     PARM #CXCCD    WQ0147  3        Carrier Broker
     C                     PARM #CXACD    WQ0148  3        Shipping Line
     C                     PARM #COANA    WQ0149 20        Port Delv Termi
     C                     PARM P2K2DT    WQ0150  70       Override Total
     C           YL0051    PARM YL0051    WQ0151 114       Unused Mile Rat
     C           YL0052    PARM YL0052    WQ0152  1        Status Flag 1
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLAFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     SETON                     3833  *
     C                     END
      * Chk Status instead of Mile Rate 1             RMC 01/23/07 TRF015
      * CASE: LCL.Status Flag 1  Y/N is No
     C           YL0052    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     MOVEL#CR6CD    ZA0052           USR Carrier Cod
      * Send message 'Rated Frt cant be calc'd'
     C                     MOVEL'USR3646' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       WUSGST           USR Input 1
     C                     MOVEL'N'       WUSHST           USR Input 2
      * RTV Del All Stop Custs RT - *Arrays  * 
     C                     EXSR TIRVGN
      * F20=Add Traffic Comments
      * CASE: CTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
      * EDT PD Traffic Comment EF - PD Traffic Comments  * 
     C                     CALL 'PDCZEFR'              90  EDT PD Traffic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0153  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCZEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * If add mode, make confirm yes
      * CASE: PAR.Load ID EQ WRK.ZERO
     C           P1RMNB    IFEQ WUW0NB                     *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
      * set confirm to yes so can create header without adding orders
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
     C                     ADD  P2DIWG    #CASWG           USR Weight
     C           1         MULT #CASWG    #CVTNB    H      USR Total Weigh
     C           1         MULT P5DTWG    #CDTWG           Weight Adjust
      * PK0302 Perform Max Sched Ship Wt edit if flag is Y & Shp mth = Tr
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : LCL.Max Schd Shp Wt Edit Flg is Yes
      *   |- c2    : CTL.Shipping Method is Not Rail
      *   |- c3    : PAR.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0053    IFEQ 'Y'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #2Q2CD    IFEQ 'CT'                       *IF
     C           #2Q2CD    OREQ 'PT'
     C           P2Q2CD    OREQ 'CT'                       *OR
     C           P2Q2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: LCL.Order Weight Assigned is Greater than zero
     C           YL0054    IFGT *ZERO                      *IF
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0154  30       Company Number
     C           WUG0TX    PARM *BLANK    WQ0155  2        Shipping Method
     C           WUG0TX    PARM *BLANK    WQ0156  1        Load Type Dft
     C           WUG0TX    PARM *BLANK    WQ0157  1        LTL Flag Dft
     C           WUG0TX    PARM *BLANK    WQ0158  1        Export Status D
     C           WUG0TX    PARM *BLANK    WQ0159  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0160  40       Departure Time
     C           WUG0TX    PARM *BLANK    WQ0161  6        Export Code Dft
     C           WUG0TX    PARM *BLANK    WQ0162  1        Allow Mult Whse
     C           WUG0TX    PARM *BLANK    WQ0163  1        Allow Multi Exp
     C           WUG0TX    PARM *BLANK    WQ0164  1        Slip Sheet Dft
     C           WUG0TX    PARM *BLANK    WQ0165  1        Palletize Dft
     C                     PARM *BLANK    WQ0166  1        Plant Company S
     C           YL0039    PARM *BLANK    WQ0167  1        Company Organiz
     C                     PARM *BLANK    WQ0168  1        CDI Valuation G
     C                     PARM *BLANK    WQ0169  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0170  2        CDI Shipper
     C                     PARM *BLANK    WQ0171  2        CDI Produced by
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Add Date Validations, parms to Sel Sched Lds Cnfrm  E001895
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Seaboard
      *   |- c2    : WRK.Display File Add/Change is Add
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0039    IFEQ 'S'                        *IF
     C           WUQSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Sched Loads Cnfrm  PV - Load Header  * 
     C                     CALL 'POJSPVR'              90  SEL Sched Loads
     C                     PARM *BLANK    W0RTN   7
     C           YL0055    PARM YL0055    WQ0172  1        Status - Y or N
     C                     PARM #2RMNB    WQ0173  70       Load ID
     C                     PARM YL0056    WQ0174  70       Scheduled Ship
     C                     PARM P3NVDT    WQ0175  70       Deadline Depart
     C           WUN7CD    PARM WUN7CD    WQ0176  1        USR Return Code
     C           YL0057    PARM YL0057    WQ0177  70       Scheduled Ship
     C                     PARM YL0054    WQ0178 112       Order Weight As
     C                     PARM YL0058    WQ0179  3        Warehouse Code
     C                     PARM YL0059    WQ0180  2        Warehouse Type
     C           YL0060    PARM YL0060    WQ0181  2        Slot Type f/New
     C                     PARM YL0061    WQ0182 112       Boxes Total Qua
     C                     PARM P1EIDT    WQ0183  70       Req Delivery Da
     C                     PARM #2C4NB    WQ0184  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POJSPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993141*
     C                     END
     C                     END                             *FI
      * CASE: WRK.USR Return Code is Exists
     C           WUN7CD    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C                     MOVEL'N'       WUTIST           USR Display 1
     C                     MOVEL'N'       WUSGST           USR Input 1
     C                     MOVEL'N'       W0RSF            *Reload subfile
      * Send message 'Assign Load Cancelled'
     C                     MOVEL'USR3038' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL*BLANK    WUECST           Error Status
     C                     MOVEL'Y'       WUSGST           USR Input 1
      * Determine if dates are in correct order on load
      * CASE: CTL.Shipping Method is Buyers Truck
     C           #2Q2CD    IFEQ 'CR'                       *IF
     C           #2Q2CD    OREQ 'CT'
     C                     ELSE
      * CASE: LCL.Scheduled Ship Date USR is Entered
     C           YL0057    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUT3CD           Warehouse Code
      * CLC Must Ship/Load     XF - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADD#2RMNB    PARMNB           Load ID
     C                     Z-ADD#2C4NB    PAC4NB           Order Number
      *
     C                     CALL 'PMQAXFR'              90  CLC Must Ship/L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
     C           WUB7SX    PARM *BLANK    WQ0185  3        Must Ship Error
     C           P4AJCD    PARM P4AJCD    WQ0186  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMQAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993141*
     C                     END
      * CASE: WRK.Must Ship Error is No Error
     C           WUB7SX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Skip Daily's and High Plains Biodiesel
      * CASE: LCL.Company Organization is Seaboard
     C           YL0039    IFEQ 'S'                        *IF
      * Display program will log the deadline errors
      * DSP Must Ship Err/Load DF - Load Detail  * 
     C                     CLEARPBRC
     C                     Z-ADD#2RMNB    PBRMNB           Load ID
      *
     C                     CALL 'PDMBDFR'              90  DSP Must Ship E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Load Detai
     C                     PARM YL0057    WQ0187  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMBDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'N'       WUSTYN           USR Exit Progra
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       YL0062           First Order Ass
     C                     END                             *FI
     C                     END                             *FI
      * RMC 9/26/07 - Order not on load matching load start co
      * CASE: WRK.Status Flag 3  Y/N is No
     C           WUQ3ST    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0053           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0053           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Order nf matching ld strt'
     C                     MOVEL'USR3403' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Min/Max messages
      * CASE: CTL.USR Truck Size NE WRK.BLANK
     C           #CTECD    IFNE WUGSTX                     *IF
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#CTECD    WL0007    P      Truck Size
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    P3RSNB           Maximum pounds
     C                     Z-ADDWL0009    P3TANB           Minimum pounds
      * If load weight > max, send message
      * CASE: CTL.Weight Adjust GT PAR.Maximum pounds
     C           #CDTWG    IFGT P3RSNB                     *IF
      * Send message 'Load Weight GT Maximum'
     C                     MOVEL'USR1261' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * If load weight < min, send message
      * CASE: CTL.Weight Adjust LT PAR.Minimum pounds
     C           #CDTWG    IFLT P3TANB                     *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0054           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Assign load msg
      * CASE: WRK.USR Input 1 is Yes
     C           WUSGST    IFEQ 'Y'                        *IF
      * Send message 'Assign load pending'
     C                     MOVEL'USR1258' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * delete load msg
      * CASE: WRK.USR Input 2 is Yes
     C           WUSHST    IFEQ 'Y'                        *IF
      * Send message 'Delete From Load Pend'
     C                     MOVEL'USR1265' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Change Stop Number
      * CASE: WRK.USR Input 3 is Yes
     C           WUHZSX    IFEQ 'Y'                        *IF
      * Send message 'Stop Chg On Ld Pending'
     C                     MOVEL'USR2913' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Check that load id is entered
      * CASE: CTL.Load ID EQ WRK.ZERO
     C           #2RMNB    IFEQ WUW0NB                     *IF
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0055           Load ID
      * Send message 'Value Required (numeric)'
     C                     MOVEL'USR1962' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * SFL Fold/Drop  RPG 2  US - /UT User Source  * 
     C           MODE      IFEQ '0'
     C                     SETON                     89
     C                     ELSE
     C                     SETOF                     89
     C                     ENDIF
      * F5=Refresh
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,50
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * ****** get fresh order information ******
      * RTV All Header Fields  RT - PD Order Header  * 
     C                     EXSR TKRVGN
      * *************************************'***
      * PK0302 --Set Fields to null on for Sched Wt Exceeded processing
      * CASE: LCL.First Order Assigned is yes
     C           YL0062    IFEQ 'Y'                        *IF
     C                     MOVELWUXKTX    YL0063           LSSA Load Slot
     C                     MOVELWUXKTX    YL0058           Warehouse Code
     C                     MOVELWUXKTX    YL0059           Warehouse Type
     C                     Z-ADD*ZERO     YL0054           Order Weight As
     C                     MOVEL'N'       YL0062           First Order Ass
     C                     END                             *FI
      * CASE: RCD.*SFLSEL is *Assign to Load
     C           #1SEL     IFEQ '1'                        *IF
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0188  30       Company Number
     C           YL0041    PARM *BLANK    WQ0189  1        Plant Company S
     C           YL0039    PARM *BLANK    WQ0190  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Determining that order can arrive on time  (chg 9/24/09 E00495)
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.USR Shipping Method is Prepaid
      *   |- c2    : LCL.Company Organization is Seaboard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CCUST    IFEQ 'PR'                       *IF
     C           #CCUST    OREQ 'PT'
     C           YL0039    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** This is only done for Seaboard Customers (skip Dailys & High P
      * ** the first stop; If not, use Deadline DD/T; and if that is also
      * ** blanks then use Sched Ship Date                    E00495
      * RTV Deadln DepartDT/TM RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0004           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WUHDDT           Deadline Depart
     C                     Z-ADDWL0006    WUAUTM           Deadline Depart
      * Deadline Departure Date not found.
      * CASE: WRK.Deadline Depart DT    HDR is not entered
     C           WUHDDT    IFEQ *ZERO                      *IF
     C                     Z-ADD#1AODT    WUHDDT           Deadline Depart
      * CASE: RCD.Scheduled Ship Date EQ JOB.*Job date
     C           #1AODT    IFEQ ##JDT                      *IF
     C                     Z-ADD##JTM     WUAUTM           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD240000    WUAUTM           Deadline Depart
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve the full city name to pass to the clc pgm    FP1251
      * RTV Ship To City/State RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0045           Company Number
     C                     Z-ADD#1C4NB    WL0046           Order Number
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    WUGUNA    P      Ship To City
     C                     MOVELWL0048    YN0009    P      Ship To State C
     C                     MOVEL*BLANK    WUT3CD           Warehouse Code
      * ** Miles to Next record not found added as an error  FP1251  11/1
      * ** Conver 6.0 time to 4.0
      * CLC Must Ship Date     XF - Order Header TRG  * 
     C                     CALL 'PDJBXFR'              90  CLC Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C           WUB7SX    PARM *BLANK    WQ0191  3        Must Ship Error
     C                     PARM #1C4NB    WQ0192  70       Order Number
     C                     PARM #1A5DT    WQ0193  70       Requested Ship
     C                     PARM WUGUNA    WQ0194 20        Ship To City
     C                     PARM #1DBCD    WQ0195  2        Ship To State C
     C                     PARM #1AIC3    WQ0196  30       Company Number
     C                     PARM #1RMNB    WQ0197  70       Load ID
     C                     PARM #1AFTM    WQ0198  40       Requested Deliv
     C                     PARM #1AODT    WQ0199  70       Scheduled Ship
     C                     PARM #1EIDT    WQ0200  70       Requested Deliv
     C           WUT3CD    PARM WUT3CD    WQ0201  3        Warehouse Code
     C           WULYDT    PARM WULYDT    WQ0202  70       Must Ship Date
     C           WUA5TM    PARM WUA5TM    WQ0203  60       Must Ship Time
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Process date order error
      * CASE:
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : WRK.Must Ship Error is No Error
      *   |- c2    : WRK.Must Ship Error is Req Ship should =Must Shp
      *   |- c3    : LCL.Company Organization is Not Seaboard
      *   |- c4    : WRK.Must Ship Error is Miles to Next=Zeros
      *   '-
     C           WUB7SX    IFEQ *BLANK                     *IF
     C           WUB7SX    OREQ 'RSD'                      *OR
     C           YL0039    OREQ 'D'                        *OR
     C           YL0039    OREQ 'H'
     C           WUB7SX    OREQ 'MTN'                      *OR
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     MOVEL*BLANK    WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUTIST           USR Display 1
     C                     MOVEL'Y'       WUECST           Error Status
      * Setup message data for message
     C                     Z-ADD#RTENB    ZA0056           USR Stop
      * Send message 'This order cannot arrive'
     C                     MOVEL'USR2688' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9851  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If assign to load request, display pending message
      * CASE: RCD.*SFLSEL is *Assign to Load
     C           #1SEL     IFEQ '1'                        *IF
      * Check for errors
      * CASE: CTL.Load Status is Locked thru Invoiced
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'L'
     C           #PPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#PPKST    ZA0057           Load Status
     C                     Z-ADD#RTENB    ZA0058           USR Stop
      * Send message 'Load Locked Can't Change'
     C                     MOVEL'USR1268' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9851  *
      *
     C                     ELSE
      * CASE: RCD.USR Stop is Not Entered
     C           #RTENB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#RTENB    ZA0059           USR Stop
      * Send message 'Stop # not entered'
     C                     MOVEL'USR1256' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9851  *
      *
     C                     ELSE
      * CASE: RCD.Load ID EQ CTL.Load ID
     C           #1RMNB    IFEQ #2RMNB                     *IF
      * Send message 'Order Already Assigned'
     C                     MOVEL'USR1267' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: Order assigned to another load
      *  - c1 AND c2
      *   |- c1    : RCD.Load ID NE CTL.Load ID
      *   |- c2    : RCD.Load ID NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RMNB    IFNE #2RMNB                     *IF
     C           #1RMNB    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0060           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0061           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0061           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order assigned another ld'
     C                     MOVEL'USR2281' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9850  *
      *
     C                     ELSE
      * CASE: RCD.Load Type NE CTL.USR Load Type
     C           #1VDST    IFNE #CWNST                     *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0062           *SFLSEL
     C                     Z-ADD#RTENB    ZA0063           USR Stop
      * Send message 'Load Type Mismatch'
     C                     MOVEL'USR1867' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     985051*
      *
     C                     ELSE
      * CASE: Shipping method mismatch
      *  - c1 AND c2
      *   |- c1    : PAR.Shipping Method NE WRK.BLANK
      *   |- c2    : PAR.Shipping Method NE RCD.Shipping Method
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2Q2CD    IFNE WUGSTX                     *IF
     C           P2Q2CD    IFNE #1Q2CD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0064           *SFLSEL
      * Send message 'Shipping Method mismatch'
     C                     MOVEL'USR2227' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9850  *
      *
     C                     ELSE
      * CASE: RCD.Order in Use is yes
     C           #1GJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0065           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0066           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0066           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9850  *
      *
     C                     ELSE
      * CASE: Order sched ship date must eq load sched ship dt
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date is entered
      *   |- c2    : PAR.Scheduled Ship Date NE RCD.Scheduled Ship Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AODT    IFNE *ZERO                      *IF
     C           P1AODT    IFNE #1AODT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0067           *SFLSEL
      * Send message 'Ord Schd Shp Dt NE LD Shp'
     C                     MOVEL'USR2330' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9850  *
      *
     C                     ELSE
      * CASE: WRK.STATUS is No
     C           WUATUS    IFEQ 'N'                        *IF
      * message already sent; this will keep subfile from reloading
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUECST           Error Status
      * RTV Stop Customer      RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0049           Load ID
     C                     Z-ADD#RTENB    WL0050           Stop/Drop
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0051    WUAJNB           Customer Number
      * Only 1 customer per stop allowed
      * CASE: Existing Cust on Stop not = RCD Customer
      *  - c2 AND c1
      *   |- c2    : WRK.Customer Number       NBR is not equal 0
      *   |- c1    : WRK.Customer Number       NBR NE RCD.Ship To Custome
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAJNB    IFNE *ZERO                      *IF
     C           WUAJNB    IFNE #1BKC7                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0068           *SFLSEL
      * Send message 'Customer mismatch'
     C                     MOVEL'USR1853' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9850  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     ELSE
      * CASE: WRK.Customer Number       NBR EQ WRK.ZERO
     C           WUAJNB    IFEQ WUW0NB                     *IF
      * RTV Stop Customer      RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RTENB    WL0052           Stop/Drop
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WUAJNB           Ship To Custome
      * Error if customer mismatch
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Customer Number       NBR NE WRK.ZERO
      *   |- c2    : WRK.Customer Number       NBR NE RCD.Ship To Custome
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAJNB    IFNE WUW0NB                     *IF
     C           WUAJNB    IFNE #1BKC7                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0069           *SFLSEL
      * Send message 'Customer mismatch'
     C                     MOVEL'USR1853' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9850  *
      *
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PK0302 Gather Data to perform Max Sched Ship Wt edit if flag is Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Max Schd Shp Wt Edit Flg is Yes
      *   |- c2    : RCD.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0053    IFEQ 'Y'                        *IF
     C           #1Q2CD    IFEQ 'CT'                       *IF
     C           #1Q2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     YL0064           Boxes Day 1 Qua
      * RTV UM/Whs Code Lmt,Bx RT - Order Detail  * 
     C                     EXSR TPRVGN
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR TRRVGN
      * Fresh Orders on a Load make the Load FRESH.
      * CASE: WRK.Warehouse Type Assigned is Fresh
     C           WUJFSX    IFEQ 'FR'                       *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Warehouse Type Assigned is Frozen
      *   |- c2    : LCL.Warehouse Type Assigned is Equal blank
      *   '-
     C           YL0059    IFEQ 'FZ'                       *IF
     C           YL0059    OREQ *BLANK                     *OR
     C                     MOVELWUJFSX    YL0059           Warehouse Type
     C                     MOVELWUCBAA    YL0058           Warehouse Code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Warehouse Type Assigned is Equal blank
     C           YL0059    IFEQ *BLANK                     *IF
     C                     MOVELWUJFSX    YL0059           Warehouse Type
     C                     MOVELWUCBAA    YL0058           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  #1A1WG    YL0054           Order Weight As
     C                     ADD  YL0064    YL0061           Boxes Total Qua
      * Clc Load Slot Type    IF
      * RMC E2706 9/11/13- No more MX, if MX and boxqty<BOXLOAD Comp valu
      *    then CB Else BX
      * Set UM based on Orders to be assgnd- Priority- CB,EX,BX,MX
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Slot Type f/New Ords USR is Combo
      *   |- c2    : PAR.Slot Type f/load USR is Combo
      *   |- c3    : PAR.Slot Type f/load USR EQ WRK.Blank 6 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0060    IFEQ 'CB'                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0067    IFEQ 'CB'                       *IF
     C           YL0067    OREQ WUXKTX                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'CB'      YL0067           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : PAR.Slot Type f/New Ords USR is Export
      *   |- c2    : PAR.Slot Type f/load USR is Export
      *   |- c3    : PAR.Export Status is yes
      *   '-
     C           YL0060    IFEQ 'EX'                       *IF
     C           YL0067    OREQ 'EX'                       *OR
     C           #1U2ST    OREQ 'Y'                        *OR
     C                     MOVEL'EX'      YL0067           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Slot Type f/New Ords USR is Box
      *   |- c2    : PAR.Slot Type f/load USR is Box
      *   |- c3    : PAR.Slot Type f/load USR EQ WRK.Blank 6 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0060    IFEQ 'BX'                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0067    IFEQ 'BX'                       *IF
     C           YL0067    OREQ WUXKTX                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'BX'      YL0067           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      YL0067           Slot Type f/loa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Slot Type f/load USR is Mixed
     C           YL0067    IFEQ 'MX'                       *IF
      *
     C                     MOVEL*BLANK    WN0012 10        User Code Model
      *
      * RTV Default Co No App IF
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0029    P      User Profile Na
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    YN0010    P      Allow Multi-Com
     C                     MOVELWL0031    YN0011    P      Default Printer
     C                     MOVELWL0032    YN0012    P      Salesperson Cod
     C                     Z-ADDWL0033    YL0069           Company Number
     C                     MOVELWL0034    WN0012    P      User Code Model
      * CASE: LCL.Company Number is Equal to zero
     C           YL0069    IFEQ 0                          *IF
      * CASE: PAR.User Code Model is equal to blank
     C           WN0012    IFEQ *BLANK                     *IF
      * RTV First Default Co  RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0057    P      User Profile Na
     C                     EXSR TSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0058    YL0068           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV First Default Co  RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0057    P      User Profile Na
     C                     EXSR TSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0058    YL0068           Company Number
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0069    YL0068           Company Number
     C                     END                             *FI
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0068    WL0054           Company Number
     C                     MOVEL'BOXLOAD' WL0055    P      Company Value C
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0056    YL0070           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0061    IFLT YL0070                     *IF
     C                     MOVEL'CB'      YL0067           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0067           Slot Type f/loa
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1AODT    YL0056           Scheduled Ship
     C                     END                             *FI
      * RMC --9/26/05 save to test that one order exists with the load st
      * CASE:
      *  - c2 AND c1
      *   |- c2    : RCD.Company Number EQ CTL.Company Number
      *   |- c1    : WRK.Status Flag 3  Y/N is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AIC3    IFEQ #2AIC3                     *IF
     C           WUQ3ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUQ3ST           Status Flag 3
     C                     END                             *FI
      * OMS315: C4121  Must Ship Date edit:  Sched Ship <= Must Ship <= D
      * CASE: RCD.Shipping Method is Prepaid
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
     C                     MOVEL*BLANK    WUT3CD           Warehouse Code
     C                     MOVEL*BLANK    WUATUS           STATUS
      * pk0302  Move proposed changed ship date to WRK context for valida
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Status Flag 4  Y/N is yes
      *   |- c2    : LCL.Scheduled Ship Date USR is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0055    IFEQ 'Y'                        *IF
     C           YL0057    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0057    WUJEDT           Date From
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AODT    WUJEDT           Date From
     C                     END                             *FI
      * ** Retrieve full city name to pass to the CLC Must Ship routine
      * RTV Ship To City/State RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0045           Company Number
     C                     Z-ADD#1C4NB    WL0046           Order Number
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    WUGUNA    P      Ship To City
     C                     MOVELWL0048    YN0009    P      Ship To State C
      * CLC Must Ship Date     XF - Order Header TRG  * 
     C                     CALL 'PDJBXFR'              90  CLC Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C           #RB7SX    PARM *BLANK    WQ0204  3        Must Ship Error
     C                     PARM #1C4NB    WQ0205  70       Order Number
     C                     PARM #1A5DT    WQ0206  70       Requested Ship
     C                     PARM WUGUNA    WQ0207 20        Ship To City
     C                     PARM #1DBCD    WQ0208  2        Ship To State C
     C                     PARM #1AIC3    WQ0209  30       Company Number
     C                     PARM #1RMNB    WQ0210  70       Load ID
     C                     PARM #1AFTM    WQ0211  40       Requested Deliv
     C                     PARM WUJEDT    WQ0212  70       Scheduled Ship
     C                     PARM #1EIDT    WQ0213  70       Requested Deliv
     C           WUT3CD    PARM WUT3CD    WQ0214  3        Warehouse Code
     C           WULYDT    PARM WULYDT    WQ0215  70       Must Ship Date
     C           WUA5TM    PARM WUA5TM    WQ0216  60       Must Ship Time
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Error if no Mileage Between Cities record  FP1251 LJB 11/15/20
      * Can order be delivered on time?
      * CASE: RCD.Must Ship Error is No Error
     C           #RB7SX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: RCD.Must Ship Error is Miles to Next=Zeros
     C           #RB7SX    IFEQ 'MTN'                      *IF
     C                     ELSE
      * CASE: RCD.Must Ship Error is Req Ship should =Must Shp
     C           #RB7SX    IFEQ 'RSD'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Don't test unless Seaboard
      * CASE: LCL.Company Organization is Seaboard
     C           YL0039    IFEQ 'S'                        *IF
      * PMT Must Ship Dt Accpt IF - Order Header TRG  * 
     C                     EXSR TTINFN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUATUS           STATUS
     C                     END                             *FI
      * CASE: WRK.Error Status is blank
     C           WUECST    IFEQ *BLANK                     *IF
      * calc abs frt rate (usr percent%) for later calculations
      * CASE: RCD.USR Update Flag is No
     C           #RR4ST    IFEQ *BLANK                     *IF
     C                     ADD  #1A1WG    P2DIWG           Trailer OUT Wei
     C           #1TBNB    DIV  100       WUBHPC    H      USR Percent Wor
     C                     MOVEL'Y'       #RR4ST           USR Update Flag
     C                     Z-ADD*ZERO     P5CDWG           USR Weight Accu
     C                     END                             *FI
      * Fill in shipping method for load
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           P2Q2CD    IFEQ WUGSTX                     *IF
     C                     MOVEL#1Q2CD    P2Q2CD           Shipping Method
     C                     END                             *FI
      * Fill in scheduled ship date for load
      * CASE: PAR.Scheduled Ship Date EQ WRK.ZERO
     C           P1AODT    IFEQ WUW0NB                     *IF
     C                     Z-ADD#1AODT    P1AODT           Scheduled Ship
     C                     END                             *FI
      * CRT Load Plan Stop Cst CR - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RTENB    WL0021           Stop/Drop
     C                     Z-ADD#1BKC7    WL0022           Ship To Custome
     C                     EXSR SQCRRC
      * calc freight amt based on % of total weight
     C           #1A1WG    MULT WUBHPC    WUDLVA    H      USR Freight Amo
     C                     ADD  WUDLVA    #CVUNB           USR Total Freig
     C                     Z-ADD*ZERO     #2R1NB           Rated Freight
     C                     MOVEL'Y'       WUSGST           USR Input 1
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If delete from load request, display pending message
      * CASE: RCD.*SFLSEL is *Delete from Load
     C           #1SEL     IFEQ '4'                        *IF
     C                     Z-ADD#RTENB    P9LMNB           Hold Stop/Drop
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0043           PFS Load ID
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0044    WUZMST    P      Pick Status USR
      * If load is locked, don't allow delete
      * CASE: CTL.Load Status is Locked thru Invoiced
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'L'
     C           #PPKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#PPKST    ZA0071           Load Status
     C                     Z-ADD#RTENB    ZA0072           USR Stop
      * Send message 'Load Locked Can't Delete'
     C                     MOVEL'USR1269' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9851  *
      *
     C                     ELSE
      * CASE: RCD.Order in Use is yes
     C           #1GJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0073           *SFLSEL
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0074           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0074           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order in use detail'
     C                     MOVEL'USR0664' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9850  *
      *
     C                     ELSE
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * Load may have a Picked order & be unlocked, so check this sts RMC
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0075           *SFLSEL
      * Send message 'Invalid option f/picked o'
     C                     MOVEL'USR3633' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9850  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Stop Number       RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0016           Load ID
     C                     Z-ADD#1C4NB    WL0018           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    WURVNB           Stop/Drop
     C                     Z-ADDWL0019    WUNFNN           Appointment Con
     C                     Z-ADDWL0020    WUNFNN           Appointment Con
      * If order is not assigned to load, will not allow delete
      * CASE: RCD.Load ID NE CTL.Load ID
     C           #1RMNB    IFNE #2RMNB                     *IF
      * Setup message data for message
     C                     Z-ADD#RTENB    ZA0076           USR Stop
      * Send message 'Order Not Assign to Load'
     C                     MOVEL'USR1264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9851  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.USR Update Flag is No
     C           #RR4ST    IFEQ *BLANK                     *IF
     C                     SUB  #1A1WG    P2DIWG           Trailer OUT Wei
     C           #1TBNB    DIV  100       WUBHPC    H      USR Percent Wor
     C                     MOVEL'Y'       #RR4ST           USR Update Flag
     C                     Z-ADD*ZERO     P5CDWG           USR Weight Accu
     C                     END                             *FI
     C                     Z-ADD*ZERO     #RTENB           USR Stop
     C           #1A1WG    MULT WUBHPC    WUDLVA    H      USR Freight Amo
     C                     SUB  WUDLVA    #CVUNB           USR Total Freig
     C                     Z-ADD*ZERO     #2R1NB           Rated Freight
     C                     MOVEL'Y'       WUSHST           USR Input 2
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * -----------------------------------------------------------------
      * C7111: If we do not want to allow stop changes from this program,
      *     a) comment the following code.
      * CASE: RCD.*SFLSEL is *Reset to blank
     C           #1SEL     IFEQ *BLANK                     *IF
      * Process update stop (order assigned to load thru order entry)
      * CASE: RCD.USR Stop NE RCD.Stop/Drop
     C           #RTENB    IFNE #RRVNB                     *IF
     C                     MOVEL*BLANK    WUHZSX           USR Input 3
     C                     MOVEL'N'       WUTUST           Error Status  2
      * CASE: RCD.Load ID NE CTL.Load ID
     C           #1RMNB    IFNE #2RMNB                     *IF
      * Setup message data for message
     C                     Z-ADD#RTENB    ZA0077           USR Stop
      * Send message 'Order Not Assign to Load'
     C                     MOVEL'USR1264' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9851  *
      *
     C                     MOVEL'Y'       WUTUST           Error Status  2
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Stop Customer      RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0049           Load ID
     C                     Z-ADD#RTENB    WL0050           Stop/Drop
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0051    WUAJNB           Customer Number
      * Only 1 customer per stop allowed
      * CASE: Existing Cust on Stop not = RCD Customer
      *  - c2 AND c1
      *   |- c2    : WRK.Customer Number       NBR is not equal 0
      *   |- c1    : WRK.Customer Number       NBR NE RCD.Ship To Custome
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAJNB    IFNE *ZERO                      *IF
     C           WUAJNB    IFNE #1BKC7                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0078           *SFLSEL
      * Send message 'Customer Mismatch Inf'
     C                     MOVEL'USR2920' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: WRK.Customer Number       NBR EQ WRK.ZERO
     C           WUAJNB    IFEQ WUW0NB                     *IF
      * RTV Stop Customer      RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RTENB    WL0052           Stop/Drop
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WUAJNB           Ship To Custome
      * Error if customer mismatch
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Customer Number       NBR NE WRK.ZERO
      *   |- c2    : WRK.Customer Number       NBR NE RCD.Ship To Custome
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUAJNB    IFNE WUW0NB                     *IF
     C           WUAJNB    IFNE #1BKC7                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0079           *SFLSEL
      * Send message 'Customer Mismatch Inf'
     C                     MOVEL'USR2920' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Error Status  2 is No
     C           WUTUST    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       WUHZSX           USR Input 3
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * C7111: End ------------------------------------------------------
      * 5=Process view order request
      * CASE: RCD.*SFLSEL is *View Order
     C           #1SEL     IFEQ '5'                        *IF
      * Dsp Order Header       PV - PD Order Header  * 
     C                     CALL 'OMB5PVR'              90  Dsp Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0225  30       Company Number
     C                     PARM #1C4NB    WQ0226  70       Order Number
     C                     PARM #1BCNA    WQ0227 15        Customer Purcha
     C                     PARM #1CXDT    WQ0228  70       Date of Origina
     C                     PARM #1AFTM    WQ0229  40       Requested Deliv
     C                     PARM 'TRF'     WQ0230  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMB5PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 8=Process view order Detail
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
     C                     MOVEL*BLANK    P4DNCD           Application Cod
     C                     MOVEL'O/M'     P4DNCD           Application Cod
      * DSP Ord Inquiry Detail DF - PD Order Detail  * 
     C                     CALL 'PDPZDFR'              90  DSP Ord Inquiry
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0231  30       Company Number
     C                     PARM #1C4NB    WQ0232  70       Order Number
     C           WUDPNB    PARM *ZERO     WQ0233  30       Order Sequence
     C           WUUENB    PARM *ZERO     WQ0234  30       Order Secondary
     C           P4DNCD    PARM P4DNCD    WQ0235  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPZDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Stop required if on a load
      * CASE: Assigned to load, but no stop entered
      *  - c1 AND c2
      *   |- c1    : RCD.Load ID is NE Blank
      *   |- c2    : RCD.USR Stop is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RMNB    IFNE *ZERO                      *IF
     C           #RTENB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Stop not required if deleting from load
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#RTENB    ZA0080           USR Stop
      * Send message 'Stop Must be Entered'
     C                     MOVEL'USR1263' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9851  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * USER: Process subfile control (Post-confirm)
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Set load status to unlock if is E or C
      * CASE: CTL.Load Status is Entered or Combined
     C           #PPKST    IFEQ 'E'                        *IF
     C           #PPKST    OREQ 'C'
     C                     MOVEL'U'       #PPKST           Load Status
     C                     END                             *FI
      * Fill shipping method
      * CASE: CTL.USR Shipping Method EQ WRK.BLANK
     C           #CCUST    IFEQ WUGSTX                     *IF
     C                     MOVELP2Q2CD    #CCUST           USR Shipping Me
     C                     ELSE
      * CASE: CTL.USR Shipping Method is Collect
     C           #CCUST    IFEQ 'CR'                       *IF
     C           #CCUST    OREQ 'CT'
     C                     MOVEL'BUY'     #CR6CD           USR Carrier Cod
     C                     END                             *FI
     C                     END                             *FI
      * VAL Load Exist        RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0023           Load ID
     C                     EXSR SRRVGN
      * 9/4/2007 Slm FP1061 - WEB030 TRF-Misc Requests for WEB Page Chang
      *   If the Carrier code is being changed, add an entry to the log f
      * Add or change load header
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * CASE: LCL.Company Organization is Seaboard
     C           YL0039    IFEQ 'S'                        *IF
      * ** Default Shag & Wash to "NO" for collect, else "Yes"   E00495
      * CASE: CTL.USR Shipping Method is Collect
     C           #CCUST    IFEQ 'CR'                       *IF
     C           #CCUST    OREQ 'CT'
     C                     MOVEL'N'       WULSHG           Load Shag Flag
     C                     MOVEL'N'       WUYPST           Load Wash Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WULSHG           Load Shag Flag
     C                     MOVEL'Y'       WUYPST           Load Wash Flag
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WULSHG           Load Shag Flag
     C                     MOVEL'N'       WUYPST           Load Wash Flag
     C                     END                             *FI
      * CRT Load Header        CR - Load Header  * 
     C                     EXSR TUCRRC
      * 9/5/2007 slm On an add move the ctl.usr carrier code
      *              to ctl.carrier code
     C                     MOVEL#CR6CD    #2BZNA           Carrier Code
     C                     MOVEL'Y'       YL0071           Load Create Sts
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Update Total Load Miles with wrk.total miles
      * ** Update Override Total Load Miles with PAR context        E0020
      * Calc Load U/M     -- RMC added here for all loads 4/17/14 (not ju
     C                     EXSR UFSUBR                     Calc Load U/M
      * CHG For Load Planning  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0059           Load ID
     C                     Z-ADD#2AIC3    WL0060           Company Number
     C                     Z-ADD#CHODT    WL0061           Scheduled Ship
     C                     MOVELWUPJST    WL0062    P      LTL Flag
     C                     MOVEL#PPKST    WL0063    P      Load Status
     C                     Z-ADD#CPCNX    WL0064           Reefer Temperat
     C                     Z-ADD#CVTNB    WL0065           Total Load Orde
     C                     Z-ADD#PFLAM    WL0066           Flat Amount
     C                     MOVEL#PXQST    WL0067    P      Allocate Pounds
     C                     Z-ADDWURRNB    WL0068           Total Stops
     C                     MOVEL#CR6CD    WL0069    P      Carrier Code
     C                     MOVEL#CTECD    WL0070    P      Truck Size
     C                     Z-ADD#2R1NB    WL0071           Rated Freight
     C                     MOVEL#CWNST    WL0072    P      Load Type
     C                     Z-ADD#CT4NB    WL0073           Schedule Sequen
     C                     Z-ADDWUTKNB    WL0074           Total Load Mile
     C                     MOVEL#CCUST    WL0075    P      Shipping Method
     C                     MOVEL#CVPCD    WL0076    P      Ship From Wareh
     C                     MOVEL#CV9CD    WL0077    P      Ship To State C
     C                     MOVEL#CXCCD    WL0078    P      Carrier Broker
     C                     MOVEL#2U2ST    WL0079    P      Export Status
     C                     Z-ADDP2K2DT    WL0080           Override Total
     C                     MOVEL#2FRSX    WL0081    P      Shipping Temp C
     C                     MOVELWURVSX    WL0082    P      Multi Company L
     C                     MOVELYL0072    WL0083    P      Load U/M
     C                     EXSR TVCHRC
      * CASE: CTL.USR Carrier Code NE CTL.Carrier Code
     C           #CR6CD    IFNE #2BZNA                     *IF
      * 9/5/2007 SLM Following statements new for Chg in Carrier
     C                     MOVEL*BLANK    YL0073           Change Log Prio
     C                     MOVEL*BLANK    YL0074           Change Log New
     C                     MOVEL*BLANK    YL0073           Change Log Prio
     C                     MOVEL#2BZNA    YL0073           Change Log Prio
     C                     MOVEL*BLANK    YL0074           Change Log New
     C                     MOVEL#CR6CD    YL0074           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
     C                     Z-ADD#PRVNB    PCRVNB           Stop/Drop
     C                     MOVEL'CARCHG'  PCRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PCUJST    P      Department Cont
     C                     MOVELYL0073    PCMNTX    P      Change Log Prio
     C                     MOVELYL0074    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#CR6CD    PCBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PCAIC3           Company Number
     C                     Z-ADD*ZERO     PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
     C                     MOVEL#CR6CD    #2BZNA           Carrier Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#CVUNB    #PRQNB           Total Freight
     C                     Z-ADD#CT4NB    P2T4NB           Schedule Sequen
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
      * E2625 RMC 10/4/13 added so daily loads created here have req delv
      * CASE: LCL.Company Organization is Daily's
     C           YL0039    IFEQ 'D'                        *IF
      * CASE: CTL.Requested Delivery Date is not entered
     C           #2EIDT    IFEQ *ZERO                      *IF
      * UPD Rqs Deliv Date/1st XF - Load Detail  * 
     C                     CLEARPDRC
     C                     Z-ADD#2RMNB    PDRMNB           Load ID
      *
     C                     CALL 'PDFFXFR'              90  UPD Rqs Deliv D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Load Detai
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * ** Deadline Departure Date/Time Restrictions          W288
      * CASE: PAR.Access Limited Sts USR is yes
     C           P4HHST    IFEQ 'Y'                        *IF
      * RTV Co. Dflt Int All   XF - Company Defaults Internal  * 
     C                     CALL 'PDSTXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0238  30       Company Number
     C           WUG0TX    PARM *BLANK    WQ0239  2        Shipping Method
     C           WUG0TX    PARM *BLANK    WQ0240  1        Load Type Dft
     C           WUG0TX    PARM *BLANK    WQ0241  1        LTL Flag Dft
     C           WUG0TX    PARM *BLANK    WQ0242  1        Export Status D
     C           WUG0TX    PARM *BLANK    WQ0243  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0244  40       Departure Time
     C           WUG0TX    PARM *BLANK    WQ0245  6        Export Code Dft
     C           WUG0TX    PARM *BLANK    WQ0246  1        Allow Mult Whse
     C           WUG0TX    PARM *BLANK    WQ0247  1        Allow Multi Exp
     C           WUG0TX    PARM *BLANK    WQ0248  1        Slip Sheet Dft
     C           WUG0TX    PARM *BLANK    WQ0249  1        Palletize Dft
     C                     PARM *BLANK    WQ0250  1        Plant Company S
     C           YL0039    PARM *BLANK    WQ0251  1        Company Organiz
     C                     PARM *BLANK    WQ0252  1        CDI Valuation G
     C                     PARM *BLANK    WQ0253  1        CDI Unused Sts
     C                     PARM *BLANK    WQ0254  2        CDI Shipper
     C                     PARM *BLANK    WQ0255  2        CDI Produced by
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Seaboard only
      * CASE: LCL.Company Organization is Seaboard
     C           YL0039    IFEQ 'S'                        *IF
      * ** Retrieve the hours that Shipping is restricted from loading
      * RTV Dock Unavail Range XF - Warehouse Control  * 
     C                     CALL 'PNNIXFR'              90  RTV Dock Unavai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CVPCD    WQ0256  3        Warehouse Code
     C           WUDPTM    PARM *ZERO     WQ0257  60       Dock Unavail St
     C           WUDQTM    PARM *ZERO     WQ0258  60       Dock Unavail En
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Retrieve Deadline Departure Date/Time from Load Header
      * RTV Deadln DepartDT/TM RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0004           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WUNVDT           Deadline Depart
     C                     Z-ADDWL0006    WUBUTM           Deadline Depart
      * ** Validate if hours are entered for a warehouse
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      *       skip - not an error if no record
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Dock Unavail Start Time is Zeros
      *   |- c2    : WRK.Dock Unavail End Time is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDPTM    IFEQ *ZERO                      *IF
     C           WUDQTM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *       skip - not an error if times are zeros
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If SSD = DDD then enforce Restricted Time Range    W288
      * CASE: WRK.Deadline Depart Date LH EQ CTL.Scheduled Ship Date USR
     C           WUNVDT    IFEQ #CHODT                     *IF
      * ** Error if DDT is during restriced hours             W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Deadline Depart Time LH GE WRK.Dock Unavail Star
      *   |- c2    : WRK.Deadline Depart Time LH LE WRK.Dock Unavail End
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUBUTM    IFGE WUDPTM                     *IF
     C           WUBUTM    IFLE WUDQTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0081
      * Send message 'Invalid Dt Chg-DDD/T err2'
     C                     MOVEL'USR4223' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
      * Edt Load/Orders        DF - Order Header TRG  * 
     C                     CALL 'PDLTDFR'              90  Edt Load/Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2C4NB    WQ0259  70       Order Number
     C                     PARM #2RMNB    WQ0260  70       Load ID
     C                     PARM #CHODT    WQ0261  70       Scheduled Ship
     C                     PARM WUADTX    WQ0262 30        Name
     C                     PARM P4HHST    WQ0263  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     994131*
     C                     END
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Error if date puts DDD/T in the past. Truck will not have
      * ** time to load and leave. Send an error message.
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0264 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0265 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Error if DDD = Today & DDT is before system time   W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Deadline Depart Date LH EQ WRK.Current System Da
      *   |- c2    : WRK.Deadline Depart Time LH LE WRK.Current System Ti
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUNVDT    IFEQ WUSDTE                     *IF
     C           WUBUTM    IFLE WUZHNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0082
      * Send message 'Invalid Deadln Dt/Tm'
     C                     MOVEL'USR4233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
      * Edt Load/Orders        DF - Order Header TRG  * 
     C                     CALL 'PDLTDFR'              90  Edt Load/Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2C4NB    WQ0266  70       Order Number
     C                     PARM #2RMNB    WQ0267  70       Load ID
     C                     PARM #CHODT    WQ0268  70       Scheduled Ship
     C                     PARM WUADTX    WQ0269 30        Name
     C                     PARM P4HHST    WQ0270  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     994131*
     C                     END
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PK0302 -- Change sched ship dt
      * CASE: LCL.Status Flag 4  Y/N is yes
     C           YL0055    IFEQ 'Y'                        *IF
      * CASE: LCL.Scheduled Ship Date USR is Entered
     C           YL0057    IFNE *ZERO                      *IF
      * Rtv/Chg Sched Shp Dt   RT - Load Header  * 
     C                     EXSR TWRVGN
     C                     MOVEL'SCHSHP'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUMNTX           Change Log Prio
     C                     MOVELP1AODT    WUMNTX           Change Log Prio
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVELYL0057    WUMOTX           Change Log New
     C                     Z-ADDYL0057    #CHODT           Scheduled Ship
      * 9/5/2007 slm was using CTL.Carrier Code changed to
      *   use CTL.USR Carrier Code (and crt the log record)
      * 06/09/2015 PKD/JH E4122 Changed RTV to include Hdr Sts=A|H|L for
      *                         changing the Requested Ship Date.
      * RTV Load for Date Chg  RT - Order Header TRG  * 
     C                     EXSR TYRVGN
     C                     Z-ADDYL0057    #2AODT           Scheduled Ship
     C                     Z-ADDYL0057    WUAODT           Scheduled Ship
     C                     Z-ADDYL0057    #CHODT           Scheduled Ship
     C                     END                             *FI
     C                     END                             *FI
      * If load weight > maximum pounds for truck, LTL for load is N else
      * CASE: CTL.Weight Adjust GE PAR.Maximum pounds
     C           #CDTWG    IFGE P3RSNB                     *IF
     C                     MOVEL'N'       WUPJST           LTL Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUPJST           LTL Flag
     C                     END                             *FI
     C                     Z-ADD*ZERO     WURRNB           Total Stops
      * RTV No. of Stops      RT - Load Detail  * 
     C                     EXSR NCRVGN
      * Rtv Min Temp for Load RT - Order Header TRG  * 
     C                     EXSR NDRVGN
      * Process lock load request
      * CASE: CTL.*CMD key is *Lock Load
     C           *IN15     IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0553  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0554 112       Flat Amount
     C                     Z-ADD*ZERO     WN0555  50       Total Stops
     C                     Z-ADD*ZERO     WN0556  70       Total Load Mile
     C                     MOVEL*BLANK    WN0557  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0558  2        Ship To State C
     C                     MOVEL*BLANK    WN0559  3        Carrier Broker
     C                     MOVEL*BLANK    WN0560  1        Export Status
     C                     MOVEL*BLANK    WN0561  3        Shipping Line
     C                     MOVEL*BLANK    WN0562 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0563  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0564  60       Deadline Depart
     C                     MOVEL*BLANK    WN0565  1        MG Created Load
     C                     MOVEL*BLANK    WN0566  2        Load U/M
     C                     MOVEL*BLANK    WN0567  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0568 20        Destination Cit
     C                     MOVEL*BLANK    WN0569  2        State Code
     C                     MOVEL*BLANK    WN0570  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0571  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN0572  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN0573  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN0574  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN0575  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN0576  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN0577  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN0578  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN0579  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN0580 155       Company Number
     C                     Z-ADD*ZERO     WN0581 155       Date 1
     C                     Z-ADD*ZERO     WN0582 155       Order Number 1
     C                     Z-ADD*ZERO     WN0583  40       Requested Deliv
     C                     MOVEL*BLANK    WN0584  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
     C                     EXSR NERVGN
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN0557    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
     C                     EXSR NFRVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0565    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
     C                     EXSR NKRVGN
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN0563           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0089           Load ID
     C                     Z-ADD*ZERO     WL0090           Stop/Drop
     C                     EXSR NLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0091    WN0563           Requested Deliv
     C                     Z-ADDWL0092    WN0583           Requested Deliv
     C           WN0583    MULT 100       WN0564           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0730  51       Hours Required
     C                     Z-ADD*ZERO     WN0731  50       Miles to next s
     C                     Z-ADD*ZERO     WN0732  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0733  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0734  50       @Days 5
     C                     Z-ADD*ZERO     WN0735  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0736  20       USR Period
     C                     Z-ADD*ZERO     WN0737  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0738  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UGSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0093           Load ID
     C                     EXSR NNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0094    YL0081    P      Shipping Method
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0081    IFEQ 'CT'                       *IF
     C           YL0081    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0095           Load ID
     C                     Z-ADD*ZERO     WL0096           Stop/Drop
     C                     Z-ADD*ZERO     WL0097           Order Number
     C                     EXSR NORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0098    WN0731           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0731    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPFRC
     C                     Z-ADD#2RMNB    PFRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0305  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0306  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0095           Load ID
     C                     Z-ADD*ZERO     WL0096           Stop/Drop
     C                     Z-ADD*ZERO     WL0097           Order Number
     C                     EXSR NORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0098    WN0731           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0731    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN0563           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0564           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0730           Hours Required
     C                     Z-ADD*ZERO     YL0082           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0731    WL0099           Miles to First
     C                     EXSR NPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0100    YL0082           Hours Required
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0307  70       Load ID
     C           YL0083    PARM YL0083    WQ0308  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C           YL0082    ADD  YL0083    WN0730           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0730    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0730    DIV  24        WN0734           @Days 5
     C           WN0734    MULT 24        WU               USR Hours 5.0
     C           WN0730    SUB  WU        WN0732           USR Hours 5.0
     C           WN0732    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0734    IFGT 0                          *IF
     C                     MULT -1        WN0734           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0563    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0734    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0563
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0563
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0564                     *IF
     C                     SUB  WN0564    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0734           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0563    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0734    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0563
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0563
     C                     END
     C           240000    SUB  WUPINB    WN0564           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0564           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0101           Load ID
     C                     EXSR NQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0102    WUG0TX    P      Load Status
     C                     Z-ADDWL0103    WUTLMI           Total Load Mile
     C                     Z-ADDWL0104    WUK2DT           Override Total
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
     C                     EXSR NRRVGN
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0555    IFEQ 1                          *IF
     C           WN0554    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
     C                     EXSR NTRVGN
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN0568    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN0568           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
     C                     EXSR NURVGN
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UHSUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
     C                     EXSR NVCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0553    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
     C                     EXSR NWRVGN
     C                     Z-ADD#2AIC3    WN0580           Company Number
     C                     Z-ADD#2RMNB    WN0582           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0553    WN0581           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0570    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN0584    PARM *BLANK    WQ0311  7        Return Code Usr
     C                     PARM 'OMS'     WQ0312  6        Application Cod
     C                     PARM @CN,004   WQ0313 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0314  1        USR Detail or S
     C                     PARM @CN,005   WQ0315 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0316 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0317  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0318  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0319  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0320 10        PRT Night Queue
     C           WN0580    PARM WN0580    WQ0321 155       Company Number
     C           WN0581    PARM WN0581    WQ0322 155       Date 1
     C           WN0582    PARM WN0582    WQ0323 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0324 155       System Value Nu
     C           WN0570    PARM WN0570    WQ0325  3        USR Warehouse C
     C           WN0571    PARM WN0571    WQ0326  3        USR CDE Parm 1
     C           WN0572    PARM WN0572    WQ0327  3        USR CDE Parm 2
     C           WN0573    PARM WN0573    WQ0328  3        USR CDE Parm 3
     C           WN0574    PARM WN0574    WQ0329  3        USR CDE Parm 4
     C           WN0575    PARM WN0575    WQ0330  3        USR CDE Parm 5
     C           WN0576    PARM WN0576    WQ0331  3        USR CDE Parm 6
     C           WN0577    PARM WN0577    WQ0332  3        USR CDE Parm 7
     C           WN0578    PARM WN0578    WQ0333  3        USR CDE Parm 8
     C           WN0579    PARM WN0579    WQ0334  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0335  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0336  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0876  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0105           Load ID
     C                     EXSR NYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0106    WN0876    P      Trans Contol AS
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0107           PFS Company Num
     C                     MOVEL'LDORDD'  WL0108    P      PFS Interface C
     C                     EXSR OCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0109    YL0084    P      PFS AccuSort Ac
     C                     MOVELWL0110    YL0085    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0084    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0876    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0337  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  CRT AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0338  70       Load ID
     C                     PARM #2AIC3    WQ0339  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0340  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0085    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0341  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0342  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,006                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0553    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0570    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0570    WQ0343  3        Warehouse Code
     C                     PARM *BLANK    WQ0344 10        Default Printer
     C           YL0086    PARM *BLANK    WQ0345  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0086    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN0570    ZA0083           USR Warehouse C
     C                     MOVELWN0571    ZA0084           USR CDE Parm 1
     C                     MOVELWN0572    ZA0085           USR CDE Parm 2
     C                     MOVELWN0573    ZA0086           USR CDE Parm 3
     C                     MOVELWN0574    ZA0087           USR CDE Parm 4
     C                     MOVELWN0575    ZA0088           USR CDE Parm 5
     C                     MOVELWN0576    ZA0089           USR CDE Parm 6
     C                     MOVELWN0577    ZA0090           USR CDE Parm 7
     C                     MOVELWN0578    ZA0091           USR CDE Parm 8
     C                     MOVELWN0579    ZA0092           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR UISUBR                     ***** Change Lo
     C                     MOVEL*BLANK    WURVST           Load Change Typ
     C                     MOVEL'LOCK'    WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVEL'L'       WUMOTX           Change Log New
      * RTV Stop Number       RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0016           Load ID
     C                     Z-ADD#2C4NB    WL0018           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    P7RVNB           Stop/Drop
     C                     Z-ADDWL0019    WUNFNN           Appointment Con
     C                     Z-ADDWL0020    WUNFNN           Appointment Con
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
     C                     Z-ADDP7RVNB    PCRVNB           Stop/Drop
     C                     MOVELWURVST    PCRVST    P      Load Change Typ
     C                     MOVELWUUJST    PCUJST    P      Department Cont
     C                     MOVEL#PPKST    PCMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#CR6CD    PCBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PCAIC3           Company Number
     C                     Z-ADD*ZERO     PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
      * RTV Defaulted Fields   RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0111           Load ID
     C                     EXSR ODRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0112    #PFLAM           Flat Amount
     C                     MOVELWL0113    #CVPCD    P      Ship From Wareh
     C                     MOVELWL0114    #CV9CD    P      Ship To State C
     C                     MOVEL'L'       #PPKST           Load Status
     C                     END                             *FI
      * Process unlock load request
      * CASE: CTL.*CMD key is *Unlock Load
     C           *IN16     IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN0877  3        Shipping Line
     C                     MOVEL*BLANK    WN0878 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0879  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0880  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
     C                     EXSR OECHRC
      *
     C                     MOVEL*BLANK    WN1024  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1025  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN1026  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN1027  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0105           Load ID
     C                     EXSR NYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0106    WN1024    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
     C                     EXSR OFRVGN
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0107           PFS Company Num
     C                     MOVEL'LDORDD'  WL0108    P      PFS Interface C
     C                     EXSR OCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0109    YL0088    P      PFS AccuSort Ac
     C                     MOVELWL0110    YL0089    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0088    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN1024    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0346  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0347  70       Load ID
     C                     PARM #2AIC3    WQ0348  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0349  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0089    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0350  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0351  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0352  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0115           Load ID
     C                     Z-ADD*ZERO     WL0116           Stop/Drop Seque
     C                     EXSR OGRVGN
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUMOTX           Change Log New
     C                     MOVEL'U'       WUMOTX           Change Log New
      * RTV Stop Number       RT - Load Detail          TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0016           Load ID
     C                     Z-ADD#2C4NB    WL0018           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    P7RVNB           Stop/Drop
     C                     Z-ADDWL0019    WUNFNN           Appointment Con
     C                     Z-ADDWL0020    WUNFNN           Appointment Con
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
     C                     Z-ADDP7RVNB    PCRVNB           Stop/Drop
     C                     MOVELWURVST    PCRVST    P      Load Change Typ
     C                     MOVELWUUJST    PCUJST    P      Department Cont
     C                     MOVEL#PPKST    PCMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#CR6CD    PCBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PCAIC3           Company Number
     C                     Z-ADD*ZERO     PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0115           Load ID
     C                     Z-ADD*ZERO     WL0116           Stop/Drop Seque
     C                     EXSR OGRVGN
      * RTV Defaulted Fields   RT - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0111           Load ID
     C                     EXSR ODRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0112    #PFLAM           Flat Amount
     C                     MOVELWL0113    #CVPCD    P      Ship From Wareh
     C                     MOVELWL0114    #CV9CD    P      Ship To State C
     C                     MOVEL'U'       #PPKST           Load Status
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * If load status is 'E'(entered) change to 'U'(unlocked)
      * CASE: CTL.Load Status is Entered or Combined
     C           #PPKST    IFEQ 'E'                        *IF
     C           #PPKST    OREQ 'C'
     C                     MOVEL'U'       #PPKST           Load Status
     C                     END                             *FI
      * RTV Export Ords for LD RT - Order Header TRG  * 
     C                     EXSR OMRVGN
      * Change export status to yes if export order found on load
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'N'       P1U2ST           Export Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P1U2ST           Export Status
     C                     END                             *FI
      * RTV First Order Whse   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0086           Load ID
     C                     Z-ADD*ZERO     WL0087           Stop/Drop
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0088    #CVPCD    P      Warehouse Code
      * ** Total Load Miles will be zeros if no Miles Between Cities rec
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPFRC
     C                     Z-ADD#2RMNB    PFRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Load Detai
     C           WUTKNB    PARM WUTKNB    WQ0353  70       Total Load Mile
     C           P2K2DT    PARM P2K2DT    WQ0354  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * If no orders on load, set ship from whse to ' ',ttl ld miles to 0
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    #CVPCD           Ship From Wareh
     C                     Z-ADD*ZERO     #CTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WUTKNB           Total Miles
     C                     END                             *FI
      * ** Update DDD/T in the Load Header                    W288
     C                     MOVEL*BLANK    WULONA           USR Load Id ALp
     C                     MOVEL#2RMNB    WULONA           USR Load Id ALp
      * CLC Depart Date f/web  XF - Load Header  * 
     C                     CALL 'PNMAXFR'              90  CLC Depart Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WULONA    WQ0355  7        USR Load Id ALp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Default Load Seq  RT - Warehouse  * 
     C                     EXSR ONRVGN
      * default Schedule Sequence Number
      * CASE: LCL.Default Load Sequence is yes
     C           YL0090    IFEQ 'Y'                        *IF
     C                     Z-ADD1         #CT4NB           Schedule Sequen
     C                     END                             *FI
      * ** CTL tlt miles may have override miles in it. Check before upda
      * Calc Load U/M     -- RMC added here for all loads 4/17/14 (not ju
     C                     EXSR UJSUBR                     Calc Load U/M
      * CHG For Load Planning  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0059           Load ID
     C                     Z-ADD#2AIC3    WL0060           Company Number
     C                     Z-ADD#CHODT    WL0061           Scheduled Ship
     C                     MOVELWUPJST    WL0062    P      LTL Flag
     C                     MOVEL#PPKST    WL0063    P      Load Status
     C                     Z-ADD#CPCNX    WL0064           Reefer Temperat
     C                     Z-ADD#CVTNB    WL0065           Total Load Orde
     C                     Z-ADD#PFLAM    WL0066           Flat Amount
     C                     MOVEL#PXQST    WL0067    P      Allocate Pounds
     C                     Z-ADDWURRNB    WL0068           Total Stops
     C                     MOVEL#CR6CD    WL0069    P      Carrier Code
     C                     MOVEL#CTECD    WL0070    P      Truck Size
     C                     Z-ADD#2R1NB    WL0071           Rated Freight
     C                     MOVEL#CWNST    WL0072    P      Load Type
     C                     Z-ADD#CT4NB    WL0073           Schedule Sequen
     C                     Z-ADDWUTKNB    WL0074           Total Load Mile
     C                     MOVEL#CCUST    WL0075    P      Shipping Method
     C                     MOVEL#CVPCD    WL0076    P      Ship From Wareh
     C                     MOVEL#CV9CD    WL0077    P      Ship To State C
     C                     MOVEL#CXCCD    WL0078    P      Carrier Broker
     C                     MOVELP1U2ST    WL0079    P      Export Status
     C                     Z-ADDP2K2DT    WL0080           Override Total
     C                     MOVEL#2FRSX    WL0081    P      Shipping Temp C
     C                     MOVELWURVSX    WL0082    P      Multi Company L
     C                     MOVELYL0072    WL0083    P      Load U/M
     C                     EXSR TVCHRC
      * *****************************************************************
      * *OMS273
      * Send Message that the load was created for current ship date.
      * CASE: LCL.Load Create Sts USR is yes
     C           YL0071    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0091           Office Message
      *
     C                     MOVEL*BLANK    WN1331  8        Dsp Date (99/99
     C                     MOVEL*BLANK    WN1332 40        System Value Al
      *
      * SndMsg Ld Crt -Cur Dt IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0122           Company Number
     C                     MOVEL'LOADMSG' WL0123    P      Company Value C
     C                     EXSR OORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    WN1332    P      System Value Al
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELWN1332    WUCLAA           DL List ID
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           #CHODT    IFEQ ##JDT                      *IF
      * Rtv Date Display Fmt  IF
     C                     MOVEL*BLANK    YL0092           Date (Alpha) US
     C                     MOVEL#CHODT    YL0092           Date (Alpha) US
      * 99/
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ YL0093    P  90  Date Component
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0093    CAT  '/':ZQ    WN1331    P      Dsp Date (99/99
      * 99/99/
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ YL0093    P  90  Date Component
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           WN1331    CAT  YL0093:ZQ WN1331    P      Dsp Date (99/99
     C                     Z-ADD*ZEROS    ZQ      50
     C           WN1331    CAT  '/':ZQ    WN1331    P      Dsp Date (99/99
      * 99/99/99
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0092:ZQ YL0093    P  90  Date Component
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           WN1331    CAT  YL0093:ZQ WN1331    P      Dsp Date (99/99
      * Setup message data for message
     C                     Z-ADD#2RMNB    ZA0093           Load ID
     C                     MOVEL##USR     ZA0094           *USER
     C                     MOVELWN1331    ZA0095           Dsp Date (99/99
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0096           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0096           CD3 Ext Numeric
     C                     END                             *FI
      * Retrieve message Load Created -Cur Dte
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2945' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0091    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM WUCLAA    WQ0358 10        DL List ID
     C                     PARM YL0091    WQ0359132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change log and comments
     C                     EXSR UKSUBR                     ***** Change lo
      * CASE: CTL.Company Number is not equal to zero
     C           #2AIC3    IFNE *ZERO                      *IF
      * ** Retrieve ESEND email list by company           E00328
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0360  30       Company Number
     C                     PARM @CN,008   WQ0361 10        Company Value C
     C           YL0094    PARM *BLANK    WQ0362 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.System Value Alpha is Not equal to Blank
     C           YL0094    IFNE *BLANK                     *IF
      * ** E00328
      * CASE: LCL.Office Message USR NE WRK.Blank for 30          USR
     C           YL0091    IFNE WUW4TX                     *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,009   CAT  @CN,010:ZQYL0095    P      Subject Line US
      * CLP Exe ESNDMAIL Cmd   UP - /UT User Programs  * 
     C                     CALL 'PPW6UPC'              90  CLP Exe ESNDMAI
     C                     PARM YL0096    WQ0363  7        Return Code Usr
     C                     PARM YL0094    WQ0364 50        Email Address
     C                     PARM YL0095    WQ0365100        Subject Line US
     C                     PARM YL0091    WQ0366256        Pager Msg 256 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPW6UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If in add mode, set flags
      * CASE: WRK.Display File Add/Change is Add
     C           WUQSST    IFEQ 'A'                        *IF
     C                     MOVEL'C'       WUQSST           Display File Ad
     C                     MOVEL'N'       WUQKST           Display Flag
     C                     END                             *FI
      * Chg load start company to match orders on the load  RMC 9/27/07
      * EXC Chg Load Str Co   XF - Load Header  * 
     C                     CALL 'PMNTXFR'              90  EXC Chg Load St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0367  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMNTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,50
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Process assign/delete/update stop
      * CASE: RCD.*SFLSEL is *Assign to Load
     C           #1SEL     IFEQ '1'                        *IF
      * Process assign to load
     C                     EXSR ULSUBR                     Process assign
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Delete from Load
     C           #1SEL     IFEQ '4'                        *IF
      * Process delete from load
     C                     EXSR UMSUBR                     Process delete
      * CRT: TMS Order Header Trigger
      * CASE: RCD.OH Load Plan Ready is Yes
     C           #1FVSX    IFEQ 'Y'                        *IF
      * Rtv Crt OH Trigger    XF - TMS Order Header Trigger  * 
     C                     CALL 'PBWVXFR'              90  Rtv Crt OH Trig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0376  70       Order Number
     C                     PARM #1AIC3    WQ0377  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Reset to blank
     C           #1SEL     IFEQ *BLANK                     *IF
      * Process update stop (order assigned to load thru order entry)
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Load ID is NE Blank
      *   |- c2    : RCD.USR Stop is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1RMNB    IFNE *ZERO                      *IF
     C           #RTENB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC FP1251 This was using the stop drop seq from WRK context
      * BUT the wrk.Stop/Drop Sequence Number has the last stop/drop seq
      * load so it s/not be changed here. if they changed a stop then add
      * an order, it wouldnt write the load dtl because the wrk.stop/drop
      * seq was already found because this rtv messed it up. i changed it
      * RTV Sequence Number    RT - Load Detail  * 
     C                     EXSR PJRVGN
     C                     Z-ADD#RTENB    WURVNB           Stop/Drop
      * ** Miles here is usually zeros, only a very few have values
      * Rtv Miles to Customer  RT - Company Customer  * 
     C                     EXSR PKRVGN
      * CHG Stop Number        CH - Load Detail  * 
     C                     EXSR PLCHRC
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * -----------------------------------------------------------------
      * C7111: If we do not want to allow stop changes from this program,
      *     a) comment the following code.
      * Load Change Type/Log
      * CASE: WRK.Stop/Drop NE LCL.Stop/Drop
     C           WURVNB    IFNE YL0100                     *IF
     C                     MOVELYL0100    WUMNTX           Change Log Prio
     C                     MOVELWURVNB    WUMOTX           Change Log New
     C                     MOVEL'CHGSTP'  P5RVST           Load Change Typ
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
     C                     Z-ADD#RTENB    PCRVNB           Stop/Drop
     C                     MOVELP5RVST    PCRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PCUJST    P      Department Cont
     C                     MOVELWUMNTX    PCMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##JOB     PCA0NA    P      Job Name
     C                     MOVEL#CR6CD    PCBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD#1C4NB    PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983151*
     C                     SETON                     32    *
     C                     END
      * E00495 Set this so the deadl dpt will be recalculated.
     C                     MOVEL'1'       WUFUST           Load Added/Dele
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *     b) uncomment the following code.
      * C7111: End ------------------------------------------------------
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN71
     C           #RE6ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN71
     C                     END                             *FI
     C                     MOVEL'0'       *IN70
     C           #1NODT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       *IN70
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           WUQKST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUE5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C                     MOVEL'0'       *IN77
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'L'
     C           #PPKST    OREQ 'S'
     C                     MOVEL'1'       *IN76
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C                     MOVEL'0'       *IN72
     C           P5JDST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN75
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'S'
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           P3QKST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPJB fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVEL*BLANK    #RB7SX           Must Ship Error
     C                     MOVEL*BLANK    #RR4ST           USR Update Flag
     C                     MOVEL*BLANK    #RE6ST           USR Status (Y/N
     C                     Z-ADD*ZERO     #RBUNB           USR Weight, 9.0
     C                     MOVEL*BLANK    #RWBT1           OHE Appt Confir
     C                     MOVEL*BLANK    #RV5T1           OHE Appt Confir
     C                     Z-ADD*ZERO     #RRVNB           Stop/Drop
     C                     MOVEL*BLANK    #RLHNA           USR State Name
     C                     Z-ADD*ZERO     #RNVDT           Deadline Depart
     C                     Z-ADD*ZERO     #RBUTM           Deadline Depart
     C                     MOVEL*BLANK    #RELTX           USR Shortened I
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RTENB           USR Stop
     C                     MOVEL*BLANK    #RAJCD           Warehouse Code
     C                     MOVEL*BLANK    #RV1CD           Region Code
     C                     Z-ADD*ZERO     #RMDDI           Month/Day Displ
     C                     Z-ADD*ZERO     #RYGNX           USR Weight, 5.0
     C                     MOVEL*BLANK    #RLSNA           USR Picked
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP7RVNB    #PRVNB           Stop/Drop
     C                     MOVELP6B2VN    #PB2VN           Job Name CDE
     C                     MOVELP3R4ST    #PR4ST           USR Update Flag
     C                     MOVEL*BLANK    #CRMST           Load Acceptance
     C                     MOVEL*BLANK    #COANA           Port Delv Termi
     C                     MOVEL*BLANK    #CXACD           Shipping Line
     C                     Z-ADD*ZERO     #CKHDT           Date of Expirat
     C                     Z-ADD*ZERO     #CAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     #CVSVA           USR Total Order
     C                     MOVEL*BLANK    #CCOFI           Certificate of
     C                     Z-ADDP5CDWG    #PCDWG           USR Weight Accu
     C                     Z-ADDP3RQNB    #PRQNB           Total Freight
     C                     MOVEL*BLANK    #CQSST           Display File Ad
     C                     Z-ADD*ZERO     #CTGNB           USR Minimum Tem
     C                     Z-ADD*ZERO     #CASWG           USR Weight
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     MOVELP2XQST    #PXQST           Allocate Pounds
     C                     MOVEL*BLANK    #2JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #CJ0VA           USR Order Value
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    #2U2ST           Export Status
     C                     Z-ADD*ZERO     #2A0DT           Order Date
     C                     Z-ADD*ZERO     #2ACDT           Cancel Date
     C                     MOVEL*BLANK    #2AQCD           Terms Code
     C                     Z-ADD*ZERO     #2AATM           Job Time
     C                     MOVEL*BLANK    #2AYNA           User Id
     C                     MOVEL*BLANK    #2A0NA           Job Name
     C                     Z-ADD*ZERO     #2AXDT           Job Date
     C                     Z-ADD*ZERO     #2RNNB           Reefer Temperat
     C                     Z-ADD*ZERO     #2A5DT           Requested Ship
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
     C                     Z-ADD*ZERO     #CBUNB           USR Weight, 9.0
     C                     Z-ADD*ZERO     #2A1WG           Order Weight To
     C                     MOVEL*BLANK    #2HNNA           Ship To City
     C                     MOVEL*BLANK    #2Q2CD           Shipping Method
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     Z-ADD*ZERO     #CFKNB           USR Company Num
     C                     MOVEL*BLANK    #2BCNA           Customer Purcha
     C                     MOVEL*BLANK    #CHLTX           Condition Desc.
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADDP1RMNB    #2RMNB           Load ID
     C                     MOVELP2PKST    #PPKST           Load Status
     C                     MOVEL*BLANK    #CHKNA           Status Descript
     C                     MOVEL*BLANK    #CR6CD           USR Carrier Cod
     C                     MOVEL*BLANK    #CGVTX           USR Carrier Nam
     C                     Z-ADD*ZERO     #CVTNB           USR Total Weigh
     C                     MOVEL*BLANK    #CXCCD           Carrier Broker
     C                     MOVEL*BLANK    #CADTX           Name
     C                     Z-ADD*ZERO     #CDTWG           Weight Adjust
     C                     Z-ADD*ZERO     #CPCNX           USR Temperature
     C                     MOVEL*BLANK    #2FRSX           Shipping Temp C
     C                     MOVEL*BLANK    #CTECD           USR Truck Size
     C                     Z-ADD*ZERO     #CVUNB           USR Total Freig
     C                     MOVEL*BLANK    #CWNST           USR Load Type
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCHODT
     C                     Z-ADD*ZERO     #2R1NB           Rated Freight
     C                     Z-ADD*ZERO     #CT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #CTLMI           Total Load Mile
     C                     MOVEL*BLANK    #CCUST           USR Shipping Me
     C                     MOVEL*BLANK    #CVPCD           Ship From Wareh
     C                     MOVEL*BLANK    #CV9CD           USR State Code
     C                     Z-ADDP2FLAM    #PFLAM           Flat Amount
     C                     Z-ADD*ZERO     #CNVDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     VCNVDT
     C                     Z-ADD*ZERO     #CBUTM           Deadline Depart
     C                     Z-ADD*ZERO     #CTENB           USR Stop
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVEL*BLANK    #CCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #2PJST           LTL Flag
     C                     MOVEL*BLANK    #CV1CD           Region Code
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #CMDDI           Month/Day Displ
     C                     Z-ADD*ZERO     #2AFTM           Requested Deliv
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #CMPT1           City 11 USR
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #CYGNX           USR Weight, 5.0
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCHODT
      * Convert Deadline Depart Date LH to display format
      * Convert date
     C           1000000   ADD  #CNVDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCNVDT
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * Chg SchShip/ReqShp Dt CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0304  70       Item Code
     C                     MOVEL*BLANK    WN0305  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0306  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0307  70       Order Group Cod
     C                     MOVEL*BLANK    WN0308  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0309  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0310 112       Billing Detail
     C                     Z-ADD*ZERO     WN0311 112       Billing Detail
     C                     Z-ADD*ZERO     WN0312 112       Billing Detail
     C                     Z-ADD*ZERO     WN0313 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0314  1        Comment Print A
     C                     MOVEL*BLANK    WN0315  1        Comment Print I
     C                     MOVEL*BLANK    WN0316  1        Comment Print P
     C                     MOVEL*BLANK    WN0317  1        Comment Print S
     C                     Z-ADD*ZERO     WN0318 112       Extended Amount
     C                     Z-ADD*ZERO     WN0319  70       Market Pricing
     C                     MOVEL*BLANK    WN0320  3        Commodity Marke
     C                     MOVEL*BLANK    WN0321  3        Date Method Cod
     C                     MOVEL*BLANK    WN0322  3        Price Method Co
     C                     Z-ADD*ZERO     WN0323 114       Price Overage O
     C                     Z-ADD*ZERO     WN0324  70       Contract Number
     C                     MOVEL*BLANK    WN0325  1        Price Status
     C                     Z-ADD*ZERO     WN0326  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0327  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0328  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0329  1        Work Confirm St
     C                     MOVEL*BLANK    WN0330  1        Work Over/Short
     C                     MOVEL*BLANK    WN0331  1        OD Production P
     C                     MOVEL*BLANK    WN0332 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0333 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0334  1        Age Code
     C                     MOVEL*BLANK    WN0335  1        Palletize
     C                     MOVEL*BLANK    WN0336  1        Slip Sheet
     C                     MOVEL*BLANK    WN0337  1        Catch Weight St
     C                     MOVEL*BLANK    WN0338  1        Price Audit
     C                     MOVEL*BLANK    WN0339  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0340  1        Production Date
     C                     Z-ADD*ZERO     WN0341 112       Rated Freight
     C                     Z-ADD*ZERO     WN0342 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0343 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0344 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0345 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0346 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0347 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0348 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0349 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0350 114       Unit Price
     C                     Z-ADD*ZERO     WN0351 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0352 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0353 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0354 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0355  70       Actual Shipped
     C                     MOVEL*BLANK    WN0356  1        Affect Inventor
     C                     MOVEL*BLANK    WN0357  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0358  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0359  30       Item Structure
     C                     Z-ADD*ZERO     WN0360  30       Item Structure
     C                     Z-ADD*ZERO     WN0361  30       Item Structure
     C                     MOVEL*BLANK    WN0362  2        Item Level
     C                     MOVEL*BLANK    WN0363  2        Quality Level
     C                     MOVEL*BLANK    WN0364  2        Pricing Product
     C                     MOVEL*BLANK    WN0365  2        Season Product
     C                     Z-ADD*ZERO     WN0366  70       Date of Origina
     C                     MOVEL*BLANK    WN0367 10        User Profile Na
     C                     MOVEL*BLANK    WN0368  6        Country Code
     C                     MOVEL*BLANK    WN0369  2        Event Code
     C                     MOVEL*BLANK    WN0370  3        Reason Code
     C                     MOVEL*BLANK    WN0371  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0372  1        Modified Flag
     C                     MOVEL*BLANK    WN0373  1        Substituted Fla
     C                     MOVEL*BLANK    WN0374  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0375 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0376 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0377  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0378  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0379  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0380  1        Affect Commissi
     C                     MOVEL*BLANK    WN0381  1        Affect Pricing
     C                     MOVEL*BLANK    WN0382  1        Released by Use
     C                     MOVEL*BLANK    WN0383  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0384  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0385  3        Production Ware
     C                     MOVEL*BLANK    WN0386  3        OD Price Type
     C                     Z-ADD*ZERO     WN0387  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0388  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0389  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0390  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0391  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0392  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0393  60       Price Code
     C                     Z-ADD*ZERO     WN0394  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0395  60       Substitution Li
     C                     Z-ADD*ZERO     WN0396  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0397 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0398 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0399 112       OD Item Target
     C                     Z-ADD*ZERO     WN0400 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0401 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0402 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0403 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0404 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0405 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0406 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0407 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0408 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0409 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0410  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0411  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0412  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0413 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0414  40       Item Age Days
     C                     Z-ADD*ZERO     WN0415  70       Production Ovr
     C                     Z-ADD*ZERO     WN0416  70       Production Ovr
     C                     MOVEL*BLANK    WN0417  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0418  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0419  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0420  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0421  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0422  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0423  1        EDI Status 1
     C                     MOVEL*BLANK    WN0424  1        EDI Status 2
     C                     MOVEL*BLANK    WN0425  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0426  60       Job Time
     C                     MOVEL*BLANK    WN0427 10        User Id
     C                     MOVEL*BLANK    WN0428 10        Job Name
     C                     Z-ADD*ZERO     WN0429  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WJAIC3           Company Number
     C                     Z-ADDOMC4NB    WJC4NB           Order Number
     C                     Z-ADDOMDPNB    WJDPNB           Order Sequence
     C                     Z-ADDOMUENB    WJUENB           Order Secondary
      *
     C           KLCHNA    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C           KLCHNA    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWUA5DT    WJA5DT           Requested Ship
     C                     Z-ADDYL0057    WJAODT           Scheduled Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBCHRC    BEGSR
      *================================================================
      * CHG Sch Shp & Req Shp CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0430  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0431  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0432  70       Ship To Custome
     C                     MOVEL*BLANK    WN0433 30        Ship To Name
     C                     MOVEL*BLANK    WN0434 30        Ship To Address
     C                     MOVEL*BLANK    WN0435 30        Ship To Address
     C                     MOVEL*BLANK    WN0436 30        Ship To Address
     C                     MOVEL*BLANK    WN0437 20        Ship To City
     C                     MOVEL*BLANK    WN0438  2        Ship To State C
     C                     MOVEL*BLANK    WN0439 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0440  70       Bill to Custome
     C                     MOVEL*BLANK    WN0441 30        Bill to Name
     C                     MOVEL*BLANK    WN0442 30        Bill to Address
     C                     MOVEL*BLANK    WN0443 30        Bill to Address
     C                     MOVEL*BLANK    WN0444 30        Bill to Address
     C                     MOVEL*BLANK    WN0445 20        Bill to City
     C                     MOVEL*BLANK    WN0446  2        Bill to State C
     C                     MOVEL*BLANK    WN0447 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0448 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0449  70       Order Date
     C                     Z-ADD*ZERO     WN0450  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0451  70       Cancel Date
     C                     MOVEL*BLANK    WN0452  2        Terms Code
     C                     MOVEL*BLANK    WN0453 40        Special Instruc
     C                     MOVEL*BLANK    WN0454 40        Special Instruc
     C                     MOVEL*BLANK    WN0455  3        Carrier Code
     C                     MOVEL*BLANK    WN0456  1        Comment Print A
     C                     MOVEL*BLANK    WN0457  1        Comment Print I
     C                     MOVEL*BLANK    WN0458  1        Comment Print P
     C                     MOVEL*BLANK    WN0459  1        Comment Print S
     C                     MOVEL*BLANK    WN0460  3        Reason Code
     C                     MOVEL*BLANK    WN0461  1        Order in Use
     C                     MOVEL*BLANK    WN0462  1        Header Status
     C                     MOVEL*BLANK    WN0463  1        Header Status L
     C                     MOVEL*BLANK    WN0464  1        Order Type Prin
     C                     MOVEL*BLANK    WN0465 10        User Original E
     C                     Z-ADD*ZERO     WN0466  70       Date of Origina
     C                     Z-ADD*ZERO     WN0467 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0468 112       Order Weight To
     C                     MOVEL*BLANK    WN0469  1        Credit Hold
     C                     MOVEL*BLANK    WN0470  1        Production Hold
     C                     MOVEL*BLANK    WN0471  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0472  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0473  40       Requested Deliv
     C                     MOVEL*BLANK    WN0474  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0475 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0476  70       Load ID
     C                     Z-ADD*ZERO     WN0477  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0478 112       Rated Freight
     C                     MOVEL*BLANK    WN0479  1        LTL Flag
     C                     MOVEL*BLANK    WN0480  1        Price Audit
     C                     MOVEL*BLANK    WN0481  1        Price Status
     C                     MOVEL*BLANK    WN0482  2        Shipping Method
     C                     MOVEL*BLANK    WN0483  1        Export Status
     C                     MOVEL*BLANK    WN0484  1        Palletize
     C                     MOVEL*BLANK    WN0485  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0486  1        Slip Sheet
     C                     MOVEL*BLANK    WN0487  1        Age Code
     C                     Z-ADD*ZERO     WN0488  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0489  1        Load Type
     C                     Z-ADD*ZERO     WN0490  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0491  1        Load Plan Order
     C                     MOVEL*BLANK    WN0492  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0493  70       Resell Referenc
     C                     MOVEL*BLANK    WN0494 30        Special Comment
     C                     MOVEL*BLANK    WN0495 30        Special Comment
     C                     MOVEL*BLANK    WN0496  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0497  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0498  2        Manager Level C
     C                     MOVEL*BLANK    WN0499  3        VP Level Code
     C                     Z-ADD*ZERO     WN0500  70       Attach to Order
     C                     MOVEL*BLANK    WN0501  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0502  70       Invoice Number
     C                     MOVEL*BLANK    WN0503  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0504  70       Invoice Date
     C                     MOVEL*BLANK    WN0505  2        Event Code
     C                     MOVEL*BLANK    WN0506  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0507  1        Modified Flag
     C                     Z-ADD*ZERO     WN0508 112       A/R order Value
     C                     MOVEL*BLANK    WN0509  1        Billing Activit
     C                     MOVEL*BLANK    WN0510  1        Block Order Fla
     C                     MOVEL*BLANK    WN0511  1        Order Certifica
     C                     Z-ADD*ZERO     WN0512 112       Invoice Order V
     C                     MOVEL*BLANK    WN0513  1        Process Sts for
     C                     MOVEL*BLANK    WN0514  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0515  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0516  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0517  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0518  1        Email Cust On O
     C                     MOVEL*BLANK    WN0519  1        Order Emailed
     C                     MOVEL*BLANK    WN0520  1        Export Docs Go
     C                     MOVEL*BLANK    WN0521  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0522  1        Broker Order St
     C                     MOVEL*BLANK    WN0523  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0524  2        Order Requires
     C                     MOVEL*BLANK    WN0525  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0526  2        Export USDA App
     C                     MOVEL*BLANK    WN0527  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0528  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0529  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0530  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0531  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0532  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0533  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0534  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0535  60       Time of Origina
     C                     Z-ADD*ZERO     WN0536  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0537  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0538  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0539 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0540 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0541 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0542 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0543 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0544  70       Claim Number
     C                     MOVEL*BLANK    WN0545  1        EDI Status 1
     C                     MOVEL*BLANK    WN0546  1        EDI Status 2
     C                     MOVEL*BLANK    WN0547  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0548  60       Job Time
     C                     MOVEL*BLANK    WN0549 10        User Id
     C                     MOVEL*BLANK    WN0550 10        Job Name
     C                     Z-ADD*ZERO     WN0551  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WKAIC3           Company Number
     C                     Z-ADDWBC4NB    WKC4NB           Order Number
      *
     C           KLCHNB    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C           KLCHNB    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * USER: Processing after Data read
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWUA5DT    WKA5DT           Requested Ship
     C                     Z-ADDYL0057    WKAODT           Scheduled Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPERC
     C                     Z-ADDWKAIC3    PEAIC3           Company Number
     C                     Z-ADDWKC4NB    PEC4NB           Order Number
     C                     MOVELWKJNCD    PEJNCD    P      Order Type - Sa
     C                     Z-ADDWKANC7    PEANC7           A/R Customer Nu
     C                     Z-ADDWKBKC7    PEBKC7           Ship To Custome
     C                     MOVELWKBRTX    PEBRTX    P      Ship To Name
     C                     MOVELWKHMNA    PEHMNA    P      Ship To Address
     C                     MOVELWKHONA    PEHONA    P      Ship To Address
     C                     MOVELWKHPNA    PEHPNA    P      Ship To Address
     C                     MOVELWKHNNA    PEHNNA    P      Ship To City
     C                     MOVELWKDBCD    PEDBCD    P      Ship To State C
     C                     MOVELWKCKTX    PECKTX    P      Ship To Zip/Pos
     C                     Z-ADDWKB0C7    PEB0C7           Bill to Custome
     C                     MOVELWKAETX    PEAETX    P      Bill to Name
     C                     MOVELWKB1NA    PEB1NA    P      Bill to Address
     C                     MOVELWKB3NA    PEB3NA    P      Bill to Address
     C                     MOVELWKB4NA    PEB4NA    P      Bill to Address
     C                     MOVELWKB2NA    PEB2NA    P      Bill to City
     C                     MOVELWKBHCD    PEBHCD    P      Bill to State C
     C                     MOVELWKC8TX    PEC8TX    P      Bill to Zip/Pos
     C                     MOVELWKBCNA    PEBCNA    P      Customer Purcha
     C                     Z-ADDWKA0DT    PEA0DT           Order Date
     C                     Z-ADDWKA5DT    PEA5DT           Requested Ship
     C                     Z-ADDWKGNDT    PEGNDT           Actual Shipped
     C                     Z-ADDWKACDT    PEACDT           Cancel Date
     C                     MOVELWKAQCD    PEAQCD    P      Terms Code
     C                     MOVELWKB6NA    PEB6NA    P      Special Instruc
     C                     MOVELWKBYNA    PEBYNA    P      Special Instruc
     C                     MOVELWKBZNA    PEBZNA    P      Carrier Code
     C                     MOVELWKGTST    PEGTST    P      Comment Print A
     C                     MOVELWKGVST    PEGVST    P      Comment Print I
     C                     MOVELWKGUST    PEGUST    P      Comment Print P
     C                     MOVELWKQFST    PEQFST    P      Comment Print S
     C                     MOVELWKCQCD    PECQCD    P      Reason Code
     C                     MOVELWKGJST    PEGJST    P      Order in Use
     C                     MOVELWKGWST    PEGWST    P      Header Status
     C                     MOVELWKGXST    PEGXST    P      Header Status L
     C                     MOVELWKGYST    PEGYST    P      Order Type Prin
     C                     Z-ADDWKAODT    PEAODT           Scheduled Ship
     C                     MOVELWKAIVN    PEAIVN    P      User Original E
     C                     Z-ADDWKCXDT    PECXDT           Date of Origina
     C                     Z-ADDWKJZVA    PEJZVA           Order Value Tot
     C                     Z-ADDWKA1WG    PEA1WG           Order Weight To
     C                     MOVELWKXIST    PEXIST    P      Credit Hold
     C                     MOVELWKXJST    PEXJST    P      Production Hold
     C                     MOVELWKXKST    PEXKST    P      New Customer Ho
     C                     Z-ADDWKEIDT    PEEIDT           Requested Deliv
     C                     Z-ADDWKAFTM    PEAFTM           Requested Deliv
     C                     MOVELWKE8CD    PEE8CD    P      Accounts Receiv
     C                     MOVELWKE9CD    PEE9CD    P      Accounts Receiv
     C                     Z-ADDWKRMNB    PERMNB           Load ID
     C                     Z-ADDWKTBNB    PETBNB           Absorbed Freigh
     C                     Z-ADDWKR1NB    PER1NB           Rated Freight
     C                     MOVELWKPJST    PEPJST    P      LTL Flag
     C                     MOVELWKU0ST    PEU0ST    P      Price Audit
     C                     MOVELWKU1ST    PEU1ST    P      Price Status
     C                     MOVELWKQ2CD    PEQ2CD    P      Shipping Method
     C                     MOVELWKU2ST    PEU2ST    P      Export Status
     C                     MOVELWKVEST    PEVEST    P      Palletize
     C                     MOVELWKVFST    PEVFST    P      Shrink Wrap
     C                     MOVELWKVGST    PEVGST    P      Slip Sheet
     C                     MOVELWKRPCD    PERPCD    P      Age Code
     C                     Z-ADDWKRNNB    PERNNB           Reefer Temperat
     C                     MOVELWKVDST    PEVDST    P      Load Type
     C                     Z-ADDWKATIN    PEATIN           Attach to Invoi
     C                     MOVELWKU4ST    PEU4ST    P      Load Plan Order
     C                     MOVELWKU5ST    PEU5ST    P      Print Pick Slip
     C                     Z-ADDWKRSRN    PERSRN           Resell Referenc
     C                     MOVELWKMHNA    PEMHNA    P      Special Comment
     C                     MOVELWKMINA    PEMINA    P      Special Comment
     C                     MOVELWKWBST    PEWBST    P      Affect Auto Acc
     C                     MOVELWKR4CD    PER4CD    P      Sales Route Cod
     C                     MOVELWKBFCD    PEBFCD    P      Manager Level C
     C                     MOVELWKQ4CD    PEQ4CD    P      VP Level Code
     C                     Z-ADDWKT3NB    PET3NB           Attach to Order
     C                     MOVELWKSICD    PESICD    P      Reason for Pric
     C                     Z-ADDWKCONB    PECONB           Invoice Number
     C                     MOVELWKCEST    PECEST    P      Invoice Suffix
     C                     Z-ADDWKAWDT    PEAWDT           Invoice Date
     C                     MOVELWKJPCD    PEJPCD    P      Event Code
     C                     MOVELWKXUST    PEXUST    P      Trans Contol AS
     C                     MOVELWKZ1ST    PEZ1ST    P      Modified Flag
     C                     Z-ADDWKVRVA    PEVRVA           A/R order Value
     C                     MOVELWKOBST    PEOBST    P      Billing Activit
     C                     MOVELWKBCST    PEBCST    P      Block Order Fla
     C                     MOVELWKBDST    PEBDST    P      Order Certifica
     C                     Z-ADDWKB7VL    PEB7VL           Invoice Order V
     C                     MOVELWKGASX    PEGASX    P      Process Sts for
     C                     MOVELWKGBSX    PEGBSX    P      Order Conf Fax
     C                     MOVELWKGCSX    PEGCSX    P      Manifest Fax St
     C                     MOVELWKGDSX    PEGDSX    P      Invoice Fax Sts
     C                     MOVELWKFNSX    PEFNSX    P      Transfer in Sto
     C                     MOVELWKFOSX    PEFOSX    P      Email Cust On O
     C                     MOVELWKFPSX    PEFPSX    P      Order Emailed
     C                     MOVELWKFQSX    PEFQSX    P      Export Docs Go
     C                     MOVELWKFRSX    PEFRSX    P      Shipping Temp C
     C                     MOVELWKFSSX    PEFSSX    P      Broker Order St
     C                     MOVELWKFTSX    PEFTSX    P      Air Freight Ord
     C                     MOVELWKFUSX    PEFUSX    P      Order Requires
     C                     MOVELWKFVSX    PEFVSX    P      OH Load Plan Re
     C                     MOVELWKFWSX    PEFWSX    P      Export USDA App
     C                     MOVELWKFXSX    PEFXSX    P      HPB Ship to War
     C                     MOVELWKFYSX    PEFYSX    P      OH TF Exempt Co
     C                     Z-ADDWKNODT    PENODT           OH Appt Confirm
     C                     Z-ADDWKNPDT    PENPDT           JPN Invoice Iss
     C                     Z-ADDWKNQDT    PENQDT           Load Actual Shi
     C                     Z-ADDWKNRDT    PENRDT           Load BOL Comple
     C                     Z-ADDWKNSDT    PENSDT           Load Truck Depa
     C                     Z-ADDWKBPTM    PEBPTM           Maximum Gross W
     C                     Z-ADDWKBQTM    PEBQTM           Time of Origina
     C                     Z-ADDWKBRTM    PEBRTM           OH Appt Confirm
     C                     Z-ADDWKBSTM    PEBSTM           Load BOL Comple
     C                     Z-ADDWKBTTM    PEBTTM           Load Truck Depa
     C                     Z-ADDWKH0NX    PEH0NX           Act Frt Referen
     C                     Z-ADDWKH1NX    PEH1NX           Act Non-Ref Frt
     C                     Z-ADDWKH2NX    PEH2NX           OH Fuel Surchar
     C                     Z-ADDWKH3NX    PEH3NX           OH Total Non-Re
     C                     Z-ADDWKH4NX    PEH4NX           OH Total Ref Fr
     C                     Z-ADDWKC0C7    PEC0C7           Claim Number
     C                     MOVELWKUVST    PEUVST    P      EDI Status 1
     C                     MOVELWKUWST    PEUWST    P      EDI Status 2
     C                     MOVELWKUXST    PEUXST    P      EDI Status 3
     C                     Z-ADDWKAATM    PEAATM           Job Time
     C                     MOVELWKAYNA    PEAYNA    P      User Id
     C                     MOVELWKA0NA    PEA0NA    P      Job Name
     C                     Z-ADDWKAXDT    PEAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * RTV No. of Stops      RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0552  30       USR Stop
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0552           USR Stop
     C                     MOVEL'N'       WURVSX           Multi Company L
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQNC02           Load ID
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNC02           Load ID
      * Establish starting position
     C           KRSNC     SETLL@FLCPEB                    *
     C           KRSNC     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop NE PAR.USR Stop
     C           WFRVNB    IFNE WN0552                     *IF
     C                     ADD  1         WURRNB           Total Stops
     C                     Z-ADDWFRVNB    WN0552           USR Stop
     C                     END                             *FI
      * CASE: WRK.Company Number     041405 is Equal to zero
     C           WUBQC3    IFEQ 0                          *IF
     C                     Z-ADDWFAIC3    WUBQC3           Company Number
     C                     END                             *FI
      * Multi Company Load?               PKTR01 8/5/04
      * CASE: DB1.Company Number NE WRK.Company Number     041405
     C           WFAIC3    IFNE WUBQC3                     *IF
     C                     MOVEL'Y'       WURVSX           Multi Company L
     C                     END                             *FI
     C           KRSNC     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv Min Temp for Load RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     Z-ADD-99       #CPCNX           USR Temperature
     C                     MOVELWUOTTX    #2FRSX           Shipping Temp C
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQND02           Load ID
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQND02           Load ID
      * Establish starting position
     C           KRSND     SETLL@BFCPD9                    *
     C           KRSND     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * **** new 7/19/02
      * If db1 doesnt match par, convert db1 temp to par temp C or F
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Shipping Temp Code C/F NE WRK.Blank for 4
      *   |- c2    : PAR.Shipping Temp Code C/F NE DB1.Shipping Temp Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2FRSX    IFNE WUOTTX                     *IF
     C           #2FRSX    IFNE WBFRSX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Shipping Temp Code C/F is Celsius
     C           #2FRSX    IFEQ 'C'                        *IF
      * Convert DB1 to Celsius
      * Compute Cels from Fahr
      * LCL.USR Temperature 3.1 =
      *    *COMPUTE (((x1 - x2) * x3) / x4)
      * x1    : DB1.Reefer Temperature
      * -     : PGM.*Synon (17,7) work field
      * x2    : CON.32
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.5
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.9
     C           WBRNNB    SUB  32        W0WD02           *Synon (17,7) w
     C           W0WD02    MULT 5         W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  9         W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0080           USR Temperature
     C                     ELSE
      * CASE: *OTHERWISE
      * Convert DB1 to Fahr
      * Compute Fahr from Cels
      * LCL.USR Temperature 3.1 =
      *    *COMPUTE (((x1 * x3) / x4) + x2)
      * x1    : DB1.Reefer Temperature
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.9
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.5
      * +     : PGM.*Synon (17,7) work field
      * x2    : CON.32
     C           WBRNNB    MULT 9         W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  5         W0WD01    H      *Synon (17,7) w
     C           W0WD01    ADD  32        W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0080           USR Temperature
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBRNNB    YL0080           USR Temperature
     C                     END                             *FI
      * CASE: LCL.USR Temperature 3.1 GT PAR.USR Temperature 3.1
     C           YL0080    IFGT #CPCNX                     *IF
     C                     Z-ADDWBRNNB    #CPCNX           USR Temperature
     C                     MOVELWBFRSX    #2FRSX           Shipping Temp C
     C                     END                             *FI
     C           KRSND     READE@BFCPD9                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Temperature 3.1 is Low
     C           #CPCNX    IFEQ -99                        *IF
     C                     Z-ADD*ZERO     #CPCNX           USR Temperature
     C                     END                             *FI
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * RTV Load Header All,Mg RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSNE     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WN0553           Scheduled Ship
     C                     MOVELFJPJST    WUG0TX           LTL Flag
     C                     MOVELFJPKST    WUG0TX           Load Status
     C                     Z-ADDFJRNNB    WUNFNN           Reefer Temperat
     C                     MOVELFJDMTX    WUG0TX           Seal 1
     C                     MOVELFJDNTX    WUG0TX           Seal 2
     C                     MOVELFJDOTX    WUG0TX           Seal 3
     C                     Z-ADDFJRPNB    WUNFNN           Total Load Orde
     C                     Z-ADDFJFLAM    WN0554           Flat Amount
     C                     MOVELFJXQST    WUG0TX           Allocate Pounds
     C                     Z-ADDFJRRNB    WN0555           Total Stops
     C                     MOVELFJDXTX    WUG0TX           Trailer Id
     C                     MOVELFJDYTX    WUG0TX           Transloader Car
     C                     Z-ADDFJSBNB    WUNFNN           BOL Time
     C                     MOVELFJBZNA    WUG0TX           Carrier Code
     C                     MOVELFJRONB    WUG0TX           Truck Size
     C                     Z-ADDFJSQNB    WUNFNN           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    WUNFNN           Rated Freight
     C                     MOVELFJVCST    WUG0TX           Ship Status
     C                     MOVELFJVDST    WUG0TX           Load Type
     C                     Z-ADDFJSDNB    WUNFNN           Number Pallets
     C                     Z-ADDFJPAOU    WUNFNN           Number Pallets
     C                     Z-ADDFJDGWG    WUNFNN           Load Carrier Pa
     C                     Z-ADDFJSXNB    WUNFNN           Estimated Arriv
     C                     Z-ADDFJHADT    WUNFNN           Actual Arrival
     C                     Z-ADDFJAART    WUNFNN           Actual Arrival
     C                     Z-ADDFJDHWG    WUNFNN           Trailer IN Weig
     C                     Z-ADDFJDIWG    WUNFNN           Trailer OUT Wei
     C                     Z-ADDFJAQDT    WUNFNN           Actual Departur
     C                     Z-ADDFJS6NB    WUNFNN           Departure Time
     C                     Z-ADDFJT4NB    WUNFNN           Schedule Sequen
     C                     Z-ADDFJPRTM    WUNFNN           Product Tempera
     C                     Z-ADDFJNPSV    WUNFNN           Number Spacers
     C                     MOVELFJJ8TX    WUG0TX           Car/Veh. Initia
     C                     Z-ADDFJTLMI    WN0556           Total Load Mile
     C                     MOVELFJJ9TX    WUG0TX           Recorder ID
     C                     MOVELFJQ2CD    WUG0TX           Shipping Method
     C                     MOVELFJVPCD    WN0557           Ship From Wareh
     C                     MOVELFJDBCD    WN0558           Ship To State C
     C                     Z-ADDFJGRWE    WUNFNN           Gross Weight
     C                     MOVELFJXCCD    WN0559           Carrier Broker
     C                     MOVELFJU2ST    WN0560           Export Status
     C                     Z-ADDFJF9DT    WUNFNN           Actual Ship Dat
     C                     MOVELFJONTM    WUG0TX           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    WUNFNN           Truck Ready Dat
     C                     Z-ADDFJTRTM    WUNFNN           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WUNFNN           Spotted Date
     C                     Z-ADDFJSPTM    WUNFNN           Spotted Time
     C                     Z-ADDFJJ6DT    WUNFNN           Load Finished D
     C                     Z-ADDFJLFTM    WUNFNN           Load Finished T
     C                     Z-ADDFJJ7DT    WUNFNN           BOL Complete Da
     C                     Z-ADDFJBOTM    WUNFNN           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WUNFNN           BOL Received Da
     C                     Z-ADDFJBLTM    WUNFNN           BOL Received Ti
     C                     Z-ADDFJKIDT    WUNFNN           Truck Departure
     C                     Z-ADDFJASTM    WUNFNN           Truck Departure
     C                     Z-ADDFJKADT    WUNFNN           Adjusted Depart
     C                     Z-ADDFJAJCM    WUNFNN           Adjusted Depart
     C                     MOVELFJXACD    WUG0TX           Shipping Line
     C                     MOVELFJOANA    WUG0TX           Port Delv Termi
     C                     MOVELFJK4TX    WUG0TX           Vessel Name
     C                     Z-ADDFJVOAG    WUNFNN           Voyage
     C                     Z-ADDFJKBDT    WUNFNN           Sail Date
     C                     MOVELFJNBBO    WUG0TX           Booking Number
     C                     MOVELFJW4CD    WUG0TX           Discharge Port
     C                     Z-ADDFJEFDT    WUNFNN           Arrival Date
     C                     MOVELFJCNTN    WUG0TX           Container Numbe
     C                     Z-ADDFJKCDT    WUNFNN           Date In
     C                     Z-ADDFJTMIN    WUNFNN           Time In
     C                     Z-ADDFJKDDT    WUNFNN           Date Out
     C                     Z-ADDFJVMNB    WUNFNN           Time Out
     C                     Z-ADDFJOCFR    WUNFNN           Load Total Frei
     C                     Z-ADDFJKJDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDFJATTM    WUNFNN           Scheduled Deliv
     C                     MOVELFJOTRS    WUG0TX           LH Unused Sts
     C                     Z-ADDFJKKDT    WUNFNN           On Yard Date
     C                     Z-ADDFJAVTM    WUNFNN           On Yard Time
     C                     Z-ADDFJKZDT    WN0563           Deadline Depart
     C                     Z-ADDFJAXTM    WN0564           Deadline Depart
     C                     MOVELFJRYSX    WN0565           MG Created Load
     C                     GOTO NEEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0585  70       Total Load Mile
     C                     MOVEL*BLANK    WN0586  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0587  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0588  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSNF     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0086           Load ID
     C                     Z-ADD1         WL0087           Stop/Drop
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0088    WN0586    P      Warehouse Code
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           FJAJCD    IFEQ WN0586                     *IF
     C                     MOVEL*BLANK    WN0587           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELFJAJCD    WN0587           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           FJRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDFJTLMI    WN0585           Total Load Mile
     C                     Z-ADDFJK2DT    WN0588           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPFRC
     C                     Z-ADDFJRMNB    PFRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             KEY: Load Detai
     C           WN0585    PARM WN0585    WQ0303  70       Total Load Mile
     C           WN0588    PARM WN0588    WQ0304  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR NJCHRC
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQNG02           Load ID
      * Define keylist
     C           KPSNG     KLIST
     C                     KFLD           WQNG02           Load ID
     C                     KFLD           WFRVNB           Stop/Drop
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           WQNG02           Load ID
      * Setup key
     C                     Z-ADDWL0086    WQNG02           Load ID
     C                     Z-ADDWL0087    WFRVNB           Stop/Drop
      * Establish starting position
     C           KPSNG     SETLL@FLCPEB                    *
     C           KRSNG     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR NHRVGN
     C                     GOTO NGEXIT                     *QUIT
     C           KRSNG     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQNH01           Company Number
     C           *LIKE     DEFN WLC4NB    WQNH02           Order Number
      * Define keylist
     C           KPSNH     KLIST
     C                     KFLD           WQNH01           Company Number
     C                     KFLD           WQNH02           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WQNH01           Company Number
     C                     KFLD           WQNH02           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WQNH01           Company Number
     C                     Z-ADDWFC4NB    WQNH02           Order Number
     C                     Z-ADD*ZERO     WLDPNB           Order Sequence
     C                     Z-ADD*ZERO     WLUENB           Order Secondary
      * Establish starting position
     C           KPSNH     SETLL@BGWKAE                    *
     C           KRSNH     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0088           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR NIRVGN
      * PAR = DB1 By name
     C                     MOVELWLAJCD    WL0088           Warehouse Code
     C                     GOTO NHEXIT                     *QUIT
     C           KRSNH     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWLAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSNI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0589  30       Company Number
     C                     Z-ADD*ZERO     WN0590  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0591  1        LTL Flag
     C                     MOVEL*BLANK    WN0592  1        Load Status
     C                     Z-ADD*ZERO     WN0593  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0594 15        Seal 1
     C                     MOVEL*BLANK    WN0595 15        Seal 2
     C                     MOVEL*BLANK    WN0596 15        Seal 3
     C                     MOVEL*BLANK    WN0597 15        Seal 4
     C                     MOVEL*BLANK    WN0598 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0599  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0600 112       Flat Amount
     C                     MOVEL*BLANK    WN0601  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0602  50       Total Stops
     C                     MOVEL*BLANK    WN0603 20        Trailer Id
     C                     MOVEL*BLANK    WN0604  3        Transloader Car
     C                     Z-ADD*ZERO     WN0605  40       BOL Time
     C                     MOVEL*BLANK    WN0606  3        Carrier Code
     C                     MOVEL*BLANK    WN0607  7        Truck Size
     C                     Z-ADD*ZERO     WN0608  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0609 112       Rated Freight
     C                     MOVEL*BLANK    WN0610  1        Ship Status
     C                     MOVEL*BLANK    WN0611  1        Load Type
     C                     Z-ADD*ZERO     WN0612  50       Number Pallets
     C                     Z-ADD*ZERO     WN0613  50       Number Pallets
     C                     Z-ADD*ZERO     WN0614 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0615  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0616  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0617  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0618 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0619 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0620  70       Actual Departur
     C                     Z-ADD*ZERO     WN0621  40       Departure Time
     C                     Z-ADD*ZERO     WN0622  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0623  52       Product Tempera
     C                     Z-ADD*ZERO     WN0624  50       Number Spacers
     C                     MOVEL*BLANK    WN0625 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0626 12        Recorder ID
     C                     MOVEL*BLANK    WN0627  2        Shipping Method
     C                     MOVEL*BLANK    WN0628  2        Ship To State C
     C                     Z-ADD*ZERO     WN0629  70       Gross Weight
     C                     MOVEL*BLANK    WN0630  3        Carrier Broker
     C                     MOVEL*BLANK    WN0631  1        Export Status
     C                     Z-ADD*ZERO     WN0632  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0633  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0634  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0635  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0636  70       Spotted Date
     C                     Z-ADD*ZERO     WN0637  60       Spotted Time
     C                     Z-ADD*ZERO     WN0638  70       Load Finished D
     C                     Z-ADD*ZERO     WN0639  60       Load Finished T
     C                     Z-ADD*ZERO     WN0640  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0641  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0642  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0643  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0644  70       Truck Departure
     C                     Z-ADD*ZERO     WN0645  60       Truck Departure
     C                     Z-ADD*ZERO     WN0646  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0647  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0648  3        Shipping Line
     C                     MOVEL*BLANK    WN0649 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0650 30        Vessel Name
     C                     Z-ADD*ZERO     WN0651  50       Voyage
     C                     Z-ADD*ZERO     WN0652  70       Sail Date
     C                     MOVEL*BLANK    WN0653 12        Booking Number
     C                     MOVEL*BLANK    WN0654 20        Discharge Port
     C                     Z-ADD*ZERO     WN0655  70       Arrival Date
     C                     MOVEL*BLANK    WN0656 12        Container Numbe
     C                     Z-ADD*ZERO     WN0657  70       Date In
     C                     Z-ADD*ZERO     WN0658  60       Time In
     C                     Z-ADD*ZERO     WN0659  70       Date Out
     C                     Z-ADD*ZERO     WN0660  60       Time Out
     C                     Z-ADD*ZERO     WN0661 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0662  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0663  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0664  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0665  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0666  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0667  70       Requested Deliv
     C                     MOVEL*BLANK    WN0668  1        Load Acceptance
     C                     Z-ADD*ZERO     WN0669  70       On Yard Date
     C                     Z-ADD*ZERO     WN0670  60       On Yard Time
     C                     Z-ADD*ZERO     WN0671  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0672  60       Deadline Depart
     C                     MOVEL*BLANK    WN0673  1        Load Held Over
     C                     MOVEL*BLANK    WN0674  1        Load Held Over
     C                     MOVEL*BLANK    WN0675 15        Load Held Over
     C                     MOVEL*BLANK    WN0676 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0677 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0678  70       Express Mail Da
     C                     MOVEL*BLANK    WN0679  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0680  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0681  70       Product Complet
     C                     Z-ADD*ZERO     WN0682  60       Product Complet
     C                     Z-ADD*ZERO     WN0683  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0684  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0685  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0686  1        Load Confirmed
     C                     MOVEL*BLANK    WN0687 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0688  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0689  60       Load Door 1
     C                     Z-ADD*ZERO     WN0690  60       Load Door 2
     C                     MOVEL*BLANK    WN0691  1        Partial Load
     C                     MOVEL*BLANK    WN0692  1        Load Confirmati
     C                     MOVEL*BLANK    WN0693  1        Export Load USD
     C                     MOVEL*BLANK    WN0694  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0695 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0696 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0697 15        Late Billing Em
     C                     MOVEL*BLANK    WN0698 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0699 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0700  1        Multi Company L
     C                     MOVEL*BLANK    WN0701  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0702  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0703  1        LH Power Only L
     C                     MOVEL*BLANK    WN0704  1        MG Created Load
     C                     MOVEL*BLANK    WN0705  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0706  2        Load U/M
     C                     MOVEL*BLANK    WN0707  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0708  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0709  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0710  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0711  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0712  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0713  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0714  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0715  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0716  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0717  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0718  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0719  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0720  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0721  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0722  60       LH Unused Time
     C                     MOVEL*BLANK    WN0723  1        EDI Status 1
     C                     MOVEL*BLANK    WN0724  1        EDI Status 2
     C                     MOVEL*BLANK    WN0725  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0726  60       Job Time
     C                     MOVEL*BLANK    WN0727 10        User Id
     C                     MOVEL*BLANK    WN0728 10        Job Name
     C                     Z-ADD*ZERO     WN0729  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDFJRMNB    WIRMNB           Load ID
      *
     C           KLCHNJ    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHNJ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YERDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0585    WITLMI           Total Load Mile
     C                     MOVELWN0586    WIVPCD    P      Ship From Wareh
     C                     MOVELWN0587    WIAJCD    P      Warehouse Code
     C                     Z-ADDWN0588    WIK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQNK02           Load ID
      * Define keylist
     C           KPSNK     KLIST
     C                     KFLD           WQNK02           Load ID
     C                     KFLD           WFRVNB           Stop/Drop
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           WQNK02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNK02           Load ID
     C                     Z-ADD*ZERO     WFRVNB           Stop/Drop
      * Establish starting position
     C           KPSNK     SETLL@FLCPEB                    *
     C           KRSNK     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWFN7DT    WUN7DT           LD Carrier Appt
     C                     Z-ADDWFB3TM    WN0564           LD Carrier Appt
     C                     GOTO NKEXIT                     *QUIT
     C           KRSNK     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQNL02           Load ID
      * Define keylist
     C           KPSNL     KLIST
     C                     KFLD           WQNL02           Load ID
     C                     KFLD           WFRVNB           Stop/Drop
      * Define keylist
     C           KRSNL     KLIST
     C                     KFLD           WQNL02           Load ID
      * Setup key
     C                     Z-ADDWL0089    WQNL02           Load ID
     C                     Z-ADDWL0090    WFRVNB           Stop/Drop
      * Establish starting position
     C           KPSNL     SETLL@FLCPEB                    *
     C           KRSNL     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR NMRVGN
     C                     GOTO NLEXIT                     *QUIT
     C           KRSNL     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WHAIC3           Company Number
     C                     Z-ADDWFC4NB    WHC4NB           Order Number
      * Establish starting position
     C           KRSNM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WL0091           Requested Deliv
     C                     Z-ADD*ZERO     WL0092           Requested Deliv
     C                     GOTO NMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHBRTX    WUBRTX           Ship To Name
     C                     MOVELWHHNNA    WUHNNA           Ship To City
     C                     Z-ADDWHEIDT    WL0091           Requested Deliv
     C                     Z-ADDWHAFTM    WL0092           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0093    FJRMNB           Load ID
      * Establish starting position
     C           KRSNN     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJQ2CD    WL0094           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NORVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQNO02           Load ID
      * Define keylist
     C           KPSNO     KLIST
     C                     KFLD           WQNO02           Load ID
     C                     KFLD           WFRVNB           Stop/Drop
     C                     KFLD           WFC4NB           Order Number
      * Define keylist
     C           KRSNO     KLIST
     C                     KFLD           WQNO02           Load ID
      * Setup key
     C                     Z-ADDWL0095    WQNO02           Load ID
     C                     Z-ADDWL0096    WFRVNB           Stop/Drop
     C                     Z-ADDWL0097    WFC4NB           Order Number
      * Establish starting position
     C           KPSNO     SETLL@FLCPEB                    *
     C           KRSNO     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFRWNB    WL0098           Miles to next s
     C                     GOTO NOEXIT                     *QUIT
     C           KRSNO     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSNP     KLIST
     C                     KFLD           LGMILE           Miles to First
      * Setup key
     C                     Z-ADDWL0099    LGMILE           Miles to First
      * Establish starting position
     C           KPSNP     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLGHRRQ    WL0100           Hours Required
     C                     GOTO NPEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0101    FJRMNB           Load ID
      * Establish starting position
     C           KRSNQ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    WL0102           Load Status
     C                     Z-ADDFJTLMI    WL0103           Total Load Mile
     C                     Z-ADDFJK2DT    WL0104           Override Total
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMRMNB    WQNR02           Load ID
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WQNR02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNR02           Load ID
      * Establish starting position
     C           KRSNR     SETLL@FLCPE8                    *
     C           KRSNR     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR NSRVGN
     C                     GOTO NREXIT                     *QUIT
     C           KRSNR     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNS     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Setup key
     C                     Z-ADDWMAIC3    WHAIC3           Company Number
     C                     Z-ADDWMC4NB    WHC4NB           Order Number
      * Establish starting position
     C           KRSNS     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHBKC7    WUBKC7           Ship To Custome
     C                     MOVELWHBRTX    WUBRTX           Ship To Name
     C                     MOVELWHHMNA    WUHMNA           Ship To Address
     C                     MOVELWHHONA    WUHONA           Ship To Address
     C                     MOVELWHHPNA    WUHPNA           Ship To Address
     C                     MOVELWHHNNA    WUHNNA           Ship To City
     C                     MOVELWHDBCD    WN0558           Ship To State C
     C                     MOVELWHCKTX    WUCKTX           Ship To Zip/Pos
     C                     MOVELWHBCNA    WUG0TX           Customer Purcha
     C                     MOVELWHB6NA    WUG0TX           Special Instruc
     C                     MOVELWHBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWHEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWHAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQNT02           Load ID
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WQNT02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNT02           Load ID
      * Establish starting position
     C           KRSNT     SETLL@BFCPD9                    *
     C           KRSNT     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBHNNA    WN0568           Ship To City
     C                     MOVELWBDBCD    WN0569           Ship To State C
     C                     GOTO NTEXIT                     *QUIT
     C           KRSNT     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NURVGN    BEGSR
      *================================================================
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNU     KLIST
     C                     KFLD           LEBZNA           Carrier Code
     C                     KFLD           LEAJCD           Warehouse Code
     C                     KFLD           LEXECD           Destination Cit
     C                     KFLD           LEBGCD           State Code
      * Setup key
     C                     MOVELWN0559    LEBZNA           Carrier Code
     C                     MOVELWN0557    LEAJCD           Warehouse Code
     C                     MOVELWN0568    LEXECD           Destination Cit
     C                     MOVELWN0569    LEBGCD           State Code
      * Establish starting position
     C           KRSNU     CHAIN@LECPM7              90    *
      * Data record not found
     C   90                MOVEL'USR2455' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * only pass out FLAT amt.  (it could now be a ML rate too)  01/03/0
      * CASE: DB1.CDR Unit of Measure is Flat
     C           LEAVTX    IFEQ 'FL'                       *IF
      * PAR = DB1 By name
     C                     Z-ADDLENMVA    WN0554           Flat Rate
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVCHRC    BEGSR
      *================================================================
      * CHG Lock Load Update   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0739  30       Company Number
     C                     MOVEL*BLANK    WN0740  1        LTL Flag
     C                     Z-ADD*ZERO     WN0741  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0742 15        Seal 1
     C                     MOVEL*BLANK    WN0743 15        Seal 2
     C                     MOVEL*BLANK    WN0744 15        Seal 3
     C                     MOVEL*BLANK    WN0745 15        Seal 4
     C                     MOVEL*BLANK    WN0746 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0747  70       Total Load Orde
     C                     MOVEL*BLANK    WN0748  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0749  50       Total Stops
     C                     MOVEL*BLANK    WN0750 20        Trailer Id
     C                     MOVEL*BLANK    WN0751  3        Transloader Car
     C                     Z-ADD*ZERO     WN0752  40       BOL Time
     C                     MOVEL*BLANK    WN0753  3        Carrier Code
     C                     MOVEL*BLANK    WN0754  7        Truck Size
     C                     Z-ADD*ZERO     WN0755  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0756 112       Rated Freight
     C                     MOVEL*BLANK    WN0757  1        Ship Status
     C                     MOVEL*BLANK    WN0758  1        Load Type
     C                     Z-ADD*ZERO     WN0759  50       Number Pallets
     C                     Z-ADD*ZERO     WN0760  50       Number Pallets
     C                     Z-ADD*ZERO     WN0761 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0762  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0763  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0764  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0765 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0766 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0767  70       Actual Departur
     C                     Z-ADD*ZERO     WN0768  40       Departure Time
     C                     Z-ADD*ZERO     WN0769  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0770  52       Product Tempera
     C                     Z-ADD*ZERO     WN0771  50       Number Spacers
     C                     MOVEL*BLANK    WN0772 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0773  70       Total Load Mile
     C                     MOVEL*BLANK    WN0774 12        Recorder ID
     C                     MOVEL*BLANK    WN0775  2        Shipping Method
     C                     Z-ADD*ZERO     WN0776  70       Gross Weight
     C                     MOVEL*BLANK    WN0777  3        Carrier Broker
     C                     MOVEL*BLANK    WN0778  1        Export Status
     C                     Z-ADD*ZERO     WN0779  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0780  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0781  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0782  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0783  70       Spotted Date
     C                     Z-ADD*ZERO     WN0784  60       Spotted Time
     C                     Z-ADD*ZERO     WN0785  70       Load Finished D
     C                     Z-ADD*ZERO     WN0786  60       Load Finished T
     C                     Z-ADD*ZERO     WN0787  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0788  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0789  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0790  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0791  70       Truck Departure
     C                     Z-ADD*ZERO     WN0792  60       Truck Departure
     C                     Z-ADD*ZERO     WN0793  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0794  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0795  3        Shipping Line
     C                     MOVEL*BLANK    WN0796 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0797 30        Vessel Name
     C                     Z-ADD*ZERO     WN0798  50       Voyage
     C                     Z-ADD*ZERO     WN0799  70       Sail Date
     C                     MOVEL*BLANK    WN0800 12        Booking Number
     C                     MOVEL*BLANK    WN0801 20        Discharge Port
     C                     Z-ADD*ZERO     WN0802  70       Arrival Date
     C                     MOVEL*BLANK    WN0803 12        Container Numbe
     C                     Z-ADD*ZERO     WN0804  70       Date In
     C                     Z-ADD*ZERO     WN0805  60       Time In
     C                     Z-ADD*ZERO     WN0806  70       Date Out
     C                     Z-ADD*ZERO     WN0807  60       Time Out
     C                     Z-ADD*ZERO     WN0808 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0809  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0810  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0811  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0812  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0813  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0814  70       Requested Deliv
     C                     MOVEL*BLANK    WN0815  1        Load Acceptance
     C                     MOVEL*BLANK    WN0816  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0817  70       On Yard Date
     C                     Z-ADD*ZERO     WN0818  60       On Yard Time
     C                     MOVEL*BLANK    WN0819  1        Load Held Over
     C                     MOVEL*BLANK    WN0820  1        Load Held Over
     C                     MOVEL*BLANK    WN0821 15        Load Held Over
     C                     MOVEL*BLANK    WN0822 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0823 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0824  70       Express Mail Da
     C                     MOVEL*BLANK    WN0825  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0826  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0827  70       Product Complet
     C                     Z-ADD*ZERO     WN0828  60       Product Complet
     C                     Z-ADD*ZERO     WN0829  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0830  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0831  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0832  1        Load Confirmed
     C                     MOVEL*BLANK    WN0833 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0834  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0835  60       Load Door 1
     C                     Z-ADD*ZERO     WN0836  70       Override Total
     C                     Z-ADD*ZERO     WN0837  60       Load Door 2
     C                     MOVEL*BLANK    WN0838  1        Partial Load
     C                     MOVEL*BLANK    WN0839  1        Load Confirmati
     C                     MOVEL*BLANK    WN0840  1        Export Load USD
     C                     MOVEL*BLANK    WN0841  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0842 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0843 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0844 15        Late Billing Em
     C                     MOVEL*BLANK    WN0845 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0846 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0847  1        Multi Company L
     C                     MOVEL*BLANK    WN0848  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0849  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0850  1        LH Power Only L
     C                     MOVEL*BLANK    WN0851  1        MG Created Load
     C                     MOVEL*BLANK    WN0852  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0853  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0854  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0855  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0856  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0857  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0858  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0859  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0860  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0861  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0862  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0863  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0864  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0865  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0866  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0867  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0868  60       LH Unused Time
     C                     MOVEL*BLANK    WN0869  1        EDI Status 1
     C                     MOVEL*BLANK    WN0870  1        EDI Status 2
     C                     MOVEL*BLANK    WN0871  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0872  60       Job Time
     C                     MOVEL*BLANK    WN0873 10        User Id
     C                     MOVEL*BLANK    WN0874 10        Job Name
     C                     Z-ADD*ZERO     WN0875  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#2RMNB    WIRMNB           Load ID
      *
     C           KLCHNV    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHNV    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YFRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0553    WIAODT           Scheduled Ship
     C                     MOVEL'L'       WIPKST    P      Load Status
     C                     Z-ADDWN0554    WIFLAM           Flat Amount
     C                     MOVELWN0557    WIVPCD    P      Ship From Wareh
     C                     MOVELWN0558    WIDBCD    P      Ship To State C
     C                     Z-ADDWN0563    WIKZDT           Deadline Depart
     C                     Z-ADDWN0564    WIAXTM           Deadline Depart
     C                     MOVELWN0566    WIR0SX    P      Load U/M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWRVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0570           USR Warehouse C
     C                     MOVEL*BLANK    WN0571           USR CDE Parm 1
     C                     MOVEL*BLANK    WN0572           USR CDE Parm 2
     C                     MOVEL*BLANK    WN0573           USR CDE Parm 3
     C                     MOVEL*BLANK    WN0574           USR CDE Parm 4
     C                     MOVEL*BLANK    WN0575           USR CDE Parm 5
     C                     MOVEL*BLANK    WN0576           USR CDE Parm 6
     C                     MOVEL*BLANK    WN0577           USR CDE Parm 7
     C                     MOVEL*BLANK    WN0578           USR CDE Parm 8
     C                     MOVEL*BLANK    WN0579           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WORMNB    WQNW02           Load ID
      * Define keylist
     C           KRSNW     KLIST
     C                     KFLD           WQNW02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQNW02           Load ID
      * Establish starting position
     C           KRSNW     SETLL@FLCPKF                    *
     C           KRSNW     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR NXRVGN
     C           KRSNW     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQNX01           Company Number
     C           *LIKE     DEFN WLC4NB    WQNX02           Order Number
      * Define keylist
     C           KPSNX     KLIST
     C                     KFLD           WQNX01           Company Number
     C                     KFLD           WQNX02           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           WQNX01           Company Number
     C                     KFLD           WQNX02           Order Number
      * Setup key
     C                     Z-ADDWOAIC3    WQNX01           Company Number
     C                     Z-ADDWOC4NB    WQNX02           Order Number
     C                     Z-ADD*ZERO     WLDPNB           Order Sequence
     C                     Z-ADD*ZERO     WLUENB           Order Secondary
      * Establish starting position
     C           KPSNX     SETLL@BGWKAE                    *
     C           KRSNX     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           WLAJCD    IFEQ WN0570                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           WLAJCD    IFEQ WN0571                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           WLAJCD    IFEQ WN0572                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           WLAJCD    IFEQ WN0573                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           WLAJCD    IFEQ WN0574                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           WLAJCD    IFEQ WN0575                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           WLAJCD    IFEQ WN0576                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           WLAJCD    IFEQ WN0577                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           WLAJCD    IFEQ WN0578                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           WLAJCD    IFEQ WN0579                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           WN0570    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0570           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           WN0571    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0571           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           WN0572    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0572           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           WN0573    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0573           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           WN0574    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0574           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           WN0575    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0575           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           WN0576    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0576           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           WN0577    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0577           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           WN0578    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0578           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           WN0579    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0579           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNX     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQNY01           Load ID
      * Define keylist
     C           KRSNY     KLIST
     C                     KFLD           WQNY01           Load ID
      * Setup key
     C                     Z-ADDWL0105    WQNY01           Load ID
      * Establish starting position
     C           KRSNY     SETLL@FLCPBW                    *
     C           KRSNY     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR NZRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WL0106           Trans Contol AS
     C                     GOTO NYEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNY     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNZ     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WHAIC3           Company Number
     C                     Z-ADDFLC4NB    WHC4NB           Order Number
      * Establish starting position
     C           KRSNZ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR OARVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO NZEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OARVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQOA01           Company Number
     C           *LIKE     DEFN OMC4NB    WQOA02           Order Number
      * Define keylist
     C           KRSOA     KLIST
     C                     KFLD           WQOA01           Company Number
     C                     KFLD           WQOA02           Order Number
      * Setup key
     C                     Z-ADDWHAIC3    WQOA01           Company Number
     C                     Z-ADDWHC4NB    WQOA02           Order Number
      * Establish starting position
     C           KRSOA     SETLL@BGWKL1                    *
     C           KRSOA     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR OBRVGN
     C                     GOTO OAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSOA     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOB     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSOB     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO OBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDF8NA    WUF8NA           Warehouse Descr
     C                     MOVELWDXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOC     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0107    BUY1NX           PFS Company Num
     C                     MOVELWL0108    BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSOC     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0109           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0110           PFS Carlisle Ac
     C                     GOTO OCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    WL0109           PFS AccuSort Ac
     C                     MOVELBUWUSX    WL0110           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODRVGN    BEGSR
      *================================================================
      * RTV Defaulted Fields   RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOD     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0111    FJRMNB           Load ID
      * Establish starting position
     C           KRSOD     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJFLAM    WL0112           Flat Amount
     C                     MOVELFJVPCD    WL0113           Ship From Wareh
     C                     MOVELFJDBCD    WL0114           Ship To State C
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OECHRC    BEGSR
      *================================================================
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0881  30       Company Number
     C                     Z-ADD*ZERO     WN0882  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0883  1        LTL Flag
     C                     Z-ADD*ZERO     WN0884  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0885 15        Seal 1
     C                     MOVEL*BLANK    WN0886 15        Seal 2
     C                     MOVEL*BLANK    WN0887 15        Seal 3
     C                     MOVEL*BLANK    WN0888 15        Seal 4
     C                     MOVEL*BLANK    WN0889 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0890  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0891 112       Flat Amount
     C                     MOVEL*BLANK    WN0892  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0893  50       Total Stops
     C                     MOVEL*BLANK    WN0894 20        Trailer Id
     C                     MOVEL*BLANK    WN0895  3        Transloader Car
     C                     Z-ADD*ZERO     WN0896  40       BOL Time
     C                     MOVEL*BLANK    WN0897  3        Carrier Code
     C                     MOVEL*BLANK    WN0898  7        Truck Size
     C                     Z-ADD*ZERO     WN0899  70       Ld Hdr/Ld Dtl U
     C                     MOVEL*BLANK    WN0900  1        Ship Status
     C                     MOVEL*BLANK    WN0901  1        Load Type
     C                     Z-ADD*ZERO     WN0902  50       Number Pallets
     C                     Z-ADD*ZERO     WN0903  50       Number Pallets
     C                     Z-ADD*ZERO     WN0904 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0905  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0906  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0907  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0908 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0909 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0910  70       Actual Departur
     C                     Z-ADD*ZERO     WN0911  40       Departure Time
     C                     Z-ADD*ZERO     WN0912  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0913  52       Product Tempera
     C                     Z-ADD*ZERO     WN0914  50       Number Spacers
     C                     MOVEL*BLANK    WN0915 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0916  70       Total Load Mile
     C                     MOVEL*BLANK    WN0917 12        Recorder ID
     C                     MOVEL*BLANK    WN0918  2        Shipping Method
     C                     MOVEL*BLANK    WN0919  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0920  2        Ship To State C
     C                     Z-ADD*ZERO     WN0921  70       Gross Weight
     C                     MOVEL*BLANK    WN0922  3        Carrier Broker
     C                     MOVEL*BLANK    WN0923  1        Export Status
     C                     Z-ADD*ZERO     WN0924  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0925  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0926  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0927  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0928  70       Spotted Date
     C                     Z-ADD*ZERO     WN0929  60       Spotted Time
     C                     Z-ADD*ZERO     WN0930  70       Load Finished D
     C                     Z-ADD*ZERO     WN0931  60       Load Finished T
     C                     Z-ADD*ZERO     WN0932  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0933  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0934  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0935  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0936  70       Truck Departure
     C                     Z-ADD*ZERO     WN0937  60       Truck Departure
     C                     Z-ADD*ZERO     WN0938  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0939  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0940  3        Shipping Line
     C                     MOVEL*BLANK    WN0941 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0942 30        Vessel Name
     C                     Z-ADD*ZERO     WN0943  50       Voyage
     C                     Z-ADD*ZERO     WN0944  70       Sail Date
     C                     MOVEL*BLANK    WN0945 12        Booking Number
     C                     MOVEL*BLANK    WN0946 20        Discharge Port
     C                     Z-ADD*ZERO     WN0947  70       Arrival Date
     C                     MOVEL*BLANK    WN0948 12        Container Numbe
     C                     Z-ADD*ZERO     WN0949  70       Date In
     C                     Z-ADD*ZERO     WN0950  60       Time In
     C                     Z-ADD*ZERO     WN0951  70       Date Out
     C                     Z-ADD*ZERO     WN0952  60       Time Out
     C                     Z-ADD*ZERO     WN0953 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0954  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0955  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0956  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0957  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0958  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0959  70       Requested Deliv
     C                     MOVEL*BLANK    WN0960  1        Load Acceptance
     C                     MOVEL*BLANK    WN0961  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0962  70       On Yard Date
     C                     Z-ADD*ZERO     WN0963  60       On Yard Time
     C                     Z-ADD*ZERO     WN0964  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0965  60       Deadline Depart
     C                     MOVEL*BLANK    WN0966  1        Load Held Over
     C                     MOVEL*BLANK    WN0967  1        Load Held Over
     C                     MOVEL*BLANK    WN0968 15        Load Held Over
     C                     MOVEL*BLANK    WN0969 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0970 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0971  70       Express Mail Da
     C                     MOVEL*BLANK    WN0972  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0973  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0974  70       Product Complet
     C                     Z-ADD*ZERO     WN0975  60       Product Complet
     C                     Z-ADD*ZERO     WN0976  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0977  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0978  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0979  1        Load Confirmed
     C                     MOVEL*BLANK    WN0980 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0981  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0982  60       Load Door 1
     C                     Z-ADD*ZERO     WN0983  70       Override Total
     C                     Z-ADD*ZERO     WN0984  60       Load Door 2
     C                     MOVEL*BLANK    WN0985  1        Partial Load
     C                     MOVEL*BLANK    WN0986  1        Load Confirmati
     C                     MOVEL*BLANK    WN0987  1        Export Load USD
     C                     MOVEL*BLANK    WN0988  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0989 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0990 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0991 15        Late Billing Em
     C                     MOVEL*BLANK    WN0992 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0993 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0994  1        Multi Company L
     C                     MOVEL*BLANK    WN0995  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0996  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0997  1        LH Power Only L
     C                     MOVEL*BLANK    WN0998  1        MG Created Load
     C                     MOVEL*BLANK    WN0999  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1000  2        Load U/M
     C                     MOVEL*BLANK    WN1001  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1002  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1003  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1004  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1005  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1006  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1007  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1008  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1009  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1010  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1011  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1012  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1013  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1014  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1015  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1016  60       LH Unused Time
     C                     MOVEL*BLANK    WN1017  1        EDI Status 1
     C                     MOVEL*BLANK    WN1018  1        EDI Status 2
     C                     MOVEL*BLANK    WN1019  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1020  60       Job Time
     C                     MOVEL*BLANK    WN1021 10        User Id
     C                     MOVEL*BLANK    WN1022 10        Job Name
     C                     Z-ADD*ZERO     WN1023  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#2RMNB    WIRMNB           Load ID
      *
     C           KLCHOE    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHOE    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YGRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WIPKST    P      Load Status
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFRVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOF     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,007   DPDOCD           System Value Co
      * Establish starting position
     C           KRSOF     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0087           System Value Al
     C                     GOTO OFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDPBXTX    YL0087           System Value Al
     C                     ENDIF
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQOG02           Load ID
      * Define keylist
     C           KRSOG     KLIST
     C                     KFLD           WQOG02           Load ID
      * Setup key
     C                     Z-ADDWL0115    WQOG02           Load ID
      * Establish starting position
     C           KRSOG     SETLL@FLCPEB                    *
     C           KRSOG     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Recovery Freight   CH - Load Detail  * 
     C                     EXSR OHCHRC
      * CHG Clear Rated Frt    RT - PD Order Header  * 
     C                     EXSR OIRVGN
     C           KRSOG     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1028  50       Stop/Drop
     C                     MOVEL*BLANK    WN1029 30        Comments for Pi
     C                     Z-ADD*ZERO     WN1030  72       Freight Charge
     C                     Z-ADD*ZERO     WN1031  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1032  30       Company Number
     C                     Z-ADD*ZERO     WN1033  70       Order Number
     C                     MOVEL*BLANK    WN1034  1        Ship Status
     C                     Z-ADD*ZERO     WN1035  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN1036  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1037  70       Appointment Con
     C                     Z-ADD*ZERO     WN1038  60       Appointment Con
     C                     MOVEL*BLANK    WN1039 30        Confirmation Ma
     C                     MOVEL*BLANK    WN1040 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN1041  70       Actual Delivery
     C                     Z-ADD*ZERO     WN1042  60       Actual Delivery
     C                     Z-ADD*ZERO     WN1043  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1044  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1045  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1046  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1047  70       On Yard Date
     C                     Z-ADD*ZERO     WN1048  60       On Yard Time
     C                     Z-ADD*ZERO     WN1049  70       MPC Number
     C                     MOVEL*BLANK    WN1050  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN1051  1        On Time Add'l R
     C                     MOVEL*BLANK    WN1052 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN1053 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN1054 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN1055 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN1056 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN1057  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1058  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1059  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1060  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1061  60       LD Unused Time
     C                     Z-ADD*ZERO     WN1062  60       LD Unused Time
     C                     MOVEL*BLANK    WN1063  1        Miles Error Sts
     C                     MOVEL*BLANK    WN1064  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN1065  2        HPB Transload S
     C                     MOVEL*BLANK    WN1066 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN1067 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN1068 25        Cust Assigned A
     C                     MOVEL*BLANK    WN1069  1        EDI Status 1
     C                     MOVEL*BLANK    WN1070  1        EDI Status 2
     C                     MOVEL*BLANK    WN1071  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1072  60       Job Time
     C                     MOVEL*BLANK    WN1073 10        User Id
     C                     MOVEL*BLANK    WN1074 10        Job Name
     C                     Z-ADD*ZERO     WN1075  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWFRMNB    WRRMNB           Load ID
     C                     Z-ADDWFRUNB    WRRUNB           Stop/Drop Seque
      *
     C           KLCHOH    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop/Drop Seque
     C           KLCHOH    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YHRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWFRWNB    WRRWNB           Miles to next s
     C                     Z-ADD*ZERO     WRT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WRT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WRR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WRAATM' defaulted for 'Job Time'.
      * Field '(DB1) WRAYNA' defaulted for 'User Id'.
      * Field '(DB1) WRA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WRAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OIRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSRMNB    WQOI02           Load ID
     C           *LIKE     DEFN WSC4NB    WQOI03           Order Number
      * Define keylist
     C           KRSOI     KLIST
     C                     KFLD           WQOI02           Load ID
     C                     KFLD           WQOI03           Order Number
      * Setup key
     C                     Z-ADDWFRMNB    WQOI02           Load ID
     C                     Z-ADDWFC4NB    WQOI03           Order Number
      * Establish starting position
     C           KRSOI     SETLL@BFCPNQ                    *
     C           KRSOI     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rated Freight      CH - PD Order Header  * 
     C                     EXSR OJCHRC
      * 05/13/04 slm Multi-Company - Order Header lv remove co must use d
      *                               was using the par replace with db1
      * UPD Rated Freight      RT - Order Detail  * 
     C                     EXSR OKRVGN
     C           KRSOI     READE@BFCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         OJCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1076  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1077  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1078  70       Ship To Custome
     C                     MOVEL*BLANK    WN1079 30        Ship To Name
     C                     MOVEL*BLANK    WN1080 30        Ship To Address
     C                     MOVEL*BLANK    WN1081 30        Ship To Address
     C                     MOVEL*BLANK    WN1082 30        Ship To Address
     C                     MOVEL*BLANK    WN1083 20        Ship To City
     C                     MOVEL*BLANK    WN1084  2        Ship To State C
     C                     MOVEL*BLANK    WN1085 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1086  70       Bill to Custome
     C                     MOVEL*BLANK    WN1087 30        Bill to Name
     C                     MOVEL*BLANK    WN1088 30        Bill to Address
     C                     MOVEL*BLANK    WN1089 30        Bill to Address
     C                     MOVEL*BLANK    WN1090 30        Bill to Address
     C                     MOVEL*BLANK    WN1091 20        Bill to City
     C                     MOVEL*BLANK    WN1092  2        Bill to State C
     C                     MOVEL*BLANK    WN1093 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1094 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1095  70       Order Date
     C                     Z-ADD*ZERO     WN1096  70       Requested Ship
     C                     Z-ADD*ZERO     WN1097  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1098  70       Cancel Date
     C                     MOVEL*BLANK    WN1099  2        Terms Code
     C                     MOVEL*BLANK    WN1100 40        Special Instruc
     C                     MOVEL*BLANK    WN1101 40        Special Instruc
     C                     MOVEL*BLANK    WN1102  3        Carrier Code
     C                     MOVEL*BLANK    WN1103  1        Comment Print A
     C                     MOVEL*BLANK    WN1104  1        Comment Print I
     C                     MOVEL*BLANK    WN1105  1        Comment Print P
     C                     MOVEL*BLANK    WN1106  1        Comment Print S
     C                     MOVEL*BLANK    WN1107  3        Reason Code
     C                     MOVEL*BLANK    WN1108  1        Order in Use
     C                     MOVEL*BLANK    WN1109  1        Header Status
     C                     MOVEL*BLANK    WN1110  1        Header Status L
     C                     MOVEL*BLANK    WN1111  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1112  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1113 10        User Original E
     C                     Z-ADD*ZERO     WN1114  70       Date of Origina
     C                     Z-ADD*ZERO     WN1115 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1116 112       Order Weight To
     C                     MOVEL*BLANK    WN1117  1        Credit Hold
     C                     MOVEL*BLANK    WN1118  1        Production Hold
     C                     MOVEL*BLANK    WN1119  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1120  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1121  40       Requested Deliv
     C                     MOVEL*BLANK    WN1122  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1123 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1124  70       Load ID
     C                     Z-ADD*ZERO     WN1125  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN1126  1        LTL Flag
     C                     MOVEL*BLANK    WN1127  1        Price Audit
     C                     MOVEL*BLANK    WN1128  1        Price Status
     C                     MOVEL*BLANK    WN1129  2        Shipping Method
     C                     MOVEL*BLANK    WN1130  1        Export Status
     C                     MOVEL*BLANK    WN1131  1        Palletize
     C                     MOVEL*BLANK    WN1132  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1133  1        Slip Sheet
     C                     MOVEL*BLANK    WN1134  1        Age Code
     C                     Z-ADD*ZERO     WN1135  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1136  1        Load Type
     C                     Z-ADD*ZERO     WN1137  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1138  1        Load Plan Order
     C                     MOVEL*BLANK    WN1139  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1140  70       Resell Referenc
     C                     MOVEL*BLANK    WN1141 30        Special Comment
     C                     MOVEL*BLANK    WN1142 30        Special Comment
     C                     MOVEL*BLANK    WN1143  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1144  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1145  2        Manager Level C
     C                     MOVEL*BLANK    WN1146  3        VP Level Code
     C                     Z-ADD*ZERO     WN1147  70       Attach to Order
     C                     MOVEL*BLANK    WN1148  3        Reason for Pric
     C                     Z-ADD*ZERO     WN1149  70       Invoice Number
     C                     MOVEL*BLANK    WN1150  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1151  70       Invoice Date
     C                     MOVEL*BLANK    WN1152  2        Event Code
     C                     MOVEL*BLANK    WN1153  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1154  1        Modified Flag
     C                     Z-ADD*ZERO     WN1155 112       A/R order Value
     C                     MOVEL*BLANK    WN1156  1        Billing Activit
     C                     MOVEL*BLANK    WN1157  1        Block Order Fla
     C                     MOVEL*BLANK    WN1158  1        Order Certifica
     C                     Z-ADD*ZERO     WN1159 112       Invoice Order V
     C                     MOVEL*BLANK    WN1160  1        Process Sts for
     C                     MOVEL*BLANK    WN1161  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1162  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1163  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1164  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1165  1        Email Cust On O
     C                     MOVEL*BLANK    WN1166  1        Order Emailed
     C                     MOVEL*BLANK    WN1167  1        Export Docs Go
     C                     MOVEL*BLANK    WN1168  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1169  1        Broker Order St
     C                     MOVEL*BLANK    WN1170  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1171  2        Order Requires
     C                     MOVEL*BLANK    WN1172  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1173  2        Export USDA App
     C                     MOVEL*BLANK    WN1174  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1175  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1176  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1177  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1178  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1179  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1180  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1181  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1182  60       Time of Origina
     C                     Z-ADD*ZERO     WN1183  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1184  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1185  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1186 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1187 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1188 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1189 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1190 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1191  70       Claim Number
     C                     MOVEL*BLANK    WN1192  1        EDI Status 1
     C                     MOVEL*BLANK    WN1193  1        EDI Status 2
     C                     MOVEL*BLANK    WN1194  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1195  60       Job Time
     C                     MOVEL*BLANK    WN1196 10        User Id
     C                     MOVEL*BLANK    WN1197 10        Job Name
     C                     Z-ADD*ZERO     WN1198  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWSAIC3    WKAIC3           Company Number
     C                     Z-ADDWSC4NB    WKC4NB           Order Number
      *
     C           KLCHOJ    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C           KLCHOJ    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YIRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPERC
     C                     Z-ADDWKAIC3    PEAIC3           Company Number
     C                     Z-ADDWKC4NB    PEC4NB           Order Number
     C                     MOVELWKJNCD    PEJNCD    P      Order Type - Sa
     C                     Z-ADDWKANC7    PEANC7           A/R Customer Nu
     C                     Z-ADDWKBKC7    PEBKC7           Ship To Custome
     C                     MOVELWKBRTX    PEBRTX    P      Ship To Name
     C                     MOVELWKHMNA    PEHMNA    P      Ship To Address
     C                     MOVELWKHONA    PEHONA    P      Ship To Address
     C                     MOVELWKHPNA    PEHPNA    P      Ship To Address
     C                     MOVELWKHNNA    PEHNNA    P      Ship To City
     C                     MOVELWKDBCD    PEDBCD    P      Ship To State C
     C                     MOVELWKCKTX    PECKTX    P      Ship To Zip/Pos
     C                     Z-ADDWKB0C7    PEB0C7           Bill to Custome
     C                     MOVELWKAETX    PEAETX    P      Bill to Name
     C                     MOVELWKB1NA    PEB1NA    P      Bill to Address
     C                     MOVELWKB3NA    PEB3NA    P      Bill to Address
     C                     MOVELWKB4NA    PEB4NA    P      Bill to Address
     C                     MOVELWKB2NA    PEB2NA    P      Bill to City
     C                     MOVELWKBHCD    PEBHCD    P      Bill to State C
     C                     MOVELWKC8TX    PEC8TX    P      Bill to Zip/Pos
     C                     MOVELWKBCNA    PEBCNA    P      Customer Purcha
     C                     Z-ADDWKA0DT    PEA0DT           Order Date
     C                     Z-ADDWKA5DT    PEA5DT           Requested Ship
     C                     Z-ADDWKGNDT    PEGNDT           Actual Shipped
     C                     Z-ADDWKACDT    PEACDT           Cancel Date
     C                     MOVELWKAQCD    PEAQCD    P      Terms Code
     C                     MOVELWKB6NA    PEB6NA    P      Special Instruc
     C                     MOVELWKBYNA    PEBYNA    P      Special Instruc
     C                     MOVELWKBZNA    PEBZNA    P      Carrier Code
     C                     MOVELWKGTST    PEGTST    P      Comment Print A
     C                     MOVELWKGVST    PEGVST    P      Comment Print I
     C                     MOVELWKGUST    PEGUST    P      Comment Print P
     C                     MOVELWKQFST    PEQFST    P      Comment Print S
     C                     MOVELWKCQCD    PECQCD    P      Reason Code
     C                     MOVELWKGJST    PEGJST    P      Order in Use
     C                     MOVELWKGWST    PEGWST    P      Header Status
     C                     MOVELWKGXST    PEGXST    P      Header Status L
     C                     MOVELWKGYST    PEGYST    P      Order Type Prin
     C                     Z-ADDWKAODT    PEAODT           Scheduled Ship
     C                     MOVELWKAIVN    PEAIVN    P      User Original E
     C                     Z-ADDWKCXDT    PECXDT           Date of Origina
     C                     Z-ADDWKJZVA    PEJZVA           Order Value Tot
     C                     Z-ADDWKA1WG    PEA1WG           Order Weight To
     C                     MOVELWKXIST    PEXIST    P      Credit Hold
     C                     MOVELWKXJST    PEXJST    P      Production Hold
     C                     MOVELWKXKST    PEXKST    P      New Customer Ho
     C                     Z-ADDWKEIDT    PEEIDT           Requested Deliv
     C                     Z-ADDWKAFTM    PEAFTM           Requested Deliv
     C                     MOVELWKE8CD    PEE8CD    P      Accounts Receiv
     C                     MOVELWKE9CD    PEE9CD    P      Accounts Receiv
     C                     Z-ADDWKRMNB    PERMNB           Load ID
     C                     Z-ADDWKTBNB    PETBNB           Absorbed Freigh
     C                     Z-ADDWKR1NB    PER1NB           Rated Freight
     C                     MOVELWKPJST    PEPJST    P      LTL Flag
     C                     MOVELWKU0ST    PEU0ST    P      Price Audit
     C                     MOVELWKU1ST    PEU1ST    P      Price Status
     C                     MOVELWKQ2CD    PEQ2CD    P      Shipping Method
     C                     MOVELWKU2ST    PEU2ST    P      Export Status
     C                     MOVELWKVEST    PEVEST    P      Palletize
     C                     MOVELWKVFST    PEVFST    P      Shrink Wrap
     C                     MOVELWKVGST    PEVGST    P      Slip Sheet
     C                     MOVELWKRPCD    PERPCD    P      Age Code
     C                     Z-ADDWKRNNB    PERNNB           Reefer Temperat
     C                     MOVELWKVDST    PEVDST    P      Load Type
     C                     Z-ADDWKATIN    PEATIN           Attach to Invoi
     C                     MOVELWKU4ST    PEU4ST    P      Load Plan Order
     C                     MOVELWKU5ST    PEU5ST    P      Print Pick Slip
     C                     Z-ADDWKRSRN    PERSRN           Resell Referenc
     C                     MOVELWKMHNA    PEMHNA    P      Special Comment
     C                     MOVELWKMINA    PEMINA    P      Special Comment
     C                     MOVELWKWBST    PEWBST    P      Affect Auto Acc
     C                     MOVELWKR4CD    PER4CD    P      Sales Route Cod
     C                     MOVELWKBFCD    PEBFCD    P      Manager Level C
     C                     MOVELWKQ4CD    PEQ4CD    P      VP Level Code
     C                     Z-ADDWKT3NB    PET3NB           Attach to Order
     C                     MOVELWKSICD    PESICD    P      Reason for Pric
     C                     Z-ADDWKCONB    PECONB           Invoice Number
     C                     MOVELWKCEST    PECEST    P      Invoice Suffix
     C                     Z-ADDWKAWDT    PEAWDT           Invoice Date
     C                     MOVELWKJPCD    PEJPCD    P      Event Code
     C                     MOVELWKXUST    PEXUST    P      Trans Contol AS
     C                     MOVELWKZ1ST    PEZ1ST    P      Modified Flag
     C                     Z-ADDWKVRVA    PEVRVA           A/R order Value
     C                     MOVELWKOBST    PEOBST    P      Billing Activit
     C                     MOVELWKBCST    PEBCST    P      Block Order Fla
     C                     MOVELWKBDST    PEBDST    P      Order Certifica
     C                     Z-ADDWKB7VL    PEB7VL           Invoice Order V
     C                     MOVELWKGASX    PEGASX    P      Process Sts for
     C                     MOVELWKGBSX    PEGBSX    P      Order Conf Fax
     C                     MOVELWKGCSX    PEGCSX    P      Manifest Fax St
     C                     MOVELWKGDSX    PEGDSX    P      Invoice Fax Sts
     C                     MOVELWKFNSX    PEFNSX    P      Transfer in Sto
     C                     MOVELWKFOSX    PEFOSX    P      Email Cust On O
     C                     MOVELWKFPSX    PEFPSX    P      Order Emailed
     C                     MOVELWKFQSX    PEFQSX    P      Export Docs Go
     C                     MOVELWKFRSX    PEFRSX    P      Shipping Temp C
     C                     MOVELWKFSSX    PEFSSX    P      Broker Order St
     C                     MOVELWKFTSX    PEFTSX    P      Air Freight Ord
     C                     MOVELWKFUSX    PEFUSX    P      Order Requires
     C                     MOVELWKFVSX    PEFVSX    P      OH Load Plan Re
     C                     MOVELWKFWSX    PEFWSX    P      Export USDA App
     C                     MOVELWKFXSX    PEFXSX    P      HPB Ship to War
     C                     MOVELWKFYSX    PEFYSX    P      OH TF Exempt Co
     C                     Z-ADDWKNODT    PENODT           OH Appt Confirm
     C                     Z-ADDWKNPDT    PENPDT           JPN Invoice Iss
     C                     Z-ADDWKNQDT    PENQDT           Load Actual Shi
     C                     Z-ADDWKNRDT    PENRDT           Load BOL Comple
     C                     Z-ADDWKNSDT    PENSDT           Load Truck Depa
     C                     Z-ADDWKBPTM    PEBPTM           Maximum Gross W
     C                     Z-ADDWKBQTM    PEBQTM           Time of Origina
     C                     Z-ADDWKBRTM    PEBRTM           OH Appt Confirm
     C                     Z-ADDWKBSTM    PEBSTM           Load BOL Comple
     C                     Z-ADDWKBTTM    PEBTTM           Load Truck Depa
     C                     Z-ADDWKH0NX    PEH0NX           Act Frt Referen
     C                     Z-ADDWKH1NX    PEH1NX           Act Non-Ref Frt
     C                     Z-ADDWKH2NX    PEH2NX           OH Fuel Surchar
     C                     Z-ADDWKH3NX    PEH3NX           OH Total Non-Re
     C                     Z-ADDWKH4NX    PEH4NX           OH Total Ref Fr
     C                     Z-ADDWKC0C7    PEC0C7           Claim Number
     C                     MOVELWKUVST    PEUVST    P      EDI Status 1
     C                     MOVELWKUWST    PEUWST    P      EDI Status 2
     C                     MOVELWKUXST    PEUXST    P      EDI Status 3
     C                     Z-ADDWKAATM    PEAATM           Job Time
     C                     MOVELWKAYNA    PEAYNA    P      User Id
     C                     MOVELWKA0NA    PEA0NA    P      Job Name
     C                     Z-ADDWKAXDT    PEAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OJEXIT    ENDSR
      /EJECT
     CSR         OKRVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1199  30       Order Sequence
     C                     Z-ADD*ZERO     WN1200  30       Order Secondary
     C                     Z-ADD*ZERO     WN1201 112       Rated Freight
     C                     Z-ADD*ZERO     WN1202 112       @Rated Freight
     C                     MOVEL*BLANK    WN1203  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD*ZERO     WN1202           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN1203           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQOK01           Company Number
     C           *LIKE     DEFN OMC4NB    WQOK02           Order Number
      * Define keylist
     C           KRSOK     KLIST
     C                     KFLD           WQOK01           Company Number
     C                     KFLD           WQOK02           Order Number
      * Setup key
     C                     Z-ADDWSAIC3    WQOK01           Company Number
     C                     Z-ADDWSC4NB    WQOK02           Order Number
      * Establish starting position
     C           KRSOK     SETLL@BGWKL1                    *
     C           KRSOK     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0117           Company Number
     C                     Z-ADDOMC4NB    WL0118           Order Number
     C                     Z-ADDOMDPNB    WL0119           Order Sequence
     C                     Z-ADDOMUENB    WL0120           Order Secondary
     C                     Z-ADD*ZERO     WL0121           Rated Freight
     C                     EXSR OLCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN1203           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           WSA1WG    IFEQ 0                          *IF
     C           *ZERO     OREQ 0                          *OR
     C                     Z-ADD*ZERO     WN1201           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           OMGMST    IFEQ 'C'                        *IF
     C           OMGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           OMATWG    DIV  WSA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U/M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           OMAVQT    MULT OMAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  WSA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN1201    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0117           Company Number
     C                     Z-ADDOMC4NB    WL0118           Order Number
     C                     Z-ADDOMDPNB    WL0119           Order Sequence
     C                     Z-ADDOMUENB    WL0120           Order Secondary
     C                     Z-ADDWN1201    WL0121           Rated Freight
     C                     EXSR OLCHRC
     C                     ADD  WN1201    WN1202           @Rated Freight
     C                     Z-ADDOMDPNB    WN1199           Order Sequence
     C                     Z-ADDOMUENB    WN1200           Order Secondary
     C                     END                             *FI
     C           KRSOK     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN1202    IFNE *ZERO                      *IF
     C           WN1203    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  WN1202    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN1201           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0117           Company Number
     C                     Z-ADDWSC4NB    WL0118           Order Number
     C                     Z-ADDWN1199    WL0119           Order Sequence
     C                     Z-ADDWN1200    WL0120           Order Secondary
     C                     Z-ADDWN1201    WL0121           Rated Freight
     C                     EXSR OLCHRC
     C                     END                             *FI
      *================================================================
     CSR         OKEXIT    ENDSR
      /EJECT
     CSR         OLCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1204  70       Item Code
     C                     MOVEL*BLANK    WN1205  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1206  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1207  70       Order Group Cod
     C                     MOVEL*BLANK    WN1208  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1209  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1210 112       Billing Detail
     C                     Z-ADD*ZERO     WN1211 112       Billing Detail
     C                     Z-ADD*ZERO     WN1212 112       Billing Detail
     C                     Z-ADD*ZERO     WN1213 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1214  1        Comment Print A
     C                     MOVEL*BLANK    WN1215  1        Comment Print I
     C                     MOVEL*BLANK    WN1216  1        Comment Print P
     C                     MOVEL*BLANK    WN1217  1        Comment Print S
     C                     Z-ADD*ZERO     WN1218 112       Extended Amount
     C                     Z-ADD*ZERO     WN1219  70       Market Pricing
     C                     MOVEL*BLANK    WN1220  3        Commodity Marke
     C                     MOVEL*BLANK    WN1221  3        Date Method Cod
     C                     MOVEL*BLANK    WN1222  3        Price Method Co
     C                     Z-ADD*ZERO     WN1223 114       Price Overage O
     C                     Z-ADD*ZERO     WN1224  70       Contract Number
     C                     MOVEL*BLANK    WN1225  1        Price Status
     C                     Z-ADD*ZERO     WN1226  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1227  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN1228  2        U/M - Ordered
     C                     MOVEL*BLANK    WN1229  1        Work Confirm St
     C                     MOVEL*BLANK    WN1230  1        Work Over/Short
     C                     MOVEL*BLANK    WN1231  1        OD Production P
     C                     MOVEL*BLANK    WN1232 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1233 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1234  1        Age Code
     C                     MOVEL*BLANK    WN1235  1        Palletize
     C                     MOVEL*BLANK    WN1236  1        Slip Sheet
     C                     MOVEL*BLANK    WN1237  1        Catch Weight St
     C                     MOVEL*BLANK    WN1238  1        Price Audit
     C                     MOVEL*BLANK    WN1239  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1240  1        Production Date
     C                     Z-ADD*ZERO     WN1241 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1242 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1243 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1244 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1245 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1246 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1247 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1248 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1249 114       Unit Price
     C                     Z-ADD*ZERO     WN1250 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1251 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1252 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1253 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1254  70       Requested Ship
     C                     Z-ADD*ZERO     WN1255  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1256  70       Actual Shipped
     C                     MOVEL*BLANK    WN1257  1        Affect Inventor
     C                     MOVEL*BLANK    WN1258  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1259  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1260  30       Item Structure
     C                     Z-ADD*ZERO     WN1261  30       Item Structure
     C                     Z-ADD*ZERO     WN1262  30       Item Structure
     C                     MOVEL*BLANK    WN1263  2        Item Level
     C                     MOVEL*BLANK    WN1264  2        Quality Level
     C                     MOVEL*BLANK    WN1265  2        Pricing Product
     C                     MOVEL*BLANK    WN1266  2        Season Product
     C                     Z-ADD*ZERO     WN1267  70       Date of Origina
     C                     MOVEL*BLANK    WN1268 10        User Profile Na
     C                     MOVEL*BLANK    WN1269  6        Country Code
     C                     MOVEL*BLANK    WN1270  2        Event Code
     C                     MOVEL*BLANK    WN1271  3        Reason Code
     C                     MOVEL*BLANK    WN1272  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1273  1        Modified Flag
     C                     MOVEL*BLANK    WN1274  1        Substituted Fla
     C                     MOVEL*BLANK    WN1275  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1276 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1277 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1278  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1279  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1280  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1281  1        Affect Commissi
     C                     MOVEL*BLANK    WN1282  1        Affect Pricing
     C                     MOVEL*BLANK    WN1283  1        Released by Use
     C                     MOVEL*BLANK    WN1284  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1285  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1286  3        Production Ware
     C                     MOVEL*BLANK    WN1287  3        OD Price Type
     C                     Z-ADD*ZERO     WN1288  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1289  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1290  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1291  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1292  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1293  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1294  60       Price Code
     C                     Z-ADD*ZERO     WN1295  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1296  60       Substitution Li
     C                     Z-ADD*ZERO     WN1297  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1298 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1299 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1300 112       OD Item Target
     C                     Z-ADD*ZERO     WN1301 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1302 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1303 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1304 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1305 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1306 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1307 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1308 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1309 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1310 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1311  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1312  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1313  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1314 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1315  40       Item Age Days
     C                     Z-ADD*ZERO     WN1316  70       Production Ovr
     C                     Z-ADD*ZERO     WN1317  70       Production Ovr
     C                     MOVEL*BLANK    WN1318  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1319  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1320  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1321  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1322  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1323  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1324  1        EDI Status 1
     C                     MOVEL*BLANK    WN1325  1        EDI Status 2
     C                     MOVEL*BLANK    WN1326  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1327  60       Job Time
     C                     MOVEL*BLANK    WN1328 10        User Id
     C                     MOVEL*BLANK    WN1329 10        Job Name
     C                     Z-ADD*ZERO     WN1330  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0117    WJAIC3           Company Number
     C                     Z-ADDWL0118    WJC4NB           Order Number
     C                     Z-ADDWL0119    WJDPNB           Order Sequence
     C                     Z-ADDWL0120    WJUENB           Order Secondary
      *
     C           KLCHOL    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C           KLCHOL    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YJRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0121    WJR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OLEXIT    ENDSR
      /EJECT
     CSR         OMRVGN    BEGSR
      *================================================================
      * RTV Export Ords for LD RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTRMNB    WQOM02           Load ID
      * Define keylist
     C           KRSOM     KLIST
     C                     KFLD           WQOM02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQOM02           Load ID
      * Establish starting position
     C           KRSOM     SETLL@BFCPMC                    *
     C           KRSOM     READE@BFCPMC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO OMEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         OMEXIT    ENDSR
      /EJECT
     CSR         ONRVGN    BEGSR
      *================================================================
      * RTV Default Load Seq  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0090           Default Load Se
      * Define keylist
     C           KRSON     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CVPCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSON     CHAIN@ADREAO              90    *
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDT4ST    YL0090           Default Load Se
     C                     ENDIF
      *================================================================
     CSR         ONEXIT    ENDSR
      /EJECT
     CSR         OORVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOO     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0122    KMAIC3           Company Number
     C                     MOVELWL0123    KMV8CD           Company Value C
      * Establish starting position
     C           KRSOO     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO OOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    WL0124           System Value Al
     C                     ENDIF
      *================================================================
     CSR         OOEXIT    ENDSR
      /EJECT
     CSR         OPRVGN    BEGSR
      *================================================================
      * Val Stop Existance    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQOP02           Load ID
     C           *LIKE     DEFN WFRVNB    WQOP03           Stop/Drop
      * Define keylist
     C           KRSOP     KLIST
     C                     KFLD           WQOP02           Load ID
     C                     KFLD           WQOP03           Stop/Drop
      * Setup key
     C                     Z-ADD#2RMNB    WQOP02           Load ID
     C                     Z-ADD#RTENB    WQOP03           Stop/Drop
      * Establish starting position
     C           KRSOP     SETLL@FLCPEB                    *
     C           KRSOP     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       P5WXST           Record Found US
     C                     GOTO OPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       P5WXST           Record Found US
     C                     GOTO OPEXIT                     *QUIT
     C           KRSOP     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         OPEXIT    ENDSR
      /EJECT
     CSR         OQCRRC    BEGSR
      *================================================================
      * CRT Load Detail        CR - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1333  1        EDI Status 1
     C                     MOVEL*BLANK    WN1334  1        EDI Status 2
     C                     MOVEL*BLANK    WN1335  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1336  60       Job Time
     C                     MOVEL*BLANK    WN1337 10        User Id
     C                     MOVEL*BLANK    WN1338 10        Job Name
     C                     Z-ADD*ZERO     WN1339  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FLCPBM
     C                     Z-ADD#2RMNB    WRRMNB           Load ID
     C                     Z-ADDWURUNB    WRRUNB           Stop/Drop Seque
     C                     Z-ADDWURVNB    WRRVNB           Stop/Drop
     C                     MOVEL*BLANK    WRDQTX           Comments for Pi
     C                     Z-ADD*ZERO     WRRWNB           Miles to next s
     C                     Z-ADD*ZERO     WRRXNB           Freight Charge
     C                     Z-ADD*ZERO     WRSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WRT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WRT1NB           Freight Stop Ch
     C                     Z-ADD#1R1NB    WRR1NB           Rated Freight
     C                     Z-ADD#1AIC3    WRAIC3           Company Number
     C                     Z-ADD#1C4NB    WRC4NB           Order Number
     C                     MOVEL'O'       WRVCST           Ship Status
     C                     Z-ADD*ZERO     WRKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WRSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WRKFDT           Appointment Con
     C                     Z-ADD*ZERO     WRACTM           Appointment Con
     C                     MOVEL#RV5T1    WRK5TX           Confirmation Ma
     C                     MOVEL#RWBT1    WRW5CD           Confirmation Nu
     C                     Z-ADD*ZERO     WREJDT           Actual Delivery
     C                     Z-ADD*ZERO     WRAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WRKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WRATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WRHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WRAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WRKKDT           On Yard Date
     C                     Z-ADD*ZERO     WRAVTM           On Yard Time
     C                     Z-ADD*ZERO     WRZ4NB           MPC Number
     C                     MOVELWUGSTX    WRY7ST           Load Dtl On Tim
     C                     MOVELWUGSTX    WRY2ST           On Time Add'l R
     C                     MOVEL*BLANK    WRWHTX           Seal Nbr 1
     C                     MOVEL*BLANK    WRWITX           Seal Nbr 2
     C                     MOVEL*BLANK    WRWJTX           Seal Nbr 3
     C                     MOVEL*BLANK    WRWKTX           Seal Nbr 4
     C                     MOVEL*BLANK    WRWLTX           Seal Nbr 5
     C                     Z-ADDYL0097    WRN7DT           LD Carrier Appt
     C                     Z-ADD#1NODT    WRN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WRN9DT           LD Unused Date
     C                     Z-ADDYL0098    WRB3TM           LD Carrier Appt
     C                     Z-ADD#1BRTM    WRB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WRB5TM           LD Unused Time
     C                     MOVELWUIASX    WRIASX           Miles Error Sts
     C                     MOVELWUIBSX    WRIBSX           LD Unused Sts 2
     C                     MOVELWUICSX    WRICSX           HPB Transload S
     C                     MOVEL*BLANK    WRWVTX           LD Cst Svc Trac
     C                     MOVEL*BLANK    WRWWTX           Carrier Ref PRO
     C                     MOVEL*BLANK    WRWXTX           Cust Assigned A
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
     C           KLCROQ    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop/Drop Seque
      * Check for duplicate primary key
     C           KLCROQ    SETLL@FLCPBM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1193' W0RTN   7
      * Send message 'Load Detail            EX'
     C                     MOVEL'USR1193' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OQEXIT
     C                     ENDIF
      *
     C                     WRITE@FLCPBM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OQEXIT    ENDSR
      /EJECT
     CSR         ORRVGN    BEGSR
      *================================================================
      * UPD Load Information   RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1340  1        Header Status
     C                     MOVEL*BLANK    WN1341  1        Header Status L
     C                     Z-ADD*ZERO     WN1342 112       Order Weight To
     C                     MOVEL*BLANK    WN1343  1        Credit Hold
     C                     MOVEL*BLANK    WN1344  1        Production Hold
     C                     Z-ADD*ZERO     WN1345 112       Total Freight
     C                     Z-ADD*ZERO     WN1346  70       Total Load Orde
     C                     MOVEL*BLANK    WN1347  1        Affect Sales Do
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOR     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0125    WHAIC3           Company Number
     C                     Z-ADDWL0126    WHC4NB           Order Number
      * Establish starting position
     C           KRSOR     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * UPD Event: Ship Detail RT - Order Detail  * 
     C                     EXSR OSRVGN
      * Chg Load Information   CH - PD Order Header  * 
     C                     EXSR OUCHRC
     C                     ENDIF
      *================================================================
     CSR         OREXIT    ENDSR
      /EJECT
     CSR         OSRVGN    BEGSR
      *================================================================
      * UPD Event: Ship Detail RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQOS01           Company Number
     C           *LIKE     DEFN WLC4NB    WQOS02           Order Number
      * Define keylist
     C           KPSOS     KLIST
     C                     KFLD           WQOS01           Company Number
     C                     KFLD           WQOS02           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Define keylist
     C           KRSOS     KLIST
     C                     KFLD           WQOS01           Company Number
     C                     KFLD           WQOS02           Order Number
      * Setup key
     C                     Z-ADDWL0125    WQOS01           Company Number
     C                     Z-ADDWL0126    WQOS02           Order Number
     C                     Z-ADD*ZERO     WLDPNB           Order Sequence
     C                     Z-ADD*ZERO     WLUENB           Order Secondary
      * Establish starting position
     C           KPSOS     SETLL@BGWKAE                    *
     C           KRSOS     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Shipping Event     CH - PD Order Detail  * 
     C                     EXSR OTCHRC
     C           KRSOS     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         OSEXIT    ENDSR
      /EJECT
     CSR         OTCHRC    BEGSR
      *================================================================
      * CHG Shipping Event     CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1348  70       Item Code
     C                     MOVEL*BLANK    WN1349  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1350  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1351  70       Order Group Cod
     C                     MOVEL*BLANK    WN1352  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1353  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1354 112       Billing Detail
     C                     Z-ADD*ZERO     WN1355 112       Billing Detail
     C                     Z-ADD*ZERO     WN1356 112       Billing Detail
     C                     Z-ADD*ZERO     WN1357 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1358  1        Comment Print A
     C                     MOVEL*BLANK    WN1359  1        Comment Print I
     C                     MOVEL*BLANK    WN1360  1        Comment Print P
     C                     MOVEL*BLANK    WN1361  1        Comment Print S
     C                     Z-ADD*ZERO     WN1362 112       Extended Amount
     C                     Z-ADD*ZERO     WN1363  70       Market Pricing
     C                     MOVEL*BLANK    WN1364  3        Commodity Marke
     C                     MOVEL*BLANK    WN1365  3        Date Method Cod
     C                     MOVEL*BLANK    WN1366  3        Price Method Co
     C                     Z-ADD*ZERO     WN1367 114       Price Overage O
     C                     Z-ADD*ZERO     WN1368  70       Contract Number
     C                     MOVEL*BLANK    WN1369  1        Price Status
     C                     Z-ADD*ZERO     WN1370  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1371  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN1372  2        U/M - Ordered
     C                     MOVEL*BLANK    WN1373  1        Work Confirm St
     C                     MOVEL*BLANK    WN1374  1        Work Over/Short
     C                     MOVEL*BLANK    WN1375  1        OD Production P
     C                     MOVEL*BLANK    WN1376 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1377 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1378  1        Age Code
     C                     MOVEL*BLANK    WN1379  1        Palletize
     C                     MOVEL*BLANK    WN1380  1        Slip Sheet
     C                     MOVEL*BLANK    WN1381  1        Catch Weight St
     C                     MOVEL*BLANK    WN1382  1        Price Audit
     C                     MOVEL*BLANK    WN1383  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1384  1        Production Date
     C                     Z-ADD*ZERO     WN1385 112       Rated Freight
     C                     Z-ADD*ZERO     WN1386 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1387 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1388 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1389 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1390 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1391 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1392 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1393 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1394 114       Unit Price
     C                     Z-ADD*ZERO     WN1395 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1396 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1397 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1398 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1399  70       Requested Ship
     C                     Z-ADD*ZERO     WN1400  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1401  70       Actual Shipped
     C                     MOVEL*BLANK    WN1402  1        Affect Inventor
     C                     MOVEL*BLANK    WN1403  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1404  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1405  30       Item Structure
     C                     Z-ADD*ZERO     WN1406  30       Item Structure
     C                     Z-ADD*ZERO     WN1407  30       Item Structure
     C                     MOVEL*BLANK    WN1408  2        Item Level
     C                     MOVEL*BLANK    WN1409  2        Quality Level
     C                     MOVEL*BLANK    WN1410  2        Pricing Product
     C                     MOVEL*BLANK    WN1411  2        Season Product
     C                     Z-ADD*ZERO     WN1412  70       Date of Origina
     C                     MOVEL*BLANK    WN1413 10        User Profile Na
     C                     MOVEL*BLANK    WN1414  6        Country Code
     C                     MOVEL*BLANK    WN1415  3        Reason Code
     C                     MOVEL*BLANK    WN1416  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1417  1        Modified Flag
     C                     MOVEL*BLANK    WN1418  1        Substituted Fla
     C                     MOVEL*BLANK    WN1419  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1420 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1421 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1422  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1423  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1424  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1425  1        Affect Commissi
     C                     MOVEL*BLANK    WN1426  1        Affect Pricing
     C                     MOVEL*BLANK    WN1427  1        Released by Use
     C                     MOVEL*BLANK    WN1428  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1429  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1430  3        Production Ware
     C                     MOVEL*BLANK    WN1431  3        OD Price Type
     C                     Z-ADD*ZERO     WN1432  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1433  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1434  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1435  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1436  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1437  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1438  60       Price Code
     C                     Z-ADD*ZERO     WN1439  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1440  60       Substitution Li
     C                     Z-ADD*ZERO     WN1441  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1442 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1443 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1444 112       OD Item Target
     C                     Z-ADD*ZERO     WN1445 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1446 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1447 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1448 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1449 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1450 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1451 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1452 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1453 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1454 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1455  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1456  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1457  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1458 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1459  40       Item Age Days
     C                     Z-ADD*ZERO     WN1460  70       Production Ovr
     C                     Z-ADD*ZERO     WN1461  70       Production Ovr
     C                     MOVEL*BLANK    WN1462  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1463  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1464  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1465  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1466  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1467  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1468  1        EDI Status 1
     C                     MOVEL*BLANK    WN1469  1        EDI Status 2
     C                     MOVEL*BLANK    WN1470  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1471  60       Job Time
     C                     MOVEL*BLANK    WN1472 10        User Id
     C                     MOVEL*BLANK    WN1473 10        Job Name
     C                     Z-ADD*ZERO     WN1474  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWLAIC3    WJAIC3           Company Number
     C                     Z-ADDWLC4NB    WJC4NB           Order Number
     C                     Z-ADDWLDPNB    WJDPNB           Order Sequence
     C                     Z-ADDWLUENB    WJUENB           Order Secondary
      *
     C           KLCHOT    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C           KLCHOT    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YKRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0130    WJJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OTEXIT    ENDSR
      /EJECT
     CSR         OUCHRC    BEGSR
      *================================================================
      * Chg Load Information   CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1475  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN1476  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN1477  70       Ship To Custome
     C                     MOVEL*BLANK    WN1478 30        Ship To Name
     C                     MOVEL*BLANK    WN1479 30        Ship To Address
     C                     MOVEL*BLANK    WN1480 30        Ship To Address
     C                     MOVEL*BLANK    WN1481 30        Ship To Address
     C                     MOVEL*BLANK    WN1482 20        Ship To City
     C                     MOVEL*BLANK    WN1483  2        Ship To State C
     C                     MOVEL*BLANK    WN1484 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1485  70       Bill to Custome
     C                     MOVEL*BLANK    WN1486 30        Bill to Name
     C                     MOVEL*BLANK    WN1487 30        Bill to Address
     C                     MOVEL*BLANK    WN1488 30        Bill to Address
     C                     MOVEL*BLANK    WN1489 30        Bill to Address
     C                     MOVEL*BLANK    WN1490 20        Bill to City
     C                     MOVEL*BLANK    WN1491  2        Bill to State C
     C                     MOVEL*BLANK    WN1492 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1493 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1494  70       Order Date
     C                     Z-ADD*ZERO     WN1495  70       Requested Ship
     C                     Z-ADD*ZERO     WN1496  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1497  70       Cancel Date
     C                     MOVEL*BLANK    WN1498  2        Terms Code
     C                     MOVEL*BLANK    WN1499 40        Special Instruc
     C                     MOVEL*BLANK    WN1500 40        Special Instruc
     C                     MOVEL*BLANK    WN1501  1        Comment Print A
     C                     MOVEL*BLANK    WN1502  1        Comment Print I
     C                     MOVEL*BLANK    WN1503  1        Comment Print P
     C                     MOVEL*BLANK    WN1504  1        Comment Print S
     C                     MOVEL*BLANK    WN1505  3        Reason Code
     C                     MOVEL*BLANK    WN1506  1        Order in Use
     C                     MOVEL*BLANK    WN1507  1        Header Status
     C                     MOVEL*BLANK    WN1508  1        Header Status L
     C                     MOVEL*BLANK    WN1509  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1510  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1511 10        User Original E
     C                     Z-ADD*ZERO     WN1512  70       Date of Origina
     C                     Z-ADD*ZERO     WN1513 112       Order Value Tot
     C                     Z-ADD*ZERO     WN1514 112       Order Weight To
     C                     MOVEL*BLANK    WN1515  1        Credit Hold
     C                     MOVEL*BLANK    WN1516  1        Production Hold
     C                     MOVEL*BLANK    WN1517  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1518  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1519  40       Requested Deliv
     C                     MOVEL*BLANK    WN1520  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1521 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1522  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN1523  1        LTL Flag
     C                     MOVEL*BLANK    WN1524  1        Price Audit
     C                     MOVEL*BLANK    WN1525  1        Price Status
     C                     MOVEL*BLANK    WN1526  2        Shipping Method
     C                     MOVEL*BLANK    WN1527  1        Export Status
     C                     MOVEL*BLANK    WN1528  1        Palletize
     C                     MOVEL*BLANK    WN1529  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1530  1        Slip Sheet
     C                     MOVEL*BLANK    WN1531  1        Age Code
     C                     Z-ADD*ZERO     WN1532  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1533  1        Load Type
     C                     Z-ADD*ZERO     WN1534  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1535  1        Load Plan Order
     C                     MOVEL*BLANK    WN1536  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1537  70       Resell Referenc
     C                     MOVEL*BLANK    WN1538 30        Special Comment
     C                     MOVEL*BLANK    WN1539 30        Special Comment
     C                     MOVEL*BLANK    WN1540  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1541  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1542  2        Manager Level C
     C                     MOVEL*BLANK    WN1543  3        VP Level Code
     C                     Z-ADD*ZERO     WN1544  70       Attach to Order
     C                     MOVEL*BLANK    WN1545  3        Reason for Pric
     C                     Z-ADD*ZERO     WN1546  70       Invoice Number
     C                     MOVEL*BLANK    WN1547  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1548  70       Invoice Date
     C                     MOVEL*BLANK    WN1549  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1550  1        Modified Flag
     C                     Z-ADD*ZERO     WN1551 112       A/R order Value
     C                     MOVEL*BLANK    WN1552  1        Billing Activit
     C                     MOVEL*BLANK    WN1553  1        Block Order Fla
     C                     MOVEL*BLANK    WN1554  1        Order Certifica
     C                     Z-ADD*ZERO     WN1555 112       Invoice Order V
     C                     MOVEL*BLANK    WN1556  1        Process Sts for
     C                     MOVEL*BLANK    WN1557  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1558  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1559  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1560  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1561  1        Email Cust On O
     C                     MOVEL*BLANK    WN1562  1        Order Emailed
     C                     MOVEL*BLANK    WN1563  1        Export Docs Go
     C                     MOVEL*BLANK    WN1564  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1565  1        Broker Order St
     C                     MOVEL*BLANK    WN1566  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1567  2        Order Requires
     C                     MOVEL*BLANK    WN1568  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN1569  2        Export USDA App
     C                     MOVEL*BLANK    WN1570  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1571  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1572  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1573  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1574  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1575  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1576  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1577  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1578  60       Time of Origina
     C                     Z-ADD*ZERO     WN1579  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1580  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1581  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1582 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1583 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1584 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1585 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1586 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1587  70       Claim Number
     C                     MOVEL*BLANK    WN1588  1        EDI Status 1
     C                     MOVEL*BLANK    WN1589  1        EDI Status 2
     C                     MOVEL*BLANK    WN1590  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1591  60       Job Time
     C                     MOVEL*BLANK    WN1592 10        User Id
     C                     MOVEL*BLANK    WN1593 10        Job Name
     C                     Z-ADD*ZERO     WN1594  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0125    WKAIC3           Company Number
     C                     Z-ADDWL0126    WKC4NB           Order Number
      *
     C           KLCHOU    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C           KLCHOU    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YLRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0127    WKBZNA    P      Carrier Code
     C                     Z-ADDWL0128    WKRMNB           Load ID
     C                     Z-ADDWL0129    WKR1NB           Rated Freight
     C                     MOVELWL0130    WKJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPERC
     C                     Z-ADDWKAIC3    PEAIC3           Company Number
     C                     Z-ADDWKC4NB    PEC4NB           Order Number
     C                     MOVELWKJNCD    PEJNCD    P      Order Type - Sa
     C                     Z-ADDWKANC7    PEANC7           A/R Customer Nu
     C                     Z-ADDWKBKC7    PEBKC7           Ship To Custome
     C                     MOVELWKBRTX    PEBRTX    P      Ship To Name
     C                     MOVELWKHMNA    PEHMNA    P      Ship To Address
     C                     MOVELWKHONA    PEHONA    P      Ship To Address
     C                     MOVELWKHPNA    PEHPNA    P      Ship To Address
     C                     MOVELWKHNNA    PEHNNA    P      Ship To City
     C                     MOVELWKDBCD    PEDBCD    P      Ship To State C
     C                     MOVELWKCKTX    PECKTX    P      Ship To Zip/Pos
     C                     Z-ADDWKB0C7    PEB0C7           Bill to Custome
     C                     MOVELWKAETX    PEAETX    P      Bill to Name
     C                     MOVELWKB1NA    PEB1NA    P      Bill to Address
     C                     MOVELWKB3NA    PEB3NA    P      Bill to Address
     C                     MOVELWKB4NA    PEB4NA    P      Bill to Address
     C                     MOVELWKB2NA    PEB2NA    P      Bill to City
     C                     MOVELWKBHCD    PEBHCD    P      Bill to State C
     C                     MOVELWKC8TX    PEC8TX    P      Bill to Zip/Pos
     C                     MOVELWKBCNA    PEBCNA    P      Customer Purcha
     C                     Z-ADDWKA0DT    PEA0DT           Order Date
     C                     Z-ADDWKA5DT    PEA5DT           Requested Ship
     C                     Z-ADDWKGNDT    PEGNDT           Actual Shipped
     C                     Z-ADDWKACDT    PEACDT           Cancel Date
     C                     MOVELWKAQCD    PEAQCD    P      Terms Code
     C                     MOVELWKB6NA    PEB6NA    P      Special Instruc
     C                     MOVELWKBYNA    PEBYNA    P      Special Instruc
     C                     MOVELWKBZNA    PEBZNA    P      Carrier Code
     C                     MOVELWKGTST    PEGTST    P      Comment Print A
     C                     MOVELWKGVST    PEGVST    P      Comment Print I
     C                     MOVELWKGUST    PEGUST    P      Comment Print P
     C                     MOVELWKQFST    PEQFST    P      Comment Print S
     C                     MOVELWKCQCD    PECQCD    P      Reason Code
     C                     MOVELWKGJST    PEGJST    P      Order in Use
     C                     MOVELWKGWST    PEGWST    P      Header Status
     C                     MOVELWKGXST    PEGXST    P      Header Status L
     C                     MOVELWKGYST    PEGYST    P      Order Type Prin
     C                     Z-ADDWKAODT    PEAODT           Scheduled Ship
     C                     MOVELWKAIVN    PEAIVN    P      User Original E
     C                     Z-ADDWKCXDT    PECXDT           Date of Origina
     C                     Z-ADDWKJZVA    PEJZVA           Order Value Tot
     C                     Z-ADDWKA1WG    PEA1WG           Order Weight To
     C                     MOVELWKXIST    PEXIST    P      Credit Hold
     C                     MOVELWKXJST    PEXJST    P      Production Hold
     C                     MOVELWKXKST    PEXKST    P      New Customer Ho
     C                     Z-ADDWKEIDT    PEEIDT           Requested Deliv
     C                     Z-ADDWKAFTM    PEAFTM           Requested Deliv
     C                     MOVELWKE8CD    PEE8CD    P      Accounts Receiv
     C                     MOVELWKE9CD    PEE9CD    P      Accounts Receiv
     C                     Z-ADDWKRMNB    PERMNB           Load ID
     C                     Z-ADDWKTBNB    PETBNB           Absorbed Freigh
     C                     Z-ADDWKR1NB    PER1NB           Rated Freight
     C                     MOVELWKPJST    PEPJST    P      LTL Flag
     C                     MOVELWKU0ST    PEU0ST    P      Price Audit
     C                     MOVELWKU1ST    PEU1ST    P      Price Status
     C                     MOVELWKQ2CD    PEQ2CD    P      Shipping Method
     C                     MOVELWKU2ST    PEU2ST    P      Export Status
     C                     MOVELWKVEST    PEVEST    P      Palletize
     C                     MOVELWKVFST    PEVFST    P      Shrink Wrap
     C                     MOVELWKVGST    PEVGST    P      Slip Sheet
     C                     MOVELWKRPCD    PERPCD    P      Age Code
     C                     Z-ADDWKRNNB    PERNNB           Reefer Temperat
     C                     MOVELWKVDST    PEVDST    P      Load Type
     C                     Z-ADDWKATIN    PEATIN           Attach to Invoi
     C                     MOVELWKU4ST    PEU4ST    P      Load Plan Order
     C                     MOVELWKU5ST    PEU5ST    P      Print Pick Slip
     C                     Z-ADDWKRSRN    PERSRN           Resell Referenc
     C                     MOVELWKMHNA    PEMHNA    P      Special Comment
     C                     MOVELWKMINA    PEMINA    P      Special Comment
     C                     MOVELWKWBST    PEWBST    P      Affect Auto Acc
     C                     MOVELWKR4CD    PER4CD    P      Sales Route Cod
     C                     MOVELWKBFCD    PEBFCD    P      Manager Level C
     C                     MOVELWKQ4CD    PEQ4CD    P      VP Level Code
     C                     Z-ADDWKT3NB    PET3NB           Attach to Order
     C                     MOVELWKSICD    PESICD    P      Reason for Pric
     C                     Z-ADDWKCONB    PECONB           Invoice Number
     C                     MOVELWKCEST    PECEST    P      Invoice Suffix
     C                     Z-ADDWKAWDT    PEAWDT           Invoice Date
     C                     MOVELWKJPCD    PEJPCD    P      Event Code
     C                     MOVELWKXUST    PEXUST    P      Trans Contol AS
     C                     MOVELWKZ1ST    PEZ1ST    P      Modified Flag
     C                     Z-ADDWKVRVA    PEVRVA           A/R order Value
     C                     MOVELWKOBST    PEOBST    P      Billing Activit
     C                     MOVELWKBCST    PEBCST    P      Block Order Fla
     C                     MOVELWKBDST    PEBDST    P      Order Certifica
     C                     Z-ADDWKB7VL    PEB7VL           Invoice Order V
     C                     MOVELWKGASX    PEGASX    P      Process Sts for
     C                     MOVELWKGBSX    PEGBSX    P      Order Conf Fax
     C                     MOVELWKGCSX    PEGCSX    P      Manifest Fax St
     C                     MOVELWKGDSX    PEGDSX    P      Invoice Fax Sts
     C                     MOVELWKFNSX    PEFNSX    P      Transfer in Sto
     C                     MOVELWKFOSX    PEFOSX    P      Email Cust On O
     C                     MOVELWKFPSX    PEFPSX    P      Order Emailed
     C                     MOVELWKFQSX    PEFQSX    P      Export Docs Go
     C                     MOVELWKFRSX    PEFRSX    P      Shipping Temp C
     C                     MOVELWKFSSX    PEFSSX    P      Broker Order St
     C                     MOVELWKFTSX    PEFTSX    P      Air Freight Ord
     C                     MOVELWKFUSX    PEFUSX    P      Order Requires
     C                     MOVELWKFVSX    PEFVSX    P      OH Load Plan Re
     C                     MOVELWKFWSX    PEFWSX    P      Export USDA App
     C                     MOVELWKFXSX    PEFXSX    P      HPB Ship to War
     C                     MOVELWKFYSX    PEFYSX    P      OH TF Exempt Co
     C                     Z-ADDWKNODT    PENODT           OH Appt Confirm
     C                     Z-ADDWKNPDT    PENPDT           JPN Invoice Iss
     C                     Z-ADDWKNQDT    PENQDT           Load Actual Shi
     C                     Z-ADDWKNRDT    PENRDT           Load BOL Comple
     C                     Z-ADDWKNSDT    PENSDT           Load Truck Depa
     C                     Z-ADDWKBPTM    PEBPTM           Maximum Gross W
     C                     Z-ADDWKBQTM    PEBQTM           Time of Origina
     C                     Z-ADDWKBRTM    PEBRTM           OH Appt Confirm
     C                     Z-ADDWKBSTM    PEBSTM           Load BOL Comple
     C                     Z-ADDWKBTTM    PEBTTM           Load Truck Depa
     C                     Z-ADDWKH0NX    PEH0NX           Act Frt Referen
     C                     Z-ADDWKH1NX    PEH1NX           Act Non-Ref Frt
     C                     Z-ADDWKH2NX    PEH2NX           OH Fuel Surchar
     C                     Z-ADDWKH3NX    PEH3NX           OH Total Non-Re
     C                     Z-ADDWKH4NX    PEH4NX           OH Total Ref Fr
     C                     Z-ADDWKC0C7    PEC0C7           Claim Number
     C                     MOVELWKUVST    PEUVST    P      EDI Status 1
     C                     MOVELWKUWST    PEUWST    P      EDI Status 2
     C                     MOVELWKUXST    PEUXST    P      EDI Status 3
     C                     Z-ADDWKAATM    PEAATM           Job Time
     C                     MOVELWKAYNA    PEAYNA    P      User Id
     C                     MOVELWKA0NA    PEA0NA    P      Job Name
     C                     Z-ADDWKAXDT    PEAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OUEXIT    ENDSR
      /EJECT
     CSR         OVRVGN    BEGSR
      *================================================================
      * Crt Load Plan Event    RT - Order Events  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1595  50       Event Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN1595           Event Number
      * RTV Latest Event/Date  RT - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0131           Company Number
     C                     Z-ADD#1C4NB    WL0132           Order Number
     C                     Z-ADDWN1595    WL0133           Event Number
     C                     Z-ADDWUNFNN    WL0137           Ship To Custome
     C                     EXSR OWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0133    WN1595           Event Number
     C                     MOVELWL0134    WUG0TX    P      Event Code
     C                     Z-ADDWL0135    WUNFNN           Event Date
     C                     MOVELWL0136    WUG0TX    P      Activity Hold
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVAIC3    WQOV01           Company Number
     C           *LIKE     DEFN WVC4NB    WQOV02           Order Number
      * Define keylist
     C           KRSOV     KLIST
     C                     KFLD           WQOV01           Company Number
     C                     KFLD           WQOV02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQOV01           Company Number
     C                     Z-ADD#1C4NB    WQOV02           Order Number
      * Establish starting position
     C           KRSOV     SETLL@EYCPY2                    *
     C           KRSOV     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0138           Company Number
     C                     Z-ADD#1C4NB    WL0139           Order Number
     C                     Z-ADDWUQ2NB    WL0140           Event Number
     C                     MOVEL'01'      WL0141    P      Event Code
     C                     Z-ADD#1AIC3    WL0142           Invoice/Memo Co
     C                     Z-ADD*ZERO     WL0143           Invoice/Memo Nu
     C                     MOVEL*BLANK    WL0144           Invoice/Memo Su
     C                     Z-ADD##JDT     WL0145           Event Date
     C                     MOVEL'Y'       WL0146    P      Activity Comple
     C                     MOVEL'N'       WL0147    P      Activity Hold
     C                     MOVEL'Y'       WL0148    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0149           Cross Event Ref
     C                     Z-ADD*ZERO     WL0150           Cross Event Ref
     C                     Z-ADD*ZERO     WL0151           Cross Event Ref
     C                     Z-ADD*ZERO     WL0152           Ship To Custome
     C                     EXSR OXCRRC
     C                     ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0138           Company Number
     C                     Z-ADD#1C4NB    WL0139           Order Number
     C                     Z-ADDWUQ2NB    WL0140           Event Number
     C                     MOVEL'02'      WL0141    P      Event Code
     C                     Z-ADD#1AIC3    WL0142           Invoice/Memo Co
     C                     Z-ADD*ZERO     WL0143           Invoice/Memo Nu
     C                     MOVEL*BLANK    WL0144           Invoice/Memo Su
     C                     Z-ADD##JDT     WL0145           Event Date
     C                     MOVEL'Y'       WL0146    P      Activity Comple
     C                     MOVEL'N'       WL0147    P      Activity Hold
     C                     MOVEL'Y'       WL0148    P      Post Cash Compl
     C                     Z-ADD*ZERO     WL0149           Cross Event Ref
     C                     Z-ADD*ZERO     WL0150           Cross Event Ref
     C                     Z-ADD*ZERO     WL0151           Cross Event Ref
     C                     Z-ADD*ZERO     WL0152           Ship To Custome
     C                     EXSR OXCRRC
     C                     GOTO OVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN1595           Event Number
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0138           Company Number
     C                     Z-ADDWVC4NB    WL0139           Order Number
     C                     Z-ADDWN1595    WL0140           Event Number
     C                     MOVEL'02'      WL0141    P      Event Code
     C                     Z-ADDWVAUC3    WL0142           Invoice/Memo Co
     C                     Z-ADDWVQ7NB    WL0143           Invoice/Memo Nu
     C                     MOVELWVOMST    WL0144    P      Invoice/Memo Su
     C                     Z-ADD##JDT     WL0145           Event Date
     C                     MOVELWVONST    WL0146    P      Activity Comple
     C                     MOVELWVOOST    WL0147    P      Activity Hold
     C                     MOVELWVOPST    WL0148    P      Post Cash Compl
     C                     Z-ADDWVAWC3    WL0149           Cross Event Ref
     C                     Z-ADDWVQ8NB    WL0150           Cross Event Ref
     C                     Z-ADDWVQ9NB    WL0151           Cross Event Ref
     C                     Z-ADDWVBKC7    WL0152           Ship To Custome
     C                     EXSR OXCRRC
     C                     GOTO OVEXIT                     *QUIT
     C           KRSOV     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         OVEXIT    ENDSR
      /EJECT
     CSR         OWRVGN    BEGSR
      *================================================================
      * RTV Latest Event/Date  RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQOW01           Company Number
     C           *LIKE     DEFN WWC4NB    WQOW02           Order Number
      * Define keylist
     C           KRSOW     KLIST
     C                     KFLD           WQOW01           Company Number
     C                     KFLD           WQOW02           Order Number
      * Setup key
     C                     Z-ADDWL0131    WQOW01           Company Number
     C                     Z-ADDWL0132    WQOW02           Order Number
      * Establish starting position
     C           KRSOW     SETLL@EYCPZR                    *
     C           KRSOW     READE@EYCPZR                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWWQ2NB    WL0133           Event Number
     C                     MOVELWWJPCD    WL0134           Event Code
     C                     Z-ADDWWD2DT    WL0135           Event Date
     C                     MOVELWWOOST    WL0136           Activity Hold
     C           KRSOW     READE@EYCPZR                  90*
     C                     ENDDO
      *================================================================
     CSR         OWEXIT    ENDSR
      /EJECT
     CSR         OXCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1596  1        EDI Status 1
     C                     MOVEL*BLANK    WN1597  1        EDI Status 2
     C                     MOVEL*BLANK    WN1598  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1599  60       Job Time
     C                     MOVEL*BLANK    WN1600 10        User Id
     C                     MOVEL*BLANK    WN1601 10        Job Name
     C                     Z-ADD*ZERO     WN1602  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0138    WXAIC3           Company Number
     C                     Z-ADDWL0139    WXC4NB           Order Number
     C                     Z-ADDWL0140    WXQ2NB           Event Number
     C                     MOVELWL0141    WXJPCD           Event Code
     C                     Z-ADDWL0142    WXAUC3           Invoice/Memo Co
     C                     Z-ADDWL0143    WXQ7NB           Invoice/Memo Nu
     C                     MOVELWL0144    WXOMST           Invoice/Memo Su
     C                     Z-ADDWL0145    WXD2DT           Event Date
     C                     MOVELWL0146    WXONST           Activity Comple
     C                     MOVELWL0147    WXOOST           Activity Hold
     C                     MOVELWL0148    WXOPST           Post Cash Compl
     C                     Z-ADDWL0149    WXAWC3           Cross Event Ref
     C                     Z-ADDWL0150    WXQ8NB           Cross Event Ref
     C                     Z-ADDWL0151    WXQ9NB           Cross Event Ref
     C                     Z-ADDWL0152    WXBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WXAATM           Job Time
     C                     MOVEL##USR     WXAYNA           User Id
     C                     MOVEL##JOB     WXA0NA           Job Name
     C                     Z-ADD##JDT     WXAXDT           Job Date
     C           KLCROX    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXC4NB           Order Number
     C                     KFLD           WXQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCROX    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OXEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OXEXIT    ENDSR
      /EJECT
     CSR         OYRVGN    BEGSR
      *================================================================
      * DLT Single Load Dtl   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQOY01           Load ID
      * Define keylist
     C           KRSOY     KLIST
     C                     KFLD           WQOY01           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQOY01           Load ID
      * Establish starting position
     C           KRSOY     SETLL@FLCPBW                    *
     C           KRSOY     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           #1C4NB    IFEQ FLC4NB                     *IF
      * DLT Load Detail        DL - Load Detail  * 
     C                     EXSR OZDLRC
     C                     GOTO OYEXIT                     *QUIT
     C                     END                             *FI
     C           KRSOY     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         OYEXIT    ENDSR
      /EJECT
     CSR         OZDLRC    BEGSR
      *================================================================
      * DLT Load Detail        DL - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FLCPBM
     C                     Z-ADDFLRMNB    WRRMNB           Load ID
     C                     Z-ADDFLRUNB    WRRUNB           Stop/Drop Seque
      *
     C           KLDLOZ    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop/Drop Seque
     C           KLDLOZ    CHAIN@FLCPBM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OZEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FLCPBM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         OZEXIT    ENDSR
      /EJECT
     CSR         PARVGN    BEGSR
      *================================================================
      * Dlt Event by Event Cde RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYAIC3    WQPA01           Company Number
     C           *LIKE     DEFN WYC4NB    WQPA02           Order Number
     C           *LIKE     DEFN WYJPCD    WQPA03           Event Code
      * Define keylist
     C           KRSPA     KLIST
     C                     KFLD           WQPA01           Company Number
     C                     KFLD           WQPA02           Order Number
     C                     KFLD           WQPA03           Event Code
      * Setup key
     C                     Z-ADD#1AIC3    WQPA01           Company Number
     C                     Z-ADD#1C4NB    WQPA02           Order Number
     C                     MOVEL'02'      WQPA03           Event Code
      * Establish starting position
     C           KRSPA     SETLL@EYCPEH                    *
     C           KRSPA     READE@EYCPEH                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT OP Order Events    DL - Order Events  * 
     C                     EXSR PBDLRC
     C                     GOTO PAEXIT                     *QUIT
     C           KRSPA     READE@EYCPEH                  90*
     C                     ENDDO
      *================================================================
     CSR         PAEXIT    ENDSR
      /EJECT
     CSR         PBDLRC    BEGSR
      *================================================================
      * DLT OP Order Events    DL - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
     C                     Z-ADDWYAIC3    WXAIC3           Company Number
     C                     Z-ADDWYC4NB    WXC4NB           Order Number
     C                     Z-ADDWYQ2NB    WXQ2NB           Event Number
      *
     C           KLDLPB    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXC4NB           Order Number
     C                     KFLD           WXQ2NB           Event Number
     C           KLDLPB    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPEYCPL0'MDACP
     C                     MOVEL'@EYCPY3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         PBEXIT    ENDSR
      /EJECT
     CSR         PCRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQPC01           Company Number
     C           *LIKE     DEFN OMC4NB    WQPC02           Order Number
      * Define keylist
     C           KRSPC     KLIST
     C                     KFLD           WQPC01           Company Number
     C                     KFLD           WQPC02           Order Number
      * Setup key
     C                     Z-ADDWL0153    WQPC01           Company Number
     C                     Z-ADDWL0154    WQPC02           Order Number
      * Establish starting position
     C           KRSPC     SETLL@BGWKL1                    *
     C           KRSPC     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR PDCHRC
     C           KRSPC     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         PCEXIT    ENDSR
      /EJECT
     CSR         PDCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1603  70       Item Code
     C                     MOVEL*BLANK    WN1604  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1605  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1606  70       Order Group Cod
     C                     MOVEL*BLANK    WN1607  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1608  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1609 112       Billing Detail
     C                     Z-ADD*ZERO     WN1610 112       Billing Detail
     C                     Z-ADD*ZERO     WN1611 112       Billing Detail
     C                     Z-ADD*ZERO     WN1612 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1613  1        Comment Print A
     C                     MOVEL*BLANK    WN1614  1        Comment Print I
     C                     MOVEL*BLANK    WN1615  1        Comment Print P
     C                     MOVEL*BLANK    WN1616  1        Comment Print S
     C                     Z-ADD*ZERO     WN1617 112       Extended Amount
     C                     Z-ADD*ZERO     WN1618  70       Market Pricing
     C                     MOVEL*BLANK    WN1619  3        Commodity Marke
     C                     MOVEL*BLANK    WN1620  3        Date Method Cod
     C                     MOVEL*BLANK    WN1621  3        Price Method Co
     C                     Z-ADD*ZERO     WN1622 114       Price Overage O
     C                     Z-ADD*ZERO     WN1623  70       Contract Number
     C                     MOVEL*BLANK    WN1624  1        Price Status
     C                     Z-ADD*ZERO     WN1625  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1626  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN1627  2        U/M - Ordered
     C                     MOVEL*BLANK    WN1628  1        Work Confirm St
     C                     MOVEL*BLANK    WN1629  1        Work Over/Short
     C                     MOVEL*BLANK    WN1630  1        OD Production P
     C                     MOVEL*BLANK    WN1631 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1632 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1633  1        Age Code
     C                     MOVEL*BLANK    WN1634  1        Palletize
     C                     MOVEL*BLANK    WN1635  1        Slip Sheet
     C                     MOVEL*BLANK    WN1636  1        Catch Weight St
     C                     MOVEL*BLANK    WN1637  1        Price Audit
     C                     MOVEL*BLANK    WN1638  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1639  1        Production Date
     C                     Z-ADD*ZERO     WN1640 112       Rated Freight
     C                     Z-ADD*ZERO     WN1641 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1642 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1643 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1644 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1645 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1646 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1647 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1648 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1649 114       Unit Price
     C                     Z-ADD*ZERO     WN1650 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1651 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1652 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1653 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1654  70       Requested Ship
     C                     Z-ADD*ZERO     WN1655  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1656  70       Actual Shipped
     C                     MOVEL*BLANK    WN1657  1        Affect Inventor
     C                     MOVEL*BLANK    WN1658  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1659  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1660  30       Item Structure
     C                     Z-ADD*ZERO     WN1661  30       Item Structure
     C                     Z-ADD*ZERO     WN1662  30       Item Structure
     C                     MOVEL*BLANK    WN1663  2        Item Level
     C                     MOVEL*BLANK    WN1664  2        Quality Level
     C                     MOVEL*BLANK    WN1665  2        Pricing Product
     C                     MOVEL*BLANK    WN1666  2        Season Product
     C                     Z-ADD*ZERO     WN1667  70       Date of Origina
     C                     MOVEL*BLANK    WN1668 10        User Profile Na
     C                     MOVEL*BLANK    WN1669  6        Country Code
     C                     MOVEL*BLANK    WN1670  2        Event Code
     C                     MOVEL*BLANK    WN1671  3        Reason Code
     C                     MOVEL*BLANK    WN1672  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1673  1        Modified Flag
     C                     MOVEL*BLANK    WN1674  1        Substituted Fla
     C                     MOVEL*BLANK    WN1675  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1676 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1677 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1678  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1679  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1680  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1681  1        Affect Commissi
     C                     MOVEL*BLANK    WN1682  1        Affect Pricing
     C                     MOVEL*BLANK    WN1683  1        Released by Use
     C                     MOVEL*BLANK    WN1684  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1685  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1686  3        Production Ware
     C                     MOVEL*BLANK    WN1687  3        OD Price Type
     C                     Z-ADD*ZERO     WN1688  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1689  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1690  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1691  70       OD Firm Date
     C                     Z-ADD*ZERO     WN1692  60       Price Code
     C                     Z-ADD*ZERO     WN1693  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1694  60       Substitution Li
     C                     Z-ADD*ZERO     WN1695  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1696 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1697 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1698 112       OD Item Target
     C                     Z-ADD*ZERO     WN1699 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1700 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1701 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1702 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1703 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1704 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1705 114       OD Original Ord
     C                     Z-ADD*ZERO     WN1706 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN1707 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1708 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1709  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1710  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1711  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1712 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1713  40       Item Age Days
     C                     Z-ADD*ZERO     WN1714  70       Production Ovr
     C                     Z-ADD*ZERO     WN1715  70       Production Ovr
     C                     MOVEL*BLANK    WN1716  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1717  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1718  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1719  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1720  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1721  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1722  1        EDI Status 1
     C                     MOVEL*BLANK    WN1723  1        EDI Status 2
     C                     MOVEL*BLANK    WN1724  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1725  60       Job Time
     C                     MOVEL*BLANK    WN1726 10        User Id
     C                     MOVEL*BLANK    WN1727 10        Job Name
     C                     Z-ADD*ZERO     WN1728  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WJAIC3           Company Number
     C                     Z-ADDOMC4NB    WJC4NB           Order Number
     C                     Z-ADDOMDPNB    WJDPNB           Order Sequence
     C                     Z-ADDOMUENB    WJUENB           Order Secondary
      *
     C           KLCHPD    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C           KLCHPD    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YMRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0155    WJNVDT           Deadline Depart
     C                     Z-ADDWL0156    WJBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PDEXIT    ENDSR
      /EJECT
     CSR         PERVGN    BEGSR
      *================================================================
      * RTV Check Existence    RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSPE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO PEEXIT                     *QUIT
     C                     GOTO PEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO PEEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         PEEXIT    ENDSR
      /EJECT
     CSR         PFCHRC    BEGSR
      *================================================================
      * CHG Load Accept Flag   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1729  30       Company Number
     C                     Z-ADD*ZERO     WN1730  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1731  1        LTL Flag
     C                     MOVEL*BLANK    WN1732  1        Load Status
     C                     Z-ADD*ZERO     WN1733  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1734 15        Seal 1
     C                     MOVEL*BLANK    WN1735 15        Seal 2
     C                     MOVEL*BLANK    WN1736 15        Seal 3
     C                     MOVEL*BLANK    WN1737 15        Seal 4
     C                     MOVEL*BLANK    WN1738 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1739  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1740 112       Flat Amount
     C                     MOVEL*BLANK    WN1741  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1742  50       Total Stops
     C                     MOVEL*BLANK    WN1743 20        Trailer Id
     C                     MOVEL*BLANK    WN1744  3        Transloader Car
     C                     Z-ADD*ZERO     WN1745  40       BOL Time
     C                     MOVEL*BLANK    WN1746  3        Carrier Code
     C                     MOVEL*BLANK    WN1747  7        Truck Size
     C                     Z-ADD*ZERO     WN1748  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1749 112       Rated Freight
     C                     MOVEL*BLANK    WN1750  1        Ship Status
     C                     MOVEL*BLANK    WN1751  1        Load Type
     C                     Z-ADD*ZERO     WN1752  50       Number Pallets
     C                     Z-ADD*ZERO     WN1753  50       Number Pallets
     C                     Z-ADD*ZERO     WN1754 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1755  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1756  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1757  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1758 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1759 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1760  70       Actual Departur
     C                     Z-ADD*ZERO     WN1761  40       Departure Time
     C                     Z-ADD*ZERO     WN1762  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1763  52       Product Tempera
     C                     Z-ADD*ZERO     WN1764  50       Number Spacers
     C                     MOVEL*BLANK    WN1765 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN1766  70       Total Load Mile
     C                     MOVEL*BLANK    WN1767 12        Recorder ID
     C                     MOVEL*BLANK    WN1768  2        Shipping Method
     C                     MOVEL*BLANK    WN1769  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1770  2        Ship To State C
     C                     Z-ADD*ZERO     WN1771  70       Gross Weight
     C                     MOVEL*BLANK    WN1772  3        Carrier Broker
     C                     MOVEL*BLANK    WN1773  1        Export Status
     C                     Z-ADD*ZERO     WN1774  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1775  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1776  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1777  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1778  70       Spotted Date
     C                     Z-ADD*ZERO     WN1779  60       Spotted Time
     C                     Z-ADD*ZERO     WN1780  70       Load Finished D
     C                     Z-ADD*ZERO     WN1781  60       Load Finished T
     C                     Z-ADD*ZERO     WN1782  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1783  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1784  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1785  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1786  70       Truck Departure
     C                     Z-ADD*ZERO     WN1787  60       Truck Departure
     C                     Z-ADD*ZERO     WN1788  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1789  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1790  3        Shipping Line
     C                     MOVEL*BLANK    WN1791 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1792 30        Vessel Name
     C                     Z-ADD*ZERO     WN1793  50       Voyage
     C                     Z-ADD*ZERO     WN1794  70       Sail Date
     C                     MOVEL*BLANK    WN1795 12        Booking Number
     C                     MOVEL*BLANK    WN1796 20        Discharge Port
     C                     Z-ADD*ZERO     WN1797  70       Arrival Date
     C                     MOVEL*BLANK    WN1798 12        Container Numbe
     C                     Z-ADD*ZERO     WN1799  70       Date In
     C                     Z-ADD*ZERO     WN1800  60       Time In
     C                     Z-ADD*ZERO     WN1801  70       Date Out
     C                     Z-ADD*ZERO     WN1802  60       Time Out
     C                     Z-ADD*ZERO     WN1803 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1804  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1805  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1806  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1807  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1808  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1809  70       Requested Deliv
     C                     MOVEL*BLANK    WN1810  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1811  70       On Yard Date
     C                     Z-ADD*ZERO     WN1812  60       On Yard Time
     C                     MOVEL*BLANK    WN1813  1        Load Held Over
     C                     MOVEL*BLANK    WN1814  1        Load Held Over
     C                     MOVEL*BLANK    WN1815 15        Load Held Over
     C                     MOVEL*BLANK    WN1816 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN1817 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN1818  70       Express Mail Da
     C                     MOVEL*BLANK    WN1819  1        Load Shag Flag
     C                     MOVEL*BLANK    WN1820  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN1821  70       Product Complet
     C                     Z-ADD*ZERO     WN1822  60       Product Complet
     C                     Z-ADD*ZERO     WN1823  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1824  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1825  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1826  1        Load Confirmed
     C                     MOVEL*BLANK    WN1827 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1828  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1829  60       Load Door 1
     C                     Z-ADD*ZERO     WN1830  70       Override Total
     C                     Z-ADD*ZERO     WN1831  60       Load Door 2
     C                     MOVEL*BLANK    WN1832  1        Partial Load
     C                     MOVEL*BLANK    WN1833  1        Load Confirmati
     C                     MOVEL*BLANK    WN1834  1        Export Load USD
     C                     MOVEL*BLANK    WN1835  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1836 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1837 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1838 15        Late Billing Em
     C                     MOVEL*BLANK    WN1839 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1840 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1841  1        Multi Company L
     C                     MOVEL*BLANK    WN1842  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1843  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1844  1        LH Power Only L
     C                     MOVEL*BLANK    WN1845  1        MG Created Load
     C                     MOVEL*BLANK    WN1846  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1847  2        Load U/M
     C                     MOVEL*BLANK    WN1848  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1849  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1850  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN1851  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1852  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1853  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1854  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1855  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1856  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1857  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN1858  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1859  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1860  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1861  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1862  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1863  60       LH Unused Time
     C                     MOVEL*BLANK    WN1864  1        EDI Status 1
     C                     MOVEL*BLANK    WN1865  1        EDI Status 2
     C                     MOVEL*BLANK    WN1866  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1867  60       Job Time
     C                     MOVEL*BLANK    WN1868 10        User Id
     C                     MOVEL*BLANK    WN1869 10        Job Name
     C                     Z-ADD*ZERO     WN1870  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WIRMNB           Load ID
      *
     C           KLCHPF    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHPF    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YNRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WIRMST    P      Load Acceptance
     C                     Z-ADDWUKZDT    WIKZDT           Deadline Depart
     C                     Z-ADDWUAXTM    WIAXTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PFEXIT    ENDSR
      /EJECT
     CSR         PGRVGN    BEGSR
      *================================================================
      * CHG Deadline Date/Time RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQPG01           Load ID
      * Define keylist
     C           KPSPG     KLIST
     C                     KFLD           WQPG01           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSPG     KLIST
     C                     KFLD           WQPG01           Load ID
      * Setup key
     C                     Z-ADDWL0157    WQPG01           Load ID
     C                     Z-ADDWL0158    FLRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSPG     SETLL@FLCPBW                    *
     C           KRSPG     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO PGEXIT                     *QUIT
     C                     GOTO PGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Deadline Date/Time CH - Load Detail  * 
     C                     EXSR PHCHRC
     C           KRSPG     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         PGEXIT    ENDSR
      /EJECT
     CSR         PHCHRC    BEGSR
      *================================================================
      * CHG Deadline Date/Time CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1871  50       Stop/Drop
     C                     MOVEL*BLANK    WN1872 30        Comments for Pi
     C                     Z-ADD*ZERO     WN1873  50       Miles to next s
     C                     Z-ADD*ZERO     WN1874  72       Freight Charge
     C                     Z-ADD*ZERO     WN1875  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1876 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN1877  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN1878 112       Rated Freight
     C                     Z-ADD*ZERO     WN1879  30       Company Number
     C                     Z-ADD*ZERO     WN1880  70       Order Number
     C                     MOVEL*BLANK    WN1881  1        Ship Status
     C                     Z-ADD*ZERO     WN1882  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN1883  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1884  70       Appointment Con
     C                     Z-ADD*ZERO     WN1885  60       Appointment Con
     C                     MOVEL*BLANK    WN1886 30        Confirmation Ma
     C                     MOVEL*BLANK    WN1887 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN1888  70       Actual Delivery
     C                     Z-ADD*ZERO     WN1889  60       Actual Delivery
     C                     Z-ADD*ZERO     WN1890  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1891  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1892  70       On Yard Date
     C                     Z-ADD*ZERO     WN1893  60       On Yard Time
     C                     Z-ADD*ZERO     WN1894  70       MPC Number
     C                     MOVEL*BLANK    WN1895  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN1896  1        On Time Add'l R
     C                     MOVEL*BLANK    WN1897 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN1898 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN1899 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN1900 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN1901 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN1902  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1903  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1904  70       LD Unused Date
     C                     Z-ADD*ZERO     WN1905  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN1906  60       LD Unused Time
     C                     Z-ADD*ZERO     WN1907  60       LD Unused Time
     C                     MOVEL*BLANK    WN1908  1        Miles Error Sts
     C                     MOVEL*BLANK    WN1909  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN1910  2        HPB Transload S
     C                     MOVEL*BLANK    WN1911 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN1912 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN1913 25        Cust Assigned A
     C                     MOVEL*BLANK    WN1914  1        EDI Status 1
     C                     MOVEL*BLANK    WN1915  1        EDI Status 2
     C                     MOVEL*BLANK    WN1916  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1917  60       Job Time
     C                     MOVEL*BLANK    WN1918 10        User Id
     C                     MOVEL*BLANK    WN1919 10        Job Name
     C                     Z-ADD*ZERO     WN1920  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWL0157    WRRMNB           Load ID
     C                     Z-ADDFLRUNB    WRRUNB           Stop/Drop Seque
      *
     C           KLCHPH    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop/Drop Seque
     C           KLCHPH    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YORDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWL0159    WRHDDT           Deadline Depart
     C                     Z-ADDWL0160    WRAUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0153           Company Number
     C                     Z-ADDWRC4NB    WL0154           Order Number
     C                     Z-ADDWRHDDT    WL0155           Deadline Depart
     C                     Z-ADDWRAUTM    WL0156           Deadline Depart
     C                     EXSR PCRVGN
     C                     ENDIF
      *================================================================
     CSR         PHEXIT    ENDSR
      /EJECT
     CSR         PICHRC    BEGSR
      *================================================================
      * CHG Carrier/Schd Sp Dt CH - OM Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1921  30       Company Number
     C                     MOVEL*BLANK    WN1922  1        LTL Flag
     C                     MOVEL*BLANK    WN1923  1        Load Status
     C                     Z-ADD*ZERO     WN1924  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1925 15        Seal 1
     C                     MOVEL*BLANK    WN1926 15        Seal 2
     C                     MOVEL*BLANK    WN1927 15        Seal 3
     C                     MOVEL*BLANK    WN1928 15        Seal 4
     C                     MOVEL*BLANK    WN1929 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN1930  70       Total Load Orde
     C                     Z-ADD*ZERO     WN1931 112       Flat Amount
     C                     MOVEL*BLANK    WN1932  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN1933  50       Total Stops
     C                     MOVEL*BLANK    WN1934 20        Trailer Id
     C                     MOVEL*BLANK    WN1935  3        Transloader Car
     C                     Z-ADD*ZERO     WN1936  40       BOL Time
     C                     MOVEL*BLANK    WN1937  7        Truck Size
     C                     Z-ADD*ZERO     WN1938  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN1939 112       Rated Freight
     C                     MOVEL*BLANK    WN1940  1        Ship Status
     C                     MOVEL*BLANK    WN1941  1        Load Type
     C                     Z-ADD*ZERO     WN1942  50       Number Pallets
     C                     Z-ADD*ZERO     WN1943  50       Number Pallets
     C                     Z-ADD*ZERO     WN1944 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN1945  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN1946  70       Actual Arrival
     C                     Z-ADD*ZERO     WN1947  40       Actual Arrival
     C                     Z-ADD*ZERO     WN1948 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN1949 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN1950  70       Actual Departur
     C                     Z-ADD*ZERO     WN1951  40       Departure Time
     C                     Z-ADD*ZERO     WN1952  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN1953  52       Product Tempera
     C                     Z-ADD*ZERO     WN1954  50       Number Spacers
     C                     MOVEL*BLANK    WN1955 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN1956  70       Total Load Mile
     C                     MOVEL*BLANK    WN1957 12        Recorder ID
     C                     MOVEL*BLANK    WN1958  2        Shipping Method
     C                     MOVEL*BLANK    WN1959  3        Ship From Wareh
     C                     MOVEL*BLANK    WN1960  2        Ship To State C
     C                     Z-ADD*ZERO     WN1961  70       Gross Weight
     C                     MOVEL*BLANK    WN1962  3        Carrier Broker
     C                     MOVEL*BLANK    WN1963  1        Export Status
     C                     Z-ADD*ZERO     WN1964  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN1965  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN1966  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN1967  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN1968  70       Spotted Date
     C                     Z-ADD*ZERO     WN1969  60       Spotted Time
     C                     Z-ADD*ZERO     WN1970  70       Load Finished D
     C                     Z-ADD*ZERO     WN1971  60       Load Finished T
     C                     Z-ADD*ZERO     WN1972  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN1973  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN1974  70       BOL Received Da
     C                     Z-ADD*ZERO     WN1975  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN1976  70       Truck Departure
     C                     Z-ADD*ZERO     WN1977  60       Truck Departure
     C                     Z-ADD*ZERO     WN1978  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN1979  60       Adjusted Depart
     C                     MOVEL*BLANK    WN1980  3        Shipping Line
     C                     MOVEL*BLANK    WN1981 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1982 30        Vessel Name
     C                     Z-ADD*ZERO     WN1983  50       Voyage
     C                     Z-ADD*ZERO     WN1984  70       Sail Date
     C                     MOVEL*BLANK    WN1985 12        Booking Number
     C                     MOVEL*BLANK    WN1986 20        Discharge Port
     C                     Z-ADD*ZERO     WN1987  70       Arrival Date
     C                     MOVEL*BLANK    WN1988 12        Container Numbe
     C                     Z-ADD*ZERO     WN1989  70       Date In
     C                     Z-ADD*ZERO     WN1990  60       Time In
     C                     Z-ADD*ZERO     WN1991  70       Date Out
     C                     Z-ADD*ZERO     WN1992  60       Time Out
     C                     Z-ADD*ZERO     WN1993 112       Load Total Frei
     C                     Z-ADD*ZERO     WN1994  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN1995  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN1996  1        LH Unused Sts
     C                     MOVEL*BLANK    WN1997  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN1998  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN1999  70       Requested Deliv
     C                     MOVEL*BLANK    WN2000  1        Load Acceptance
     C                     MOVEL*BLANK    WN2001  3        Warehouse Code
     C                     Z-ADD*ZERO     WN2002  70       On Yard Date
     C                     Z-ADD*ZERO     WN2003  60       On Yard Time
     C                     Z-ADD*ZERO     WN2004  70       Deadline Depart
     C                     Z-ADD*ZERO     WN2005  60       Deadline Depart
     C                     MOVEL*BLANK    WN2006  1        Load Held Over
     C                     MOVEL*BLANK    WN2007  1        Load Held Over
     C                     MOVEL*BLANK    WN2008 15        Load Held Over
     C                     MOVEL*BLANK    WN2009 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN2010 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN2011  70       Express Mail Da
     C                     MOVEL*BLANK    WN2012  1        Load Shag Flag
     C                     MOVEL*BLANK    WN2013  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN2014  70       Product Complet
     C                     Z-ADD*ZERO     WN2015  60       Product Complet
     C                     Z-ADD*ZERO     WN2016  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN2017  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN2018  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN2019  1        Load Confirmed
     C                     MOVEL*BLANK    WN2020 25        Load Confirmed
     C                     Z-ADD*ZERO     WN2021  70       Load Confirmati
     C                     Z-ADD*ZERO     WN2022  60       Load Door 1
     C                     Z-ADD*ZERO     WN2023  70       Override Total
     C                     Z-ADD*ZERO     WN2024  60       Load Door 2
     C                     MOVEL*BLANK    WN2025  1        Partial Load
     C                     MOVEL*BLANK    WN2026  1        Load Confirmati
     C                     MOVEL*BLANK    WN2027  1        Export Load USD
     C                     MOVEL*BLANK    WN2028  1        Late Delivery E
     C                     Z-ADD*ZERO     WN2029 112       Load Actual Fre
     C                     MOVEL*BLANK    WN2030 15        Hide on WW Load
     C                     MOVEL*BLANK    WN2031 15        Late Billing Em
     C                     MOVEL*BLANK    WN2032 25        Shipping Temp C
     C                     MOVEL*BLANK    WN2033 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN2034  1        Multi Company L
     C                     MOVEL*BLANK    WN2035  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN2036  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN2037  1        LH Power Only L
     C                     MOVEL*BLANK    WN2038  1        MG Created Load
     C                     MOVEL*BLANK    WN2039  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN2040  2        Load U/M
     C                     MOVEL*BLANK    WN2041  2        TPM Shipment St
     C                     MOVEL*BLANK    WN2042  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN2043  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN2044  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN2045  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN2046  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN2047  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN2048  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN2049  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN2050  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN2051  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN2052  60       LH Unused Time
     C                     Z-ADD*ZERO     WN2053  70       LH Unused Date
     C                     Z-ADD*ZERO     WN2054  60       LH Unused Time
     C                     Z-ADD*ZERO     WN2055  70       LH Unused Date
     C                     Z-ADD*ZERO     WN2056  60       LH Unused Time
     C                     MOVEL*BLANK    WN2057  1        EDI Status 1
     C                     MOVEL*BLANK    WN2058  1        EDI Status 2
     C                     MOVEL*BLANK    WN2059  1        EDI Status 3
     C                     Z-ADD*ZERO     WN2060  60       Job Time
     C                     MOVEL*BLANK    WN2061 10        User Id
     C                     MOVEL*BLANK    WN2062 10        Job Name
     C                     Z-ADD*ZERO     WN2063  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WIRMNB           Load ID
      *
     C           KLCHPI    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHPI    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YPRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     MOVEL*BLANK    WIBZNA    P      Carrier Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PIEXIT    ENDSR
      /EJECT
     CSR         PJRVGN    BEGSR
      *================================================================
      * RTV Sequence Number    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQPJ01           Load ID
      * Define keylist
     C           KRSPJ     KLIST
     C                     KFLD           WQPJ01           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQPJ01           Load ID
      * Establish starting position
     C           KRSPJ     SETLL@FLCPBW                    *
     C           KRSPJ     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           #1C4NB    IFEQ FLC4NB                     *IF
      * PAR = DB1 By name
     C                     Z-ADDFLRUNB    YL0016           Stop/Drop Seque
     C                     Z-ADDFLRVNB    YL0100           Stop/Drop
     C                     GOTO PJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSPJ     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         PJEXIT    ENDSR
      /EJECT
     CSR         PKRVGN    BEGSR
      *================================================================
      * Rtv Miles to Customer  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPK     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD#1AIC3    EOAIC3           Company Number
     C                     Z-ADD#1BKC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSPK     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEOMTCU    WUMTCU           Mileage To Cust
     C                     ENDIF
      *================================================================
     CSR         PKEXIT    ENDSR
      /EJECT
     CSR         PLCHRC    BEGSR
      *================================================================
      * CHG Stop Number        CH - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN2064 30        Comments for Pi
     C                     Z-ADD*ZERO     WN2065  72       Freight Charge
     C                     Z-ADD*ZERO     WN2066  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN2067 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN2068  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN2069 112       Rated Freight
     C                     Z-ADD*ZERO     WN2070  30       Company Number
     C                     Z-ADD*ZERO     WN2071  70       Order Number
     C                     MOVEL*BLANK    WN2072  1        Ship Status
     C                     Z-ADD*ZERO     WN2073  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN2074  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN2075  70       Appointment Con
     C                     Z-ADD*ZERO     WN2076  60       Appointment Con
     C                     MOVEL*BLANK    WN2077 30        Confirmation Ma
     C                     MOVEL*BLANK    WN2078 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN2079  70       Actual Delivery
     C                     Z-ADD*ZERO     WN2080  60       Actual Delivery
     C                     Z-ADD*ZERO     WN2081  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN2082  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN2083  70       Deadline Depart
     C                     Z-ADD*ZERO     WN2084  60       Deadline Depart
     C                     Z-ADD*ZERO     WN2085  70       On Yard Date
     C                     Z-ADD*ZERO     WN2086  60       On Yard Time
     C                     Z-ADD*ZERO     WN2087  70       MPC Number
     C                     MOVEL*BLANK    WN2088  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN2089  1        On Time Add'l R
     C                     MOVEL*BLANK    WN2090 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN2091 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN2092 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN2093 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN2094 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN2095  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN2096  70       LD Unused Date
     C                     Z-ADD*ZERO     WN2097  70       LD Unused Date
     C                     Z-ADD*ZERO     WN2098  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN2099  60       LD Unused Time
     C                     Z-ADD*ZERO     WN2100  60       LD Unused Time
     C                     MOVEL*BLANK    WN2101  1        Miles Error Sts
     C                     MOVEL*BLANK    WN2102  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN2103  2        HPB Transload S
     C                     MOVEL*BLANK    WN2104 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN2105 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN2106 25        Cust Assigned A
     C                     MOVEL*BLANK    WN2107  1        EDI Status 1
     C                     MOVEL*BLANK    WN2108  1        EDI Status 2
     C                     MOVEL*BLANK    WN2109  1        EDI Status 3
     C                     Z-ADD*ZERO     WN2110  60       Job Time
     C                     MOVEL*BLANK    WN2111 10        User Id
     C                     MOVEL*BLANK    WN2112 10        Job Name
     C                     Z-ADD*ZERO     WN2113  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADD#2RMNB    WRRMNB           Load ID
     C                     Z-ADDYL0016    WRRUNB           Stop/Drop Seque
      *
     C           KLCHPL    KLIST
     C                     KFLD           WRRMNB           Load ID
     C                     KFLD           WRRUNB           Stop/Drop Seque
     C           KLCHPL    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YQRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWURVNB    WRRVNB           Stop/Drop
     C                     Z-ADDWUMTCU    WRRWNB           Miles to next s
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PLEXIT    ENDSR
      /EJECT
     CSR         PMRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQPM01           Application Cod
      * Define keylist
     C           KRSPM     KLIST
     C                     KFLD           WQPM01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQPM01           Application Cod
     C                     MOVEL'OMS'     WQPM01           Application Cod
      * Establish starting position
     C           KRSPM     SETLL@DNRESF                    *
     C           KRSPM     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR PNRVGN
     C                     END                             *FI
     C           KRSPM     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         PMEXIT    ENDSR
      /EJECT
     CSR         PNRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQPN01           Application Cod
      * Define keylist
     C           KRSPN     KLIST
     C                     KFLD           WQPN01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQPN01           Application Cod
      * Establish starting position
     C           KRSPN     SETLL@DNRESF                    *
     C           KRSPN     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO PNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSPN     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         PNEXIT    ENDSR
      /EJECT
     CSR         PORVGN    BEGSR
      *================================================================
      * RTV Load No. Status    RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPO     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    ASAIC3           Company Number
      * Establish starting position
     C           KRSPO     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELASPNST    P3PNST           Auto Load Numbe
     C                     ENDIF
      *================================================================
     CSR         POEXIT    ENDSR
      /EJECT
     CSR         PPCHRC    BEGSR
      *================================================================
      * RTV Next Load No.      CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN2116  40       Current Account
     C                     Z-ADD*ZERO     WN2117  20       Current Account
     C                     Z-ADD*ZERO     WN2118  30       OM Week
     C                     Z-ADD*ZERO     WN2119  70       Next Order Numb
     C                     Z-ADD*ZERO     WN2120  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN2121  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN2122  70       Next Charge Bac
     C                     Z-ADD*ZERO     WN2123  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN2124  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN2125  70       Next Customer #
     C                     Z-ADD*ZERO     WN2126  70       Next Inventory
     C                     Z-ADD*ZERO     WN2127  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN2128  70       Next Contract/P
     C                     Z-ADD*ZERO     WN2129  60       Next HPB Batch
     C                     MOVEL*BLANK    WN2130  1        Auto Order Numb
     C                     MOVEL*BLANK    WN2131  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN2132  1        Auto Customers
     C                     MOVEL*BLANK    WN2133  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN2134  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN2135  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN2136 112       Late Charge Min
     C                     MOVEL*BLANK    WN2137  1        Print Co Addr o
     C                     MOVEL*BLANK    WN2138  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN2139  1        Allocate Credit
     C                     MOVEL*BLANK    WN2140 30        Message Line 1
     C                     MOVEL*BLANK    WN2141 30        Message Line 2
     C                     MOVEL*BLANK    WN2142 30        Message Line 3
     C                     MOVEL*BLANK    WN2143 30        Message Line 4
     C                     MOVEL*BLANK    WN2144  1        Age by Trans or
     C                     Z-ADD*ZERO     WN2145  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN2146  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN2147  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN2148  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN2149  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN2150  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN2151  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN2152  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN2153  30       Retention Perio
     C                     Z-ADD*ZERO     WN2154  30       Retention Perio
     C                     Z-ADD*ZERO     WN2155  30       Retention Perio
     C                     Z-ADD*ZERO     WN2156  30       Retention Perio
     C                     Z-ADD*ZERO     WN2157  30       Retention Perio
     C                     Z-ADD*ZERO     WN2158  70       Next Load ID
     C                     MOVEL*BLANK    WN2159  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN2160  70       Next Item Numbe
     C                     MOVEL*BLANK    WN2161  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN2162  30       Production Numb
     C                     MOVEL*BLANK    WN2163  1        Freight by Poun
     C                     MOVEL*BLANK    WN2164  1        Price Audit Act
     C                     MOVEL*BLANK    WN2165 10        PRT Night Queue
     C                     MOVEL*BLANK    WN2166  1        EDI Status 1
     C                     MOVEL*BLANK    WN2167  1        EDI Status 2
     C                     MOVEL*BLANK    WN2168  1        EDI Status 3
     C                     MOVEL*BLANK    WN2169  1        Record Status
     C                     Z-ADD*ZERO     WN2170  60       Job Time
     C                     MOVEL*BLANK    WN2171 10        User Id
     C                     MOVEL*BLANK    WN2172 10        Job Name
     C                     Z-ADD*ZERO     WN2173  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADD*ZERO     TAAIC3           Company Number
      *
     C           KLCHPP    KLIST
     C                     KFLD           TAAIC3           Company Number
     C           KLCHPP    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL020.
     C                     MOVEL'LBL020'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YRRDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YRRDC            *Record Data Ch
     C                     Z-ADDTAR3NB    P1RMNB           Load ID
     C                     ADD  1         TAR3NB           Next Load ID
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TAAATM' defaulted for 'Job Time'.
      * Field '(DB1) TAAYNA' defaulted for 'User Id'.
      * Field '(DB1) TAA0NA' defaulted for 'Job Name'.
      * Field '(DB1) TAAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TAAATM           Job Time
     C                     MOVEL##USR     TAAYNA           User Id
     C                     MOVEL##JOB     TAA0NA           Job Name
     C                     Z-ADD##JDT     TAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PPEXIT    ENDSR
      /EJECT
     CSR         PQRVGN    BEGSR
      *================================================================
      * Rtv Stop/Drop Seq.    RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQPQ01           Load ID
      * Define keylist
     C           KRSPQ     KLIST
     C                     KFLD           WQPQ01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQPQ01           Load ID
      * Establish starting position
     C           KRSPQ     SETLL@FLCPBW                    *
     C           KRSPQ     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO PQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Find the ending sequence number for the load
      * CASE: DB1.Stop/Drop Sequence Number GT PAR.Stop/Drop Sequence Num
     C           FLRUNB    IFGT WURUNB                     *IF
     C                     Z-ADDFLRUNB    WURUNB           Stop/Drop Seque
     C                     END                             *FI
     C           KRSPQ     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         PQEXIT    ENDSR
      /EJECT
     CSR         PRRVGN    BEGSR
      *================================================================
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPR     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSPR     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Application WHS
     C                     GOTO PREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI7ST    YL0001           Application WHS
     C                     ENDIF
      *================================================================
     CSR         PREXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Load for Load Plan RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSA     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
     C                     MOVEL*BLANK    #PPKST           Load Status
     C                     Z-ADD*ZERO     #CPCNX           Reefer Temperat
     C                     Z-ADD*ZERO     P2RPNB           Total Load Orde
     C                     Z-ADD*ZERO     #PFLAM           Flat Amount
     C                     MOVEL*BLANK    #PXQST           Allocate Pounds
     C                     MOVEL*BLANK    #CR6CD           Carrier Code
     C                     MOVEL*BLANK    #CTECD           Truck Size
     C                     Z-ADD*ZERO     #2R1NB           Rated Freight
     C                     MOVEL*BLANK    #CWNST           Load Type
     C                     Z-ADD*ZERO     #CT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WUTKNB           Total Load Mile
     C                     MOVEL*BLANK    #CCUST           Shipping Method
     C                     MOVEL*BLANK    #CVPCD           Ship From Wareh
     C                     MOVEL*BLANK    #CV9CD           Ship To State C
     C                     MOVEL*BLANK    #CXCCD           Carrier Broker
     C                     MOVEL*BLANK    #CRMST           Load Acceptance
     C                     Z-ADD*ZERO     P2K2DT           Override Total
     C                     MOVEL*BLANK    WUWRTX           Shipping Temp C
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    #CHODT           Scheduled Ship
     C                     MOVELFJPKST    #PPKST           Load Status
     C                     Z-ADDFJRNNB    #CPCNX           Reefer Temperat
     C                     Z-ADDFJRPNB    P2RPNB           Total Load Orde
     C                     Z-ADDFJFLAM    #PFLAM           Flat Amount
     C                     MOVELFJXQST    #PXQST           Allocate Pounds
     C                     MOVELFJBZNA    #CR6CD           Carrier Code
     C                     MOVELFJRONB    #CTECD           Truck Size
     C                     Z-ADDFJR1NB    #2R1NB           Rated Freight
     C                     MOVELFJVDST    #CWNST           Load Type
     C                     Z-ADDFJT4NB    #CT4NB           Schedule Sequen
     C                     Z-ADDFJTLMI    WUTKNB           Total Load Mile
     C                     MOVELFJQ2CD    #CCUST           Shipping Method
     C                     MOVELFJVPCD    #CVPCD           Ship From Wareh
     C                     MOVELFJDBCD    #CV9CD           Ship To State C
     C                     MOVELFJXCCD    #CXCCD           Carrier Broker
     C                     MOVELFJRMST    #CRMST           Load Acceptance
     C                     Z-ADDFJK2DT    P2K2DT           Override Total
     C                     MOVELFJWRTX    WUWRTX           Shipping Temp C
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0001    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSB     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     MOVEL*BLANK    WL0003           Record Status
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0002           Name
     C                     MOVELFFVSST    WL0003           Record Status
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Deadln DepartDT/TM RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADDWL0004    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@FJCPSB                    *
     C           KRSSC     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Deadline Depart
     C                     Z-ADD*ZERO     WL0006           Deadline Depart
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAKZDT    WL0005           Deadline Depart
     C                     Z-ADDWAAXTM    WL0006           Deadline Depart
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv 1st Warehouse     RT - User Application Whs  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FOAJVN    WQSD01           User Profile Na
     C           *LIKE     DEFN FODNCD    WQSD02           Application Cod
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           User Profile Na
     C                     KFLD           WQSD02           Application Cod
      * Setup key
     C                     MOVEL##USR     WQSD01           User Profile Na
     C                     MOVE *BLANK    WQSD02           Application Cod
     C                     MOVEL'TRF'     WQSD02           Application Cod
      * Establish starting position
     C           KRSSD     SETLL@FOREDD                    *
     C           KRSSD     READE@FOREDD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4200' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CCPCD           Warehouse Code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFOAJCD    #CCPCD           Warehouse Code
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@FOREDD                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV WhsTyp/Ctrl/LdTyp RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CCPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #CWNST           WHS Default Loa
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADT7ST    #CWNST           WHS Default Loa
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVELWL0007    FKRONB           Truck Size
      * Establish starting position
     C           KRSSF     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0008           Maximum pounds
     C                     Z-ADD*ZERO     WL0009           Minimum pounds
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    WL0008           Maximum pounds
     C                     Z-ADDFKTANB    WL0009           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P2DHWG           USR Weight Accu
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0010           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0035           Pallets Loaded
     C                     Z-ADDWL0012    YL0036           Avg Pallet Tare
     C                     Z-ADDWL0013    YL0037           Tot Pallet Tare
     C                     END                             *FI
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSG01           Load ID
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Load ID
     C                     KFLD           FLRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQSG01           Load ID
     C                     Z-ADD*ZERO     FLRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSG     SETLL@FLCPBW                    *
     C           KRSSG     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 01/18/10 PKD E000261 SEND in LCL.Avg Pallet Tare
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM FLAIC3    WQ0061  30       Company Number
     C                     PARM FLC4NB    WQ0062  70       Order Number
     C                     PARM *ZERO     WQ0063  30       Order Sequence
     C                     PARM *ZERO     WQ0064  30       Order Secondary
     C           P2DHWG    PARM P2DHWG    WQ0065 112       USR Weight Accu
     C           YL0038    PARM YL0038    WQ0066 112       Order Quantity
     C                     PARM YL0036    WQ0067  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           KRSSG     READE@FLCPBW                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #PPKST    IFEQ 'I'                        *IF
     C           #PPKST    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFLRMNB    WL0010           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0035           Pallets Loaded
     C                     Z-ADDWL0012    YL0036           Avg Pallet Tare
     C                     Z-ADDWL0013    YL0037           Tot Pallet Tare
     C                     ADD  YL0037    P2DHWG           USR Weight Accu
     C                     END                             *FI
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Pallet/Tare        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0010    FJRMNB           Load ID
      * Establish starting position
     C           KRSSH     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJKNNX    WL0011           Pallets Loaded
     C                     Z-ADDFJICWG    WL0012           Avg Pallet Tare
     C                     Z-ADDFJIDWG    WL0013           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Chk any ords on Ld RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0015           USR Check Y/N S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSI02           Load ID
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Load ID
      * Setup key
     C                     Z-ADDWL0014    WQSI02           Load ID
      * Establish starting position
     C           KRSSI     SETLL@BFCPD9                    *
     C           KRSSI     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0015           USR Check Y/N S
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Trailer Number     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSJ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJDXTX    WUDXTX           Trailer Id
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Stop Number       RT - Load Detail          TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0017           Stop/Drop
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSK01           Load ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Load ID
      * Setup key
     C                     Z-ADDWL0016    WQSK01           Load ID
      * Establish starting position
     C           KRSSK     SETLL@FLCPBW                    *
     C           KRSSK     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0017           Stop/Drop
     C                     Z-ADD*ZERO     WL0019           Appointment Con
     C                     Z-ADD*ZERO     WL0020           Appointment Con
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If order number is found, retrieve stop number
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           WL0018    IFEQ FLC4NB                     *IF
     C                     Z-ADDFLRVNB    WL0017           Stop/Drop
      * PAR = DB1 By name
     C                     Z-ADDFLRVNB    WL0017           Stop/Drop
     C                     Z-ADDFLKFDT    WL0019           Appointment Con
     C                     Z-ADDFLACTM    WL0020           Appointment Con
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Region for State   RT - Region Definition  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN KGAIC3    WQSL01           Company Number
     C           *LIKE     DEFN KGBGCD    WQSL02           State Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           State Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSL01           Company Number
     C                     MOVEL#1DBCD    WQSL02           State Code
      * Establish starting position
     C           KRSSL     SETLL@KGREGY                    *
     C           KRSSL     READE@KGREGY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2203' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKGV1CD    #RV1CD           Region Code
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@KGREGY                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSM01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSM01           Company Number
     C                     Z-ADD#1C4NB    WQSM02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSSM     SETLL@BGWKL1                    *
     C           KRSSM     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELOMAJCD    #RAJCD           Warehouse Code
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Type              RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0044           OHE Override Ty
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMCHTX    YL0044           OHE Override Ty
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV State Description  RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    ACBGCD           State Code
      * Establish starting position
     C           KRSSO     CHAIN@ACREAH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RLHNA           Description
     C                     MOVEL*BLANK    WUG0TX           Record Status
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAUNA    #RLHNA           Description
     C                     MOVELACVSST    WUG0TX           Record Status
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Check Pick Event   RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSP01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSP02           Order Number
     C           *LIKE     DEFN EYJPCD    WQSP03           Event Code
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
     C                     KFLD           WQSP03           Event Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSP01           Company Number
     C                     Z-ADD#1C4NB    WQSP02           Order Number
     C                     MOVEL'03'      WQSP03           Event Code
      * Establish starting position
     C           KRSSP     SETLL@EYCPZE                    *
     C           KRSSP     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * CRT Load Plan Stop Cst CR - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL01      IFEQ 100
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     Z-ADD*ZERO     XARVNB           Stop/Drop
     C                     Z-ADD*ZERO     XABKC7           Ship To Custome
      * Move all fields to Load Planning Stop Cust
     C                     Z-ADDWL0021    XARVNB           Stop/Drop
     C                     Z-ADDWL0022    XABKC7           Ship To Custome
      *
      * Move key fields to Load Planning Stop Cust
     C                     Z-ADDXARVNB    YI0101           Stop/Drop
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFEQ XARVNB
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
      * USER: Processing if Data record already exists
     C                     GOTO SQEXIT                     *QUIT
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL01      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK01,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK01,Y    YD01
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI01
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to Load Planning Stop Cust
     C                     Z-ADDXARVNB    YI0101           Stop/Drop
      *
     C                     MOVELYD01      YK01,Y
     C           YI01      OCUR YM01
      * Update MODS fields
     C                     Z-ADDXARVNB    WCRVNB           Stop/Drop
     C                     Z-ADDXABKC7    WCBKC7           Ship To Custome
      * Only sort if element is out of position
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE100
     C           YK01,YR01 ANDGTYD01
     C                     ADD  1         YR01    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK01
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL01
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * VAL Load Exist        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0023    FJRMNB           Load ID
      * Establish starting position
     C           KRSSR     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SREXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0024    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSS     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Val Truck Size        RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVEL#CTECD    FKRONB           Truck Size
      * Establish starting position
     C           KRSST     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Validate State Cd  RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVELWL0025    ACBGCD           State Code
      * Establish starting position
     C           KRSSU     CHAIN@ACREAH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0005' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * VAL Active Region      RT - PD Region  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           KFAIC3           Company Number
     C                     KFLD           KFV1CD           Region Code
      * Setup key
     C                     Z-ADD#2AIC3    KFAIC3           Company Number
     C                     MOVEL#CV1CD    KFV1CD           Region Code
      * Establish starting position
     C           KRSSV     CHAIN@KFREGX              90    *
      * Data record not found
     C   90                MOVEL'USR2201' W0RTN   7
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Val Carrier           RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#CXCCD    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSW     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0027           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WL0028           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSX02           Load ID
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX02           Load ID
      * Setup key
     C                     Z-ADDWL0026    WQSX02           Load ID
      * Establish starting position
     C           KRSSX     SETLL@BFCPD9                    *
     C           KRSSX     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0027           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           WBBCST    IFEQ 'B'                        *IF
     C                     MOVELWBBCST    WL0028           Block Order Fla
     C                     GOTO SXEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSX     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0029    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSY     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0030           Allow Multi-Com
     C                     MOVELDRMPNA    WL0031           Default Printer
     C                     MOVELDRBCCD    WL0032           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0033           Company Number
     C                     MOVELDRBUVN    WL0034           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0035    DTAJVN           User Profile Na
     C                     MOVELWL0036    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSZ     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0037           Company Number
     C                     MOVELDTAJCD    WL0038           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBWC3    WQTA01           Shipping Compan
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Shipping Compan
      * Setup key
     C                     Z-ADDWL0040    WQTA01           Shipping Compan
      * Establish starting position
     C           KRSTA     SETLL@ADREWA                    *
     C           KRSTA     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0039           Warehouse Code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WEVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WEAOCD    IFNE *BLANK                     *IF
     C                     MOVELWEAOCD    WL0039           Warehouse Code
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTA     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0041    ABAIC3           Company Number
      * Establish starting position
     C           KRSTB     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0042           Name
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0042           Name
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0003           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQTC02           Load ID
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQTC02           Load ID
      * Establish starting position
     C           KRSTC     SETLL@FLCPEB                    *
     C           KRSTC     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           WFRVNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       WN0003           Status - Y or N
     C                     GOTO TCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTC     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0004           Order in Use
     C                     MOVEL*BLANK    WN0005           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQTD02           Load ID
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQTD02           Load ID
      * Establish starting position
     C           KRSTD     SETLL@BFCPD9                    *
     C           KRSTD     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           WBGWST    IFEQ 'H'                        *IF
     C                     MOVELWBGWST    WN0005           Header Status
     C                     GOTO TDEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           WBGWST    IFEQ 'X'                        *IF
     C                     MOVELWBGWST    WN0005           Header Status
     C                     GOTO TDEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           WBGJST    IFEQ 'Y'                        *IF
     C                     MOVELWBGJST    WN0004           Order in Use
     C                     GOTO TDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTD     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQTE02           Load ID
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQTE02           Load ID
      * Establish starting position
     C           KRSTE     SETLL@BFCPD9                    *
     C           KRSTE     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0050           Order Requires
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBFUSX    YL0050           Order Requires
     C           KRSTE     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Unlock Load Authr RT - Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVEL##USR     C0AJVN           User Profile Na
     C                     MOVE *BLANK    C0DNCD           Application Cod
     C                     MOVEL'O/P'     C0DNCD           Application Cod
     C                     Z-ADD#2AIC3    C0AIC3           Company Number
      * Establish starting position
     C           KRSTF     CHAIN@C0REO4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0527' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUHTST           Unlock Load Aut
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0HTST    WUHTST           Unlock Load Aut
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKZGNX    WQTG01           PFS Load ID
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           PFS Load ID
      * Setup key
     C                     Z-ADDWL0043    WQTG01           PFS Load ID
      * Establish starting position
     C           KRSTG     SETLL@BKCPEK                    *
     C           KRSTG     READE@BKCPEK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3504' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0044           Pick Status USR
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0044           Pick Status USR
     C                     GOTO TGEXIT                     *QUIT
     C           KRSTG     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Val Carrier Active     RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WGBZNA           Carrier Code
      * Setup key
     C                     MOVEL#CR6CD    WGBZNA           Carrier Code
      * Establish starting position
     C           KRSTH     CHAIN@FFREUG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO THEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Del All Stop Custs RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD1         Y       50
     C           YL01      IFGT 0
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
     C                     ELSE
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
      * Sequence through qualified elements:
     C                     Z-ADDY         YR01    50
     C           YR01      DOWLEYL01
     C                     Z-ADDYR01      Y
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * USER: Process Data record
      * DEL Stop Cust          DL - *Arrays  * 
     C                     EXSR TJDLRC
     C                     ADD  1         YR01
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJDLRC    BEGSR
      *================================================================
      * DEL Stop Cust          DL - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to Load Planning Stop Cust
     C                     Z-ADDWCRVNB    YI0101           Stop/Drop
      *
      * Reset global index if not within range of current elements
     C           Y         IFGT YL01
     C                     Z-ADD1         Y
     C                     ENDIF
      * Only search if not already pointing to correct element
     C           Y         IFGT 0
     C           YD01      ANDNEYK01,Y
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE WCRVNB
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * Element not found in array
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     GOTO TJEXIT
     C                     ENDIF
     C                     ENDIF
      *
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE100
     C           YK01,YR01 ANDGEYD01
     C                     SUB  1         YR01    50
     C                     ENDIF
      *
      * Initialize keys in array but retain index to MODS for later reuse
     C                     Z-ADDYI01      YISAV   50
     C                     MOVEL*HIVAL    YD01
     C                     Z-ADDYISAV     YI01
     C                     MOVELYD01      YK01,Y
      * Sort array to compress out deleted element
     C                     SORTAYK01
      * Adjust number of elements currently in array
     C                     SUB  1         YL01
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV All Header Fields  RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WHAIC3           Company Number
     C                     Z-ADD#1C4NB    WHC4NB           Order Number
      * Establish starting position
     C           KRSTK     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDWHANC7    #1ANC7           A/R Customer Nu
     C                     Z-ADDWHBKC7    #1BKC7           Ship To Custome
     C                     MOVELWHBRTX    #1BRTX           Ship To Name
     C                     MOVELWHHMNA    #1HMNA           Ship To Address
     C                     MOVELWHHONA    #1HONA           Ship To Address
     C                     MOVELWHHPNA    #1HPNA           Ship To Address
     C                     MOVELWHHNNA    #1HNNA           Ship To City
     C                     MOVELWHDBCD    #1DBCD           Ship To State C
     C                     MOVELWHCKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDWHB0C7    #1B0C7           Bill to Custome
     C                     MOVELWHAETX    #1AETX           Bill to Name
     C                     MOVELWHB1NA    #1B1NA           Bill to Address
     C                     MOVELWHB3NA    #1B3NA           Bill to Address
     C                     MOVELWHB4NA    #1B4NA           Bill to Address
     C                     MOVELWHB2NA    #1B2NA           Bill to City
     C                     MOVELWHBHCD    #1BHCD           Bill to State C
     C                     MOVELWHC8TX    #1C8TX           Bill to Zip/Pos
     C                     MOVELWHBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDWHA0DT    #1A0DT           Order Date
     C                     Z-ADDWHA5DT    #1A5DT           Requested Ship
     C                     Z-ADDWHGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDWHACDT    #1ACDT           Cancel Date
     C                     MOVELWHAQCD    #1AQCD           Terms Code
     C                     MOVELWHB6NA    #1B6NA           Special Instruc
     C                     MOVELWHBYNA    #1BYNA           Special Instruc
     C                     MOVELWHBZNA    #1BZNA           Carrier Code
     C                     MOVELWHGTST    #1GTST           Comment Print A
     C                     MOVELWHGVST    #1GVST           Comment Print I
     C                     MOVELWHGUST    #1GUST           Comment Print P
     C                     MOVELWHQFST    #1QFST           Comment Print S
     C                     MOVELWHCQCD    #1CQCD           Reason Code
     C                     MOVELWHGJST    #1GJST           Order in Use
     C                     MOVELWHGWST    #1GWST           Header Status
     C                     MOVELWHGXST    #1GXST           Header Status L
     C                     MOVELWHGYST    #1GYST           Order Type Prin
     C                     Z-ADDWHAODT    #1AODT           Scheduled Ship
     C                     MOVELWHAIVN    #1AIVN           User Original E
     C                     Z-ADDWHCXDT    #1CXDT           Date of Origina
     C                     Z-ADDWHJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDWHA1WG    #1A1WG           Order Weight To
     C                     MOVELWHXIST    #1XIST           Credit Hold
     C                     MOVELWHXJST    #1XJST           Production Hold
     C                     MOVELWHXKST    #1XKST           New Customer Ho
     C                     Z-ADDWHEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDWHAFTM    #1AFTM           Requested Deliv
     C                     MOVELWHE8CD    #1E8CD           Accounts Receiv
     C                     MOVELWHE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDWHRMNB    #1RMNB           Load ID
     C                     Z-ADDWHTBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDWHR1NB    #1R1NB           Rated Freight
     C                     MOVELWHPJST    #1PJST           LTL Flag
     C                     MOVELWHU0ST    #1U0ST           Price Audit
     C                     MOVELWHU1ST    #1U1ST           Price Status
     C                     MOVELWHQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWHU2ST    #1U2ST           Export Status
     C                     MOVELWHVEST    #1VEST           Palletize
     C                     MOVELWHVFST    #1VFST           Shrink Wrap
     C                     MOVELWHVGST    #1VGST           Slip Sheet
     C                     MOVELWHRPCD    #1RPCD           Age Code
     C                     Z-ADDWHRNNB    #1RNNB           Reefer Temperat
     C                     MOVELWHVDST    #1VDST           Load Type
     C                     Z-ADDWHATIN    #1ATIN           Attach to Invoi
     C                     MOVELWHU4ST    #1U4ST           Load Plan Order
     C                     MOVELWHU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDWHRSRN    #1RSRN           Resell Referenc
     C                     MOVELWHMHNA    #1MHNA           Special Comment
     C                     MOVELWHMINA    #1MINA           Special Comment
     C                     MOVELWHWBST    #1WBST           Affect Auto Acc
     C                     MOVELWHR4CD    #1R4CD           Sales Route Cod
     C                     MOVELWHBFCD    #1BFCD           Manager Level C
     C                     MOVELWHQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDWHT3NB    #1T3NB           Attach to Order
     C                     MOVELWHSICD    #1SICD           Reason for Pric
     C                     Z-ADDWHCONB    #1CONB           Invoice Number
     C                     MOVELWHCEST    #1CEST           Invoice Suffix
     C                     Z-ADDWHAWDT    #1AWDT           Invoice Date
     C                     MOVELWHJPCD    #1JPCD           Event Code
     C                     MOVELWHXUST    #1XUST           Trans Contol AS
     C                     MOVELWHZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDWHVRVA    #1VRVA           A/R order Value
     C                     MOVELWHOBST    #1OBST           Billing Activit
     C                     MOVELWHBCST    #1BCST           Block Order Fla
     C                     MOVELWHBDST    #1BDST           Order Certifica
     C                     MOVELWHUVST    #1UVST           EDI Status 1
     C                     MOVELWHUWST    #1UWST           EDI Status 2
     C                     MOVELWHUXST    #1UXST           EDI Status 3
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV Ship To City/State RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0045    WHAIC3           Company Number
     C                     Z-ADDWL0046    WHC4NB           Order Number
      * Establish starting position
     C           KRSTL     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHHNNA    WL0047           Ship To City
     C                     MOVELWHDBCD    WL0048           Ship To State C
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Stop Customer      RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQTM02           Load ID
     C           *LIKE     DEFN WFRVNB    WQTM03           Stop/Drop
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM02           Load ID
     C                     KFLD           WQTM03           Stop/Drop
      * Setup key
     C                     Z-ADDWL0049    WQTM02           Load ID
     C                     Z-ADDWL0050    WQTM03           Stop/Drop
      * Establish starting position
     C           KRSTM     SETLL@FLCPEB                    *
     C           KRSTM     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WL0051           Customer Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Customer Number    RT - Order Header TRG  * 
     C                     EXSR TNRVGN
     C           KRSTM     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Customer Number    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WHAIC3           Company Number
     C                     Z-ADDWFC4NB    WHC4NB           Order Number
      * Establish starting position
     C           KRSTN     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0051           Ship To Custome
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHBKC7    WL0051           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Stop Customer      RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to Load Planning Stop Cust
     C                     Z-ADDWL0052    YI0101           Stop/Drop
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE WL0052
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
     C           YI01      OCUR YM01
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCBKC7    WL0053           Ship To Custome
     C                     GOTO TOEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code Lmt,Bx RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTP01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTP02           Order Number
      * Define keylist
     C           KPSTP     KLIST
     C                     KFLD           WQTP01           Company Number
     C                     KFLD           WQTP02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Company Number
     C                     KFLD           WQTP02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTP01           Company Number
     C                     Z-ADD#1C4NB    WQTP02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSTP     SETLL@BGWKL1                    *
     C           KRSTP     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUCBAA           Warehouse Code
     C                     MOVEL*BLANK    YL0060           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0064           Boxes Total Qua
     C                     Z-ADD*ZERO     WUH8WG           USR Weight   9.
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PF3280 -- add "Cases" to the case-stmt
     C                     MOVELOMAJCD    WUCBAA           Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.U/M - Ordered is EQ Boxes
      *   |- c3    : DB1.U/M - Ordered is Mixed
      *   |- c4    : DB1.U/M - Ordered is Cases
      *   '-
     C           OMAGCD    IFEQ 'CB'                       *IF
     C           OMAGCD    OREQ 'BX'                       *OR
     C           OMAGCD    OREQ 'MX'                       *OR
     C           OMAGCD    OREQ 'CS'                       *OR
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/09/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/09/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELOMAGCD    YL0065           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0065    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0065           U/M - Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration 6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0065    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    YL0064           Boxes Total Qua
     C                     END                             *FI
     C                     ADD  OMAUWG    WUH8WG           USR Weight   9.
      * CASE: PAR.USR Unit of Measure is *Blank
     C           YL0060    IFEQ *BLANK                     *IF
     C                     MOVELYL0065    YL0060           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0065    IFEQ YL0060                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WUAGCD           U/M - Ordered
     C                     MOVELWUAGCD    YL0060           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTP     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0060    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0054           Company Number
     C                     MOVEL'BOXLOAD' WL0055    P      Company Value C
     C                     EXSR TQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0056    YL0066           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0064    IFLT YL0066                     *IF
     C                     MOVEL'CB'      YL0060           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0060           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0054    KMAIC3           Company Number
     C                     MOVELWL0055    KMV8CD           Company Value C
      * Establish starting position
     C           KRSTQ     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0056           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWUCBAA    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSTR     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUJFSX           Warehouse Type
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDWPST    WUJFSX           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV First Default Co  RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DTAJVN    WQTS01           User Profile Na
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           User Profile Na
      * Setup key
     C                     MOVELWL0057    WQTS01           User Profile Na
      * Establish starting position
     C           KRSTS     SETLL@DTRETE                    *
     C           KRSTS     READE@DTRETE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0058           Company Number
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0058           Company Number
     C                     GOTO TSEXIT                     *QUIT
     C           KRSTS     READE@DTRETE                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTINFN    BEGSR
      *================================================================
      * PMT Must Ship Dt Accpt IF - Order Header TRG  * 
      *================================================================
      * PMT Must Ship Dt Accpt IF
      * PMT Must Ship Dt Accpt PV - Order Header TRG  * 
     C                     CALL 'PDJFPVR'              90  PMT Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1EIDT    WQ0217  70       Requested Deliv
     C                     PARM WULYDT    WQ0218  70       Must Ship Date
     C                     PARM #1A5DT    WQ0219  70       Requested Ship
     C           WUATUS    PARM WUATUS    WQ0220  1        STATUS
     C                     PARM WUA5TM    WQ0221  60       Must Ship Time
     C                     PARM #1AFTM    WQ0222  40       Requested Deliv
     C                     PARM #RB7SX    WQ0223  3        Must Ship Error
     C                     PARM #1C4NB    WQ0224  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJFPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PAR.STATUS is No
     C           WUATUS    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Must Ship Date        USR to display format
      * Convert date
     C           1000000   ADD  WULYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0070
      * Send message 'Requested Ship Date can n'
     C                     MOVEL'USR2662' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCRRC    BEGSR
      *================================================================
      * CRT Load Header        CR - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0013  1        Load Held Over
     C                     MOVEL*BLANK    WN0014  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0015  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0016  1        LH Power Only L
     C                     MOVEL*BLANK    WN0017  1        MG Created Load
     C                     MOVEL*BLANK    WN0018  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0019  2        Load U/M
     C                     MOVEL*BLANK    WN0020  2        LH Unused Sts 8
     C                     Z-ADD*ZERO     WN0021  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0022  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0023  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0024  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0025  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0026  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0027  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0028  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0029  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0030  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0031  60       LH Unused Time
     C                     MOVEL*BLANK    WN0032  1        EDI Status 1
     C                     MOVEL*BLANK    WN0033  1        EDI Status 2
     C                     MOVEL*BLANK    WN0034  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0035  60       Job Time
     C                     MOVEL*BLANK    WN0036 10        User Id
     C                     MOVEL*BLANK    WN0037 10        Job Name
     C                     Z-ADD*ZERO     WN0038  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FJCPBO
     C                     Z-ADD#2RMNB    WIRMNB           Load ID
     C                     Z-ADD#2AIC3    WIAIC3           Company Number
     C                     Z-ADD#CHODT    WIAODT           Scheduled Ship
     C                     MOVELWUPJST    WIPJST           LTL Flag
     C                     MOVEL#PPKST    WIPKST           Load Status
     C                     Z-ADD#CPCNX    WIRNNB           Reefer Temperat
     C                     MOVEL*BLANK    WIDMTX           Seal 1
     C                     MOVEL*BLANK    WIDNTX           Seal 2
     C                     MOVEL*BLANK    WIDOTX           Seal 3
     C                     MOVEL*BLANK    WIWTTX           Seal 4
     C                     MOVEL*BLANK    WIWUTX           Seal 2 Unused
     C                     Z-ADD#CVTNB    WIRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WIFLAM           Flat Amount
     C                     MOVEL#PXQST    WIXQST           Allocate Pounds
     C                     Z-ADDWURRNB    WIRRNB           Total Stops
     C                     MOVEL*BLANK    WIDXTX           Trailer Id
     C                     MOVEL*BLANK    WIDYTX           Transloader Car
     C                     Z-ADD*ZERO     WISBNB           BOL Time
     C                     MOVEL#CR6CD    WIBZNA           Carrier Code
     C                     MOVEL#CTECD    WIRONB           Truck Size
     C                     Z-ADD*ZERO     WISQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD#2R1NB    WIR1NB           Rated Freight
     C                     MOVEL'O'       WIVCST           Ship Status
     C                     MOVEL#CWNST    WIVDST           Load Type
     C                     Z-ADD*ZERO     WISDNB           Number Pallets
     C                     Z-ADD*ZERO     WIPAOU           Number Pallets
     C                     Z-ADD*ZERO     WIDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WISXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WIHADT           Actual Arrival
     C                     Z-ADD*ZERO     WIAART           Actual Arrival
     C                     Z-ADD*ZERO     WIDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WIDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WIAQDT           Actual Departur
     C                     Z-ADD*ZERO     WIS6NB           Departure Time
     C                     Z-ADD#CT4NB    WIT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WIPRTM           Product Tempera
     C                     Z-ADD*ZERO     WINPSV           Number Spacers
     C                     MOVEL*BLANK    WIJ8TX           Car/Veh. Initia
     C                     Z-ADDWUTKNB    WITLMI           Total Load Mile
     C                     MOVEL*BLANK    WIJ9TX           Recorder ID
     C                     MOVEL#CCUST    WIQ2CD           Shipping Method
     C                     MOVEL#CVPCD    WIVPCD           Ship From Wareh
     C                     MOVEL#CV9CD    WIDBCD           Ship To State C
     C                     Z-ADD*ZERO     WIGRWE           Gross Weight
     C                     MOVEL#CXCCD    WIXCCD           Carrier Broker
     C                     MOVEL*BLANK    WIU2ST           Export Status
     C                     Z-ADD*ZERO     WIF9DT           Actual Ship Dat
     C                     MOVEL*BLANK    WIONTM           On Time - (Y/N)
     C                     Z-ADD*ZERO     WIJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WITRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WIJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WISPTM           Spotted Time
     C                     Z-ADD*ZERO     WIJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WILFTM           Load Finished T
     C                     Z-ADD*ZERO     WIJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WIBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WIJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WIBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WIKIDT           Truck Departure
     C                     Z-ADD*ZERO     WIASTM           Truck Departure
     C                     Z-ADD*ZERO     WIKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WIAJCM           Adjusted Depart
     C                     MOVEL*BLANK    WIXACD           Shipping Line
     C                     MOVEL*BLANK    WIOANA           Port Delv Termi
     C                     MOVEL*BLANK    WIK4TX           Vessel Name
     C                     Z-ADD*ZERO     WIVOAG           Voyage
     C                     Z-ADD*ZERO     WIKBDT           Sail Date
     C                     MOVEL*BLANK    WINBBO           Booking Number
     C                     MOVEL*BLANK    WIW4CD           Discharge Port
     C                     Z-ADD*ZERO     WIEFDT           Arrival Date
     C                     MOVEL*BLANK    WICNTN           Container Numbe
     C                     Z-ADD*ZERO     WIKCDT           Date In
     C                     Z-ADD*ZERO     WITMIN           Time In
     C                     Z-ADD*ZERO     WIKDDT           Date Out
     C                     Z-ADD*ZERO     WIVMNB           Time Out
     C                     Z-ADD*ZERO     WIOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WIKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WIATTM           Scheduled Deliv
     C                     MOVELWUGSTX    WIOTRS           LH Unused Sts
     C                     MOVELWUGSTX    WIRNST           LH Carrier Paym
     C                     Z-ADD*ZERO     WIBRBK           Bring Back Mile
     C                     Z-ADD#2EIDT    WIEIDT           Requested Deliv
     C                     MOVEL'A'       WIRMST           Load Acceptance
     C                     MOVEL*BLANK    WIAJCD           Warehouse Code
     C                     Z-ADD*ZERO     WIKKDT           On Yard Date
     C                     Z-ADD*ZERO     WIAVTM           On Yard Time
     C                     Z-ADD*ZERO     WIKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WIAXTM           Deadline Depart
     C                     MOVELWUGSTX    WILHOS           Load Held Over
     C                     MOVEL*BLANK    WIWNTX           Load Held Over
     C                     MOVEL*BLANK    WIOITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    WIOJTX           Express Mail Nu
     C                     Z-ADD*ZERO     WILLDT           Express Mail Da
     C                     MOVELWULSHG    WILSHG           Load Shag Flag
     C                     MOVELWUYPST    WIYPST           Load Wash Flag
     C                     Z-ADD*ZERO     WIK0DT           Product Complet
     C                     Z-ADD*ZERO     WIAYTM           Product Complet
     C                     Z-ADD*ZERO     WIKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WIICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WIIDWG           Tot Pallet Tare
     C                     MOVEL'N'       WIH9SX           Load Confirmed
     C                     MOVEL*BLANK    WIWOTX           Load Confirmed
     C                     Z-ADD*ZERO     WIK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WIAZTM           Load Door 1
     C                     Z-ADDP2K2DT    WIK2DT           Override Total
     C                     Z-ADD*ZERO     WIA0TM           Load Door 2
     C                     MOVELWUGSTX    WIROST           Partial Load
     C                     MOVELWUGSTX    WIRPST           Load Confirmati
     C                     MOVEL'N'       WIRQST           Export Load USD
     C                     MOVELWUGSTX    WIRRST           Late Delivery E
     C                     Z-ADD*ZERO     WIZBVA           Load Actual Fre
     C                     MOVEL*BLANK    WIWPTX           Hide on WW Load
     C                     MOVEL*BLANK    WIWQTX           Late Billing Em
     C                     MOVEL#2FRSX    WIWRTX           Shipping Temp C
     C                     MOVEL*BLANK    WIWSTX           LH Held Over Rs
     C                     MOVEL'N'       WIRVSX           Multi Company L
     C                     MOVELWUGSTX    WIR1SX           TPM Shipment St
     C                     MOVELWUGSTX    WIR3SX           LH On-Time Reas
     C                     MOVELWUGSTX    WIR4SX           LH Held Over Re
     C                     Z-ADD*ZERO     WIP1DT           TPM Planned Shi
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * ***** Change Log and Comments
     C                     EXSR UESUBR                     ***** Change Lo
     C           KLCRTU    KLIST
     C                     KFLD           WIRMNB           Load ID
      * Check for duplicate primary key
     C           KLCRTU    SETLL@FJCPBO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1189' W0RTN   7
      * Send message 'Load Header            EX'
     C                     MOVEL'USR1189' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C                     WRITE@FJCPBO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCHRC    BEGSR
      *================================================================
      * CHG For Load Planning  CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0039 15        Seal 1
     C                     MOVEL*BLANK    WN0040 15        Seal 2
     C                     MOVEL*BLANK    WN0041 15        Seal 3
     C                     MOVEL*BLANK    WN0042 15        Seal 4
     C                     MOVEL*BLANK    WN0043 15        Seal 2 Unused
     C                     MOVEL*BLANK    WN0044 20        Trailer Id
     C                     MOVEL*BLANK    WN0045  3        Transloader Car
     C                     Z-ADD*ZERO     WN0046  40       BOL Time
     C                     Z-ADD*ZERO     WN0047  70       Ld Hdr/Ld Dtl U
     C                     MOVEL*BLANK    WN0048  1        Ship Status
     C                     Z-ADD*ZERO     WN0049  50       Number Pallets
     C                     Z-ADD*ZERO     WN0050  50       Number Pallets
     C                     Z-ADD*ZERO     WN0051 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0052  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0053  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0054  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0055 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0056 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0057  70       Actual Departur
     C                     Z-ADD*ZERO     WN0058  40       Departure Time
     C                     Z-ADD*ZERO     WN0059  52       Product Tempera
     C                     Z-ADD*ZERO     WN0060  50       Number Spacers
     C                     MOVEL*BLANK    WN0061 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0062 12        Recorder ID
     C                     Z-ADD*ZERO     WN0063  70       Gross Weight
     C                     Z-ADD*ZERO     WN0064  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0065  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0066  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0067  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0068  70       Spotted Date
     C                     Z-ADD*ZERO     WN0069  60       Spotted Time
     C                     Z-ADD*ZERO     WN0070  70       Load Finished D
     C                     Z-ADD*ZERO     WN0071  60       Load Finished T
     C                     Z-ADD*ZERO     WN0072  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0073  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0074  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0075  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0076  70       Truck Departure
     C                     Z-ADD*ZERO     WN0077  60       Truck Departure
     C                     Z-ADD*ZERO     WN0078  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0079  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0080  3        Shipping Line
     C                     MOVEL*BLANK    WN0081 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0082 30        Vessel Name
     C                     Z-ADD*ZERO     WN0083  50       Voyage
     C                     Z-ADD*ZERO     WN0084  70       Sail Date
     C                     MOVEL*BLANK    WN0085 12        Booking Number
     C                     MOVEL*BLANK    WN0086 20        Discharge Port
     C                     Z-ADD*ZERO     WN0087  70       Arrival Date
     C                     MOVEL*BLANK    WN0088 12        Container Numbe
     C                     Z-ADD*ZERO     WN0089  70       Date In
     C                     Z-ADD*ZERO     WN0090  60       Time In
     C                     Z-ADD*ZERO     WN0091  70       Date Out
     C                     Z-ADD*ZERO     WN0092  60       Time Out
     C                     Z-ADD*ZERO     WN0093 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0094  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0095  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0096  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0097  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0098  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0099  70       Requested Deliv
     C                     MOVEL*BLANK    WN0100  1        Load Acceptance
     C                     MOVEL*BLANK    WN0101  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0102  70       On Yard Date
     C                     Z-ADD*ZERO     WN0103  60       On Yard Time
     C                     Z-ADD*ZERO     WN0104  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0105  60       Deadline Depart
     C                     MOVEL*BLANK    WN0106  1        Load Held Over
     C                     MOVEL*BLANK    WN0107  1        Load Held Over
     C                     MOVEL*BLANK    WN0108 15        Load Held Over
     C                     MOVEL*BLANK    WN0109 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0110 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0111  70       Express Mail Da
     C                     MOVEL*BLANK    WN0112  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0113  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0114  70       Product Complet
     C                     Z-ADD*ZERO     WN0115  60       Product Complet
     C                     Z-ADD*ZERO     WN0116  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0117  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0118  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0119  1        Load Confirmed
     C                     MOVEL*BLANK    WN0120 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0121  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0122  60       Load Door 1
     C                     Z-ADD*ZERO     WN0123  60       Load Door 2
     C                     MOVEL*BLANK    WN0124  1        Partial Load
     C                     MOVEL*BLANK    WN0125  1        Load Confirmati
     C                     MOVEL*BLANK    WN0126  1        Export Load USD
     C                     MOVEL*BLANK    WN0127  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0128 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0129 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0130 15        Late Billing Em
     C                     MOVEL*BLANK    WN0131 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0132  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0133  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0134  1        LH Power Only L
     C                     MOVEL*BLANK    WN0135  1        MG Created Load
     C                     MOVEL*BLANK    WN0136  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0137  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0138  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0139  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0140  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0141  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0142  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0143  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0144  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0145  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0146  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0147  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0148  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0149  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0150  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0151  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0152  60       LH Unused Time
     C                     MOVEL*BLANK    WN0153  1        EDI Status 1
     C                     MOVEL*BLANK    WN0154  1        EDI Status 2
     C                     MOVEL*BLANK    WN0155  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0156  60       Job Time
     C                     MOVEL*BLANK    WN0157 10        User Id
     C                     MOVEL*BLANK    WN0158 10        Job Name
     C                     Z-ADD*ZERO     WN0159  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0059    WIRMNB           Load ID
      *
     C           KLCHTV    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHTV    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0060    WIAIC3           Company Number
     C                     Z-ADDWL0061    WIAODT           Scheduled Ship
     C                     MOVELWL0062    WIPJST    P      LTL Flag
     C                     MOVELWL0063    WIPKST    P      Load Status
     C                     Z-ADDWL0064    WIRNNB           Reefer Temperat
     C                     Z-ADDWL0065    WIRPNB           Total Load Orde
     C                     Z-ADDWL0066    WIFLAM           Flat Amount
     C                     MOVELWL0067    WIXQST    P      Allocate Pounds
     C                     Z-ADDWL0068    WIRRNB           Total Stops
     C                     MOVELWL0069    WIBZNA    P      Carrier Code
     C                     MOVELWL0070    WIRONB    P      Truck Size
     C                     Z-ADDWL0071    WIR1NB           Rated Freight
     C                     MOVELWL0072    WIVDST    P      Load Type
     C                     Z-ADDWL0073    WIT4NB           Schedule Sequen
     C                     Z-ADDWL0074    WITLMI           Total Load Mile
     C                     MOVELWL0075    WIQ2CD    P      Shipping Method
     C                     MOVELWL0076    WIVPCD    P      Ship From Wareh
     C                     MOVELWL0077    WIDBCD    P      Ship To State C
     C                     MOVELWL0078    WIXCCD    P      Carrier Broker
     C                     MOVELWL0079    WIU2ST    P      Export Status
     C                     Z-ADDWL0080    WIK2DT           Override Total
     C                     MOVELWL0081    WIWRTX    P      Shipping Temp C
     C                     MOVELWL0082    WIRVSX    P      Multi Company L
     C                     MOVELWL0083    WIR0SX    P      Load U/M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WIAATM' defaulted for 'Job Time'.
      * Field '(DB1) WIAYNA' defaulted for 'User Id'.
      * Field '(DB1) WIA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WIAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv/Chg Sched Shp Dt   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTW     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Schedule Ship Date CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0084           Load ID
     C                     Z-ADDYL0057    WL0085           Scheduled Ship
     C                     EXSR TXCHRC
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXCHRC    BEGSR
      *================================================================
      * CHG Schedule Ship Date CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0160  30       Company Number
     C                     MOVEL*BLANK    WN0161  1        LTL Flag
     C                     MOVEL*BLANK    WN0162  1        Load Status
     C                     Z-ADD*ZERO     WN0163  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0164 15        Seal 1
     C                     MOVEL*BLANK    WN0165 15        Seal 2
     C                     MOVEL*BLANK    WN0166 15        Seal 3
     C                     MOVEL*BLANK    WN0167 15        Seal 4
     C                     MOVEL*BLANK    WN0168 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0169  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0170 112       Flat Amount
     C                     MOVEL*BLANK    WN0171  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0172  50       Total Stops
     C                     MOVEL*BLANK    WN0173 20        Trailer Id
     C                     MOVEL*BLANK    WN0174  3        Transloader Car
     C                     Z-ADD*ZERO     WN0175  40       BOL Time
     C                     MOVEL*BLANK    WN0176  3        Carrier Code
     C                     MOVEL*BLANK    WN0177  7        Truck Size
     C                     Z-ADD*ZERO     WN0178  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0179 112       Rated Freight
     C                     MOVEL*BLANK    WN0180  1        Ship Status
     C                     MOVEL*BLANK    WN0181  1        Load Type
     C                     Z-ADD*ZERO     WN0182  50       Number Pallets
     C                     Z-ADD*ZERO     WN0183  50       Number Pallets
     C                     Z-ADD*ZERO     WN0184 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0185  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0186  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0187  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0188 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0189 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0190  70       Actual Departur
     C                     Z-ADD*ZERO     WN0191  40       Departure Time
     C                     Z-ADD*ZERO     WN0192  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0193  52       Product Tempera
     C                     Z-ADD*ZERO     WN0194  50       Number Spacers
     C                     MOVEL*BLANK    WN0195 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0196  70       Total Load Mile
     C                     MOVEL*BLANK    WN0197 12        Recorder ID
     C                     MOVEL*BLANK    WN0198  2        Shipping Method
     C                     MOVEL*BLANK    WN0199  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0200  2        Ship To State C
     C                     Z-ADD*ZERO     WN0201  70       Gross Weight
     C                     MOVEL*BLANK    WN0202  3        Carrier Broker
     C                     MOVEL*BLANK    WN0203  1        Export Status
     C                     Z-ADD*ZERO     WN0204  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0205  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0206  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0207  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0208  70       Spotted Date
     C                     Z-ADD*ZERO     WN0209  60       Spotted Time
     C                     Z-ADD*ZERO     WN0210  70       Load Finished D
     C                     Z-ADD*ZERO     WN0211  60       Load Finished T
     C                     Z-ADD*ZERO     WN0212  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0213  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0214  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0215  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0216  70       Truck Departure
     C                     Z-ADD*ZERO     WN0217  60       Truck Departure
     C                     Z-ADD*ZERO     WN0218  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0219  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0220  3        Shipping Line
     C                     MOVEL*BLANK    WN0221 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0222 30        Vessel Name
     C                     Z-ADD*ZERO     WN0223  50       Voyage
     C                     Z-ADD*ZERO     WN0224  70       Sail Date
     C                     MOVEL*BLANK    WN0225 12        Booking Number
     C                     MOVEL*BLANK    WN0226 20        Discharge Port
     C                     Z-ADD*ZERO     WN0227  70       Arrival Date
     C                     MOVEL*BLANK    WN0228 12        Container Numbe
     C                     Z-ADD*ZERO     WN0229  70       Date In
     C                     Z-ADD*ZERO     WN0230  60       Time In
     C                     Z-ADD*ZERO     WN0231  70       Date Out
     C                     Z-ADD*ZERO     WN0232  60       Time Out
     C                     Z-ADD*ZERO     WN0233 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0234  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0235  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0236  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0237  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0238  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0239  70       Requested Deliv
     C                     MOVEL*BLANK    WN0240  1        Load Acceptance
     C                     MOVEL*BLANK    WN0241  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0242  70       On Yard Date
     C                     Z-ADD*ZERO     WN0243  60       On Yard Time
     C                     Z-ADD*ZERO     WN0244  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0245  60       Deadline Depart
     C                     MOVEL*BLANK    WN0246  1        Load Held Over
     C                     MOVEL*BLANK    WN0247  1        Load Held Over
     C                     MOVEL*BLANK    WN0248 15        Load Held Over
     C                     MOVEL*BLANK    WN0249 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0250 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0251  70       Express Mail Da
     C                     MOVEL*BLANK    WN0252  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0253  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0254  70       Product Complet
     C                     Z-ADD*ZERO     WN0255  60       Product Complet
     C                     Z-ADD*ZERO     WN0256  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0257  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0258  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0259  1        Load Confirmed
     C                     MOVEL*BLANK    WN0260 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0261  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0262  60       Load Door 1
     C                     Z-ADD*ZERO     WN0263  70       Override Total
     C                     Z-ADD*ZERO     WN0264  60       Load Door 2
     C                     MOVEL*BLANK    WN0265  1        Partial Load
     C                     MOVEL*BLANK    WN0266  1        Load Confirmati
     C                     MOVEL*BLANK    WN0267  1        Export Load USD
     C                     MOVEL*BLANK    WN0268  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0269 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0270 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0271 15        Late Billing Em
     C                     MOVEL*BLANK    WN0272 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0273 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0274  1        Multi Company L
     C                     MOVEL*BLANK    WN0275  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0276  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0277  1        LH Power Only L
     C                     MOVEL*BLANK    WN0278  1        MG Created Load
     C                     MOVEL*BLANK    WN0279  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0280  2        Load U/M
     C                     MOVEL*BLANK    WN0281  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0282  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0283  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0284  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0285  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0286  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0287  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0288  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0289  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0290  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0291  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0292  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0293  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0294  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0295  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0296  60       LH Unused Time
     C                     MOVEL*BLANK    WN0297  1        EDI Status 1
     C                     MOVEL*BLANK    WN0298  1        EDI Status 2
     C                     MOVEL*BLANK    WN0299  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0300  60       Job Time
     C                     MOVEL*BLANK    WN0301 10        User Id
     C                     MOVEL*BLANK    WN0302 10        Job Name
     C                     Z-ADD*ZERO     WN0303  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0084    WIRMNB           Load ID
      *
     C           KLCHTX    KLIST
     C                     KFLD           WIRMNB           Load ID
     C           KLCHTX    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * USER: Processing after Data read
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0085    WIAODT           Scheduled Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * RTV Load for Date Chg  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * 06/09/2015 PKD/JH E4122 Changed RTV to include Hdr Sts=A|H|L for
      *                         changing the Requested Ship Date.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQTY02           Load ID
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WQTY02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQTY02           Load ID
      * Establish starting position
     C           KRSTY     SETLL@BFCPD9                    *
     C           KRSTY     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 06/09/2015 PKD/JH e4122 Save Requested Ship Date for Change Log.
     C                     Z-ADDWBA5DT    YL0075           Requested Ship
      * 06/09/2015 E4122 Change Req Ship Date for Header Sts=E|A|H|L
      * CASE: DB1.Header Status is Avail/Alloc/Enter/Hold
     C           WBGWST    IFEQ 'L'                        *IF
     C           WBGWST    OREQ 'A'
     C           WBGWST    OREQ 'E'
     C           WBGWST    OREQ 'H'
     C                     Z-ADDYL0057    WUA5DT           Requested Ship
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBA5DT    WUA5DT           Requested Ship
     C                     END                             *FI
      * 06/17/2015 Added Deallocate/Allocate process before change to OD.
      * RTV Orders for Dt Chg RT - Order Detail  * 
     C                     EXSR TZRVGN
      * CHG Sch Shp & Req Shp CH - Order Header TRG  * 
     C                     EXSR NBCHRC
      * CRT Load/Order Chg Log XF - Load Order Change Log  * Sched Ship D
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
     C                     Z-ADD*ZERO     PCRVNB           Stop/Drop
     C                     MOVELWURVST    PCRVST    P      Load Change Typ
     C                     MOVELWUUJST    PCUJST    P      Department Cont
     C                     MOVELWUMNTX    PCMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#CR6CD    PCBZNA    P      Carrier Code
     C                     Z-ADDWBAIC3    PCAIC3           Company Number
     C                     Z-ADDWBC4NB    PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
      * 06/09/2015 PKD/JH E4122 Added Change Log for Requested Ship Date
     C                     MOVEL*BLANK    YL0078           Change Log Prio
     C                     MOVELYL0075    YL0078           Change Log Prio
     C                     MOVEL*BLANK    YL0079           Change Log New
     C                     MOVELWUA5DT    YL0079           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * Request Ship
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
     C                     Z-ADD*ZERO     PCRVNB           Stop/Drop
     C                     MOVEL'RQSSHP'  PCRVST    P      Load Change Typ
     C                     MOVELWUUJST    PCUJST    P      Department Cont
     C                     MOVELYL0078    PCMNTX    P      Change Log Prio
     C                     MOVELYL0079    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#CR6CD    PCBZNA    P      Carrier Code
     C                     Z-ADDWBAIC3    PCAIC3           Company Number
     C                     Z-ADDWBC4NB    PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
     C           KRSTY     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * RTV Orders for Dt Chg RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 06/09/2015 PKD/JH E4122 Added Deallocate and Allocate Process
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTZ01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTZ02           Order Number
      * Define keylist
     C           KPSTZ     KLIST
     C                     KFLD           WQTZ01           Company Number
     C                     KFLD           WQTZ02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           WQTZ01           Company Number
     C                     KFLD           WQTZ02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQTZ01           Company Number
     C                     Z-ADDWBC4NB    WQTZ02           Order Number
     C                     Z-ADD1         OMDPNB           Order Sequence
     C                     Z-ADD1         OMUENB           Order Secondary
      * Establish starting position
     C           KPSTZ     SETLL@BGWKL1                    *
     C           KRSTZ     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEALLOCATE
     C                     Z-ADDOMCCQT    YL0076           Quantity Schedu
     C                     Z-ADDOMAUWG    YL0077           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0271  30       Company Number
     C                     PARM OMC4NB    WQ0272  70       Order Number
     C                     PARM OMDPNB    WQ0273  30       Order Sequence
     C                     PARM OMUENB    WQ0274  30       Order Secondary
     C                     PARM OMHGCD    WQ0275  70       Item Code
     C                     PARM OMAJCD    WQ0276  3        Warehouse Code
     C                     PARM OMA5DT    WQ0277  70       Ship Date USR
     C                     PARM *ZERO     WQ0278 112       Quantity Ordere
     C                     PARM *ZERO     WQ0279 112       Weight Ordered
     C           YL0076    PARM YL0076    WQ0280 112       Quantity Schedu
     C           YL0077    PARM YL0077    WQ0281 112       Weight Schedule
     C                     PARM 'OD'      WQ0282  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0283 10        PSAA Program Na
     C                     PARM OMRINY    WQ0284  40       Item Age Days
     C                     PARM OMTIDT    WQ0285  70       Production Ovr
     C                     PARM OMTJDT    WQ0286  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ALLOCATE
     C                     Z-ADD*ZERO     YL0076           Quantity Schedu
     C                     Z-ADD*ZERO     YL0077           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0287  30       Company Number
     C                     PARM OMC4NB    WQ0288  70       Order Number
     C                     PARM OMDPNB    WQ0289  30       Order Sequence
     C                     PARM OMUENB    WQ0290  30       Order Secondary
     C                     PARM OMHGCD    WQ0291  70       Item Code
     C                     PARM OMAJCD    WQ0292  3        Warehouse Code
     C                     PARM WUA5DT    WQ0293  70       Ship Date USR
     C                     PARM OMAVQT    WQ0294 112       Quantity Ordere
     C                     PARM OMD0WG    WQ0295 112       Weight Ordered
     C           YL0076    PARM YL0076    WQ0296 112       Quantity Schedu
     C           YL0077    PARM YL0077    WQ0297 112       Weight Schedule
     C                     PARM 'OA'      WQ0298  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0299 10        PSAA Program Na
     C                     PARM OMRINY    WQ0300  40       Item Age Days
     C                     PARM OMTIDT    WQ0301  70       Production Ovr
     C                     PARM OMTJDT    WQ0302  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg SchShip/ReqShp Dt CH - Order Detail  * 
     C                     EXSR NACHRC
     C           KRSTZ     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 01/18/2010 PKD E000261 Pass the Average Pallet Tare
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Update "last" ctl fields
      *================================================================
     C                     Z-ADD#2C4NB    WUC4NB           Order Number
     C                     MOVEL#CCPCD    WUCPCD           USR Warehouse C
     C                     Z-ADD#CFKNB    WUFKNB           USR Company Num
     C                     Z-ADD#CTENB    WUTENB           USR Stop
     C                     Z-ADD#2AODT    WUAODT           Scheduled Ship
     C                     Z-ADD#2BKC7    WUBKC7           Ship To Custome
     C                     MOVEL#2DBCD    WUDBCD           Ship To State C
     C                     Z-ADD#CYGNX    WUYGNX           USR Weight, 5.0
     C                     MOVEL#2PJST    P1PJST           LTL Flag
     C                     MOVEL#CV1CD    WUV1CD           Region Code
     C                     Z-ADD#2RNNB    WURNNB           Reefer Temperat
     C                     MOVEL#2GWST    WUGWST           Header Status
     C                     MOVEL#2Q2CD    WUQ2CD           Shipping Method
      * ** If collect truck or rail, default carrier to Buy   FP1251
      * CASE: CTL.Shipping Method is Collect
     C           #2Q2CD    IFEQ 'CR'                       *IF
     C           #2Q2CD    OREQ 'CT'
     C                     MOVEL'BUY'     #2BZNA           Carrier Code
     C                     MOVEL'BUY'     #CR6CD           USR Carrier Cod
     C                     MOVEL'BUY'     #CXCCD           Carrier Broker
     C                     END                             *FI
     C                     MOVEL#2BCNA    WUBCNA           Customer Purcha
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Update "last" ctl load fields
      *================================================================
     C                     MOVEL#CR6CD    WUR6CD           USR Carrier Cod
     C                     MOVEL#CXCCD    WUXCCD           Carrier Broker
     C                     MOVEL#CTECD    WUTECD           USR Truck Size
     C                     Z-ADD#CT4NB    WUT4NB           Schedule Sequen
     C                     MOVEL#CV9CD    WUV9CD           USR State Code
     C                     Z-ADD#PFLAM    YL0046           Flat Amount
      * ** Always display override miles if they are entered.   E00207
      * CASE: PAR.Override Total Load Miles is Entered
     C           P2K2DT    IFNE *ZERO                      *IF
     C                     Z-ADDP2K2DT    #CTLMI           Total Load Mile
     C                     MOVEL'Y'       P3QKST           Display Flag
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 09/20/2011 LJB P001251 Export Order Automation
      * ** Cannot lock if Export Order Automation Upload had errors
      * ** that have not been cleared up
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 06/28/2006 LJB TRF011
      * ** Added 3 char LH On-Time Reason Code as an input parm to
      * ** replace the 1 char On Time Reason parm
      * *****
      * ** 09/19/2006 LJB PK0036
      * ** Added 3 char LH Heldover Reason Code as an input parm to
      * ** replace the 1 char Held Over Reason parm
      * *****
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Calc Load U/M     -- RMC added here for all loads 4/17/14 (not j
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0236  70       Load ID
     C           YL0072    PARM *BLANK    WQ0237  2        Load U/M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0309  70       Load ID
     C           WN0566    PARM *BLANK    WQ0310  2        Load U/M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Calc Load U/M     -- RMC added here for all loads 4/17/14 (not j
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0356  70       Load ID
     C           YL0072    PARM *BLANK    WQ0357  2        Load U/M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 06/10/2009 LJB E00328 Pass the formatted message back to
      * ** the calling program to be used by ESEND
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Process assign to load
      *================================================================
      * CASE: WRK.STATUS is No
     C           WUATUS    IFEQ 'N'                        *IF
      * this message gets cleared below, so it doesn't display
      * Setup message data for message
     C                     Z-ADD#RTENB    ZA0097           USR Stop
      * Send message 'This order cannot arrive'
     C                     MOVEL'USR2688' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9851  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1AODT    #CHODT           Scheduled Ship
     C                     ADD  1         WURUNB           Stop/Drop Seque
     C                     Z-ADD#RTENB    WURVNB           Stop/Drop
     C                     MOVEL'Y'       #RE6ST           USR Status (Y/N
      * Val Stop Existance    RT - Load Detail  * 
     C                     EXSR OPRVGN
      * Load Change Type for log
      * CASE: PAR.Record Found USR is Record Not Found
     C           P5WXST    IFEQ 'N'                        *IF
     C                     MOVEL'ADDSTP'  P5RVST           Load Change Typ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'ADDORD'  P5RVST           Load Change Typ
     C                     END                             *FI
      * E01488 RMC 5/19/11 upd Appt conf fields (were going out -0-, blan
     C                     Z-ADD*ZERO     YL0097           LD Carrier Appt
     C                     Z-ADD*ZERO     YL0098           LD Carrier Appt
      * Output Carrier appt if appt conf was made on order before load ti
      * CASE: RCD.OH Appt Confirmation Dt is Entered
     C           #1NODT    IFGT *ZERO                      *IF
     C                     Z-ADD#1EIDT    YL0097           LD Carrier Appt
     C           100       MULT #1AFTM    YL0098           LD Carrier Appt
     C                     END                             *FI
      * CRT Load Detail        CR - Load Detail  * 
     C                     EXSR OQCRRC
     C                     Z-ADDYL0057    YL0056           Scheduled Ship
      * UPD Load Information   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0125           Company Number
     C                     Z-ADD#1C4NB    WL0126           Order Number
     C                     MOVEL#CR6CD    WL0127    P      Carrier Code
     C                     Z-ADD#2RMNB    WL0128           Load ID
     C                     Z-ADD#2R1NB    WL0129           Rated Freight
     C                     MOVEL'02'      WL0130    P      Event Code
     C                     EXSR ORRVGN
      * ** Update OHE with Load ID/Stop Seq if it exists   FP1303
      * VAL CHG OHE for ld pln XF - Order Header Extension  * 
     C                     CALL 'PMDMXFR'              90  VAL CHG OHE for
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0368  30       Company Number
     C                     PARM #1C4NB    WQ0369  70       Order Number
     C                     PARM #2RMNB    WQ0370  70       Load ID
     C                     PARM WURUNB    WQ0371  50       Stop/Drop Seque
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9831  *
     C                     END
      * Crt Load Plan Event    RT - Order Events  * 
     C                     EXSR OVRVGN
     C                     MOVEL*BLANK    WUMNTX           Change Log Prio
     C                     MOVEL*BLANK    WUMOTX           Change Log New
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
     C                     Z-ADD#RTENB    PCRVNB           Stop/Drop
     C                     MOVELP5RVST    PCRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PCUJST    P      Department Cont
     C                     MOVELWUMNTX    PCMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##JOB     PCA0NA    P      Job Name
     C                     MOVEL#CR6CD    PCBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD#1C4NB    PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983151*
     C                     SETON                     32    *
     C                     END
     C                     Z-ADD*ZERO     #2R1NB           Rated Freight
      * If no orders already on load and ship mth is collect, fill in car
      * CASE: PAR.USR Check Y/N Status is Not Yes
     C           P5JDST    IFEQ *BLANK                     *IF
     C           P5JDST    OREQ 'N'
      * CASE: PAR.Shipping Method is Buyers Truck
     C           P2Q2CD    IFEQ 'CR'                       *IF
     C           P2Q2CD    OREQ 'CT'
      * CASE: CTL.USR Carrier Code EQ WRK.BLANK
     C           #CR6CD    IFEQ WUGSTX                     *IF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0122           Company Number
     C                     MOVEL@CN,011   WL0123    P      Company Value C
     C                     EXSR OORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    WUBXTX    P      System Value Al
     C                     MOVELWUBXTX    #CR6CD           USR Carrier Cod
     C                     MOVEL#CR6CD    #CXCCD           Carrier Broker
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'1'       WUFUST           Load Added/Dele
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * ** Log error if missing Miles to Next (not Dailys or HPB)
      * CASE: RCD.Must Ship Error is No Error
     C           #RB7SX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: ** No Miles to Next City Record (skip Dailys/HPB)
      *  - c1 AND c2
      *   |- c1    : WRK.STATUS is No
      *   |- c2    : LCL.Company Organization is Seaboard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUATUS    IFEQ 'N'                        *IF
     C           YL0039    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Only log "No Miles" if not an export               E000550
      * CASE: RCD.Export Status is Not Yes
     C           #1U2ST    IFEQ *BLANK                     *IF
     C           #1U2ST    OREQ 'N'
      * CRT Load/Order for DD/TXF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#2RMNB    PGRMNB           Load ID
     C                     Z-ADD#RTENB    PGRVNB           Stop/Drop
     C                     MOVEL'NOMILE'  PGRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PGUJST    P      Department Cont
     C                     MOVELP8MNTX    PGMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#1BZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDKTXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983151*
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT Load/Order for DD/TXF - Load/Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#2RMNB    PGRMNB           Load ID
     C                     Z-ADD#RTENB    PGRVNB           Stop/Drop
     C                     MOVEL'ACCDEA'  PGRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PGUJST    P      Department Cont
     C                     MOVELP8MNTX    PGMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#1BZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDKTXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983151*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Process delete from load
      *================================================================
     C                     MOVEL'N'       #RE6ST           USR Status (Y/N
      * DLT Single Load Dtl   RT - Load Detail  * 
     C                     EXSR OYRVGN
      * Dlt Event by Event Cde RT - OP Order Events  * 
     C                     EXSR PARVGN
      * RTV Latest Event/Date  RT - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0131           Company Number
     C                     Z-ADD#1C4NB    WL0132           Order Number
     C                     Z-ADDWUQ2NB    WL0133           Event Number
     C                     Z-ADD#1BKC7    WL0137           Ship To Custome
     C                     EXSR OWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0133    WUQ2NB           Event Number
     C                     MOVELWL0134    #1JPCD    P      Event Code
     C                     Z-ADDWL0135    WUNFNN           Event Date
     C                     MOVELWL0136    WUG0TX    P      Activity Hold
      * UPD Load Information   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0125           Company Number
     C                     Z-ADD#1C4NB    WL0126           Order Number
     C                     MOVEL*BLANK    WL0127           Carrier Code
     C                     Z-ADD*ZERO     WL0128           Load ID
     C                     Z-ADD*ZERO     WL0129           Rated Freight
     C                     MOVEL#1JPCD    WL0130    P      Event Code
     C                     EXSR ORRVGN
      * *------------------------------------------------------*
      * * 07/18/02 PKP When the Order is removed from the Load, change
      * *              the Deadline Departure Date and Time to zero.
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0153           Company Number
     C                     Z-ADD#1C4NB    WL0154           Order Number
     C                     Z-ADD*ZERO     WL0155           Deadline Depart
     C                     Z-ADD*ZERO     WL0156           Deadline Depart
     C                     EXSR PCRVGN
     C                     MOVEL*BLANK    WUKGTX           @Blank for 5
     C                     MOVELP9LMNB    WUKGTX           @Blank for 5
     C                     MOVEL*BLANK    WUKGTX           @Blank for 5
     C                     MOVEL#RRVNB    WUKGTX           @Blank for 5
     C                     MOVEL*BLANK    P8MNTX           Change Log Prio
     C                     MOVELWUKGTX    P8MNTX           Change Log Prio
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
     C                     Z-ADDP9LMNB    PCRVNB           Stop/Drop
     C                     MOVEL'DELORD'  PCRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PCUJST    P      Department Cont
     C                     MOVELP8MNTX    PCMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##JOB     PCA0NA    P      Job Name
     C                     MOVEL#1BZNA    PCBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD#1C4NB    PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV Check Existence    RT - OM Load Header  * 
     C                     EXSR PERVGN
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,012                    *IF
      * ** DDD/T are returned as zeros if no Miles Between Cities records
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0372  70       Load ID
     C           WUKZDT    PARM WUKZDT    WQ0373  70       Deadline Depart
     C           WUAXTM    PARM *ZERO     WQ0374  60       Deadline Depart
     C           YL0099    PARM *ZERO     WQ0375  70       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Load Accept Flag   CH - Load Header  * 
     C                     EXSR PFCHRC
      * CHG Deadline Date/Time RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0157           Load ID
     C                     Z-ADD*ZERO     WL0158           Stop/Drop Seque
     C                     Z-ADDWUKZDT    WL0159           Deadline Depart
     C                     Z-ADDWUAXTM    WL0160           Deadline Depart
     C                     EXSR PGRVGN
     C                     END                             *FI
     C                     Z-ADD*ZERO     #2R1NB           Rated Freight
      * RTV Chk any ords on Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0014           Load ID
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0015    WUJDST    P      USR Check Y/N S
      * If no more orders on load check default carrier & clear schd shp
      * CASE: WRK.USR Check Y/N Status is Not Yes
     C           WUJDST    IFEQ *BLANK                     *IF
     C           WUJDST    OREQ 'N'
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0122           Company Number
     C                     MOVEL@CN,011   WL0123    P      Company Value C
     C                     EXSR OORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    WUBXTX    P      System Value Al
     C                     MOVELWUBXTX    WUBZNA           Carrier Code
      * If carrier EQ default carrier,blank carrier/schd shp dt else just
      * CASE: CTL.USR Carrier Code EQ WRK.Carrier Code
     C           #CR6CD    IFEQ WUBZNA                     *IF
      * CHG Carrier/Schd Sp Dt CH - OM Load Header  * 
     C                     EXSR PICHRC
     C                     MOVEL*BLANK    #CR6CD           USR Carrier Cod
      * 9/5/2007 SLM Carrier is being changed to *blanks
     C                     MOVEL*BLANK    YL0073           Change Log Prio
     C                     MOVEL*BLANK    YL0074           Change Log New
     C                     MOVEL*BLANK    YL0073           Change Log Prio
     C                     MOVEL#2BZNA    YL0073           Change Log Prio
     C                     MOVEL*BLANK    YL0074           Change Log New
     C                     MOVEL#CR6CD    YL0074           Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
     C                     Z-ADD#PRVNB    PCRVNB           Stop/Drop
     C                     MOVEL'CARCHG'  PCRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PCUJST    P      Department Cont
     C                     MOVELYL0073    PCMNTX    P      Change Log Prio
     C                     MOVELYL0074    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#CR6CD    PCBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PCAIC3           Company Number
     C                     Z-ADD*ZERO     PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     MOVEL#CR6CD    #2BZNA           Carrier Code
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Schedule Ship Date CH - OM Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0084           Load ID
     C                     Z-ADD*ZERO     WL0085           Scheduled Ship
     C                     EXSR TXCHRC
     C                     END                             *FI
      * TPA 09/20/07 - Create Load Ord Chg Log for change in Sceduled Shi
     C                     MOVEL*BLANK    YL0073           Change Log Prio
     C                     MOVEL#CHODT    YL0073           Change Log Prio
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
     C                     Z-ADD#PRVNB    PCRVNB           Stop/Drop
     C                     MOVEL'SCHSHP'  PCRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PCUJST    P      Department Cont
     C                     MOVELYL0073    PCMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#CR6CD    PCBZNA    P      Carrier Code
     C                     Z-ADD#2AIC3    PCAIC3           Company Number
     C                     Z-ADD*ZERO     PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983132*
     C                     END
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
     C                     END                             *FI
     C                     MOVEL'2'       WUFUST           Load Added/Dele
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'Y'       WUR4ST           USR Update Flag
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Change Log
      *================================================================
      * -----------------------------------------------------------
      * ******** Note - there ARE 50 files being used in this pgm ****
      * -----------------------------------------------------------
      *   Load Accounting for the Plant and Load Balancing.
      * - Changed 'RTV UM/Whs Code Lmt,Bx RT - Order Detail'.
      * E00519 Access by WHS  IF
      * ---------- November 2009 PKD ----------
      * *****  WW Cust/Order Inq O.E.  *****
      * - Do not allow Transfer Co if Application WHS Restrict = Y.
      * ***** Edit Order Header ***** -TESTED 11/10/09
      * -  Added validation on Warehouse Code.  If Application WHS Restri
      * is Yes, then only the Warehouse Code for O/P Application Code
      * are allowed.  If the Application WHS Restrict is No, then the
      * User is allowed access to all Active Warehouses.
      * -  Changed the F4=Prompt to only display the Warehouses the
      * User has access to if the Application WHS Restrict is Yes.
      * ***** Edit Order Detail Lines & Copy Order Template ***** TESTED
      * -  Added validation for Item Code. For each application and
      * Warehouse, addtional access control is defined for TF Exempt Code
      * Users that are restricted by Warehouse, they may also be restrict
      * on the Items they are able to sell.
      * -  Added validation on Order TF Exempt Code.  If the Customer is
      * is Exempt, then they can only sell Exempt Product. (E00505)
      * ***** Edit Load Plan Order Entry *****
      * -  Added WHS Code to the Control Context and Record Context.
      * For Users that are Application WHS Restrict = Yes,
      * the CTL.Warehouse Code will be restricted to the
      * Warehouses that they have access to.
      * -  CTL.Warehouse Code will be required for Users with
      * Application Warehouse Controlled.
      * -  Added Delivery State Code (Sail Port State) to the screen.
      * It will default to the Ship To State Code.  It will be overriden
      * to the Sail Port State if the Shipping Line and Port Delivery
      * Terminal are entered in the Order Header Extent.
      * -  Added subfile select for WHS and Delv ST.
      * ***** Edit Load Plan *****
      * -  For Users that are Application WHS Restrict = Yes,
      * the CTL.Warehouse Code will be restricted to the
      * Warehouses that they have access to.
      * -  CTL.Warehouse Code will be required for Users with
      * Application Warehouse Controlled.
      * -  CTL.USR Load Type---Default from the CTL.USR Warehosue Code
      * for users that are Application WHS Restrict.
      * ***** Display Change Log/Accept Load (PDAOXFR) *****
      * -  Deletes will not be accepted by Application WHS Restricted
      * users because we do not know the Warehouse that was on the Load.
      * -  If Application WHS Restrict is Yes, then only select the load
      * for acceptance if at least one order on the load has a warehouse
      * where the user has access.
      * -  Reverse imaged Warehouse Code on the Display. The Users with
      * Application WHS Restrict of No will be able to see all Loads.
      * ***** Edit Load Plan *****
      * - Added Warehouse Code to the Control and Detail Context with
      * appropriate validations.
      * ***** Work With Load Confirmation *****
      * - Added Warehouse Code as a parameter from the Work With Load
      * Plan All screen for selection of the Loads to Display on the
      * screen.  Added selection for Warehouse Code if one passed in.
      * If the Load is not to be selected due to not matching the Whs,
      * a record is created for the load in the array (exception array).
      * - Added Warehouse Code to the Subfile.
      * ***** Order Status Report Prompt *****
      * - Added Warehouse Code restriction on the prompt.
      * ***** Work With Orders Price Audit/Maintenance *****
      * - Added Warehouse Code restriction.
      * ***** Work With Orders - Edit Ship Date  *****
      * - Added Warehouse Code restriction.
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 04096
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  16        W0CSRR  50
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ADD  16        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD16        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ014
     C           @#DFMT    ANDEQ'#SFLCTL'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#CWNST'  YPMTFD           USR Load Type
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDGE068
     C           ZHCSCL    ANDLE069
     C           @#DFMT    ANDEQ'#SFLCTL'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#CCUST'  YPMTFD           USR Shipping Me
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ020
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2PJST'  YPMTFD           LTL Flag
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'OMQ6DFRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     Z-ADD*ZERO     P1BKC7           Ship To Custome
     C                     MOVEL*BLANK    P1BRTX           Ship To Name
     C                     MOVEL*BLANK    P1HMNA           Ship To Address
     C                     MOVEL*BLANK    P1HONA           Ship To Address
     C                     MOVEL*BLANK    P1HPNA           Ship To Address
     C                     MOVEL*BLANK    P1GWST           Header Status
     C                     Z-ADD*ZERO     P1AODT           Scheduled Ship
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     MOVEL*BLANK    P1PJST           LTL Flag
     C                     MOVEL*BLANK    P1U2ST           Export Status
     C                     MOVEL*BLANK    P1VDST           Load Type
     C                     MOVEL*BLANK    P1XUST           Trans Contol AS
     C                     Z-ADD*ZERO     P2RPNB           Total Load Orde
     C                     Z-ADD*ZERO     P2FLAM           Flat Amount
     C                     MOVEL*BLANK    P2XQST           Allocate Pounds
     C                     MOVEL*BLANK    P2BZNA           Carrier Code
     C                     MOVEL*BLANK    P2RONB           Truck Size
     C                     Z-ADD*ZERO     P2DGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     P2DHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     P2DIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     P2T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     P2TLMI           Total Load Mile
     C                     MOVEL*BLANK    P2Q2CD           Shipping Method
     C                     MOVEL*BLANK    P2XACD           Shipping Line
     C                     MOVEL*BLANK    P2OANA           Port Delv Termi
     C                     Z-ADD*ZERO     P2K2DT           Override Total
     C                     Z-ADD*ZERO     P3BUNB           USR Weight, 9.0
     C                     MOVEL*BLANK    P3PNST           Auto Load Numbe
     C                     Z-ADD*ZERO     P3RSNB           Maximum pounds
     C                     Z-ADD*ZERO     P3TANB           Minimum pounds
     C                     MOVEL*BLANK    P3QKST           Display Flag
     C                     Z-ADD*ZERO     P3RQNB           Total Freight
     C                     Z-ADD*ZERO     P3NVDT           Deadline Depart
     C                     MOVEL*BLANK    P4AJCD           Warehouse Code
     C                     MOVEL*BLANK    P4DNCD           Application Cod
     C                     MOVEL*BLANK    P4BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P4B8NA           System Date For
     C                     MOVEL*BLANK    P4I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P4MPNA           Default Printer
     C                     MOVEL*BLANK    P4TAST           First Time Flag
     C                     Z-ADD*ZERO     P5DTWG           Weight Adjust
     C                     Z-ADD*ZERO     P5TENB           USR Stop
     C                     MOVEL*BLANK    P5JDST           USR Check Y/N S
     C                     Z-ADD*ZERO     P5JLCR           USR Julian - Cu
     C                     Z-ADD*ZERO     P5CDWG           USR Weight Accu
     C                     MOVEL*BLANK    P5RVST           Load Change Typ
     C                     MOVEL*BLANK    P5WXST           Record Found US
     C                     Z-ADD*ZERO     P7RVNB           Stop/Drop
     C                     MOVEL*BLANK    P8MNTX           Change Log Prio
     C                     Z-ADD*ZERO     P9LMNB           Hold Stop/Drop
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Display File Add/Change
     C                     MOVEL*BLANK    WUQSST  1
      * Define work field Load Added/Deleted     .U
     C                     MOVEL*BLANK    WUFUST  1
      * Define work field Total Miles
     C                     Z-ADD*ZERO     WUTKNB  70
      * Define work field Shipping Temp C/F txt
     C                     MOVEL*BLANK    WUWRTX 25
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Spacers
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Dock Unavail Start Time
     C                     Z-ADD*ZERO     WUDPTM  60
      * Define work field Dock Unavail End Time
     C                     Z-ADD*ZERO     WUDQTM  60
      * Define work field Deadline Depart Date LH
     C                     Z-ADD*ZERO     WUNVDT  70
      * Define work field Deadline Depart Time LH
     C                     Z-ADD*ZERO     WUBUTM  60
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Define work field Current System Date
     C                     Z-ADD*ZERO     WUSDTE 155
      * Define work field Current System Time
     C                     Z-ADD*ZERO     WUZHNB 155
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field USR Carrier Code
     C                     MOVEL*BLANK    WUR6CD  3
      * Define work field USR Truck Size
     C                     MOVEL*BLANK    WUTECD  7
      * Define work field USR Load Type
     C                     MOVEL*BLANK    WUWNST  1
      * Define work field USR Shipping Method
     C                     MOVEL*BLANK    WUCUST  2
      * Define work field Schedule Sequence Number
     C                     Z-ADD*ZERO     WUT4NB  50
      * Define work field USR State Code
     C                     MOVEL*BLANK    WUV9CD  2
      * Define work field USR Assigned This Load
     C                     MOVEL*BLANK    WUQZST  1
      * Define work field USR Stop
     C                     Z-ADD*ZERO     WUTENB  30
      * Define work field USR Output Only Status
     C                     MOVEL*BLANK    WUE5ST  1
      * Define work field Trailer Id
     C                     MOVEL*BLANK    WUDXTX 20
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR Warehouse Code
     C                     MOVEL*BLANK    WUCPCD  3
      * Define work field Status Flag 3  Y/N
     C                     MOVEL*BLANK    WUQ3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01    50
     C                     Z-ADD1         Y       50
     C                     ENDIF
      *
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Define work field USR Weight, 5.0
     C                     Z-ADD*ZERO     WUYGNX  50
      * Define work field Region Code
     C                     MOVEL*BLANK    WUV1CD  4
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Shipping Method
     C                     MOVEL*BLANK    WUQ2CD  2
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Customer Purchase Order #
     C                     MOVEL*BLANK    WUBCNA 15
      * Define work field USR Company Number
     C                     Z-ADD*ZERO     WUFKNB  30
      * Define work field Carrier Broker
     C                     MOVEL*BLANK    WUXCCD  3
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Define work field Block Order Flag
     C                     MOVEL*BLANK    WUBCST  1
      * Define work field *SFLSEL
     C                     MOVEL*BLANK    WUSEL   1
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WFRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WFRWNB           Miles to next s
     C                     Z-ADD*ZERO     WFRXNB           Freight Charge
     C                     Z-ADD*ZERO     WFSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WFT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WFT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WFSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WFKFDT           Appointment Con
     C                     Z-ADD*ZERO     WFACTM           Appointment Con
     C                     Z-ADD*ZERO     WFEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WFAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WFKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WFATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WFHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFKKDT           On Yard Date
     C                     Z-ADD*ZERO     WFAVTM           On Yard Time
     C                     Z-ADD*ZERO     WFZ4NB           MPC Number
     C                     Z-ADD*ZERO     WFN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WFN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WFN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WFB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WFB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WFB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Unlock Load Authority
     C                     MOVEL*BLANK    WUHTST  1
      * Define work field Pick Status USR
     C                     MOVEL*BLANK    WUZMST  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WGEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WGNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WGNSVA           Long hook balan
     C                     Z-ADD*ZERO     WGNTVA           Short hook bala
     C                     Z-ADD*ZERO     WGNUVA           Tub Balance
     C                     Z-ADD*ZERO     WGS8NB           Home Phone
     C                     Z-ADD*ZERO     WGS9NB           Other Phone
     C                     Z-ADD*ZERO     WGNMVA           Flat Rate
     C                     Z-ADD*ZERO     WGNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WGNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WGNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WGQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WGQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WGMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WGMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WGRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WGMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WGBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WGBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WGBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WGBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WGBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WGBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WGDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WGDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WGDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WGDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WGDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WGDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WGB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WGB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WGB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WGB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WGB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WGB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WGAAC7           Contact Number
     C                     Z-ADD*ZERO     WGTENO           Carrier Unused
     C                     Z-ADD*ZERO     WGAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WGAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WGKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field USR Input 1
     C                     MOVEL*BLANK    WUSGST  1
      * Define work field USR Input 2
     C                     MOVEL*BLANK    WUSHST  1
      * Define work field USR Return Code
     C                     MOVEL*BLANK    WUN7CD  1
      * Define work field USR Display 1
     C                     MOVEL*BLANK    WUTIST  1
      * Define work field Warehouse Code PASS   USR
     C                     MOVEL*BLANK    WUT3CD  3
      * Define work field Must Ship Error
     C                     MOVEL*BLANK    WUB7SX  3
      * Define work field USR Exit Program
     C                     MOVEL*BLANK    WUSTYN  1
      * Define work field USR Input 3
     C                     MOVEL*BLANK    WUHZSX  1
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
      * Define work field Deadline Depart DT    HDR
     C                     Z-ADD*ZERO     WUHDDT  70
      * Define work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     WUAUTM  60
      * Define work field USR City
     C                     MOVEL*BLANK    WUGUNA 20
      * Define work field Must Ship Date        USR
     C                     Z-ADD*ZERO     WULYDT  70
      * Define work field Must Ship Time        USR
     C                     Z-ADD*ZERO     WUA5TM  60
      * Define work field STATUS
     C                     MOVEL*BLANK    WUATUS  1
      * Define work field Customer Number       NBR
     C                     Z-ADD*ZERO     WUAJNB  70
      * Define work field Warehouse Code Assigned
     C                     MOVEL*BLANK    WUCBAA  3
      * Define work field USR Weight   9.1  3
     C                     Z-ADD*ZERO     WUH8WG  91
      * Define work field U/M - Ordered
     C                     MOVEL*BLANK    WUAGCD  2
      * Define work field Warehouse Type Assigned
     C                     MOVEL*BLANK    WUJFSX  2
      * Define work field Date From             USR
     C                     Z-ADD*ZERO     WUJEDT  70
      * Define work field USR Percent Work, 7.4
     C                     Z-ADD*ZERO     WUBHPC  74
      * Define work field USR Freight Amount 1
     C                     Z-ADD*ZERO     WUDLVA 112
      * Define work field Stop/Drop
     C                     Z-ADD*ZERO     WURVNB  50
      * Define work field Error Status  2
     C                     MOVEL*BLANK    WUTUST  1
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Define work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     WUUENB  30
      * Define work field Load Shag Flag
     C                     MOVEL*BLANK    WULSHG  1
      * Define work field Load Wash Flag
     C                     MOVEL*BLANK    WUYPST  1
      * Define work field LTL Flag
     C                     MOVEL*BLANK    WUPJST  1
      * Define work field Total Stops
     C                     Z-ADD*ZERO     WURRNB  50
      * Clear all neither parameters
      * CRT Load Header        CR - Load Header  * 
     C                     Z-ADD*ZERO     WIPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WICKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WIPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WICLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WIP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WICMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WICNTM           LH Unused Time
     C                     Z-ADD*ZERO     WIP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WICOTM           LH Unused Time
     C                     Z-ADD*ZERO     WIP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WICQTM           LH Unused Time
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Multi Company Load
     C                     MOVEL*BLANK    WURVSX  1
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Change Log Prior Value
     C                     MOVEL*BLANK    WUMNTX 12
      * Define work field Change Log New Value
     C                     MOVEL*BLANK    WUMOTX 12
      * Define work field Requested Ship Date
     C                     Z-ADD*ZERO     WUA5DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDPNB           Order Sequence
     C                     Z-ADD*ZERO     WJUENB           Order Secondary
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WJMAVA           Billing Detail
     C                     Z-ADD*ZERO     WJKDVA           Billing Detail
     C                     Z-ADD*ZERO     WJL8VA           Billing Detail
     C                     Z-ADD*ZERO     WJL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WJAYVA           Extended Amount
     C                     Z-ADD*ZERO     WJEXDT           Market Pricing
     C                     Z-ADD*ZERO     WJBZPR           Price Overage O
     C                     Z-ADD*ZERO     WJL6NB           Contract Number
     C                     Z-ADD*ZERO     WJGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WJD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WJCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WJAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WJCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WJATWG           Weight Shipped
     C                     Z-ADD*ZERO     WJAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WJAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WJAKPR           Unit Price
     C                     Z-ADD*ZERO     WJALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WJAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WJAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WJA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WJA5DT           Requested Ship
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJCXDT           Date of Origina
     C                     Z-ADD*ZERO     WJDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WJB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WJA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WJNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WJNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WJNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WJNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WJNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WJBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WJBVTM           Price Code
     C                     Z-ADD*ZERO     WJBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WJBXTM           Substitution Li
     C                     Z-ADD*ZERO     WJBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WJH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WJH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WJH7NX           OD Item Target
     C                     Z-ADD*ZERO     WJH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WJH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WJDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WJDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WJDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WJDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WJDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WJGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WJGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WJGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WJPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WJRINY           Item Age Days
     C                     Z-ADD*ZERO     WJTIDT           Production Ovr
     C                     Z-ADD*ZERO     WJTJDT           Production Ovr
     C                     Z-ADD*ZERO     WJTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WJTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WJTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Company Number     041405
     C                     Z-ADD*ZERO     WUBQC3  30
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field Destination City
     C                     MOVEL*BLANK    WUXECD 20
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field USR Detail or Summary
     C                     MOVEL*BLANK    WUSTST  1
      * Define work field AUTO PRINT PRELIM PICK
     C                     MOVEL*BLANK    WUCLST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field System Value Numeric
     C                     Z-ADD*ZERO     WUM8NB 155
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define work field USR Load Id ALpha
     C                     MOVEL*BLANK    WULONA  7
      * Define work field DL List ID
     C                     MOVEL*BLANK    WUCLAA 10
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Define work field Display Flag
     C                     MOVEL*BLANK    WUQKST  1
      * Define work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     WURUNB  50
      * Define work field Miles Error Sts
     C                     MOVEL*BLANK    WUIASX  1
      * Define work field LD Unused Sts 2
     C                     MOVEL*BLANK    WUIBSX  1
      * Define work field HPB Transload Station
     C                     MOVEL*BLANK    WUICSX  2
      * Clear all neither parameters
      * CRT Load Detail        CR - Load Detail  * 
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVAIC3           Company Number
     C                     Z-ADD*ZERO     WVC4NB           Order Number
     C                     Z-ADD*ZERO     WVQ2NB           Event Number
     C                     Z-ADD*ZERO     WVAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WVQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WVD2DT           Event Date
     C                     Z-ADD*ZERO     WVAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WVQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WVQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WVBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Clear all neither parameters
      * CRT OP Order Events    CR - Order Events  * 
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Define work field System Value Alpha
     C                     MOVEL*BLANK    WUBXTX 40
      * Define work field @Blank for 5
     C                     MOVEL*BLANK    WUKGTX  5
      * Define work field Deadline Departure Date
     C                     Z-ADD*ZERO     WUKZDT  70
      * Define work field Deadline Departure Time
     C                     Z-ADD*ZERO     WUAXTM  60
      * Define work field Carrier Code
     C                     MOVEL*BLANK    WUBZNA  3
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Define work field Mileage To Customer
     C                     Z-ADD*ZERO     WUMTCU  92
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TAAIC3           Company Number
     C                     Z-ADD*ZERO     TAAXNB           Current Account
     C                     Z-ADD*ZERO     TANGNB           Current Account
     C                     Z-ADD*ZERO     TABZNB           OM Week
     C                     Z-ADD*ZERO     TAC5NB           Next Order Numb
     C                     Z-ADD*ZERO     TAC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     TACYNB           Next Credit Mem
     C                     Z-ADD*ZERO     TAIONB           Next Charge Bac
     C                     Z-ADD*ZERO     TAI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     TADCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     TAC7NB           Next Customer #
     C                     Z-ADD*ZERO     TAC2NB           Next Inventory
     C                     Z-ADD*ZERO     TAC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     TAL8NB           Next Contract/P
     C                     Z-ADD*ZERO     TABANB           Next HPB Batch
     C                     Z-ADD*ZERO     TAAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     TAASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     TAA2VA           Late Charge Min
     C                     Z-ADD*ZERO     TAAADY           A/P Aging Days
     C                     Z-ADD*ZERO     TAABDY           A/P Aging Days
     C                     Z-ADD*ZERO     TAACDY           A/P Aging Days
     C                     Z-ADD*ZERO     TAADDY           A/P Aging Days
     C                     Z-ADD*ZERO     TAAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     TAAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     TAAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     TAAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     TAAENB           Retention Perio
     C                     Z-ADD*ZERO     TAALNB           Retention Perio
     C                     Z-ADD*ZERO     TAEVNB           Retention Perio
     C                     Z-ADD*ZERO     TARPOP           Retention Perio
     C                     Z-ADD*ZERO     TADWNB           Retention Perio
     C                     Z-ADD*ZERO     TAR3NB           Next Load ID
     C                     Z-ADD*ZERO     TAR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     TASCNB           Production Numb
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  60
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0007  7
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  50
     C                     Z-ADD*ZERO     WL0012  92
     C                     Z-ADD*ZERO     WL0013  92
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  50
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  60
      * Define local variables for subroutine SQCRRC.
     C                     Z-ADD*ZERO     WL0021  50
     C                     Z-ADD*ZERO     WL0022  70
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0023  70
      * Define local variables for subroutine SSRVGN.
     C                     MOVEL*BLANK    WL0024  3
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0025  2
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
      * Define local variables for subroutine SYRVGN.
     C                     MOVEL*BLANK    WL0029 10
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031 10
     C                     MOVEL*BLANK    WL0032  3
     C                     Z-ADD*ZERO     WL0033  30
     C                     MOVEL*BLANK    WL0034 10
      * Define local variables for subroutine SZRVGN.
     C                     MOVEL*BLANK    WL0035 10
     C                     MOVEL*BLANK    WL0036  6
     C                     Z-ADD*ZERO     WL0037  30
     C                     MOVEL*BLANK    WL0038  3
      * Define local variables for subroutine TARVGN.
     C                     MOVEL*BLANK    WL0039  3
     C                     Z-ADD*ZERO     WL0040  30
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0041  30
     C                     MOVEL*BLANK    WL0042 30
      * Define local variables for subroutine TGRVGN.
     C                     Z-ADD*ZERO     WL0043  70
     C                     MOVEL*BLANK    WL0044  1
      * Define local variables for subroutine TLRVGN.
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  70
     C                     MOVEL*BLANK    WL0047 20
     C                     MOVEL*BLANK    WL0048  2
      * Define local variables for subroutine TMRVGN.
     C                     Z-ADD*ZERO     WL0049  70
     C                     Z-ADD*ZERO     WL0050  50
     C                     Z-ADD*ZERO     WL0051  70
      * Define local variables for subroutine TORVGN.
     C                     Z-ADD*ZERO     WL0052  50
     C                     Z-ADD*ZERO     WL0053  70
      * Define local variables for subroutine TQRVGN.
     C                     Z-ADD*ZERO     WL0054  30
     C                     MOVEL*BLANK    WL0055 10
     C                     Z-ADD*ZERO     WL0056 155
      * Define local variables for subroutine TSRVGN.
     C                     MOVEL*BLANK    WL0057 10
     C                     Z-ADD*ZERO     WL0058  30
      * Define local variables for subroutine TVCHRC.
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  30
     C                     Z-ADD*ZERO     WL0061  70
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  1
     C                     Z-ADD*ZERO     WL0064  52
     C                     Z-ADD*ZERO     WL0065  70
     C                     Z-ADD*ZERO     WL0066 112
     C                     MOVEL*BLANK    WL0067  1
     C                     Z-ADD*ZERO     WL0068  50
     C                     MOVEL*BLANK    WL0069  3
     C                     MOVEL*BLANK    WL0070  7
     C                     Z-ADD*ZERO     WL0071 112
     C                     MOVEL*BLANK    WL0072  1
     C                     Z-ADD*ZERO     WL0073  50
     C                     Z-ADD*ZERO     WL0074  70
     C                     MOVEL*BLANK    WL0075  2
     C                     MOVEL*BLANK    WL0076  3
     C                     MOVEL*BLANK    WL0077  2
     C                     MOVEL*BLANK    WL0078  3
     C                     MOVEL*BLANK    WL0079  1
     C                     Z-ADD*ZERO     WL0080  70
     C                     MOVEL*BLANK    WL0081 25
     C                     MOVEL*BLANK    WL0082  1
     C                     MOVEL*BLANK    WL0083  2
      * Define local variables for subroutine TXCHRC.
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085  70
      * Define local variables for subroutine NGRVGN.
     C                     Z-ADD*ZERO     WL0086  70
     C                     Z-ADD*ZERO     WL0087  50
     C                     MOVEL*BLANK    WL0088  3
      * Define local variables for subroutine NLRVGN.
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090  50
     C                     Z-ADD*ZERO     WL0091  70
     C                     Z-ADD*ZERO     WL0092  40
      * Define local variables for subroutine NNRVGN.
     C                     Z-ADD*ZERO     WL0093  70
     C                     MOVEL*BLANK    WL0094  2
      * Define local variables for subroutine NORVGN.
     C                     Z-ADD*ZERO     WL0095  70
     C                     Z-ADD*ZERO     WL0096  50
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  50
      * Define local variables for subroutine NPRVGN.
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100  51
      * Define local variables for subroutine NQRVGN.
     C                     Z-ADD*ZERO     WL0101  70
     C                     MOVEL*BLANK    WL0102  1
     C                     Z-ADD*ZERO     WL0103  70
     C                     Z-ADD*ZERO     WL0104  70
      * Define local variables for subroutine NYRVGN.
     C                     Z-ADD*ZERO     WL0105  70
     C                     MOVEL*BLANK    WL0106  1
      * Define local variables for subroutine OCRVGN.
     C                     Z-ADD*ZERO     WL0107  30
     C                     MOVEL*BLANK    WL0108  6
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  1
      * Define local variables for subroutine ODRVGN.
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112 112
     C                     MOVEL*BLANK    WL0113  3
     C                     MOVEL*BLANK    WL0114  2
      * Define local variables for subroutine OGRVGN.
     C                     Z-ADD*ZERO     WL0115  70
     C                     Z-ADD*ZERO     WL0116  50
      * Define local variables for subroutine OLCHRC.
     C                     Z-ADD*ZERO     WL0117  30
     C                     Z-ADD*ZERO     WL0118  70
     C                     Z-ADD*ZERO     WL0119  30
     C                     Z-ADD*ZERO     WL0120  30
     C                     Z-ADD*ZERO     WL0121 112
      * Define local variables for subroutine OORVGN.
     C                     Z-ADD*ZERO     WL0122  30
     C                     MOVEL*BLANK    WL0123 10
     C                     MOVEL*BLANK    WL0124 40
      * Define local variables for subroutine ORRVGN.
     C                     Z-ADD*ZERO     WL0125  30
     C                     Z-ADD*ZERO     WL0126  70
     C                     MOVEL*BLANK    WL0127  3
     C                     Z-ADD*ZERO     WL0128  70
     C                     Z-ADD*ZERO     WL0129 112
     C                     MOVEL*BLANK    WL0130  2
      * Define local variables for subroutine OWRVGN.
     C                     Z-ADD*ZERO     WL0131  30
     C                     Z-ADD*ZERO     WL0132  70
     C                     Z-ADD*ZERO     WL0133  50
     C                     MOVEL*BLANK    WL0134  2
     C                     Z-ADD*ZERO     WL0135  70
     C                     MOVEL*BLANK    WL0136  1
     C                     Z-ADD*ZERO     WL0137  70
      * Define local variables for subroutine OXCRRC.
     C                     Z-ADD*ZERO     WL0138  30
     C                     Z-ADD*ZERO     WL0139  70
     C                     Z-ADD*ZERO     WL0140  50
     C                     MOVEL*BLANK    WL0141  2
     C                     Z-ADD*ZERO     WL0142  30
     C                     Z-ADD*ZERO     WL0143  70
     C                     MOVEL*BLANK    WL0144  2
     C                     Z-ADD*ZERO     WL0145  70
     C                     MOVEL*BLANK    WL0146  1
     C                     MOVEL*BLANK    WL0147  1
     C                     MOVEL*BLANK    WL0148  1
     C                     Z-ADD*ZERO     WL0149  30
     C                     Z-ADD*ZERO     WL0150  70
     C                     Z-ADD*ZERO     WL0151  50
     C                     Z-ADD*ZERO     WL0152  70
      * Define local variables for subroutine PCRVGN.
     C                     Z-ADD*ZERO     WL0153  30
     C                     Z-ADD*ZERO     WL0154  70
     C                     Z-ADD*ZERO     WL0155  70
     C                     Z-ADD*ZERO     WL0156  60
      * Define local variables for subroutine PGRVGN.
     C                     Z-ADD*ZERO     WL0157  70
     C                     Z-ADD*ZERO     WL0158  50
     C                     Z-ADD*ZERO     WL0159  70
     C                     Z-ADD*ZERO     WL0160  60
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Company Organization
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field CDI Valuation Grouping
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field CDI Unused Sts 3
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field CDI Shipper
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field CDI Produced by co
     C                     MOVEL*BLANK    YN0006  2
      * Define local work field Application WHS Restrict
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0007  2
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0008  1
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0004 30
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0005 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0006 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0007 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0008 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0010 11
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0011  3
      * Define local work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Air Freight Order
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Export USDA Approved
     C                     MOVEL*BLANK    YL0014  2
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0015  30
      * Define local work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field OHE City
     C                     MOVEL*BLANK    YL0017 25
      * Define local work field OHE Vessel/Airline
     C                     MOVEL*BLANK    YL0018 30
      * Define local work field OHE Voyage/Flight
     C                     MOVEL*BLANK    YL0019 15
      * Define local work field OHE Booking Number
     C                     MOVEL*BLANK    YL0020 15
      * Define local work field OHE Discharge Port/Airprt
     C                     MOVEL*BLANK    YL0021 20
      * Define local work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YL0023  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YL0025  3
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field OHE Container Number
     C                     MOVEL*BLANK    YL0027 12
      * Define local work field OHE Comment 1
     C                     MOVEL*BLANK    YL0028 35
      * Define local work field OHE Comment 2
     C                     MOVEL*BLANK    YL0029 75
      * Define local work field Port Address Line 1
     C                     MOVEL*BLANK    YL0030 25
      * Define local work field Port Address Line 2
     C                     MOVEL*BLANK    YL0031 25
      * Define local work field Port Zip/Postal Code
     C                     MOVEL*BLANK    YL0032 11
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0033 110
      * Define local work field Port Fax Number
     C                     MOVEL*BLANK    YL0034 25
      * Define local work field Pallets Loaded
     C                     Z-ADD*ZERO     YL0035  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0036  92
      * Define local work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YL0037  92
      * Define local work field Order Quantity
     C                     Z-ADD*ZERO     YL0038 112
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field First time flag 2     USR
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field Live with TPM
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0043  1
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0044  2
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Flat Amount
     C                     Z-ADD*ZERO     YL0046 112
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0047  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0048  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0049  30
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0050  2
      * Define local work field Unused Mile Rate 1
     C                     Z-ADD*ZERO     YL0051 114
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field Max Schd Shp Wt Edit Flg
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Order Weight Assigned
     C                     Z-ADD*ZERO     YL0054 112
      * Define local work field Status Flag 4  Y/N
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field Scheduled Ship Dt Assgnd
     C                     Z-ADD*ZERO     YL0056  70
      * Define local work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     YL0057  70
      * Define local work field Warehouse Code Assigned
     C                     MOVEL*BLANK    YL0058  3
      * Define local work field Warehouse Type Assigned
     C                     MOVEL*BLANK    YL0059  2
      * Define local work field Slot Type f/New Ords USR
     C                     MOVEL*BLANK    YL0060  2
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0061 112
      * Define local work field First Order Assigned
     C                     MOVEL*BLANK    YL0062  1
      * Define local work field LSSA Load Slot Type
     C                     MOVEL*BLANK    YL0063  2
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0009  2
      * Define local work field Boxes Day 1 Quantity
     C                     Z-ADD*ZERO     YL0064 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0065  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0066  50
      * Define local work field Slot Type f/load USR
     C                     MOVEL*BLANK    YL0067  2
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0068  30
      * Define null work field Allow Multi-Company
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0011 10
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0012  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0069  30
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0070  50
      * Define local work field Load Create Sts USR
     C                     MOVEL*BLANK    YL0071  1
      * Define local work field Load U/M
     C                     MOVEL*BLANK    YL0072  2
      * Define local work field Change Log Prior Val Usr1
     C                     MOVEL*BLANK    YL0073 12
      * Define local work field Change Log New Vl Usr 1
     C                     MOVEL*BLANK    YL0074 12
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0075  70
      * Define local work field Quantity Scheduled
     C                     Z-ADD*ZERO     YL0076 112
      * Define local work field Weight Scheduled
     C                     Z-ADD*ZERO     YL0077 112
      * Define local work field Change Log Prior Value
     C                     MOVEL*BLANK    YL0078 12
      * Define local work field Change Log New Value
     C                     MOVEL*BLANK    YL0079 12
      * Define local work field USR Temperature 3.1
     C                     Z-ADD*ZERO     YL0080  31
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0013  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0081  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0082  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0083  50
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0084  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0085  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0014 10
      * Define local work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YL0086  1
      * Define local work field Plant Floor System USR
     C                     MOVEL*BLANK    YL0087  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0088  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0089  1
      * Define local work field Default Load Sequence
     C                     MOVEL*BLANK    YL0090  1
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0091132
      * Define local work field Date (Alpha) USR
     C                     MOVEL*BLANK    YL0092  7
      * Define local work field Date Component Alpha  USR
     C                     MOVEL*BLANK    YL0093  2
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0094 40
      * Define local work field Subject Line USR
     C                     MOVEL*BLANK    YL0095100
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0096  7
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0097  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0098  60
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0099  70
      * Define local work field Stop/Drop
     C                     Z-ADD*ZERO     YL0100  50
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0101  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0102  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD03        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ******** Note - there ARE 50 files being used in this pgm ****
      * Change Log
     C                     EXSR UNSUBR                     Change Log
     C                     Z-ADD9999999   W0SLM            *Scan limit
      *
     C                     MOVEL*BLANK    WN2114 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN2114           User Profile Na
      *
     C                     MOVEL*BLANK    WN2115 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN2114    WL0029    P      User Profile Na
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    P4I6ST    P      Allow Multi-Com
     C                     MOVELWL0031    P4MPNA    P      Default Printer
     C                     MOVELWL0032    P4BCCD    P      Salesperson Cod
     C                     Z-ADDWL0033    YL0101           Company Number
     C                     MOVELWL0034    WN2115    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN2114    ZA0098           User Profile Na
     C                     MOVEL'OMS'     ZA0099           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN2115    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN2114    WL0035    P      User Profile Na
     C                     MOVEL'OMS'     WL0036    P      Application Cod
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    WUAIC3           Company Number
     C                     MOVELWL0038    YL0102    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN2115    WL0035    P      User Profile Na
     C                     MOVEL'OMS'     WL0036    P      Application Cod
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    WUAIC3           Company Number
     C                     MOVELWL0038    YL0102    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0102    P4AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN2114    ZA0100           User Profile Na
     C                     MOVEL'OMS'     ZA0101           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0101    IFNE 0                          *IF
     C                     Z-ADDYL0101    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0102    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P4AJCD    PARM *BLANK    WQ0378  3        Warehouse Code
     C                     PARM YL0101    WQ0379  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR PMRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * RTV Load No. Status    RT - Company Control  * 
     C                     EXSR PORVGN
      * Set to add mode if load id passed equal zero
      * CASE: PAR.Load ID is Blank
     C           P1RMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'A'       WUQSST           Display File Ad
      * If auto = Y, retrieve next load #
      * CASE: PAR.Auto Load Numbering? is Yes
     C           P3PNST    IFEQ 'Y'                        *IF
      * RTV Next Load No.      CH - Company Control  * 
     C                     EXSR PPCHRC
     C                     END                             *FI
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WUQSST           Display File Ad
     C                     Z-ADD*ZERO     WURUNB           Stop/Drop Seque
      * Rtv Stop/Drop Seq.    RT - OM Load Detail  * 
     C                     EXSR PQRVGN
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     END                             *FI
      * If auto number is yes or in change mode, make Load ID display onl
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Auto Load Numbering? is Yes
      *   |- c2    : WRK.Display File Add/Change is Change
      *   '-
     C           P3PNST    IFEQ 'Y'                        *IF
     C           WUQSST    OREQ 'C'                        *OR
     C                     MOVEL'N'       WUQKST           Display Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUQKST           Display Flag
     C                     END                             *FI
     C                     MOVEL'N'       YL0071           Load Create Sts
      * PK0302
      * Get Company Value to determine if the Max Sched Ship Wt edit is d
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0122           Company Number
     C                     MOVEL@CN,013   WL0123    P      Company Value C
     C                     EXSR OORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0124    YL0053    P      System Value Al
     C                     MOVEL'N'       P3QKST           Display Flag
     C                     MOVEL*BLANK    YL0055           Status Flag 4
     C                     MOVEL'Y'       YL0062           First Order Ass
     C                     MOVEL'N'       WUQ3ST           Status Flag 3
      * SFL Fold/Drop  RPG    US - /UT User Source  * 
     C                     Z-ADD06        ##SFPG
     C                     MOVEL'Y'       YL0040           First time flag
      * 11/04/09 PKD E00519 Warehouse and Item Access by User
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
     C                     EXSR PRRVGN
      * The Accusort sts will be Y if live with DOmestic only
      * EXC Rtv Status        XF - PFS Interface  * 
     C                     CALL 'PBXNXFR'              90  EXC Rtv Status
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0380  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0381  6        PFS Interface C
     C           YL0042    PARM *BLANK    WQ0382  1        PFS Carlisle Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * EXC Rtv Status-AS     XF - PFS Interface  * 
     C                     CALL 'PBX2XFR'              90  EXC Rtv Status-
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0383  30       PFS Company Num
     C                     PARM 'TMSLDP'  WQ0384  6        PFS Interface C
     C           YL0043    PARM *BLANK    WQ0385  1        PFS AccuSort Ac
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBX2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
00770010380106201092010940129401300
01348015500155601604018060181201830
01860020620208602116023180234202372
02574025980262802879028880307403844
03848038560386003863038680387603882
03889038970390903913040980410004104
04112041160411904124041320413804145
04153041650416904356043650438104387
04389043970439904402
** W0END
00794010400106801092011030129601329
01354015520158501610018100181201836
01871020620209302127023220234802373
02576025990263902886028950315103846
03854038580386003866038730388003886
03895039070391003917040980410204110
04114041160412204129041360414204151
04163041660417304358043790438404387
04395043970440004431
** W0NAM
#CHLTX    V2AIC3    #2RMNB    #PPKST    #CHKNA    #CR6CD    #CGVTX
#CVTNB    #CXCCD    #CADTX    #CDTWG    #CPCNX    #2FRSX    #CTECD
#CVUNB    #CWNST    VCHODT    #2R1NB    #CT4NB    #CTLMI    #CCUST
#CVPCD    #CV9CD    #PFLAM    VCNVDT    #CBUTM    #2ST1     #CTENB
V2C4NB    #CCPCD    #2PJST    #CV1CD    V2AODT    #CMDDI    #2AFTM
V2BKC7    #CMPT1    #2DBCD    #CYGNX    #1SEL     #RTENB    V1C4NB
#RAJCD    #1PJST    #RV1CD    V1AODT    #RMDDI    #1AFTM    V1BKC7
#1HNNA    #1DBCD    #RYGNX    V1AIC3    #1BCNA    #RLSNA    #1GWST
#1RNNB    #1FRSX    #1Q2CD    #1BRTX
** @CN
00001 Y2U0005
00002 Picked
00003 USR0752
00004 PDIZPCLP
00005 Auto Print Prelim. Pick
00006 PDSNPFR
00007 PLTFLRSYS
00008 LOADADDONS
00009 Same Day Load Add-Ons
00010 Notification Alert
00011 DFTCARRIER
00012 Y2U0003
00013 MAXFLAG
