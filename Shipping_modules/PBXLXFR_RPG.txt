     H/TITLE UPD Auto Accruals 855  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSZURN
     H* Date          : 07/07/16  Time  : 13:09:27
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPBCZCPL1IF  E           K        DISK
      * RTV : Order Detail Accrual 855  Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBFCPLWIF  E           K        DISK
      * RTV : Order Header TRG          Orders not Cancelled
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FOMHLREL5IF  E           K        DISK
      * RTV : Accrual Program           ACde Product Programs
      *
     FPBAMREL1IF  E           K        DISK
      * RTV : Accrual Program EXT       Retrieval index
      *
     FPMD2REL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm          Retrieval index
      *
     FPMD3REL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm Item     Retrieval index
      *
     FPNFJREL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm Cust     Retrieval index
      *
     FOMCRWKL1IF  E           K        DISK
      * RTV : Order Detail Fin          Retrieval index
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FOMHOREL7IF  E           K        DISK
      * RSQ : Customer Accrual          ShipTo/CommSts/AccrlCd/S
      *
     FOMHLREL3IF  E           K        DISK
      * RTV : Accrual Program           Active Records Only
      *
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker                    Retrieval index
      *
     FOMHRCPLEIF  E           K        DISK
      * RSQ : Shipping Dtl Accrual      Co/Ord/ACde/ATyp
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FOMHPREL1IF  E           K        DISK
      * RTV : Customer Accrual Item     Retrieval index
      *
     FPOC8REL1IF  E           K        DISK
      * RTV : Customer Accrual Str      Retrieval index
      *
     FOMHRCPL1IF  E           K        DISK
      * RTV : Shipping Dtl Accrual      Retrieval index
      *
     FOMHQCPL1IF  E           K        DISK
      * RTV : Order Detail Accrual      Retrieval index
      *
     FPBCZCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Accrual 855  Update index
      *
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@CZCPYF
      * Order Detail Accrual 855  Retrieval index
      * Renamed input format fields
     I              CZAIC3                          WAAIC3
     I              CZC4NB                          WAC4NB
     I              CZDPNB                          WADPNB
     I              CZUENB                          WAUENB
     I              CZDXNB                          WADXNB
     I              CZBKPR                          WABKPR
     I              CZC5PC                          WAC5PC
     I              CZAYVA                          WAAYVA
     I              CZHGCD                          WAHGCD
     I              CZBKC7                          WABKC7
     I              CZDUC7                          WADUC7
     I              CZAODT                          WAAODT
     I              CZD0WG                          WAD0WG
     I              CZAVQT                          WAAVQT
     I              CZOKCD                          WAOKCD
     I              CZTQST                          WATQST
     I              CZFGTX                          WAFGTX
     I              CZQRDT                          WAQRDT
     I              CZQSDT                          WAQSDT
     I              CZHBVL                          WAHBVL
     I              CZHCVL                          WAHCVL
     I              CZSHSX                          WASHSX
     I              CZOJCD                          WAOJCD
     I              CZHPAA                          WAHPAA
     I              CZBCNA                          WABCNA
     I              CZP4AA                          WAP4AA
     I              CZP5AA                          WAP5AA
     I              CZUNU2                          WAUNU2
     I              CZUNU3                          WAUNU3
     I              CZVSST                          WAVSST
     I              CZMJDT                          WAMJDT
     I              CZBETM                          WABETM
     I              CZCCVN                          WACCVN
     I              CZCDVN                          WACDVN
     I              CZMKDT                          WAMKDT
     I              CZBFTM                          WABFTM
     I              CZCEVN                          WACEVN
     I              CZCFVN                          WACFVN
      *
     I@CZCPYE
      * Order Detail Accrual 855  Update index
      * Renamed input format fields
     I              CZAIC3                          WBAIC3
     I              CZC4NB                          WBC4NB
     I              CZDPNB                          WBDPNB
     I              CZUENB                          WBUENB
     I              CZDXNB                          WBDXNB
     I              CZBKPR                          WBBKPR
     I              CZC5PC                          WBC5PC
     I              CZAYVA                          WBAYVA
     I              CZHGCD                          WBHGCD
     I              CZBKC7                          WBBKC7
     I              CZDUC7                          WBDUC7
     I              CZAODT                          WBAODT
     I              CZD0WG                          WBD0WG
     I              CZAVQT                          WBAVQT
     I              CZOKCD                          WBOKCD
     I              CZTQST                          WBTQST
     I              CZFGTX                          WBFGTX
     I              CZQRDT                          WBQRDT
     I              CZQSDT                          WBQSDT
     I              CZHBVL                          WBHBVL
     I              CZHCVL                          WBHCVL
     I              CZSHSX                          WBSHSX
     I              CZOJCD                          WBOJCD
     I              CZHPAA                          WBHPAA
     I              CZBCNA                          WBBCNA
     I              CZP4AA                          WBP4AA
     I              CZP5AA                          WBP5AA
     I              CZUNU2                          WBUNU2
     I              CZUNU3                          WBUNU3
     I              CZVSST                          WBVSST
     I              CZMJDT                          WBMJDT
     I              CZBETM                          WBBETM
     I              CZCCVN                          WBCCVN
     I              CZCDVN                          WBCDVN
     I              CZMKDT                          WBMKDT
     I              CZBFTM                          WBBFTM
     I              CZCEVN                          WBCEVN
     I              CZCFVN                          WBCFVN
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WEAJCD
     I              ADF8NA                          WEF8NA
     I              ADACNA                          WEACNA
     I              ADADNA                          WEADNA
     I              ADAENA                          WEAENA
     I              ADAJNA                          WEAJNA
     I              ADBTTX                          WEBTTX
     I              ADAOCD                          WEAOCD
     I              ADBGCD                          WEBGCD
     I              ADVHST                          WEVHST
     I              ADMPNA                          WEMPNA
     I              ADWPST                          WEWPST
     I              ADXUST                          WEXUST
     I              ADT0ST                          WET0ST
     I              ADT1ST                          WET1ST
     I              ADDBNB                          WEDBNB
     I              ADT2ST                          WET2ST
     I              ADT3ST                          WET3ST
     I              ADT4ST                          WET4ST
     I              ADT6ST                          WET6ST
     I              ADBWC3                          WEBWC3
     I              ADBTC3                          WEBTC3
     I              ADBUC3                          WEBUC3
     I              ADBVC3                          WEBVC3
     I              ADFCAA                          WEFCAA
     I              ADRQSX                          WERQSX
     I              ADRRSX                          WERRSX
     I              ADRSSX                          WERSSX
     I              ADRTSX                          WERTSX
     I              ADT7ST                          WET7ST
     I              ADT8ST                          WET8ST
     I              ADRNSX                          WERNSX
     I              ADROSX                          WEROSX
     I              ADRPSX                          WERPSX
     I              ADUVST                          WEUVST
     I              ADUWST                          WEUWST
     I              ADUXST                          WEUXST
     I              ADVSST                          WEVSST
     I              ADAATM                          WEAATM
     I              ADAYNA                          WEAYNA
     I              ADA0NA                          WEA0NA
     I              ADAXDT                          WEAXDT
      *
     I@BFCPZ9
      * Order Header TRG          Orders not Cancelled
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WGBKC7
     I              NEUFTX                          WGUFTX
     I              NEUGTX                          WGUGTX
     I              NEPFNA                          WGPFNA
     I              NEJ5NX                          WGJ5NX
     I              NEU5TX                          WGU5TX
     I              NEU6TX                          WGU6TX
     I              NEW0TX                          WGW0TX
     I              NEHSSX                          WGHSSX
     I              NEHUSX                          WGHUSX
     I              NEHVSX                          WGHVSX
     I              NEAAC8                          WGAAC8
     I              NEP0SX                          WGP0SX
     I              NEP1SX                          WGP1SX
     I              NEP2SX                          WGP2SX
     I              NEP3SX                          WGP3SX
     I              NEP4SX                          WGP4SX
     I              NEP5SX                          WGP5SX
     I              NEP6SX                          WGP6SX
     I              NEUVST                          WGUVST
     I              NEUWST                          WGUWST
     I              NEUXST                          WGUXST
     I              NEVSST                          WGVSST
     I              NEAATM                          WGAATM
     I              NEAYNA                          WGAYNA
     I              NEA0NA                          WGA0NA
     I              NEAXDT                          WGAXDT
      *
     I@HLRET0
      * Accrual Program           ACde Product Programs
      * Renamed input format fields
     I              HLOJCD                          WHOJCD
     I              HLLENA                          WHLENA
     I              HLTOST                          WHTOST
     I              HLTQST                          WHTQST
     I              HLTRST                          WHTRST
     I              HLTSST                          WHTSST
     I              HLOKCD                          WHOKCD
     I              HLTYST                          WHTYST
     I              HLOQCD                          WHOQCD
     I              HLHHCD                          WHHHCD
     I              HLI2TX                          WHI2TX
     I              HLJFTX                          WHJFTX
     I              HLI3TX                          WHI3TX
     I              HLJGTX                          WHJGTX
     I              HLLEDG                          WHLEDG
     I              HLTTST                          WHTTST
     I              HLBKPR                          WHBKPR
     I              HLSHSX                          WHSHSX
     I              HLQFSX                          WHQFSX
     I              HLFDTX                          WHFDTX
     I              HLFETX                          WHFETX
     I              HLFFTX                          WHFFTX
     I              HLFGTX                          WHFGTX
     I              HLHQVL                          WHHQVL
     I              HLFHTX                          WHFHTX
     I              HLUVST                          WHUVST
     I              HLUWST                          WHUWST
     I              HLUXST                          WHUXST
     I              HLVSST                          WHVSST
     I              HLAATM                          WHAATM
     I              HLAYNA                          WHAYNA
     I              HLA0NA                          WHA0NA
     I              HLAXDT                          WHAXDT
      *
     I@AMREN7
      * Accrual Program EXT       Retrieval index
      * Renamed input format fields
     I              AMOJCD                          WIOJCD
     I              AMPNAA                          WIPNAA
     I              AMPAST                          WIPAST
     I              AMVSST                          WIVSST
     I              AMMJDT                          WIMJDT
     I              AMBETM                          WIBETM
     I              AMCCVN                          WICCVN
     I              AMCDVN                          WICDVN
     I              AMMKDT                          WIMKDT
     I              AMBFTM                          WIBFTM
     I              AMCEVN                          WICEVN
     I              AMCFVN                          WICFVN
      *
     I@D2RET9
      * Accrual Prod Pgm          Retrieval index
      * Renamed input format fields
     I              D2OJCD                          WJOJCD
     I              D2MSNY                          WJMSNY
     I              D2SCDT                          WJSCDT
     I              D2SDDT                          WJSDDT
     I              D2O9TX                          WJO9TX
     I              D2EWST                          WJEWST
     I              D2VSST                          WJVSST
     I              D2MJDT                          WJMJDT
     I              D2BETM                          WJBETM
     I              D2CCVN                          WJCCVN
     I              D2CDVN                          WJCDVN
     I              D2MKDT                          WJMKDT
     I              D2BFTM                          WJBFTM
     I              D2CEVN                          WJCEVN
     I              D2CFVN                          WJCFVN
      *
     I@D3REUC
      * Accrual Prod Pgm Item     Retrieval index
      * Renamed input format fields
     I              D3OJCD                          WKOJCD
     I              D3MSNY                          WKMSNY
     I              D3HGCD                          WKHGCD
     I              D3SHSX                          WKSHSX
     I              D3BKPR                          WKBKPR
     I              D3VSST                          WKVSST
     I              D3MJDT                          WKMJDT
     I              D3BETM                          WKBETM
     I              D3CCVN                          WKCCVN
     I              D3CDVN                          WKCDVN
     I              D3MKDT                          WKMKDT
     I              D3BFTM                          WKBFTM
     I              D3CEVN                          WKCEVN
     I              D3CFVN                          WKCFVN
      *
     I@FJREBY
      * Accrual Prod Pgm Cust     Retrieval index
      * Renamed input format fields
     I              FJOJCD                          WLOJCD
     I              FJMSNY                          WLMSNY
     I              FJBKC7                          WLBKC7
     I              FJVSST                          WLVSST
     I              FJMJDT                          WLMJDT
     I              FJBETM                          WLBETM
     I              FJCCVN                          WLCCVN
     I              FJCDVN                          WLCDVN
     I              FJMKDT                          WLMKDT
     I              FJBFTM                          WLBFTM
     I              FJCEVN                          WLCEVN
     I              FJCFVN                          WLCFVN
      *
     I@CRWKL1
      * Order Detail Fin          Retrieval index
      * Renamed input format fields
     I              N1AIC3                          WMAIC3
     I              N1C4NB                          WMC4NB
     I              N1DPNB                          WMDPNB
     I              N1UENB                          WMUENB
     I              N1DXNB                          WMDXNB
     I              N1G4ST                          WMG4ST
     I              N1BSVA                          WMBSVA
     I              N1G5NA                          WMG5NA
     I              N1DQCD                          WMDQCD
     I              N1DRCD                          WMDRCD
     I              N1AVNB                          WMAVNB
     I              N1DSCD                          WMDSCD
     I              N1GFST                          WMGFST
     I              N1SANB                          WMSANB
     I              N1OJCD                          WMOJCD
     I              N1UVCD                          WMUVCD
     I              N1CKNB                          WMCKNB
     I              N1BMST                          WMBMST
     I              N1UVST                          WMUVST
     I              N1UWST                          WMUWST
     I              N1UXST                          WMUXST
     I              N1AATM                          WMAATM
     I              N1AYNA                          WMAYNA
     I              N1A0NA                          WMA0NA
     I              N1AXDT                          WMAXDT
      *
     I@HLREK4
      * Accrual Program           Retrieval index
      * Renamed input format fields
     I              HLOJCD                          WOOJCD
     I              HLLENA                          WOLENA
     I              HLTOST                          WOTOST
     I              HLTQST                          WOTQST
     I              HLTRST                          WOTRST
     I              HLTSST                          WOTSST
     I              HLOKCD                          WOOKCD
     I              HLTYST                          WOTYST
     I              HLOQCD                          WOOQCD
     I              HLHHCD                          WOHHCD
     I              HLI2TX                          WOI2TX
     I              HLJFTX                          WOJFTX
     I              HLI3TX                          WOI3TX
     I              HLJGTX                          WOJGTX
     I              HLLEDG                          WOLEDG
     I              HLTTST                          WOTTST
     I              HLBKPR                          WOBKPR
     I              HLSHSX                          WOSHSX
     I              HLQFSX                          WOQFSX
     I              HLFDTX                          WOFDTX
     I              HLFETX                          WOFETX
     I              HLFFTX                          WOFFTX
     I              HLFGTX                          WOFGTX
     I              HLHQVL                          WOHQVL
     I              HLFHTX                          WOFHTX
     I              HLUVST                          WOUVST
     I              HLUWST                          WOUWST
     I              HLUXST                          WOUXST
     I              HLVSST                          WOVSST
     I              HLAATM                          WOAATM
     I              HLAYNA                          WOAYNA
     I              HLA0NA                          WOA0NA
     I              HLAXDT                          WOAXDT
      *
     I@HOREKH
      * Customer Accrual          ShipTo/CommSts/AccrlCd/S
      * Renamed input format fields
     I              HOBKC7                          WRBKC7
     I              HOOJCD                          WROJCD
     I              HOGUNY                          WRGUNY
     I              HOBFDT                          WRBFDT
     I              HOA2DT                          WRA2DT
     I              HOBKPR                          WRBKPR
     I              HOTTST                          WRTTST
     I              HOSHSX                          WRSHSX
     I              HOQDSX                          WRQDSX
     I              HOPJDT                          WRPJDT
     I              HOPKDT                          WRPKDT
     I              HOECVL                          WRECVL
     I              HOQESX                          WRQESX
     I              HOQFSX                          WRQFSX
     I              HOHHAA                          WRHHAA
     I              HOHQVL                          WRHQVL
     I              HOQGSX                          WRQGSX
     I              HOQHSX                          WRQHSX
     I              HOQISX                          WRQISX
     I              HOQJSX                          WRQJSX
     I              HOUVST                          WRUVST
     I              HOUWST                          WRUWST
     I              HOUXST                          WRUXST
     I              HOAATM                          WRAATM
     I              HOAYNA                          WRAYNA
     I              HOA0NA                          WRA0NA
     I              HOAXDT                          WRAXDT
      *
     I@HLREU8
      * Accrual Program           Active Records Only
      * Renamed input format fields
     I              HLOJCD                          WSOJCD
     I              HLLENA                          WSLENA
     I              HLTOST                          WSTOST
     I              HLTQST                          WSTQST
     I              HLTRST                          WSTRST
     I              HLTSST                          WSTSST
     I              HLOKCD                          WSOKCD
     I              HLTYST                          WSTYST
     I              HLOQCD                          WSOQCD
     I              HLHHCD                          WSHHCD
     I              HLI2TX                          WSI2TX
     I              HLJFTX                          WSJFTX
     I              HLI3TX                          WSI3TX
     I              HLJGTX                          WSJGTX
     I              HLLEDG                          WSLEDG
     I              HLTTST                          WSTTST
     I              HLBKPR                          WSBKPR
     I              HLSHSX                          WSSHSX
     I              HLQFSX                          WSQFSX
     I              HLFDTX                          WSFDTX
     I              HLFETX                          WSFETX
     I              HLFFTX                          WSFFTX
     I              HLFGTX                          WSFGTX
     I              HLHQVL                          WSHQVL
     I              HLFHTX                          WSFHTX
     I              HLUVST                          WSUVST
     I              HLUWST                          WSUWST
     I              HLUXST                          WSUXST
     I              HLVSST                          WSVSST
     I              HLAATM                          WSAATM
     I              HLAYNA                          WSAYNA
     I              HLA0NA                          WSA0NA
     I              HLAXDT                          WSAXDT
      *
     I@C5RESJ
      * Broker                    Retrieval index
      * Renamed input format fields
     I              C5HHAA                          WTHHAA
     I              C5C4T1                          WTC4T1
     I              C5QMNA                          WTQMNA
     I              C5QNNA                          WTQNNA
     I              C5QONA                          WTQONA
     I              C5QPNA                          WTQPNA
     I              C5C5T1                          WTC5T1
     I              C5C6T1                          WTC6T1
     I              C5C7T1                          WTC7T1
     I              C5C8T1                          WTC8T1
     I              C5C9T1                          WTC9T1
     I              C5DAT1                          WTDAT1
     I              C5DBT1                          WTDBT1
     I              C5DCT1                          WTDCT1
     I              C5DDT1                          WTDDT1
     I              C5PWSX                          WTPWSX
     I              C5PXSX                          WTPXSX
     I              C5PYSX                          WTPYSX
     I              C5PZSX                          WTPZSX
     I              C5BCCD                          WTBCCD
     I              C5UVST                          WTUVST
     I              C5UWST                          WTUWST
     I              C5UXST                          WTUXST
     I              C5VSST                          WTVSST
     I              C5AATM                          WTAATM
     I              C5AYNA                          WTAYNA
     I              C5A0NA                          WTA0NA
     I              C5AXDT                          WTAXDT
      *
     I@HRCPC9
      * Shipping Dtl Accrual      Co/Ord/ACde/ATyp
      * Renamed input format fields
     I              HRAIC3                          WVAIC3
     I              HRC4NB                          WVC4NB
     I              HRDPNB                          WVDPNB
     I              HRUENB                          WVUENB
     I              HRDXNB                          WVDXNB
     I              HRBKPR                          WVBKPR
     I              HRC5PC                          WVC5PC
     I              HRAYVA                          WVAYVA
     I              HREDVL                          WVEDVL
     I              HRHGCD                          WVHGCD
     I              HRBKC7                          WVBKC7
     I              HRDUC7                          WVDUC7
     I              HRHHAA                          WVHHAA
     I              HRPODT                          WVPODT
     I              HRBYWG                          WVBYWG
     I              HRBVST                          WVBVST
     I              HRP7SX                          WVP7SX
     I              HROKCD                          WVOKCD
     I              HRP8SX                          WVP8SX
     I              HRP9SX                          WVP9SX
     I              HRQASX                          WVQASX
     I              HRQBSX                          WVQBSX
     I              HRPPDT                          WVPPDT
     I              HRPQDT                          WVPQDT
     I              HREEVL                          WVEEVL
     I              HREFVL                          WVEFVL
     I              HRFITX                          WVFITX
     I              HRFJTX                          WVFJTX
     I              HRQ8DT                          WVQ8DT
     I              HRFKTX                          WVFKTX
     I              HRH0NY                          WVH0NY
     I              HRKQT1                          WVKQT1
     I              HRKTT1                          WVKTT1
     I              HRHIAA                          WVHIAA
     I              HRHLAA                          WVHLAA
     I              HROJCD                          WVOJCD
     I              HRAVNB                          WVAVNB
     I              HRDSCD                          WVDSCD
     I              HRUVST                          WVUVST
     I              HRUWST                          WVUWST
     I              HRUXST                          WVUXST
     I              HRAATM                          WVAATM
     I              HRAYNA                          WVAYNA
     I              HRA0NA                          WVA0NA
     I              HRAXDT                          WVAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WWAIC3
     I              BEC4NB                          WWC4NB
     I              BEJNCD                          WWJNCD
     I              BEANC7                          WWANC7
     I              BEBKC7                          WWBKC7
     I              BEBRTX                          WWBRTX
     I              BEHMNA                          WWHMNA
     I              BEHONA                          WWHONA
     I              BEHPNA                          WWHPNA
     I              BEHNNA                          WWHNNA
     I              BEDBCD                          WWDBCD
     I              BECKTX                          WWCKTX
     I              BEB0C7                          WWB0C7
     I              BEAETX                          WWAETX
     I              BEB1NA                          WWB1NA
     I              BEB3NA                          WWB3NA
     I              BEB4NA                          WWB4NA
     I              BEB2NA                          WWB2NA
     I              BEBHCD                          WWBHCD
     I              BEC8TX                          WWC8TX
     I              BEBCNA                          WWBCNA
     I              BEA0DT                          WWA0DT
     I              BEA5DT                          WWA5DT
     I              BEGNDT                          WWGNDT
     I              BEACDT                          WWACDT
     I              BEAQCD                          WWAQCD
     I              BEB6NA                          WWB6NA
     I              BEBYNA                          WWBYNA
     I              BEBZNA                          WWBZNA
     I              BEGTST                          WWGTST
     I              BEGVST                          WWGVST
     I              BEGUST                          WWGUST
     I              BEQFST                          WWQFST
     I              BECQCD                          WWCQCD
     I              BEGJST                          WWGJST
     I              BEGWST                          WWGWST
     I              BEGXST                          WWGXST
     I              BEGYST                          WWGYST
     I              BEAODT                          WWAODT
     I              BEAIVN                          WWAIVN
     I              BECXDT                          WWCXDT
     I              BEJZVA                          WWJZVA
     I              BEA1WG                          WWA1WG
     I              BEXIST                          WWXIST
     I              BEXJST                          WWXJST
     I              BEXKST                          WWXKST
     I              BEEIDT                          WWEIDT
     I              BEAFTM                          WWAFTM
     I              BEE8CD                          WWE8CD
     I              BEE9CD                          WWE9CD
     I              BERMNB                          WWRMNB
     I              BETBNB                          WWTBNB
     I              BER1NB                          WWR1NB
     I              BEPJST                          WWPJST
     I              BEU0ST                          WWU0ST
     I              BEU1ST                          WWU1ST
     I              BEQ2CD                          WWQ2CD
     I              BEU2ST                          WWU2ST
     I              BEVEST                          WWVEST
     I              BEVFST                          WWVFST
     I              BEVGST                          WWVGST
     I              BERPCD                          WWRPCD
     I              BERNNB                          WWRNNB
     I              BEVDST                          WWVDST
     I              BEATIN                          WWATIN
     I              BEU4ST                          WWU4ST
     I              BEU5ST                          WWU5ST
     I              BERSRN                          WWRSRN
     I              BEMHNA                          WWMHNA
     I              BEMINA                          WWMINA
     I              BEWBST                          WWWBST
     I              BER4CD                          WWR4CD
     I              BEBFCD                          WWBFCD
     I              BEQ4CD                          WWQ4CD
     I              BET3NB                          WWT3NB
     I              BESICD                          WWSICD
     I              BECONB                          WWCONB
     I              BECEST                          WWCEST
     I              BEAWDT                          WWAWDT
     I              BEJPCD                          WWJPCD
     I              BEXUST                          WWXUST
     I              BEZ1ST                          WWZ1ST
     I              BEVRVA                          WWVRVA
     I              BEOBST                          WWOBST
     I              BEBCST                          WWBCST
     I              BEBDST                          WWBDST
     I              BEB7VL                          WWB7VL
     I              BEGASX                          WWGASX
     I              BEGBSX                          WWGBSX
     I              BEGCSX                          WWGCSX
     I              BEGDSX                          WWGDSX
     I              BEFNSX                          WWFNSX
     I              BEFOSX                          WWFOSX
     I              BEFPSX                          WWFPSX
     I              BEFQSX                          WWFQSX
     I              BEFRSX                          WWFRSX
     I              BEFSSX                          WWFSSX
     I              BEFTSX                          WWFTSX
     I              BEFUSX                          WWFUSX
     I              BEFVSX                          WWFVSX
     I              BEFWSX                          WWFWSX
     I              BEFXSX                          WWFXSX
     I              BEFYSX                          WWFYSX
     I              BENODT                          WWNODT
     I              BENPDT                          WWNPDT
     I              BENQDT                          WWNQDT
     I              BENRDT                          WWNRDT
     I              BENSDT                          WWNSDT
     I              BEBPTM                          WWBPTM
     I              BEBQTM                          WWBQTM
     I              BEBRTM                          WWBRTM
     I              BEBSTM                          WWBSTM
     I              BEBTTM                          WWBTTM
     I              BEH0NX                          WWH0NX
     I              BEH1NX                          WWH1NX
     I              BEH2NX                          WWH2NX
     I              BEH3NX                          WWH3NX
     I              BEH4NX                          WWH4NX
     I              BEC0C7                          WWC0C7
     I              BEUVST                          WWUVST
     I              BEUWST                          WWUWST
     I              BEUXST                          WWUXST
     I              BEAATM                          WWAATM
     I              BEAYNA                          WWAYNA
     I              BEA0NA                          WWA0NA
     I              BEAXDT                          WWAXDT
      *
     I@HPRELD
      * Customer Accrual Item     Retrieval index
      * Renamed input format fields
     I              HPBKC7                          WXBKC7
     I              HPOJCD                          WXOJCD
     I              HPGUNY                          WXGUNY
     I              HPHGCD                          WXHGCD
     I              HPBKPR                          WXBKPR
     I              HPSHSX                          WXSHSX
     I              HPUVST                          WXUVST
     I              HPUWST                          WXUWST
     I              HPUXST                          WXUXST
     I              HPAATM                          WXAATM
     I              HPAYNA                          WXAYNA
     I              HPA0NA                          WXA0NA
     I              HPAXDT                          WXAXDT
      *
     I@C8RES1
      * Customer Accrual Str      Retrieval index
      * Renamed input format fields
     I              C8BKC7                          WYBKC7
     I              C8OJCD                          WYOJCD
     I              C8GUNY                          WYGUNY
     I              C8RGNB                          WYRGNB
     I              C8RHNB                          WYRHNB
     I              C8RINB                          WYRINB
     I              C8BKPR                          WYBKPR
     I              C8SHSX                          WYSHSX
     I              C8QTSX                          WYQTSX
     I              C8QUSX                          WYQUSX
     I              C8FKPR                          WYFKPR
     I              C8FLPR                          WYFLPR
     I              C8UVST                          WYUVST
     I              C8UWST                          WYUWST
     I              C8UXST                          WYUXST
     I              C8VSST                          WYVSST
     I              C8AATM                          WYAATM
     I              C8AYNA                          WYAYNA
     I              C8A0NA                          WYA0NA
     I              C8AXDT                          WYAXDT
      *
     I@HRCPLM
      * Shipping Dtl Accrual      Retrieval index
      * Renamed input format fields
     I              HRAIC3                          TAAIC3
     I              HRC4NB                          TAC4NB
     I              HRDPNB                          TADPNB
     I              HRUENB                          TAUENB
     I              HRDXNB                          TADXNB
     I              HRBKPR                          TABKPR
     I              HRC5PC                          TAC5PC
     I              HRAYVA                          TAAYVA
     I              HREDVL                          TAEDVL
     I              HRHGCD                          TAHGCD
     I              HRBKC7                          TABKC7
     I              HRDUC7                          TADUC7
     I              HRHHAA                          TAHHAA
     I              HRPODT                          TAPODT
     I              HRBYWG                          TABYWG
     I              HRBVST                          TABVST
     I              HRP7SX                          TAP7SX
     I              HROKCD                          TAOKCD
     I              HRP8SX                          TAP8SX
     I              HRP9SX                          TAP9SX
     I              HRQASX                          TAQASX
     I              HRQBSX                          TAQBSX
     I              HRPPDT                          TAPPDT
     I              HRPQDT                          TAPQDT
     I              HREEVL                          TAEEVL
     I              HREFVL                          TAEFVL
     I              HRFITX                          TAFITX
     I              HRFJTX                          TAFJTX
     I              HRQ8DT                          TAQ8DT
     I              HRFKTX                          TAFKTX
     I              HRH0NY                          TAH0NY
     I              HRKQT1                          TAKQT1
     I              HRKTT1                          TAKTT1
     I              HRHIAA                          TAHIAA
     I              HRHLAA                          TAHLAA
     I              HROJCD                          TAOJCD
     I              HRAVNB                          TAAVNB
     I              HRDSCD                          TADSCD
     I              HRUVST                          TAUVST
     I              HRUWST                          TAUWST
     I              HRUXST                          TAUXST
     I              HRAATM                          TAAATM
     I              HRAYNA                          TAAYNA
     I              HRA0NA                          TAA0NA
     I              HRAXDT                          TAAXDT
      *
     I@HQCPLJ
      * Order Detail Accrual      Retrieval index
      * Renamed input format fields
     I              HQAIC3                          TBAIC3
     I              HQC4NB                          TBC4NB
     I              HQDPNB                          TBDPNB
     I              HQUENB                          TBUENB
     I              HQDXNB                          TBDXNB
     I              HQBKPR                          TBBKPR
     I              HQSHSX                          TBSHSX
     I              HQOKCD                          TBOKCD
     I              HQTINA                          TBTINA
     I              HQDSCD                          TBDSCD
     I              HQHAST                          TBHAST
     I              HQHBST                          TBHBST
     I              HQHCST                          TBHCST
     I              HQHDST                          TBHDST
     I              HQHEST                          TBHEST
     I              HQHFST                          TBHFST
     I              HQOJCD                          TBOJCD
     I              HQL8AA                          TBL8AA
     I              HQVSST                          TBVSST
     I              HQMJDT                          TBMJDT
     I              HQBETM                          TBBETM
     I              HQCCVN                          TBCCVN
     I              HQCDVN                          TBCDVN
     I              HQMKDT                          TBMKDT
     I              HQBFTM                          TBBFTM
     I              HQCEVN                          TBCEVN
     I              HQCFVN                          TBCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPBCZ1    E DSPBCZCPL0
      * UPD : Order Detail Accrual 855  Update index
      * Renamed input format fields
     I              CZAIC3                          WBAIC3
     I              CZC4NB                          WBC4NB
     I              CZDPNB                          WBDPNB
     I              CZUENB                          WBUENB
     I              CZDXNB                          WBDXNB
     I              CZBKPR                          WBBKPR
     I              CZC5PC                          WBC5PC
     I              CZAYVA                          WBAYVA
     I              CZHGCD                          WBHGCD
     I              CZBKC7                          WBBKC7
     I              CZDUC7                          WBDUC7
     I              CZAODT                          WBAODT
     I              CZD0WG                          WBD0WG
     I              CZAVQT                          WBAVQT
     I              CZOKCD                          WBOKCD
     I              CZTQST                          WBTQST
     I              CZFGTX                          WBFGTX
     I              CZQRDT                          WBQRDT
     I              CZQSDT                          WBQSDT
     I              CZHBVL                          WBHBVL
     I              CZHCVL                          WBHCVL
     I              CZSHSX                          WBSHSX
     I              CZOJCD                          WBOJCD
     I              CZHPAA                          WBHPAA
     I              CZBCNA                          WBBCNA
     I              CZP4AA                          WBP4AA
     I              CZP5AA                          WBP5AA
     I              CZUNU2                          WBUNU2
     I              CZUNU3                          WBUNU3
     I              CZVSST                          WBVSST
     I              CZMJDT                          WBMJDT
     I              CZBETM                          WBBETM
     I              CZCCVN                          WBCCVN
     I              CZCDVN                          WBCDVN
     I              CZMKDT                          WBMKDT
     I              CZBFTM                          WBBFTM
     I              CZCEVN                          WBCEVN
     I              CZCFVN                          WBCFVN
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
     IP2PARM      DS
      * FLD: Order Header TRG
      * I :  A/R Customer Number
     I                                    P   1   40P2ANC7
      * I :  Scheduled Ship Date
     I                                    P   5   80P2AODT
      * I :  Date of Original Entry
     I                                    P   9  120P2CXDT
      * I :  Load ID
     I                                    P  13  160P2RMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P  17  192P2TBNB
      * I :  Attach to Order Number
     I                                    P  20  230P2T3NB
      * I :  Invoice Date
     I                                    P  24  270P2AWDT
      * I :  Billing Activity Type
     I                                       28  28 P2OBST
     IP3PARM      DS
      * N :  Extended Amt Total
     I                                    P   1   62P3EJVL
     IP4PARM      DS
      * N :  Weight Total 13.2     USR
     I                                    P   1   72P4ETWG
     IP5PARM      DS
      * N :  Quantity Total S
     I                                    P   1   62P5BKQT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P2ANC7    PARM           WP0003  70       A/R Customer Nu
     C           P2AODT    PARM           WP0004  70       Scheduled Ship
     C           P2CXDT    PARM           WP0005  70       Date of Origina
     C           P2RMNB    PARM           WP0006  70       Load ID
     C           P2TBNB    PARM           WP0007  52       Absorbed Freigh
     C           P2T3NB    PARM           WP0008  70       Attach to Order
     C           P2AWDT    PARM           WP0009  70       Invoice Date
     C           P2OBST    PARM           WP0010  1        Billing Activit
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Auto Accruals 855  XF
      * *** PROGRAM DESCRIPTION ***
     C                     EXSR UASUBR                     *** PROGRAM DES
      * Modifications and Comments - FROM COPIED XF POST SHIPPING
     C                     EXSR UBSUBR                     Modifications a
      * 1.  DELETE ALL NEW FILE RECORDS BEFORE PROCESSING *****
      * Del Ord Dtl Acrl 855  RT - Order Detail Accrual 855  * 
     C                     EXSR SARVGN
      * 2.  RETRIEVE ORDER DETAIL AND HEADER INFORMATION NEEDED FOR PROCE
      * RTV Total Qty,Wgt Ext  RT - Order Detail  * 
     C                     EXSR SCRVGN
      * 06/26/14 PKD E3164 Added Exclude Collect Truck flag to the
      *              Accrual Program EXT.  Need to send in the Shipping M
      *              for selection criteria for the Accrual Program.
      * Rtv Shipping Method   RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * 3.  PROCESS EACH ORDER DETAIL LINE TO CALCULATE APPLICABLE ACCRUA
      * UPD Auto Accruals 855  RT - Order Detail  * 
     C                     EXSR SERVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Del Ord Dtl Acrl 855  RT - Order Detail Accrual 855  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1C4NB    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@CZCPYF                    *
     C           KRSSA     READE@CZCPYF                  90*
      * Data record not found
     C   90                MOVEL'USR4947' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Ord Dtl Acrl 855  DL - Order Detail Accrual 855  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@CZCPYF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Del Ord Dtl Acrl 855  DL - Order Detail Accrual 855  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CZCPYE
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
     C                     Z-ADDWADPNB    WBDPNB           Order Sequence
     C                     Z-ADDWAUENB    WBUENB           Order Secondary
     C                     Z-ADDWADXNB    WBDXNB           Sequence Number
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C                     KFLD           WBDXNB           Sequence Number
     C           KLDLSB    CHAIN@CZCPYE              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PBCZCPL0'MDACP
     C                     MOVEL'@CZCPYE' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CZCPYE                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Total Qty,Wgt Ext  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3EJVL           Extended Amount
     C                     Z-ADD*ZERO     P5BKQT           Quantity Shippe
     C                     Z-ADD*ZERO     P4ETWG           Weight Shipped
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     Z-ADDP1C4NB    WQSC02           Order Number
      * Establish starting position
     C           KRSSC     SETLL@BGWKL1                    *
     C           KRSSC     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'C'
     C           WCGMST    OREQ 'R'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCGMST    OREQ 'I'
     C                     ADD  WCCBQT    P5BKQT           Quantity Shippe
     C                     ADD  WCATWG    P4ETWG           Weight Shipped
     C                     ADD  WCAYVA    P3EJVL           Extended Amount
     C                     END                             *FI
     C           KRSSC     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Shipping Method   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADDP1C4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Shipping Method
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDQ2CD    YL0001           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * UPD Auto Accruals 855  RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Sequence Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E4057 JJH 04/27/15 - New input Parm: SDA Atch to Ord ActShpDt
     C                     Z-ADD0         WN0001           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
     C                     Z-ADDP1C4NB    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ***** MAINTENANCE LOG
     C                     EXSR UCSUBR                     ***** MAINTENAN
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * OMIT: Credit/Debit Memos
      * CASE: PAR.Billing Activity Type is Credit or Debit Memo
     C           P2OBST    IFEQ '2'                        *IF
     C           P2OBST    OREQ '3'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Process Selected Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: Quantity Ordered or Weight Ordered <> Zero
      *  - c1 OR c2
      *   |- c1    : DB1.Quantity Ordered is not equal zero
      *   |- c2    : DB1.Weight Ordered is Not equal zero
      *   '-
     C           WCAVQT    IFNE 0                          *IF
     C           WCD0WG    ORNE 0                          *OR
      * Rtv Acct&Ship Co      RT - Warehouse  * 
     C                     EXSR SFRVGN
      * RTV Purchase Order     RT - Order Header TRG  * 
     C                     EXSR SGRVGN
      * Rtv Bill To TP & DUNS RT - Customer EXT  * 
     C                     EXSR SHRVGN
      * *---------------------------------------------------------------*
      * ***** MAINTENANCE LOG: Product Program - FROM COPIED FUNCTION
     C                     EXSR UDSUBR                     ***** MAINTENAN
      * RTV Write Accrual 855 RT - Accrual Program  * 
     C                     EXSR SIRVGN
      * *---------------------------------------------------------------*
      * ***** MAINTENANCE LOG: Customer Accrual - FROM COPIED FUNCTION
     C                     EXSR UGSUBR                     ***** MAINTENAN
      * RTV Write Accrual 855 RT - Customer Accrual  * 
     C                     EXSR SQRVGN
      * *---------------------------------------------------------------*
      * ***** MAINTENANCE LOG: Order Detail Accrual - FROM COPIED FUNCTIO
     C                     EXSR UHSUBR                     ***** MAINTENAN
      * Logic only for Regular Sales Orders. CM/DMs are not allowed to
      * create Order Dtl Accrual.
      * RTV Write Accrual 855 RT - Order Detail Accrual  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Acct&Ship Co      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEAJCD           Warehouse Code
      * Setup key
     C                     MOVELWCAJCD    WEAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Accounting Comp
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBTC3    YL0002           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Purchase Order     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WFAIC3           Company Number
     C                     Z-ADDWCC4NB    WFC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@BFCPZ9              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFBCNA    YL0003           Customer Purcha
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Bill To TP & DUNS RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP2ANC7    WGBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           EDI Trading Par
     C                     MOVEL*BLANK    YL0005           EDI Cust Duns N
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGJ5NX    YL0004           EDI Trading Par
     C                     MOVELWGU5TX    YL0005           EDI Cust Duns N
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Write Accrual 855 RT - Accrual Program  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002 30        Accrual Descrip
     C                     MOVEL*BLANK    WN0003  1        Automatic Accru
     C                     MOVEL*BLANK    WN0004  1        Print On Invoic
     C                     MOVEL*BLANK    WN0005  1        Rate Usage
     C                     MOVEL*BLANK    WN0006  1        Add-on/Allowanc
     C                     MOVEL*BLANK    WN0007  2        Accrual Type
     C                     MOVEL*BLANK    WN0008  2        Sub Ledger Code
     C                     MOVEL*BLANK    WN0009  3        Reverse Accrual
     C                     MOVEL*BLANK    WN0010  2        U/M - Primary D
     C                     MOVEL*BLANK    WN0011  8        G/L Code Dr
     C                     MOVEL*BLANK    WN0012  8        G/L Code Cr
     C                     MOVEL*BLANK    WN0013  1        Post to G/L (Y/
     C                     MOVEL*BLANK    WN0014  2        Accrual Rate Ty
     C                     MOVEL*BLANK    WN0015  1        Affect Sales Re
     C                     MOVEL*BLANK    WN0016  1        Affect Invoice
     C                     MOVEL*BLANK    WN0017  2        Invoice Print T
     C                     Z-ADD*ZERO     WN0018 112       Item Accrual Am
     C                     MOVEL*BLANK    WN0019  1        Retro Comm Calc
     C                     MOVEL*BLANK    WN0020  1        SDA Affect Sale
     C                     MOVEL*BLANK    WN0021  1        SDA Affect Invo
     C                     MOVEL*BLANK    WN0022  1        SDA Print on In
     C                     MOVEL*BLANK    WN0023  2        SDA Invoice Pri
     C                     Z-ADD*ZERO     WN0024  70       SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WN0025 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0026 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0027  80       SDA G/L Sub Led
     C                     MOVEL*BLANK    WN0028  8        SDA G/L Code Dr
     C                     MOVEL*BLANK    WN0029  8        SDA G/L Code Cr
     C                     MOVEL*BLANK    WN0030  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0031  8        SDA JDE Account
     C                     Z-ADD*ZERO     WN0032  70       AD Period Begin
     C                     Z-ADD*ZERO     WN0033  70       AD Period Endin
     C                     Z-ADD*ZERO     WN0034  80       AD Sub Ledger
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@HLRET0                    *
     C                     READ @HLRET0                  90*
      * Data record not found
     C   90                MOVEL'USR1514' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *----------- MAINTENANCE LOG -----------* FROM COPIED FUNCTION
     C                     EXSR UESUBR                     *----------- MA
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * E4057 JJH 05/13/15 - Reset Extended Amount to Zero
     C                     Z-ADD0         WUAYVA           Extended Amount
      * E003964 Only process accruals printing on an Invoice.
      * OMIT:  Print on Invoice = No
      * CASE: DB1.Print On Invoice (Y/N) is Yes
     C           WHTQST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Rtv Accr Prog EXT     RT - Accrual Program EXT  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWHOJCD    WL0001    P      Accrual Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0002    P      G/L Account Cat
     C                     MOVELWL0003    YL0007    P      APE Excl Collec
     C                     MOVELWL0004    YN0003    P      Record Status
      * OMIT:  Shipping Method = Collect Rail or Truck
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.APE Excl Collect ShpMthd is Yes
      *   |- c2    : PAR.Shipping Method is Collect
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'Y'                        *IF
     C           YL0001    IFEQ 'CR'                       *IF
     C           YL0001    OREQ 'CT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Process Accrual Program
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: DB1.Automatic Accrual (Y/N) is Yes
     C           WHTOST    IFEQ 'Y'                        *IF
      * E4057 JJH 04/24/14 - Add I parm for: SDA Atch to Ord ActShpDt
      * RTV Write Accrual 855 RT - Accrual Prod Pgm  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @HLRET0                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Accr Prog EXT     RT - Accrual Program EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIOJCD           Accrual Code
      * Setup key
     C                     MOVELWL0001    WIOJCD           Accrual Code
      * Establish starting position
     C           KRSSJ     CHAIN@AMREN7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4529' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           G/L Account Cat
     C                     MOVEL*BLANK    WL0003           APE Excl Collec
     C                     MOVEL*BLANK    WL0004           Record Status
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIPNAA    WL0002           G/L Account Cat
     C                     MOVELWIPAST    WL0003           APE Excl Collec
     C                     MOVELWIVSST    WL0004           Record Status
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Write Accrual 855 RT - Accrual Prod Pgm  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0035 112       Item Accrual Am
     C                     MOVEL*BLANK    WN0036  1        Retro Comm Calc
     C                     MOVEL*BLANK    WN0037  1        SDA Affect Sale
     C                     MOVEL*BLANK    WN0038  1        SDA Affect Invo
     C                     MOVEL*BLANK    WN0039  1        SDA Print on In
     C                     MOVEL*BLANK    WN0040  2        SDA Invoice Pri
     C                     Z-ADD*ZERO     WN0041  70       SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WN0042 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0043 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0044  80       SDA G/L Sub Led
     C                     MOVEL*BLANK    WN0045  8        SDA G/L Code Dr
     C                     MOVEL*BLANK    WN0046  8        SDA G/L Code Cr
     C                     MOVEL*BLANK    WN0047  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0048  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0049  8        G/L Sub Account
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJOJCD    WQSK01           Accrual Code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Accrual Code
      * Setup key
     C                     MOVELWHOJCD    WQSK01           Accrual Code
      * Establish starting position
     C           KRSSK     SETLL@D2RET9                    *
     C           KRSSK     READE@D2RET9                  90*
      * Data record not found
     C   90                MOVEL'USR3972' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *---------- MAINTENANCE LOG ----------* FROM COPIED FUNCTION
     C                     EXSR UFSUBR                     *---------- MAI
      * **** USE Ordered Qty/Wgt instead of Shipped Qty/Wgt ****
      * CALC: Accrual
      * CASE: Scheduled Ship Date within Period Begin/End
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE DB1.AD Period Beginning D
      *   |- c2    : PAR.Scheduled Ship Date LE DB1.AD Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCAODT    IFGE WJSCDT                     *IF
     C           WCAODT    IFLE WJSDDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWHI2TX    WN0045           SDA G/L Code Dr
     C                     MOVELWHJFTX    WN0046           SDA G/L Code Cr
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Dr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0002    WQ0001  30       Company Number
     C                     PARM WHI2TX    WQ0002  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0003 25        G/L Code Desc U
     C           WN0047    PARM *BLANK    WQ0004  8        G/L Account Id
     C                     PARM *BLANK    WQ0005  3        G/L Account Typ
     C                     PARM *BLANK    WQ0006  3        G/L Account Typ
     C           YL0008    PARM *BLANK    WQ0007  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Cr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0002    WQ0008  30       Company Number
     C                     PARM WHJFTX    WQ0009  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0010 25        G/L Code Desc U
     C           WN0048    PARM *BLANK    WQ0011  8        G/L Account Id
     C                     PARM *BLANK    WQ0012  3        G/L Account Typ
     C                     PARM *BLANK    WQ0013  3        G/L Account Typ
     C           YL0008    PARM *BLANK    WQ0014  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWJO9TX    WN0044           SDA G/L Sub Led
     C                     MOVELWHI3TX    WN0049           G/L Sub Account
     C                     MOVEL'N'       WUB8ST           Status - Y or N
      * If all products flag is no
      * CASE: PAR.All Products (Y/N) is No
     C           WHTTST    IFEQ 'N'                        *IF
      * RTV: Accrual Rate & Type
      * CASE: PAR.Accrual Detail Search is Item
     C           WHQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Accrual Prod Pgm Item  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      * Check if Rate > 0
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : WRK.Accrual Rate is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WUBKPR    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
      * 12/15/10 PKD TFS: C1208 Only check the Customer Selection if
      *              Product is applicable for the program.
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * If all customers is no
      * CASE: DB1.AD All Customers is no
     C           WJEWST    IFEQ 'N'                        *IF
      * RTV: Ship To Customer and check status (skip if inactive)
      * RTV Acr Prod Pgm Cust RT - Accrual Prod Pgm Cust  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     C                     END                             *FI
      * Calc Accrual
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTUST           Error Status  2
      * RTV Chk for Rvrs Accru RT - Order Detail Fin  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0005           Company Number
     C                     Z-ADDWCC4NB    WL0006           Order Number
     C                     Z-ADDWCDPNB    WL0007           Order Sequence
     C                     Z-ADDWCUENB    WL0008           Order Secondary
     C                     MOVELWJOJCD    WL0009    P      Accrual Code
     C                     MOVELWUTUST    WL0010    P      Error Status  2
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WUTUST    P      Error Status  2
      * CASE: WRK.Error Status  2 is No
     C           WUTUST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
      * CASE: WRK.Error Status  3 is No
     C           WUTXST    IFEQ 'N'                        *IF
      * Calculate Extended Amount (which is the Accrual Amount)
      * E4057 JJH 04/29/15 - Rewrite Calc logic to utizile Affect Sales
      *  Pounds Status and Affect Sales Dollar Status
      * Calc Accrual
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Accrual Rate Type is $/Lb
      *   |- c2    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'W'                        *IF
     C           WCVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WUBKPR    MULT WCD0WG    WUAYVA           Extended Amount
     C                     END                             *FI
      * Change trans amount according to add-on/allowance flag
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Add-on/Allowance is Allowance
      *   |- c2    : PAR.Billing Activity Type is Invoice
      *   |- c3    : PAR.Billing Activity Type is Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WHTSST    IFEQ 'S'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2OBST    OREQ '3'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
      * Change trans amount according to Credit Memo & Addon allow 4/14/1
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : PAR.Add-on/Allowance is Add-on
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '2'                        *IF
     C           WHTSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     Z-ADDWUAYVA    WN0035           Item Accrual Am
     C                     ADD  1         WN0001           Sequence Number
      * E4057 JJH 04/27/15 - Populate: SDA Atch to Ord ActShpDt
      * CREATE:  ORDER DETAIL ACCRUAL 855
      * CASE: WRK.Extended Amount is not equal to zeros
     C           WUAYVA    IFNE 0                          *IF
      * E4057 JJH 05/13/15 - Only crt record if Extended Amount NE 0
      * **** REPLACE WITH CREATE OBJECT OVER NEW FILE ****
      * Crt Ord Dtl Acrl 855  CR - Order Detail Accrual 855  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0011           Company Number
     C                     Z-ADDWCC4NB    WL0012           Order Number
     C                     Z-ADDWCDPNB    WL0013           Order Sequence
     C                     Z-ADDWCUENB    WL0014           Order Secondary
     C                     Z-ADDWN0001    WL0015           Sequence Number
     C                     Z-ADDWUBKPR    WL0016           Accrual Rate
     C                     Z-ADDWUC5PC    WL0017           Accrual Percent
     C                     Z-ADDWUAYVA    WL0018           Extended Amount
     C                     Z-ADDWCHGCD    WL0019           Item Code
     C                     Z-ADDWCBKC7    WL0020           Ship To Custome
     C                     Z-ADDP2ANC7    WL0021           A/R Customer
     C                     Z-ADDWCAODT    WL0022           Scheduled Ship
     C                     Z-ADDWCD0WG    WL0023           Weight Ordered
     C                     Z-ADDWCAVQT    WL0024           Quantity Ordere
     C                     MOVELWHOKCD    WL0025    P      Accrual Type
     C                     MOVELWHTQST    WL0026    P      Print On Invoic
     C                     MOVELWHFGTX    WL0027    P      Invoice Print T
     C                     Z-ADD0         WL0028           Unused Date
     C                     Z-ADD0         WL0029           Unused Date 2
     C                     Z-ADD0         WL0030           Unused Value 1-
     C                     Z-ADD0         WL0031           Unused Value 2-
     C                     MOVELWUSHSX    WL0032    P      Accrual Rate Ty
     C                     MOVELWJOJCD    WL0033    P      Accrual Code
     C                     MOVELYL0004    WL0034    P      TRADE PARTNER C
     C                     MOVELYL0003    WL0035    P      Customer Purcha
     C                     MOVEL*BLANK    WL0036           Unused Cde 2-2
     C                     MOVEL*BLANK    WL0037           Unused Cde 2-3
     C                     MOVELWUGSTX    WL0038    P      unused status 2
     C                     MOVELWUGSTX    WL0039    P      unused status 3
     C                     MOVELWJVSST    WL0040    P      Record Status
     C                     Z-ADD##JDT     WL0041           Create Date
     C                     Z-ADD##JTM     WL0042           Create Time
     C                     MOVEL##USR     WL0043    P      Create User
     C                     MOVEL@CN,001   WL0044    P      Create Program
     C                     Z-ADD0         WL0045           Change Date
     C                     Z-ADD0         WL0046           Change Time
     C                     MOVEL*BLANK    WL0047           Change User
     C                     MOVEL*BLANK    WL0048           Change Program
     C                     EXSR SPCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSK     READE@D2RET9                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists  RT - Accrual Prod Pgm Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKOJCD           Accrual Code
     C                     KFLD           WKMSNY           AD Program Numb
     C                     KFLD           WKHGCD           Item Code
      * Setup key
     C                     MOVELWJOJCD    WKOJCD           Accrual Code
     C                     Z-ADDWJMSNY    WKMSNY           AD Program Numb
     C                     Z-ADDWCHGCD    WKHGCD           Item Code
      * Establish starting position
     C           KRSSL     CHAIN@D3REUC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3974' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WUSHSX           Accrual Rate Ty
     C                     Z-ADD*ZERO     WUBKPR           Accrual Rate
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWKSHSX    WUSHSX           Accrual Rate Ty
     C                     Z-ADDWKBKPR    WUBKPR           Accrual Rate
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Acr Prod Pgm Cust RT - Accrual Prod Pgm Cust  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0050  1        Record Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WLOJCD           Accrual Code
     C                     KFLD           WLMSNY           AD Program Numb
     C                     KFLD           WLBKC7           Ship To Custome
      * Setup key
     C                     MOVELWJOJCD    WLOJCD           Accrual Code
     C                     Z-ADDWJMSNY    WLMSNY           AD Program Numb
     C                     Z-ADDWCBKC7    WLBKC7           Ship To Custome
      * Establish starting position
     C           KRSSM     CHAIN@FJREBY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4157' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WLVSST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Chk for Rvrs Accru RT - Order Detail Fin  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WMC4NB    WQSN02           Order Number
     C           *LIKE     DEFN WMDPNB    WQSN03           Order Sequence
     C           *LIKE     DEFN WMUENB    WQSN04           Order Secondary
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WQSN03           Order Sequence
     C                     KFLD           WQSN04           Order Secondary
      * Setup key
     C                     Z-ADDWL0005    WQSN01           Company Number
     C                     Z-ADDWL0006    WQSN02           Order Number
     C                     Z-ADDWL0007    WQSN03           Order Sequence
     C                     Z-ADDWL0008    WQSN04           Order Secondary
      * Establish starting position
     C           KRSSN     SETLL@CRWKL1                    *
     C           KRSSN     READE@CRWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1317' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Financial Type is Accrual Charge
     C           WMG4ST    IFEQ 'A'                        *IF
      * RTV Reverse Code       RT - Accrual Code Master  * 
     C                     EXSR SORVGN
      * CASE: PAR.Accrual Code EQ WRK.Reverse Accrual Code
     C           WL0009    IFEQ WUOQCD                     *IF
     C                     MOVEL'Y'       WL0010           Error Status  2
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@CRWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Reverse Code       RT - Accrual Code Master  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0051  1        Automatic Accru
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WOOJCD           Accrual Code
      * Setup key
     C                     MOVELWMOJCD    WOOJCD           Accrual Code
      * Establish starting position
     C           KRSSO     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0051           Automatic Accru
     C                     MOVEL*BLANK    WUOQCD           Reverse Accrual
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWOTOST    WN0051           Automatic Accru
     C                     MOVELWOOQCD    WUOQCD           Reverse Accrual
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt Ord Dtl Acrl 855  CR - Order Detail Accrual 855  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CZCPYE
     C                     Z-ADDWL0011    WBAIC3           Company Number
     C                     Z-ADDWL0012    WBC4NB           Order Number
     C                     Z-ADDWL0013    WBDPNB           Order Sequence
     C                     Z-ADDWL0014    WBUENB           Order Secondary
     C                     Z-ADDWL0015    WBDXNB           Sequence Number
     C                     Z-ADDWL0016    WBBKPR           Accrual Rate
     C                     Z-ADDWL0017    WBC5PC           Accrual Percent
     C                     Z-ADDWL0018    WBAYVA           Extended Amount
     C                     Z-ADDWL0019    WBHGCD           Item Code
     C                     Z-ADDWL0020    WBBKC7           Ship To Custome
     C                     Z-ADDWL0021    WBDUC7           A/R Customer
     C                     Z-ADDWL0022    WBAODT           Scheduled Ship
     C                     Z-ADDWL0023    WBD0WG           Weight Ordered
     C                     Z-ADDWL0024    WBAVQT           Quantity Ordere
     C                     MOVELWL0025    WBOKCD           Accrual Type
     C                     MOVELWL0026    WBTQST           Print On Invoic
     C                     MOVELWL0027    WBFGTX           Invoice Print T
     C                     Z-ADDWL0028    WBQRDT           Unused Date
     C                     Z-ADDWL0029    WBQSDT           Unused Date 2
     C                     Z-ADDWL0030    WBHBVL           Unused Value 1-
     C                     Z-ADDWL0031    WBHCVL           Unused Value 2-
     C                     MOVELWL0032    WBSHSX           Accrual Rate Ty
     C                     MOVELWL0033    WBOJCD           Accrual Code
     C                     MOVELWL0034    WBHPAA           TRADE PARTNER C
     C                     MOVELWL0035    WBBCNA           Customer Purcha
     C                     MOVELWL0036    WBP4AA           Unused Cde 2-2
     C                     MOVELWL0037    WBP5AA           Unused Cde 2-3
     C                     MOVELWL0038    WBUNU2           unused status 2
     C                     MOVELWL0039    WBUNU3           unused status 3
     C                     MOVELWL0040    WBVSST           Record Status
     C                     Z-ADDWL0041    WBMJDT           Create Date
     C                     Z-ADDWL0042    WBBETM           Create Time
     C                     MOVELWL0043    WBCCVN           Create User
     C                     MOVELWL0044    WBCDVN           Create Program
     C                     Z-ADDWL0045    WBMKDT           Change Date
     C                     Z-ADDWL0046    WBBFTM           Change Time
     C                     MOVELWL0047    WBCEVN           Change User
     C                     MOVELWL0048    WBCFVN           Change Program
      *
     C           KLCRSP    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C                     KFLD           WBDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSP    SETLL@CZCPYE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4948' W0RTN   7
      * Send message 'Order Detail Accrual 8 EX'
     C                     MOVEL'USR4948' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@CZCPYE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Write Accrual 855 RT - Customer Accrual  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0052 30        Accrual Descrip
     C                     MOVEL*BLANK    WN0053  1        Automatic Accru
     C                     MOVEL*BLANK    WN0054  1        Print On Invoic
     C                     MOVEL*BLANK    WN0055  1        Rate Usage
     C                     MOVEL*BLANK    WN0056  1        Add-on/Allowanc
     C                     MOVEL*BLANK    WN0057  2        Accrual Type
     C                     MOVEL*BLANK    WN0058  2        Sub Ledger Code
     C                     MOVEL*BLANK    WN0059  3        Reverse Accrual
     C                     MOVEL*BLANK    WN0060  2        U/M - Primary D
     C                     MOVEL*BLANK    WN0061  8        G/L Code Dr
     C                     MOVEL*BLANK    WN0062  8        G/L Code Cr
     C                     MOVEL*BLANK    WN0063  8        G/L Sub Account
     C                     MOVEL*BLANK    WN0064  8        Sales History E
     C                     MOVEL*BLANK    WN0065  1        Post to G/L (Y/
     C                     MOVEL*BLANK    WN0066  2        Accrual Rate Ty
     C                     MOVEL*BLANK    WN0067  1        Affect Sales Re
     C                     MOVEL*BLANK    WN0068  1        Affect Invoice
     C                     MOVEL*BLANK    WN0069  2        Invoice Print T
     C                     Z-ADD*ZERO     WN0070 112       Item Accrual Am
     C                     MOVEL*BLANK    WN0071  1        Retro Comm Calc
     C                     MOVEL*BLANK    WN0072  1        SDA Affect Sale
     C                     MOVEL*BLANK    WN0073  1        SDA Affect Invo
     C                     MOVEL*BLANK    WN0074  1        SDA Print on In
     C                     MOVEL*BLANK    WN0075  2        SDA Invoice Pri
     C                     Z-ADD*ZERO     WN0076  70       SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WN0077 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0078 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0079  80       SDA G/L Sub Led
     C                     MOVEL*BLANK    WN0080  8        SDA G/L Code Dr
     C                     MOVEL*BLANK    WN0081  8        SDA G/L Code Cr
     C                     MOVEL*BLANK    WN0082  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0083  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0084  8        G/L Sub Account
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRBKC7    WQSQ01           Ship To Custome
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           WQSQ01           Ship To Custome
     C                     KFLD           WRQGSX           Commission/Not
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Ship To Custome
      * Setup key
     C                     Z-ADDWCBKC7    WQSQ01           Ship To Custome
     C                     MOVEL'1'       WRQGSX           Commission/Not
      * Establish starting position
     C           KPSSQ     SETLL@HOREKH                    *
     C           KRSSQ     READE@HOREKH                  90*
      * Data record not found
     C   90                MOVEL'USR1520' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * E4057 JJH 05/13/15 - Reset Extended Amount to Zero
     C                     Z-ADD0         WUAYVA           Extended Amount
      * RTV All Values Act NEW RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWROJCD    WL0049    P      Accrual Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    WN0052    P      Accrual Descrip
     C                     MOVELWL0051    WN0053    P      Automatic Accru
     C                     MOVELWL0052    WN0054    P      Print On Invoic
     C                     MOVELWL0053    WN0055    P      Rate Usage
     C                     MOVELWL0054    WN0056    P      Add-on/Allowanc
     C                     MOVELWL0055    WN0057    P      Accrual Type
     C                     MOVELWL0056    WN0058    P      Sub Ledger Code
     C                     MOVELWL0057    WN0059    P      Reverse Accrual
     C                     MOVELWL0058    WN0060    P      U/M - Primary D
     C                     MOVELWL0059    WN0061    P      G/L Code Dr
     C                     MOVELWL0060    WN0062    P      G/L Code Cr
     C                     MOVELWL0061    WN0063    P      G/L Sub Account
     C                     MOVELWL0062    WN0064    P      Sales History E
     C                     MOVELWL0063    WN0065    P      Post to G/L (Y/
     C                     MOVELWL0064    WN0066    P      Accrual Rate Ty
     C                     MOVELWL0065    WN0067    P      Affect Sales Re
     C                     MOVELWL0066    WN0068    P      Affect Invoice
     C                     MOVELWL0067    WN0069    P      Invoice Print T
      * OMIT:  Print On Invoice = No
      * CASE: PAR.Print On Invoice (Y/N) is Yes
     C           WN0054    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OMIT:  Commission Accruals
      * CASE: DB1.Commission/Not Comm Sts is Commission
     C           WRQGSX    IFEQ '9'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Rtv Accr Prog EXT     RT - Accrual Program EXT  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWROJCD    WL0001    P      Accrual Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0004    P      G/L Account Cat
     C                     MOVELWL0003    YL0009    P      APE Excl Collec
     C                     MOVELWL0004    YN0005    P      Record Status
      * OMIT:  Shipping Method = Collect Rail or Truck
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.APE Excl Collect ShpMthd is Yes
      *   |- c2    : PAR.Shipping Method is Collect
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFEQ 'Y'                        *IF
     C           YL0001    IFEQ 'CR'                       *IF
     C           YL0001    OREQ 'CT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0071           Retro Comm Calc
      * Process Accrual Program
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Scheduled Ship Date between Priod Begin & Period End Date
      * CASE: Period Begin <= Scheduled Ship Date <= Period End
      *  - c1 AND c2
      *   |- c1    : PAR.Scheduled Ship Date GE DB1.Period Beginning Date
      *   |- c2    : PAR.Scheduled Ship Date LE DB1.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCAODT    IFGE WRBFDT                     *IF
     C           WCAODT    IFLE WRA2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWN0061    WN0080           SDA G/L Code Dr
     C                     MOVELWN0062    WN0081           SDA G/L Code Cr
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Dr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0002    WQ0015  30       Company Number
     C                     PARM WN0061    WQ0016  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0017 25        G/L Code Desc U
     C           WN0082    PARM *BLANK    WQ0018  8        G/L Account Id
     C                     PARM *BLANK    WQ0019  3        G/L Account Typ
     C                     PARM *BLANK    WQ0020  3        G/L Account Typ
     C           YL0010    PARM *BLANK    WQ0021  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Cr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0002    WQ0022  30       Company Number
     C                     PARM WN0062    WQ0023  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0024 25        G/L Code Desc U
     C           WN0083    PARM *BLANK    WQ0025  8        G/L Account Id
     C                     PARM *BLANK    WQ0026  3        G/L Account Typ
     C                     PARM *BLANK    WQ0027  3        G/L Account Typ
     C           YL0010    PARM *BLANK    WQ0028  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0079           G/L Sub Ledger
      * G/L Sub Ledger DRV
      * A/R Customer
      * CASE: PAR.Sub Ledger Code is A/R Customer
     C           WN0058    IFEQ 'A'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2ANC7    WL0068           Ship To Custome
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    WN0079           Customer G/L Ve
     C                     END                             *FI
      * Ship To Customer
      * CASE: PAR.Sub Ledger Code is Ship To Customer
     C           WN0058    IFEQ 'S'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRBKC7    WL0068           Ship To Custome
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    WN0079           Customer G/L Ve
     C                     END                             *FI
      * Broker
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Sub Ledger Code is Broker
      *   |- c2    : PAR.Sub Ledger Code is Buyer Group
      *   '-
     C           WN0058    IFEQ 'B'                        *IF
     C           WN0058    OREQ 'G'                        *OR
      * Rtv Broker Info       RT - Broker  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWRHHAA    WL0070    P      Broker Code
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YL0011    P      Broker Name
     C                     MOVELWL0072    YL0012    P      Broker Address
     C                     MOVELWL0073    YL0013    P      Broker Address
     C                     MOVELWL0074    YL0014    P      Broker City
     C                     MOVELWL0075    YL0015    P      Broker State
     C                     MOVELWL0076    YL0016    P      Broker Zip
     C                     MOVELWL0077    YL0017    P      Broker Office M
     C                     MOVELWL0078    YL0018    P      Broker Telephon
     C                     MOVELWL0079    YL0019    P      Broker Fax Numb
     C                     MOVELWL0080    YL0020    P      Broker Email Ad
     C                     Z-ADDWL0081    WN0079           Broker G/L Vend
     C                     MOVELWL0082    YL0021    P      Salesperson Cod
     C                     END                             *FI
     C                     MOVELWN0063    WN0084           G/L Sub Account
      * E4057 JJH 04/29/15 - Rewrite Calc logic to utizile Affect Sales
      *  Pounds Status and Affect Sales Dollar Status
      * Determine Rate & Calculate Accrual Amount
      * CASE: PAR.Automatic Accrual (Y/N) is Yes
     C           WN0053    IFEQ 'Y'                        *IF
      * E4057 JJH 05/04/15 - Revised logic for Accrual Rates
      * Accrual Type is : Not Commission - same as Commission now DLY029
      * CASE: DB1.Commission/Not Comm Sts is Not Commission
     C           WRQGSX    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUB8ST           Status - Y or N
      * If all products is Yes
      * CASE: DB1.All Products (Y/N) is Yes
     C           WRTTST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * Accrual Rate
      * CASE: DB1.Accrual Rate Type is All Sales
     C           WRSHSX    IFEQ 'W'                        *IF
     C           WRSHSX    OREQ 'S'
     C           WRSHSX    OREQ 'Q'
     C           WRSHSX    OREQ 'G'
     C           WRSHSX    OREQ 'FA'
      * RMC 08/09/07 add "G" (% of gross ext amt) to All Sales condition
     C                     Z-ADDWRBKPR    WUBKPR           Accrual Rate
     C                     MOVELWRSHSX    WUSHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is NetSls-3rdParty Adj
     C           WRSHSX    IFEQ 'SA'                       *IF
      * E4057 JJH 05/04/15 - Per Purva Droge, Leave as is because this is
      *   NOT affected by Customer Accrual.
      * ** Exclude 3rd Party Sales Adjustments      FP1314 LJB
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is Flat Order Amount
     C           WRSHSX    IFEQ 'FO'                       *IF
      * E4057 JJH 05/04/15 - Revised logic for Flat Load Amount
      * Process by Billing Activity Type
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : PAR.Billing Activity Type is Invoice
      *   |- c2    : PAR.Billing Activity Type is Credit Memo
      *   |- c3    : PAR.OD Full Return to Plant is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2OBST    IFEQ '2'                        *IF
     C           WCH0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Accrual Exists    RT - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0083           Company Number
     C                     Z-ADDWCC4NB    WL0084           Order Number
     C                     MOVELWROJCD    WL0085    P      Accrual Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0086    YL0010    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0010    IFEQ 'N'                        *IF
     C                     Z-ADDWRBKPR    WUBKPR           Accrual Rate
     C                     MOVELWRSHSX    WUSHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is Flat Load Amount
     C           WRSHSX    IFEQ 'FL'                       *IF
      * E4057 JJH 05/04/15 - Revised logic for Flat Load Amount
      * Process by Billing Activity Type
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4)
      *   |- c1    : PAR.Billing Activity Type is Invoice
      *   |- c2    : PAR.Load ID is NE Blank
      *   |- c3    : PAR.Billing Activity Type is Credit Memo
      *   |- c4    : PAR.OD Full Return to Plant is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2RMNB    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2OBST    IFEQ '2'                        *IF
     C           WCH0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Billing Activity Type is Invoice
     C           P2OBST    IFEQ '1'                        *IF
      * Val Accrual Exists    RT - Order Header TRG  * 
     C                     EXSR SVRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Accrual Exists    RT - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0083           Company Number
     C                     Z-ADDWCC4NB    WL0084           Order Number
     C                     MOVELWROJCD    WL0085    P      Accrual Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0086    YL0010    P      Record Found US
     C                     END                             *FI
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0010    IFEQ 'N'                        *IF
     C                     Z-ADDWRBKPR    WUBKPR           Accrual Rate
     C                     MOVELWRSHSX    WUSHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If all products flag is no/yes+exceptions, check for item exists
      * CASE: DB1.All Products (Y/N) is No
     C           WRTTST    IFEQ 'N'                        *IF
      * RTV: Accrual Rate
      * CASE: DB1.Accrual Detail Search is Item
     C           WRQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRBKC7    WL0087           Ship To Custome
     C                     MOVELWROJCD    WL0088    P      Accrual Code
     C                     Z-ADDWRGUNY    WL0089           CAH Sequence No
     C                     Z-ADDWCHGCD    WL0090           Item Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0091    WUBKPR           Accrual Rate
     C                     MOVELWL0092    WUSHSX    P      Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRBKC7    WL0093           Ship To Custome
     C                     MOVELWROJCD    WL0094    P      Accrual Code
     C                     Z-ADDWRGUNY    WL0095           CAH Sequence No
     C                     Z-ADDWCRGNB    WL0096           Item Structure
     C                     Z-ADDWCRHNB    WL0097           Item Structure
     C                     Z-ADDWCRINB    WL0098           Item Structure
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0099    WUBKPR           Accrual Rate
     C                     MOVELWL0100    WUSHSX    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRBKC7    WL0093           Ship To Custome
     C                     MOVELWROJCD    WL0094    P      Accrual Code
     C                     Z-ADDWRGUNY    WL0095           CAH Sequence No
     C                     Z-ADDWCRGNB    WL0096           Item Structure
     C                     Z-ADDWCRHNB    WL0097           Item Structure
     C                     Z-ADD0         WL0098           Item Structure
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0099    WUBKPR           Accrual Rate
     C                     MOVELWL0100    WUSHSX    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
      * 05/09/08 PKD/SZ Only calculate the Accrual if Rate > 0
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : WRK.Accrual Rate is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WUBKPR    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Yes + Exc
      * CASE: DB1.All Products (Y/N) is Yes + Exceptions
     C           WRTTST    IFEQ 'X'                        *IF
      * RTV: Accrual Rate
      * CASE: DB1.Accrual Detail Search is Item
     C           WRQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRBKC7    WL0087           Ship To Custome
     C                     MOVELWROJCD    WL0088    P      Accrual Code
     C                     Z-ADDWRGUNY    WL0089           CAH Sequence No
     C                     Z-ADDWCHGCD    WL0090           Item Code
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0091    WUBKPR           Accrual Rate
     C                     MOVELWL0092    WUSHSX    P      Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRBKC7    WL0093           Ship To Custome
     C                     MOVELWROJCD    WL0094    P      Accrual Code
     C                     Z-ADDWRGUNY    WL0095           CAH Sequence No
     C                     Z-ADDWCRGNB    WL0096           Item Structure
     C                     Z-ADDWCRHNB    WL0097           Item Structure
     C                     Z-ADDWCRINB    WL0098           Item Structure
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0099    WUBKPR           Accrual Rate
     C                     MOVELWL0100    WUSHSX    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRBKC7    WL0093           Ship To Custome
     C                     MOVELWROJCD    WL0094    P      Accrual Code
     C                     Z-ADDWRGUNY    WL0095           CAH Sequence No
     C                     Z-ADDWCRGNB    WL0096           Item Structure
     C                     Z-ADDWCRHNB    WL0097           Item Structure
     C                     Z-ADD0         WL0098           Item Structure
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0099    WUBKPR           Accrual Rate
     C                     MOVELWL0100    WUSHSX    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
      * Calcualte only if Rate exists
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * 11/26/02 Exception may exist as 0 -- then dont calc accrual
      * CASE: WRK.Accrual Rate is equal to zero
     C           WUBKPR    IFEQ 0                          *IF
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWRBKPR    WUBKPR           Accrual Rate
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVELWRSHSX    WUSHSX           Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calc Accrual
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTUST           Error Status  2
      * RTV Chk for Rvrs Accru RT - Order Detail Fin  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0005           Company Number
     C                     Z-ADDWCC4NB    WL0006           Order Number
     C                     Z-ADDWCDPNB    WL0007           Order Sequence
     C                     Z-ADDWCUENB    WL0008           Order Secondary
     C                     MOVELWROJCD    WL0009    P      Accrual Code
     C                     MOVELWUTUST    WL0010    P      Error Status  2
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WUTUST    P      Error Status  2
      * Calc Accrual
      * CASE: WRK.Error Status  2 is No
     C           WUTUST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
      * CASE: WRK.Error Status  3 is No
     C           WUTXST    IFEQ 'N'                        *IF
      * Calculate Extended Amount (which is the Accrual Amount)
      * E4057 JJH 05/04/15 - Revised logic for Accrual Rates
      * Calc Accrual
      * CASE:
      *  - c1 AND c3
      *   |- c1    : WRK.Accrual Rate Type is $/Lb
      *   |- c3    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'W'                        *IF
     C           WCVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WUBKPR    MULT WCD0WG    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c3
      *   |- c1    : WRK.Accrual Rate Type is $/Quantity
      *   |- c3    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'Q'                        *IF
     C           WCVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WUBKPR    MULT WCAVQT    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c4
      *   |- c1    : WRK.Accrual Rate Type is % of Net Sales
      *   |- c4    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'S'                        *IF
     C           WCANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * (RMC Added check for "SS" for new Seidai contract)
      * Accr Amount = order dtl extended amt - TF Accruals - Absorbed Frt
      * Rtv TF accrl total    RT - Shipping Dtl Accrual  * 
     C                     EXSR SYRVGN
      * Calculate Absorbed Freight Amount
     C           P2TBNB    DIV  100       WUWB      H      *Synon (15,5) w
     C           WCD0WG    MULT WUWB      WUULVA    H      Absorbed Freigh
      * Compute: Accr Amt f/Sales
      * WRK.Extended Amount =
      *    *COMPUTE ((x1-x2-x3)*x4)
      * x1    : PAR.Extended Amount
      * -     : PGM.*Synon (15,2) work field
      * x2    : WRK.Total Amount
      * -     : PGM.*Synon (15,2) work field
      * x3    : WRK.Absorbed Freight Amount
      * *     : PGM.*Synon (15,2) work field *
      * x4    : WRK.Accrual Rate
     C           WCAYVA    SUB  WUMFQT    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  WUULVA    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT WUBKPR    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Accrual Rate Type is % of Gross Extended Amt
      *   |- c2    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'G'                        *IF
     C           WCANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Accrual = gross extended amt from Order dtl * accrual rate
      * WRK.Extended Amount
      * WRK.Extended Amount =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : WRK.Accrual Rate
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Extended Amount
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUBKPR    MULT WCAYVA    W0WA01    H      *Synon (15,2) w
     C           W0WA01    DIV  100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAYVA           Extended Amount
      * E4057 JJH 06/04/15 - Correction for Flat Load Amount & Invoice
     C                     ELSE
      * CASE:
      *  - (c2 AND c3 AND c4) OR (c2 AND c5)
      *   |- c2    : WRK.Accrual Rate Type is Flat Load Amount
      *   |- c3    : PAR.Billing Activity Type is Credit Memo
      *   |- c4    : PAR.OD Full Return to Plant is Yes
      *   |- c5    : PAR.Billing Activity Type is Invoice
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'FL'                       *IF
     C           P2OBST    IFEQ '2'                        *IF
     C           WCH0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WUSHSX    IFEQ 'FL'                       *IF
     C           P2OBST    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWUBKPR    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Change trans amount according to add-on/allowance flag
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Add-on/Allowance is Allowance
      *   |- c2    : PAR.Billing Activity Type is Invoice
      *   |- c3    : PAR.Billing Activity Type is Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0056    IFEQ 'S'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2OBST    OREQ '3'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
      * Change trans amount according to Credit Memo & Addon allow  4/14/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : PAR.Add-on/Allowance is Add-on
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '2'                        *IF
     C           WN0056    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     Z-ADDWUAYVA    WN0070           Item Accrual Am
     C                     ADD  1         WN0001           Sequence Number
      * db1.accrual percent changed to wrk. context    10/13
      * db1.company changed to par. context    10/22/04
      * RMC DLY029 5/23/07 output new fields
      * ** Don't create the record if the accrual amount = zeros  FP1314
      * CASE: WRK.Extended Amount is not equal to zeros
     C           WUAYVA    IFNE 0                          *IF
      * E4057 JJH 04/27/15 - Populate: SDA Atch to Ord ActShpDt
      * **** REPLACE WITH ORDER DETAIL ACCRUAL 855
      * Crt Ord Dtl Acrl 855  CR - Order Detail Accrual 855  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0011           Company Number
     C                     Z-ADDWCC4NB    WL0012           Order Number
     C                     Z-ADDWCDPNB    WL0013           Order Sequence
     C                     Z-ADDWCUENB    WL0014           Order Secondary
     C                     Z-ADDWN0001    WL0015           Sequence Number
     C                     Z-ADDWUBKPR    WL0016           Accrual Rate
     C                     Z-ADDWUC5PC    WL0017           Accrual Percent
     C                     Z-ADDWUAYVA    WL0018           Extended Amount
     C                     Z-ADDWCHGCD    WL0019           Item Code
     C                     Z-ADDWRBKC7    WL0020           Ship To Custome
     C                     Z-ADDP2ANC7    WL0021           A/R Customer
     C                     Z-ADDWCAODT    WL0022           Scheduled Ship
     C                     Z-ADDWCD0WG    WL0023           Weight Ordered
     C                     Z-ADDWCAVQT    WL0024           Quantity Ordere
     C                     MOVELWN0057    WL0025    P      Accrual Type
     C                     MOVELWN0054    WL0026    P      Print On Invoic
     C                     MOVELWN0069    WL0027    P      Invoice Print T
     C                     Z-ADD0         WL0028           Unused Date
     C                     Z-ADD0         WL0029           Unused Date 2
     C                     Z-ADD0         WL0030           Unused Value 1-
     C                     Z-ADD0         WL0031           Unused Value 2-
     C                     MOVELWUSHSX    WL0032    P      Accrual Rate Ty
     C                     MOVELWROJCD    WL0033    P      Accrual Code
     C                     MOVELYL0004    WL0034    P      TRADE PARTNER C
     C                     MOVELYL0003    WL0035    P      Customer Purcha
     C                     MOVEL*BLANK    WL0036           Unused Cde 2-2
     C                     MOVEL*BLANK    WL0037           Unused Cde 2-3
     C                     MOVELYL0023    WL0038    P      unused status 2
     C                     MOVELYL0024    WL0039    P      unused status 3
     C                     MOVEL'A'       WL0040    P      Record Status
     C                     Z-ADD##JDT     WL0041           Create Date
     C                     Z-ADD##JTM     WL0042           Create Time
     C                     MOVEL##USR     WL0043    P      Create User
     C                     MOVEL@CN,002   WL0044    P      Create Program
     C                     Z-ADD0         WL0045           Change Date
     C                     Z-ADD0         WL0046           Change Time
     C                     MOVEL*BLANK    WL0047           Change User
     C                     MOVEL*BLANK    WL0048           Change Program
     C                     EXSR SPCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@HOREKH                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV All Values Act NEW RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC DLY029 5/23/07 Db Change - this outputs the new fields
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WSOJCD           Accrual Code
      * Setup key
     C                     MOVELWL0049    WSOJCD           Accrual Code
      * Establish starting position
     C           KRSSR     CHAIN@HLREU8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0050           Accrual Descrip
     C                     MOVEL*BLANK    WL0051           Automatic Accru
     C                     MOVEL*BLANK    WL0052           Print On Invoic
     C                     MOVEL*BLANK    WL0053           Rate Usage
     C                     MOVEL*BLANK    WL0054           Add-on/Allowanc
     C                     MOVEL*BLANK    WL0055           Accrual Type
     C                     MOVEL*BLANK    WL0056           Sub Ledger Code
     C                     MOVEL*BLANK    WL0057           Reverse Accrual
     C                     MOVEL*BLANK    WL0058           U/M - Primary D
     C                     MOVEL*BLANK    WL0059           G/L Code Dr
     C                     MOVEL*BLANK    WL0060           G/L Code Cr
     C                     MOVEL*BLANK    WL0061           G/L Sub Account
     C                     MOVEL*BLANK    WL0062           Sales History E
     C                     MOVEL*BLANK    WL0063           Post to G/L (Y/
     C                     MOVEL*BLANK    WL0064           Accrual Rate Ty
     C                     MOVEL*BLANK    WL0065           Affect Sales Re
     C                     MOVEL*BLANK    WL0066           Affect Invoice
     C                     MOVEL*BLANK    WL0067           Invoice Print T
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWSLENA    WL0050           Accrual Descrip
     C                     MOVELWSTOST    WL0051           Automatic Accru
     C                     MOVELWSTQST    WL0052           Print On Invoic
     C                     MOVELWSTRST    WL0053           Rate Usage
     C                     MOVELWSTSST    WL0054           Add-on/Allowanc
     C                     MOVELWSOKCD    WL0055           Accrual Type
     C                     MOVELWSTYST    WL0056           Sub Ledger Code
     C                     MOVELWSOQCD    WL0057           Reverse Accrual
     C                     MOVELWSHHCD    WL0058           U/M - Primary D
     C                     MOVELWSI2TX    WL0059           G/L Code Dr
     C                     MOVELWSJFTX    WL0060           G/L Code Cr
     C                     MOVELWSI3TX    WL0061           G/L Sub Account
     C                     MOVELWSJGTX    WL0062           Sales History E
     C                     MOVELWSLEDG    WL0063           Post to G/L (Y/
     C                     MOVELWSSHSX    WL0064           Accrual Rate Ty
     C                     MOVELWSFETX    WL0065           Affect Sales Re
     C                     MOVELWSFFTX    WL0066           Affect Invoice
     C                     MOVELWSFGTX    WL0067           Invoice Print T
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv g/l Vendor        RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WGBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0068    WGBKC7           Ship To Custome
      * Establish starting position
     C           KRSSS     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0069           Customer G/L Ve
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGAAC8    WL0069           Customer G/L Ve
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Broker Info       RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WTHHAA           Broker Code
      * Setup key
     C                     MOVELWL0070    WTHHAA           Broker Code
      * Establish starting position
     C           KRSST     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0071           Broker Name
     C                     MOVEL*BLANK    WL0072           Broker Address
     C                     MOVEL*BLANK    WL0073           Broker Address
     C                     MOVEL*BLANK    WL0074           Broker City
     C                     MOVEL*BLANK    WL0075           Broker State
     C                     MOVEL*BLANK    WL0076           Broker Zip
     C                     MOVEL*BLANK    WL0077           Broker Office M
     C                     MOVEL*BLANK    WL0078           Broker Telephon
     C                     MOVEL*BLANK    WL0079           Broker Fax Numb
     C                     MOVEL*BLANK    WL0080           Broker Email Ad
     C                     Z-ADD*ZERO     WL0081           Broker G/L Vend
     C                     MOVEL*BLANK    WL0082           Salesperson Cod
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTC4T1    WL0071           Broker Name
     C                     MOVELWTQMNA    WL0072           Broker Address
     C                     MOVELWTQNNA    WL0073           Broker Address
     C                     MOVELWTQONA    WL0074           Broker City
     C                     MOVELWTQPNA    WL0075           Broker State
     C                     MOVELWTC5T1    WL0076           Broker Zip
     C                     MOVELWTC6T1    WL0077           Broker Office M
     C                     MOVELWTC7T1    WL0078           Broker Telephon
     C                     MOVELWTC8T1    WL0079           Broker Fax Numb
     C                     MOVELWTC9T1    WL0080           Broker Email Ad
     C                     Z-ADDWTDAT1    WL0081           Broker G/L Vend
     C                     MOVELWTBCCD    WL0082           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Val Accrual Exists    RT - Shipping Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0086           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVAIC3    WQSU01           Company Number
     C           *LIKE     DEFN WVC4NB    WQSU02           Order Number
     C           *LIKE     DEFN WVOJCD    WQSU03           Accrual Code
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
     C                     KFLD           WQSU03           Accrual Code
      * Setup key
     C                     Z-ADDWL0083    WQSU01           Company Number
     C                     Z-ADDWL0084    WQSU02           Order Number
     C                     MOVELWL0085    WQSU03           Accrual Code
      * Establish starting position
     C           KRSSU     SETLL@HRCPC9                    *
     C           KRSSU     READE@HRCPC9                  90*
      * Data record not found
     C   90                MOVEL'USR1526' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0086           Record Found US
     C                     GOTO SUEXIT                     *QUIT
     C           KRSSU     READE@HRCPC9                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Val Accrual Exists    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0010           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWRMNB    WQSV01           Load ID
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Load ID
      * Setup key
     C                     Z-ADDP2RMNB    WQSV01           Load ID
      * Establish starting position
     C           KRSSV     SETLL@BFCPR0                    *
     C           KRSSV     READE@BFCPR0                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Val Accrual Exists    RT - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWAIC3    WL0083           Company Number
     C                     Z-ADDWWC4NB    WL0084           Order Number
     C                     MOVELWROJCD    WL0085    P      Accrual Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0086    YL0022    P      Record Found US
      * CASE: LCL.Record Found USR is Record Found
     C           YL0022    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0010           Record Found US
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSV     READE@BFCPR0                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WXBKC7           Ship To Custome
     C                     KFLD           WXOJCD           Accrual Code
     C                     KFLD           WXGUNY           CAH Sequence No
     C                     KFLD           WXHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0087    WXBKC7           Ship To Custome
     C                     MOVELWL0088    WXOJCD           Accrual Code
     C                     Z-ADDWL0089    WXGUNY           CAH Sequence No
     C                     Z-ADDWL0090    WXHGCD           Item Code
      * Establish starting position
     C           KRSSW     CHAIN@HPRELD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1522' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0091           Accrual Rate
     C                     MOVEL*BLANK    WL0092           Accrual Rate Ty
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDWXBKPR    WL0091           Accrual Rate
     C                     MOVELWXSHSX    WL0092           Accrual Rate Ty
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WYBKC7           Ship To Custome
     C                     KFLD           WYOJCD           Accrual Code
     C                     KFLD           WYGUNY           CAH Sequence No
     C                     KFLD           WYRGNB           Item Structure
     C                     KFLD           WYRHNB           Item Structure
     C                     KFLD           WYRINB           Item Structure
      * Setup key
     C                     Z-ADDWL0093    WYBKC7           Ship To Custome
     C                     MOVELWL0094    WYOJCD           Accrual Code
     C                     Z-ADDWL0095    WYGUNY           CAH Sequence No
     C                     Z-ADDWL0096    WYRGNB           Item Structure
     C                     Z-ADDWL0097    WYRHNB           Item Structure
     C                     Z-ADDWL0098    WYRINB           Item Structure
      * Establish starting position
     C           KRSSX     CHAIN@C8RES1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3294' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0099           Accrual Rate
     C                     MOVEL*BLANK    WL0100           Accrual Rate Ty
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWYBKPR    WL0099           Accrual Rate
     C                     MOVELWYSHSX    WL0100           Accrual Rate Ty
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv TF accrl total    RT - Shipping Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUMFQT           Total Amount
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAAIC3    WQSY01           Company Number
     C           *LIKE     DEFN TAC4NB    WQSY02           Order Number
     C           *LIKE     DEFN TADPNB    WQSY03           Order Sequence
     C           *LIKE     DEFN TAUENB    WQSY04           Order Secondary
      * Define keylist
     C           KPSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Order Number
     C                     KFLD           WQSY03           Order Sequence
     C                     KFLD           WQSY04           Order Secondary
     C                     KFLD           TADXNB           Sequence Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Order Number
     C                     KFLD           WQSY03           Order Sequence
     C                     KFLD           WQSY04           Order Secondary
      * Setup key
     C                     Z-ADDWCAIC3    WQSY01           Company Number
     C                     Z-ADDWCC4NB    WQSY02           Order Number
     C                     Z-ADDWCDPNB    WQSY03           Order Sequence
     C                     Z-ADDWCUENB    WQSY04           Order Secondary
     C                     Z-ADD1         TADXNB           Sequence Number
      * Establish starting position
     C           KPSSY     SETLL@HRCPLM                    *
     C           KRSSY     READE@HRCPLM                  90*
      * Data record not found
     C   90                MOVEL'USR1526' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 11/13/03 Accum Trade Fund Accruals only ...   PK0519
      * 06/18/07 Chg CASE to select Affect Invoice price=Y    DLY029
      * CASE: DB1.SDA Affect Invoice Price is Yes
     C           TAP9SX    IFEQ 'Y'                        *IF
     C                     ADD  TAAYVA    WUMFQT           Total Amount
     C                     END                             *FI
     C           KRSSY     READE@HRCPLM                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Write Accrual 855 RT - Order Detail Accrual  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0085 30        Accrual Descrip
     C                     MOVEL*BLANK    WN0086  1        Automatic Accru
     C                     MOVEL*BLANK    WN0087  1        Print On Invoic
     C                     MOVEL*BLANK    WN0088  1        Rate Usage
     C                     MOVEL*BLANK    WN0089  1        Add-on/Allowanc
     C                     MOVEL*BLANK    WN0090  2        Accrual Type
     C                     MOVEL*BLANK    WN0091  2        Sub Ledger Code
     C                     MOVEL*BLANK    WN0092  3        Reverse Accrual
     C                     MOVEL*BLANK    WN0093  2        U/M - Primary D
     C                     MOVEL*BLANK    WN0094  8        G/L Code Dr
     C                     MOVEL*BLANK    WN0095  8        G/L Code Cr
     C                     MOVEL*BLANK    WN0096  8        G/L Sub Account
     C                     MOVEL*BLANK    WN0097  8        Sales History E
     C                     MOVEL*BLANK    WN0098  1        Post to G/L (Y/
     C                     MOVEL*BLANK    WN0099  2        Accrual Rate Ty
     C                     MOVEL*BLANK    WN0100  1        Affect Sales Re
     C                     MOVEL*BLANK    WN0101  1        Affect Invoice
     C                     MOVEL*BLANK    WN0102  2        Invoice Print T
     C                     Z-ADD*ZERO     WN0103 112       Item Accrual Am
     C                     MOVEL*BLANK    WN0104  6        Broker Code
     C                     MOVEL*BLANK    WN0105  1        Retro Comm Calc
     C                     MOVEL*BLANK    WN0106  1        SDA Affect Sale
     C                     MOVEL*BLANK    WN0107  1        SDA Affect Invo
     C                     MOVEL*BLANK    WN0108  1        SDA Print on In
     C                     MOVEL*BLANK    WN0109  2        SDA Invoice Pri
     C                     Z-ADD*ZERO     WN0110  70       SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WN0111 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0112 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0113  80       SDA G/L Sub Led
     C                     MOVEL*BLANK    WN0114  8        SDA G/L Code Dr
     C                     MOVEL*BLANK    WN0115  8        SDA G/L Code Cr
     C                     MOVEL*BLANK    WN0116  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0117  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0118  8        G/L Sub Account
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E1812 RMC 11/22/11 Added here: Accrual type -->  % of Gross Ext A
      *                    And  Accrual type -->  $ per Qty/1000      "QT
      * 06/26/14 PKD E3164 add omit criteria for Exclude Collect Truck/Ra
      * Declare restrictor key work fields
     C           *LIKE     DEFN TBAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN TBC4NB    WQSZ02           Order Number
     C           *LIKE     DEFN TBDPNB    WQSZ03           Order Sequence
     C           *LIKE     DEFN TBUENB    WQSZ04           Order Secondary
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Order Number
     C                     KFLD           WQSZ03           Order Sequence
     C                     KFLD           WQSZ04           Order Secondary
      * Setup key
     C                     Z-ADDWCAIC3    WQSZ01           Company Number
     C                     Z-ADDWCC4NB    WQSZ02           Order Number
     C                     Z-ADDWCDPNB    WQSZ03           Order Sequence
     C                     Z-ADDWCUENB    WQSZ04           Order Secondary
      * Establish starting position
     C           KRSSZ     SETLL@HQCPLJ                    *
     C           KRSSZ     READE@HQCPLJ                  90*
      * Data record not found
     C   90                MOVEL'USR1524' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WN0105           Retro Comm Calc
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * E4057 JJH 05/13/15 - Reset Extended Amount to Zero
     C                     Z-ADD0         WUAYVA           Extended Amount
      * RTV All Values Act NEW RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELTBOJCD    WL0049    P      Accrual Code
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    WN0085    P      Accrual Descrip
     C                     MOVELWL0051    WN0086    P      Automatic Accru
     C                     MOVELWL0052    WN0087    P      Print On Invoic
     C                     MOVELWL0053    WN0088    P      Rate Usage
     C                     MOVELWL0054    WN0089    P      Add-on/Allowanc
     C                     MOVELWL0055    WN0090    P      Accrual Type
     C                     MOVELWL0056    WN0091    P      Sub Ledger Code
     C                     MOVELWL0057    WN0092    P      Reverse Accrual
     C                     MOVELWL0058    WN0093    P      U/M - Primary D
     C                     MOVELWL0059    WN0094    P      G/L Code Dr
     C                     MOVELWL0060    WN0095    P      G/L Code Cr
     C                     MOVELWL0061    WN0096    P      G/L Sub Account
     C                     MOVELWL0062    WN0097    P      Sales History E
     C                     MOVELWL0063    WN0098    P      Post to G/L (Y/
     C                     MOVELWL0064    WN0099    P      Accrual Rate Ty
     C                     MOVELWL0065    WN0100    P      Affect Sales Re
     C                     MOVELWL0066    WN0101    P      Affect Invoice
     C                     MOVELWL0067    WN0102    P      Invoice Print T
      * OMIT:  Print on Invoice = N
      * CASE: PAR.Print On Invoice (Y/N) is Yes
     C           WN0087    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Rtv Accr Prog EXT     RT - Accrual Program EXT  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELTBOJCD    WL0001    P      Accrual Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0006    P      G/L Account Cat
     C                     MOVELWL0003    YL0025    P      APE Excl Collec
     C                     MOVELWL0004    YN0007    P      Record Status
      * OMIT:  Shipping Method = Collect Rail or Truck
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.APE Excl Collect ShpMthd is Yes
      *   |- c2    : PAR.Shipping Method is Collect
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0025    IFEQ 'Y'                        *IF
     C           YL0001    IFEQ 'CR'                       *IF
     C           YL0001    OREQ 'CT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Process Accrual Program
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELWN0094    WN0114           SDA G/L Code Dr
     C                     MOVELWN0095    WN0115           SDA G/L Code Cr
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Dr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0002    WQ0029  30       Company Number
     C                     PARM WN0094    WQ0030  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0031 25        G/L Code Desc U
     C           WN0116    PARM *BLANK    WQ0032  8        G/L Account Id
     C                     PARM *BLANK    WQ0033  3        G/L Account Typ
     C                     PARM *BLANK    WQ0034  3        G/L Account Typ
     C           YL0026    PARM *BLANK    WQ0035  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Cr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0002    WQ0036  30       Company Number
     C                     PARM WN0095    WQ0037  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0038 25        G/L Code Desc U
     C           WN0117    PARM *BLANK    WQ0039  8        G/L Account Id
     C                     PARM *BLANK    WQ0040  3        G/L Account Typ
     C                     PARM *BLANK    WQ0041  3        G/L Account Typ
     C           YL0026    PARM *BLANK    WQ0042  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0113           G/L Sub Ledger
      * G/L Sub Ledger DRV
      * A/R Customer
      * CASE: PAR.Sub Ledger Code is A/R Customer
     C           WN0091    IFEQ 'A'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2ANC7    WL0068           Ship To Custome
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    WN0113           Customer G/L Ve
     C                     END                             *FI
      * Ship To Customer
      * CASE: PAR.Sub Ledger Code is Ship To Customer
     C           WN0091    IFEQ 'S'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCBKC7    WL0068           Ship To Custome
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    WN0113           Customer G/L Ve
     C                     END                             *FI
      * Broker
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Sub Ledger Code is Broker
      *   |- c2    : PAR.Sub Ledger Code is Buyer Group
      *   '-
     C           WN0091    IFEQ 'B'                        *IF
     C           WN0091    OREQ 'G'                        *OR
      * Rtv Broker Info       RT - Broker  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0027    WL0070    P      Broker Code
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YL0011    P      Broker Name
     C                     MOVELWL0072    YL0012    P      Broker Address
     C                     MOVELWL0073    YL0013    P      Broker Address
     C                     MOVELWL0074    YL0014    P      Broker City
     C                     MOVELWL0075    YL0015    P      Broker State
     C                     MOVELWL0076    YL0016    P      Broker Zip
     C                     MOVELWL0077    YL0017    P      Broker Office M
     C                     MOVELWL0078    YL0018    P      Broker Telephon
     C                     MOVELWL0079    YL0019    P      Broker Fax Numb
     C                     MOVELWL0080    YL0020    P      Broker Email Ad
     C                     Z-ADDWL0081    WN0113           Broker G/L Vend
     C                     MOVELWL0082    YL0021    P      Salesperson Cod
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0104           Broker Code
     C                     MOVELTBDSCD    WN0118           G/L Sub Account
     C                     Z-ADDTBDXNB    WN0110           SDA Ord Dtl Acr
     C                     MOVEL'N'       WUTXST           Error Status  3
      * E4057 JJH 04/29/15 - Rewrite Calc logic to utizile Affect Sales
      *  Pounds Status and Affect Sales Dollar Status
      * Calc Accrual
      * CASE: WRK.Error Status  3 is No
     C           WUTXST    IFEQ 'N'                        *IF
      * Calculate Extended Amount (which is the Accrual Amount)
      * Calc Accrual
      * CASE:
      *  - c1 AND c3
      *   |- c1    : DB1.Accrual Rate Type is $/Quantity
      *   |- c3    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TBSHSX    IFEQ 'Q'                        *IF
     C           WCVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           TBBKPR    MULT WCAVQT    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Accrual Rate Type is Flat Amount
      *   |- c2    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TBSHSX    IFEQ 'FA'                       *IF
     C           WCANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDTBBKPR    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Accrual Rate Type is % of Gross Extended Amt
      *   |- c2    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TBSHSX    IFEQ 'G'                        *IF
     C           WCANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Accrual = gross extended amt from Order dtl * accrual rate
      * WRK.Extended Amount
      * WRK.Extended Amount =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : DB1.Accrual Rate
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Extended Amount
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           TBBKPR    MULT WCAYVA    W0WA01    H      *Synon (15,2) w
     C           W0WA01    DIV  100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Accrual Rate Type is $/Quantity/1000
      *   |- c2    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TBSHSX    IFEQ 'QT'                       *IF
     C           WCVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Compute: Amt/1000 qty
      * WRK.Extended Amount =
      *    *COMPUTE (x1 * x2 / x3)
      * x1    : DB1.Accrual Rate
      * *     : PGM.*Synon (17,7) work field *
      * x2    : PAR.Quantity Ordered
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.1000
     C           TBBKPR    MULT WCAVQT    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  1000      W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Change trans amount according to add-on/allowance flag
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Add-on/Allowance is Allowance
      *   |- c2    : PAR.Billing Activity Type is Invoice
      *   |- c3    : PAR.Billing Activity Type is Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0089    IFEQ 'S'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2OBST    OREQ '3'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Do for debit memo too     RMC    4/14/10
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
      * Change trans amount according to Credit Memo  - look at add/on 4/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : PAR.Add-on/Allowance is Add-on
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '2'                        *IF
     C           WN0089    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Before  4/14 wasnt loking at add-on/allowance status -- So
      * if accrual is Add on, then subtract it for CR Memos (do the oppos
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     Z-ADDWUAYVA    WN0103           Item Accrual Am
     C                     ADD  1         WN0001           Sequence Number
      * ** Don't create the record if the accrual amount = zeros
      * CASE: WRK.Extended Amount is not equal to zeros
     C           WUAYVA    IFNE 0                          *IF
      * E4057 JJH 04/27/15 - Populate: SDA Atch to Ord ActShpDt
      * Crt Ord Dtl Acrl 855  CR - Order Detail Accrual 855  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0011           Company Number
     C                     Z-ADDWCC4NB    WL0012           Order Number
     C                     Z-ADDWCDPNB    WL0013           Order Sequence
     C                     Z-ADDWCUENB    WL0014           Order Secondary
     C                     Z-ADDWN0001    WL0015           Sequence Number
     C                     Z-ADDTBBKPR    WL0016           Accrual Rate
     C                     Z-ADDWUC5PC    WL0017           Accrual Percent
     C                     Z-ADDWUAYVA    WL0018           Extended Amount
     C                     Z-ADDWCHGCD    WL0019           Item Code
     C                     Z-ADDWCBKC7    WL0020           Ship To Custome
     C                     Z-ADDP2ANC7    WL0021           A/R Customer
     C                     Z-ADDWCAODT    WL0022           Scheduled Ship
     C                     Z-ADDWCD0WG    WL0023           Weight Ordered
     C                     Z-ADDWCAVQT    WL0024           Quantity Ordere
     C                     MOVELWN0090    WL0025    P      Accrual Type
     C                     MOVELWN0087    WL0026    P      Print On Invoic
     C                     MOVELWN0102    WL0027    P      Invoice Print T
     C                     Z-ADD0         WL0028           Unused Date
     C                     Z-ADD0         WL0029           Unused Date 2
     C                     Z-ADD0         WL0030           Unused Value 1-
     C                     Z-ADD0         WL0031           Unused Value 2-
     C                     MOVELTBSHSX    WL0032    P      Accrual Rate Ty
     C                     MOVELTBOJCD    WL0033    P      Accrual Code
     C                     MOVELYL0004    WL0034    P      TRADE PARTNER C
     C                     MOVELYL0003    WL0035    P      Customer Purcha
     C                     MOVEL*BLANK    WL0036           Unused Cde 2-2
     C                     MOVEL*BLANK    WL0037           Unused Cde 2-3
     C                     MOVELYL0028    WL0038    P      unused status 2
     C                     MOVELYL0029    WL0039    P      unused status 3
     C                     MOVEL'A'       WL0040    P      Record Status
     C                     Z-ADD##JDT     WL0041           Create Date
     C                     Z-ADD##JTM     WL0042           Create Time
     C                     MOVEL##USR     WL0043    P      Create User
     C                     MOVEL@CN,003   WL0044    P      Create Program
     C                     Z-ADD0         WL0045           Change Date
     C                     Z-ADD0         WL0046           Change Time
     C                     MOVEL*BLANK    WL0047           Change User
     C                     MOVEL*BLANK    WL0048           Change Program
     C                     EXSR SPCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSZ     READE@HQCPLJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * *** PROGRAM DESCRIPTION ***
      *================================================================
      * This XF will be used from events where an EDI 855 is required
      * with the SAC Segments at the detail level and/or at the header
      * level.  Accrual that are setup for a customer that print on the
      * Invoice are eligible for an EDI 855.  Other Accruals are included
      * in the price of the product and would not be sent as a separate
      * line.  This XF will create only those accruals that are needed
      * on an EDI855.
      * - Ordered Quantity and Weight will be used for calculation.
      * - A record is created in "Order Detail Accrual 855".
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modifications and Comments - FROM COPIED XF POST SHIPPING
      *================================================================
      * EXPCOM 11/10/04 RMC -- new to use in the accrual by range calcs
      * DLY029 05/23/07 RMC -- DB Changes,new rate type "SS" for SEIDAI b
      * DLY029 08/08/07 RMC -- New rate type "G " for % of gross ext amt
      *       will be used for sales tax calc
      * DLY029 08/09/07 RMC -- All accr types can have rate types & dtl n
      *   so do same calcs as CM-commission
      * 05/27/09 LJB E00422 -- Accrual prod pgm can be by customer, if
      *   All Customers = No, see if a customer exists and is Active, els
      * 11/11/09 LJB E00513 -- Condition the write of the commission reco
      *   to Shipping Dtl Accrual from Customer Accrual on the Affect
      *   Commission flag. If No, skip.
      * 03/23/10 PKD E0648 - for db/cr, add accrual processing
      * 04/14/10 RMC C0699 - for db/cm look at add-on allow for accruals
      *    when deciding when to reverse the sign on the accr amt
      * 11/22/11 RMC E1812 - Order Dtl level: added rate types "G " and "
      *   HPB (but anyone can use)  G= % of gross extended : "QT"= $/Qty/
      * E4057 JJH 04/23/15 - Price Credit Memo Fixes
      * - Add I Parm for Attach to Order Number
      * - Rtv Actual Ship Date of Attach to Order Number for Credit
      *   and Debit Memos
      * - Pass in OD Full Return to Plant from Order Detail.  This will
      *   be used to update accurals for selected Flat Amount calculation
      * - Comment out logic for Accrual Rate Type that have never been us
      *   Product  (W ) $/Quantity
      *   Product   (FA) Flat Amount
      *   Customer  (WR) $/LB by Weight Billed
      *   Customer  (QR) $/Quantity by Qty Shipped
      *   Customer  (SR) % ofNetSls by NetSls/Lb
      *   Customer  (SS) % ofNetSls by NetSls/Month
      *   Customer  (FA) Flat Amount
      *   Order Dtl (W ) $/Lb
      *   Order Dtl (WR) $/Lb Weight Billed
      *   Order Dtl (QR) $/Quantity by Qty Shipped
      * - All logic for By Range LST for Accrual Rate Type commented out
      *   because By Range is no longer required.
      * - Remove logic for Invoices only on Customer Accural.  Customer
      *   will now process Invoices, Credit Memos, and Debit Memos.
      * - Correction to allow Flat Load Amount and Invoice to process.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** MAINTENANCE LOG
      *================================================================
      * * 12/02/03 PKD Only calculate accrual if Quantity or Weight is
      * *              not zero.
      * E4057 JJH 04/27/15 - See comments in 3 Maintenance Logs below
      * - RTV Write Accrual Rcd RT - Accrual Program  *
      * - RTV Write Accrual Rcd RT - Customer Accrual  *
      * - RTV Write Accrual Rcd RT - Order Detail Accrual  *
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** MAINTENANCE LOG: Product Program - FROM COPIED FUNCTION
      *================================================================
      * * 07/16/08 PKD E00193 Product Accrual
      * * 12/03/09 PKD FP1322 Added Flat Amount Accrual Rate Type
      * * 3/23/10 PKD E00648 upd accruals for db/cm
      * * 4/14/10 RMC E00648 for db/cm look at addon allow flag
      * *12/15/10 PKD TFS: C1208 If product is not applicable, then do
      *               do not check if Ship To is applicable for the pgm.
      * 06/26/14 PKD E3164 Send in Shipping Method as a parameter
      * E4057 JJH 04/24/14 - Price Credit Memo Fixes
      * - Add I parm for: SDA Atch to Ord ActShpDt
      * - Add I parm for: Affect Sales Doll Status
      * - Add I parm for: Affect Sales Pnds Status
      * - Comment out logic for Affect Trade Fund & Affect Commission
      * - Pass in OD Full Retturn to Plant from Order Detail.  This will
      *   be used to update accurals for selected Flat Amount calculation
      * - Comment out logic for Accrual Rate Type that have never been us
      *   Product  (W ) $/Quantity
      *   Product   (FA) Flat Amount
      * - Use Actual Ship Date from Original Order when determining if
      *   the Accrual should be applied based on the Accrual Date Range
      * - Reset the WRK.Extended Amount to zero for each record
      * - Only create Shipping Detail Accrual records if the Extended
      *   Amount is GT Zero.
      * - Comment Out Accrual Rate Type processing that has never been
      *   used.
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * *----------- MAINTENANCE LOG -----------* FROM COPIED FUNCTION
      *================================================================
      * 07/16/08 PKD E00193 Product Accrual
      * 06/26/14 PKD E3164 add omit criteria for Exclude Collect Truck/Ra
      * E4057 JJH 04/29/15 - Price Credit Memo Fixes
      * - Use Actual Ship Date from Original Order when determining if
      *   the Accrual should be applied based on the Accrual Date Range
      * - Reset the WRK.Extended Amount to zero for each record
      * - Only create Shipping Detail Accrual records if the Extended
      *   Amount is GT Zero.
      * - Comment Out Accrual Rate Type processing that has never been
      *   used.
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * *---------- MAINTENANCE LOG ----------* FROM COPIED FUNCTION
      *================================================================
      * 05/27/09 LJB E00422 Accrual Prod Pgm Cust -
      *   If All Customers = No, see if a customer exists and is active
      * 07/16/08 PKD E00193 Product Accrual
      * E4057 JJH 04/24/14 - Price Credit Memo Fixes
      * - Use Actual Ship Date from Original Order when determining if
      *   the Accrual should be applied based on the Accrual Date Range
      * - Reset the WRK.Extended Amount to zero for each record
      * - Only create Shipping Detail Accrual records if the Extended
      *   Amount is GT Zero.
      * - Comment Out Accrual Rate Type processing that has never been
      *   used.
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * ***** MAINTENANCE LOG: Customer Accrual - FROM COPIED FUNCTION
      *================================================================
      * *---------------------------------------------------------------*
      * * 09/28/00 PKD Added Ship To Customer as a Restrictor Parm.
      * *              Added Scheduled Ship Date as an Input Parm.
      * * 11/10/04 RMC Added par.quantity & weight & extended amt & abs f
      * * 11/10/04 RMC Create Trade Fund Accruals before commission
      * * 08/15/05 RMC Rtv Broker from Cust Ext instead of Order, it may
      * * 05/23/07 RMC DLY029 use broker from customer accrual file
      * * 06/18/07 RMC DLY029 DO COMMISSION ACCRUAL LAST -- ALL OTHERS FI
      * *   so read Cust Accrual in Ship to /Comm sts seq
      * *   Comm Sts = 1 if not commission, and =9 if it is commission
      * * 11/11/09 LJB E00513 Condition commission on Affect Commision fl
      * *   if NO then skip (don't write Shipping Dtl Accrual rec)
      * * 12/03/09 PKD FP1322 Added Flat Amount Accrual Rate Type
      * * 3/23/10 PKD E00648 upd accruals for db/cm
      * * 4/14/10 RMC E00648 for db/cm look at addon allow flag
      * 06/26/14 PKD E3164 Send in Shipping Method as a parameter
      * E4057 JJH 04/24/14
      * - Add I parm for: SDA Atch to Ord ActShpDt
      * - Add I parm for: Affect Sales Doll Status
      * - Add I parm for: Affect Sales Pnds Status
      * - Comment out logic for Affect Trade Fund & Affect Commission
      * - Pass in OD Full Return to Plant from Order Detail.  This will
      *   be used to update accurals for selected Flat Amount calculation
      * - Comment out logic for Accrual Rate Type that have never been us
      *   Customer  (WR) $/LB by Weight Billed
      *   Customer  (QR) $/Quantity by Qty Shipped
      *   Customer  (SR) % ofNetSls by NetSls/Lb
      *   Customer  (SS) % ofNetSls by NetSls/Month
      *   Customer  (FA) Flat Amount
      * - Remove logic for Invoices only on Customer Accural.  Customer
      *   will now process Invoices, Credit Memos, and Debit Memos.
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * ***** MAINTENANCE LOG: Order Detail Accrual - FROM COPIED FUNCTI
      *================================================================
      * *---------------------------------------------------------------*
      * * 10/20/09 PKD Add accrual by Order Detail.
      * * 12/03/09 PKD FP1322 Added Flat Amount Accrual Rate Type
      * * 3/23/10 PKD E00648 upd accruals for db/cm
      * * 4/14/10 RMC E00648 for db/cm look at addon allow flag
      * * 11/22/11 RMC E1812 Added Rate type "G" % of gross extended and
      * *                    Added Rate type "QT" $ per qty/ 1000
      * 06/26/14 PKD E3164 Send in Shipping Method as a parameter
      * E4057 JJH 04/24/14
      * - Add I parm for: SDA Atch to Ord ActShpDt
      * - Add I parm for: Affect Sales Doll Status
      * - Add I parm for: Affect Sales Pnds Status
      * - Comment out logic for Affect Trade Fund & Affect Commission
      * - Pass in OD Full Retturn to Plant from Order Detail.  This will
      *   be used to update accurals for selected Flat Amount calculation
      * - Comment out logic for Accrual Rate Type that have never been us
      *   Order Dtl (W ) $/Lb
      *   Order Dtl (WR) $/Lb Weight Billed
      *   Order Dtl (QR) $/Quantity by Qty Shipped
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3EJVL           Extended Amt To
     C                     Z-ADD*ZERO     P4ETWG           Weight Total 13
     C                     Z-ADD*ZERO     P5BKQT           Quantity Total
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WABKPR           Accrual Rate
     C                     Z-ADD*ZERO     WAC5PC           Accrual Percent
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WADUC7           A/R Customer
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAQRDT           Unused Date
     C                     Z-ADD*ZERO     WAQSDT           Unused Date 2
     C                     Z-ADD*ZERO     WAHBVL           Unused Value 1-
     C                     Z-ADD*ZERO     WAHCVL           Unused Value 2-
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WCGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WEBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WEBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WEBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WEBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WHHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Extended Amount
     C                     Z-ADD*ZERO     WUAYVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIMJDT           Create Date
     C                     Z-ADD*ZERO     WIBETM           Create Time
     C                     Z-ADD*ZERO     WIMKDT           Change Date
     C                     Z-ADD*ZERO     WIBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJMSNY           AD Program Numb
     C                     Z-ADD*ZERO     WJSCDT           AD Period Begin
     C                     Z-ADD*ZERO     WJSDDT           AD Period Endin
     C                     Z-ADD*ZERO     WJO9TX           AD Sub Ledger
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Define work field G/L Code Desc USR
     C                     MOVEL*BLANK    WUIYTX 25
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Accrual Rate Type
     C                     MOVEL*BLANK    WUSHSX  2
      * Define work field Accrual Rate
     C                     Z-ADD*ZERO     WUBKPR  96
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKMSNY           AD Program Numb
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLMSNY           AD Program Numb
     C                     Z-ADD*ZERO     WLBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WLMJDT           Create Date
     C                     Z-ADD*ZERO     WLBETM           Create Time
     C                     Z-ADD*ZERO     WLMKDT           Change Date
     C                     Z-ADD*ZERO     WLBFTM           Change Time
      * Define work field Error Status  2
     C                     MOVEL*BLANK    WUTUST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMDPNB           Order Sequence
     C                     Z-ADD*ZERO     WMUENB           Order Secondary
     C                     Z-ADD*ZERO     WMDXNB           Sequence Number
     C                     Z-ADD*ZERO     WMBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WMSANB           Special Charge
     C                     Z-ADD*ZERO     WMCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Reverse Accrual Code
     C                     MOVEL*BLANK    WUOQCD  3
      * Define work field Error Status  3
     C                     MOVEL*BLANK    WUTXST  1
      * Define work field Accrual Percent
     C                     Z-ADD*ZERO     WUC5PC  52
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WRGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WRBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WRA2DT           Period Ending D
     C                     Z-ADD*ZERO     WRBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WRPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WRPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WRECVL           Comm Min Amt /P
     C                     Z-ADD*ZERO     WRHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTDAT1           Broker G/L Vend
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVAIC3           Company Number
     C                     Z-ADD*ZERO     WVC4NB           Order Number
     C                     Z-ADD*ZERO     WVDPNB           Order Sequence
     C                     Z-ADD*ZERO     WVUENB           Order Secondary
     C                     Z-ADD*ZERO     WVDXNB           Sequence Number
     C                     Z-ADD*ZERO     WVBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WVC5PC           Accrual Percent
     C                     Z-ADD*ZERO     WVAYVA           Extended Amount
     C                     Z-ADD*ZERO     WVEDVL           Item Accrual Am
     C                     Z-ADD*ZERO     WVHGCD           Item Code
     C                     Z-ADD*ZERO     WVBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WVDUC7           A/R Customer
     C                     Z-ADD*ZERO     WVPODT           SDA Actual Ship
     C                     Z-ADD*ZERO     WVBYWG           Weight Billed
     C                     Z-ADD*ZERO     WVPPDT           SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WVPQDT           SDA Atch to Ord
     C                     Z-ADD*ZERO     WVEEVL           SDA Unused Amt
     C                     Z-ADD*ZERO     WVEFVL           SDA Unused Amt
     C                     Z-ADD*ZERO     WVQ8DT           SDA Invoice Dat
     C                     Z-ADD*ZERO     WVH0NY           SDA G/L Sub Led
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WXGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WXHGCD           Item Code
     C                     Z-ADD*ZERO     WXBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WYGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WYRGNB           Item Structure
     C                     Z-ADD*ZERO     WYRHNB           Item Structure
     C                     Z-ADD*ZERO     WYRINB           Item Structure
     C                     Z-ADD*ZERO     WYBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WYFKPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WYFLPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Define work field Total Amount
     C                     Z-ADD*ZERO     WUMFQT 112
      * Define work field *Synon (15,5) work field
     C                     Z-ADD*ZERO     WUWB   155
      * Define work field Absorbed Freight Amount
     C                     Z-ADD*ZERO     WUULVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBAIC3           Company Number
     C                     Z-ADD*ZERO     TBC4NB           Order Number
     C                     Z-ADD*ZERO     TBDPNB           Order Sequence
     C                     Z-ADD*ZERO     TBUENB           Order Secondary
     C                     Z-ADD*ZERO     TBDXNB           Sequence Number
     C                     Z-ADD*ZERO     TBBKPR           Accrual Rate
     C                     Z-ADD*ZERO     TBMJDT           Create Date
     C                     Z-ADD*ZERO     TBBETM           Create Time
     C                     Z-ADD*ZERO     TBMKDT           Change Date
     C                     Z-ADD*ZERO     TBBFTM           Change Time
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SPCRRC.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  96
     C                     Z-ADD*ZERO     WL0017  52
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023 112
     C                     Z-ADD*ZERO     WL0024 112
     C                     MOVEL*BLANK    WL0025  2
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  2
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030 112
     C                     Z-ADD*ZERO     WL0031 112
     C                     MOVEL*BLANK    WL0032  2
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034  6
     C                     MOVEL*BLANK    WL0035 15
     C                     MOVEL*BLANK    WL0036  2
     C                     MOVEL*BLANK    WL0037  2
     C                     MOVEL*BLANK    WL0038  1
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  1
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  60
     C                     MOVEL*BLANK    WL0043 10
     C                     MOVEL*BLANK    WL0044 10
     C                     Z-ADD*ZERO     WL0045  70
     C                     Z-ADD*ZERO     WL0046  60
     C                     MOVEL*BLANK    WL0047 10
     C                     MOVEL*BLANK    WL0048 10
      * Define local variables for subroutine SRRVGN.
     C                     MOVEL*BLANK    WL0049  3
     C                     MOVEL*BLANK    WL0050 30
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     MOVEL*BLANK    WL0053  1
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055  2
     C                     MOVEL*BLANK    WL0056  2
     C                     MOVEL*BLANK    WL0057  3
     C                     MOVEL*BLANK    WL0058  2
     C                     MOVEL*BLANK    WL0059  8
     C                     MOVEL*BLANK    WL0060  8
     C                     MOVEL*BLANK    WL0061  8
     C                     MOVEL*BLANK    WL0062  8
     C                     MOVEL*BLANK    WL0063  1
     C                     MOVEL*BLANK    WL0064  2
     C                     MOVEL*BLANK    WL0065  1
     C                     MOVEL*BLANK    WL0066  1
     C                     MOVEL*BLANK    WL0067  2
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  80
      * Define local variables for subroutine STRVGN.
     C                     MOVEL*BLANK    WL0070  6
     C                     MOVEL*BLANK    WL0071 30
     C                     MOVEL*BLANK    WL0072 30
     C                     MOVEL*BLANK    WL0073 30
     C                     MOVEL*BLANK    WL0074 20
     C                     MOVEL*BLANK    WL0075  2
     C                     MOVEL*BLANK    WL0076 11
     C                     MOVEL*BLANK    WL0077 30
     C                     MOVEL*BLANK    WL0078 25
     C                     MOVEL*BLANK    WL0079 25
     C                     MOVEL*BLANK    WL0080 50
     C                     Z-ADD*ZERO     WL0081  80
     C                     MOVEL*BLANK    WL0082  3
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0083  30
     C                     Z-ADD*ZERO     WL0084  70
     C                     MOVEL*BLANK    WL0085  3
     C                     MOVEL*BLANK    WL0086  1
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  3
     C                     Z-ADD*ZERO     WL0089  50
     C                     Z-ADD*ZERO     WL0090  70
     C                     Z-ADD*ZERO     WL0091  96
     C                     MOVEL*BLANK    WL0092  2
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0093  70
     C                     MOVEL*BLANK    WL0094  3
     C                     Z-ADD*ZERO     WL0095  50
     C                     Z-ADD*ZERO     WL0096  30
     C                     Z-ADD*ZERO     WL0097  30
     C                     Z-ADD*ZERO     WL0098  30
     C                     Z-ADD*ZERO     WL0099  96
     C                     MOVEL*BLANK    WL0100  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0001  2
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0003 15
      * Define local work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YL0004  6
      * Define local work field EDI Cust Duns Number
     C                     MOVEL*BLANK    YL0005 20
      * Define local work field SDA Atch to Ord ActShpDt
     C                     Z-ADD*ZERO     YL0006  70
      * Define null work field G/L Account Category
     C                     MOVEL*BLANK    YN0002  3
      * Define local work field APE Excl Collect ShpMthd
     C                     MOVEL*BLANK    YL0007  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0003  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0008  1
      * Define null work field G/L Account Category
     C                     MOVEL*BLANK    YN0004  3
      * Define local work field APE Excl Collect ShpMthd
     C                     MOVEL*BLANK    YL0009  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0005  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Broker Name
     C                     MOVEL*BLANK    YL0011 30
      * Define local work field Broker Address Line 1
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field Broker Address Line 2
     C                     MOVEL*BLANK    YL0013 30
      * Define local work field Broker City
     C                     MOVEL*BLANK    YL0014 20
      * Define local work field Broker State
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field Broker Zip
     C                     MOVEL*BLANK    YL0016 11
      * Define local work field Broker Office Manager
     C                     MOVEL*BLANK    YL0017 30
      * Define local work field Broker Telephone Number
     C                     MOVEL*BLANK    YL0018 25
      * Define local work field Broker Fax Number
     C                     MOVEL*BLANK    YL0019 25
      * Define local work field Broker Email Address
     C                     MOVEL*BLANK    YL0020 50
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0021  3
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field unused status 2
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field unused status 3
     C                     MOVEL*BLANK    YL0024  1
      * Define null work field G/L Account Category
     C                     MOVEL*BLANK    YN0006  3
      * Define local work field APE Excl Collect ShpMthd
     C                     MOVEL*BLANK    YL0025  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0007  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field Broker Code
     C                     MOVEL*BLANK    YL0027  6
      * Define local work field unused status 2
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field unused status 3
     C                     MOVEL*BLANK    YL0029  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 APP855ACRL
00002 CA855ACRL
00003 ODA855ACRL
