     H/TITLE BLD BPS Consumed Itm  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/27/12  Time  : 11:25:38
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDIOREL6IF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      *
     FPDIORELGIF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Itm/Typ/RmO/CPty/CItm
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     E                    YK01      100 22  A            ARR BPS Consume
      *
     I@IOREGB
      * Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      * Renamed input format fields
     I              IOAIC3                          WAAIC3
     I              IOHGCD                          WAHGCD
     I              IOC9NB                          WAC9NB
     I              IOV2ST                          WAV2ST
     I              IOBOPR                          WABOPR
     I              IOBPPR                          WABPPR
     I              IOHGQT                          WAHGQT
     I              IOHHCD                          WAHHCD
     I              IOYAST                          WAYAST
     I              IOCNSM                          WACNSM
     I              IOBMY1                          WABMY1
     I              IOBMY2                          WABMY2
     I              IOIXQT                          WAIXQT
     I              IOIYQT                          WAIYQT
     I              IORSST                          WARSST
     I              IORTST                          WARTST
     I              IOUVST                          WAUVST
     I              IOUWST                          WAUWST
     I              IOUXST                          WAUXST
     I              IOVSST                          WAVSST
     I              IOAATM                          WAAATM
     I              IOAYNA                          WAAYNA
     I              IOA0NA                          WAA0NA
     I              IOAXDT                          WAAXDT
      *
     I@IORETB
      * Item Bill Of Material     Co/Itm/Typ/RmO/CPty/CItm
      * Renamed input format fields
     I              IOAIC3                          WBAIC3
     I              IOHGCD                          WBHGCD
     I              IOC9NB                          WBC9NB
     I              IOV2ST                          WBV2ST
     I              IOBOPR                          WBBOPR
     I              IOBPPR                          WBBPPR
     I              IOHGQT                          WBHGQT
     I              IOHHCD                          WBHHCD
     I              IOYAST                          WBYAST
     I              IOCNSM                          WBCNSM
     I              IOBMY1                          WBBMY1
     I              IOBMY2                          WBBMY2
     I              IOIXQT                          WBIXQT
     I              IOIYQT                          WBIYQT
     I              IORSST                          WBRSST
     I              IORTST                          WBRTST
     I              IOUVST                          WBUVST
     I              IOUWST                          WBUWST
     I              IOUXST                          WBUXST
     I              IOVSST                          WBVSST
     I              IOAATM                          WBAATM
     I              IOAYNA                          WBAYNA
     I              IOA0NA                          WBA0NA
     I              IOAXDT                          WBAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WEAIC3
     I              BZHGCD                          WEHGCD
     I              BZAVNA                          WEAVNA
     I              BZAWNA                          WEAWNA
     I              BZL7NA                          WEL7NA
     I              BZL8NA                          WEL8NA
     I              BZL6NA                          WEL6NA
     I              BZMFNA                          WEMFNA
     I              BZADCD                          WEADCD
     I              BZAWPC                          WEAWPC
     I              BZLXST                          WELXST
     I              BZAECD                          WEAECD
     I              BZAXPC                          WEAXPC
     I              BZLYST                          WELYST
     I              BZAFCD                          WEAFCD
     I              BZAICD                          WEAICD
     I              BZAIWG                          WEAIWG
     I              BZHICD                          WEHICD
     I              BZRBCD                          WERBCD
     I              BZFZST                          WEFZST
     I              BZAVST                          WEAVST
     I              BZCZWG                          WECZWG
     I              BZC0WG                          WEC0WG
     I              BZURTN                          WEURTN
     I              BZAJC8                          WEAJC8
     I              BZRINB                          WERINB
     I              BZRHNB                          WERHNB
     I              BZRGNB                          WERGNB
     I              BZLNCD                          WELNCD
     I              BZTFNB                          WETFNB
     I              BZN0CD                          WEN0CD
     I              BZX4ST                          WEX4ST
     I              BZTMVA                          WETMVA
     I              BZTNVA                          WETNVA
     I              BZBLPR                          WEBLPR
     I              BZBMPR                          WEBMPR
     I              BZLRCD                          WELRCD
     I              BZU9ST                          WEU9ST
     I              BZCMCO                          WECMCO
     I              BZQ1CD                          WEQ1CD
     I              BZQ8CD                          WEQ8CD
     I              BZCHTM                          WECHTM
     I              BZQZCD                          WEQZCD
     I              BZXWST                          WEXWST
     I              BZXXST                          WEXXST
     I              BZVMST                          WEVMST
     I              BZSWGH                          WESWGH
     I              BZPPHE                          WEPPHE
     I              BZR3CD                          WER3CD
     I              BZSDCD                          WESDCD
     I              BZICN1                          WEICN1
     I              BZSVCD                          WESVCD
     I              BZICN2                          WEICN2
     I              BZSWCD                          WESWCD
     I              BZV2NB                          WEV2NB
     I              BZSXCD                          WESXCD
     I              BZITCN                          WEITCN
     I              BZSYCD                          WESYCD
     I              BZITC5                          WEITC5
     I              BZSZCD                          WESZCD
     I              BZICN6                          WEICN6
     I              BZS0CD                          WES0CD
     I              BZICN7                          WEICN7
     I              BZS1CD                          WES1CD
     I              BZICN8                          WEICN8
     I              BZS2CD                          WES2CD
     I              BZICN9                          WEICN9
     I              BZS3CD                          WES3CD
     I              BZICN0                          WEICN0
     I              BZS4CD                          WES4CD
     I              BZSFNB                          WESFNB
     I              BZA3WG                          WEA3WG
     I              BZSJNB                          WESJNB
     I              BZLLCD                          WELLCD
     I              BZLMCD                          WELMCD
     I              BZP3ST                          WEP3ST
     I              BZSKNB                          WESKNB
     I              BZSLNB                          WESLNB
     I              BZSMNB                          WESMNB
     I              BZP4ST                          WEP4ST
     I              BZCFNB                          WECFNB
     I              BZCGNB                          WECGNB
     I              BZILNB                          WEILNB
     I              BZCHNB                          WECHNB
     I              BZCINB                          WECINB
     I              BZCJNB                          WECJNB
     I              BZCMNB                          WECMNB
     I              BZCNNB                          WECNNB
     I              BZCRNB                          WECRNB
     I              BZCSNB                          WECSNB
     I              BZCVNB                          WECVNB
     I              BZCWNB                          WECWNB
     I              BZCXNB                          WECXNB
     I              BZCZNB                          WECZNB
     I              BZC0NB                          WEC0NB
     I              BZN1CD                          WEN1CD
     I              BZB4NB                          WEB4NB
     I              BZB5NB                          WEB5NB
     I              BZX5ST                          WEX5ST
     I              BZX6ST                          WEX6ST
     I              BZX7ST                          WEX7ST
     I              BZPCCT                          WEPCCT
     I              BZBDNB                          WEBDNB
     I              BZBJNB                          WEBJNB
     I              BZSUST                          WESUST
     I              BZSVST                          WESVST
     I              BZSYST                          WESYST
     I              BZSZST                          WESZST
     I              BZS1ST                          WES1ST
     I              BZXRCD                          WEXRCD
     I              BZXTCD                          WEXTCD
     I              BZXUCD                          WEXUCD
     I              BZF5WG                          WEF5WG
     I              BZF6WG                          WEF6WG
     I              BZF7WG                          WEF7WG
     I              BZBLNB                          WEBLNB
     I              BZBNNB                          WEBNNB
     I              BZS2ST                          WES2ST
     I              BZS4ST                          WES4ST
     I              BZS5ST                          WES5ST
     I              BZS6ST                          WES6ST
     I              BZS8ST                          WES8ST
     I              BZS9ST                          WES9ST
     I              BZTCST                          WETCST
     I              BZTDST                          WETDST
     I              BZUVST                          WEUVST
     I              BZUWST                          WEUWST
     I              BZUXST                          WEUXST
     I              BZVSST                          WEVSST
     I              BZAATM                          WEAATM
     I              BZAYNA                          WEAYNA
     I              BZA0NA                          WEA0NA
     I              BZAXDT                          WEAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADBWC3                          WFBWC3
     I              ADBTC3                          WFBTC3
     I              ADBUC3                          WFBUC3
     I              ADBVC3                          WFBVC3
     I              ADFCAA                          WFFCAA
     I              ADRQSX                          WFRQSX
     I              ADRRSX                          WFRRSX
     I              ADRSSX                          WFRSSX
     I              ADRTSX                          WFRTSX
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADRNSX                          WFRNSX
     I              ADROSX                          WFROSX
     I              ADRPSX                          WFRPSX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WGAIC3
     I              I8V5ST                          WGV5ST
     I              I8ELDT                          WGELDT
     I              I8HGCD                          WGHGCD
     I              I8AJCD                          WGAJCD
     I              I8GPDT                          WGGPDT
     I              I8WTSP                          WGWTSP
     I              I8QTSP                          WGQTSP
     I              I8DJPC                          WGDJPC
     I              I8F8WG                          WGF8WG
     I              I8WTIN                          WGWTIN
     I              I8D5NB                          WGD5NB
     I              I8DXWG                          WGDXWG
     I              I8B2NB                          WGB2NB
     I              I8WTCN                          WGWTCN
     I              I8PSCV                          WGPSCV
     I              I8SAWT                          WGSAWT
     I              I8B9NB                          WGB9NB
     I              I8D1WG                          WGD1WG
     I              I8CBNB                          WGCBNB
     I              I8EZWG                          WGEZWG
     I              I8CCNB                          WGCCNB
     I              I8E0WG                          WGE0WG
     I              I8D6NB                          WGD6NB
     I              I8OAWT                          WGOAWT
     I              I8CDNB                          WGCDNB
     I              I8UNW2                          WGUNW2
     I              I8CENB                          WGCENB
     I              I8F9WG                          WGF9WG
     I              I8BPNB                          WGBPNB
     I              I8GAWG                          WGGAWG
     I              I8BQNB                          WGBQNB
     I              I8GBWG                          WGGBWG
     I              I8BRNB                          WGBRNB
     I              I8GCWG                          WGGCWG
     I              I8BSNB                          WGBSNB
     I              I8GDWG                          WGGDWG
     I              I8BWNB                          WGBWNB
     I              I8GEWG                          WGGEWG
     I              I8PS6U                          WGPS6U
     I              I8WCST                          WGWCST
     I              I8WPST                          WGWPST
     I              I8B5ST                          WGB5ST
     I              I8TFST                          WGTFST
     I              I8TEST                          WGTEST
     I              I8THST                          WGTHST
     I              I8UDST                          WGUDST
     I              I8UFST                          WGUFST
     I              I8UGST                          WGUGST
     I              I8UHST                          WGUHST
     I              I8B6ST                          WGB6ST
     I              I8B7ST                          WGB7ST
     I              I8DVWG                          WGDVWG
     I              I8D7NB                          WGD7NB
     I              I8FCAD                          WGFCAD
     I              I8D9NB                          WGD9NB
     I              I8DWWG                          WGDWWG
     I              I8EANB                          WGEANB
     I              I8SHWT                          WGSHWT
     I              I8EBNB                          WGEBNB
     I              I8AVWT                          WGAVWT
     I              I8ECNB                          WGECNB
     I              I8WTON                          WGWTON
     I              I8EDNB                          WGEDNB
     I              I8FNWT                          WGFNWT
     I              I8EENB                          WGEENB
     I              I8QTAS                          WGQTAS
     I              I8EFNB                          WGEFNB
     I              I8WAIO                          WGWAIO
     I              I8EGNB                          WGEGNB
     I              I8R3CD                          WGR3CD
     I              I8RGNB                          WGRGNB
     I              I8RHNB                          WGRHNB
     I              I8RINB                          WGRINB
     I              I8XRCD                          WGXRCD
     I              I8UVST                          WGUVST
     I              I8UWST                          WGUWST
     I              I8UXST                          WGUXST
     I              I8VSST                          WGVSST
     I              I8AATM                          WGAATM
     I              I8AYNA                          WGAYNA
     I              I8A0NA                          WGA0NA
     I              I8AXDT                          WGAXDT
      *
     I@I8CPXP
      * PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      * Renamed input format fields
     I              I8AIC3                          WHAIC3
     I              I8V5ST                          WHV5ST
     I              I8ELDT                          WHELDT
     I              I8HGCD                          WHHGCD
     I              I8AJCD                          WHAJCD
     I              I8GPDT                          WHGPDT
     I              I8WTSP                          WHWTSP
     I              I8QTSP                          WHQTSP
     I              I8DJPC                          WHDJPC
     I              I8F8WG                          WHF8WG
     I              I8WTIN                          WHWTIN
     I              I8D5NB                          WHD5NB
     I              I8DXWG                          WHDXWG
     I              I8B2NB                          WHB2NB
     I              I8WTCN                          WHWTCN
     I              I8PSCV                          WHPSCV
     I              I8SAWT                          WHSAWT
     I              I8B9NB                          WHB9NB
     I              I8D1WG                          WHD1WG
     I              I8CBNB                          WHCBNB
     I              I8EZWG                          WHEZWG
     I              I8CCNB                          WHCCNB
     I              I8E0WG                          WHE0WG
     I              I8D6NB                          WHD6NB
     I              I8OAWT                          WHOAWT
     I              I8CDNB                          WHCDNB
     I              I8UNW2                          WHUNW2
     I              I8CENB                          WHCENB
     I              I8F9WG                          WHF9WG
     I              I8BPNB                          WHBPNB
     I              I8GAWG                          WHGAWG
     I              I8BQNB                          WHBQNB
     I              I8GBWG                          WHGBWG
     I              I8BRNB                          WHBRNB
     I              I8GCWG                          WHGCWG
     I              I8BSNB                          WHBSNB
     I              I8GDWG                          WHGDWG
     I              I8BWNB                          WHBWNB
     I              I8GEWG                          WHGEWG
     I              I8PS6U                          WHPS6U
     I              I8WCST                          WHWCST
     I              I8WPST                          WHWPST
     I              I8B5ST                          WHB5ST
     I              I8TFST                          WHTFST
     I              I8TEST                          WHTEST
     I              I8THST                          WHTHST
     I              I8UDST                          WHUDST
     I              I8UFST                          WHUFST
     I              I8UGST                          WHUGST
     I              I8UHST                          WHUHST
     I              I8B6ST                          WHB6ST
     I              I8B7ST                          WHB7ST
     I              I8DVWG                          WHDVWG
     I              I8D7NB                          WHD7NB
     I              I8FCAD                          WHFCAD
     I              I8D9NB                          WHD9NB
     I              I8DWWG                          WHDWWG
     I              I8EANB                          WHEANB
     I              I8SHWT                          WHSHWT
     I              I8EBNB                          WHEBNB
     I              I8AVWT                          WHAVWT
     I              I8ECNB                          WHECNB
     I              I8WTON                          WHWTON
     I              I8EDNB                          WHEDNB
     I              I8FNWT                          WHFNWT
     I              I8EENB                          WHEENB
     I              I8QTAS                          WHQTAS
     I              I8EFNB                          WHEFNB
     I              I8WAIO                          WHWAIO
     I              I8EGNB                          WHEGNB
     I              I8R3CD                          WHR3CD
     I              I8RGNB                          WHRGNB
     I              I8RHNB                          WHRHNB
     I              I8RINB                          WHRINB
     I              I8XRCD                          WHXRCD
     I              I8UVST                          WHUVST
     I              I8UWST                          WHUWST
     I              I8UXST                          WHUXST
     I              I8VSST                          WHVSST
     I              I8AATM                          WHAATM
     I              I8AYNA                          WHAYNA
     I              I8A0NA                          WHA0NA
     I              I8AXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IYD01        DS
     I                                        1   30YI0101
     I                                        4  100YI0102
     I                                       11  170YI0103
     I                                       18  220YI01
      *
     IYM01        DS                        100
     I                                        1   30WCAIC3
     I                                        4  100WCHGCD
     I                                       11  170WCC9NB
     I                                       18  220WCCNSM
     I                                       23  272WCBMY1
     I                                       28  382WCD0WG
     I                                       39  450WCPIAL
     I                                       46  542WCE7WG
     I                                       55  610WCAVPS
     I                                       62  662WCGTPC
      *
     IYW01        DS
     I                                        1   30XAAIC3
     I                                        4  100XAHGCD
     I                                       11  170XAC9NB
     I                                       18  220XACNSM
     I                                       23  272XABMY1
     I                                       28  382XAD0WG
     I                                       39  450XAPIAL
     I                                       46  542XAE7WG
     I                                       55  610XAAVPS
     I                                       62  662XAGTPC
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Bill Of Material
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
     IP2PARM      DS
      * B :  Weight Need USR
     I                                    P   1   62P2GYWG
     IP3PARM      DS
      * B :  Pieces Need USR
     I                                    P   1   40P3E3NB
     IP4PARM      DS
      * I :  Piece Count Item
     I                                        1   1 P4PCCT
     IP5PARM      DS
      * FLD: *Arrays
      * I :  Warehouse Code
     I                                        1   3 P5AJCD
      * I :  Production Date
     I                                    P   4   70P5ELDT
      * I :  Production Type
     I                                        8   8 P5V5ST
      * I :  PS Avg Piece Wgt
     I                                    P   9  132P5F8WG
     IP6PARM      DS
      * O :  Percent Available for ord
     I                                    P   1   32P6GTPC
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P2GYWG    PARM P2GYWG    WP0003 112       Weight Need USR
     C           P3E3NB    PARM P3E3NB    WP0004  70       Pieces Need USR
     C           P4PCCT    PARM           WP0005  1        Piece Count Ite
     C           P5AJCD    PARM           WP0006  3        Warehouse Code
     C           P5ELDT    PARM           WP0007  70       Production Date
     C           P5V5ST    PARM           WP0008  1        Production Type
     C           P5F8WG    PARM           WP0009  92       PS Avg Piece Wg
     C           P6GTPC    PARM P6GTPC    WP0010  52       Percent Availab
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BLD BPS Consumed Itm  XF
      * Are the BOM consumed items an AND or an OR condition?
      *  AND : the consume priority is 1 on all consumed items.
      *         all of the consumed items must be available to sched the
      *         The (consmd pty%)  * (the weight needed) must be avail
      *  OR  : the consume priority is different on all consumed items.
      *         Consumption is taken per the consmd pty% * weight needed
      *         The last consmd item should have 100%, so the remaining
      *         weight needed will come from this item
      * Rtv Consmd Itm AND/OR RT - Item Bill Of Material  * 
     C                     EXSR SARVGN
      * *** IF consumed priority is 1, then perform AND condition process
      * Consume Priority = 1
      * CASE: LCL.Consume Priority is EQ 1
     C           YL0001    IFEQ 1                          *IF
      * 1. Build array with consumed items and the RM lbs that are needed
      *    from this consumed item to fill the need, based on its consmed
      * 2. Calc whats avail from each consumed item in lbs or pieces  &
      *   set AvailNeed% = (avail per item) / (RM need per item)
      * BLD BPS Consumed Itm  RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1HGCD    WL0002           Item Code
     C                     Z-ADDP2GYWG    WL0003           Weight Need USR
     C                     Z-ADDP3E3NB    WL0004           Pieces Need USR
     C                     MOVELP4PCCT    WL0005    P      Piece Count Ite
     C                     MOVELP5AJCD    WL0006    P      Warehouse Code
     C                     Z-ADDP5ELDT    WL0007           Production Date
     C                     MOVELP5V5ST    WL0008    P      Production Type
     C                     EXSR SBRVGN
      * 3. The lowest AvailNeed% * (rm wt need) = new adjusted need weigh
      * Rtv BPS Lowest % AvailRT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP1HGCD    WL0010           Item Code
     C                     Z-ADDYL0010    WL0011           Percent Availab
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    YL0010           Percent Availab
      * CASE: LCL.Percent Available for ord is GT 0
     C           YL0010    IFGT *ZERO                      *IF
      * Compute: new weight need
      * PAR.Weight Need USR =
      *    *COMPUTE (x1 *(x2/x3))
      * x1    : PAR.Weight Need USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : LCL.Percent Available for ord
      * /     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           YL0010    DIV  100       W0WB01           *Synon (15,5) w
     C           P2GYWG    MULT W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    P2GYWG           Weight Need USR
      * CASE: PAR.Piece Count Item is yes
     C           P4PCCT    IFEQ 'Y'                        *IF
      * Compute: new pieces need
      * PAR.Pieces Need USR =
      *    *COMPUTE (x1 *(x2/x3))
      * x1    : PAR.Pieces Need USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : LCL.Percent Available for ord
      * /     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           YL0010    DIV  100       W0WB01           *Synon (15,5) w
     C           P3E3NB    MULT W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    P3E3NB           Pieces Need USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     P2GYWG           Weight Need USR
     C                     Z-ADD*ZERO     P3E3NB           Pieces Need USR
     C                     END                             *FI
     C                     Z-ADDYL0010    P6GTPC           Percent Availab
     C                     END                             *FI
      * *** IF consumed priority is 1,2,3.. then perform OR condition pro
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Consmd Itm AND/OR RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0001           Consume Priorit
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSA02           Item Code
     C           *LIKE     DEFN WAV2ST    WQSA03           BOM Type
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Item Code
     C                     KFLD           WQSA03           BOM Type
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1HGCD    WQSA02           Item Code
     C                     MOVEL'C'       WQSA03           BOM Type
      * Establish starting position
     C           KRSSA     SETLL@IOREGB                    *
     C           KRSSA     READE@IOREGB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     YL0001           Consume Priorit
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Consume Priority is NE Zero
     C           WACNSM    IFNE *ZERO                      *IF
      * CASE: DB1.Consume Priority GT PAR.Consume Priority
     C           WACNSM    IFGT YL0001                     *IF
     C                     Z-ADDWACNSM    YL0001           Consume Priorit
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@IOREGB                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * BLD BPS Consumed Itm  RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  52       Consume Priorit
     C                     Z-ADD*ZERO     WN0002 112       Unit Weight
     C                     Z-ADD*ZERO     WN0003  70       Pieces Per Head
     C                     Z-ADD*ZERO     WN0004  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0005  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0006  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0007  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0008 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0009  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0010  92       PS Avg Piece Wg
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Clr BPS Consumed Itm  DL - *Arrays  * 
     C                     EXSR SCDLRC
     C                     MOVEL'Y'       YL0002           First Time Flag
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SDRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
      * Setup key
     C                     Z-ADDWL0001    WQSB01           Company Number
     C                     Z-ADDWL0002    WQSB02           Item Code
      * Establish starting position
     C           KRSSB     SETLL@IORETB                    *
     C           KRSSB     READE@IORETB                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT: BPS Consumed Item Allc array for Active items Only
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Record Status is Active
      *   |- c2    : DB1.Consume Priority % is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBVSST    IFEQ 'A'                        *IF
     C           WBBMY1    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Calc weight of consumed item needed to fill the order based on co
      * Compute: weight need p/it
      * LCL.Weight Ordered =
      *    *COMPUTE (x1*(x2/x3))
      * x1    : PAR.Weight Need USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : DB1.Consume Priority %
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WBBMY1    DIV  100       W0WD01           *Synon (17,7) w
     C           WL0003    MULT W0WD01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0005           Weight Ordered
      *  if piece count
      * CASE: PAR.Piece Count Item is yes
     C           WL0005    IFEQ 'Y'                        *IF
      * Compute: pieces need p/it
      * LCL.Pieces Ordered =
      *    *COMPUTE (x1*(x2/x3))
      * x1    : PAR.Pieces Need USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : DB1.Consume Priority %
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WBBMY1    DIV  100       W0WD01           *Synon (17,7) w
     C           WL0004    MULT W0WD01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0006           Pieces Ordered
     C                     END                             *FI
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0011 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
     C                     EXSR SERVGN
      * BPS Rtv Whs Info      RT - Warehouse  * 
     C                     EXSR SFRVGN
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chilling Time
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDWUDBNB    WN0007           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCHTM    WN0007           Chilling Time U
     C                     END                             *FI
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
     C                     EXSR SGRVGN
      * make sure weight avail isnt > rm needed
      * CASE: PAR.ATS Weight Available USR GT LCL.Weight Ordered
     C           WN0008    IFGT YL0005                     *IF
     C                     Z-ADDYL0005    WN0008           ATS Weight Avai
     C                     END                             *FI
      * make sure pieces avail isnt > rm needed
      * CASE: PAR.ATS Pieces Available USR GT LCL.Pieces Ordered
     C           WN0009    IFGT YL0006                     *IF
     C                     Z-ADDYL0006    WN0009           ATS Pieces Avai
     C                     END                             *FI
      * CASE: PAR.Piece Count Item is yes
     C           WL0005    IFEQ 'Y'                        *IF
      * CASE: PAR.ATS Pieces Available USR is GT Zero
     C           WN0009    IFGT *ZERO                      *IF
      * Compute: pct avail
      * LCL.Percent Available for ord =
      *    *COMPUTE ((x1/ x2)*x3)
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,5) work field *
      * x2    : LCL.Pieces Ordered
      * *     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           WN0009    DIV  YL0006    W0WB01           *Synon (15,5) w
     C           W0WB01    MULT 100       W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0007           Percent Availab
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.ATS Weight Available USR is Greater than zero
     C           WN0008    IFGT *ZERO                      *IF
      * Compute: pct avail
      * LCL.Percent Available for ord =
      *    *COMPUTE ((x1/ x2)*x3)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,5) work field *
      * x2    : LCL.Weight Ordered
      * *     : PGM.*Synon (15,5) work field *
      * x3    : CON.100
     C           WN0008    DIV  YL0005    W0WB01           *Synon (15,5) w
     C           W0WB01    MULT 100       W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0007           Percent Availab
     C                     END                             *FI
     C                     END                             *FI
      * BPS Consumed Itm Allc RT - *Arrays  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C           KRSSB     READE@IORETB                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * Clr BPS Consumed Itm  DL - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0006    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Production Ware
     C                     Z-ADD*ZERO     YL0004           Accounting Comp
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDAOCD    YL0003           Production Ware
     C                     Z-ADDWDBTC3    YL0004           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADDWBAIC3    WEAIC3           Company Number
     C                     Z-ADDWBC9NB    WEHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUADCD           U/M - Primary
     C                     Z-ADD*ZERO     WN0002           Unit Weight
     C                     Z-ADD*ZERO     WURINB           Item Structure
     C                     Z-ADD*ZERO     WURHNB           Item Structure
     C                     Z-ADD*ZERO     WURGNB           Item Structure
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     MOVEL*BLANK    WUQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    WUXWST           Variety/Rendere
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     Z-ADD*ZERO     WUSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WN0003           Pieces Per Head
     C                     MOVEL*BLANK    WUR3CD           Department Code
     C                     MOVEL*BLANK    WUSDCD           Group for Packa
     C                     MOVEL*BLANK    WUX5ST           Seconds Item
     C                     MOVEL*BLANK    WN0006           Piece Count Ite
     C                     Z-ADD*ZERO     WN0004           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0005           Bags Per Unit
     C                     MOVEL*BLANK    WUSUST           Export/Domestic
     C                     MOVEL*BLANK    WUSVST           Print On Schedu
     C                     MOVEL*BLANK    WUSYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    WUSZST           Fresh Sched As
     C                     MOVEL*BLANK    WUS1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    WUXRCD           Primal Group Co
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAVNA    WUAVNA           Description Lin
     C                     MOVELWEADCD    WUADCD           U/M - Primary
     C                     Z-ADDWEAIWG    WN0002           Unit Weight
     C                     Z-ADDWERINB    WURINB           Item Structure
     C                     Z-ADDWERHNB    WURHNB           Item Structure
     C                     Z-ADDWERGNB    WURGNB           Item Structure
     C                     MOVELWEN0CD    WUN0CD           Item Type Code
     C                     MOVELWEQ1CD    WUQ1CD           Default Warehou
     C                     Z-ADDWECHTM    WUCHTM           Fresh Chilling
     C                     MOVELWEQZCD    WUQZCD           Base/Conv/Loss
     C                     MOVELWEXWST    WUXWST           Variety/Rendere
     C                     MOVELWEVMST    WUVMST           Credit Item Sta
     C                     Z-ADDWESWGH    WUSWGH           Std Weight/Head
     C                     Z-ADDWEPPHE    WN0003           Pieces Per Head
     C                     MOVELWER3CD    WUR3CD           Department Code
     C                     MOVELWESDCD    WUSDCD           Group for Packa
     C                     MOVELWEX5ST    WUX5ST           Seconds Item
     C                     MOVELWEPCCT    WN0006           Piece Count Ite
     C                     Z-ADDWEBDNB    WN0004           Pieces Per Bag
     C                     Z-ADDWEBJNB    WN0005           Bags Per Unit
     C                     MOVELWESUST    WUSUST           Export/Domestic
     C                     MOVELWESVST    WUSVST           Print On Schedu
     C                     MOVELWESYST    WUSYST           Fresh Inv Alloc
     C                     MOVELWESZST    WUSZST           Fresh Sched As
     C                     MOVELWES1ST    WUS1ST           Frozen Inv Allo
     C                     MOVELWEXRCD    WUXRCD           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0003    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWPST           Warehouse Type
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL*BLANK    WUT0ST           Warehouse Locat
     C                     MOVEL*BLANK    WUT1ST           Warehouse Std C
     C                     Z-ADD*ZERO     WUDBNB           Warehouse Chill
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFWPST    WUWPST           Warehouse Type
     C                     MOVELWFXUST    WUXUST           Trans Contol AS
     C                     MOVELWFT0ST    WUT0ST           Warehouse Locat
     C                     MOVELWFT1ST    WUT1ST           Warehouse Std C
     C                     Z-ADDWFDBNB    WUDBNB           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0012  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0013  70       PS Pieces Ship
     C                     MOVEL*BLANK    WN0014  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0015  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0016  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0017  92       Weight Producti
     C                     Z-ADD*ZERO     WN0018  70       Pieces Producti
     C                     Z-ADD*ZERO     WN0019 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0020 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0021  70       Pieces Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0010           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0012           PS Weight Ship
     C                     Z-ADD*ZERO     WN0013           PS Pieces Ship
     C                     Z-ADD*ZERO     WN0008           ATS Weight Avai
     C                     Z-ADD*ZERO     WN0009           ATS Pieces Avai
     C                     MOVEL*BLANK    WN0014           Piece Count Ite
     C                     Z-ADD*ZERO     WN0015           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0016           Bags Per Unit
     C                     Z-ADD*ZERO     WN0017           Weight Producti
     C                     Z-ADD*ZERO     WN0018           Pieces Producti
     C                     Z-ADD*ZERO     WN0019           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0020           OD Weight Sched
     C                     Z-ADD*ZERO     WN0021           Pieces Allocate
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV5ST           Production Type
     C                     KFLD           WGELDT           Production Date
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDYL0004    WGAIC3           Company Number
     C                     MOVELWL0008    WGV5ST           Production Type
     C                     Z-ADDWL0007    WGELDT           Production Date
     C                     Z-ADDWBC9NB    WGHGCD           Item Code
     C                     MOVELYL0003    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * so calc is: Production = Planned Prod + Standard + Prod Adj - Con
      *  instead of:
      * Production = Standard + Prod Adj - Converted
      * Prod Avail = Production + Ship Cut Adj + Ship Adj - Prod Alloc
      * CASE: DB1.PS Lock Status is NOT LOCKED
     C           WGB5ST    IFEQ 'N'                        *IF
      * Ship Cut Adjust
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Chilling Time USR is GT Zero
      *   |- c2    : DB1.Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0007    IFGT *ZERO                      *IF
     C           WGELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Weight Planned Prod
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whse Tfr Adj
     C           WGWTSP    ADD  WGDXWG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WGD1WG    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WGWTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WGGAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0017           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Pieces Planned Prod
      * +     : PGM.*Synon (15,0) work field
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whse Tfr Adj
     C           WGQTSP    ADD  WGB2NB    W0WJ03           *Synon (15,0) w
     C           W0WJ03    ADD  WGCBNB    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WGPSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WGBPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0018           Pieces Producti
      * Weight Available
      * PAR.ATS Weight Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Weight Production USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Shipping Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Prod Allocated
     C           WN0017    ADD  WN0012    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WGSAWT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WGOAWT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0008           ATS Weight Avai
      * Pieces Available
      * PAR.ATS Pieces Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Pieces Production USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * +     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Shipping Adj
      * -     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Prod Allocated
     C           WN0018    ADD  WN0013    W0WJ02           *Synon (15,0) w
     C           W0WJ02    ADD  WGB9NB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WGCDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0009           ATS Pieces Avai
      * Weight Avail E1971 RMC   2/27/12 change to leave pieces if > 0
      * CASE: PAR.ATS Weight Available USR is Less than zero
     C           WN0008    IFLT *ZERO                      *IF
      * CASE: PAR.ATS Pieces Available USR is LE Zero
     C           WN0009    IFLE *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0008           ATS Weight Avai
     C                     Z-ADD*ZERO     WN0009           ATS Pieces Avai
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWGF8WG    WN0010           PS Avg Piece Wg
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHHGCD    WQSH02           Item Code
     C           *LIKE     DEFN WHAJCD    WQSH03           Warehouse Code
     C           *LIKE     DEFN WHELDT    WQSH04           Production Date
     C           *LIKE     DEFN WHV5ST    WQSH05           Production Type
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Item Code
     C                     KFLD           WQSH03           Warehouse Code
     C                     KFLD           WQSH04           Production Date
     C                     KFLD           WQSH05           Production Type
      * Setup key
     C                     Z-ADDWGAIC3    WQSH01           Company Number
     C                     Z-ADDWGHGCD    WQSH02           Item Code
     C                     MOVELWGAJCD    WQSH03           Warehouse Code
     C                     Z-ADDWGGPDT    WQSH04           Production Date
     C                     MOVEL'P'       WQSH05           Production Type
      * Establish starting position
     C           KRSSH     SETLL@I8CPXP                    *
     C           KRSSH     READE@I8CPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0012           PS Weight Ship
     C                     Z-ADD*ZERO     WN0013           PS Pieces Ship
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHE0WG    WN0012           PS Weight Ship
     C                     Z-ADDWHD6NB    WN0013           PS Pieces Ship
     C           KRSSH     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * BPS Consumed Itm Allc RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to ARR BPS Consumed Itm Allc
     C                     Z-ADDWBAIC3    YI0101           Company Number
     C                     Z-ADDWBHGCD    YI0102           Item Code
     C                     Z-ADDWBC9NB    YI0103           Component Item
      *
      *
      *
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE WBAIC3
     C           YI0102    ORNE WBHGCD
     C           YI0103    ORNE WBC9NB
      *
      *
      *
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
      * USER: Processing if Data record not found
      * Crt BPS Consumed Itm  CR - *Arrays  * 
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt BPS Consumed Itm  CR - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL01      IFEQ 100
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     Z-ADD*ZERO     XAAIC3           Company Number
     C                     Z-ADD*ZERO     XAHGCD           Item Code
     C                     Z-ADD*ZERO     XAC9NB           Component Item
     C                     Z-ADD*ZERO     XACNSM           Consume Priorit
     C                     Z-ADD*ZERO     XABMY1           Consume Priorit
     C                     Z-ADD*ZERO     XAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     XAPIAL           Pieces Ordered
     C                     Z-ADD*ZERO     XAE7WG           Weight Availabl
     C                     Z-ADD*ZERO     XAAVPS           Pieces Avail Pr
     C                     Z-ADD*ZERO     XAGTPC           Percent Availab
      * Move all fields to ARR BPS Consumed Itm Allc
     C                     Z-ADDWBAIC3    XAAIC3           Company Number
     C                     Z-ADDWBHGCD    XAHGCD           Item Code
     C                     Z-ADDWBC9NB    XAC9NB           Component Item
     C                     Z-ADDWBCNSM    XACNSM           Consume Priorit
     C                     Z-ADDWBBMY1    XABMY1           Consume Priorit
     C                     Z-ADDYL0008    XAD0WG           Weight Ordered
     C                     Z-ADDYL0009    XAPIAL           Pieces Ordered
     C                     Z-ADDWN0008    XAE7WG           Weight Availabl
     C                     Z-ADDWN0009    XAAVPS           Pieces Avail Pr
     C                     Z-ADDYL0007    XAGTPC           Percent Availab
      *
      * Move key fields to ARR BPS Consumed Itm Allc
     C                     Z-ADDXAAIC3    YI0101           Company Number
     C                     Z-ADDXAHGCD    YI0102           Item Code
     C                     Z-ADDXAC9NB    YI0103           Component Item
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFEQ XAAIC3
     C           YI0102    ANDEQXAHGCD
     C           YI0103    ANDEQXAC9NB
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL01      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK01,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK01,Y    YD01
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI01
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to ARR BPS Consumed Itm Allc
     C                     Z-ADDXAAIC3    YI0101           Company Number
     C                     Z-ADDXAHGCD    YI0102           Item Code
     C                     Z-ADDXAC9NB    YI0103           Component Item
      *
     C                     MOVELYD01      YK01,Y
     C           YI01      OCUR YM01
      * Update MODS fields
     C                     Z-ADDXAAIC3    WCAIC3           Company Number
     C                     Z-ADDXAHGCD    WCHGCD           Item Code
     C                     Z-ADDXAC9NB    WCC9NB           Component Item
     C                     Z-ADDXACNSM    WCCNSM           Consume Priorit
     C                     Z-ADDXABMY1    WCBMY1           Consume Priorit
     C                     Z-ADDXAD0WG    WCD0WG           Weight Ordered
     C                     Z-ADDXAPIAL    WCPIAL           Pieces Ordered
     C                     Z-ADDXAE7WG    WCE7WG           Weight Availabl
     C                     Z-ADDXAAVPS    WCAVPS           Pieces Avail Pr
     C                     Z-ADDXAGTPC    WCGTPC           Percent Availab
      * Only sort if element is out of position
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE100
     C           YK01,YR01 ANDGTYD01
     C                     ADD  1         YR01    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK01
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL01
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv BPS Lowest % AvailRT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD100       WL0011           Percent Availab
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to ARR BPS Consumed Itm Allc
     C                     Z-ADDWL0009    YI0101           Company Number
     C                     Z-ADDWL0010    YI0102           Item Code
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE WL0009
     C           YI0102    ORNE WL0010
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
      * Sequence through qualified elements:
     C                     Z-ADDY         YR01    50
     C           YR01      DOWLEYL01
     C           YI0101    ANDEQWL0009
     C           YI0102    ANDEQWL0010
      *
     C           YI01      OCUR YM01
      * USER: Process Data record
      * CASE: DB1.Percent Available for ord LT PAR.Percent Available for
     C           WCGTPC    IFLT WL0011                     *IF
     C                     Z-ADDWCGTPC    WL0011           Percent Availab
     C                     END                             *FI
     C                     ADD  1         YR01
     C           YR01      IFLE 100
     C                     Z-ADDYR01      Y
     C                     MOVELYK01,Y    YD01
     C                     ENDIF
     C                     ENDDO
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAC9NB           Component Item
     C                     Z-ADD*ZERO     WABOPR           Sales Yield
     C                     Z-ADD*ZERO     WABPPR           Production Yiel
     C                     Z-ADD*ZERO     WAHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WACNSM           Consume Priorit
     C                     Z-ADD*ZERO     WABMY1           Consume Priorit
     C                     Z-ADD*ZERO     WABMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WAIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WAIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01    50
     C                     Z-ADD1         Y       50
     C                     ENDIF
      *
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WDBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field PS Item Id
     C                     MOVEL*BLANK    WUWCST  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAIWG           Unit Weight
     C                     Z-ADD*ZERO     WECZWG           Minimum Weight
     C                     Z-ADD*ZERO     WEC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WEURTN           Number Cases On
     C                     Z-ADD*ZERO     WEAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WETFNB           Transportation
     C                     Z-ADD*ZERO     WETMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WETNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WEBLPR           Market Overage
     C                     Z-ADD*ZERO     WEBMPR           Standard Overag
     C                     Z-ADD*ZERO     WECMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WECHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WESWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WEPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WEICN1           Item Category N
     C                     Z-ADD*ZERO     WEICN2           Item Category N
     C                     Z-ADD*ZERO     WEV2NB           Item Category N
     C                     Z-ADD*ZERO     WEITCN           Item Category N
     C                     Z-ADD*ZERO     WEITC5           Item Category N
     C                     Z-ADD*ZERO     WEICN6           Item Category N
     C                     Z-ADD*ZERO     WEICN7           Item Category N
     C                     Z-ADD*ZERO     WEICN8           Item Category N
     C                     Z-ADD*ZERO     WEICN9           Item Category N
     C                     Z-ADD*ZERO     WEICN0           Item Category N
     C                     Z-ADD*ZERO     WESFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WEA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WESJNB           Production Lead
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WECFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WECGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WEILNB           Packages per ca
     C                     Z-ADD*ZERO     WECHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WECINB           PM Batch Size
     C                     Z-ADD*ZERO     WECJNB           Package Level s
     C                     Z-ADD*ZERO     WECMNB           Partial Item Co
     C                     Z-ADD*ZERO     WECNNB           WIP Item Code
     C                     Z-ADD*ZERO     WECRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WECSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WECVNB           FP Std Green We
     C                     Z-ADD*ZERO     WECWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WECXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WECZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WEC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WEB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WEBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WEF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WEF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WEF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WEBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WEBNNB           Production Qty
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WGWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WGQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WGDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WGF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WGWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WGD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WGDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WGB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WGWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WGPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WGSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WGB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WGD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WGCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WGEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WGCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WGE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WGD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WGOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WGCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WGUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WGCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WGF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WGBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WGGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WGBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WGD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WGFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WGD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WGDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WGEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WGSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WGEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WGECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WGWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WGEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WGFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WGEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WGQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WGEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WGEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ03 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003 112
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  3
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  52
      * Define local work field Consume Priority
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field Pieces Ordered
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Percent Available for ord
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field Pieces Ordered
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Percent Available for ord
     C                     Z-ADD*ZERO     YL0010  52
      *================================================================
     CSR         ZZEXIT    ENDSR
