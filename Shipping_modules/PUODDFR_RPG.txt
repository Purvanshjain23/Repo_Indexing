     H/TITLE WW Cust Orders ASN 856 DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 03/12/25  Time  : 03:39:26
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUODDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Cust Orders ASN 856 DF Display file
      *
     FOPBFCPLOIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FPNGQREL1IF  E           K        DISK
      * RTV : EDI Bill To Interchange   Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FPMAMRELMIF  E           K        DISK
      * RSQ : Order Header Extension    Load/Co/Order
      *
     FOPBFCPM2IF  E           K        DISK
      * RSQ : Order Header TRG          Load/BTC#/Co/Order
      *
     FECP140L2IF  E           K        DISK
      * RSQ : EDI Adv Ship Ntc Dtl V2   Order/
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPMAMREL0UF  E           K        DISK
      * UPD : Order Header Extension    Update index
      *
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@AMREL3
      * Order Header Extension    Load/Co/Order
      * Renamed input format fields
     I              AMAIC3                          WCAIC3
     I              AMC4NB                          WCC4NB
     I              AMRMNB                          WCRMNB
     I              AMRUNB                          WCRUNB
     I              AMXACD                          WCXACD
     I              AMOANA                          WCOANA
     I              AMHBAA                          WCHBAA
     I              AMJ0T1                          WCJ0T1
     I              AMGENY                          WCGENY
     I              AMJ1T1                          WCJ1T1
     I              AMHCAA                          WCHCAA
     I              AMQWDT                          WCQWDT
     I              AMQXDT                          WCQXDT
     I              AMQYDT                          WCQYDT
     I              AMHDAA                          WCHDAA
     I              AMCCTX                          WCCCTX
     I              AMJ2T1                          WCJ2T1
     I              AMRLNA                          WCRLNA
     I              AMRMNA                          WCRMNA
     I              AMGINY                          WCGINY
     I              AMGFNY                          WCGFNY
     I              AMGGNY                          WCGGNY
     I              AMGHNY                          WCGHNY
     I              AMHEVL                          WCHEVL
     I              AMHFVL                          WCHFVL
     I              AMHGVL                          WCHGVL
     I              AMQZDT                          WCQZDT
     I              AMQ0DT                          WCQ0DT
     I              AMQ1DT                          WCQ1DT
     I              AMQ2DT                          WCQ2DT
     I              AMC2TX                          WCC2TX
     I              AMC3TX                          WCC3TX
     I              AMC6TX                          WCC6TX
     I              AMCHTX                          WCCHTX
     I              AMCITX                          WCCITX
     I              AMCLTX                          WCCLTX
     I              AMB4TX                          WCB4TX
     I              AMCUTX                          WCCUTX
     I              AMCVTX                          WCCVTX
     I              AMB9TX                          WCB9TX
     I              AMJWSC                          WCJWSC
     I              AMITNY                          WCITNY
     I              AMLMT1                          WCLMT1
     I              AMLWAA                          WCLWAA
     I              AMFVST                          WCFVST
     I              AMF0ST                          WCF0ST
     I              AMF2ST                          WCF2ST
     I              AMF3ST                          WCF3ST
     I              AMJUSC                          WCJUSC
     I              AMJVSC                          WCJVSC
     I              AMV3T1                          WCV3T1
     I              AMV4T1                          WCV4T1
     I              AMV5T1                          WCV5T1
     I              AMV6T1                          WCV6T1
     I              AMV7T1                          WCV7T1
     I              AMV8T1                          WCV8T1
     I              AMV9T1                          WCV9T1
     I              AMWAT1                          WCWAT1
     I              AMWBT1                          WCWBT1
     I              AMWCT1                          WCWCT1
     I              AMWDT1                          WCWDT1
     I              AMQJNY                          WCQJNY
     I              AMQKNY                          WCQKNY
     I              AMQLNY                          WCQLNY
     I              AMP8NY                          WCP8NY
     I              AMP9NY                          WCP9NY
     I              AMQANY                          WCQANY
     I              AMQCNY                          WCQCNY
     I              AMQDNY                          WCQDNY
     I              AMQENY                          WCQENY
     I              AMQFNY                          WCQFNY
     I              AMQGNY                          WCQGNY
     I              AMQHNY                          WCQHNY
     I              AMQINY                          WCQINY
     I              AMQMNY                          WCQMNY
     I              AMMYU1                          WCMYU1
     I              AMJXSC                          WCJXSC
     I              AMJYSC                          WCJYSC
     I              AMJZSC                          WCJZSC
     I              AMJ0SC                          WCJ0SC
     I              AMMZU1                          WCMZU1
     I              AMM0U1                          WCM0U1
     I              AMM1U1                          WCM1U1
     I              AMM2U1                          WCM2U1
     I              AMM3U1                          WCM3U1
     I              AMW5DT                          WCW5DT
     I              AMW6DT                          WCW6DT
     I              AMUVST                          WCUVST
     I              AMUWST                          WCUWST
     I              AMUXST                          WCUXST
     I              AMVSST                          WCVSST
     I              AMAATM                          WCAATM
     I              AMAYNA                          WCAYNA
     I              AMA0NA                          WCA0NA
     I              AMAXDT                          WCAXDT
      *
     I@BFCPHX
      * Order Header TRG          Load/BTC#/Co/Order
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WEAIC3
     I              AMC4NB                          WEC4NB
     I              AMRMNB                          WERMNB
     I              AMRUNB                          WERUNB
     I              AMXACD                          WEXACD
     I              AMOANA                          WEOANA
     I              AMHBAA                          WEHBAA
     I              AMJ0T1                          WEJ0T1
     I              AMGENY                          WEGENY
     I              AMJ1T1                          WEJ1T1
     I              AMHCAA                          WEHCAA
     I              AMQWDT                          WEQWDT
     I              AMQXDT                          WEQXDT
     I              AMQYDT                          WEQYDT
     I              AMHDAA                          WEHDAA
     I              AMCCTX                          WECCTX
     I              AMJ2T1                          WEJ2T1
     I              AMRLNA                          WERLNA
     I              AMRMNA                          WERMNA
     I              AMGINY                          WEGINY
     I              AMGFNY                          WEGFNY
     I              AMGGNY                          WEGGNY
     I              AMGHNY                          WEGHNY
     I              AMHEVL                          WEHEVL
     I              AMHFVL                          WEHFVL
     I              AMHGVL                          WEHGVL
     I              AMQZDT                          WEQZDT
     I              AMQ0DT                          WEQ0DT
     I              AMQ1DT                          WEQ1DT
     I              AMQ2DT                          WEQ2DT
     I              AMC2TX                          WEC2TX
     I              AMC3TX                          WEC3TX
     I              AMC6TX                          WEC6TX
     I              AMCHTX                          WECHTX
     I              AMCITX                          WECITX
     I              AMCLTX                          WECLTX
     I              AMB4TX                          WEB4TX
     I              AMCUTX                          WECUTX
     I              AMCVTX                          WECVTX
     I              AMB9TX                          WEB9TX
     I              AMJWSC                          WEJWSC
     I              AMITNY                          WEITNY
     I              AMLMT1                          WELMT1
     I              AMLWAA                          WELWAA
     I              AMFVST                          WEFVST
     I              AMF0ST                          WEF0ST
     I              AMF2ST                          WEF2ST
     I              AMF3ST                          WEF3ST
     I              AMJUSC                          WEJUSC
     I              AMJVSC                          WEJVSC
     I              AMV3T1                          WEV3T1
     I              AMV4T1                          WEV4T1
     I              AMV5T1                          WEV5T1
     I              AMV6T1                          WEV6T1
     I              AMV7T1                          WEV7T1
     I              AMV8T1                          WEV8T1
     I              AMV9T1                          WEV9T1
     I              AMWAT1                          WEWAT1
     I              AMWBT1                          WEWBT1
     I              AMWCT1                          WEWCT1
     I              AMWDT1                          WEWDT1
     I              AMQJNY                          WEQJNY
     I              AMQKNY                          WEQKNY
     I              AMQLNY                          WEQLNY
     I              AMP8NY                          WEP8NY
     I              AMP9NY                          WEP9NY
     I              AMQANY                          WEQANY
     I              AMQCNY                          WEQCNY
     I              AMQDNY                          WEQDNY
     I              AMQENY                          WEQENY
     I              AMQFNY                          WEQFNY
     I              AMQGNY                          WEQGNY
     I              AMQHNY                          WEQHNY
     I              AMQINY                          WEQINY
     I              AMQMNY                          WEQMNY
     I              AMMYU1                          WEMYU1
     I              AMJXSC                          WEJXSC
     I              AMJYSC                          WEJYSC
     I              AMJZSC                          WEJZSC
     I              AMJ0SC                          WEJ0SC
     I              AMMZU1                          WEMZU1
     I              AMM0U1                          WEM0U1
     I              AMM1U1                          WEM1U1
     I              AMM2U1                          WEM2U1
     I              AMM3U1                          WEM3U1
     I              AMW5DT                          WEW5DT
     I              AMW6DT                          WEW6DT
     I              AMUVST                          WEUVST
     I              AMUWST                          WEUWST
     I              AMUXST                          WEUXST
     I              AMVSST                          WEVSST
     I              AMAATM                          WEAATM
     I              AMAYNA                          WEAYNA
     I              AMA0NA                          WEA0NA
     I              AMAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WEAIC3
     I              AMC4NB                          WEC4NB
     I              AMRMNB                          WERMNB
     I              AMRUNB                          WERUNB
     I              AMXACD                          WEXACD
     I              AMOANA                          WEOANA
     I              AMHBAA                          WEHBAA
     I              AMJ0T1                          WEJ0T1
     I              AMGENY                          WEGENY
     I              AMJ1T1                          WEJ1T1
     I              AMHCAA                          WEHCAA
     I              AMQWDT                          WEQWDT
     I              AMQXDT                          WEQXDT
     I              AMQYDT                          WEQYDT
     I              AMHDAA                          WEHDAA
     I              AMCCTX                          WECCTX
     I              AMJ2T1                          WEJ2T1
     I              AMRLNA                          WERLNA
     I              AMRMNA                          WERMNA
     I              AMGINY                          WEGINY
     I              AMGFNY                          WEGFNY
     I              AMGGNY                          WEGGNY
     I              AMGHNY                          WEGHNY
     I              AMHEVL                          WEHEVL
     I              AMHFVL                          WEHFVL
     I              AMHGVL                          WEHGVL
     I              AMQZDT                          WEQZDT
     I              AMQ0DT                          WEQ0DT
     I              AMQ1DT                          WEQ1DT
     I              AMQ2DT                          WEQ2DT
     I              AMC2TX                          WEC2TX
     I              AMC3TX                          WEC3TX
     I              AMC6TX                          WEC6TX
     I              AMCHTX                          WECHTX
     I              AMCITX                          WECITX
     I              AMCLTX                          WECLTX
     I              AMB4TX                          WEB4TX
     I              AMCUTX                          WECUTX
     I              AMCVTX                          WECVTX
     I              AMB9TX                          WEB9TX
     I              AMJWSC                          WEJWSC
     I              AMITNY                          WEITNY
     I              AMLMT1                          WELMT1
     I              AMLWAA                          WELWAA
     I              AMFVST                          WEFVST
     I              AMF0ST                          WEF0ST
     I              AMF2ST                          WEF2ST
     I              AMF3ST                          WEF3ST
     I              AMJUSC                          WEJUSC
     I              AMJVSC                          WEJVSC
     I              AMV3T1                          WEV3T1
     I              AMV4T1                          WEV4T1
     I              AMV5T1                          WEV5T1
     I              AMV6T1                          WEV6T1
     I              AMV7T1                          WEV7T1
     I              AMV8T1                          WEV8T1
     I              AMV9T1                          WEV9T1
     I              AMWAT1                          WEWAT1
     I              AMWBT1                          WEWBT1
     I              AMWCT1                          WEWCT1
     I              AMWDT1                          WEWDT1
     I              AMQJNY                          WEQJNY
     I              AMQKNY                          WEQKNY
     I              AMQLNY                          WEQLNY
     I              AMP8NY                          WEP8NY
     I              AMP9NY                          WEP9NY
     I              AMQANY                          WEQANY
     I              AMQCNY                          WEQCNY
     I              AMQDNY                          WEQDNY
     I              AMQENY                          WEQENY
     I              AMQFNY                          WEQFNY
     I              AMQGNY                          WEQGNY
     I              AMQHNY                          WEQHNY
     I              AMQINY                          WEQINY
     I              AMQMNY                          WEQMNY
     I              AMMYU1                          WEMYU1
     I              AMJXSC                          WEJXSC
     I              AMJYSC                          WEJYSC
     I              AMJZSC                          WEJZSC
     I              AMJ0SC                          WEJ0SC
     I              AMMZU1                          WEMZU1
     I              AMM0U1                          WEM0U1
     I              AMM1U1                          WEM1U1
     I              AMM2U1                          WEM2U1
     I              AMM3U1                          WEM3U1
     I              AMW5DT                          WEW5DT
     I              AMW6DT                          WEW6DT
     I              AMUVST                          WEUVST
     I              AMUWST                          WEUWST
     I              AMUXST                          WEUXST
     I              AMVSST                          WEVSST
     I              AMAATM                          WEAATM
     I              AMAYNA                          WEAYNA
     I              AMA0NA                          WEA0NA
     I              AMAXDT                          WEAXDT
      *
     IYARDCS      DS                            894
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Description
     I                                        1  25 P1G3TX
      * N : MAP PRT Printer Device
     I                                       26  35 P1WRST
      * N : MAP PRT Hold Output Sts
     I                                       36  39 P1WSST
      * N : MAP PRT Save Output Sts
     I                                       40  43 P1WTST
      * N : MAP PRT Night Queue Run Sts
     I                                       44  44 P1WUST
      * N : MAP PRT Night Queue
     I                                       45  54 P1BVVN
      * N : MAP System Value Numeric
     I                                    P  55  625P1M8NB
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  Salesperson Code
     I                                       10  12 P2BCCD
      * N :  Allow Multi_Company
     I                                       13  13 P2I6ST
      * N :  Default Printer
     I                                       14  23 P2MPNA
     IP3PARM      DS
      * FLD: Order Header TRG
      * N : MAP Company Number
     I                                    P   1   20P3AIC3
      * N : MAP Order Type_Sales
     I                                        3   4 P3JNCD
      * N : MAP Actual Shipped Date
     I                                    P   5   80P3GNDT
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Generic Message 80 NBR'
      * Generic Message 80 USR
     I                                        1  80 ZA0001
      * @Numeric 15.2
     I                                    P  81  882ZA0002
      * Message data for 'Generic Message 80 NBR'
      * Generic Message 80 USR
     I                                        1  80 ZA0003
      * @Numeric 15.2
     I                                    P  81  882ZA0004
      * Message data for 'Load has Unshipped Orders'
      * Load ID
     I                                    P   1   40ZA0005
      * Message data for 'Generic Message 80 NBR'
      * Generic Message 80 USR
     I                                        1  80 ZA0006
      * @Numeric 15.2
     I                                    P  81  882ZA0007
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0008
      * Application Code
     I                                       11  16 ZA0009
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0010
      * Application Code
     I                                       11  16 ZA0011
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     MOVEL#CVPCD    YL0002           Ship From Wareh
     C                     MOVEL#2GWST    YL0003           Header Status
     C                     Z-ADD#2RMNB    YL0004           Load ID
     C                     MOVEL#2BCNA    YL0005           Customer Purcha
     C                     MOVEL#CPKST    YL0006           Load Status
     C                     Z-ADD#2AODT    YL0007           Scheduled Ship
     C                     Z-ADD#2GNDT    YL0008           Actual Shipped
     C                     Z-ADD#2BKC7    YL0009           Ship To Custome
     C                     MOVEL#CQDU1    YL0010           Ship To Name (1
     C                     MOVEL#CJUSC    YL0011           OHE EDI 856 Act
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEC4NB           Order Number
     C                     KFLD           BEAIC3           Company Number
      * Setup key
     C           #2C4NB    IFEQ *ZERO
     C                     MOVEL*HIVAL    BEC4NB           Order Number
     C                     ELSE
     C                     Z-ADD#2C4NB    BEC4NB
     C                     ENDIF
     C                     Z-ADD#2AIC3    BEAIC3
     C           KPOS      SETLL@BFCPY2
     C                     READ @BFCPY2                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type_Sale
     C           *LIKE     DEFN #2BRTX    WZBRTX
     C                     MOVEL#2BRTX    WZBRTX           Ship To Name
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2BCNA    WZBCNA
     C                     MOVEL#2BCNA    WZBCNA           Customer Purcha
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2GNDT    WZGNDT
     C                     MOVEL#2GNDT    WZGNDT           Actual Shipped
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2BCNA    WQBCNA           Customer Purcha
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 15        WQA5N   50
     C                     PARM #2BCNA    WQBCNA           Customer Purcha
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPY2                  90*
     C  N82                READ @BFCPY2                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,43
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2JNCD    IFNE *BLANK                     Order Type_Sale
     C           BEJNCD    CABNE#2JNCD    BB020            Order Type_Sale
     C                     END
     C           #2C4NB    IFEQ *ZERO                      Order Number
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           BEAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C                     END
     C           #2GWST    IFNE *BLANK                     Header Status
     C           BEGWST    CABNE#2GWST    BB020            Header Status
     C                     END
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           BERMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C           #2BCNA    IFNE *BLANK                     Customer Purcha
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           BEBCNA           Customer Purcha
      * Length
     C                     PARM 15        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQBCNA
      * Length
     C                     PARM 15        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABNE1         BB020
     C                     END
     C           #2AODT    IFNE *ZERO                      Scheduled Ship
     C           BEAODT    CABNE#2AODT    BB020            Scheduled Ship
     C                     END
     C           #2GNDT    IFNE *ZERO                      Actual Shipped
     C           BEGNDT    CABNE#2GNDT    BB020            Actual Shipped
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Select Only Regular Orders 'OR'.
      * CASE: DB1.Order Type - Sales is Regular Order
     C           BEJNCD    IFEQ 'OR'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select Only Confirmed 'R' or Invoiced 'C' Orders.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: RCD.Header Status is Confirmed & Complete
     C           #1GWST    IFEQ 'C'                        *IF
     C           #1GWST    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select Customer Setup for EDI 856 & Warehouse Live w/Carlisle & I
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Val Cust Setup 4/856 V2IF
      * VALIDATIONS: Is Bill To Customer Setup for EDI 856 ASN V2?
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0012           Create EDI ASN
      * RTV EDI ASN 856 Info  RT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1B0C7    WL0001           Bill to Custome
     C                     MOVEL'ADVSN'   WL0002    P      Interchange Cod
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YN0001    P      EDI Trading Par
     C                     MOVELWL0004    YL0013    P      EDI Detailed AS
     C                     MOVELWL0005    YL0014    P      Record Status
      * Do Not Check Customer & Warehouse if Coming From PDN2XFR Program.
      * CASE: *OTHERWISE
      * Bill To Customer Must Be Active & Setup for EDI 856.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.EDI Detailed ASN 856 Rqd is Yes
      *   |- c2    : LCL.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0013    IFEQ 'Y'                        *IF
     C           YL0014    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0012           Create EDI ASN
     C                     END                             *FI
      * WI609_2 Check Internal or External Warehouse Qualifies for 856 AS
      * CASE: PAR.Create EDI ASN 856 V2 USR is Yes
     C           YL0012    IFEQ 'Y'                        *IF
      * RTV 1st Whse/Country   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0006           Company Number
     C                     Z-ADD#1C4NB    WL0007           Order Number
     C                     Z-ADD1         WL0008           Order Sequence
     C                     Z-ADD1         WL0009           Order Secondary
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YL0015    P      Warehouse Code
     C                     MOVELWL0011    YN0002    P      Country Code
      * Rtv EDI 856 ASN Info RT - Warehouse Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0015    WL0012    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0016    P      Warehouse Locat
     C                     MOVELWL0014    YL0017    P      WHS Live with C
     C                     MOVELWL0015    YN0004    P      WHS PFS Interfa
     C                     MOVELWL0016    YL0018    P      Crt 856 ASN for
     C                     MOVELYL0016    YN0003           Warehouse Locat
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Warehouse Location is Internal (Plant)
      *   |- c2    : LCL.WHS Live w/Carlisle is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0016    IFEQ 'I'                        *IF
     C           YL0017    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0012           Create EDI ASN
     C                     MOVELYL0015    #RVPCD           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0012           Create EDI ASN
      * WI609_2 JM 10/08/24-Allow External 3PL Warehouses to Receive EDI
      * CASE: LCL.Warehouse Location is External
     C           YL0016    IFEQ 'E'                        *IF
      * CASE: LCL.Crt 856 ASN for 3PL Whse is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0012           Create EDI ASN
     C                     MOVELYL0015    #RVPCD           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * WI609_2 JM 10/08/24-Check EDI Manual PO.
      * CASE: PAR.Create EDI ASN 856 V2 USR is Yes
     C           YL0012    IFEQ 'Y'                        *IF
      * Rtv EDI Manual PO Sts XF - EDI Bill To Interchange  * ADVSN
     C                     CALL 'PUTBXFR'              90  Rtv EDI Manual
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0001  30       Company Number
     C                     PARM #1C4NB    WQ0002  70       Order Number
     C                     PARM 'ADVSN'   WQ0003  6        Interchange Cod
     C           YL0019    PARM *BLANK    WQ0004  1        Send EDI Docume
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * If Send EDI Documents = N, set Create EDI ASN 856 V2 USR = N
      * CASE: LCL.Send EDI Document Y/N is No
     C           YL0019    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0012           Create EDI ASN
     C                     END                             *FI
     C                     END                             *FI
      * Customer Not Setup For EDI 856 ASN, Do Not Select.
      * CASE: LCL.Create EDI ASN 856 V2 USR is No
     C           YL0012    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Get/Set EDI 856/824 Status Info.
      * CASE: *OTHERWISE
      * RTV EDI 856/824 OHE StsRT - Order Header Extension  * 
     C                     EXSR SDRVGN
      * Set EDI 856 Action Desc.
      * CASE: RCD.OHE EDI 856 Action is Blanks
     C           #RJUSC    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #RNXU1           EDI 856 Action
     C                     ELSE
      * CASE: *OTHERWISE
      * RCD.EDI 856 Action Dsc USR = Condition name of RCD.OHE EDI 856 Ac
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2176915   Y2LSNO  70       List number
     C                     PARM #RJUSC    W0INVL 25        OHE EDI 856 Act
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #RNXU1    PARM           W0CNNM 25        EDI 856 Action
      *
     C                     END                             *FI
      * Set EDI Error Reason Desc.
      * CASE: RCD.OHE EDI Error Reasons 2 is Blank
     C           #RJWSC    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #RHMTX           Condition Desc.
     C                     ELSE
      * CASE: *OTHERWISE
      * RCD.Condition Desc. 2  USR = Condition name of RCD.OHE EDI Error
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 2177064   Y2LSNO  70       List number
     C                     PARM #RJWSC    W0INVL 25        OHE EDI Error R
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #RHMTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
      * Select by User Defined Selectors.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Select By Ship From Warehouse.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Ship From Warehouse is Blanks
      *   |- c2    : CTL.Ship From Warehouse EQ RCD.Ship From Warehouse
      *   '-
     C           #CVPCD    IFEQ *BLANK                     *IF
     C           #CVPCD    OREQ #RVPCD                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Header Status.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Header Status is *None
      *   |- c2    : CTL.Header Status EQ RCD.Header Status
      *   '-
     C           #2GWST    IFEQ *BLANK                     *IF
     C           #2GWST    OREQ #1GWST                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Ship to customer
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Ship To Customer is equal to zero
      *   |- c2    : CTL.Ship To Customer EQ RCD.Ship To Customer
      *   '-
     C           #2BKC7    IFEQ *ZERO                      *IF
     C           #2BKC7    OREQ #1BKC7                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select by Customer Name.                      R17040 DN 02/25/21
      * CASE: CTL.Ship To Name (15A) USR NE WRK.BLANK
     C           #CQDU1    IFNE WUGSTX                     *IF
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEA#CQDU1    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       #CQDU1           LOAD OUTPUT
      * CLC Call Qclscan       UP - /UT User Source  * 
     C                     CALL 'QCLSCAN'              90  CLC Call Qclsca
     C                     PARM #1BRTX    WQ0005256        USR Qclscan fie
     C                     PARM 30        WQ0006  30       USR Qclscan Len
     C                     PARM 1         WQ0007  30       USR Qclscan Sta
     C                     PARM #CQDU1    WQ0008256        USR Qclscan Mas
     C                     PARM 15        WQ0009  30       USR Qclscan Mas
     C                     PARM '1'       WQ0010  1        USR Qclscan Tra
     C                     PARM '1'       WQ0011  1        USR Qclscan Tri
     C                     PARM *BLANK    WQ0012  1        USR Qclscan Wil
     C           WUY8NB    PARM WUY8NB    WQ0013  30       USR Qclscan Res
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'QCLSCAN' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9838  *
     C                     END
      * CASE: WRK.USR Qclscan Result ? is Does contain
     C           WUY8NB    IFGT 0                          *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select By Load ID.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Load ID is Blank
      *   |- c2    : CTL.Load ID EQ RCD.Load ID
      *   '-
     C           #2RMNB    IFEQ *ZERO                      *IF
     C           #2RMNB    OREQ #1RMNB                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Scheduled Ship Date.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Scheduled Ship Date is not entered
      *   |- c2    : CTL.Scheduled Ship Date EQ RCD.Scheduled Ship Date
      *   '-
     C           #2AODT    IFEQ *ZERO                      *IF
     C           #2AODT    OREQ #1AODT                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Actual Shipped Date.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Actual Shipped Date is not entered
      *   |- c2    : CTL.Actual Shipped Date EQ RCD.Actual Shipped Date
      *   '-
     C           #2GNDT    IFEQ *ZERO                      *IF
     C           #2GNDT    OREQ #1GNDT                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select By Load Status.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Load Status 2      RT - Load Header  * 
     C                     EXSR SERVGN
      * Select By Load Status.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Load Status is *Blank
      *   |- c2    : CTL.Load Status EQ RCD.Load Status
      *   '-
     C           #CPKST    IFEQ *BLANK                     *IF
     C           #CPKST    OREQ #RPKST                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select By EDI 856 Action Status.              R17040 DN 02/26/21
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.OHE EDI 856 Action is Blanks
      *   |- c2    : CTL.OHE EDI 856 Action EQ RCD.OHE EDI 856 Action
      *   '-
     C           #CJUSC    IFEQ *BLANK                     *IF
     C           #CJUSC    OREQ #RJUSC                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Sum Quantity & Populate Other Screen Data.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Sum Qty Ord/Ship   RT - Order Detail  * 
     C                     EXSR SFRVGN
      * Get Other Info.
      * CASE: *OTHERWISE
      * R17040 DN 02/26/21-Commented Out & Moved 856/824 Logic Above.
      * RTV Departure DT/TM   RT - Load Header  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPY2                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Header Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2GWST    W0NSRQ  1        Header Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2GWST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1160607   Y2LSNO  70
     C           #2GWST    PARM #2GWST    W0EXVL 25        Header Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Load Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CPKST    W0NSRQ  1        Load Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CPKST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70
     C           #CPKST    PARM #CPKST    W0EXVL 25        Load Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Actual Shipped Date
      * External date
     C                     Z-ADDV2GNDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     Z-ADDXDINDT    #2GNDT
      * Validate OHE EDI 856 Action
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CJUSC'  IFEQ YPMTFD
      * OHE EDI 856 Action
     C                     MOVEL#CJUSC    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFJUSC
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFJUSC
     C           W0INVL    WHEQ 'H'                        H
     C                     Z-ADD2         ZFJUSC
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZFJUSC
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD4         ZFJUSC
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD5         ZFJUSC
     C                     ENDSL
     C                     EXFMTZEJUSC
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFJUSC    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFJUSC    WHEQ 2
     C                     MOVEL'H'       W0INVL           H
     C           ZFJUSC    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZFJUSC    WHEQ 4
     C                     MOVEL'E'       W0INVL           E
     C           ZFJUSC    WHEQ 5
     C                     MOVEL'X'       W0INVL           X
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CJUSC
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZGWST    CASNE#2GWST    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C           WZBCNA    CASNE#2BCNA    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZGNDT    CASNE#2GNDT    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10
      *   |- c1    : CTL.Ship From Warehouse NE LCL.Ship From Warehouse
      *   |- c2    : CTL.Load ID NE LCL.Load ID
      *   |- c3    : CTL.Scheduled Ship Date NE LCL.Scheduled Ship Date
      *   |- c4    : CTL.Header Status NE LCL.Header Status
      *   |- c5    : CTL.Load Status NE LCL.Load Status
      *   |- c6    : CTL.Actual Shipped Date NE LCL.Actual Shipped Date
      *   |- c7    : CTL.Ship To Customer NE LCL.Ship To Customer
      *   |- c8    : CTL.Customer Purchase Order # NE LCL.Customer Purcha
      *   |- c9    : CTL.Ship To Name (15A) USR NE LCL.Ship To Name (15A)
      *   |- c10   : CTL.OHE EDI 856 Action NE LCL.OHE EDI 856 Action
      *   '-
     C           #CVPCD    IFNE YL0002                     *IF
     C           #2RMNB    ORNE YL0004                     *OR
     C           #2AODT    ORNE YL0007                     *OR
     C           #2GWST    ORNE YL0003                     *OR
     C           #CPKST    ORNE YL0006                     *OR
     C           #2GNDT    ORNE YL0008                     *OR
     C           #2BKC7    ORNE YL0009                     *OR
     C           #2BCNA    ORNE YL0005                     *OR
     C           #CQDU1    ORNE YL0010                     *OR
     C           #CJUSC    ORNE YL0011                     *OR
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 10/8/19 DN-Not sure if we need new SEQUEL or not??
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: Process command keys
      * CASE: CTL.*CMD key is *Reload
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CASE: CTL.*CMD key is *Print List
     C           *IN21     IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P1WSST           PRT Hold Output
     C                     MOVEL'*NO'     P1WSST           PRT Hold Output
     C                     MOVEL*BLANK    P1WTST           PRT Save Output
     C                     MOVEL'*NO'     P1WTST           PRT Save Output
     C                     MOVEL'N'       P1WUST           PRT Night Queue
     C                     MOVEL*BLANK    P1BVVN           PRT Night Queue
     C                     Z-ADD1         P1M8NB           System Value Nu
     C                     MOVEL@CN,002   P1G3TX           PRT Description
      * !!!We don't need the From / To Date...
      * !!!Resetup Ship From/To Warehouse...
     C                     END                             *FI
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,43
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * Subfile Option Processing.
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * Display Order Inquiry.
      * CASE: RCD.Event Code is Shipped Thru 07 History
     C           #1JPCD    IFGE '04'                       *IF
     C           #1JPCD    ANDLE'07'
      * DSP Ord Inq Ship Dtl   DF - Order Detail  * 
     C                     CALL 'PDP3DFR'              90  DSP Ord Inq Shi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0014  30       Company Number
     C                     PARM #1C4NB    WQ0015  70       Order Number
     C           YN0005    PARM YN0005    WQ0016  30       Order Sequence
     C           P2DNCD    PARM P2DNCD    WQ0017  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP3DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * DSP Ord Inquiry Detail DF - Order Detail  * 
     C                     CALL 'PDPZDFR'              90  DSP Ord Inquiry
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0018  30       Company Number
     C                     PARM #1C4NB    WQ0019  70       Order Number
     C                     PARM *ZERO     WQ0020  30       Order Sequence
     C                     PARM *ZERO     WQ0021  30       Order Secondary
     C           P2DNCD    PARM P2DNCD    WQ0022  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPZDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * DSP Order vs. Ship Dtl DF - Order Detail  * 
     C                     CALL 'PDP7DFR'              90  DSP Order vs. S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0023  30       Company Number
     C                     PARM #1C4NB    WQ0024  70       Order Number
     C                     PARM #1JNCD    WQ0025  2        Order Type_Sale
     C                     PARM #1BKC7    WQ0026  70       Ship To Custome
     C                     PARM #1BRTX    WQ0027 30        Ship To Name
     C                     PARM #1BCNA    WQ0028 15        Customer Purcha
     C                     PARM #1A0DT    WQ0029  70       Order Date
     C                     PARM #1GNDT    WQ0030  70       Actual Shipped
     C                     PARM #1GWST    WQ0031  1        Header Status
     C           #1XIST    PARM #1XIST    WQ0032  1        Credit Hold
     C           #1XJST    PARM #1XJST    WQ0033  1        Production Hold
     C           #1XKST    PARM #1XKST    WQ0034  1        New Customer Ho
     C                     PARM #1R4CD    WQ0035  3        Sales Route Cod
     C                     PARM P2DNCD    WQ0036  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP7DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 16
     C           #1SEL     IFEQ '16'                       *IF
      * Dsp Order Header       PV - Order Header TRG  * 
     C                     CALL 'OMB5PVR'              90  Dsp Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0037  30       Company Number
     C                     PARM #1C4NB    WQ0038  70       Order Number
     C                     PARM #1BCNA    WQ0039 15        Customer Purcha
     C                     PARM #1CXDT    WQ0040  70       Date of Origina
     C                     PARM #1AFTM    WQ0041  40       Requested Deliv
     C                     PARM P2DNCD    WQ0042  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMB5PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is Option 17
     C           #1SEL     IFEQ '17'                       *IF
      * WI609_2 JM 11/12/24-Show error for invalid SSCID pallet.
      * CASE: RCD.OHE EDI Error Reasons is Invalid Pallet SSCID
     C           #RB9TX    IFEQ 'SSCID'                    *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,003   CAT  @CN,004:ZQYL0022    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0022    ZA0001           Generic Message
     C                     Z-ADD#1RMNB    ZA0002           Load ID
      * Send message 'Generic Message 80 NBR'
     C                     MOVEL'USR5117' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv EDI 856 ASN Info RT - Warehouse Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RVPCD    WL0012    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      Warehouse Locat
     C                     MOVELWL0014    YN0007    P      WHS Live with C
     C                     MOVELWL0015    YN0008    P      WHS PFS Interfa
     C                     MOVELWL0016    YL0024    P      Crt 856 ASN for
      * WI609_2 JM 11/12/24-Do not process where Crt 856 ASN for 3PL Whse
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.Crt 856 ASN for 3PL Whse is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0023    IFEQ 'E'                        *IF
     C           YL0024    IFEQ 'Y'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,005   CAT  @CN,006:ZQYL0022    P      Generic Message
     C                     Z-ADD1         ZQ      50
     C           YL0022    CAT  @CN,007:ZQYL0022    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0022    ZA0003           Generic Message
     C                     Z-ADD#1RMNB    ZA0004           Load ID
      * Send message 'Generic Message 80 NBR'
     C                     MOVEL'USR5117' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * WI609_2 JM 02/27/25-Checkfor Load/BTC#/Co that AllOrders Have Bee
      * CASE: *OTHERWISE
      * Val All Orders Shipped XF - Order Header TRG  * 
     C                     CALL 'PVJ5XFR'              90  Val All Orders
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0043  30       Company Number
     C                     PARM #1B0C7    WQ0044  70       Bill to Custome
     C                     PARM #1RMNB    WQ0045  70       Load ID
     C           YL0025    PARM *BLANK    WQ0046  1        All Orders Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVJ5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: LCL.All Orders Shipped 2 USR is No
     C           YL0025    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0005           Load ID
      * Send message 'Load has Unshipped Orders'
     C                     MOVEL'USR5545' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Chg EDI 856 Sts  RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0017           Load ID
     C                     Z-ADD#1AIC3    WL0018           Company Number
     C                     MOVEL*BLANK    WL0019           OHE EDI Error R
     C                     MOVEL*BLANK    WL0020           OHE EDI 856 Act
     C                     Z-ADD#1B0C7    WL0021           Bill to Custome
     C                     EXSR SHRVGN
     C                     MOVEL'Y'       YL0027           F17 Pressed USR
      * Exc Crt EDI 856 ASN V2 XF - EDI Adv Ship Ntc Headr V2  * 
     C                     CALL 'PUOIXFR'              90  Exc Crt EDI 856
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0047  70       Load ID
     C                     PARM #1AIC3    WQ0048  30       Company Number
     C                     PARM #1B0C7    WQ0049  70       Bill to Custome
     C                     PARM YL0027    WQ0050  1        F17 Pressed USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUOIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Get EDI 856 Sts if Blank.
      * CASE: RCD.EDI 856 Action Dsc USR is Blank
     C           #RNXU1    IFEQ *BLANK                     *IF
      * RTV EDI 856/824 Sts    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0026           Company Number
     C                     Z-ADD#1C4NB    WL0027           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    #RJWSC    P      OHE EDI Error R
     C                     MOVELWL0029    #RJUSC    P      OHE EDI 856 Act
     C                     MOVELWL0030    YN0009    P      OHE EDI 824 Act
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: RCD.*SFLSEL is *Edit
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * Rtv Last EDI 856 f/Ord RT - EDI Adv Ship Ntc Dtl V2  * 
     C                     EXSR SLRVGN
      * Record Exist. Call WW.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * WW ASN HDR            DF - EDI Adv Ship Ntc Headr V2  * 
     C                     CALL 'PUN5DFR'              90  WW ASN HDR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0028    WQ0051  90       EDI SURROGATE N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUN5DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Get EDI 856 Sts if Blank.
      * CASE: RCD.EDI 856 Action Dsc USR is Blank
     C           #RNXU1    IFEQ *BLANK                     *IF
      * RTV EDI 856/824 Sts    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0026           Company Number
     C                     Z-ADD#1C4NB    WL0027           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    #RJWSC    P      OHE EDI Error R
     C                     MOVELWL0029    #RJUSC    P      OHE EDI 856 Act
     C                     MOVELWL0030    YN0009    P      OHE EDI 824 Act
     C                     END                             *FI
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,008   CAT  @CN,009:ZQYL0022    P      Generic Message
      * Setup message data for message
     C                     MOVELYL0022    ZA0006           Generic Message
     C                     Z-ADD#1RMNB    ZA0007           Load ID
      * Send message 'Generic Message 80 NBR'
     C                     MOVEL'USR5117' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     Z-ADD#1C4NB    #2C4NB           Order Number
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPY2 fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBEJNCD    #1JNCD           Order Type_Sale
     C                     Z-ADDBEANC7    #1ANC7           AR Customer Num
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip_Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip_Pos
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A_R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non_Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non_Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V1GNDT
     C                     Z-ADD*ZERO     #RAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     #RCBQT           Quantity Shippe
     C                     MOVEL*BLANK    #RF2ST           OHE EDI 940 Act
     C                     MOVEL*BLANK    #RJUSC           OHE EDI 856 Act
     C                     MOVEL*BLANK    #RF3ST           OHE EDI 945 Act
     C                     MOVEL*BLANK    #RF0ST           OHE EDI 944 Act
     C                     MOVEL*BLANK    #RJVSC           OHE EDI 824 Act
     C                     MOVEL*BLANK    #RNYU1           EDI 824 Action
     C                     MOVEL*BLANK    #RJWSC           OHE EDI Error R
     C                     MOVEL*BLANK    #RB9TX           OHE EDI Error R
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RVPCD           Ship From Wareh
     C                     MOVEL*BLANK    #RPKST           Load Status
     C                     Z-ADD*ZERO     #RC4QT           Quantity Ordere
     C                     Z-ADD*ZERO     #RSRQT           Quantity Shippe
     C                     MOVEL*BLANK    #RNXU1           EDI 856 Action
     C                     MOVEL*BLANK    #RHMTX           Condition Desc.
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP1G3TX    #PG3TX           PRT Description
     C                     MOVELP1WRST    #PWRST           PRT Printer Dev
     C                     MOVELP1WSST    #PWSST           PRT Hold Output
     C                     MOVELP1WTST    #PWTST           PRT Save Output
     C                     MOVELP1WUST    #PWUST           PRT Night Queue
     C                     MOVELP1BVVN    #PBVVN           PRT Night Queue
     C                     Z-ADDP1M8NB    #PM8NB           System Value Nu
     C                     MOVEL*BLANK    #CAPTX           Company Name
     C                     Z-ADD*ZERO     #CMADT           To Date
     C                     MOVELP3JNCD    #2JNCD           Order Type_Sale
     C                     MOVEL*BLANK    #2BRTX           Ship To Name
     C                     Z-ADD*ZERO     #CAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     #CCBQT           Quantity Shippe
     C                     MOVEL*BLANK    #CF2ST           OHE EDI 940 Act
     C                     MOVEL*BLANK    #CNXU1           EDI 856 Action
     C                     MOVEL*BLANK    #CF3ST           OHE EDI 945 Act
     C                     MOVEL*BLANK    #CJVSC           OHE EDI 824 Act
     C                     MOVEL*BLANK    #CNYU1           EDI 824 Action
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADDP3AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CVPCD           Ship From Wareh
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #CPKST           Load Status
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #CQDU1           Ship To Name (1
     C                     MOVEL*BLANK    #2BCNA           Customer Purcha
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADDP3GNDT    #2GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V2GNDT
     C                     Z-ADD*ZERO     #CC4QT           Quantity Ordere
     C                     Z-ADD*ZERO     #CSRQT           Quantity Shippe
     C                     MOVEL*BLANK    #CJUSC           OHE EDI 856 Act
     C                     MOVEL*BLANK    #CHMTX           Condition Desc.
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #1GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1GNDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #2GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2GNDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV EDI ASN 856 Info  RT - EDI Bill To Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           EDI Trading Par
     C                     MOVEL*BLANK    WL0004           EDI Detailed AS
     C                     MOVEL*BLANK    WL0005           Record Status
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           GQB0C7           Bill to Custome
     C                     KFLD           GQM4AA           Interchange Cod
      * Setup key
     C                     Z-ADDWL0001    GQB0C7           Bill to Custome
     C                     MOVELWL0002    GQM4AA           Interchange Cod
      * Establish starting position
     C           KRSSA     CHAIN@GQREH2              90    *
      * Data record not found
     C   90                MOVEL'USR4373' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELGQJ5NX    WL0003           EDI Trading Par
     C                     MOVELGQBIU1    WL0004           EDI Detailed AS
     C                     MOVELGQVSST    WL0005           Record Status
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV 1st Whse/Country   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSB02           Order Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDWL0006    WQSB01           Company Number
     C                     Z-ADDWL0007    WQSB02           Order Number
     C                     Z-ADDWL0008    OMDPNB           Order Sequence
     C                     Z-ADDWL0009    OMUENB           Order Secondary
      * Establish starting position
     C           KPSSB     SETLL@BGWKAE                    *
     C           KRSSB     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WL0010           Warehouse Code
     C                     MOVELOMKXCD    WL0011           Country Code
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv EDI 856 ASN Info RT - Warehouse Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0012    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0013           Warehouse Locat
     C                     MOVEL*BLANK    WL0014           WHS Live with C
     C                     MOVEL*BLANK    WL0015           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0016           Crt 856 ASN for
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADT0ST    WL0013           Warehouse Locat
     C                     MOVELADRRSX    WL0014           WHS Live with C
     C                     MOVELADRSSX    WL0015           WHS PFS Interfa
     C                     MOVELADQDSC    WL0016           Crt 856 ASN for
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV EDI 856/824 OHE StsRT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #RB9TX           OHE EDI Error R
     C                     MOVEL*BLANK    #RJWSC           OHE EDI Error R
     C                     MOVEL*BLANK    #RJUSC           OHE EDI 856 Act
     C                     MOVEL*BLANK    #RJVSC           OHE EDI 824 Act
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@AMREJF              90    *
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMB9TX    #RB9TX           OHE EDI Error R
     C                     MOVELAMJWSC    #RJWSC           OHE EDI Error R
     C                     MOVELAMJUSC    #RJUSC           OHE EDI 856 Act
     C                     MOVELAMJVSC    #RJVSC           OHE EDI 824 Act
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Load Status 2      RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #RPKST           Load Status
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    #RPKST           Load Status
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Sum Qty Ord/Ship   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RC4QT           Total Quantity
     C                     Z-ADD*ZERO     #RSRQT           Total Quantity
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSF02           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSF01           Company Number
     C                     Z-ADD#1C4NB    WQSF02           Order Number
      * Establish starting position
     C           KRSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WAGMST    IFEQ 'L'                        *IF
     C           WAGMST    OREQ 'A'
     C           WAGMST    OREQ 'C'
     C           WAGMST    OREQ 'R'
     C           WAGMST    OREQ 'E'
     C           WAGMST    OREQ 'H'
     C           WAGMST    OREQ 'I'
     C                     ADD  WAAVQT    #RC4QT           Total Quantity
     C                     ADD  WACBQT    #RSRQT           Total Quantity
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Departure DT/TM   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSG02           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSG02           Load ID
      * Establish starting position
     C           KRSSG     SETLL@FJCPSB                    *
     C           KRSSG     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0020           Truck Departure
     C                     Z-ADD*ZERO     YL0021           Truck Departure
     C                     GOTO SGEXIT                     *QUIT
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBKIDT    YL0020           Truck Departure
     C                     Z-ADDWBASTM    YL0021           Truck Departure
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Chg EDI 856 Sts  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSH01           Load ID
     C           *LIKE     DEFN WCAIC3    WQSH02           Company Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Load ID
     C                     KFLD           WQSH02           Company Number
      * Setup key
     C                     Z-ADDWL0017    WQSH01           Load ID
     C                     Z-ADDWL0018    WQSH02           Company Number
      * Establish starting position
     C           KRSSH     SETLL@AMREL3                    *
     C           KRSSH     READE@AMREL3                  90*
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Val Recreate 856 ASN   RT - Order Header TRG  * 
     C                     EXSR SIRVGN
      * CASE: LCL.Match Found USR is Yes
     C           YL0026    IFEQ 'Y'                        *IF
      * CASE: DB1.OHE EDI 856 Action is Sent
     C           WCJUSC    IFEQ 'S'                        *IF
      * CHG OHE EDI 856 Error  CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0022           Company Number
     C                     Z-ADDWCC4NB    WL0023           Order Number
     C                     MOVELWL0019    WL0024    P      OHE EDI Error R
     C                     MOVELWL0020    WL0025    P      OHE EDI 856 Act
     C                     EXSR SJCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@AMREL3                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Val Recreate 856 ASN   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0026           Match Found USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSI01           Load ID
     C           *LIKE     DEFN WDB0C7    WQSI02           Bill to Custome
     C           *LIKE     DEFN WDAIC3    WQSI03           Company Number
     C           *LIKE     DEFN WDC4NB    WQSI04           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Load ID
     C                     KFLD           WQSI02           Bill to Custome
     C                     KFLD           WQSI03           Company Number
     C                     KFLD           WQSI04           Order Number
      * Setup key
     C                     Z-ADDWCRMNB    WQSI01           Load ID
     C                     Z-ADDWL0021    WQSI02           Bill to Custome
     C                     Z-ADDWCAIC3    WQSI03           Company Number
     C                     Z-ADDWCC4NB    WQSI04           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BFCPHX                    *
     C           KRSSI     READE@BFCPHX                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0026           Match Found USR
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@BFCPHX                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * CHG OHE EDI 856 Error  CH - Order Header Extension  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Load ID
     C                     Z-ADD*ZERO     WN0002  50       Stop_Drop Seque
     C                     MOVEL*BLANK    WN0003  3        Shipping Line
     C                     MOVEL*BLANK    WN0004 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0005 25        OHE City
     C                     MOVEL*BLANK    WN0006 30        OHE Vessel_Airl
     C                     MOVEL*BLANK    WN0007 15        OHE Voyage_Flig
     C                     MOVEL*BLANK    WN0008 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0009 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0010  70       OHE Sail_Flight
     C                     Z-ADD*ZERO     WN0011  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0012  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0013  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0014  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0015 12        OHE Container N
     C                     MOVEL*BLANK    WN0016 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0017 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0018 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0019 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0020 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0021 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0022 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0023 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0024 112       Transload Termi
     C                     Z-ADD*ZERO     WN0025  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0026  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0027  70       OHE Port_Pier P
     C                     Z-ADD*ZERO     WN0028  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0029  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0030  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0031  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0032  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0033  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0034  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0035  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0036  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0037  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0038  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0039  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0040 38        Delivery P_O  N
     C                     MOVEL*BLANK    WN0041  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0042  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0043  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0044  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0045  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0046  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0047 10        OHE Transload S
     C                     MOVEL*BLANK    WN0048 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0049 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0050 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0051 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0052 15        OHE Transload C
     C                     MOVEL*BLANK    WN0053 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0054 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0055 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0056 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0057 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0058  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0059  30       LD Stop_Drop
     C                     Z-ADD*ZERO     WN0060  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0061  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0062  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0063  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0064  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0065  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0066  60       Original Appoin
     C                     Z-ADD*ZERO     WN0067  60       Original Appoin
     C                     Z-ADD*ZERO     WN0068  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0069  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0070  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0071  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0072 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0073  1        OHE Email BOL_S
     C                     MOVEL*BLANK    WN0074  1        OHE EDI Order A
     C                     MOVEL*BLANK    WN0075  2        OHE EDI 601 Act
     C                     MOVEL*BLANK    WN0076  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0077  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0078  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0079 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0080 15        OHE EDI 824 AES
     C                     MOVEL*BLANK    WN0081 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0082  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0083  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0084  1        EDI Status 1
     C                     MOVEL*BLANK    WN0085  1        EDI Status 2
     C                     MOVEL*BLANK    WN0086  1        EDI Status 3
     C                     MOVEL*BLANK    WN0087  1        Record Status
     C                     Z-ADD*ZERO     WN0088  60       Job Time
     C                     MOVEL*BLANK    WN0089 10        User Id
     C                     MOVEL*BLANK    WN0090 10        Job Name
     C                     Z-ADD*ZERO     WN0091  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWL0022    WEAIC3           Company Number
     C                     Z-ADDWL0023    WEC4NB           Order Number
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C           KLCHSJ    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YARDCS
      * Move non-key fields to @AMREJE
     C                     MOVELWL0024    WEJWSC    P      OHE EDI Error R
     C                     MOVELWL0025    WEJUSC    P      OHE EDI 856 Act
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     MOVEL##USR     WEAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV EDI 856/824 Sts    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0028           OHE EDI Error R
     C                     MOVEL*BLANK    WL0029           OHE EDI 856 Act
     C                     MOVEL*BLANK    WL0030           OHE EDI 824 Act
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0026    AMAIC3           Company Number
     C                     Z-ADDWL0027    AMC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@AMREJF              90    *
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMJWSC    WL0028           OHE EDI Error R
     C                     MOVELAMJUSC    WL0029           OHE EDI 856 Act
     C                     MOVELAMJVSC    WL0030           OHE EDI 824 Act
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Last EDI 856 f/Ord RT - EDI Adv Ship Ntc Dtl V2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0028           EDI SURROGATE N
      * Declare restrictor key work fields
     C           *LIKE     DEFN BMC4NB    WQSL01           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Order Number
      * Setup key
     C                     Z-ADD#1C4NB    WQSL01           Order Number
      * Establish starting position
     C           KRSSL     SETLL@P140F4                    *
     C           KRSSL     READE@P140F4                  90*
      * Data record not found
     C   90                MOVEL'USR5139' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBMH9NY    YL0028           EDI SURROGATE N
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@P140F4                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0092    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSM     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi_Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0029           Company Number
     C                     MOVELDRBUVN    WN0093           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0031    DTAJVN           User Profile Na
     C                     MOVELWL0032    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSN     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0033           Company Number
     C                     MOVELDTAJCD    WL0034           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSO01           Application Cod
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Application Cod
      * Setup key
     C                     MOVELP2DNCD    WQSO01           Application Cod
      * Establish starting position
     C           KRSSO     SETLL@DNRESF                    *
     C           KRSSO     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C           KRSSO     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSP01           Application Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSP01           Application Cod
      * Establish starting position
     C           KRSSP     SETLL@DNRESF                    *
     C           KRSSP     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD10        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ021
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2GWST'  YPMTFD           Header Status
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ031
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CPKST'  YPMTFD           Load Status
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ113
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CJUSC'  YPMTFD           OHE EDI 856 Act
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1G3TX           PRT Description
     C                     MOVEL*BLANK    P1WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P1WSST           PRT Hold Output
     C                     MOVEL*BLANK    P1WTST           PRT Save Output
     C                     MOVEL*BLANK    P1WUST           PRT Night Queue
     C                     MOVEL*BLANK    P1BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P1M8NB           System Value Nu
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3AIC3           Company Number
     C                     MOVEL*BLANK    P3JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     P3GNDT           Actual Shipped
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR Qclscan Result ?
     C                     Z-ADD*ZERO     WUY8NB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WCQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WCQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WCQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WCGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WCHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WCHGVL           Transload Termi
     C                     Z-ADD*ZERO     WCQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WCQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WCQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WCQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WCQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WCQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WCP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WCQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WCQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WCQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WCQENY           Original Appoin
     C                     Z-ADD*ZERO     WCQFNY           Original Appoin
     C                     Z-ADD*ZERO     WCQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WCQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WCW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           AR Customer Num
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A_R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  6
     C                     MOVEL*BLANK    WL0003  6
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005  1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  3
     C                     MOVEL*BLANK    WL0011  6
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0012  3
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  30
     C                     MOVEL*BLANK    WL0019  5
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  70
      * Define local variables for subroutine SJCHRC.
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  5
     C                     MOVEL*BLANK    WL0025  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028  5
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0031 10
     C                     MOVEL*BLANK    WL0032  6
     C                     Z-ADD*ZERO     WL0033  30
     C                     MOVEL*BLANK    WL0034  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Ship From Warehouse
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0005 15
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Ship To Name (15A) USR
     C                     MOVEL*BLANK    YL0010 15
      * Define local work field OHE EDI 856 Action
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Create EDI ASN 856 V2 USR
     C                     MOVEL*BLANK    YL0012  1
      * Define null work field EDI Trading Partner No
     C                     MOVEL*BLANK    YN0001  6
      * Define null work field Country Code
     C                     MOVEL*BLANK    YN0002  6
      * Define null work field Warehouse Location
     C                     MOVEL*BLANK    YN0003  1
      * Define local work field EDI Detailed ASN 856 Rqd
     C                     MOVEL*BLANK    YL0013  3
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0015  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0017  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Crt 856 ASN for 3PL Whse
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Send EDI Document Y/N
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Truck Departure Date
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field Truck Departure Time
     C                     Z-ADD*ZERO     YL0021  60
      * Define null work field Order Sequence Number
     C                     Z-ADD*ZERO     YN0005  30
      * Define null work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YN0006  30
      * Define local work field Generic Message 80 USR
     C                     MOVEL*BLANK    YL0022 80
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0023  1
      * Define null work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0008  1
      * Define local work field Crt 856 ASN for 3PL Whse
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field All Orders Shipped 2 USR
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Match Found USR
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field F17 Pressed USR
     C                     MOVEL*BLANK    YL0027  1
      * Define null work field OHE EDI 824 Action
     C                     MOVEL*BLANK    YN0009  1
      * Define local work field EDI SURROGATE NUMBER
     C                     Z-ADD*ZERO     YL0028  90
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0029  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0030  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD14        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL'OMS'     P2DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN0092 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0092           User Profile Na
      *
     C                     MOVEL*BLANK    WN0093 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SMRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0092    ZA0008           User Profile Na
     C                     MOVELP2DNCD    ZA0009           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0093    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0092    WL0031    P      User Profile Na
     C                     MOVELP2DNCD    WL0032    P      Application Cod
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    P3AIC3           Company Number
     C                     MOVELWL0034    YL0030    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0093    WL0031    P      User Profile Na
     C                     MOVELP2DNCD    WL0032    P      Application Cod
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    P3AIC3           Company Number
     C                     MOVELWL0034    YL0030    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0030    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0092    ZA0010           User Profile Na
     C                     MOVELP2DNCD    ZA0011           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0029    IFNE 0                          *IF
     C                     Z-ADDYL0029    P3AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0030    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0052  3        Warehouse Code
     C                     PARM YL0029    WQ0053  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SORVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       YL0001           First Time Flag
     C                     Z-ADD50000     W0SLM            *Scan limit
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 USR0752
00002 Shipped Whs Transfer Rpt
00003 Invalid pallet SSCID,EDI
00004  856 ASN can't be created
00005 Create 856 ASN for 3PL
00006 warehouse is No,
00007 856 ASN can't be created.
00008 EDI 856 ASN detail not fo
00009 und. Option not allowed.
00010 Y2U0005
