/********************************************************************/
/*  SYNOPSIS -  RECEIVE PARAMETERS AND PASS TO SUBMITTED            */
/*              PROGRAM THAT WILL CREATE THE SPREADSHEET            */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - SUBMITS PROGRAM TO CREATE BACKHAUL SPREADSHEET      */
/*  DATE      - 04/07/2014                                          */
/*  PROGRAMMER- LARA BUSER                                          */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*   &COMPYN     - BACKHAUL TO COMPANY NUMBER 15.5                  */
/*   &FRMDATN    - FROM ACTUAL SHIPPED DATE 15.5                    */
/*   &THRDATN    - THRU ACTUAL SHIPPED DATE 15.5                    */
/*   &RPTTYPE    - REPORT TYPE                                      */
/*   &SHIPLINE   - SHIPPING LINE                                    */
/*   &CARRIER    - BACKHAUL CARRIER CODE                            */
/*   &EMAIL      - EMAIL ADDRESS                                    */
/********************************************************************/
/* MODIFICATIONS:                                                   */
/* LJB 06/11/2015 E004106  ADD SELECT AS AN INPUT PARM TO DETERMINE */
/*     IF REPORTS ARE BY 1=ETA TO PLANT DATE  OR 2=SCHED SHIP DATE  */
/********************************************************************/
 PNXRUPC:    PGM        PARM(&COMPYN &FRMDATN &THRDATN &RPTTYPE +
                          &SELECT &CARRIER &EMAIL)

             DCL        VAR(&COMPYN)    TYPE(*DEC)
             DCL        VAR(&FRMDATN)   TYPE(*DEC)
             DCL        VAR(&THRDATN)   TYPE(*DEC)
             DCL        VAR(&RPTTYPE)   TYPE(*CHAR) LEN(1)
             DCL        VAR(&CARRIER)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&SELECT)    TYPE(*CHAR) LEN(1)
             DCL        VAR(&EMAIL)     TYPE(*CHAR) LEN(50)
/* ERROR MESSAGE FIELDS                                             */
             DCL        VAR(&MSG)       TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID)     TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL)      TYPE(*DEC) LEN(5 0)

             MONMSG     MSGID(CPF0000)
/******      GOTO TEST             TESTING      *****/
/*-------------------------------------------------------------------*/
/* SUBMIT THE BACKHAUL REPORT - PMGDUPC                              */
/*-------------------------------------------------------------------*/
 SUBMIT:     SBMJOB     CMD(CALL PGM(PMGDUPC) PARM(&COMPYN &FRMDATN +
                          &THRDATN &RPTTYPE &CARRIER &SELECT &EMAIL)) +
                          JOB(BACKHAUL)

             GOTO       CMDLBL(END)
TEST:
             CALL       PGM(PMGDUPC) PARM(&COMPYN &FRMDATN &THRDATN +
                          &RPTTYPE &CARRIER &SELECT &EMAIL)

             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/
 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
