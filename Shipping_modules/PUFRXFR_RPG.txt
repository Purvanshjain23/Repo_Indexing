     H/TITLE Crt Rcvd But Not Ship XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 09/24/18  Time  : 12:46:43
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUAOCPL3IF  E           K        DISK
      * RSQ : Manifest Detail EDI Rcpt  Co/Ord/Item/Pallet/Seria
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMFNCPLDIF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Itm/Pllt/Srl
      *
     FPUA1CPL1IF  E           K        DISK
      * RTV : WF EDI Whs Stk Txfr Diff  Retrieval index
      *
     FPUA1CPL2IF  E           K        DISK
      * RSQ : WF EDI Whs Stk Txfr Diff  Co/Ord/Load/Item/Pal/Ser
      *
     FPUA1CPL0UF  E           K        DISK                      A
      * UPD : WF EDI Whs Stk Txfr Diff  Update index
      *
     I@AOCPCK
      * Manifest Detail EDI Rcpt  Co/Ord/Item/Pallet/Seria
      * Renamed input format fields
     I              AOAIC3                          WAAIC3
     I              AOC4NB                          WAC4NB
     I              AOT4NY                          WAT4NY
     I              AOAXNZ                          WAAXNZ
     I              AOA1NZ                          WAA1NZ
     I              AORMNB                          WARMNB
     I              AOHGCD                          WAHGCD
     I              AOH7NY                          WAH7NY
     I              AOPFNX                          WAPFNX
     I              AOSIQT                          WASIQT
     I              AOP5WG                          WAP5WG
     I              AOWDAA                          WAWDAA
     I              AOHMU1                          WAHMU1
     I              AOWBAA                          WAWBAA
     I              AOWCAA                          WAWCAA
     I              AOPMST                          WAPMST
     I              AOWSDT                          WAWSDT
     I              AOEETM                          WAEETM
     I              AOE1SC                          WAE1SC
     I              AOGVSC                          WAGVSC
     I              AOWTDT                          WAWTDT
     I              AOCHNZ                          WACHNZ
     I              AOSKQT                          WASKQT
     I              AOIDU1                          WAIDU1
     I              AOAATM                          WAAATM
     I              AOAYNA                          WAAYNA
     I              AOA0NA                          WAA0NA
     I              AOAXDT                          WAAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@FNCPCL
      * Manifest Detail           Co/Ord/Itm/Pllt/Srl
      * Renamed input format fields
     I              FNAIC3                          WCAIC3
     I              FNC4NB                          WCC4NB
     I              FNDPNB                          WCDPNB
     I              FNUENB                          WCUENB
     I              FNRZNB                          WCRZNB
     I              FNFOQT                          WCFOQT
     I              FNR0NB                          WCR0NB
     I              FNPMST                          WCPMST
     I              FNK7DT                          WCK7DT
     I              FNPFNX                          WCPFNX
     I              FNHGCD                          WCHGCD
     I              FNAJCD                          WCAJCD
     I              FNELDT                          WCELDT
     I              FNN5WG                          WCN5WG
     I              FNRZNA                          WCRZNA
     I              FNH5NY                          WCH5NY
     I              FNH6NY                          WCH6NY
     I              FNH7NY                          WCH7NY
     I              FNGBTX                          WCGBTX
     I              FNN6WG                          WCN6WG
     I              FNN7WG                          WCN7WG
     I              FNGCTX                          WCGCTX
     I              FNGDTX                          WCGDTX
     I              FNRBDT                          WCRBDT
     I              FNITNY                          WCITNY
     I              FNIVNY                          WCIVNY
     I              FNIUNY                          WCIUNY
     I              FNIWNY                          WCIWNY
     I              FNIXNY                          WCIXNY
     I              FNIYNY                          WCIYNY
     I              FNUVST                          WCUVST
     I              FNUWST                          WCUWST
     I              FNUXST                          WCUXST
     I              FNVSST                          WCVSST
     I              FNAATM                          WCAATM
     I              FNAYNA                          WCAYNA
     I              FNA0NA                          WCA0NA
     I              FNAXDT                          WCAXDT
      *
     I@A1CPCO
      * WF EDI Whs Stk Txfr Diff  Retrieval index
      * Renamed input format fields
     I              A1AIC3                          WDAIC3
     I              A1C4NB                          WDC4NB
     I              A1RMNB                          WDRMNB
     I              A1H7NY                          WDH7NY
     I              A1HGCD                          WDHGCD
     I              A1PFNX                          WDPFNX
     I              A1VPCD                          WDVPCD
     I              A1L9AA                          WDL9AA
     I              A1AODT                          WDAODT
     I              A1J7DT                          WDJ7DT
     I              A1BOTM                          WDBOTM
     I              A1WSDT                          WDWSDT
     I              A1EETM                          WDEETM
     I              A1RQNA                          WDRQNA
     I              A1ELDT                          WDELDT
     I              A1R0NB                          WDR0NB
     I              A1N5WG                          WDN5WG
     I              A1FOQT                          WDFOQT
     I              A1SIQT                          WDSIQT
     I              A1GWSC                          WDGWSC
     I              A1GXSC                          WDGXSC
     I              A1SNQT                          WDSNQT
     I              A1SOQT                          WDSOQT
     I              A1CINZ                          WDCINZ
     I              A1P7WG                          WDP7WG
     I              A1WVDT                          WDWVDT
     I              A1WWDT                          WDWWDT
      *
     I@A1CPCN
      * WF EDI Whs Stk Txfr Diff  Update index
      * Renamed input format fields
     I              A1AIC3                          WEAIC3
     I              A1C4NB                          WEC4NB
     I              A1RMNB                          WERMNB
     I              A1H7NY                          WEH7NY
     I              A1HGCD                          WEHGCD
     I              A1PFNX                          WEPFNX
     I              A1VPCD                          WEVPCD
     I              A1L9AA                          WEL9AA
     I              A1AODT                          WEAODT
     I              A1J7DT                          WEJ7DT
     I              A1BOTM                          WEBOTM
     I              A1WSDT                          WEWSDT
     I              A1EETM                          WEEETM
     I              A1RQNA                          WERQNA
     I              A1ELDT                          WEELDT
     I              A1R0NB                          WER0NB
     I              A1N5WG                          WEN5WG
     I              A1FOQT                          WEFOQT
     I              A1SIQT                          WESIQT
     I              A1GWSC                          WEGWSC
     I              A1GXSC                          WEGXSC
     I              A1SNQT                          WESNQT
     I              A1SOQT                          WESOQT
     I              A1CINZ                          WECINZ
     I              A1P7WG                          WEP7WG
     I              A1WVDT                          WEWVDT
     I              A1WWDT                          WEWWDT
      *
     I@A1CPD5
      * WF EDI Whs Stk Txfr Diff  Co/Ord/Load/Item/Pal/Ser
      * Renamed input format fields
     I              A1AIC3                          WFAIC3
     I              A1C4NB                          WFC4NB
     I              A1RMNB                          WFRMNB
     I              A1H7NY                          WFH7NY
     I              A1HGCD                          WFHGCD
     I              A1PFNX                          WFPFNX
     I              A1VPCD                          WFVPCD
     I              A1L9AA                          WFL9AA
     I              A1AODT                          WFAODT
     I              A1J7DT                          WFJ7DT
     I              A1BOTM                          WFBOTM
     I              A1WSDT                          WFWSDT
     I              A1EETM                          WFEETM
     I              A1RQNA                          WFRQNA
     I              A1ELDT                          WFELDT
     I              A1R0NB                          WFR0NB
     I              A1N5WG                          WFN5WG
     I              A1FOQT                          WFFOQT
     I              A1SIQT                          WFSIQT
     I              A1GWSC                          WFGWSC
     I              A1GXSC                          WFGXSC
     I              A1SNQT                          WFSNQT
     I              A1SOQT                          WFSOQT
     I              A1CINZ                          WFCINZ
     I              A1P7WG                          WFP7WG
     I              A1WVDT                          WFWVDT
     I              A1WWDT                          WFWWDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPUA11    E DSPUA1CPL0
      * UPD : WF EDI Whs Stk Txfr Diff  Update index
      * Renamed input format fields
     I              A1AIC3                          WEAIC3
     I              A1C4NB                          WEC4NB
     I              A1RMNB                          WERMNB
     I              A1H7NY                          WEH7NY
     I              A1HGCD                          WEHGCD
     I              A1PFNX                          WEPFNX
     I              A1VPCD                          WEVPCD
     I              A1L9AA                          WEL9AA
     I              A1AODT                          WEAODT
     I              A1J7DT                          WEJ7DT
     I              A1BOTM                          WEBOTM
     I              A1WSDT                          WEWSDT
     I              A1EETM                          WEEETM
     I              A1RQNA                          WERQNA
     I              A1ELDT                          WEELDT
     I              A1R0NB                          WER0NB
     I              A1N5WG                          WEN5WG
     I              A1FOQT                          WEFOQT
     I              A1SIQT                          WESIQT
     I              A1GWSC                          WEGWSC
     I              A1GXSC                          WEGXSC
     I              A1SNQT                          WESNQT
     I              A1SOQT                          WESOQT
     I              A1CINZ                          WECINZ
     I              A1P7WG                          WEP7WG
     I              A1WVDT                          WEWVDT
     I              A1WWDT                          WEWWDT
      *
     IYARDCS      DS                            133
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             24
      * KEY: Manifest Detail EDI Rcpt  Co/Ord/Item/Pallet/Seria
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Item Code
     I                                    P   7  100P1HGCD
     IP2PARM      DS
      * I :  Ship From Warehouse
     I                                        1   3 P2VPCD
     IP3PARM      DS
      * I :  Ship To Warehouse
     I                                        1   3 P3L9AA
     IP4PARM      DS
      * FLD: Order Header TRG
      * I :  Scheduled Ship Date
     I                                    P   1   40P4AODT
      * I :  Load ID
     I                                    P   5   80P4RMNB
     IP5PARM      DS
      * FLD: Load Header
      * I :  BOL Complete Date
     I                                    P   1   40P5J7DT
      * I :  BOL Complete Time
     I                                    P   5   80P5BOTM
     IP6PARM      DS
      * I :  Item Description Line 1
     I                                        1  30 P6RQNA
     IP7PARM      DS
      * I :  Email Ship/Rcvd Diff USR
     I                                        1   1 P7ICSC
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Manifest D
     C           P2VPCD    PARM           WP0001  3        Ship From Wareh
     C           P3L9AA    PARM           WP0002  3        Ship To Warehou
     C           P4AODT    PARM           WP0003  70       Scheduled Ship
     C           P4RMNB    PARM           WP0004  70       Load ID
     C           P5J7DT    PARM           WP0005  70       BOL Complete Da
     C           P5BOTM    PARM           WP0006  60       BOL Complete Ti
     C           P6RQNA    PARM           WP0007 30        Item Descriptio
     C           P7ICSC    PARM           WP0008  1        Email Ship/Rcvd
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt Rcvd But Not Ship XF
      * Crt Rcvd But Not Ship RT - Manifest Detail EDI Rcpt  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Crt Rcvd But Not Ship RT - Manifest Detail EDI Rcpt  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVELP6RQNA    YL0001           Item Descriptio
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1C4NB    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@AOCPCK                    *
     C           KRSSA     READE@AOCPCK                  90*
      * Data record not found
     C   90                MOVEL'USR5011' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Match by Item Code if Requested.
      * CASE: PAR.Item Code is Entered
     C           P1HGCD    IFNE 0                          *IF
      * CASE: PAR.Item Code NE DB1.Item Code
     C           P1HGCD    IFNE WAHGCD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Get Item Code Description.
      * CASE: DB1.Item Code NE LCL.Item Code
     C           WAHGCD    IFNE YL0002                     *IF
     C                     Z-ADDWAHGCD    YL0002           Item Code
      * Rtv Desc Line 1&2      RT - Company Item  * Get Item Desc
     C                     EXSR SBRVGN
     C                     END                             *FI
     C                     END                             *FI
      * Create WF Whs Stck Txf Diff if Manifest Detail Not Found.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Check By Item or By Pallet Level?
      * CASE: PAR.Email Ship/Rcvd Diff USR is No
     C           P7ICSC    IFEQ 'N'                        *IF
      * Called from PUDCDFR - F22=Email DTL Rcvd/In-Transit EDI.
      * RTV for Existence     RT - Manifest Detail  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Called from PMEZDFR - F20=Email Ship/Rcvd Diff EDI.
      * RTV for Existence 2   RT - Manifest Detail  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * If not found, this means Rcvd Qty was more than what was shipped.
     C                     Z-ADDWASIQT    YL0003           Diff/Discrepanc
      * R113315 DN 09/10/18-If keys exist, add it to existing record.
      * CASE: PAR.Email Ship/Rcvd Diff USR is No
     C           P7ICSC    IFEQ 'N'                        *IF
      * Called from PUDCDFR - F22=Email DTL Rcvd/In-Transit EDI.
      * This will update by Co/Ord/Load/Pallet/Item/Serial.
      * Upd WF Whs StckTxf Dif RT - WF EDI Whs Stk Txfr Diff  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Called from PMEZDFR - F20=Email Ship/Rcvd Diff EDI.
      * This will SUM up Qty Ship & Qty Rcvd by Co/Ord/Load/Item.
      * Upd WhsStckTxf Diff 2  RT - WF EDI Whs Stk Txfr Diff  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@AOCPCK                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Desc Line 1&2      RT - Company Item  * Get Item Desc
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Description Lin
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDWAHGCD    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAVNA    YL0001           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV for Existence     RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
     C           *LIKE     DEFN WCHGCD    WQSC03           Item Code
     C           *LIKE     DEFN WCH7NY    WQSC04           Manifest Pallet
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Item Code
     C                     KFLD           WQSC04           Manifest Pallet
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     Z-ADDWAC4NB    WQSC02           Order Number
     C                     Z-ADDWAHGCD    WQSC03           Item Code
     C                     Z-ADDWAH7NY    WQSC04           Manifest Pallet
      * Establish starting position
     C           KRSSC     SETLL@FNCPCL                    *
     C           KRSSC     READE@FNCPCL                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV for Existence 2   RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSD02           Order Number
     C           *LIKE     DEFN WCHGCD    WQSD03           Item Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSD01           Company Number
     C                     Z-ADDWAC4NB    WQSD02           Order Number
     C                     Z-ADDWAHGCD    WQSD03           Item Code
      * Establish starting position
     C           KRSSD     SETLL@FNCPCL                    *
     C           KRSSD     READE@FNCPCL                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Upd WF Whs StckTxf Dif RT - WF EDI Whs Stk Txfr Diff  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDRMNB           Load ID
     C                     KFLD           WDH7NY           Manifest Pallet
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDPFNX           PT Serial Numbe
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     Z-ADDWAC4NB    WDC4NB           Order Number
     C                     Z-ADDWARMNB    WDRMNB           Load ID
     C                     Z-ADDWAH7NY    WDH7NY           Manifest Pallet
     C                     Z-ADDWAHGCD    WDHGCD           Item Code
     C                     Z-ADDWAPFNX    WDPFNX           PT Serial Numbe
      * Establish starting position
     C           KRSSE     CHAIN@A1CPCO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5054' W0RTN   7
      * USER: Processing if Data record not found
      * CRT WF Whs StckTxf Dif CR - WF EDI Whs Stk Txfr Diff  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWARMNB    WL0003           Load ID
     C                     Z-ADDWAH7NY    WL0004           Manifest Pallet
     C                     Z-ADDWAHGCD    WL0005           Item Code
     C                     Z-ADDWAPFNX    WL0006           PT Serial Numbe
     C                     MOVELP2VPCD    WL0007    P      Ship From Wareh
     C                     MOVELP3L9AA    WL0008    P      Ship To Warehou
     C                     Z-ADDP4AODT    WL0009           Scheduled Ship
     C                     Z-ADDP5J7DT    WL0010           BOL Complete Da
     C                     Z-ADDP5BOTM    WL0011           BOL Complete Ti
     C                     Z-ADDWAWSDT    WL0012           MDER Receipt Da
     C                     Z-ADDWAEETM    WL0013           MDER Receipt Ti
     C                     MOVELYL0001    WL0014    P      Item Descriptio
     C                     Z-ADDWAWTDT    WL0015           Production Date
     C                     Z-ADD0         WL0016           Case Weight
     C                     Z-ADD0         WL0017           Manifest Gross
     C                     Z-ADD0         WL0018           Case Quantity
     C                     Z-ADDWASIQT    WL0019           Quantity Receiv
     C                     MOVEL*BLANK    WL0020           EWSTD Unused St
     C                     MOVEL*BLANK    WL0021           EWSTD Unused St
     C                     Z-ADDYL0003    WL0022           Diff/Discrepanc
     C                     Z-ADD0         WL0023           In Transit Qty
     C                     Z-ADD0         WL0024           EWSTD Unused Nb
     C                     Z-ADD0         WL0025           EWSTD Unused Wg
     C                     Z-ADD0         WL0026           EWSTD Unused Dt
     C                     Z-ADD0         WL0027           EWSTD Unused Dt
     C                     EXSR SFCRRC
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Update Quantity Received & Diff/Discrepancy Qty.
     C           WDSIQT    ADD  WASIQT    YL0004           Quantity Receiv
     C           WDSNQT    ADD  YL0003    YL0005           Diff/Discrepanc
      * Update the Oldest Production Date.
      * CASE: PAR.Production Date LT DB1.Production Date
     C           WAWTDT    IFLT WDELDT                     *IF
     C                     Z-ADDWAWTDT    YL0006           Production Date
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWDELDT    YL0006           Production Date
     C                     END                             *FI
      * CHG WF Whs StckTxf Dif CH - WF EDI Whs Stk Txfr Diff  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0028           Company Number
     C                     Z-ADDWDC4NB    WL0029           Order Number
     C                     Z-ADDWDRMNB    WL0030           Load ID
     C                     Z-ADDWDH7NY    WL0031           Manifest Pallet
     C                     Z-ADDWDHGCD    WL0032           Item Code
     C                     Z-ADDWDPFNX    WL0033           PT Serial Numbe
     C                     MOVELWDVPCD    WL0034    P      Ship From Wareh
     C                     MOVELWDL9AA    WL0035    P      Ship To Warehou
     C                     Z-ADDWDAODT    WL0036           Scheduled Ship
     C                     Z-ADDWDJ7DT    WL0037           BOL Complete Da
     C                     Z-ADDWDBOTM    WL0038           BOL Complete Ti
     C                     Z-ADDWDWSDT    WL0039           MDER Receipt Da
     C                     Z-ADDWDEETM    WL0040           MDER Receipt Ti
     C                     MOVELWDRQNA    WL0041    P      Item Descriptio
     C                     Z-ADDYL0006    WL0042           Production Date
     C                     Z-ADDWDR0NB    WL0043           Case Weight
     C                     Z-ADDWDN5WG    WL0044           Manifest Gross
     C                     Z-ADDWDFOQT    WL0045           Case Quantity
     C                     Z-ADDYL0004    WL0046           Quantity Receiv
     C                     MOVELWDGWSC    WL0047    P      EWSTD Unused St
     C                     MOVELWDGXSC    WL0048    P      EWSTD Unused St
     C                     Z-ADDYL0005    WL0049           Diff/Discrepanc
     C                     Z-ADDWDSOQT    WL0050           In Transit Qty
     C                     Z-ADDWDCINZ    WL0051           EWSTD Unused Nb
     C                     Z-ADDWDP7WG    WL0052           EWSTD Unused Wg
     C                     Z-ADDWDWVDT    WL0053           EWSTD Unused Dt
     C                     Z-ADDWDWWDT    WL0054           EWSTD Unused Dt
     C                     EXSR SGCHRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT WF Whs StckTxf Dif CR - WF EDI Whs Stk Txfr Diff  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @A1CPCN
     C                     Z-ADDWL0001    WEAIC3           Company Number
     C                     Z-ADDWL0002    WEC4NB           Order Number
     C                     Z-ADDWL0003    WERMNB           Load ID
     C                     Z-ADDWL0004    WEH7NY           Manifest Pallet
     C                     Z-ADDWL0005    WEHGCD           Item Code
     C                     Z-ADDWL0006    WEPFNX           PT Serial Numbe
     C                     MOVELWL0007    WEVPCD           Ship From Wareh
     C                     MOVELWL0008    WEL9AA           Ship To Warehou
     C                     Z-ADDWL0009    WEAODT           Scheduled Ship
     C                     Z-ADDWL0010    WEJ7DT           BOL Complete Da
     C                     Z-ADDWL0011    WEBOTM           BOL Complete Ti
     C                     Z-ADDWL0012    WEWSDT           MDER Receipt Da
     C                     Z-ADDWL0013    WEEETM           MDER Receipt Ti
     C                     MOVELWL0014    WERQNA           Item Descriptio
     C                     Z-ADDWL0015    WEELDT           Production Date
     C                     Z-ADDWL0016    WER0NB           Case Weight
     C                     Z-ADDWL0017    WEN5WG           Manifest Gross
     C                     Z-ADDWL0018    WEFOQT           Case Quantity
     C                     Z-ADDWL0019    WESIQT           Quantity Receiv
     C                     MOVELWL0020    WEGWSC           EWSTD Unused St
     C                     MOVELWL0021    WEGXSC           EWSTD Unused St
     C                     Z-ADDWL0022    WESNQT           Diff/Discrepanc
     C                     Z-ADDWL0023    WESOQT           In Transit Qty
     C                     Z-ADDWL0024    WECINZ           EWSTD Unused Nb
     C                     Z-ADDWL0025    WEP7WG           EWSTD Unused Wg
     C                     Z-ADDWL0026    WEWVDT           EWSTD Unused Dt
     C                     Z-ADDWL0027    WEWWDT           EWSTD Unused Dt
      *
     C           KLCRSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WERMNB           Load ID
     C                     KFLD           WEH7NY           Manifest Pallet
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEPFNX           PT Serial Numbe
      * Check for duplicate primary key
     C           KLCRSF    SETLL@A1CPCN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR5055' W0RTN   7
      * Send message 'WF EDI Whs Stk Txfr Di EX'
     C                     MOVEL'USR5055' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@A1CPCN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * CHG WF Whs StckTxf Dif CH - WF EDI Whs Stk Txfr Diff  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPCN
     C                     Z-ADDWL0028    WEAIC3           Company Number
     C                     Z-ADDWL0029    WEC4NB           Order Number
     C                     Z-ADDWL0030    WERMNB           Load ID
     C                     Z-ADDWL0031    WEH7NY           Manifest Pallet
     C                     Z-ADDWL0032    WEHGCD           Item Code
     C                     Z-ADDWL0033    WEPFNX           PT Serial Numbe
      *
     C           KLCHSG    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WERMNB           Load ID
     C                     KFLD           WEH7NY           Manifest Pallet
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEPFNX           PT Serial Numbe
     C           KLCHSG    CHAIN@A1CPCN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PUA1CPL0'MDACP
     C                     MOVEL'@A1CPCN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPUA11    YARDCS
      * Move non-key fields to @A1CPCN
     C                     MOVELWL0034    WEVPCD    P      Ship From Wareh
     C                     MOVELWL0035    WEL9AA    P      Ship To Warehou
     C                     Z-ADDWL0036    WEAODT           Scheduled Ship
     C                     Z-ADDWL0037    WEJ7DT           BOL Complete Da
     C                     Z-ADDWL0038    WEBOTM           BOL Complete Ti
     C                     Z-ADDWL0039    WEWSDT           MDER Receipt Da
     C                     Z-ADDWL0040    WEEETM           MDER Receipt Ti
     C                     MOVELWL0041    WERQNA    P      Item Descriptio
     C                     Z-ADDWL0042    WEELDT           Production Date
     C                     Z-ADDWL0043    WER0NB           Case Weight
     C                     Z-ADDWL0044    WEN5WG           Manifest Gross
     C                     Z-ADDWL0045    WEFOQT           Case Quantity
     C                     Z-ADDWL0046    WESIQT           Quantity Receiv
     C                     MOVELWL0047    WEGWSC    P      EWSTD Unused St
     C                     MOVELWL0048    WEGXSC    P      EWSTD Unused St
     C                     Z-ADDWL0049    WESNQT           Diff/Discrepanc
     C                     Z-ADDWL0050    WESOQT           In Transit Qty
     C                     Z-ADDWL0051    WECINZ           EWSTD Unused Nb
     C                     Z-ADDWL0052    WEP7WG           EWSTD Unused Wg
     C                     Z-ADDWL0053    WEWVDT           EWSTD Unused Dt
     C                     Z-ADDWL0054    WEWWDT           EWSTD Unused Dt
      *
      * Set PGM.*Record Data Changed flag
     C           QPUA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPCN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPUA1CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Upd WhsStckTxf Diff 2  RT - WF EDI Whs Stk Txfr Diff  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSH02           Order Number
     C           *LIKE     DEFN WFRMNB    WQSH03           Load ID
     C           *LIKE     DEFN WFHGCD    WQSH04           Item Code
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WQSH03           Load ID
     C                     KFLD           WQSH04           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSH01           Company Number
     C                     Z-ADDWAC4NB    WQSH02           Order Number
     C                     Z-ADDWARMNB    WQSH03           Load ID
     C                     Z-ADDWAHGCD    WQSH04           Item Code
      * Establish starting position
     C           KRSSH     SETLL@A1CPD5                    *
     C           KRSSH     READE@A1CPD5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5054' W0RTN   7
      * USER: Processing if Data record not found
      * CRT WF Whs StckTxf Dif CR - WF EDI Whs Stk Txfr Diff  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWARMNB    WL0003           Load ID
     C                     Z-ADDWAH7NY    WL0004           Manifest Pallet
     C                     Z-ADDWAHGCD    WL0005           Item Code
     C                     Z-ADDWAPFNX    WL0006           PT Serial Numbe
     C                     MOVELP2VPCD    WL0007    P      Ship From Wareh
     C                     MOVELP3L9AA    WL0008    P      Ship To Warehou
     C                     Z-ADDP4AODT    WL0009           Scheduled Ship
     C                     Z-ADDP5J7DT    WL0010           BOL Complete Da
     C                     Z-ADDP5BOTM    WL0011           BOL Complete Ti
     C                     Z-ADDWAWSDT    WL0012           MDER Receipt Da
     C                     Z-ADDWAEETM    WL0013           MDER Receipt Ti
     C                     MOVELYL0001    WL0014    P      Item Descriptio
     C                     Z-ADDWAWTDT    WL0015           Production Date
     C                     Z-ADD0         WL0016           Case Weight
     C                     Z-ADD0         WL0017           Manifest Gross
     C                     Z-ADD0         WL0018           Case Quantity
     C                     Z-ADDWASIQT    WL0019           Quantity Receiv
     C                     MOVEL*BLANK    WL0020           EWSTD Unused St
     C                     MOVEL*BLANK    WL0021           EWSTD Unused St
     C                     Z-ADDYL0003    WL0022           Diff/Discrepanc
     C                     Z-ADD0         WL0023           In Transit Qty
     C                     Z-ADD0         WL0024           EWSTD Unused Nb
     C                     Z-ADD0         WL0025           EWSTD Unused Wg
     C                     Z-ADD0         WL0026           EWSTD Unused Dt
     C                     Z-ADD0         WL0027           EWSTD Unused Dt
     C                     EXSR SFCRRC
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Accumulate & Update WF EDI Whs Stk Txfr Diff File.
     C           WFR0NB    ADD  0         YL0007           Case Weight
     C           WFN5WG    ADD  0         YL0008           Manifest Gross
     C           WFFOQT    ADD  0         YL0009           Case Quantity
     C           WFSIQT    ADD  WASIQT    YL0010           Quantity Receiv
     C           WFSNQT    ADD  YL0003    YL0011           Diff/Discrepanc
      * CHG WF Whs StckTxf Dif CH - WF EDI Whs Stk Txfr Diff  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0028           Company Number
     C                     Z-ADDWFC4NB    WL0029           Order Number
     C                     Z-ADDWFRMNB    WL0030           Load ID
     C                     Z-ADDWFH7NY    WL0031           Manifest Pallet
     C                     Z-ADDWFHGCD    WL0032           Item Code
     C                     Z-ADDWFPFNX    WL0033           PT Serial Numbe
     C                     MOVELWFVPCD    WL0034    P      Ship From Wareh
     C                     MOVELWFL9AA    WL0035    P      Ship To Warehou
     C                     Z-ADDWFAODT    WL0036           Scheduled Ship
     C                     Z-ADDWFJ7DT    WL0037           BOL Complete Da
     C                     Z-ADDWFBOTM    WL0038           BOL Complete Ti
     C                     Z-ADDWFWSDT    WL0039           MDER Receipt Da
     C                     Z-ADDWFEETM    WL0040           MDER Receipt Ti
     C                     MOVELWFRQNA    WL0041    P      Item Descriptio
     C                     Z-ADDWFELDT    WL0042           Production Date
     C                     Z-ADDYL0007    WL0043           Case Weight
     C                     Z-ADDYL0008    WL0044           Manifest Gross
     C                     Z-ADDYL0009    WL0045           Case Quantity
     C                     Z-ADDYL0010    WL0046           Quantity Receiv
     C                     MOVELWFGWSC    WL0047    P      EWSTD Unused St
     C                     MOVELWFGXSC    WL0048    P      EWSTD Unused St
     C                     Z-ADDYL0011    WL0049           Diff/Discrepanc
     C                     Z-ADDWFSOQT    WL0050           In Transit Qty
     C                     Z-ADDWFCINZ    WL0051           EWSTD Unused Nb
     C                     Z-ADDWFP7WG    WL0052           EWSTD Unused Wg
     C                     Z-ADDWFWVDT    WL0053           EWSTD Unused Dt
     C                     Z-ADDWFWWDT    WL0054           EWSTD Unused Dt
     C                     EXSR SGCHRC
     C           KRSSH     READE@A1CPD5                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAT4NY           LX01 Sequence N
     C                     Z-ADD*ZERO     WAAXNZ           EDI Case Sequen
     C                     Z-ADD*ZERO     WAA1NZ           EDI Ref Sequenc
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WAPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WASIQT           Quantity Receiv
     C                     Z-ADD*ZERO     WAP5WG           Weight Received
     C                     Z-ADD*ZERO     WAWSDT           MDER Receipt Da
     C                     Z-ADD*ZERO     WAEETM           MDER Receipt Ti
     C                     Z-ADD*ZERO     WAWTDT           MDER Production
     C                     Z-ADD*ZERO     WACHNZ           MDER Unused Nbr
     C                     Z-ADD*ZERO     WASKQT           MDER Unused Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Item Category N
     C                     Z-ADD*ZERO     WBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Production Lead
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WBILNB           Packages per ca
     C                     Z-ADD*ZERO     WBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           Package Level s
     C                     Z-ADD*ZERO     WBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WBCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WBBNNB           Production Qty
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WCFOQT           Case Quantity
     C                     Z-ADD*ZERO     WCR0NB           Case Weight
     C                     Z-ADD*ZERO     WCK7DT           Label Date
     C                     Z-ADD*ZERO     WCPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WCH5NY           Manifest Total
     C                     Z-ADD*ZERO     WCH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WCH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WCN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WCN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WCRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WCIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WCIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WCIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WCIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDWSDT           MDER Receipt Da
     C                     Z-ADD*ZERO     WDEETM           MDER Receipt Ti
     C                     Z-ADD*ZERO     WDELDT           Production Date
     C                     Z-ADD*ZERO     WDR0NB           Case Weight
     C                     Z-ADD*ZERO     WDN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WDFOQT           Case Quantity
     C                     Z-ADD*ZERO     WDSIQT           Quantity Receiv
     C                     Z-ADD*ZERO     WDSNQT           Diff/Discrepanc
     C                     Z-ADD*ZERO     WDSOQT           In Transit Qty
     C                     Z-ADD*ZERO     WDCINZ           EWSTD Unused Nb
     C                     Z-ADD*ZERO     WDP7WG           EWSTD Unused Wg
     C                     Z-ADD*ZERO     WDWVDT           EWSTD Unused Dt
     C                     Z-ADD*ZERO     WDWWDT           EWSTD Unused Dt
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  90
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  80
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  3
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  60
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  60
     C                     MOVEL*BLANK    WL0014 30
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018  50
     C                     Z-ADD*ZERO     WL0019  50
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
     C                     Z-ADD*ZERO     WL0022  50
     C                     Z-ADD*ZERO     WL0023  50
     C                     Z-ADD*ZERO     WL0024  90
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026  70
     C                     Z-ADD*ZERO     WL0027  70
      * Define local variables for subroutine SGCHRC.
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  90
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  80
     C                     MOVEL*BLANK    WL0034  3
     C                     MOVEL*BLANK    WL0035  3
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037  70
     C                     Z-ADD*ZERO     WL0038  60
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040  60
     C                     MOVEL*BLANK    WL0041 30
     C                     Z-ADD*ZERO     WL0042  70
     C                     Z-ADD*ZERO     WL0043 112
     C                     Z-ADD*ZERO     WL0044 112
     C                     Z-ADD*ZERO     WL0045  50
     C                     Z-ADD*ZERO     WL0046  50
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     Z-ADD*ZERO     WL0049  50
     C                     Z-ADD*ZERO     WL0050  50
     C                     Z-ADD*ZERO     WL0051  90
     C                     Z-ADD*ZERO     WL0052 112
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  70
      * Define local work field Item Description Line 1
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0002  70
      * Define null work field Description Line Two
     C                     MOVEL*BLANK    YN0001 30
      * Define local work field Diff/Discrepancy Qty
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Quantity Received
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field Diff/Discrepancy Qty
     C                     Z-ADD*ZERO     YL0005  50
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Case Weight
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Manifest Gross Weight
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field Case Quantity
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field Quantity Received
     C                     Z-ADD*ZERO     YL0010  50
      * Define local work field Diff/Discrepancy Qty
     C                     Z-ADD*ZERO     YL0011  50
      *================================================================
     CSR         ZZEXIT    ENDSR
