     H/TITLE PFS Order Header/Dtl  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISELOUC
     H* Date          : 06/09/23  Time  : 15:45:48
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPOBIREL1IF  E           K        DISK
      * RTV : Customer Item Reference   Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPBBTREL1IF  E           K        DISK
      * RTV : Item Default Extension    Retrieval index
      *
     FPPBCCPL1IF  E           K        DISK
      * RTV : PFS Order Detail          Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPPBDCPL1IF  E           K        DISK
      * RTV : PFS Order BOL Comment     Retrieval index
      *
     FOPCOCPL1IF  E           K        DISK
      * RTV : Order Comment             Retrieval index       NV
      *
     FPPB1REL1IF  E           K        DISK
      * RTV : Country Comment           Retrieval index
      *
     FPOAVCPL1IF  E           K        DISK
      * RTV : Customer Comment          Retrieval index
      *
     FPUC8REL2IF  E           K        DISK
      * RSQ : Regulation Code Mst       Reg Code Mst By Regul ID
      *
     FPUAAREL1IF  E           K        DISK
      * RTV : Customer EXT2             Retrieval index
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FPPBBCPL1IF  E           K        DISK
      * RTV : PFS Order Header          Retrieval index
      *
     FPPBCCPL0UF  E           K        DISK                      A
      * UPD : PFS Order Detail          Update index
      *
     FPPBDCPL0UF  E           K        DISK                      A
      * UPD : PFS Order BOL Comment     Update index
      *
     FPPBBCPL0UF  E           K        DISK                      A
      * UPD : PFS Order Header          Update index
      *
     E                    YDOW        7  1               *Days of week
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WFBKC7
     I              BBAYTX                          WFAYTX
     I              BBACNA                          WFACNA
     I              BBADNA                          WFADNA
     I              BBAENA                          WFAENA
     I              BBAJNA                          WFAJNA
     I              BBBGCD                          WFBGCD
     I              BBG5CD                          WFG5CD
     I              BBBTTX                          WFBTTX
     I              BBBVTX                          WFBVTX
     I              BBBWTX                          WFBWTX
     I              BBABTX                          WFABTX
     I              BBA2NA                          WFA2NA
     I              BBCBST                          WFCBST
     I              BBB0NA                          WFB0NA
     I              BBP3NB                          WFP3NB
     I              BBAXNA                          WFAXNA
     I              BBI6DT                          WFI6DT
     I              BBAYDT                          WFAYDT
     I              BBANC7                          WFANC7
     I              BBBTC7                          WFBTC7
     I              BBK6ST                          WFK6ST
     I              BBUZST                          WFUZST
     I              BBKXCD                          WFKXCD
     I              BBLTCD                          WFLTCD
     I              BBQNST                          WFQNST
     I              BBS2NB                          WFS2NB
     I              BBVHVA                          WFVHVA
     I              BBI7DT                          WFI7DT
     I              BBRJST                          WFRJST
     I              BBRKST                          WFRKST
     I              BBQWST                          WFQWST
     I              BBQXST                          WFQXST
     I              BBQYST                          WFQYST
     I              BBUNCS                          WFUNCS
     I              BBUVST                          WFUVST
     I              BBUWST                          WFUWST
     I              BBUXST                          WFUXST
     I              BBVSST                          WFVSST
     I              BBAATM                          WFAATM
     I              BBAYNA                          WFAYNA
     I              BBA0NA                          WFA0NA
     I              BBAXDT                          WFAXDT
      *
     I@BIREKY
      * Customer Item Reference   Retrieval index
      * Renamed input format fields
     I              BIBKC7                          WGBKC7
     I              BIHGCD                          WGHGCD
     I              BICOAA                          WGCOAA
     I              BICPAA                          WGCPAA
     I              BIPSNA                          WGPSNA
     I              BIPTNA                          WGPTNA
     I              BIPUNA                          WGPUNA
     I              BILBSX                          WGLBSX
     I              BILCSX                          WGLCSX
     I              BILDSX                          WGLDSX
     I              BILESX                          WGLESX
     I              BILFSX                          WGLFSX
     I              BIVSST                          WGVSST
     I              BIMJDT                          WGMJDT
     I              BIBETM                          WGBETM
     I              BICCVN                          WGCCVN
     I              BICDVN                          WGCDVN
     I              BIMKDT                          WGMKDT
     I              BIBFTM                          WGBFTM
     I              BICEVN                          WGCEVN
     I              BICFVN                          WGCFVN
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WHAIC3
     I              EOBKC7                          WHBKC7
     I              EOAQCD                          WHAQCD
     I              EOR4CD                          WHR4CD
     I              EOBYNA                          WHBYNA
     I              EOB6NA                          WHB6NA
     I              EOBZNA                          WHBZNA
     I              EOLLST                          WHLLST
     I              EOPPST                          WHPPST
     I              EOR5NB                          WHR5NB
     I              EOR6NB                          WHR6NB
     I              EOQGST                          WHQGST
     I              EOBOCD                          WHBOCD
     I              EOTBNB                          WHTBNB
     I              EOMTCU                          WHMTCU
     I              EOW2NB                          WHW2NB
     I              EORPCD                          WHRPCD
     I              EOAJCD                          WHAJCD
     I              EOX9ST                          WHX9ST
     I              EOT9CD                          WHT9CD
     I              EOUBCD                          WHUBCD
     I              EOISTX                          WHISTX
     I              EOLQCD                          WHLQCD
     I              EONJNA                          WHNJNA
     I              EOI0TX                          WHI0TX
     I              EONKNA                          WHNKNA
     I              EOI1TX                          WHI1TX
     I              EOVLST                          WHVLST
     I              EORLST                          WHRLST
     I              EOMMTX                          WHMMTX
     I              EOOHNA                          WHOHNA
     I              EOQ6ST                          WHQ6ST
     I              EOQ8ST                          WHQ8ST
     I              EORBST                          WHRBST
     I              EOREST                          WHREST
     I              EOUVST                          WHUVST
     I              EOUWST                          WHUWST
     I              EOUXST                          WHUXST
     I              EOVSST                          WHVSST
     I              EOAATM                          WHAATM
     I              EOAYNA                          WHAYNA
     I              EOA0NA                          WHA0NA
     I              EOAXDT                          WHAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WIAIC3
     I              AFBCDT                          WIBCDT
     I              AFCQNB                          WICQNB
     I              AFESNB                          WIESNB
     I              AFETNB                          WIETNB
     I              AFBZNB                          WIBZNB
     I              AFA9ST                          WIA9ST
     I              AFEINB                          WIEINB
     I              AFC5ST                          WIC5ST
     I              AFAQNB                          WIAQNB
     I              AFCMST                          WICMST
     I              AFV9ST                          WIV9ST
     I              AFWAST                          WIWAST
     I              AFX2ST                          WIX2ST
     I              AFOJDT                          WIOJDT
     I              AFNQNX                          WINQNX
     I              AFNRNX                          WINRNX
     I              AFI9SX                          WII9SX
     I              AFJASX                          WIJASX
     I              AFOKDT                          WIOKDT
     I              AFOLDT                          WIOLDT
     I              AFUVST                          WIUVST
     I              AFUWST                          WIUWST
     I              AFUXST                          WIUXST
     I              AFAATM                          WIAATM
     I              AFAYNA                          WIAYNA
     I              AFA0NA                          WIA0NA
     I              AFAXDT                          WIAXDT
      *
     I@IORETI
      * Item Bill Of Material     Retrieval index
      * Renamed input format fields
     I              IOAIC3                          WJAIC3
     I              IOHGCD                          WJHGCD
     I              IOC9NB                          WJC9NB
     I              IOV2ST                          WJV2ST
     I              IOBOPR                          WJBOPR
     I              IOBPPR                          WJBPPR
     I              IOHGQT                          WJHGQT
     I              IOHHCD                          WJHHCD
     I              IOYAST                          WJYAST
     I              IOCNSM                          WJCNSM
     I              IOBMY1                          WJBMY1
     I              IOBMY2                          WJBMY2
     I              IOIXQT                          WJIXQT
     I              IOIYQT                          WJIYQT
     I              IORSST                          WJRSST
     I              IORTST                          WJRTST
     I              IOUVST                          WJUVST
     I              IOUWST                          WJUWST
     I              IOUXST                          WJUXST
     I              IOVSST                          WJVSST
     I              IOAATM                          WJAATM
     I              IOAYNA                          WJAYNA
     I              IOA0NA                          WJA0NA
     I              IOAXDT                          WJAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WKAIC3
     I              BZHGCD                          WKHGCD
     I              BZAVNA                          WKAVNA
     I              BZAWNA                          WKAWNA
     I              BZL7NA                          WKL7NA
     I              BZL8NA                          WKL8NA
     I              BZL6NA                          WKL6NA
     I              BZMFNA                          WKMFNA
     I              BZADCD                          WKADCD
     I              BZAWPC                          WKAWPC
     I              BZLXST                          WKLXST
     I              BZAECD                          WKAECD
     I              BZAXPC                          WKAXPC
     I              BZLYST                          WKLYST
     I              BZAFCD                          WKAFCD
     I              BZAICD                          WKAICD
     I              BZAIWG                          WKAIWG
     I              BZHICD                          WKHICD
     I              BZRBCD                          WKRBCD
     I              BZFZST                          WKFZST
     I              BZAVST                          WKAVST
     I              BZCZWG                          WKCZWG
     I              BZC0WG                          WKC0WG
     I              BZURTN                          WKURTN
     I              BZAJC8                          WKAJC8
     I              BZRINB                          WKRINB
     I              BZRHNB                          WKRHNB
     I              BZRGNB                          WKRGNB
     I              BZLNCD                          WKLNCD
     I              BZTFNB                          WKTFNB
     I              BZN0CD                          WKN0CD
     I              BZX4ST                          WKX4ST
     I              BZTMVA                          WKTMVA
     I              BZTNVA                          WKTNVA
     I              BZBLPR                          WKBLPR
     I              BZBMPR                          WKBMPR
     I              BZLRCD                          WKLRCD
     I              BZU9ST                          WKU9ST
     I              BZCMCO                          WKCMCO
     I              BZQ1CD                          WKQ1CD
     I              BZQ8CD                          WKQ8CD
     I              BZCHTM                          WKCHTM
     I              BZQZCD                          WKQZCD
     I              BZXWST                          WKXWST
     I              BZXXST                          WKXXST
     I              BZVMST                          WKVMST
     I              BZSWGH                          WKSWGH
     I              BZPPHE                          WKPPHE
     I              BZR3CD                          WKR3CD
     I              BZSDCD                          WKSDCD
     I              BZICN1                          WKICN1
     I              BZSVCD                          WKSVCD
     I              BZICN2                          WKICN2
     I              BZSWCD                          WKSWCD
     I              BZV2NB                          WKV2NB
     I              BZSXCD                          WKSXCD
     I              BZITCN                          WKITCN
     I              BZSYCD                          WKSYCD
     I              BZITC5                          WKITC5
     I              BZSZCD                          WKSZCD
     I              BZICN6                          WKICN6
     I              BZS0CD                          WKS0CD
     I              BZICN7                          WKICN7
     I              BZS1CD                          WKS1CD
     I              BZICN8                          WKICN8
     I              BZS2CD                          WKS2CD
     I              BZICN9                          WKICN9
     I              BZS3CD                          WKS3CD
     I              BZICN0                          WKICN0
     I              BZS4CD                          WKS4CD
     I              BZSFNB                          WKSFNB
     I              BZA3WG                          WKA3WG
     I              BZSJNB                          WKSJNB
     I              BZLLCD                          WKLLCD
     I              BZLMCD                          WKLMCD
     I              BZP3ST                          WKP3ST
     I              BZSKNB                          WKSKNB
     I              BZSLNB                          WKSLNB
     I              BZSMNB                          WKSMNB
     I              BZP4ST                          WKP4ST
     I              BZCFNB                          WKCFNB
     I              BZCGNB                          WKCGNB
     I              BZILNB                          WKILNB
     I              BZCHNB                          WKCHNB
     I              BZCINB                          WKCINB
     I              BZCJNB                          WKCJNB
     I              BZCMNB                          WKCMNB
     I              BZCNNB                          WKCNNB
     I              BZCRNB                          WKCRNB
     I              BZCSNB                          WKCSNB
     I              BZCVNB                          WKCVNB
     I              BZCWNB                          WKCWNB
     I              BZCXNB                          WKCXNB
     I              BZCZNB                          WKCZNB
     I              BZC0NB                          WKC0NB
     I              BZN1CD                          WKN1CD
     I              BZB4NB                          WKB4NB
     I              BZB5NB                          WKB5NB
     I              BZX5ST                          WKX5ST
     I              BZX6ST                          WKX6ST
     I              BZX7ST                          WKX7ST
     I              BZPCCT                          WKPCCT
     I              BZBDNB                          WKBDNB
     I              BZBJNB                          WKBJNB
     I              BZSUST                          WKSUST
     I              BZSVST                          WKSVST
     I              BZSYST                          WKSYST
     I              BZSZST                          WKSZST
     I              BZS1ST                          WKS1ST
     I              BZXRCD                          WKXRCD
     I              BZXTCD                          WKXTCD
     I              BZXUCD                          WKXUCD
     I              BZF5WG                          WKF5WG
     I              BZF6WG                          WKF6WG
     I              BZF7WG                          WKF7WG
     I              BZBLNB                          WKBLNB
     I              BZBNNB                          WKBNNB
     I              BZS2ST                          WKS2ST
     I              BZS4ST                          WKS4ST
     I              BZS5ST                          WKS5ST
     I              BZS6ST                          WKS6ST
     I              BZS8ST                          WKS8ST
     I              BZS9ST                          WKS9ST
     I              BZTCST                          WKTCST
     I              BZTDST                          WKTDST
     I              BZUVST                          WKUVST
     I              BZUWST                          WKUWST
     I              BZUXST                          WKUXST
     I              BZVSST                          WKVSST
     I              BZAATM                          WKAATM
     I              BZAYNA                          WKAYNA
     I              BZA0NA                          WKA0NA
     I              BZAXDT                          WKAXDT
      *
     I@BTRETK
      * Item Default Extension    Retrieval index
      * Renamed input format fields
     I              BTHGCD                          WLHGCD
     I              BTCUU1                          WLCUU1
     I              BTALSC                          WLALSC
     I              BTAMSC                          WLAMSC
     I              BTANSC                          WLANSC
     I              BTAOSC                          WLAOSC
     I              BTAPSC                          WLAPSC
     I              BTAQSC                          WLAQSC
     I              BTARSC                          WLARSC
     I              BTASSC                          WLASSC
     I              BTCVU1                          WLCVU1
     I              BTKXU1                          WLKXU1
     I              BTKYU1                          WLKYU1
     I              BTKZU1                          WLKZU1
     I              BTDXNZ                          WLDXNZ
     I              BTDYNZ                          WLDYNZ
     I              BTVSST                          WLVSST
     I              BTMJDT                          WLMJDT
     I              BTBETM                          WLBETM
     I              BTCCVN                          WLCCVN
     I              BTCDVN                          WLCDVN
     I              BTMKDT                          WLMKDT
     I              BTBFTM                          WLBFTM
     I              BTCEVN                          WLCEVN
     I              BTCFVN                          WLCFVN
      *
     I@BCCPZP
      * PFS Order Detail          Retrieval index
      * Renamed input format fields
     I              BCY1NX                          WMY1NX
     I              BCZPNX                          WMZPNX
     I              BCZXNX                          WMZXNX
     I              BCZYNX                          WMZYNX
     I              BCY2NX                          WMY2NX
     I              BCGIT1                          WMGIT1
     I              BCGGT1                          WMGGT1
     I              BCGHT1                          WMGHT1
     I              BCVFSX                          WMVFSX
     I              BCVGSX                          WMVGSX
     I              BCVHSX                          WMVHSX
     I              BCVISX                          WMVISX
     I              BCF8AA                          WMF8AA
     I              BCV4SX                          WMV4SX
     I              BCF9AA                          WMF9AA
     I              BCZFNX                          WMZFNX
     I              BCZZNX                          WMZZNX
     I              BCZ0NX                          WMZ0NX
     I              BCBINY                          WMBINY
     I              BCBJNY                          WMBJNY
     I              BCBKNY                          WMBKNY
     I              BCATNY                          WMATNY
     I              BCALD8                          WMALD8
     I              BCAMD8                          WMAMD8
     I              BCF5NY                          WMF5NY
     I              BCZISX                          WMZISX
     I              BCZJSX                          WMZJSX
     I              BCZKSX                          WMZKSX
     I              BCZLSX                          WMZLSX
     I              BCZMSX                          WMZMSX
     I              BCUWSX                          WMUWSX
     I              BCUXSX                          WMUXSX
     I              BCV3SX                          WMV3SX
     I              BCAHNY                          WMAHNY
     I              BCAINY                          WMAINY
     I              BCAJNY                          WMAJNY
     I              BCAKNY                          WMAKNY
      *
     I@BCCPZO
      * PFS Order Detail          Update index
      * Renamed input format fields
     I              BCY1NX                          WOY1NX
     I              BCZPNX                          WOZPNX
     I              BCZXNX                          WOZXNX
     I              BCZYNX                          WOZYNX
     I              BCY2NX                          WOY2NX
     I              BCGIT1                          WOGIT1
     I              BCGGT1                          WOGGT1
     I              BCGHT1                          WOGHT1
     I              BCVFSX                          WOVFSX
     I              BCVGSX                          WOVGSX
     I              BCVHSX                          WOVHSX
     I              BCVISX                          WOVISX
     I              BCF8AA                          WOF8AA
     I              BCV4SX                          WOV4SX
     I              BCF9AA                          WOF9AA
     I              BCZFNX                          WOZFNX
     I              BCZZNX                          WOZZNX
     I              BCZ0NX                          WOZ0NX
     I              BCBINY                          WOBINY
     I              BCBJNY                          WOBJNY
     I              BCBKNY                          WOBKNY
     I              BCATNY                          WOATNY
     I              BCALD8                          WOALD8
     I              BCAMD8                          WOAMD8
     I              BCF5NY                          WOF5NY
     I              BCZISX                          WOZISX
     I              BCZJSX                          WOZJSX
     I              BCZKSX                          WOZKSX
     I              BCZLSX                          WOZLSX
     I              BCZMSX                          WOZMSX
     I              BCUWSX                          WOUWSX
     I              BCUXSX                          WOUXSX
     I              BCV3SX                          WOV3SX
     I              BCAHNY                          WOAHNY
     I              BCAINY                          WOAINY
     I              BCAJNY                          WOAJNY
     I              BCAKNY                          WOAKNY
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WRAIC3
     I              AMC4NB                          WRC4NB
     I              AMRMNB                          WRRMNB
     I              AMRUNB                          WRRUNB
     I              AMXACD                          WRXACD
     I              AMOANA                          WROANA
     I              AMHBAA                          WRHBAA
     I              AMJ0T1                          WRJ0T1
     I              AMGENY                          WRGENY
     I              AMJ1T1                          WRJ1T1
     I              AMHCAA                          WRHCAA
     I              AMQWDT                          WRQWDT
     I              AMQXDT                          WRQXDT
     I              AMQYDT                          WRQYDT
     I              AMHDAA                          WRHDAA
     I              AMCCTX                          WRCCTX
     I              AMJ2T1                          WRJ2T1
     I              AMRLNA                          WRRLNA
     I              AMRMNA                          WRRMNA
     I              AMGINY                          WRGINY
     I              AMGFNY                          WRGFNY
     I              AMGGNY                          WRGGNY
     I              AMGHNY                          WRGHNY
     I              AMHEVL                          WRHEVL
     I              AMHFVL                          WRHFVL
     I              AMHGVL                          WRHGVL
     I              AMQZDT                          WRQZDT
     I              AMQ0DT                          WRQ0DT
     I              AMQ1DT                          WRQ1DT
     I              AMQ2DT                          WRQ2DT
     I              AMC2TX                          WRC2TX
     I              AMC3TX                          WRC3TX
     I              AMC6TX                          WRC6TX
     I              AMCHTX                          WRCHTX
     I              AMCITX                          WRCITX
     I              AMCLTX                          WRCLTX
     I              AMB4TX                          WRB4TX
     I              AMCUTX                          WRCUTX
     I              AMCVTX                          WRCVTX
     I              AMB9TX                          WRB9TX
     I              AMJWSC                          WRJWSC
     I              AMITNY                          WRITNY
     I              AMLMT1                          WRLMT1
     I              AMLWAA                          WRLWAA
     I              AMFVST                          WRFVST
     I              AMF0ST                          WRF0ST
     I              AMF2ST                          WRF2ST
     I              AMF3ST                          WRF3ST
     I              AMJUSC                          WRJUSC
     I              AMJVSC                          WRJVSC
     I              AMV3T1                          WRV3T1
     I              AMV4T1                          WRV4T1
     I              AMV5T1                          WRV5T1
     I              AMV6T1                          WRV6T1
     I              AMV7T1                          WRV7T1
     I              AMV8T1                          WRV8T1
     I              AMV9T1                          WRV9T1
     I              AMWAT1                          WRWAT1
     I              AMWBT1                          WRWBT1
     I              AMWCT1                          WRWCT1
     I              AMWDT1                          WRWDT1
     I              AMQJNY                          WRQJNY
     I              AMQKNY                          WRQKNY
     I              AMQLNY                          WRQLNY
     I              AMP8NY                          WRP8NY
     I              AMP9NY                          WRP9NY
     I              AMQANY                          WRQANY
     I              AMQCNY                          WRQCNY
     I              AMQDNY                          WRQDNY
     I              AMQENY                          WRQENY
     I              AMQFNY                          WRQFNY
     I              AMQGNY                          WRQGNY
     I              AMQHNY                          WRQHNY
     I              AMQINY                          WRQINY
     I              AMQMNY                          WRQMNY
     I              AMMYU1                          WRMYU1
     I              AMJXSC                          WRJXSC
     I              AMJYSC                          WRJYSC
     I              AMJZSC                          WRJZSC
     I              AMJ0SC                          WRJ0SC
     I              AMMZU1                          WRMZU1
     I              AMM0U1                          WRM0U1
     I              AMM1U1                          WRM1U1
     I              AMM2U1                          WRM2U1
     I              AMM3U1                          WRM3U1
     I              AMW5DT                          WRW5DT
     I              AMW6DT                          WRW6DT
     I              AMUVST                          WRUVST
     I              AMUWST                          WRUWST
     I              AMUXST                          WRUXST
     I              AMVSST                          WRVSST
     I              AMAATM                          WRAATM
     I              AMAYNA                          WRAYNA
     I              AMA0NA                          WRA0NA
     I              AMAXDT                          WRAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WSAIC3
     I              JYZ9ST                          WSZ9ST
     I              JYCSST                          WSCSST
     I              JYZ8ST                          WSZ8ST
     I              JYCXST                          WSCXST
     I              JYSWST                          WSSWST
     I              JYXXTM                          WSXXTM
     I              JYUECD                          WSUECD
     I              JYHSST                          WSHSST
     I              JYAMEO                          WSAMEO
     I              JYSSDF                          WSSSDF
     I              JYPDFT                          WSPDFT
     I              JYYISX                          WSYISX
     I              JYYJSX                          WSYJSX
     I              JYYKSX                          WSYKSX
     I              JYYLSX                          WSYLSX
     I              JYYMSX                          WSYMSX
     I              JYYNSX                          WSYNSX
     I              JYUVST                          WSUVST
     I              JYUWST                          WSUWST
     I              JYUXST                          WSUXST
     I              JYVSST                          WSVSST
     I              JYAATM                          WSAATM
     I              JYAYNA                          WSAYNA
     I              JYA0NA                          WSA0NA
     I              JYAXDT                          WSAXDT
      *
     I@BDCPAB
      * PFS Order BOL Comment     Retrieval index
      * Renamed input format fields
     I              BDY1NX                          WTY1NX
     I              BDZPNX                          WTZPNX
     I              BDIZST                          WTIZST
     I              BDZ1NX                          WTZ1NX
     I              BDGJT1                          WTGJT1
     I              BDUWSX                          WTUWSX
     I              BDUXSX                          WTUXSX
     I              BDV3SX                          WTV3SX
     I              BDAHNY                          WTAHNY
     I              BDAINY                          WTAINY
     I              BDAJNY                          WTAJNY
     I              BDAKNY                          WTAKNY
      *
     I@BDCPAA
      * PFS Order BOL Comment     Update index
      * Renamed input format fields
     I              BDY1NX                          WVY1NX
     I              BDZPNX                          WVZPNX
     I              BDIZST                          WVIZST
     I              BDZ1NX                          WVZ1NX
     I              BDGJT1                          WVGJT1
     I              BDUWSX                          WVUWSX
     I              BDUXSX                          WVUXSX
     I              BDV3SX                          WVV3SX
     I              BDAHNY                          WVAHNY
     I              BDAINY                          WVAINY
     I              BDAJNY                          WVAJNY
     I              BDAKNY                          WVAKNY
      *
     I@COCPNU
      * Order Comment             Retrieval index       NV
      * Renamed input format fields
     I              COAIC3                          WWAIC3
     I              COC4NB                          WWC4NB
     I              COI1SX                          WWI1SX
     I              CODXNB                          WWDXNB
     I              COG4NA                          WWG4NA
     I              COUVST                          WWUVST
     I              COUWST                          WWUWST
     I              COUXST                          WWUXST
     I              COAATM                          WWAATM
     I              COAYNA                          WWAYNA
     I              COA0NA                          WWA0NA
     I              COAXDT                          WWAXDT
      *
     I@B1REED
      * Country Comment           Retrieval index
      * Renamed input format fields
     I              B1KXCD                          WXKXCD
     I              B1I1SX                          WXI1SX
     I              B1M5NX                          WXM5NX
     I              B1Q6NA                          WXQ6NA
     I              B1UVST                          WXUVST
     I              B1UWST                          WXUWST
     I              B1UXST                          WXUXST
     I              B1VSST                          WXVSST
     I              B1AATM                          WXAATM
     I              B1AYNA                          WXAYNA
     I              B1A0NA                          WXA0NA
     I              B1AXDT                          WXAXDT
      *
     I@AVCPG4
      * Customer Comment          Retrieval index
      * Renamed input format fields
     I              AVBKC7                          WYBKC7
     I              AVI1SX                          WYI1SX
     I              AVM5NX                          WYM5NX
     I              AVXRTX                          WYXRTX
     I              AVUVST                          WYUVST
     I              AVUWST                          WYUWST
     I              AVUXST                          WYUXST
     I              AVVSST                          WYVSST
     I              AVAATM                          WYAATM
     I              AVAYNA                          WYAYNA
     I              AVA0NA                          WYA0NA
     I              AVAXDT                          WYAXDT
      *
     I@C8REMY
      * Regulation Code Mst       Reg Code Mst By Regul ID
      * Renamed input format fields
     I              C8CAAB                          TACAAB
     I              C8CBAB                          TACBAB
     I              C8CCAB                          TACCAB
     I              C8UVU1                          TAUVU1
     I              C8UWU1                          TAUWU1
     I              C8CDAB                          TACDAB
     I              C8OHSC                          TAOHSC
     I              C8UXU1                          TAUXU1
     I              C8UYU1                          TAUYU1
     I              C8UZU1                          TAUZU1
     I              C8U0U1                          TAU0U1
     I              C8VSST                          TAVSST
     I              C8MJDT                          TAMJDT
     I              C8BETM                          TABETM
     I              C8CCVN                          TACCVN
     I              C8CDVN                          TACDVN
     I              C8MKDT                          TAMKDT
     I              C8BFTM                          TABFTM
     I              C8CEVN                          TACEVN
     I              C8CFVN                          TACFVN
      *
     I@AAREY9
      * Customer EXT2             Retrieval index
      * Renamed input format fields
     I              AABKC7                          TBBKC7
     I              AAVEAA                          TBVEAA
     I              AAD9SC                          TBD9SC
     I              AAZZAA                          TBZZAA
     I              AAK8SC                          TBK8SC
     I              AAK5SC                          TBK5SC
     I              AAK6SC                          TBK6SC
     I              AAK7SC                          TBK7SC
     I              AAZ3AA                          TBZ3AA
     I              AAZ4AA                          TBZ4AA
     I              AAZ5AA                          TBZ5AA
     I              AAGBNZ                          TBGBNZ
     I              AAFCNZ                          TBFCNZ
     I              AAXKDT                          TBXKDT
     I              AAEPTM                          TBEPTM
     I              AAO1U1                          TBO1U1
     I              AALWSC                          TBLWSC
     I              AAAKAB                          TBAKAB
     I              AAGANZ                          TBGANZ
     I              AAEOTM                          TBEOTM
     I              AAVSST                          TBVSST
     I              AAMJDT                          TBMJDT
     I              AABETM                          TBBETM
     I              AACCVN                          TBCCVN
     I              AACDVN                          TBCDVN
     I              AAMKDT                          TBMKDT
     I              AABFTM                          TBBFTM
     I              AACEVN                          TBCEVN
     I              AACFVN                          TBCFVN
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          TCBKC7
     I              NEUFTX                          TCUFTX
     I              NEUGTX                          TCUGTX
     I              NEPFNA                          TCPFNA
     I              NEJ5NX                          TCJ5NX
     I              NEU5TX                          TCU5TX
     I              NEU6TX                          TCU6TX
     I              NEW0TX                          TCW0TX
     I              NEHSSX                          TCHSSX
     I              NEHUSX                          TCHUSX
     I              NEHVSX                          TCHVSX
     I              NEAAC8                          TCAAC8
     I              NEP0SX                          TCP0SX
     I              NEP1SX                          TCP1SX
     I              NEP2SX                          TCP2SX
     I              NEP3SX                          TCP3SX
     I              NEP4SX                          TCP4SX
     I              NEP5SX                          TCP5SX
     I              NEP6SX                          TCP6SX
     I              NEUVST                          TCUVST
     I              NEUWST                          TCUWST
     I              NEUXST                          TCUXST
     I              NEVSST                          TCVSST
     I              NEAATM                          TCAATM
     I              NEAYNA                          TCAYNA
     I              NEA0NA                          TCA0NA
     I              NEAXDT                          TCAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          TDRMNB
     I              FLRUNB                          TDRUNB
     I              FLRVNB                          TDRVNB
     I              FLDQTX                          TDDQTX
     I              FLRWNB                          TDRWNB
     I              FLRXNB                          TDRXNB
     I              FLSQNB                          TDSQNB
     I              FLT0NB                          TDT0NB
     I              FLT1NB                          TDT1NB
     I              FLR1NB                          TDR1NB
     I              FLAIC3                          TDAIC3
     I              FLC4NB                          TDC4NB
     I              FLVCST                          TDVCST
     I              FLKEDT                          TDKEDT
     I              FLSXNB                          TDSXNB
     I              FLKFDT                          TDKFDT
     I              FLACTM                          TDACTM
     I              FLK5TX                          TDK5TX
     I              FLW5CD                          TDW5CD
     I              FLEJDT                          TDEJDT
     I              FLAGTM                          TDAGTM
     I              FLKJDT                          TDKJDT
     I              FLATTM                          TDATTM
     I              FLHDDT                          TDHDDT
     I              FLAUTM                          TDAUTM
     I              FLKKDT                          TDKKDT
     I              FLAVTM                          TDAVTM
     I              FLZ4NB                          TDZ4NB
     I              FLY7ST                          TDY7ST
     I              FLY2ST                          TDY2ST
     I              FLWHTX                          TDWHTX
     I              FLWITX                          TDWITX
     I              FLWJTX                          TDWJTX
     I              FLWKTX                          TDWKTX
     I              FLWLTX                          TDWLTX
     I              FLN7DT                          TDN7DT
     I              FLN8DT                          TDN8DT
     I              FLN9DT                          TDN9DT
     I              FLB3TM                          TDB3TM
     I              FLB4TM                          TDB4TM
     I              FLB5TM                          TDB5TM
     I              FLIASX                          TDIASX
     I              FLIBSX                          TDIBSX
     I              FLICSX                          TDICSX
     I              FLWVTX                          TDWVTX
     I              FLWWTX                          TDWWTX
     I              FLWXTX                          TDWXTX
     I              FLUVST                          TDUVST
     I              FLUWST                          TDUWST
     I              FLUXST                          TDUXST
     I              FLAATM                          TDAATM
     I              FLAYNA                          TDAYNA
     I              FLA0NA                          TDA0NA
     I              FLAXDT                          TDAXDT
      *
     I@LCREL2
      * Shipping Line/Port        Retrieval index
      * Renamed input format fields
     I              LCXACD                          TEXACD
     I              LCOANA                          TEOANA
     I              LCOKTX                          TEOKTX
     I              LCLBTX                          TELBTX
     I              LCLATX                          TELATX
     I              LCXBCD                          TEXBCD
     I              LCLCTX                          TELCTX
     I              LCSPPN                          TESPPN
     I              LCLDTX                          TELDTX
     I              LCPYAA                          TEPYAA
     I              LCUVST                          TEUVST
     I              LCUWST                          TEUWST
     I              LCUXST                          TEUXST
     I              LCVSST                          TEVSST
     I              LCAATM                          TEAATM
     I              LCAYNA                          TEAYNA
     I              LCA0NA                          TEA0NA
     I              LCAXDT                          TEAXDT
      *
     I@BBCPZS
      * PFS Order Header          Retrieval index
      * Renamed input format fields
     I              BBY1NX                          TFY1NX
     I              BBZPNX                          TFZPNX
     I              BBZGNX                          TFZGNX
     I              BBZWNX                          TFZWNX
     I              BBZVNX                          TFZVNX
     I              BBVCSX                          TFVCSX
     I              BBZQNX                          TFZQNX
     I              BBF0T1                          TFF0T1
     I              BBF1T1                          TFF1T1
     I              BBF2T1                          TFF2T1
     I              BBGUT1                          TFGUT1
     I              BBF3T1                          TFF3T1
     I              BBF4T1                          TFF4T1
     I              BBF5T1                          TFF5T1
     I              BBF6T1                          TFF6T1
     I              BBF7T1                          TFF7T1
     I              BBZENX                          TFZENX
     I              BBF8T1                          TFF8T1
     I              BBF9T1                          TFF9T1
     I              BBGAT1                          TFGAT1
     I              BBGVT1                          TFGVT1
     I              BBGBT1                          TFGBT1
     I              BBGCT1                          TFGCT1
     I              BBGDT1                          TFGDT1
     I              BBFZT1                          TFFZT1
     I              BBZRNX                          TFZRNX
     I              BBZSNX                          TFZSNX
     I              BBZTNX                          TFZTNX
     I              BBZUNX                          TFZUNX
     I              BBVBSX                          TFVBSX
     I              BBU3SX                          TFU3SX
     I              BBGET1                          TFGET1
     I              BBGFT1                          TFGFT1
     I              BBA1NY                          TFA1NY
     I              BBBKNY                          TFBKNY
     I              BBATNY                          TFATNY
     I              BBVESX                          TFVESX
     I              BBF8AA                          TFF8AA
     I              BBF9AA                          TFF9AA
     I              BBC5NY                          TFC5NY
     I              BBF5NY                          TFF5NY
     I              BBF5AA                          TFF5AA
     I              BBFRT1                          TFFRT1
     I              BBFST1                          TFFST1
     I              BBFTT1                          TFFTT1
     I              BBFUT1                          TFFUT1
     I              BBFVT1                          TFFVT1
     I              BBFWT1                          TFFWT1
     I              BBFXT1                          TFFXT1
     I              BBZLNX                          TFZLNX
     I              BBF7AA                          TFF7AA
     I              BBF6AA                          TFF6AA
     I              BBS6NA                          TFS6NA
     I              BBZDSX                          TFZDSX
     I              BBZESX                          TFZESX
     I              BBZFSX                          TFZFSX
     I              BBZGSX                          TFZGSX
     I              BBZHSX                          TFZHSX
     I              BBMXU1                          TFMXU1
     I              BBUWSX                          TFUWSX
     I              BBUXSX                          TFUXSX
     I              BBV3SX                          TFV3SX
     I              BBAHNY                          TFAHNY
     I              BBAINY                          TFAINY
     I              BBAJNY                          TFAJNY
     I              BBAKNY                          TFAKNY
      *
     I@BBCPZR
      * PFS Order Header          Update index
      * Renamed input format fields
     I              BBY1NX                          TGY1NX
     I              BBZPNX                          TGZPNX
     I              BBZGNX                          TGZGNX
     I              BBZWNX                          TGZWNX
     I              BBZVNX                          TGZVNX
     I              BBVCSX                          TGVCSX
     I              BBZQNX                          TGZQNX
     I              BBF0T1                          TGF0T1
     I              BBF1T1                          TGF1T1
     I              BBF2T1                          TGF2T1
     I              BBGUT1                          TGGUT1
     I              BBF3T1                          TGF3T1
     I              BBF4T1                          TGF4T1
     I              BBF5T1                          TGF5T1
     I              BBF6T1                          TGF6T1
     I              BBF7T1                          TGF7T1
     I              BBZENX                          TGZENX
     I              BBF8T1                          TGF8T1
     I              BBF9T1                          TGF9T1
     I              BBGAT1                          TGGAT1
     I              BBGVT1                          TGGVT1
     I              BBGBT1                          TGGBT1
     I              BBGCT1                          TGGCT1
     I              BBGDT1                          TGGDT1
     I              BBFZT1                          TGFZT1
     I              BBZRNX                          TGZRNX
     I              BBZSNX                          TGZSNX
     I              BBZTNX                          TGZTNX
     I              BBZUNX                          TGZUNX
     I              BBVBSX                          TGVBSX
     I              BBU3SX                          TGU3SX
     I              BBGET1                          TGGET1
     I              BBGFT1                          TGGFT1
     I              BBA1NY                          TGA1NY
     I              BBBKNY                          TGBKNY
     I              BBATNY                          TGATNY
     I              BBVESX                          TGVESX
     I              BBF8AA                          TGF8AA
     I              BBF9AA                          TGF9AA
     I              BBC5NY                          TGC5NY
     I              BBF5NY                          TGF5NY
     I              BBF5AA                          TGF5AA
     I              BBFRT1                          TGFRT1
     I              BBFST1                          TGFST1
     I              BBFTT1                          TGFTT1
     I              BBFUT1                          TGFUT1
     I              BBFVT1                          TGFVT1
     I              BBFWT1                          TGFWT1
     I              BBFXT1                          TGFXT1
     I              BBZLNX                          TGZLNX
     I              BBF7AA                          TGF7AA
     I              BBF6AA                          TGF6AA
     I              BBS6NA                          TGS6NA
     I              BBZDSX                          TGZDSX
     I              BBZESX                          TGZESX
     I              BBZFSX                          TGZFSX
     I              BBZGSX                          TGZGSX
     I              BBZHSX                          TGZHSX
     I              BBMXU1                          TGMXU1
     I              BBUWSX                          TGUWSX
     I              BBUXSX                          TGUXSX
     I              BBV3SX                          TGV3SX
     I              BBAHNY                          TGAHNY
     I              BBAINY                          TGAINY
     I              BBAJNY                          TGAJNY
     I              BBAKNY                          TGAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPPBC1    E DSPPBCCPL0
      * UPD : PFS Order Detail          Update index
      * Renamed input format fields
     I              BCY1NX                          WOY1NX
     I              BCZPNX                          WOZPNX
     I              BCZXNX                          WOZXNX
     I              BCZYNX                          WOZYNX
     I              BCY2NX                          WOY2NX
     I              BCGIT1                          WOGIT1
     I              BCGGT1                          WOGGT1
     I              BCGHT1                          WOGHT1
     I              BCVFSX                          WOVFSX
     I              BCVGSX                          WOVGSX
     I              BCVHSX                          WOVHSX
     I              BCVISX                          WOVISX
     I              BCF8AA                          WOF8AA
     I              BCV4SX                          WOV4SX
     I              BCF9AA                          WOF9AA
     I              BCZFNX                          WOZFNX
     I              BCZZNX                          WOZZNX
     I              BCZ0NX                          WOZ0NX
     I              BCBINY                          WOBINY
     I              BCBJNY                          WOBJNY
     I              BCBKNY                          WOBKNY
     I              BCATNY                          WOATNY
     I              BCALD8                          WOALD8
     I              BCAMD8                          WOAMD8
     I              BCF5NY                          WOF5NY
     I              BCZISX                          WOZISX
     I              BCZJSX                          WOZJSX
     I              BCZKSX                          WOZKSX
     I              BCZLSX                          WOZLSX
     I              BCZMSX                          WOZMSX
     I              BCUWSX                          WOUWSX
     I              BCUXSX                          WOUXSX
     I              BCV3SX                          WOV3SX
     I              BCAHNY                          WOAHNY
     I              BCAINY                          WOAINY
     I              BCAJNY                          WOAJNY
     I              BCAKNY                          WOAKNY
      *
     IYARDCS      DS                            222
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPPBD1    E DSPPBDCPL0
      * UPD : PFS Order BOL Comment     Update index
      * Renamed input format fields
     I              BDY1NX                          WVY1NX
     I              BDZPNX                          WVZPNX
     I              BDIZST                          WVIZST
     I              BDZ1NX                          WVZ1NX
     I              BDGJT1                          WVGJT1
     I              BDUWSX                          WVUWSX
     I              BDUXSX                          WVUXSX
     I              BDV3SX                          WVV3SX
     I              BDAHNY                          WVAHNY
     I              BDAINY                          WVAINY
     I              BDAJNY                          WVAJNY
     I              BDAKNY                          WVAKNY
      *
     IYBRDCS      DS                            111
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPPBB1    E DSPPBBCPL0
      * UPD : PFS Order Header          Update index
      * Renamed input format fields
     I              BBY1NX                          TGY1NX
     I              BBZPNX                          TGZPNX
     I              BBZGNX                          TGZGNX
     I              BBZWNX                          TGZWNX
     I              BBZVNX                          TGZVNX
     I              BBVCSX                          TGVCSX
     I              BBZQNX                          TGZQNX
     I              BBF0T1                          TGF0T1
     I              BBF1T1                          TGF1T1
     I              BBF2T1                          TGF2T1
     I              BBGUT1                          TGGUT1
     I              BBF3T1                          TGF3T1
     I              BBF4T1                          TGF4T1
     I              BBF5T1                          TGF5T1
     I              BBF6T1                          TGF6T1
     I              BBF7T1                          TGF7T1
     I              BBZENX                          TGZENX
     I              BBF8T1                          TGF8T1
     I              BBF9T1                          TGF9T1
     I              BBGAT1                          TGGAT1
     I              BBGVT1                          TGGVT1
     I              BBGBT1                          TGGBT1
     I              BBGCT1                          TGGCT1
     I              BBGDT1                          TGGDT1
     I              BBFZT1                          TGFZT1
     I              BBZRNX                          TGZRNX
     I              BBZSNX                          TGZSNX
     I              BBZTNX                          TGZTNX
     I              BBZUNX                          TGZUNX
     I              BBVBSX                          TGVBSX
     I              BBU3SX                          TGU3SX
     I              BBGET1                          TGGET1
     I              BBGFT1                          TGGFT1
     I              BBA1NY                          TGA1NY
     I              BBBKNY                          TGBKNY
     I              BBATNY                          TGATNY
     I              BBVESX                          TGVESX
     I              BBF8AA                          TGF8AA
     I              BBF9AA                          TGF9AA
     I              BBC5NY                          TGC5NY
     I              BBF5NY                          TGF5NY
     I              BBF5AA                          TGF5AA
     I              BBFRT1                          TGFRT1
     I              BBFST1                          TGFST1
     I              BBFTT1                          TGFTT1
     I              BBFUT1                          TGFUT1
     I              BBFVT1                          TGFVT1
     I              BBFWT1                          TGFWT1
     I              BBFXT1                          TGFXT1
     I              BBZLNX                          TGZLNX
     I              BBF7AA                          TGF7AA
     I              BBF6AA                          TGF6AA
     I              BBS6NA                          TGS6NA
     I              BBZDSX                          TGZDSX
     I              BBZESX                          TGZESX
     I              BBZFSX                          TGZFSX
     I              BBZGSX                          TGZGSX
     I              BBZHSX                          TGZHSX
     I              BBMXU1                          TGMXU1
     I              BBUWSX                          TGUWSX
     I              BBUXSX                          TGUXSX
     I              BBV3SX                          TGV3SX
     I              BBAHNY                          TGAHNY
     I              BBAINY                          TGAINY
     I              BBAJNY                          TGAJNY
     I              BBAKNY                          TGAKNY
      *
     IYCRDCS      DS                            861
      * Outward parameters
     IPARC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PADXNB
      * I :  Load ID
     I                                    P  11  140PARMNB
      * I :  Stop_Drop
     I                                    P  15  170PARVNB
      * I :  Load Change Type
     I                                       18  23 PARVST
      * I :  Department Control Code
     I                                       24  26 PAUJST
      * I :  Change Log Prior Value
     I                                       27  38 PAMNTX
      * I :  Change Log New Value
     I                                       39  50 PAMOTX
      * I :  User Id
     I                                       51  60 PAAYNA
      * I :  Job Name
     I                                       61  70 PAA0NA
      * I :  Carrier Code
     I                                       71  73 PABZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PAXMCD
      * I :  Company Number
     I                                    P  77  780PAAIC3
      * I :  Order Number
     I                                    P  79  820PAC4NB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * I :  Load Status
     I                                        5   5 P1PKST
      * I :  Carrier Code
     I                                        6   8 P1BZNA
     IP2PARM      DS
      * B :  Number Pallets Loaded
     I                                    P   1   30P2PAOU
     IP3PARM      DS
      * B :  Weight 1 USR
     I                                    P   1   62P3IVWG
     IP4PARM      DS
      * FLD: Shipping Line/Port
      * I :  Shipping Line
     I                                        1   3 P4XACD
      * B :  Port Delv Terminal
     I                                        4  23 P4OANA
     IP5PARM      DS
      * I :  PFS Sequence No.
     I                                    P   1   50P5F5NY
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0001
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0002
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0003
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0004
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0005
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0006
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0007
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0008
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0009
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0010
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0011
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0012
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0013
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0014
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0015
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0016
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0017
      * Production AgeDte To
     I                                    P   5   80ZA0018
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1PKST    PARM           WP0002  1        Load Status
     C           P1BZNA    PARM           WP0003  3        Carrier Code
     C           P2PAOU    PARM P2PAOU    WP0004  50       Number Pallets
     C           P3IVWG    PARM P3IVWG    WP0005 112       Weight 1 USR
     C           P4XACD    PARM           WP0006  3        Shipping Line
     C           P4OANA    PARM P4OANA    WP0007 20        Port Delv Termi
     C           P5F5NY    PARM           WP0008  90       PFS Sequence No
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Order Header/Dtl  XF
     C                     Z-ADD*ZERO     P2PAOU           Number Pallets
     C                     Z-ADD*ZERO     P3IVWG           Weight 1 USR
      * *** CREATE LOAD ORDERS, ORDER DETAIL, & SHIPPING INSTRUCTION ***
      * PFS Order Information RT - Load Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PFS Order Information RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  20       PFS Loading Seq
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WN0001           PFS Loading Seq
     C                     MOVEL'Y'       YL0001           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSA02           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSA02           Load ID
      * Establish starting position
     C           KRSSA     SETLL@FLCPE8                    *
     C           KRSSA     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time
      * CASE: LCL.First Time Flag is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVELWARVNB    YL0002           Stop/Drop Seque
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     END                             *FI
      * CLC:  PFS Loading Sequence Number
      * CASE: LCL.Stop/Drop NE DB1.Stop/Drop
     C           YL0003    IFNE WARVNB                     *IF
     C                     ADD  1         WN0001           PFS Loading Seq
     C                     Z-ADDWARVNB    YL0003           Stop_Drop
     C                     END                             *FI
      * **** UPDATE ORDER HEADER
      * RTV 1st WHS/PFS Act   RT - Order Detail  * 
     C                     EXSR SBRVGN
      * ** Create PFS Order Header
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0005    IFEQ 'Y'                        *IF
      * PFS Order Header      RT2 - Order Header TRG  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * *** CREATE LOAD ORDER CHANGE LOG ***
      * CASE: PAR.Load Status is Unlock
     C           P1PKST    IFEQ 'U'                        *IF
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDWARMNB    PARMNB           Load ID
     C                     Z-ADDWARVNB    PARVNB           Stop_Drop
     C                     MOVEL'SNDUNL'  PARVST    P      Load Change Typ
     C                     MOVEL'INT'     PAUJST    P      Department Cont
     C                     MOVEL*BLANK    PAMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##JOB     PAA0NA    P      Job Name
     C                     MOVELP1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
     C                     Z-ADDWAC4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPARC
     C                     Z-ADDWARMNB    PARMNB           Load ID
     C                     Z-ADDWARVNB    PARVNB           Stop_Drop
     C                     MOVEL'SNDPFS'  PARVST    P      Load Change Typ
     C                     MOVEL'INT'     PAUJST    P      Department Cont
     C                     MOVEL*BLANK    PAMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    PAMOTX    P      Change Log New
     C                     MOVEL##USR     PAAYNA    P      User Id
     C                     MOVEL##JOB     PAA0NA    P      Job Name
     C                     MOVELP1BZNA    PABZNA    P      Carrier Code
     C                     Z-ADDWAAIC3    PAAIC3           Company Number
     C                     Z-ADDWAC4NB    PAC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C           KRSSA     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV 1st WHS/PFS Act   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAC4NB    WQSB02           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
      * Establish starting position
     C           KPSSB     SETLL@BGWKAE                    *
     C           KRSSB     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Warehouse Code
     C                     MOVEL*BLANK    YL0005           WHS Live with C
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 10/20/06 PKD Changed to use the WHS PFS LD/ORD Interface
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
     C                     EXSR SCRVGN
     C                     MOVEL'N'       YL0005           WHS Live with C
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0006    IFEQ 'Y'                        *IF
      * CASE: LCL.WHS PFS Interface is Download/Both
     C           YL0007    IFEQ 'D'                        *IF
     C           YL0007    OREQ 'B'
     C                     MOVEL'Y'       YL0005           WHS Live with C
     C                     END                             *FI
     C                     END                             *FI
      * PAR = DB1 By name
     C                     MOVELWBAJCD    YL0004           Warehouse Code
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           WHS Live with C
     C                     MOVEL*BLANK    YL0007           WHS PFS Interfa
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCRRSX    YL0006           WHS Live with C
     C                     MOVELWCRSSX    YL0007           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * PFS Order Header      RT2 - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  30       PFS Company Num
     C                     Z-ADD*ZERO     WN0003  70       PFS Order Numbe
     C                     Z-ADD*ZERO     WN0004  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0005  20       PFS Load Stop N
     C                     MOVEL*BLANK    WN0006  2        PFS Order Type
     C                     Z-ADD*ZERO     WN0007  70       PFS Ship To Cus
     C                     MOVEL*BLANK    WN0008 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0009 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0010 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0011 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0012 20        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0013  2        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0014 11        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0015 50        PFS Ship To Ema
     C                     MOVEL*BLANK    WN0016 25        PFS Ship To Pho
     C                     Z-ADD*ZERO     WN0017  70       PFS Bill To Cus
     C                     MOVEL*BLANK    WN0018 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0019 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0020 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0021 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0022 20        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0023  2        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0024 11        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0025 15        PFS Customer PO
     C                     Z-ADD*ZERO     WN0026  80       PFS Order Date
     C                     Z-ADD*ZERO     WN0027  80       PFS Scheduled S
     C                     Z-ADD*ZERO     WN0028  80       PFS Requested D
     C                     Z-ADD*ZERO     WN0029  60       PFS Requested D
     C                     MOVEL*BLANK    WN0030  1        PFS Export Stat
     C                     MOVEL*BLANK    WN0031  6        PFS Country Cod
     C                     MOVEL*BLANK    WN0032 40        PFS Special Ins
     C                     MOVEL*BLANK    WN0033 40        PFS Special Ins
     C                     Z-ADD*ZERO     WN0034  70       PFS Maximum Gro
     C                     Z-ADD*ZERO     WN0035  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0036  52       PFS Average Pal
     C                     MOVEL*BLANK    WN0037  1        PFS Order Statu
     C                     MOVEL*BLANK    WN0038  3        PFS Ship From W
     C                     MOVEL*BLANK    WN0039  3        PFS Ship To War
     C                     Z-ADD*ZERO     WN0040  50       PFS Order Detai
     C                     MOVEL*BLANK    WN0041  3        PFS Shipping Li
     C                     MOVEL*BLANK    WN0042 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0043 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0044 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0045 20        PFS Shipping Li
     C                     MOVEL*BLANK    WN0046  2        PFS Shipping Li
     C                     MOVEL*BLANK    WN0047 11        PFS Shipping LI
     C                     MOVEL*BLANK    WN0048 30        PFS Vessel Name
     C                     MOVEL*BLANK    WN0049 15        PFS Voyage
     C                     MOVEL*BLANK    WN0050 20        PFS Discharge P
     C                     MOVEL*BLANK    WN0051 15        PFS Booking Num
     C                     MOVEL*BLANK    WN0052 15        PFS Delivery P.
     C                     MOVEL*BLANK    WN0053  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0054  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0055  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0056  2        PFS Order Unuse
     C                     MOVEL*BLANK    WN0057  2        PFS Regul Code
     C                     MOVEL*BLANK    WN0058 15        PFS Ship To Est
     C                     MOVEL*BLANK    WN0059  1        PFS Record Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     Z-ADDWAC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * FP1309 Inventory Age  IF
      * FP1309 Inventory Age Code Description
      * ** CREATE ORDER DETAIL
      * WI572:Update PFS order detail with IDE Regulation Code ID
      *       Also pass IDE Regulation Code ID back to the current functi
      * PFS Order Detail      RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0001           Company Number
     C                     Z-ADDWDC4NB    WL0002           Order Number
     C                     MOVELWDJNCD    WL0003    P      Order Type_Sale
     C                     Z-ADDWDEIDT    WL0004           Requested Deliv
     C                     MOVELWDVEST    WL0005    P      Palletize
     C                     MOVELWDVFST    WL0006    P      Shrink Wrap
     C                     MOVELWDVGST    WL0007    P      Slip Sheet
     C                     Z-ADDP5F5NY    WL0008           PFS Sequence No
     C                     Z-ADDYL0008    WL0009           Number Pallets
     C                     Z-ADDYL0009    WL0010           Weight 1 USR
     C                     MOVELP1PKST    WL0011    P      Load Status
     C                     Z-ADDWN0040    WL0012           PFS Order Detai
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0008           Number Pallets
     C                     Z-ADDWL0010    YL0009           Weight 1 USR
     C                     Z-ADDWL0012    WN0040           PFS Order Detai
     C                     MOVELWL0013    YL0010    P      IDE Regulation
      * ** E0657 RMC 4/05/2010   UPDATE ORDER BOL Comment from Country co
      * **   Was outputting shipping instructions prior to 4/05/10 - but
      * **   Werent picked up by carisle in ppu1upc - file was commented
      * RTV OHE Intend for Exp RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0017           Company Number
     C                     Z-ADDWDC4NB    WL0018           Order Number
     C                     MOVELYL0018    WL0019    P      OHE Intended fo
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0019    YL0018    P      OHE Intended fo
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0020           Company Number
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    YL0019    P      Plant Company S
     C                     MOVELWL0022    YL0020    P      Company Organiz
      * For Daily CAT = put all comments in Order Comments
      * CASE: LCL.Company Organization is Daily's
     C           YL0020    IFEQ 'D'                        *IF
      * Rtv Del Ord Comment   RT - PFS Order BOL Comment  * delete all fo
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0023           PFS Company Num
     C                     Z-ADDWDC4NB    WL0024           PFS Order Numbe
     C                     MOVEL'BL'      WL0025    P      PFS BOL Comment
     C                     Z-ADD*ZERO     WL0026           PFS Sequence Nu
     C                     EXSR SSRVGN
      * CASE: PAR.Load Status is Lock
     C           P1PKST    IFEQ 'L'                        *IF
      * RTV PFS Ord Comment   RT - Order Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0027           Company Number
     C                     Z-ADDWDC4NB    WL0028           Order Number
     C                     MOVEL'BL'      WL0029    P      Comment Type
     C                     EXSR SURVGN
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0040           Company Number
     C                     Z-ADDWDC4NB    WL0041           Order Number
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    YL0022    P      Country Code
      * CASE: LCL.OHE Intended for ExportCC is Entered
     C           YL0018    IFNE *BLANK                     *IF
      * Rtv PFS BL Cmnt f/CAT RT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0018    WL0043    P      Country Code
     C                     MOVEL'BI'      WL0044    P      Comment Type
     C                     Z-ADDWDAIC3    WL0045           Company Number
     C                     Z-ADDWDC4NB    WL0046           Order Number
     C                     MOVELP1PKST    WL0047    P      Load Status
     C                     EXSR TARVGN
     C                     ELSE
      * CASE: LCL.Country Code is Entered
     C           YL0022    IFNE *BLANK                     *IF
      * Rtv PFS BL Cmnt f/CAT RT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0022    WL0043    P      Country Code
     C                     MOVEL'BL'      WL0044    P      Comment Type
     C                     Z-ADDWDAIC3    WL0045           Company Number
     C                     Z-ADDWDC4NB    WL0046           Order Number
     C                     MOVELP1PKST    WL0047    P      Load Status
     C                     EXSR TARVGN
     C                     END                             *FI
     C                     END                             *FI
      * PFS Cust Comment Tp BL RT - Customer Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDBKC7    WL0048           Ship To Custome
     C                     MOVEL'BL'      WL0049    P      Comment Type
     C                     Z-ADDWDAIC3    WL0050           Company Number
     C                     Z-ADDWDC4NB    WL0051           Order Number
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     END                             *FI
      * Not Dailys output these comments -  orig code before p000196
      * CASE: LCL.Company Organization is Not Daily's
     C           YL0020    IFEQ 'H'                        *IF
     C           YL0020    OREQ 'S'
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0040           Company Number
     C                     Z-ADDWDC4NB    WL0041           Order Number
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    YL0022    P      Country Code
      * CASE: LCL.OHE Intended for ExportCC is Entered
     C           YL0018    IFNE *BLANK                     *IF
      * Rtv Crt PFS BOL CommntRT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0018    WL0052    P      Country Code
     C                     MOVEL'BI'      WL0053    P      Comment Type
     C                     Z-ADDWDAIC3    WL0054           Company Number
     C                     Z-ADDWDC4NB    WL0055           Order Number
     C                     MOVELP1PKST    WL0056    P      Load Status
     C                     EXSR TCRVGN
     C                     ELSE
      * CASE: LCL.Country Code is Entered
     C           YL0022    IFNE *BLANK                     *IF
      * Rtv Crt PFS BOL CommntRT - Country Comment  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0022    WL0052    P      Country Code
     C                     MOVEL'BL'      WL0053    P      Comment Type
     C                     Z-ADDWDAIC3    WL0054           Company Number
     C                     Z-ADDWDC4NB    WL0055           Order Number
     C                     MOVELP1PKST    WL0056    P      Load Status
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * WI572 - Regulation ID logic
     C                     EXSR UBSUBR                     WI572 - Regulat
      * ** PFS Order Header now includes the export shipping instructions
      * ** CREATE ORDER HEADER
     C                     EXSR UCSUBR                     ** CREATE ORDER
      * ** Accumulate Number of Pallets Loaded & Total Pallet Weight **
      * Do not add if Header Status is Cancelled.
      * CASE: DB1.Header Status is Cancelled
     C           WDGWST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  YL0008    P2PAOU           Number Pallets
     C                     END                             *FI
     C                     ADD  YL0009    P3IVWG           Weight 1 USR
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * PFS Order Detail      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0060  30       PFS Company Num
     C                     Z-ADD*ZERO     WN0061  70       PFS Order Numbe
     C                     Z-ADD*ZERO     WN0062  30       PFS Order Line
     C                     Z-ADD*ZERO     WN0063  30       PFS Substitutio
     C                     Z-ADD*ZERO     WN0064  70       PFS Item Code
     C                     MOVEL*BLANK    WN0065 14        PFS Customer It
     C                     MOVEL*BLANK    WN0066 30        PFS Item Descri
     C                     MOVEL*BLANK    WN0067 30        PFS Item Descri
     C                     MOVEL*BLANK    WN0068  1        PFS Age Code
     C                     MOVEL*BLANK    WN0069  1        PFS Slip Sheet
     C                     MOVEL*BLANK    WN0070  1        PFS Shrink Wrap
     C                     MOVEL*BLANK    WN0071  1        PFS Palletize
     C                     MOVEL*BLANK    WN0072  3        PFS Ship From W
     C                     MOVEL*BLANK    WN0073  2        PFS Ship From W
     C                     MOVEL*BLANK    WN0074  3        PFS Ship To War
     C                     Z-ADD*ZERO     WN0075  70       PFS Scheduled Q
     C                     Z-ADD*ZERO     WN0076  82       PFS Scheduled W
     C                     Z-ADD*ZERO     WN0077  82       PFS Maximum Net
     C                     Z-ADD*ZERO     WN0078  82       PFS Minimum Uni
     C                     Z-ADD*ZERO     WN0079  82       PFS Maximum Uni
     C                     Z-ADD*ZERO     WN0080  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0081  52       PFS Average Pal
     C                     Z-ADD*ZERO     WN0082  80       PFS Oldest Date
     C                     Z-ADD*ZERO     WN0083  80       PFS Newest Date
     C                     MOVEL*BLANK    WN0084  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0085  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0086  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0087  2        PFS Pallet Type
     C                     MOVEL*BLANK    WN0088  2        PFS Regulation
     C                     MOVEL*BLANK    WN0089  1        PFS Record Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * EL  04/28/23 Adding Regulation ID logic (WI572 - CA Prop 12)
      * RMC 12/19/17 output par.pfs pallet type
      * RMC R5207 02/16/16 DLY - output sched ship date-1prod date for ne
      * RMC 03/13/07 output par.sequence no.
      * FP1309 Inventory Age  IF
      * FP1309 Inventory Age Code Description
     C                     Z-ADD*ZERO     WL0009           Number Pallets
     C                     Z-ADD*ZERO     WL0010           Weight 1 USR
     C                     Z-ADD*ZERO     WL0012           PFS Order Detai
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WL0001    WQ0001  30       Company Number
     C           WUYISX    PARM *BLANK    WQ0002  1        Plant Company S
     C           WUYJSX    PARM *BLANK    WQ0003  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSE01           Company Number
     C                     Z-ADDWL0002    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * fp1309 calculate the date for the newest and oldest
     C                     Z-ADDWEAIC3    WN0060           PFS Company Num
     C                     Z-ADDWEC4NB    WN0061           PFS Order Numbe
     C                     Z-ADDWEDPNB    WN0062           PFS Order Line
     C                     Z-ADDWEBXTM    WN0063           PFS Substitutio
      * RTV Item Ref Sts      RT - Customer  * 
     C                     EXSR SFRVGN
     C                     Z-ADDWEHGCD    WN0064           PFS Item Code
      * CASE: LCL.Item Reference Status is Both
     C           YL0011    IFEQ 'B'                        *IF
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0065           PFS Customer It
     C                     END                             *FI
     C                     MOVELWEG7NA    WN0066           PFS Item Descri
     C                     MOVELWEG8NA    WN0067           PFS Item Descri
     C                     MOVELWEVGST    WN0069           PFS Slip Sheet
     C                     MOVELWL0006    WN0070           PFS Shrink Wrap
     C                     MOVELWEVEST    WN0071           PFS Palletize
     C                     MOVELWEF5SX    WN0087           PFS Pallet Type
     C                     MOVELWEAJCD    WN0072           PFS Ship From W
      * CASE: PAR.PFS Ship From Warehouse is CFH
     C           WN0072    IFEQ 'CFH'                      *IF
     C                     MOVEL'CF1'     WN0072           PFS Ship From W
     C                     END                             *FI
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SHRVGN
      * PFS Ship To Warehouse
      * CASE: PAR.Order Type - Sales is Transfer Order
     C           WL0003    IFEQ 'TR'                       *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0014           Company Number
     C                     Z-ADDWEBKC7    WL0015           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    WN0074    P      Warehouse Code
     C                     END                             *FI
      * FP1309 Calculate Oldest Allowed & Newest Allowed Dates
     C                     EXSR UASUBR                     FP1309 Calculat
      * RMC 10/14/13 E2824 Output Ordered a lieu sched - because sched ch
      *   unless User Release is Yes, then they want to short ship the sc
      * CASE: DB1.Released by User Sts Y/N is yes
     C           WEF3SX    IFEQ 'Y'                        *IF
     C                     Z-ADDWECCQT    WN0075           PFS Scheduled Q
     C                     Z-ADDWEAUWG    WN0076           PFS Scheduled W
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWEAVQT    WN0075           PFS Scheduled Q
     C                     Z-ADDWED0WG    WN0076           PFS Scheduled W
     C                     END                             *FI
     C                     Z-ADDWEBWTM    WN0077           PFS Maximum Net
      * PFS Estimated Pallets, PFS Average Pallet Tare
      * CASE: PAR.Palletize is yes
     C           WL0005    IFEQ 'Y'                        *IF
      * Rtv Pallet Tare/Cases RT - Item Bill Of Material  * 
     C                     EXSR SKRVGN
      * CASE: LCL.Number Cases On A Pallet is GT Zero
     C           YL0015    IFGT 0                          *IF
      * PFS Estimated Pallets
      * PAR.PFS Estimated Pallets =
      *    *COMPUTE ((x1 / x2))
      * x1    : DB1.Quantity Ordered
      * /     : PGM.*Synon (15,0) work field *
      * x2    : LCL.Number Cases On A Pallet
     C           WEAVQT    DIV  YL0015    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0080           PFS Estimated P
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0080           PFS Estimated P
     C                     END                             *FI
      * CASE: PAR.PFS Estimated Pallets is GT Zero
     C           WN0080    IFGT 0                          *IF
     C                     Z-ADDYL0016    WN0081           PFS Average Pal
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0080           PFS Estimated P
     C                     Z-ADD*ZERO     WN0081           PFS Average Pal
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Detail Line Status is Cancelled
      *   |- c2    : PAR.Load Status is Unlock
      *   '-
     C           WEGMST    IFEQ 'X'                        *IF
     C           WL0011    OREQ 'U'                        *OR
     C                     MOVEL'D'       WN0089           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WN0089           PFS Record Stat
     C                     END                             *FI
      * - WI572 (CA Prop 12) - RTV Regulation ID
      * RTV Regul Code ID RT - Item Default Extension  * 
     C                     EXSR SMRVGN
      * If Regul Code is populated
      * CASE: LCL.IDE Regulation Code ID is Blank
     C           YL0017    IFEQ *BLANK                     *IF
     C                     MOVELYL0017    WN0088           PFS Regulation
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0017    WN0088           PFS Regulation
      * Send back to calling function to Update PFS Order Header
     C                     MOVELYL0017    WL0013           IDE Regulation
     C                     END                             *FI
      * Upd Order Detail      RT - PFS Order Detail  * 
     C                     EXSR SNRVGN
      * ** Accumulate Number of Pallets & Total Pallet Weight **
      * CASE: DB1.Detail Line Status is Cancelled
     C           WEGMST    IFEQ 'X'                        *IF
      * ** Do not add if Cancelled.
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Accumulate Number of Pallets & Total Pallet Weight **
     C                     ADD  WN0080    WL0009           Number Pallets
      * PAR.Weight 1 USR
      * PAR.Weight 1 USR =
      *    *COMPUTE ((x3 + (x1 * x2)))
      * x3    : PAR.Weight 1 USR
      * +     : PGM.*Synon (15,2) work field
      * x1    : PAR.PFS Average Pallet Tare
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PFS Estimated Pallets
     C           WN0081    MULT WN0080    W0WA01           *Synon (15,2) w
     C           WL0010    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0010           Weight 1 USR
     C                     END                             *FI
     C                     ADD  1         WL0012           PFS Order Detai
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Item Ref Sts      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWEBKC7    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0011           Item Reference
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFQYST    YL0011           Item Reference
     C                     GOTO SFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Cust Item Ref     RT - Customer Item Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGBKC7           Ship To Custome
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     Z-ADDWEBKC7    WGBKC7           Ship To Custome
     C                     Z-ADDWEHGCD    WGHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BIREKY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3081' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0065           CIR Resource No
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGCOAA    WN0065           CIR Resource No
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0072    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0073           Warehouse Type
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WN0073           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0014    WHAIC3           Company Number
     C                     Z-ADDWL0015    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0016           Warehouse Code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHAJCD    WL0016           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Prev Prd Dte      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSJ01           Company Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WIBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSJ01           Company Number
     C                     Z-ADDWEAODT    WIBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSJ     SETLL@AFREPU                    *
     C           KRSSJ     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Orde
     C           WIBCDT    IFEQ WEAODT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Day Status is yes
     C           WIWAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWIBCDT    YL0013           Production Date
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Pallet Tare/Cases RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WJHGCD    WQSK02           Item Code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Item Code
      * Setup key
     C                     Z-ADDWEAIC3    WQSK01           Company Number
     C                     Z-ADDWEHGCD    WQSK02           Item Code
      * Establish starting position
     C           KRSSK     SETLL@IORETI                    *
     C           KRSSK     READE@IORETI                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOM Type is Supplies
     C           WJV2ST    IFEQ 'S'                        *IF
      * Rtv Pallet Tare/Cases RT - Company/Item  * 
     C                     EXSR SLRVGN
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@IORETI                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Pallet Tare/Cases RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
      * Setup key
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     Z-ADDWJC9NB    WKHGCD           Item Code
      * Establish starting position
     C           KRSSL     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKURTN    YL0015           Number Cases On
     C                     Z-ADDWKSFNB    YL0016           Pallet Tare Wei
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Regul Code ID RT - Item Default Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WLHGCD           Item Code
      * Setup key
     C                     Z-ADDWEHGCD    WLHGCD           Item Code
      * Establish starting position
     C           KRSSM     CHAIN@BTRETK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4745' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAOSC    YL0017           IDE Regulation
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Upd Order Detail      RT - PFS Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0090  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0091  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0092  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0093  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0094  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0095  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WMY1NX           PFS Company Num
     C                     KFLD           WMZPNX           PFS Order Numbe
     C                     KFLD           WMZXNX           PFS Order Line
     C                     KFLD           WMZYNX           PFS Substitutio
      * Setup key
     C                     Z-ADDWN0060    WMY1NX           PFS Company Num
     C                     Z-ADDWN0061    WMZPNX           PFS Order Numbe
     C                     Z-ADDWN0062    WMZXNX           PFS Order Line
     C                     Z-ADDWN0063    WMZYNX           PFS Substitutio
      * Establish starting position
     C           KRSSN     CHAIN@BCCPZP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3488' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS Order Detail  CR - PFS Order Detail  * 
     C                     EXSR SOCRRC
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS Order Detail  CH - PFS Order Detail  * 
     C                     EXSR SPCHRC
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt PFS Order Detail  CR - PFS Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCCPZO
     C                     Z-ADDWN0060    WOY1NX           PFS Company Num
     C                     Z-ADDWN0061    WOZPNX           PFS Order Numbe
     C                     Z-ADDWN0062    WOZXNX           PFS Order Line
     C                     Z-ADDWN0063    WOZYNX           PFS Substitutio
     C                     Z-ADDWN0064    WOY2NX           PFS Item Code
     C                     MOVELWN0065    WOGIT1           PFS Customer It
     C                     MOVELWN0066    WOGGT1           PFS Item Descri
     C                     MOVELWN0067    WOGHT1           PFS Item Descri
     C                     MOVELWN0068    WOVFSX           PFS Age Code
     C                     MOVELWN0069    WOVGSX           PFS Slip Sheet
     C                     MOVELWN0070    WOVHSX           PFS Shrink Wrap
     C                     MOVELWN0071    WOVISX           PFS Palletize
     C                     MOVELWN0072    WOF8AA           PFS Ship From W
     C                     MOVELWN0073    WOV4SX           PFS Ship From W
     C                     MOVELWN0074    WOF9AA           PFS Ship To War
     C                     Z-ADDWN0075    WOZFNX           PFS Scheduled Q
     C                     Z-ADDWN0076    WOZZNX           PFS Scheduled W
     C                     Z-ADDWN0077    WOZ0NX           PFS Maximum Net
     C                     Z-ADDWN0078    WOBINY           PFS Minimum Uni
     C                     Z-ADDWN0079    WOBJNY           PFS Maximum Uni
     C                     Z-ADDWN0080    WOBKNY           PFS Estimated P
     C                     Z-ADDWN0081    WOATNY           PFS Average Pal
     C                     Z-ADDWN0082    WOALD8           PFS Oldest Date
     C                     Z-ADDWN0083    WOAMD8           PFS Newest Date
     C                     Z-ADDWL0008    WOF5NY           PFS Sequence No
     C                     MOVELWN0084    WOZISX           PFS Ord Dtl Unu
     C                     MOVELWN0085    WOZJSX           PFS Ord Dtl Unu
     C                     MOVELWN0086    WOZKSX           PFS Ord Dtl Unu
     C                     MOVELWN0087    WOZLSX           PFS Pallet Type
     C                     MOVELWN0088    WOZMSX           PFS Regulation
     C                     MOVELWN0089    WOUWSX           PFS Record Stat
     C                     Z-ADDWN0090    WOUXSX           PFS Process Sta
     C                     MOVELWN0091    WOV3SX           PFS Error Reaso
     C                     Z-ADDWN0092    WOAHNY           PFS Create Date
     C                     Z-ADDWN0093    WOAINY           PFS Create Time
     C                     Z-ADDWN0094    WOAJNY           PFS Change Date
     C                     Z-ADDWN0095    WOAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD*ZERO     WOUXSX           PFS Process Sta
     C                     Z-ADD##JDT     WOAHNY           PFS Create Date
     C                     Z-ADD##JTM     WOAINY           PFS Create Time
     C           KLCRSO    KLIST
     C                     KFLD           WOY1NX           PFS Company Num
     C                     KFLD           WOZPNX           PFS Order Numbe
     C                     KFLD           WOZXNX           PFS Order Line
     C                     KFLD           WOZYNX           PFS Substitutio
      * Check for duplicate primary key
     C           KLCRSO    SETLL@BCCPZO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3489' W0RTN   7
      * Send message 'PFS Order Detail       EX'
     C                     MOVEL'USR3489' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@BCCPZO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg PFS Order Detail  CH - PFS Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0096  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0097  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0098  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0099  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0100  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0101  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BCCPZO
     C                     Z-ADDWN0060    WOY1NX           PFS Company Num
     C                     Z-ADDWN0061    WOZPNX           PFS Order Numbe
     C                     Z-ADDWN0062    WOZXNX           PFS Order Line
     C                     Z-ADDWN0063    WOZYNX           PFS Substitutio
      *
     C           KLCHSP    KLIST
     C                     KFLD           WOY1NX           PFS Company Num
     C                     KFLD           WOZPNX           PFS Order Numbe
     C                     KFLD           WOZXNX           PFS Order Line
     C                     KFLD           WOZYNX           PFS Substitutio
     C           KLCHSP    CHAIN@BCCPZO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBCCPL0'MDACP
     C                     MOVEL'@BCCPZO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBC1    YARDCS
      * Move non-key fields to @BCCPZO
     C                     Z-ADDWN0064    WOY2NX           PFS Item Code
     C                     MOVELWN0065    WOGIT1    P      PFS Customer It
     C                     MOVELWN0066    WOGGT1    P      PFS Item Descri
     C                     MOVELWN0067    WOGHT1    P      PFS Item Descri
     C                     MOVELWN0068    WOVFSX    P      PFS Age Code
     C                     MOVELWN0069    WOVGSX    P      PFS Slip Sheet
     C                     MOVELWN0070    WOVHSX    P      PFS Shrink Wrap
     C                     MOVELWN0071    WOVISX    P      PFS Palletize
     C                     MOVELWN0072    WOF8AA    P      PFS Ship From W
     C                     MOVELWN0073    WOV4SX    P      PFS Ship From W
     C                     MOVELWN0074    WOF9AA    P      PFS Ship To War
     C                     Z-ADDWN0075    WOZFNX           PFS Scheduled Q
     C                     Z-ADDWN0076    WOZZNX           PFS Scheduled W
     C                     Z-ADDWN0077    WOZ0NX           PFS Maximum Net
     C                     Z-ADDWN0078    WOBINY           PFS Minimum Uni
     C                     Z-ADDWN0079    WOBJNY           PFS Maximum Uni
     C                     Z-ADDWN0080    WOBKNY           PFS Estimated P
     C                     Z-ADDWN0081    WOATNY           PFS Average Pal
     C                     Z-ADDWN0082    WOALD8           PFS Oldest Date
     C                     Z-ADDWN0083    WOAMD8           PFS Newest Date
     C                     Z-ADDWL0008    WOF5NY           PFS Sequence No
     C                     MOVELWN0084    WOZISX    P      PFS Ord Dtl Unu
     C                     MOVELWN0085    WOZJSX    P      PFS Ord Dtl Unu
     C                     MOVELWN0086    WOZKSX    P      PFS Ord Dtl Unu
     C                     MOVELWN0087    WOZLSX    P      PFS Pallet Type
     C                     MOVELWN0088    WOZMSX    P      PFS Regulation
     C                     MOVELWN0089    WOUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WOAJNY           PFS Change Date
     C                     Z-ADD##JTM     WOAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BCCPZO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV OHE Intend for Exp RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0017    WRAIC3           Company Number
     C                     Z-ADDWL0018    WRC4NB           Order Number
      * Establish starting position
     C           KRSSQ     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRLWAA    WL0019           OHE Intended fo
     C                     GOTO SQEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WSAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0020    WSAIC3           Company Number
      * Establish starting position
     C           KRSSR     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0021           Plant Company S
     C                     MOVEL*BLANK    WL0022           Company Organiz
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSYISX    WL0021           Plant Company S
     C                     MOVELWSYJSX    WL0022           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Del Ord Comment   RT - PFS Order BOL Comment  * delete all f
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY1NX    WQSS01           PFS Company Num
     C           *LIKE     DEFN WTZPNX    WQSS02           PFS Order Numbe
     C           *LIKE     DEFN WTIZST    WQSS03           PFS BOL Comment
      * Define keylist
     C           KPSSS     KLIST
     C                     KFLD           WQSS01           PFS Company Num
     C                     KFLD           WQSS02           PFS Order Numbe
     C                     KFLD           WQSS03           PFS BOL Comment
     C                     KFLD           WTZ1NX           PFS Sequence Nu
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           PFS Company Num
     C                     KFLD           WQSS02           PFS Order Numbe
     C                     KFLD           WQSS03           PFS BOL Comment
      * Setup key
     C                     Z-ADDWL0023    WQSS01           PFS Company Num
     C                     Z-ADDWL0024    WQSS02           PFS Order Numbe
     C                     MOVELWL0025    WQSS03           PFS BOL Comment
     C                     Z-ADDWL0026    WTZ1NX           PFS Sequence Nu
      * Establish starting position
     C           KPSSS     SETLL@BDCPAB                    *
     C           KRSSS     READE@BDCPAB                  90*
      * Data record not found
     C   90                MOVEL'USR3490' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del PFS BOL Comment   DL - PFS Order BOL Comment  * 
     C                     EXSR STDLRC
     C           KRSSS     READE@BDCPAB                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STDLRC    BEGSR
      *================================================================
      * Del PFS BOL Comment   DL - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BDCPAA
     C                     Z-ADDWTY1NX    WVY1NX           PFS Company Num
     C                     Z-ADDWTZPNX    WVZPNX           PFS Order Numbe
     C                     MOVELWTIZST    WVIZST           PFS BOL Comment
     C                     Z-ADDWTZ1NX    WVZ1NX           PFS Sequence Nu
      *
     C           KLDLST    KLIST
     C                     KFLD           WVY1NX           PFS Company Num
     C                     KFLD           WVZPNX           PFS Order Numbe
     C                     KFLD           WVIZST           PFS BOL Comment
     C                     KFLD           WVZ1NX           PFS Sequence Nu
     C           KLDLST    CHAIN@BDCPAA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBDCPL0'MDACP
     C                     MOVEL'@BDCPAA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BDCPAA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV PFS Ord Comment   RT - Order Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQSU01           Company Number
     C           *LIKE     DEFN WWC4NB    WQSU02           Order Number
     C           *LIKE     DEFN WWI1SX    WQSU03           Comment Type
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
     C                     KFLD           WQSU03           Comment Type
      * Setup key
     C                     Z-ADDWL0027    WQSU01           Company Number
     C                     Z-ADDWL0028    WQSU02           Order Number
     C                     MOVELWL0029    WQSU03           Comment Type
      * Establish starting position
     C           KRSSU     SETLL@COCPNU                    *
     C           KRSSU     READE@COCPNU                  90*
      * Data record not found
     C   90                MOVEL'USR0486' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWAIC3    WL0030           PFS Company Num
     C                     Z-ADDWWC4NB    WL0031           PFS Order Numbe
     C                     MOVELWWI1SX    WL0032    P      PFS BOL Comment
     C                     Z-ADDYL0021    WL0033           PFS Sequence Nu
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    YL0021           PFS Sequence Nu
     C                     ADD  1         YL0021           PFS Sequence Nu
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWAIC3    WL0034           PFS Company Num
     C                     Z-ADDWWC4NB    WL0035           PFS Order Numbe
     C                     MOVELWWI1SX    WL0036    P      PFS BOL Comment
     C                     Z-ADDYL0021    WL0037           PFS Sequence Nu
     C                     MOVELWWG4NA    WL0038    P      PFS BOL Comment
     C                     MOVEL'A'       WL0039    P      PFS Record Stat
     C                     EXSR SWRVGN
     C           KRSSU     READE@COCPNU                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY1NX    WQSV01           PFS Company Num
     C           *LIKE     DEFN WTZPNX    WQSV02           PFS Order Numbe
     C           *LIKE     DEFN WTIZST    WQSV03           PFS BOL Comment
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           PFS Company Num
     C                     KFLD           WQSV02           PFS Order Numbe
     C                     KFLD           WQSV03           PFS BOL Comment
      * Setup key
     C                     Z-ADDWL0030    WQSV01           PFS Company Num
     C                     Z-ADDWL0031    WQSV02           PFS Order Numbe
     C                     MOVELWL0032    WQSV03           PFS BOL Comment
      * Establish starting position
     C           KRSSV     SETLL@BDCPAB                    *
     C           KRSSV     READE@BDCPAB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3490' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0033           PFS Sequence Nu
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWTZ1NX    WL0033           PFS Sequence Nu
     C           KRSSV     READE@BDCPAB                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0102  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0103  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0104  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0105  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0106  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0107  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WTY1NX           PFS Company Num
     C                     KFLD           WTZPNX           PFS Order Numbe
     C                     KFLD           WTIZST           PFS BOL Comment
     C                     KFLD           WTZ1NX           PFS Sequence Nu
      * Setup key
     C                     Z-ADDWL0034    WTY1NX           PFS Company Num
     C                     Z-ADDWL0035    WTZPNX           PFS Order Numbe
     C                     MOVELWL0036    WTIZST           PFS BOL Comment
     C                     Z-ADDWL0037    WTZ1NX           PFS Sequence Nu
      * Establish starting position
     C           KRSSW     CHAIN@BDCPAB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3490' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS BOL Comment   CR - PFS Order BOL Comment  * 
     C                     EXSR SXCRRC
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS BOL Comment   CH - PFS Order BOL Comment  * 
     C                     EXSR SYCHRC
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Crt PFS BOL Comment   CR - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BDCPAA
     C                     Z-ADDWL0034    WVY1NX           PFS Company Num
     C                     Z-ADDWL0035    WVZPNX           PFS Order Numbe
     C                     MOVELWL0036    WVIZST           PFS BOL Comment
     C                     Z-ADDWL0037    WVZ1NX           PFS Sequence Nu
     C                     MOVELWL0038    WVGJT1           PFS BOL Comment
     C                     MOVELWL0039    WVUWSX           PFS Record Stat
     C                     Z-ADDWN0102    WVUXSX           PFS Process Sta
     C                     MOVELWN0103    WVV3SX           PFS Error Reaso
     C                     Z-ADDWN0104    WVAHNY           PFS Create Date
     C                     Z-ADDWN0105    WVAINY           PFS Create Time
     C                     Z-ADDWN0106    WVAJNY           PFS Change Date
     C                     Z-ADDWN0107    WVAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD*ZERO     WVUXSX           PFS Process Sta
     C                     Z-ADD##JDT     WVAHNY           PFS Create Date
     C                     Z-ADD##JTM     WVAINY           PFS Create Time
     C           KLCRSX    KLIST
     C                     KFLD           WVY1NX           PFS Company Num
     C                     KFLD           WVZPNX           PFS Order Numbe
     C                     KFLD           WVIZST           PFS BOL Comment
     C                     KFLD           WVZ1NX           PFS Sequence Nu
      * Check for duplicate primary key
     C           KLCRSX    SETLL@BDCPAA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3491' W0RTN   7
      * Send message 'PFS Order BOL Comment  EX'
     C                     MOVEL'USR3491' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@BDCPAA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg PFS BOL Comment   CH - PFS Order BOL Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0108  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0109  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0110  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0111  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0112  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0113  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BDCPAA
     C                     Z-ADDWL0034    WVY1NX           PFS Company Num
     C                     Z-ADDWL0035    WVZPNX           PFS Order Numbe
     C                     MOVELWL0036    WVIZST    P      PFS BOL Comment
     C                     Z-ADDWL0037    WVZ1NX           PFS Sequence Nu
      *
     C           KLCHSY    KLIST
     C                     KFLD           WVY1NX           PFS Company Num
     C                     KFLD           WVZPNX           PFS Order Numbe
     C                     KFLD           WVIZST           PFS BOL Comment
     C                     KFLD           WVZ1NX           PFS Sequence Nu
     C           KLCHSY    CHAIN@BDCPAA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBDCPL0'MDACP
     C                     MOVEL'@BDCPAA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBD1    YBRDCS
      * Move non-key fields to @BDCPAA
     C                     MOVELWL0038    WVGJT1    P      PFS BOL Comment
     C                     MOVELWL0039    WVUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WVAJNY           PFS Change Date
     C                     Z-ADD##JTM     WVAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BDCPAA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Country Code only  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSZ02           Order Number
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Order Number
      * Setup key
     C                     Z-ADDWL0040    WQSZ01           Company Number
     C                     Z-ADDWL0041    WQSZ02           Order Number
      * Establish starting position
     C           KRSSZ     SETLL@BGWKAE                    *
     C           KRSSZ     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0042           Country Code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WBGMST    IFEQ 'L'                        *IF
     C           WBGMST    OREQ 'A'
     C           WBGMST    OREQ 'C'
     C           WBGMST    OREQ 'R'
     C           WBGMST    OREQ 'E'
     C           WBGMST    OREQ 'H'
     C           WBGMST    OREQ 'I'
      * PAR = DB1 By name
     C                     MOVELWBKXCD    WL0042           Country Code
     C                     GOTO SZEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSZ     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv PFS BL Cmnt f/CAT RT - Country Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXKXCD    WQTA01           Country Code
     C           *LIKE     DEFN WXI1SX    WQTA02           Comment Type
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Country Code
     C                     KFLD           WQTA02           Comment Type
      * Setup key
     C                     MOVELWL0043    WQTA01           Country Code
     C                     MOVELWL0044    WQTA02           Comment Type
      * Establish starting position
     C           KRSTA     SETLL@B1REED                    *
     C           KRSTA     READE@B1REED                  90*
      * Data record not found
     C   90                MOVEL'USR3594' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Comment is Not Entered
     C           WXQ6NA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0045    WL0030           PFS Company Num
     C                     Z-ADDWL0046    WL0031           PFS Order Numbe
     C                     MOVEL'BL'      WL0032    P      PFS BOL Comment
     C                     Z-ADDYL0023    WL0033           PFS Sequence Nu
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    YL0023           PFS Sequence Nu
     C                     ADD  1         YL0023           PFS Sequence Nu
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0045    WL0034           PFS Company Num
     C                     Z-ADDWL0046    WL0035           PFS Order Numbe
     C                     MOVEL'BL'      WL0036    P      PFS BOL Comment
     C                     Z-ADDYL0023    WL0037           PFS Sequence Nu
     C                     MOVELWXQ6NA    WL0038    P      PFS BOL Comment
     C                     MOVEL'A'       WL0039    P      PFS Record Stat
     C                     EXSR SWRVGN
     C                     END                             *FI
     C           KRSTA     READE@B1REED                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * PFS Cust Comment Tp BL RT - Customer Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0114  70       PFS Ship To Cus
     C                     MOVEL*BLANK    WN0115  2        PFS Comment Typ
     C                     Z-ADD*ZERO     WN0116  30       PFS Sequence Nu
     C                     MOVEL*BLANK    WN0117 60        PFS Comment
     C                     MOVEL*BLANK    WN0118  1        PFS Record Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYBKC7    WQTB01           Ship To Custome
     C           *LIKE     DEFN WYI1SX    WQTB02           Comment Type
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Ship To Custome
     C                     KFLD           WQTB02           Comment Type
      * Setup key
     C                     Z-ADDWL0048    WQTB01           Ship To Custome
     C                     MOVELWL0049    WQTB02           Comment Type
      * Establish starting position
     C           KRSTB     SETLL@AVCPG4                    *
     C           KRSTB     READE@AVCPG4                  90*
      * Data record not found
     C   90                MOVEL'USR2993' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Last Seq for Order - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0050    WL0030           PFS Company Num
     C                     Z-ADDWL0051    WL0031           PFS Order Numbe
     C                     MOVEL'BL'      WL0032    P      PFS BOL Comment
     C                     Z-ADDWN0116    WL0033           PFS Sequence Nu
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    WN0116           PFS Sequence Nu
     C                     ADD  1         WN0116           PFS Sequence Nu
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0050    WL0034           PFS Company Num
     C                     Z-ADDWL0051    WL0035           PFS Order Numbe
     C                     MOVEL'BL'      WL0036    P      PFS BOL Comment
     C                     Z-ADDWN0116    WL0037           PFS Sequence Nu
     C                     MOVELWYXRTX    WL0038    P      PFS BOL Comment
     C                     MOVEL'A'       WL0039    P      PFS Record Stat
     C                     EXSR SWRVGN
     C           KRSTB     READE@AVCPG4                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Crt PFS BOL CommntRT - Country Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXKXCD    WQTC01           Country Code
     C           *LIKE     DEFN WXI1SX    WQTC02           Comment Type
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Country Code
     C                     KFLD           WQTC02           Comment Type
      * Setup key
     C                     MOVELWL0052    WQTC01           Country Code
     C                     MOVELWL0053    WQTC02           Comment Type
      * Establish starting position
     C           KRSTC     SETLL@B1REED                    *
     C           KRSTC     READE@B1REED                  90*
      * Data record not found
     C   90                MOVEL'USR3594' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Comment is Not Entered
     C           WXQ6NA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Load Status is Unlock
     C           WL0056    IFEQ 'U'                        *IF
     C                     MOVEL'D'       YL0024           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       YL0024           PFS Record Stat
     C                     END                             *FI
      * Upd PFS BOL Comment   RT - PFS Order BOL Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0054    WL0034           PFS Company Num
     C                     Z-ADDWL0055    WL0035           PFS Order Numbe
     C                     MOVELWXI1SX    WL0036    P      PFS BOL Comment
     C                     Z-ADDWXM5NX    WL0037           PFS Sequence Nu
     C                     MOVELWXQ6NA    WL0038    P      PFS BOL Comment
     C                     MOVELYL0024    WL0039    P      PFS Record Stat
     C                     EXSR SWRVGN
     C                     END                             *FI
     C           KRSTC     READE@B1REED                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV *ALL Reg Code RT - Regulation Code Mst  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TACBAB    WQTD01           Regulation ID
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Regulation ID
      * Setup key
     C                     MOVELWL0057    WQTD01           Regulation ID
      * Establish starting position
     C           KRSTD     SETLL@C8REMY                    *
     C           KRSTD     READE@C8REMY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5316' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0058           Regulation Code
     C                     MOVEL*BLANK    WL0059           Regulation ID
     C                     MOVEL*BLANK    WL0060           Regulation Orig
     C                     MOVEL*BLANK    WL0061           Regulation Desc
     C                     MOVEL*BLANK    WL0062           ShipTo Est Stm
     C                     MOVEL*BLANK    WL0063           Ship To Cust Ty
     C                     MOVEL*BLANK    WL0064           Default Regulat
     C                     MOVEL*BLANK    WL0065           NonComp Stm1 St
     C                     MOVEL*BLANK    WL0066           NonComp Stm2 St
     C                     MOVEL*BLANK    WL0067           Compliancy Stm1
     C                     MOVEL*BLANK    WL0068           Compliancy Stm2
     C                     MOVEL*BLANK    WL0069           Record Status
     C                     Z-ADD*ZERO     WL0070           Create Date
     C                     Z-ADD*ZERO     WL0071           Create Time
     C                     MOVEL*BLANK    WL0072           Create User
     C                     MOVEL*BLANK    WL0073           Create Program
     C                     Z-ADD*ZERO     WL0074           Change Date
     C                     Z-ADD*ZERO     WL0075           Change Time
     C                     MOVEL*BLANK    WL0076           Change User
     C                     MOVEL*BLANK    WL0077           Change Program
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTACAAB    WL0058           Regulation Code
     C                     MOVELTACBAB    WL0059           Regulation ID
     C                     MOVELTACCAB    WL0060           Regulation Orig
     C                     MOVELTAUVU1    WL0061           Regulation Desc
     C                     MOVELTAUWU1    WL0062           ShipTo Est Stm
     C                     MOVELTACDAB    WL0063           Ship To Cust Ty
     C                     MOVELTAOHSC    WL0064           Default Regulat
     C                     MOVELTAUXU1    WL0065           NonComp Stm1 St
     C                     MOVELTAUYU1    WL0066           NonComp Stm2 St
     C                     MOVELTAUZU1    WL0067           Compliancy Stm1
     C                     MOVELTAU0U1    WL0068           Compliancy Stm2
     C                     MOVELTAVSST    WL0069           Record Status
     C                     Z-ADDTAMJDT    WL0070           Create Date
     C                     Z-ADDTABETM    WL0071           Create Time
     C                     MOVELTACCVN    WL0072           Create User
     C                     MOVELTACDVN    WL0073           Create Program
     C                     Z-ADDTAMKDT    WL0074           Change Date
     C                     Z-ADDTABFTM    WL0075           Change Time
     C                     MOVELTACEVN    WL0076           Change User
     C                     MOVELTACFVN    WL0077           Change Program
     C           KRSTD     READE@C8REMY                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv All - Customer EXT2  *  Get Establishment Nbr
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0079           M3 Supplier ID
     C                     MOVEL*BLANK    WL0080           Dft Mode of Tra
     C                     MOVEL*BLANK    WL0081           Buying Group
     C                     MOVEL*BLANK    WL0082           Buying Group Op
     C                     MOVEL*BLANK    WL0083           Ship To Establi
     C                     MOVEL*BLANK    WL0084           PM Pallet Type
     C                     MOVEL*BLANK    WL0085           Cust Dft Price
     C                     Z-ADD*ZERO     WL0086           Cust Dft Age Da
     C                     Z-ADD*ZERO     WL0087           Cust Dft Delive
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           TBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0078    TBBKC7           Ship To Custome
      * Establish starting position
     C           KRSTE     CHAIN@AAREY9              90    *
      * Data record not found
     C   90                MOVEL'USR4969' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTBVEAA    WL0079           M3 Supplier ID
     C                     MOVELTBD9SC    WL0080           Dft Mode of Tra
     C                     MOVELTBZZAA    WL0081           Buying Group
     C                     MOVELTBK8SC    WL0082           Buying Group Op
     C                     MOVELTBO1U1    WL0083           Ship To Establi
     C                     MOVELTBLWSC    WL0084           PM Pallet Type
     C                     MOVELTBAKAB    WL0085           Cust Dft Price
     C                     Z-ADDTBGANZ    WL0086           Cust Dft Age Da
     C                     Z-ADDTBEOTM    WL0087           Cust Dft Delive
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Default Reg Code RT - Regulation Code Mst  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSTF     KLIST
     C                     KFLD           TACBAB           Regulation ID
      * Setup key
     C                     MOVELWL0088    TACBAB           Regulation ID
      * Establish starting position
     C           KPSTF     SETLL@C8REMY                    *
     C                     READ @C8REMY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5316' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Default Regulation is Yes
     C           TAOHSC    IFEQ 'Y'                        *IF
     C                     MOVELTACBAB    WL0089           Regulation ID
     C                     GOTO TFEXIT                     *QUIT
     C                     END                             *FI
     C                     READ @C8REMY                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv All Values        RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           TCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0090    TCBKC7           Ship To Custome
      * Establish starting position
     C           KRSTG     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0091           Internet Passwo
     C                     MOVEL*BLANK    WL0092           Email Address
     C                     MOVEL*BLANK    WL0093           Email User ID
     C                     MOVEL*BLANK    WL0094           EDI Trading Par
     C                     MOVEL*BLANK    WL0095           EDI Cust Duns N
     C                     MOVEL*BLANK    WL0096           EDI Warehouse/S
     C                     MOVEL*BLANK    WL0097           State Tax ID
     C                     MOVEL*BLANK    WL0098           Cust Shipping T
     C                     MOVEL*BLANK    WL0099           One Invoice Per
     C                     MOVEL*BLANK    WL0100           EDI Advanced Sh
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTCUFTX    WL0091           Internet Passwo
     C                     MOVELTCUGTX    WL0092           Email Address
     C                     MOVELTCPFNA    WL0093           Email User ID
     C                     MOVELTCJ5NX    WL0094           EDI Trading Par
     C                     MOVELTCU5TX    WL0095           EDI Cust Duns N
     C                     MOVELTCU6TX    WL0096           EDI Warehouse/S
     C                     MOVELTCW0TX    WL0097           State Tax ID
     C                     MOVELTCHSSX    WL0098           Cust Shipping T
     C                     MOVELTCHUSX    WL0099           One Invoice Per
     C                     MOVELTCHVSX    WL0100           EDI Advanced Sh
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0101    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSTH     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFBVTX    WL0102           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TDRMNB    WQTI02           Load ID
     C           *LIKE     DEFN TDC4NB    WQTI03           Order Number
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI02           Load ID
     C                     KFLD           WQTI03           Order Number
      * Setup key
     C                     Z-ADDWL0103    WQTI02           Load ID
     C                     Z-ADDWL0104    WQTI03           Order Number
      * Establish starting position
     C           KRSTI     SETLL@FLCPKF                    *
     C           KRSTI     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDTDN7DT    WL0105           Appointment Con
     C                     Z-ADDTDB3TM    WL0106           Appointment Con
     C                     GOTO TIEXIT                     *QUIT
     C           KRSTI     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV OHE Delivery PO #  RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0107    WRAIC3           Company Number
     C                     Z-ADDWL0108    WRC4NB           Order Number
      * Establish starting position
     C           KRSTJ     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0109           Delivery P.O. N
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRLMT1    WL0109           Delivery P.O. N
     C                     GOTO TJEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV From/To WHS   PFS RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQTK01           Company Number
     C           *LIKE     DEFN WEC4NB    WQTK02           Order Number
      * Define keylist
     C           KPSTK     KLIST
     C                     KFLD           WQTK01           Company Number
     C                     KFLD           WQTK02           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           Company Number
     C                     KFLD           WQTK02           Order Number
      * Setup key
     C                     Z-ADDWL0110    WQTK01           Company Number
     C                     Z-ADDWL0111    WQTK02           Order Number
     C                     Z-ADDWL0112    WEDPNB           Order Sequence
     C                     Z-ADDWL0113    WEUENB           Order Secondary
      * Establish starting position
     C           KPSTK     SETLL@BGWKL1                    *
     C           KRSTK     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0114           Warehouse Code
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WEGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWEAJCD    WL0114           Warehouse Code
     C                     GOTO TKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTK     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * RTV PFS Export Inst    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0115    WRAIC3           Company Number
     C                     Z-ADDWL0116    WRC4NB           Order Number
      * Establish starting position
     C           KRSTL     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0119           Shipping Line
     C                     MOVEL*BLANK    WL0120           Port Delv Termi
     C                     MOVEL*BLANK    WL0121           OHE City
     C                     MOVEL*BLANK    WL0122           OHE Vessel_Airl
     C                     MOVEL*BLANK    WL0123           OHE Voyage_Flig
     C                     MOVEL*BLANK    WL0124           OHE Booking Num
     C                     MOVEL*BLANK    WL0125           OHE Discharge P
     C                     Z-ADD*ZERO     WL0126           OHE Sail_Flight
     C                     Z-ADD*ZERO     WL0127           OHE Port Cut Da
     C                     Z-ADD*ZERO     WL0128           OHE Arrival Dat
     C                     MOVEL*BLANK    WL0129           OHE Late Delive
     C                     MOVEL*BLANK    WL0130           OHE Ship Status
     C                     MOVEL*BLANK    WL0131           OHE Container N
     C                     MOVEL*BLANK    WL0132           OHE Comment 1
     C                     MOVEL*BLANK    WL0133           OHE Comment 2
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRXACD    WL0119           Shipping Line
     C                     MOVELWROANA    WL0120           Port Delv Termi
     C                     MOVELWRHBAA    WL0121           OHE City
     C                     MOVELWRJ0T1    WL0122           OHE Vessel_Airl
     C                     MOVELWRGENY    WL0123           OHE Voyage_Flig
     C                     MOVELWRJ1T1    WL0124           OHE Booking Num
     C                     MOVELWRHCAA    WL0125           OHE Discharge P
     C                     Z-ADDWRQWDT    WL0126           OHE Sail_Flight
     C                     Z-ADDWRQXDT    WL0127           OHE Port Cut Da
     C                     Z-ADDWRQYDT    WL0128           OHE Arrival Dat
     C                     MOVELWRHDAA    WL0129           OHE Late Delive
     C                     MOVELWRCCTX    WL0130           OHE Ship Status
     C                     MOVELWRJ2T1    WL0131           OHE Container N
     C                     MOVELWRRLNA    WL0132           OHE Comment 1
     C                     MOVELWRRMNA    WL0133           OHE Comment 2
     C                     GOTO TLEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           TEXACD           Shipping Line
     C                     KFLD           TEOANA           Port Delv Termi
      * Setup key
     C                     MOVELWL0134    TEXACD           Shipping Line
     C                     MOVELWL0135    TEOANA           Port Delv Termi
      * Establish starting position
     C           KRSTM     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0136           Port City
     C                     MOVEL*BLANK    WL0137           Port Address Li
     C                     MOVEL*BLANK    WL0138           Port Address Li
     C                     MOVEL*BLANK    WL0139           Sail Port State
     C                     MOVEL*BLANK    WL0140           Port Zip/Postal
     C                     Z-ADD*ZERO     WL0141           Port Phone Numb
     C                     MOVEL*BLANK    WL0142           Port Fax Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTEOKTX    WL0136           Port City
     C                     MOVELTELBTX    WL0137           Port Address Li
     C                     MOVELTELATX    WL0138           Port Address Li
     C                     MOVELTEXBCD    WL0139           Sail Port State
     C                     MOVELTELCTX    WL0140           Port Zip/Postal
     C                     Z-ADDTESPPN    WL0141           Port Phone Numb
     C                     MOVELTELDTX    WL0142           Port Fax Number
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Upd Order Header      RT - PFS Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0135  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0136  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0137  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0138  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0139  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0140  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * LJB 1/14/09 FP1303 Add PFS Delivery P.O. Number (new field)
      * RMC 03/13/07 output par.sequence no
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           TFY1NX           PFS Company Num
     C                     KFLD           TFZPNX           PFS Order Numbe
      * Setup key
     C                     Z-ADDWL0143    TFY1NX           PFS Company Num
     C                     Z-ADDWL0144    TFZPNX           PFS Order Numbe
      * Establish starting position
     C           KRSTN     CHAIN@BBCPZS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3486' W0RTN   7
      * USER: Processing if Data record not found
      * Crt PFS Order Header  CR - PFS Order Header  * 
     C                     EXSR TOCRRC
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg PFS Order Header  CH - PFS Order Header  * 
     C                     EXSR TPCHRC
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCRRC    BEGSR
      *================================================================
      * Crt PFS Order Header  CR - PFS Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BBCPZR
     C                     Z-ADDWL0143    TGY1NX           PFS Company Num
     C                     Z-ADDWL0144    TGZPNX           PFS Order Numbe
     C                     Z-ADDWL0145    TGZGNX           PFS Load ID
     C                     Z-ADDWL0146    TGZWNX           PFS Loading Seq
     C                     Z-ADDWL0147    TGZVNX           PFS Load Stop N
     C                     MOVELWL0148    TGVCSX           PFS Order Type
     C                     Z-ADDWL0149    TGZQNX           PFS Ship To Cus
     C                     MOVELWL0150    TGF0T1           PFS Ship To Cus
     C                     MOVELWL0151    TGF1T1           PFS Ship To Cus
     C                     MOVELWL0152    TGF2T1           PFS Ship To Cus
     C                     MOVELWL0153    TGGUT1           PFS Ship To Cus
     C                     MOVELWL0154    TGF3T1           PFS Ship To Cus
     C                     MOVELWL0155    TGF4T1           PFS Ship To Cus
     C                     MOVELWL0156    TGF5T1           PFS Ship To Cus
     C                     MOVELWL0157    TGF6T1           PFS Ship To Ema
     C                     MOVELWL0158    TGF7T1           PFS Ship To Pho
     C                     Z-ADDWL0159    TGZENX           PFS Bill To Cus
     C                     MOVELWL0160    TGF8T1           PFS Bill To Cus
     C                     MOVELWL0161    TGF9T1           PFS Bill To Cus
     C                     MOVELWL0162    TGGAT1           PFS Bill To Cus
     C                     MOVELWL0163    TGGVT1           PFS Bill To Cus
     C                     MOVELWL0164    TGGBT1           PFS Bill To Cus
     C                     MOVELWL0165    TGGCT1           PFS Bill To Cus
     C                     MOVELWL0166    TGGDT1           PFS Bill To Cus
     C                     MOVELWL0167    TGFZT1           PFS Customer PO
     C                     Z-ADDWL0168    TGZRNX           PFS Order Date
     C                     Z-ADDWL0169    TGZSNX           PFS Scheduled S
     C                     Z-ADDWL0170    TGZTNX           PFS Requested D
     C                     Z-ADDWL0171    TGZUNX           PFS Requested D
     C                     MOVELWL0172    TGVBSX           PFS Export Stat
     C                     MOVELWL0173    TGU3SX           PFS Country Cod
     C                     MOVELWL0174    TGGET1           PFS Special Ins
     C                     MOVELWL0175    TGGFT1           PFS Special Ins
     C                     Z-ADDWL0176    TGA1NY           PFS Maximum Gro
     C                     Z-ADDWL0177    TGBKNY           PFS Estimated P
     C                     Z-ADDWL0178    TGATNY           PFS Average Pal
     C                     MOVELWL0179    TGVESX           PFS Order Statu
     C                     MOVELWL0180    TGF8AA           PFS Ship From W
     C                     MOVELWL0181    TGF9AA           PFS Ship To War
     C                     Z-ADDWL0182    TGC5NY           PFS Order Detai
     C                     Z-ADDWL0183    TGF5NY           PFS Sequence No
     C                     MOVELWL0184    TGF5AA           PFS Shipping Li
     C                     MOVELWL0185    TGFRT1           PFS Shipping Li
     C                     MOVELWL0186    TGFST1           PFS Shipping Li
     C                     MOVELWL0187    TGFTT1           PFS Shipping Li
     C                     MOVELWL0188    TGFUT1           PFS Shipping Li
     C                     MOVELWL0189    TGFVT1           PFS Shipping Li
     C                     MOVELWL0190    TGFWT1           PFS Shipping LI
     C                     MOVELWL0191    TGFXT1           PFS Vessel Name
     C                     MOVELWL0192    TGZLNX           PFS Voyage
     C                     MOVELWL0193    TGF7AA           PFS Discharge P
     C                     MOVELWL0194    TGF6AA           PFS Booking Num
     C                     MOVELWL0195    TGS6NA           PFS Delivery P.
     C                     MOVELWL0196    TGZDSX           PFS Order Unuse
     C                     MOVELWL0197    TGZESX           PFS Order Unuse
     C                     MOVELWL0198    TGZFSX           PFS Order Unuse
     C                     MOVELWL0199    TGZGSX           PFS Order Unuse
     C                     MOVELWL0200    TGZHSX           PFS Regul Code
     C                     MOVELWL0201    TGMXU1           PFS Ship To Est
     C                     MOVELWL0202    TGUWSX           PFS Record Stat
     C                     Z-ADDWN0135    TGUXSX           PFS Process Sta
     C                     MOVELWN0136    TGV3SX           PFS Error Reaso
     C                     Z-ADDWN0137    TGAHNY           PFS Create Date
     C                     Z-ADDWN0138    TGAINY           PFS Create Time
     C                     Z-ADDWN0139    TGAJNY           PFS Change Date
     C                     Z-ADDWN0140    TGAKNY           PFS Change time
      *
      * USER: Processing before Data update
      * Set Create Stamp      IF
     C                     Z-ADD*ZERO     TGUXSX           PFS Process Sta
     C                     Z-ADD##JDT     TGAHNY           PFS Create Date
     C                     Z-ADD##JTM     TGAINY           PFS Create Time
     C           KLCRTO    KLIST
     C                     KFLD           TGY1NX           PFS Company Num
     C                     KFLD           TGZPNX           PFS Order Numbe
      * Check for duplicate primary key
     C           KLCRTO    SETLL@BBCPZR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3487' W0RTN   7
      * Send message 'PFS Order Header       EX'
     C                     MOVEL'USR3487' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C                     WRITE@BBCPZR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCHRC    BEGSR
      *================================================================
      * Chg PFS Order Header  CH - PFS Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0141  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0142  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0143  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0144  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0145  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0146  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BBCPZR
     C                     Z-ADDWL0143    TGY1NX           PFS Company Num
     C                     Z-ADDWL0144    TGZPNX           PFS Order Numbe
      *
     C           KLCHTP    KLIST
     C                     KFLD           TGY1NX           PFS Company Num
     C                     KFLD           TGZPNX           PFS Order Numbe
     C           KLCHTP    CHAIN@BBCPZR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBBCPL0'MDACP
     C                     MOVEL'@BBCPZR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBB1    YCRDCS
      * Move non-key fields to @BBCPZR
     C                     Z-ADDWL0145    TGZGNX           PFS Load ID
     C                     Z-ADDWL0146    TGZWNX           PFS Loading Seq
     C                     Z-ADDWL0147    TGZVNX           PFS Load Stop N
     C                     MOVELWL0148    TGVCSX    P      PFS Order Type
     C                     Z-ADDWL0149    TGZQNX           PFS Ship To Cus
     C                     MOVELWL0150    TGF0T1    P      PFS Ship To Cus
     C                     MOVELWL0151    TGF1T1    P      PFS Ship To Cus
     C                     MOVELWL0152    TGF2T1    P      PFS Ship To Cus
     C                     MOVELWL0153    TGGUT1    P      PFS Ship To Cus
     C                     MOVELWL0154    TGF3T1    P      PFS Ship To Cus
     C                     MOVELWL0155    TGF4T1    P      PFS Ship To Cus
     C                     MOVELWL0156    TGF5T1    P      PFS Ship To Cus
     C                     MOVELWL0157    TGF6T1    P      PFS Ship To Ema
     C                     MOVELWL0158    TGF7T1    P      PFS Ship To Pho
     C                     Z-ADDWL0159    TGZENX           PFS Bill To Cus
     C                     MOVELWL0160    TGF8T1    P      PFS Bill To Cus
     C                     MOVELWL0161    TGF9T1    P      PFS Bill To Cus
     C                     MOVELWL0162    TGGAT1    P      PFS Bill To Cus
     C                     MOVELWL0163    TGGVT1    P      PFS Bill To Cus
     C                     MOVELWL0164    TGGBT1    P      PFS Bill To Cus
     C                     MOVELWL0165    TGGCT1    P      PFS Bill To Cus
     C                     MOVELWL0166    TGGDT1    P      PFS Bill To Cus
     C                     MOVELWL0167    TGFZT1    P      PFS Customer PO
     C                     Z-ADDWL0168    TGZRNX           PFS Order Date
     C                     Z-ADDWL0169    TGZSNX           PFS Scheduled S
     C                     Z-ADDWL0170    TGZTNX           PFS Requested D
     C                     Z-ADDWL0171    TGZUNX           PFS Requested D
     C                     MOVELWL0172    TGVBSX    P      PFS Export Stat
     C                     MOVELWL0173    TGU3SX    P      PFS Country Cod
     C                     MOVELWL0174    TGGET1    P      PFS Special Ins
     C                     MOVELWL0175    TGGFT1    P      PFS Special Ins
     C                     Z-ADDWL0176    TGA1NY           PFS Maximum Gro
     C                     Z-ADDWL0177    TGBKNY           PFS Estimated P
     C                     Z-ADDWL0178    TGATNY           PFS Average Pal
     C                     MOVELWL0179    TGVESX    P      PFS Order Statu
     C                     MOVELWL0180    TGF8AA    P      PFS Ship From W
     C                     MOVELWL0181    TGF9AA    P      PFS Ship To War
     C                     Z-ADDWL0182    TGC5NY           PFS Order Detai
     C                     Z-ADDWL0183    TGF5NY           PFS Sequence No
     C                     MOVELWL0184    TGF5AA    P      PFS Shipping Li
     C                     MOVELWL0185    TGFRT1    P      PFS Shipping Li
     C                     MOVELWL0186    TGFST1    P      PFS Shipping Li
     C                     MOVELWL0187    TGFTT1    P      PFS Shipping Li
     C                     MOVELWL0188    TGFUT1    P      PFS Shipping Li
     C                     MOVELWL0189    TGFVT1    P      PFS Shipping Li
     C                     MOVELWL0190    TGFWT1    P      PFS Shipping LI
     C                     MOVELWL0191    TGFXT1    P      PFS Vessel Name
     C                     MOVELWL0192    TGZLNX    P      PFS Voyage
     C                     MOVELWL0193    TGF7AA    P      PFS Discharge P
     C                     MOVELWL0194    TGF6AA    P      PFS Booking Num
     C                     MOVELWL0195    TGS6NA    P      PFS Delivery P.
     C                     MOVELWL0196    TGZDSX    P      PFS Order Unuse
     C                     MOVELWL0197    TGZESX    P      PFS Order Unuse
     C                     MOVELWL0198    TGZFSX    P      PFS Order Unuse
     C                     MOVELWL0199    TGZGSX    P      PFS Order Unuse
     C                     MOVELWL0200    TGZHSX    P      PFS Regul Code
     C                     MOVELWL0201    TGMXU1    P      PFS Ship To Est
     C                     MOVELWL0202    TGUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     TGAJNY           PFS Change Date
     C                     Z-ADD##JTM     TGAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BBCPZR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * FP1309 Calculate Oldest Allowed & Newest Allowed Dates
      *================================================================
      * FP1309 Calculate Oldest Allowed & Newest Allowed Dates
     C                     MOVELWUJ1TX    WN0068           PFS Age Code
     C                     Z-ADD*ZERO     WN0082           PFS Oldest Date
     C                     Z-ADD*ZERO     WN0083           PFS Newest Date
      * **** Calculate both dates ****
      * The oldest allowed date is either the Override From date or
      * Requested Delivery Date - Item Age Days.
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    YL0012           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           WUYJSX    IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           WL0004    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  WL0004    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           WEAODT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  WEAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEHGCD    WQ0004  70       Item Code
     C                     PARM WEAJCD    WQ0005  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0006  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0007 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0008 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0009 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0010 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0011 30        Error Reason De
     C                     PARM WEAIC3    WQ0012  30       Company Number
     C                     PARM WEAODT    WQ0013  70       Scheduled Ship
     C                     PARM WL0004    WQ0014  70       Requested Deliv
     C                     PARM WERINY    WQ0015  40       Item Age Days
     C                     PARM WETIDT    WQ0016  70       Production Ovr
     C                     PARM WETJDT    WQ0017  70       Production Ovr
     C           WN0082    PARM WN0082    WQ0018  70       Production AgeD
     C           WN0083    PARM WN0083    WQ0019  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'C'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0082    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWERINY    ZA0004           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WETIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0005
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WETJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWERINY    ZA0007           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WETIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0008
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WETJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWERINY    ZA0010           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WETIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WETJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0012
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWERINY    ZA0013           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WETIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WETJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0015
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           WETIDT    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADDWERINY    ZA0016           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WN0082    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  WN0083    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       YL0012           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Newest date is from the Schedule Ship Date unless User OvrR
      * CASE: DB1.Production Ovr AgeDte To is GT Zero
     C           WETJDT    IFGT 0                          *IF
      * The newest allowed date: If entered - Override To date will be us
     C                     ELSE
      * CASE: *OTHERWISE
      * The newest allowed date: If there is no override then
      * the newest allowed date = Schedule Ship Date
      * Carlisle application adds the chill time in their process
      * Requested from John Z during technical review.  FP1309
     C                     Z-ADDWEAODT    WN0083           PFS Newest Date
     C                     END                             *FI
      * R5207 2/16/16  Dailys  Only  - newest prod date
      * CASE: WRK.Company Organization is Daily's
     C           WUYJSX    IFEQ 'D'                        *IF
      * Rtv Prev Prd Dte      RT - Calendar  * 
     C                     EXSR SJRVGN
     C                     MOVEL*BLANK    WUR4TX           Date (Alpha) US
     C                     MOVELYL0013    WUR4TX           Date (Alpha) US
     C                     Z-ADD6         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUR4TX:ZQ WUT7TX    P  90  Date (Char-6) U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           '20'      CAT  WUT7TX:ZQ YL0014    P      Date (Char-8) U
     C                     MOVE YL0014    WN0083           PFS Newest Date
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * WI572 - Regulation ID logic
      *================================================================
      * RTV *ALL Reg Code RT - Regulation Code Mst  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0010    WL0057    P      Regulation ID
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0058    YN0005    P      Regulation Code
     C                     MOVELWL0059    YL0025    P      Regulation ID
     C                     MOVELWL0060    YN0006    P      Regulation Orig
     C                     MOVELWL0061    YN0007    P      Regulation Desc
     C                     MOVELWL0062    YL0026    P      ShipTo Est Stm
     C                     MOVELWL0063    YL0027    P      Ship To Cust Ty
     C                     MOVELWL0064    YN0008    P      Default Regulat
     C                     MOVELWL0065    YN0009    P      NonComp Stm1 St
     C                     MOVELWL0066    YN0010    P      NonComp Stm2 St
     C                     MOVELWL0067    YN0011    P      Compliancy Stm1
     C                     MOVELWL0068    YN0012    P      Compliancy Stm2
     C                     MOVELWL0069    YN0013    P      Record Status
     C                     Z-ADDWL0070    YN0014           Create Date
     C                     Z-ADDWL0071    YN0015           Create Time
     C                     MOVELWL0072    YN0016    P      Create User
     C                     MOVELWL0073    YN0017    P      Create Program
     C                     Z-ADDWL0074    YN0018           Change Date
     C                     Z-ADDWL0075    YN0019           Change Time
     C                     MOVELWL0076    YN0020    P      Change User
     C                     MOVELWL0077    YN0021    P      Change Program
      * Per the business we print the EST# regardless of customer type.
      * Rtv All - Customer EXT2  *  Get Establishment Nbr
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDBKC7    WL0078           Ship To Custome
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0079    YN0022    P      M3 Supplier ID
     C                     MOVELWL0080    YN0023    P      Dft Mode of Tra
     C                     MOVELWL0081    YN0024    P      Buying Group
     C                     MOVELWL0082    YN0025    P      Buying Group Op
     C                     MOVELWL0083    WN0058    P      Ship To Establi
     C                     MOVELWL0084    YN0026    P      PM Pallet Type
     C                     MOVELWL0085    YN0027    P      Cust Dft Price
     C                     Z-ADDWL0086    YN0028           Cust Dft Age Da
     C                     Z-ADDWL0087    YN0029           Cust Dft Delive
      * Update of PFS Order Header (PPBBCPP) field = BBZHSX (Regulation I
      * If the Regulation Id from the OD is entered, then use it
     C                     MOVEL'Y'       YL0028           Continue (Yes/N
      * Use Reg ID from the Order Detail if entered
      * CASE: LCL.IDE Regulation Code ID is Blank
     C           YL0010    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * To update PFS OH
     C                     MOVELYL0025    WN0057           PFS Regul Code
     C                     MOVEL'N'       YL0028           Continue (Yes/N
     C                     END                             *FI
      * If the regulation id from the ShipTo above is entered, then use i
      * CASE: LCL.Continue (Yes/No) USR is Yes
     C           YL0028    IFEQ 'Y'                        *IF
      * Use Reg ID from the Ship To if entered
      * CASE: LCL.Regulation ID is Entered
     C           YL0025    IFNE *BLANK                     *IF
      * To update PFS OH
     C                     MOVELYL0025    WN0057           PFS Regul Code
     C                     MOVEL'N'       YL0028           Continue (Yes/N
     C                     END                             *FI
     C                     END                             *FI
      * Else Read the Regulation Code Mst for the one with Default Regula
      * set to "Y" and update the Regulation ID with its Regulation ID.
      * CASE: LCL.Continue (Yes/No) USR is Yes
     C           YL0028    IFEQ 'Y'                        *IF
      * RTV Default Reg Code RT - Regulation Code Mst  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL*BLANK    WL0088           Regulation ID
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0089    YL0025    P      Regulation ID
      * To update PFS OH
     C                     MOVELYL0025    WN0057           PFS Regul Code
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ** CREATE ORDER HEADER
      *================================================================
     C                     Z-ADDWDAIC3    WN0002           PFS Company Num
     C                     Z-ADDWDC4NB    WN0003           PFS Order Numbe
     C                     Z-ADDWARMNB    WN0004           PFS Load ID
     C                     Z-ADDWARVNB    WN0005           PFS Load Stop N
     C                     MOVELWDJNCD    WN0006           PFS Order Type
     C                     Z-ADDWDBKC7    WN0007           PFS Ship To Cus
     C                     MOVELWDBRTX    WN0008           PFS Ship To Cus
     C                     MOVELWDHMNA    WN0009           PFS Ship To Cus
     C                     MOVELWDHONA    WN0010           PFS Ship To Cus
     C                     MOVELWDHPNA    WN0011           PFS Ship To Cus
     C                     MOVELWDHNNA    WN0012           PFS Ship To Cus
     C                     MOVELWDDBCD    WN0013           PFS Ship To Cus
     C                     MOVELWDCKTX    WN0014           PFS Ship To Cus
      * Rtv All Values        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDBKC7    WL0090           Ship To Custome
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0091    YN0030    P      Internet Passwo
     C                     MOVELWL0092    WN0015    P      Email Address
     C                     MOVELWL0093    YN0031    P      Email User ID
     C                     MOVELWL0094    YN0032    P      EDI Trading Par
     C                     MOVELWL0095    YN0033    P      EDI Cust Duns N
     C                     MOVELWL0096    YN0034    P      EDI Warehouse/S
     C                     MOVELWL0097    YN0035    P      State Tax ID
     C                     MOVELWL0098    YN0036    P      Cust Shipping T
     C                     MOVELWL0099    YN0037    P      One Invoice Per
     C                     MOVELWL0100    YN0038    P      EDI Advanced Sh
      * RTV Customer Telephone RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDBKC7    WL0101           Ship To Custome
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0102    WN0016    P      Telephone Numbe
     C                     Z-ADDWDB0C7    WN0017           PFS Bill To Cus
     C                     MOVELWDAETX    WN0018           PFS Bill To Cus
     C                     MOVELWDB1NA    WN0019           PFS Bill To Cus
     C                     MOVELWDB3NA    WN0020           PFS Bill To Cus
     C                     MOVELWDB4NA    WN0021           PFS Bill To Cus
     C                     MOVELWDB2NA    WN0022           PFS Bill To Cus
     C                     MOVELWDBHCD    WN0023           PFS Bill To Cus
     C                     MOVELWDC8TX    WN0024           PFS Bill To Cus
     C                     MOVELWDBCNA    WN0025           PFS Customer PO
      *
     C                     MOVEL*BLANK    WN0119  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0120  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0121  2        Month (Char) US
     C                     MOVEL*BLANK    WN0122  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WDA0DT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0029
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WDA0DT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0030
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WDA0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0031
     C                     MOVEL*BLANK    WN0120           Year Alpha (YYY
     C                     MOVELYL0029    WN0120           Year Alpha (YYY
     C                     MOVELYL0030    WN0121           Month (Char) US
     C                     MOVELYL0031    WN0122           Day   (Char) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0120    CAT  WN0121:ZQ WN0119    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0119    CAT  WN0122:ZQ WN0119    P      Date (Char-8) U
     C                     MOVE WN0119    WN0026           Date Out (8,0)
      *
     C                     MOVEL*BLANK    WN0123  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0124  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0125  2        Month (Char) US
     C                     MOVEL*BLANK    WN0126  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WDAODT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0029
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WDAODT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0030
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WDAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0031
     C                     MOVEL*BLANK    WN0124           Year Alpha (YYY
     C                     MOVELYL0029    WN0124           Year Alpha (YYY
     C                     MOVELYL0030    WN0125           Month (Char) US
     C                     MOVELYL0031    WN0126           Day   (Char) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0124    CAT  WN0125:ZQ WN0123    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0123    CAT  WN0126:ZQ WN0123    P      Date (Char-8) U
     C                     MOVE WN0123    WN0027           Date Out (8,0)
     C                     Z-ADD*ZERO     YL0032           LD Carrier Appt
     C                     Z-ADD*ZERO     YL0033           LD Carrier Appt
      * E4119 RMC 9/2/16 TMS Use appt date/time if there, else use req de
      * CASE: DB1.OH Load Plan Ready is Yes
     C           WDFVSX    IFEQ 'Y'                        *IF
      * RTV Carr Appt Dt/Tm   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDRMNB    WL0103           Load ID
     C                     Z-ADDWDC4NB    WL0104           Order Number
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0105    YL0032           Appointment Con
     C                     Z-ADDWL0106    YL0033           Appointment Con
     C                     END                             *FI
      * CASE: LCL.LD Carrier Appt Date is Entered
     C           YL0032    IFGT 0                          *IF
      *
     C                     MOVEL*BLANK    WN0127  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0128  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0129  2        Month (Char) US
     C                     MOVEL*BLANK    WN0130  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           YL0032    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0029
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           YL0032    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0030
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           YL0032    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0031
     C                     MOVEL*BLANK    WN0128           Year Alpha (YYY
     C                     MOVELYL0029    WN0128           Year Alpha (YYY
     C                     MOVELYL0030    WN0129           Month (Char) US
     C                     MOVELYL0031    WN0130           Day   (Char) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0128    CAT  WN0129:ZQ WN0127    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0127    CAT  WN0130:ZQ WN0127    P      Date (Char-8) U
     C                     MOVE WN0127    WN0028           Date Out (8,0)
     C                     Z-ADDYL0033    WN0029           PFS Requested D
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0131  8        Date (Char-8) U
     C                     MOVEL*BLANK    WN0132  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0133  2        Month (Char) US
     C                     MOVEL*BLANK    WN0134  2        Day   (Char) US
      *
      * CNV cyymmdd to yyyymmdd
      * LCL.Year Code = PAR.Date In  (7,0) USR *YEAR
     C           WDEIDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0029
      * LCL.Month NBR USR = PAR.Date In  (7,0) USR *MONTH
     C           WDEIDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    YL0030
      * LCL.Day of Month USR = PAR.Date In  (7,0) USR *DAY OF MONTH
     C           WDEIDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0031
     C                     MOVEL*BLANK    WN0132           Year Alpha (YYY
     C                     MOVELYL0029    WN0132           Year Alpha (YYY
     C                     MOVELYL0030    WN0133           Month (Char) US
     C                     MOVELYL0031    WN0134           Day   (Char) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0132    CAT  WN0133:ZQ WN0131    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0131    CAT  WN0134:ZQ WN0131    P      Date (Char-8) U
     C                     MOVE WN0131    WN0028           Date Out (8,0)
     C           100       MULT WDAFTM    WN0029           PFS Requested D
     C                     END                             *FI
     C                     MOVELWDU2ST    WN0030           PFS Export Stat
      * RTV Country Code only  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0040           Company Number
     C                     Z-ADDWDC4NB    WL0041           Order Number
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    WN0031    P      Country Code
      * ** 01/14/2009 LJB FP1303 Retrieve new delivery p.o.number
      * RTV OHE Delivery PO #  RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0107           Company Number
     C                     Z-ADDWDC4NB    WL0108           Order Number
     C                     MOVELWN0052    WL0109    P      Delivery P.O. N
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0109    WN0052    P      Delivery P.O. N
      * CASE: PAR.PFS Country Code is Not Entered
     C           WN0031    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    WN0031           PFS Country Cod
     C                     MOVEL'USA'     WN0031           PFS Country Cod
     C                     END                             *FI
     C                     MOVELWDB6NA    WN0032           PFS Special Ins
     C                     MOVELWDBYNA    WN0033           PFS Special Ins
     C                     Z-ADDWDBPTM    WN0034           PFS Maximum Gro
     C                     Z-ADDYL0008    WN0035           PFS Estimated P
      * avg pallet tare
      * CASE: LCL.Number Pallets Loaded is Not zero
     C           YL0008    IFNE 0                          *IF
     C           YL0009    DIV  YL0008    WN0036    H      PFS Average Pal
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0036           PFS Average Pal
     C                     END                             *FI
      * RTV From/To WHS   PFS RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0110           Company Number
     C                     Z-ADDWDC4NB    WL0111           Order Number
     C                     Z-ADD*ZERO     WL0112           Order Sequence
     C                     Z-ADD*ZERO     WL0113           Order Secondary
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0114    WN0038    P      Warehouse Code
      * Warehouse CFH to CF1
      * CASE: PAR.PFS Ship From Warehouse is CFH
     C           WN0038    IFEQ 'CFH'                      *IF
     C                     MOVEL'CF1'     WN0038           PFS Ship From W
     C                     END                             *FI
      * PFS Ship To Warehouse for Transfers
      * CASE: DB1.Order Type - Sales is Transfer Order
     C           WDJNCD    IFEQ 'TR'                       *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0014           Company Number
     C                     Z-ADDWDBKC7    WL0015           Ship To Custome
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0016    WN0039    P      Warehouse Code
     C                     END                             *FI
      * invoiced status
      * CASE: DB1.Invoice Number is GT Zero
     C           WDCONB    IFGT 0                          *IF
     C                     MOVEL'C'       WN0037           PFS Order Statu
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWDGWST    WN0037           PFS Order Statu
     C                     END                             *FI
      * --------
      * load status
      * CASE: PAR.Load Status is Unlock
     C           P1PKST    IFEQ 'U'                        *IF
     C                     MOVEL'D'       WN0059           PFS Record Stat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WN0059           PFS Record Stat
     C                     END                             *FI
      * PFS015 RMC 8/14/06
      * CASE: PAR.Receipt Order Sts USR is yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     MOVEL'RO'      WN0006           PFS Order Type
     C                     END                             *FI
      * **************************************************************
      * ** FP1101-4 LJB 04/06/2007
      * ** Get Customer Order Export Instructions from OHE
      * CASE: DB1.Export Status is yes
     C           WDU2ST    IFEQ 'Y'                        *IF
      * ** FP1101
     C                     MOVELWDU2ST    WN0030           PFS Export Stat
      * RTV PFS Export Inst    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0115           Company Number
     C                     Z-ADDWDC4NB    WL0116           Order Number
     C                     Z-ADDWDRMNB    WL0117           Load ID
     C                     Z-ADDWARVNB    WL0118           Stop_Drop Seque
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0119    WN0041    P      Shipping Line
     C                     MOVELWL0120    P4OANA    P      Port Delv Termi
     C                     MOVELWL0121    WN0045    P      OHE City
     C                     MOVELWL0122    WN0048    P      OHE Vessel_Airl
     C                     MOVELWL0123    WN0049    P      OHE Voyage_Flig
     C                     MOVELWL0124    WN0051    P      OHE Booking Num
     C                     MOVELWL0125    WN0050    P      OHE Discharge P
     C                     Z-ADDWL0126    YL0034           OHE Sail_Flight
     C                     Z-ADDWL0127    YL0035           OHE Port Cut Da
     C                     Z-ADDWL0128    YL0036           OHE Arrival Dat
     C                     MOVELWL0129    YL0037    P      OHE Late Delive
     C                     MOVELWL0130    YL0038    P      OHE Ship Status
     C                     MOVELWL0131    YL0039    P      OHE Container N
     C                     MOVELWL0132    YL0040    P      OHE Comment 1
     C                     MOVELWL0133    YL0041    P      OHE Comment 2
      * ** Shipping line and port terminal info
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PFS Shipping Line is Entered
      *   |- c2    : PAR.Port Delv Terminal is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0041    IFNE *BLANK                     *IF
     C           P4OANA    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Shipping Line/PortsRT - Shipping Line/Port  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0041    WL0134    P      Shipping Line
     C                     MOVELP4OANA    WL0135    P      Port Delv Termi
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0136    WN0045    P      Port City
     C                     MOVELWL0137    WN0043    P      Port Address Li
     C                     MOVELWL0138    WN0044    P      Port Address Li
     C                     MOVELWL0139    WN0046    P      Sail Port State
     C                     MOVELWL0140    WN0047    P      Port Zip/Postal
     C                     Z-ADDWL0141    YL0042           Port Phone Numb
     C                     MOVELWL0142    YN0039    P      Port Fax Number
     C                     MOVEL*BLANK    WN0042           PFS Shipping Li
     C                     MOVELP4OANA    WN0042           PFS Shipping Li
     C                     MOVEL*BLANK    WN0016           PFS Ship To Pho
     C                     MOVELYL0042    WN0016           PFS Ship To Pho
     C                     END                             *FI
     C                     END                             *FI
      * ** Update includes new Order Header Extension file export data
      * 07/12/19 DN R15161-Sent in PAR.PFS Load Unused Text 1.
      * Upd Order Header      RT - PFS Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0143           PFS Company Num
     C                     Z-ADDWN0003    WL0144           PFS Order Numbe
     C                     Z-ADDWN0004    WL0145           PFS Load ID
     C                     Z-ADDWN0001    WL0146           PFS Loading Seq
     C                     Z-ADDWN0005    WL0147           PFS Load Stop N
     C                     MOVELWN0006    WL0148    P      PFS Order Type
     C                     Z-ADDWN0007    WL0149           PFS Ship To Cus
     C                     MOVELWN0008    WL0150    P      PFS Ship To Cus
     C                     MOVELWN0009    WL0151    P      PFS Ship To Cus
     C                     MOVELWN0010    WL0152    P      PFS Ship To Cus
     C                     MOVELWN0011    WL0153    P      PFS Ship To Cus
     C                     MOVELWN0012    WL0154    P      PFS Ship To Cus
     C                     MOVELWN0013    WL0155    P      PFS Ship To Cus
     C                     MOVELWN0014    WL0156    P      PFS Ship To Cus
     C                     MOVELWN0015    WL0157    P      PFS Ship To Ema
     C                     MOVELWN0016    WL0158    P      PFS Ship To Pho
     C                     Z-ADDWN0017    WL0159           PFS Bill To Cus
     C                     MOVELWN0018    WL0160    P      PFS Bill To Cus
     C                     MOVELWN0019    WL0161    P      PFS Bill To Cus
     C                     MOVELWN0020    WL0162    P      PFS Bill To Cus
     C                     MOVELWN0021    WL0163    P      PFS Bill To Cus
     C                     MOVELWN0022    WL0164    P      PFS Bill To Cus
     C                     MOVELWN0023    WL0165    P      PFS Bill To Cus
     C                     MOVELWN0024    WL0166    P      PFS Bill To Cus
     C                     MOVELWN0025    WL0167    P      PFS Customer PO
     C                     Z-ADDWN0026    WL0168           PFS Order Date
     C                     Z-ADDWN0027    WL0169           PFS Scheduled S
     C                     Z-ADDWN0028    WL0170           PFS Requested D
     C                     Z-ADDWN0029    WL0171           PFS Requested D
     C                     MOVELWN0030    WL0172    P      PFS Export Stat
     C                     MOVELWN0031    WL0173    P      PFS Country Cod
     C                     MOVELWN0032    WL0174    P      PFS Special Ins
     C                     MOVELWN0033    WL0175    P      PFS Special Ins
     C                     Z-ADDWN0034    WL0176           PFS Maximum Gro
     C                     Z-ADDWN0035    WL0177           PFS Estimated P
     C                     Z-ADDWN0036    WL0178           PFS Average Pal
     C                     MOVELWN0037    WL0179    P      PFS Order Statu
     C                     MOVELWN0038    WL0180    P      PFS Ship From W
     C                     MOVELWN0039    WL0181    P      PFS Ship To War
     C                     Z-ADDWN0040    WL0182           PFS Order Detai
     C                     Z-ADDP5F5NY    WL0183           PFS Sequence No
     C                     MOVELWN0041    WL0184    P      PFS Shipping Li
     C                     MOVELWN0042    WL0185    P      PFS Shipping Li
     C                     MOVELWN0043    WL0186    P      PFS Shipping Li
     C                     MOVELWN0044    WL0187    P      PFS Shipping Li
     C                     MOVELWN0045    WL0188    P      PFS Shipping Li
     C                     MOVELWN0046    WL0189    P      PFS Shipping Li
     C                     MOVELWN0047    WL0190    P      PFS Shipping LI
     C                     MOVELWN0048    WL0191    P      PFS Vessel Name
     C                     MOVELWN0049    WL0192    P      PFS Voyage
     C                     MOVELWN0050    WL0193    P      PFS Discharge P
     C                     MOVELWN0051    WL0194    P      PFS Booking Num
     C                     MOVELWN0052    WL0195    P      PFS Delivery P.
     C                     MOVELWN0053    WL0196    P      PFS Order Unuse
     C                     MOVELWN0054    WL0197    P      PFS Order Unuse
     C                     MOVELWN0055    WL0198    P      PFS Order Unuse
     C                     MOVELWN0056    WL0199    P      PFS Order Unuse
     C                     MOVELWN0057    WL0200    P      PFS Regul Code
     C                     MOVELWN0058    WL0201    P      PFS Ship To Est
     C                     MOVELWN0059    WL0202    P      PFS Record Stat
     C                     EXSR TNRVGN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop_Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           AR Customer Num
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Plant Company Sts
     C                     MOVEL*BLANK    WUYISX  1
      * Define work field Company Organization
     C                     MOVEL*BLANK    WUYJSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFP3NB           D & B Number
     C                     Z-ADD*ZERO     WFI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WFAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WFANC7           AR Customer Num
     C                     Z-ADD*ZERO     WFBTC7           Parent Customer
     C                     Z-ADD*ZERO     WFS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WFVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WFI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHR5NB           Deliver after t
     C                     Z-ADD*ZERO     WHR6NB           Deliver before
     C                     Z-ADD*ZERO     WHTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WHMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WHW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field BLANK 1               USR
     C                     MOVEL*BLANK    WUJ1TX 25
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WICQNB           Julian Date
     C                     Z-ADD*ZERO     WIESNB           Accounting Year
     C                     Z-ADD*ZERO     WIETNB           Accounting Peri
     C                     Z-ADD*ZERO     WIBZNB           OM Week
     C                     Z-ADD*ZERO     WIEINB           Week Number
     C                     Z-ADD*ZERO     WIAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WIOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WINQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WINRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WIOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WIOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Date (Alpha) USR
     C                     MOVEL*BLANK    WUR4TX  7
      * Define work field Date (Char-6) USR
     C                     MOVEL*BLANK    WUT7TX  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJC9NB           Component Item
     C                     Z-ADD*ZERO     WJBOPR           Sales Yield
     C                     Z-ADD*ZERO     WJBPPR           Production Yiel
     C                     Z-ADD*ZERO     WJHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WJCNSM           Consume Priorit
     C                     Z-ADD*ZERO     WJBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WJBMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WJIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WJIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WKAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WKAIWG           Unit Weight
     C                     Z-ADD*ZERO     WKCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WKC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WKURTN           Number Cases On
     C                     Z-ADD*ZERO     WKAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WKRINB           Item Structure
     C                     Z-ADD*ZERO     WKRHNB           Item Structure
     C                     Z-ADD*ZERO     WKRGNB           Item Structure
     C                     Z-ADD*ZERO     WKTFNB           Transportation
     C                     Z-ADD*ZERO     WKTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WKTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WKBLPR           Market Overage
     C                     Z-ADD*ZERO     WKBMPR           Standard Overag
     C                     Z-ADD*ZERO     WKCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WKCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WKSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WKPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WKICN1           Item Category N
     C                     Z-ADD*ZERO     WKICN2           Item Category N
     C                     Z-ADD*ZERO     WKV2NB           Item Category N
     C                     Z-ADD*ZERO     WKITCN           Item Category N
     C                     Z-ADD*ZERO     WKITC5           Item Category N
     C                     Z-ADD*ZERO     WKICN6           Item Category N
     C                     Z-ADD*ZERO     WKICN7           Item Category N
     C                     Z-ADD*ZERO     WKICN8           Item Category N
     C                     Z-ADD*ZERO     WKICN9           Item Category N
     C                     Z-ADD*ZERO     WKICN0           Item Category N
     C                     Z-ADD*ZERO     WKSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WKA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WKSJNB           Production Lead
     C                     Z-ADD*ZERO     WKSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WKSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WKSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WKCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WKCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WKILNB           Packages per ca
     C                     Z-ADD*ZERO     WKCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WKCINB           PM Batch Size
     C                     Z-ADD*ZERO     WKCJNB           Package Level s
     C                     Z-ADD*ZERO     WKCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WKCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WKCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WKCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WKCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WKCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WKCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WKCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WKC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WKB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WKB5NB           PM Line Number
     C                     Z-ADD*ZERO     WKBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WKBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WKF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WKF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WKF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WKBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WKBNNB           Production Qty
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLDXNZ           IDE Unused Nbr
     C                     Z-ADD*ZERO     WLDYNZ           IDE Manufacture
     C                     Z-ADD*ZERO     WLMJDT           Create Date
     C                     Z-ADD*ZERO     WLBETM           Create Time
     C                     Z-ADD*ZERO     WLMKDT           Change Date
     C                     Z-ADD*ZERO     WLBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WMZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WMZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WMZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WMY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WMZFNX           PFS Scheduled Q
     C                     Z-ADD*ZERO     WMZZNX           PFS Scheduled W
     C                     Z-ADD*ZERO     WMZ0NX           PFS Maximum Net
     C                     Z-ADD*ZERO     WMBINY           PFS Minimum Uni
     C                     Z-ADD*ZERO     WMBJNY           PFS Maximum Uni
     C                     Z-ADD*ZERO     WMBKNY           PFS Estimated P
     C                     Z-ADD*ZERO     WMATNY           PFS Average Pal
     C                     Z-ADD*ZERO     WMALD8           PFS Oldest Date
     C                     Z-ADD*ZERO     WMAMD8           PFS Newest Date
     C                     Z-ADD*ZERO     WMF5NY           PFS Sequence No
     C                     Z-ADD*ZERO     WMUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WMAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WMAINY           PFS Create Time
     C                     Z-ADD*ZERO     WMAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WMAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRC4NB           Order Number
     C                     Z-ADD*ZERO     WRRMNB           Load ID
     C                     Z-ADD*ZERO     WRRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WRQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WRQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WRQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WRGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WRGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WRGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WRGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WRHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WRHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WRHGVL           Transload Termi
     C                     Z-ADD*ZERO     WRQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WRQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WRQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WRQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WRITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WRQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WRQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WRQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WRP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WRP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WRQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WRQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WRQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WRQENY           Original Appoin
     C                     Z-ADD*ZERO     WRQFNY           Original Appoin
     C                     Z-ADD*ZERO     WRQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WRQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WRQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WRQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WRW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WRW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSXXTM           Departure Time
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WTZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WTZ1NX           PFS Sequence Nu
     C                     Z-ADD*ZERO     WTUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WTAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WTAINY           PFS Create Time
     C                     Z-ADD*ZERO     WTAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WTAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWC4NB           Order Number
     C                     Z-ADD*ZERO     WWDXNB           Sequence Number
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXM5NX           Comment Sequenc
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WYM5NX           Comment Sequenc
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TAMJDT           Create Date
     C                     Z-ADD*ZERO     TABETM           Create Time
     C                     Z-ADD*ZERO     TAMKDT           Change Date
     C                     Z-ADD*ZERO     TABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     TBGBNZ           CEXT2 Unused Nb
     C                     Z-ADD*ZERO     TBFCNZ           CEXT2 Unused Nb
     C                     Z-ADD*ZERO     TBXKDT           CEXT2 Unused Dt
     C                     Z-ADD*ZERO     TBEPTM           CEXT2 Unused Tm
     C                     Z-ADD*ZERO     TBGANZ           Cust Dft Age Da
     C                     Z-ADD*ZERO     TBEOTM           Cust Dft Delive
     C                     Z-ADD*ZERO     TBMJDT           Create Date
     C                     Z-ADD*ZERO     TBBETM           Create Time
     C                     Z-ADD*ZERO     TBMKDT           Change Date
     C                     Z-ADD*ZERO     TBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     TCAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     TCAATM           Job Time
     C                     Z-ADD*ZERO     TCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TESPPN           Port Phone Numb
     C                     Z-ADD*ZERO     TEAATM           Job Time
     C                     Z-ADD*ZERO     TEAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  1
     C                     Z-ADD*ZERO     WL0008  90
     C                     Z-ADD*ZERO     WL0009  50
     C                     Z-ADD*ZERO     WL0010 112
     C                     MOVEL*BLANK    WL0011  1
     C                     Z-ADD*ZERO     WL0012  50
     C                     MOVEL*BLANK    WL0013  2
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  3
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  6
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0020  30
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  70
     C                     MOVEL*BLANK    WL0025  2
     C                     Z-ADD*ZERO     WL0026  30
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  70
     C                     MOVEL*BLANK    WL0029  2
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0030  30
     C                     Z-ADD*ZERO     WL0031  70
     C                     MOVEL*BLANK    WL0032  2
     C                     Z-ADD*ZERO     WL0033  30
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  70
     C                     MOVEL*BLANK    WL0036  2
     C                     Z-ADD*ZERO     WL0037  30
     C                     MOVEL*BLANK    WL0038 60
     C                     MOVEL*BLANK    WL0039  1
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  6
      * Define local variables for subroutine TARVGN.
     C                     MOVEL*BLANK    WL0043  6
     C                     MOVEL*BLANK    WL0044  2
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  70
     C                     MOVEL*BLANK    WL0047  1
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0048  70
     C                     MOVEL*BLANK    WL0049  2
     C                     Z-ADD*ZERO     WL0050  30
     C                     Z-ADD*ZERO     WL0051  70
      * Define local variables for subroutine TCRVGN.
     C                     MOVEL*BLANK    WL0052  6
     C                     MOVEL*BLANK    WL0053  2
     C                     Z-ADD*ZERO     WL0054  30
     C                     Z-ADD*ZERO     WL0055  70
     C                     MOVEL*BLANK    WL0056  1
      * Define local variables for subroutine TDRVGN.
     C                     MOVEL*BLANK    WL0057  2
     C                     MOVEL*BLANK    WL0058 10
     C                     MOVEL*BLANK    WL0059  2
     C                     MOVEL*BLANK    WL0060  3
     C                     MOVEL*BLANK    WL0061 30
     C                     MOVEL*BLANK    WL0062 30
     C                     MOVEL*BLANK    WL0063  2
     C                     MOVEL*BLANK    WL0064  1
     C                     MOVEL*BLANK    WL0065 75
     C                     MOVEL*BLANK    WL0066 75
     C                     MOVEL*BLANK    WL0067 50
     C                     MOVEL*BLANK    WL0068 50
     C                     MOVEL*BLANK    WL0069  1
     C                     Z-ADD*ZERO     WL0070  70
     C                     Z-ADD*ZERO     WL0071  60
     C                     MOVEL*BLANK    WL0072 10
     C                     MOVEL*BLANK    WL0073 10
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  60
     C                     MOVEL*BLANK    WL0076 10
     C                     MOVEL*BLANK    WL0077 10
      * Define local variables for subroutine TERVGN.
     C                     Z-ADD*ZERO     WL0078  70
     C                     MOVEL*BLANK    WL0079 10
     C                     MOVEL*BLANK    WL0080  2
     C                     MOVEL*BLANK    WL0081 10
     C                     MOVEL*BLANK    WL0082  1
     C                     MOVEL*BLANK    WL0083 25
     C                     MOVEL*BLANK    WL0084  2
     C                     MOVEL*BLANK    WL0085  3
     C                     Z-ADD*ZERO     WL0086  50
     C                     Z-ADD*ZERO     WL0087  60
      * Define local variables for subroutine TFRVGN.
     C                     MOVEL*BLANK    WL0088  2
     C                     MOVEL*BLANK    WL0089  2
      * Define local variables for subroutine TGRVGN.
     C                     Z-ADD*ZERO     WL0090  70
     C                     MOVEL*BLANK    WL0091 10
     C                     MOVEL*BLANK    WL0092 50
     C                     MOVEL*BLANK    WL0093  8
     C                     MOVEL*BLANK    WL0094  6
     C                     MOVEL*BLANK    WL0095 20
     C                     MOVEL*BLANK    WL0096 20
     C                     MOVEL*BLANK    WL0097 20
     C                     MOVEL*BLANK    WL0098  1
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  1
      * Define local variables for subroutine THRVGN.
     C                     Z-ADD*ZERO     WL0101  70
     C                     MOVEL*BLANK    WL0102 25
      * Define local variables for subroutine TIRVGN.
     C                     Z-ADD*ZERO     WL0103  70
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  70
     C                     Z-ADD*ZERO     WL0106  60
      * Define local variables for subroutine TJRVGN.
     C                     Z-ADD*ZERO     WL0107  30
     C                     Z-ADD*ZERO     WL0108  70
     C                     MOVEL*BLANK    WL0109 38
      * Define local variables for subroutine TKRVGN.
     C                     Z-ADD*ZERO     WL0110  30
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112  30
     C                     Z-ADD*ZERO     WL0113  30
     C                     MOVEL*BLANK    WL0114  3
      * Define local variables for subroutine TLRVGN.
     C                     Z-ADD*ZERO     WL0115  30
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117  70
     C                     Z-ADD*ZERO     WL0118  50
     C                     MOVEL*BLANK    WL0119  3
     C                     MOVEL*BLANK    WL0120 20
     C                     MOVEL*BLANK    WL0121 25
     C                     MOVEL*BLANK    WL0122 30
     C                     MOVEL*BLANK    WL0123 15
     C                     MOVEL*BLANK    WL0124 15
     C                     MOVEL*BLANK    WL0125 20
     C                     Z-ADD*ZERO     WL0126  70
     C                     Z-ADD*ZERO     WL0127  70
     C                     Z-ADD*ZERO     WL0128  70
     C                     MOVEL*BLANK    WL0129  3
     C                     MOVEL*BLANK    WL0130  1
     C                     MOVEL*BLANK    WL0131 12
     C                     MOVEL*BLANK    WL0132 35
     C                     MOVEL*BLANK    WL0133 75
      * Define local variables for subroutine TMRVGN.
     C                     MOVEL*BLANK    WL0134  3
     C                     MOVEL*BLANK    WL0135 20
     C                     MOVEL*BLANK    WL0136 25
     C                     MOVEL*BLANK    WL0137 25
     C                     MOVEL*BLANK    WL0138 25
     C                     MOVEL*BLANK    WL0139  2
     C                     MOVEL*BLANK    WL0140 11
     C                     Z-ADD*ZERO     WL0141 110
     C                     MOVEL*BLANK    WL0142 25
      * Define local variables for subroutine TNRVGN.
     C                     Z-ADD*ZERO     WL0143  30
     C                     Z-ADD*ZERO     WL0144  70
     C                     Z-ADD*ZERO     WL0145  70
     C                     Z-ADD*ZERO     WL0146  20
     C                     Z-ADD*ZERO     WL0147  20
     C                     MOVEL*BLANK    WL0148  2
     C                     Z-ADD*ZERO     WL0149  70
     C                     MOVEL*BLANK    WL0150 30
     C                     MOVEL*BLANK    WL0151 30
     C                     MOVEL*BLANK    WL0152 30
     C                     MOVEL*BLANK    WL0153 30
     C                     MOVEL*BLANK    WL0154 20
     C                     MOVEL*BLANK    WL0155  2
     C                     MOVEL*BLANK    WL0156 11
     C                     MOVEL*BLANK    WL0157 50
     C                     MOVEL*BLANK    WL0158 25
     C                     Z-ADD*ZERO     WL0159  70
     C                     MOVEL*BLANK    WL0160 30
     C                     MOVEL*BLANK    WL0161 30
     C                     MOVEL*BLANK    WL0162 30
     C                     MOVEL*BLANK    WL0163 30
     C                     MOVEL*BLANK    WL0164 20
     C                     MOVEL*BLANK    WL0165  2
     C                     MOVEL*BLANK    WL0166 11
     C                     MOVEL*BLANK    WL0167 15
     C                     Z-ADD*ZERO     WL0168  80
     C                     Z-ADD*ZERO     WL0169  80
     C                     Z-ADD*ZERO     WL0170  80
     C                     Z-ADD*ZERO     WL0171  60
     C                     MOVEL*BLANK    WL0172  1
     C                     MOVEL*BLANK    WL0173  6
     C                     MOVEL*BLANK    WL0174 40
     C                     MOVEL*BLANK    WL0175 40
     C                     Z-ADD*ZERO     WL0176  70
     C                     Z-ADD*ZERO     WL0177  50
     C                     Z-ADD*ZERO     WL0178  52
     C                     MOVEL*BLANK    WL0179  1
     C                     MOVEL*BLANK    WL0180  3
     C                     MOVEL*BLANK    WL0181  3
     C                     Z-ADD*ZERO     WL0182  50
     C                     Z-ADD*ZERO     WL0183  90
     C                     MOVEL*BLANK    WL0184  3
     C                     MOVEL*BLANK    WL0185 30
     C                     MOVEL*BLANK    WL0186 30
     C                     MOVEL*BLANK    WL0187 30
     C                     MOVEL*BLANK    WL0188 20
     C                     MOVEL*BLANK    WL0189  2
     C                     MOVEL*BLANK    WL0190 11
     C                     MOVEL*BLANK    WL0191 30
     C                     MOVEL*BLANK    WL0192 15
     C                     MOVEL*BLANK    WL0193 20
     C                     MOVEL*BLANK    WL0194 15
     C                     MOVEL*BLANK    WL0195 15
     C                     MOVEL*BLANK    WL0196  1
     C                     MOVEL*BLANK    WL0197  1
     C                     MOVEL*BLANK    WL0198  1
     C                     MOVEL*BLANK    WL0199  2
     C                     MOVEL*BLANK    WL0200  2
     C                     MOVEL*BLANK    WL0201 15
     C                     MOVEL*BLANK    WL0202  1
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Stop/Drop Sequence Alpha
     C                     MOVEL*BLANK    YL0002  5
      * Define local work field Stop_Drop
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field Weight 1 USR
     C                     Z-ADD*ZERO     YL0009 112
      * Define local work field IDE Regulation Code ID
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field Item Reference Status
     C                     MOVEL*BLANK    YL0011  1
      * Define null work field CIR Item No
     C                     MOVEL*BLANK    YN0001 10
      * Define null work field CIR Description Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field CIR Description Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field CIR Description Line 3
     C                     MOVEL*BLANK    YN0004 30
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Production Date Prev USR
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0014  8
      * Define local work field Number Cases On A Pallet
     C                     Z-ADD*ZERO     YL0015  50
      * Define local work field Pallet Tare Weight
     C                     Z-ADD*ZERO     YL0016  52
      * Define local work field IDE Regulation Code ID
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field OHE Intended for ExportCC
     C                     MOVEL*BLANK    YL0018  6
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field PFS Sequence Number
     C                     Z-ADD*ZERO     YL0021  30
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0022  6
      * Define local work field PFS Sequence Number
     C                     Z-ADD*ZERO     YL0023  30
      * Define local work field PFS Record Status
     C                     MOVEL*BLANK    YL0024  1
      * Define null work field Regulation Code
     C                     MOVEL*BLANK    YN0005 10
      * Define local work field Regulation ID
     C                     MOVEL*BLANK    YL0025  2
      * Define null work field Regulation Origin
     C                     MOVEL*BLANK    YN0006  3
      * Define null work field Regulation Desc
     C                     MOVEL*BLANK    YN0007 30
      * Define local work field ShipTo Est Stm Stop Tot
     C                     MOVEL*BLANK    YL0026 30
      * Define local work field Ship To Cust Type
     C                     MOVEL*BLANK    YL0027  2
      * Define null work field Default Regulation
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field NonComp Stm1 StopTot
     C                     MOVEL*BLANK    YN0009 75
      * Define null work field NonComp Stm2 StopTot
     C                     MOVEL*BLANK    YN0010 75
      * Define null work field Compliancy Stm1 Item
     C                     MOVEL*BLANK    YN0011 50
      * Define null work field Compliancy Stm2 Item
     C                     MOVEL*BLANK    YN0012 50
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0013  1
      * Define null work field Create Date
     C                     Z-ADD*ZERO     YN0014  70
      * Define null work field Create Time
     C                     Z-ADD*ZERO     YN0015  60
      * Define null work field Create User
     C                     MOVEL*BLANK    YN0016 10
      * Define null work field Create Program
     C                     MOVEL*BLANK    YN0017 10
      * Define null work field Change Date
     C                     Z-ADD*ZERO     YN0018  70
      * Define null work field Change Time
     C                     Z-ADD*ZERO     YN0019  60
      * Define null work field Change User
     C                     MOVEL*BLANK    YN0020 10
      * Define null work field Change Program
     C                     MOVEL*BLANK    YN0021 10
      * Define null work field M3 Supplier ID
     C                     MOVEL*BLANK    YN0022 10
      * Define null work field Dft Mode of Transportaton
     C                     MOVEL*BLANK    YN0023  2
      * Define null work field Buying Group
     C                     MOVEL*BLANK    YN0024 10
      * Define null work field Buying Group Opt In/Out
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field PM Pallet Type
     C                     MOVEL*BLANK    YN0026  2
      * Define null work field Cust Dft Price Type
     C                     MOVEL*BLANK    YN0027  3
      * Define null work field Cust Dft Age Days
     C                     Z-ADD*ZERO     YN0028  50
      * Define null work field Cust Dft Delivery Time
     C                     Z-ADD*ZERO     YN0029  60
      * Define local work field Continue (Yes/No) USR
     C                     MOVEL*BLANK    YL0028  1
      * Define null work field Internet Password
     C                     MOVEL*BLANK    YN0030 10
      * Define null work field Email User ID
     C                     MOVEL*BLANK    YN0031  8
      * Define null work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YN0032  6
      * Define null work field EDI Cust Duns Number
     C                     MOVEL*BLANK    YN0033 20
      * Define null work field EDI Warehouse/Store No.
     C                     MOVEL*BLANK    YN0034 20
      * Define null work field State Tax ID
     C                     MOVEL*BLANK    YN0035 20
      * Define null work field Cust Shipping Temp C/F
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field One Invoice Per PO
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field EDI Advanced Ship Notice
     C                     MOVEL*BLANK    YN0038  1
      * Define local work field Year Code
     C                     Z-ADD*ZERO     YL0029  40
      * Define local work field Month NBR USR
     C                     Z-ADD*ZERO     YL0030  20
      * Define local work field Day of Month USR
     C                     Z-ADD*ZERO     YL0031  20
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0033  60
      * Define local work field OHE Sail_Flight Date
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YL0035  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YL0037  3
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field OHE Container Number
     C                     MOVEL*BLANK    YL0039 12
      * Define local work field OHE Comment 1
     C                     MOVEL*BLANK    YL0040 35
      * Define local work field OHE Comment 2
     C                     MOVEL*BLANK    YL0041 75
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0042 110
      * Define null work field Port Fax Number
     C                     MOVEL*BLANK    YN0039 25
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
