// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDMYXFR
// ?Date: 14.08.2025 Time: 03:32:24
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Crts weight adjustment transaction for when qty goes 0, wgt doesnt
//?change sign on weight
// WRK.Transaction Weight = CON.*ZERO - PAR.Transaction Weight
WRK.Transaction_Weight = *ZERO - PAR.Transaction_Weight;

CASE;

// IF WRK.Transaction Weight EQ WRK.ZERO
IF WRK.Transaction_Weight = WRK.ZERO;

RETURN;

ENDIF;

// PAR.USR Reason Code = CON.*BLANK
PAR.USR_Reason_Code = *BLANK;

// PAR.Extended Amount = PAR.USR Transaction-Unit Cost * PAR.Transaction Weight *Ro
PAR.Extended_Amount = PAR.USR_Transaction_Unit_Cost * PAR.Transaction_Weight 'H';

//?Error if unit cost = 0
CASE;

// IF PAR.USR Transaction-Unit Cost EQ WRK.ZERO
IF PAR.USR_Transaction_Unit_Cost = WRK.ZERO;

// PAR.USR Reason Code = CND.Error
PAR.USR_Reason_Code = 'ERR';

ENDIF;

EXECUTE FUNCTION(Rtv Next Sequence No.  RT) TYPE(RTVOBJ) FILE(CAB7CPP)          AC1304410;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Item_Code);
PARAMETER(PAR.Warehouse_Code);
PARAMETER('A');
PARAMETER('AW');
PARAMETER(PAR.Transaction_Date_Code);
PARAMETER(PAR.ITD_Sequence_Number);
{
 //?USER: Processing if Data record not found

 // PAR.ITD Sequence Number = CON.1
 PAR.ITD_Sequence_Number = 1;

 //?USER: Process Data record

 // PAR.ITD Sequence Number = DB1.ITD Sequence Number + CON.1
 PAR.ITD_Sequence_Number = DB1.ITD_Sequence_Number + 1;

 QUIT;

}


//?C2954 RMC 12/17/13 crt cab7cpp with system date instead of jobdate
EXECUTE FUNCTION(Crt IC Trans. W/SystDt CR) TYPE(CRTOBJ) FILE(CAB7CPP)          AC2080125;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Item_Code);
PARAMETER(PAR.Warehouse_Code);
PARAMETER('A');
PARAMETER('AW');
PARAMETER(PAR.Transaction_Date_Code);
PARAMETER(PAR.ITD_Sequence_Number);
PARAMETER(*ZERO);
PARAMETER(PAR.Production_Date);
PARAMETER(PAR.UOM_Transaction);
PARAMETER('SG');
PARAMETER('Adjustment to Weight');
PARAMETER(*ZERO);
PARAMETER(WRK.Transaction_Weight);
PARAMETER(*ZERO);
PARAMETER(PAR.UOM_Cost);
PARAMETER(PAR.Extended_Amount);
PARAMETER(*BLANK);
PARAMETER(*ZERO);
PARAMETER(*BLANK);
PARAMETER(PAR.USR_Reason_Code);
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(PAR.Item_Structure_Class_Code);
PARAMETER(PAR.Item_Structure_Group_Code);
PARAMETER(PAR.Item_Structure_Type_Code);
PARAMETER(*BLANK);
PARAMETER(*ZERO);
PARAMETER(PAR.Shift_Number);
PARAMETER(PAR.Label_Date);
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER('A');
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?Execute internal function

  // PAR.Job Time = JOB.*Job time
  PAR.Job_Time = JOB.*Job_time;

  // PAR.User Id = JOB.*USER
  PAR.User_Id = JOB.*USER;

  // PAR.Job Name = JOB.*JOB
  PAR.Job_Name = JOB.*JOB;

  // PAR.Job Date = JOB.*Job date
  PAR.Job_Date = JOB.*Job_date;

 }

 // Call program RTV System Date/Time   UP.
 CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
 PARAMETER(DB1.Job_Date);
 PARAMETER(DB1.Job_Time);

 //?USER: Processing after Data update

 // Call program Crt Export Rate Dtl   XF.
 CALL PROGRAM(Crt Export Rate Dtl   XF) ('POO5XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER(DB1.Inventory_Trans_ID);
 PARAMETER(DB1.Inventory_Trans_Type);
 PARAMETER(DB1.Transaction_Date_Code);
 PARAMETER(DB1.Sequence_Number);
 PARAMETER(DB1.Production_Date);
 PARAMETER(DB1.UOM_Transaction);
 PARAMETER(DB1.Item_Transaction_Source);
 PARAMETER(DB1.Description);
 PARAMETER(DB1.Transaction_Quantity);
 PARAMETER(DB1.Transaction_Weight);
 PARAMETER(DB1.USR_Transaction_Unit_Cost);
 PARAMETER(DB1.UOM_Cost);
 PARAMETER(DB1.Extended_Amount);
 PARAMETER(DB1.Ticket_Number);
 PARAMETER(DB1.GL_Document_Number);
 PARAMETER(DB1.GL_Update_Status);
 PARAMETER(DB1.Reason_Code);
 PARAMETER(DB1.Reference_Number_Code);
 PARAMETER(DB1.Lot_ID);
 PARAMETER(DB1.Transfer_Batch_Number);
 PARAMETER(DB1.Transfer_Batch_Sequence);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Item_Structure_Class_Code);
 PARAMETER(DB1.Item_Structure_Group_Code);
 PARAMETER(DB1.Item_Structure_Type_Code);
 PARAMETER(DB1.Employee_Badge_Number);
 PARAMETER(DB1.Production_Time);
 PARAMETER(DB1.Shift_Number);
 PARAMETER(DB1.Label_Date);
 PARAMETER(DB1.Record_Status);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.Job_Date);

}


