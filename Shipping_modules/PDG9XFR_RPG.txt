     H/TITLE CLC Price Item         XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 11/03/16  Time  : 16:59:27
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FPDIMCPW1IF  E           K        DISK
      * RTV : Order Detail Pricing      Rtv Index for Work File
      *
     FPDJKCPW1IF  E           K        DISK
      * RTV : Order Dtl Formula Dtl     Rtv Index for Work File
      *
     FPDIMCPL1IF  E           K        DISK
      * RTV : Order Detail Pricing      Retrieval index
      *
     FPDJKCPL1IF  E           K        DISK
      * RTV : Order Dtl Formula Dtl     Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDIMCPW0UF  E           K        DISK
      * UPD : Order Detail Pricing      Upd Index for Work File
      *
     FPDJKCPW0UF  E           K        DISK
      * UPD : Order Dtl Formula Dtl     Upd Index for Work File
      *
     FPDIMCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Pricing      Update index
      *
     FPDJKCPL0UF  E           K        DISK                      A
      * UPD : Order Dtl Formula Dtl     Update index
      *
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                          WAAIC3
     I              IHQ7CD                          WAQ7CD
     I              IHMLNA                          WAMLNA
     I              IHU0ST                          WAU0ST
     I              IHV8ST                          WAV8ST
     I              IHBYST                          WABYST
     I              IHRMNY                          WARMNY
     I              IHH3ST                          WAH3ST
     I              IHH5ST                          WAH5ST
     I              IHH6ST                          WAH6ST
     I              IHH7ST                          WAH7ST
     I              IHUVST                          WAUVST
     I              IHUWST                          WAUWST
     I              IHUXST                          WAUXST
     I              IHAATM                          WAAATM
     I              IHAYNA                          WAAYNA
     I              IHA0NA                          WAA0NA
     I              IHAXDT                          WAAXDT
      *
     I@IMCPZ5
      * Order Detail Pricing      Rtv Index for Work File
      * Renamed input format fields
     I              IMAIC3                          WBAIC3
     I              IMC4NB                          WBC4NB
     I              IMDPNB                          WBDPNB
     I              IMUENB                          WBUENB
     I              IMQ9CD                          WBQ9CD
     I              IMPDSQ                          WBPDSQ
     I              IMBNPR                          WBBNPR
     I              IMU6ST                          WBU6ST
     I              IMUVST                          WBUVST
     I              IMUWST                          WBUWST
     I              IMUXST                          WBUXST
     I              IMAATM                          WBAATM
     I              IMAYNA                          WBAYNA
     I              IMA0NA                          WBA0NA
     I              IMAXDT                          WBAXDT
      *
     I@IMCPZ4
      * Order Detail Pricing      Upd Index for Work File
      * Renamed input format fields
     I              IMAIC3                          WCAIC3
     I              IMC4NB                          WCC4NB
     I              IMDPNB                          WCDPNB
     I              IMUENB                          WCUENB
     I              IMQ9CD                          WCQ9CD
     I              IMPDSQ                          WCPDSQ
     I              IMBNPR                          WCBNPR
     I              IMU6ST                          WCU6ST
     I              IMUVST                          WCUVST
     I              IMUWST                          WCUWST
     I              IMUXST                          WCUXST
     I              IMAATM                          WCAATM
     I              IMAYNA                          WCAYNA
     I              IMA0NA                          WCA0NA
     I              IMAXDT                          WCAXDT
      *
     I@JKCPZ7
      * Order Dtl Formula Dtl     Rtv Index for Work File
      * Renamed input format fields
     I              JKAIC3                          WDAIC3
     I              JKC4NB                          WDC4NB
     I              JKDPNB                          WDDPNB
     I              JKUENB                          WDUENB
     I              JKQ9CD                          WDQ9CD
     I              JKHGCD                          WDHGCD
     I              JKZXNB                          WDZXNB
     I              JKBOPR                          WDBOPR
     I              JKCDPR                          WDCDPR
     I              JKCEPR                          WDCEPR
     I              JKU6ST                          WDU6ST
     I              JKUVST                          WDUVST
     I              JKUWST                          WDUWST
     I              JKUXST                          WDUXST
     I              JKAATM                          WDAATM
     I              JKAYNA                          WDAYNA
     I              JKA0NA                          WDA0NA
     I              JKAXDT                          WDAXDT
      *
     I@JKCPZ6
      * Order Dtl Formula Dtl     Upd Index for Work File
      * Renamed input format fields
     I              JKAIC3                          WEAIC3
     I              JKC4NB                          WEC4NB
     I              JKDPNB                          WEDPNB
     I              JKUENB                          WEUENB
     I              JKQ9CD                          WEQ9CD
     I              JKHGCD                          WEHGCD
     I              JKZXNB                          WEZXNB
     I              JKBOPR                          WEBOPR
     I              JKCDPR                          WECDPR
     I              JKCEPR                          WECEPR
     I              JKU6ST                          WEU6ST
     I              JKUVST                          WEUVST
     I              JKUWST                          WEUWST
     I              JKUXST                          WEUXST
     I              JKAATM                          WEAATM
     I              JKAYNA                          WEAYNA
     I              JKA0NA                          WEA0NA
     I              JKAXDT                          WEAXDT
      *
     I@IMCPSE
      * Order Detail Pricing      Retrieval index
      * Renamed input format fields
     I              IMAIC3                          WFAIC3
     I              IMC4NB                          WFC4NB
     I              IMDPNB                          WFDPNB
     I              IMUENB                          WFUENB
     I              IMQ9CD                          WFQ9CD
     I              IMPDSQ                          WFPDSQ
     I              IMBNPR                          WFBNPR
     I              IMU6ST                          WFU6ST
     I              IMUVST                          WFUVST
     I              IMUWST                          WFUWST
     I              IMUXST                          WFUXST
     I              IMAATM                          WFAATM
     I              IMAYNA                          WFAYNA
     I              IMA0NA                          WFA0NA
     I              IMAXDT                          WFAXDT
      *
     I@IMCPSD
      * Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WGAIC3
     I              IMC4NB                          WGC4NB
     I              IMDPNB                          WGDPNB
     I              IMUENB                          WGUENB
     I              IMQ9CD                          WGQ9CD
     I              IMPDSQ                          WGPDSQ
     I              IMBNPR                          WGBNPR
     I              IMU6ST                          WGU6ST
     I              IMUVST                          WGUVST
     I              IMUWST                          WGUWST
     I              IMUXST                          WGUXST
     I              IMAATM                          WGAATM
     I              IMAYNA                          WGAYNA
     I              IMA0NA                          WGA0NA
     I              IMAXDT                          WGAXDT
      *
     I@JKCPYF
      * Order Dtl Formula Dtl     Retrieval index
      * Renamed input format fields
     I              JKAIC3                          WHAIC3
     I              JKC4NB                          WHC4NB
     I              JKDPNB                          WHDPNB
     I              JKUENB                          WHUENB
     I              JKQ9CD                          WHQ9CD
     I              JKHGCD                          WHHGCD
     I              JKZXNB                          WHZXNB
     I              JKBOPR                          WHBOPR
     I              JKCDPR                          WHCDPR
     I              JKCEPR                          WHCEPR
     I              JKU6ST                          WHU6ST
     I              JKUVST                          WHUVST
     I              JKUWST                          WHUWST
     I              JKUXST                          WHUXST
     I              JKAATM                          WHAATM
     I              JKAYNA                          WHAYNA
     I              JKA0NA                          WHA0NA
     I              JKAXDT                          WHAXDT
      *
     I@JKCPYE
      * Order Dtl Formula Dtl     Update index
      * Renamed input format fields
     I              JKAIC3                          WIAIC3
     I              JKC4NB                          WIC4NB
     I              JKDPNB                          WIDPNB
     I              JKUENB                          WIUENB
     I              JKQ9CD                          WIQ9CD
     I              JKHGCD                          WIHGCD
     I              JKZXNB                          WIZXNB
     I              JKBOPR                          WIBOPR
     I              JKCDPR                          WICDPR
     I              JKCEPR                          WICEPR
     I              JKU6ST                          WIU6ST
     I              JKUVST                          WIUVST
     I              JKUWST                          WIUWST
     I              JKUXST                          WIUXST
     I              JKAATM                          WIAATM
     I              JKAYNA                          WIAYNA
     I              JKA0NA                          WIA0NA
     I              JKAXDT                          WIAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WJAIC3
     I              BZHGCD                          WJHGCD
     I              BZAVNA                          WJAVNA
     I              BZAWNA                          WJAWNA
     I              BZL7NA                          WJL7NA
     I              BZL8NA                          WJL8NA
     I              BZL6NA                          WJL6NA
     I              BZMFNA                          WJMFNA
     I              BZADCD                          WJADCD
     I              BZAWPC                          WJAWPC
     I              BZLXST                          WJLXST
     I              BZAECD                          WJAECD
     I              BZAXPC                          WJAXPC
     I              BZLYST                          WJLYST
     I              BZAFCD                          WJAFCD
     I              BZAICD                          WJAICD
     I              BZAIWG                          WJAIWG
     I              BZHICD                          WJHICD
     I              BZRBCD                          WJRBCD
     I              BZFZST                          WJFZST
     I              BZAVST                          WJAVST
     I              BZCZWG                          WJCZWG
     I              BZC0WG                          WJC0WG
     I              BZURTN                          WJURTN
     I              BZAJC8                          WJAJC8
     I              BZRINB                          WJRINB
     I              BZRHNB                          WJRHNB
     I              BZRGNB                          WJRGNB
     I              BZLNCD                          WJLNCD
     I              BZTFNB                          WJTFNB
     I              BZN0CD                          WJN0CD
     I              BZX4ST                          WJX4ST
     I              BZTMVA                          WJTMVA
     I              BZTNVA                          WJTNVA
     I              BZBLPR                          WJBLPR
     I              BZBMPR                          WJBMPR
     I              BZLRCD                          WJLRCD
     I              BZU9ST                          WJU9ST
     I              BZCMCO                          WJCMCO
     I              BZQ1CD                          WJQ1CD
     I              BZQ8CD                          WJQ8CD
     I              BZCHTM                          WJCHTM
     I              BZQZCD                          WJQZCD
     I              BZXWST                          WJXWST
     I              BZXXST                          WJXXST
     I              BZVMST                          WJVMST
     I              BZSWGH                          WJSWGH
     I              BZPPHE                          WJPPHE
     I              BZR3CD                          WJR3CD
     I              BZSDCD                          WJSDCD
     I              BZICN1                          WJICN1
     I              BZSVCD                          WJSVCD
     I              BZICN2                          WJICN2
     I              BZSWCD                          WJSWCD
     I              BZV2NB                          WJV2NB
     I              BZSXCD                          WJSXCD
     I              BZITCN                          WJITCN
     I              BZSYCD                          WJSYCD
     I              BZITC5                          WJITC5
     I              BZSZCD                          WJSZCD
     I              BZICN6                          WJICN6
     I              BZS0CD                          WJS0CD
     I              BZICN7                          WJICN7
     I              BZS1CD                          WJS1CD
     I              BZICN8                          WJICN8
     I              BZS2CD                          WJS2CD
     I              BZICN9                          WJICN9
     I              BZS3CD                          WJS3CD
     I              BZICN0                          WJICN0
     I              BZS4CD                          WJS4CD
     I              BZSFNB                          WJSFNB
     I              BZA3WG                          WJA3WG
     I              BZSJNB                          WJSJNB
     I              BZLLCD                          WJLLCD
     I              BZLMCD                          WJLMCD
     I              BZP3ST                          WJP3ST
     I              BZSKNB                          WJSKNB
     I              BZSLNB                          WJSLNB
     I              BZSMNB                          WJSMNB
     I              BZP4ST                          WJP4ST
     I              BZCFNB                          WJCFNB
     I              BZCGNB                          WJCGNB
     I              BZILNB                          WJILNB
     I              BZCHNB                          WJCHNB
     I              BZCINB                          WJCINB
     I              BZCJNB                          WJCJNB
     I              BZCMNB                          WJCMNB
     I              BZCNNB                          WJCNNB
     I              BZCRNB                          WJCRNB
     I              BZCSNB                          WJCSNB
     I              BZCVNB                          WJCVNB
     I              BZCWNB                          WJCWNB
     I              BZCXNB                          WJCXNB
     I              BZCZNB                          WJCZNB
     I              BZC0NB                          WJC0NB
     I              BZN1CD                          WJN1CD
     I              BZB4NB                          WJB4NB
     I              BZB5NB                          WJB5NB
     I              BZX5ST                          WJX5ST
     I              BZX6ST                          WJX6ST
     I              BZX7ST                          WJX7ST
     I              BZPCCT                          WJPCCT
     I              BZBDNB                          WJBDNB
     I              BZBJNB                          WJBJNB
     I              BZSUST                          WJSUST
     I              BZSVST                          WJSVST
     I              BZSYST                          WJSYST
     I              BZSZST                          WJSZST
     I              BZS1ST                          WJS1ST
     I              BZXRCD                          WJXRCD
     I              BZXTCD                          WJXTCD
     I              BZXUCD                          WJXUCD
     I              BZF5WG                          WJF5WG
     I              BZF6WG                          WJF6WG
     I              BZF7WG                          WJF7WG
     I              BZBLNB                          WJBLNB
     I              BZBNNB                          WJBNNB
     I              BZS2ST                          WJS2ST
     I              BZS4ST                          WJS4ST
     I              BZS5ST                          WJS5ST
     I              BZS6ST                          WJS6ST
     I              BZS8ST                          WJS8ST
     I              BZS9ST                          WJS9ST
     I              BZTCST                          WJTCST
     I              BZTDST                          WJTDST
     I              BZUVST                          WJUVST
     I              BZUWST                          WJUWST
     I              BZUXST                          WJUXST
     I              BZVSST                          WJVSST
     I              BZAATM                          WJAATM
     I              BZAYNA                          WJAYNA
     I              BZA0NA                          WJA0NA
     I              BZAXDT                          WJAXDT
      *
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                          WKHGCD
     I              BYAVNA                          WKAVNA
     I              BYAWNA                          WKAWNA
     I              BYL7NA                          WKL7NA
     I              BYL8NA                          WKL8NA
     I              BYL6NA                          WKL6NA
     I              BYMFNA                          WKMFNA
     I              BYHHCD                          WKHHCD
     I              BYAWPC                          WKAWPC
     I              BYLXST                          WKLXST
     I              BYLGCD                          WKLGCD
     I              BYAXPC                          WKAXPC
     I              BYLYST                          WKLYST
     I              BYLHCD                          WKLHCD
     I              BYLICD                          WKLICD
     I              BYAIWG                          WKAIWG
     I              BYHICD                          WKHICD
     I              BYRBCD                          WKRBCD
     I              BYFZST                          WKFZST
     I              BYAVST                          WKAVST
     I              BYCZWG                          WKCZWG
     I              BYC0WG                          WKC0WG
     I              BYURTN                          WKURTN
     I              BYACC8                          WKACC8
     I              BYRINB                          WKRINB
     I              BYRHNB                          WKRHNB
     I              BYRGNB                          WKRGNB
     I              BYLNCD                          WKLNCD
     I              BYTFNB                          WKTFNB
     I              BYN0CD                          WKN0CD
     I              BYX4ST                          WKX4ST
     I              BYCHTM                          WKCHTM
     I              BYQZCD                          WKQZCD
     I              BYXWST                          WKXWST
     I              BYXXST                          WKXXST
     I              BYVMST                          WKVMST
     I              BYSWGH                          WKSWGH
     I              BYPPHE                          WKPPHE
     I              BYLRCD                          WKLRCD
     I              BYSFNB                          WKSFNB
     I              BYA3WG                          WKA3WG
     I              BYSJNB                          WKSJNB
     I              BYLLCD                          WKLLCD
     I              BYLMCD                          WKLMCD
     I              BYP3ST                          WKP3ST
     I              BYSKNB                          WKSKNB
     I              BYSLNB                          WKSLNB
     I              BYSMNB                          WKSMNB
     I              BYP4ST                          WKP4ST
     I              BYCFNB                          WKCFNB
     I              BYCGNB                          WKCGNB
     I              BYILNB                          WKILNB
     I              BYCHNB                          WKCHNB
     I              BYCINB                          WKCINB
     I              BYCJNB                          WKCJNB
     I              BYCMNB                          WKCMNB
     I              BYCNNB                          WKCNNB
     I              BYCRNB                          WKCRNB
     I              BYCSNB                          WKCSNB
     I              BYCVNB                          WKCVNB
     I              BYCWNB                          WKCWNB
     I              BYCXNB                          WKCXNB
     I              BYCZNB                          WKCZNB
     I              BYC0NB                          WKC0NB
     I              BYN1CD                          WKN1CD
     I              BYB4NB                          WKB4NB
     I              BYX5ST                          WKX5ST
     I              BYX6ST                          WKX6ST
     I              BYX7ST                          WKX7ST
     I              BYTMVA                          WKTMVA
     I              BYTNVA                          WKTNVA
     I              BYBLPR                          WKBLPR
     I              BYBMPR                          WKBMPR
     I              BYU9ST                          WKU9ST
     I              BYCMCO                          WKCMCO
     I              BYQ1CD                          WKQ1CD
     I              BYAIC3                          WKAIC3
     I              BYQ8CD                          WKQ8CD
     I              BYR3CD                          WKR3CD
     I              BYSDCD                          WKSDCD
     I              BYICN1                          WKICN1
     I              BYSVCD                          WKSVCD
     I              BYICN2                          WKICN2
     I              BYSWCD                          WKSWCD
     I              BYV2NB                          WKV2NB
     I              BYSXCD                          WKSXCD
     I              BYITCN                          WKITCN
     I              BYSYCD                          WKSYCD
     I              BYITC5                          WKITC5
     I              BYSZCD                          WKSZCD
     I              BYICN6                          WKICN6
     I              BYS0CD                          WKS0CD
     I              BYICN7                          WKICN7
     I              BYS1CD                          WKS1CD
     I              BYICN8                          WKICN8
     I              BYS2CD                          WKS2CD
     I              BYICN9                          WKICN9
     I              BYS3CD                          WKS3CD
     I              BYICN0                          WKICN0
     I              BYS4CD                          WKS4CD
     I              BYB5NB                          WKB5NB
     I              BYXRCD                          WKXRCD
     I              BYPCCT                          WKPCCT
     I              BYBDNB                          WKBDNB
     I              BYBJNB                          WKBJNB
     I              BYSUST                          WKSUST
     I              BYSVST                          WKSVST
     I              BYSYST                          WKSYST
     I              BYSZST                          WKSZST
     I              BYS1ST                          WKS1ST
     I              BYXTCD                          WKXTCD
     I              BYXUCD                          WKXUCD
     I              BYF5WG                          WKF5WG
     I              BYF6WG                          WKF6WG
     I              BYF7WG                          WKF7WG
     I              BYBLNB                          WKBLNB
     I              BYBNNB                          WKBNNB
     I              BYS2ST                          WKS2ST
     I              BYS4ST                          WKS4ST
     I              BYS5ST                          WKS5ST
     I              BYS6ST                          WKS6ST
     I              BYS8ST                          WKS8ST
     I              BYS9ST                          WKS9ST
     I              BYTCST                          WKTCST
     I              BYTDST                          WKTDST
     I              BYUVST                          WKUVST
     I              BYUWST                          WKUWST
     I              BYUXST                          WKUXST
     I              BYVSST                          WKVSST
     I              BYAHTM                          WKAHTM
     I              BYBEVN                          WKBEVN
     I              BYBFVN                          WKBFVN
     I              BYEKDT                          WKEKDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WLAIC3
     I              EOBKC7                          WLBKC7
     I              EOAQCD                          WLAQCD
     I              EOR4CD                          WLR4CD
     I              EOBYNA                          WLBYNA
     I              EOB6NA                          WLB6NA
     I              EOBZNA                          WLBZNA
     I              EOLLST                          WLLLST
     I              EOPPST                          WLPPST
     I              EOR5NB                          WLR5NB
     I              EOR6NB                          WLR6NB
     I              EOQGST                          WLQGST
     I              EOBOCD                          WLBOCD
     I              EOTBNB                          WLTBNB
     I              EOMTCU                          WLMTCU
     I              EOW2NB                          WLW2NB
     I              EORPCD                          WLRPCD
     I              EOAJCD                          WLAJCD
     I              EOX9ST                          WLX9ST
     I              EOT9CD                          WLT9CD
     I              EOUBCD                          WLUBCD
     I              EOISTX                          WLISTX
     I              EOLQCD                          WLLQCD
     I              EONJNA                          WLNJNA
     I              EOI0TX                          WLI0TX
     I              EONKNA                          WLNKNA
     I              EOI1TX                          WLI1TX
     I              EOVLST                          WLVLST
     I              EORLST                          WLRLST
     I              EOMMTX                          WLMMTX
     I              EOOHNA                          WLOHNA
     I              EOQ6ST                          WLQ6ST
     I              EOQ8ST                          WLQ8ST
     I              EORBST                          WLRBST
     I              EOREST                          WLREST
     I              EOUVST                          WLUVST
     I              EOUWST                          WLUWST
     I              EOUXST                          WLUXST
     I              EOVSST                          WLVSST
     I              EOAATM                          WLAATM
     I              EOAYNA                          WLAYNA
     I              EOA0NA                          WLA0NA
     I              EOAXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDIM1    E DSPDIMCPW0
      * UPD : Order Detail Pricing      Upd Index for Work File
      * Renamed input format fields
     I              IMAIC3                          WCAIC3
     I              IMC4NB                          WCC4NB
     I              IMDPNB                          WCDPNB
     I              IMUENB                          WCUENB
     I              IMQ9CD                          WCQ9CD
     I              IMPDSQ                          WCPDSQ
     I              IMBNPR                          WCBNPR
     I              IMU6ST                          WCU6ST
     I              IMUVST                          WCUVST
     I              IMUWST                          WCUWST
     I              IMUXST                          WCUXST
     I              IMAATM                          WCAATM
     I              IMAYNA                          WCAYNA
     I              IMA0NA                          WCA0NA
     I              IMAXDT                          WCAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDJK1    E DSPDJKCPW0
      * UPD : Order Dtl Formula Dtl     Upd Index for Work File
      * Renamed input format fields
     I              JKAIC3                          WEAIC3
     I              JKC4NB                          WEC4NB
     I              JKDPNB                          WEDPNB
     I              JKUENB                          WEUENB
     I              JKQ9CD                          WEQ9CD
     I              JKHGCD                          WEHGCD
     I              JKZXNB                          WEZXNB
     I              JKBOPR                          WEBOPR
     I              JKCDPR                          WECDPR
     I              JKCEPR                          WECEPR
     I              JKU6ST                          WEU6ST
     I              JKUVST                          WEUVST
     I              JKUWST                          WEUWST
     I              JKUXST                          WEUXST
     I              JKAATM                          WEAATM
     I              JKAYNA                          WEAYNA
     I              JKA0NA                          WEA0NA
     I              JKAXDT                          WEAXDT
      *
     IQPDIM2    E DSPDIMCPL0
      * UPD : Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WGAIC3
     I              IMC4NB                          WGC4NB
     I              IMDPNB                          WGDPNB
     I              IMUENB                          WGUENB
     I              IMQ9CD                          WGQ9CD
     I              IMPDSQ                          WGPDSQ
     I              IMBNPR                          WGBNPR
     I              IMU6ST                          WGU6ST
     I              IMUVST                          WGUVST
     I              IMUWST                          WGUWST
     I              IMUXST                          WGUXST
     I              IMAATM                          WGAATM
     I              IMAYNA                          WGAYNA
     I              IMA0NA                          WGA0NA
     I              IMAXDT                          WGAXDT
      *
     IQPDJK2    E DSPDJKCPL0
      * UPD : Order Dtl Formula Dtl     Update index
      * Renamed input format fields
     I              JKAIC3                          WIAIC3
     I              JKC4NB                          WIC4NB
     I              JKDPNB                          WIDPNB
     I              JKUENB                          WIUENB
     I              JKQ9CD                          WIQ9CD
     I              JKHGCD                          WIHGCD
     I              JKZXNB                          WIZXNB
     I              JKBOPR                          WIBOPR
     I              JKCDPR                          WICDPR
     I              JKCEPR                          WICEPR
     I              JKU6ST                          WIU6ST
     I              JKUVST                          WIUVST
     I              JKUWST                          WIUWST
     I              JKUXST                          WIUXST
     I              JKAATM                          WIAATM
     I              JKAYNA                          WIAYNA
     I              JKA0NA                          WIA0NA
     I              JKAXDT                          WIAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Price Method Type
     I                                        1   1 P1V8ST
      * N :  Decimal Places Rounded
     I                                    P   2   30P1RMNY
      * N :  PMH Price Type
     I                                        4   4 P1H3ST
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * I :  Price Method Code
     I                                        7   9 P1Q7CD
      * I :  Ship To Customer
     I                                    P  10  130P1BKC7
      * I :  Actual Shipped Date
     I                                    P  14  170P1GNDT
      * I :  U/M - Ordered
     I                                       18  19 P1AGCD
      * I :  Quantity Ordered
     I                                    P  20  252P1AVQT
      * I :  Requested Ship Date
     I                                    P  26  290P1A5DT
      * B :  Unit Price
     I                                    P  30  354P1AKPR
      * B :  Unit Price Ordered U/M
     I                                    P  36  414P1AUPR
      * I :  Item Code
     I                                    P  42  450P1HGCD
      * I :  Date of Orig. Entry Det.
     I                                    P  46  490P1D3DT
      * I :  Commodity Market Code
     I                                       50  52 P1LQCD
      * I :  Market Pricing Date
     I                                    P  53  560P1EXDT
      * B :  Price Status
     I                                       57  57 P1U1ST
      * I :  Date Method Code
     I                                       58  60 P1RDCD
      * I :  Price Overage Override
     I                                    P  61  664P1BZPR
      * B :  Pricing Date Used
     I                                    P  67  700P1GIDT
      * N :  Pricing Retrieved Amount
     I                                    P  71  764P1TPVA
      * I :  Event Called From
     I                                       77  78 P1SJCD
      * I :  OD Ceiling Price
     I                                    P  79  844P1DWPR
      * I :  OD Market Begin Date
     I                                    P  85  880P1TKDT
      * I :  OD Market Ending Date
     I                                    P  89  920P1TLDT
     IP2PARM      DS
      * FLD: STR Quantity/Price Convrt
      * N :  Price based on U/M1 S
     I                                    P   1   64P2APPR
      * N :  Price based on U/M2 S
     I                                    P   7  124P2AQPR
      * N :  Price based on U/M3 S
     I                                    P  13  184P2ARPR
     IP3PARM      DS
      * N :  Date Used for Calculation
     I                                    P   1   40P3GTDT
     IP4PARM      DS
      * FLD: Company Customer Item
      * N :  Market Overage
     I                                    P   1   64P4BLPR
      * N :  Formula Differential
     I                                    P   7  124P4BXPR
      * N :  Formula Processing Fee
     I                                    P  13  184P4BYPR
     IP5PARM      DS
      * FLD: Company Customer
      * N :  Co/Cust Overage Rate CWT
     I                                    P   1   62P5W2NB
     IP6PARM      DS
      * FLD: Order Detail
      * I :  Order Number
     I                                    P   1   40P6C4NB
      * I :  Requested Delivery Date
     I                                    P   5   80P6EIDT
      * I :  Order Sequence Number
     I                                    P   9  100P6DPNB
      * I :  Order Secondary Line Seq
     I                                    P  11  120P6UENB
     IP7PARM      DS
      * FLD: Company Item
      * N :  U/M - Primary
     I                                        1   2 P7ADCD
      * N :  U/M - Second
     I                                        3   4 P7AECD
      * N :  U/M - Third
     I                                        5   6 P7AFCD
      * N :  U/M - Pricing
     I                                        7   8 P7AICD
     IP8PARM      DS
      * B :  Error Return
     I                                        1   5 P8WZST
     IP9PARM      DS
      * I :  Price Type Status
     I                                        1   1 P9Y0ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1Q7CD    PARM           WP0002  3        Price Method Co
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P1GNDT    PARM           WP0004  70       Actual Shipped
     C           P1AGCD    PARM           WP0005  2        U/M - Ordered
     C           P1AVQT    PARM           WP0006 112       Quantity Ordere
     C           P1A5DT    PARM           WP0007  70       Requested Ship
     C           P1AKPR    PARM P1AKPR    WP0008 114       Unit Price
     C           P1AUPR    PARM P1AUPR    WP0009 114       Unit Price Orde
     C           P1HGCD    PARM           WP0010  70       Item Code
     C           P1D3DT    PARM           WP0011  70       Date of Orig. E
     C           P1LQCD    PARM           WP0012  3        Commodity Marke
     C           P1EXDT    PARM           WP0013  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WP0014  1        Price Status
     C           P1RDCD    PARM           WP0015  3        Date Method Cod
     C           P1BZPR    PARM           WP0016 114       Price Overage O
     C           P1GIDT    PARM P1GIDT    WP0017  70       Pricing Date Us
     C           P1SJCD    PARM           WP0018  2        Event Called Fr
     C           P1DWPR    PARM           WP0019 114       OD Ceiling Pric
     C           P1TKDT    PARM           WP0020  70       OD Market Begin
     C           P1TLDT    PARM           WP0021  70       OD Market Endin
     C           P6C4NB    PARM           WP0022  70       Order Number
     C           P6EIDT    PARM           WP0023  70       Requested Deliv
     C           P6DPNB    PARM           WP0024  30       Order Sequence
     C           P6UENB    PARM           WP0025  30       Order Secondary
     C           P8WZST    PARM P8WZST    WP0026  5        Error Return
     C           P9Y0ST    PARM           WP0027  1        Price Type Stat
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CLC Price Item         XF
      * RMC 11/3/16 IF HPB and Str Type=800 then allow price =.00
      * RTV Meth Type/Audit    RT - Price Method Header  * 
     C                     EXSR SARVGN
      * If Event is Pre update Invoicing then use Invoice qtemp files
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * Build files in Library: Qtemp
      * UPD Pricing Files Inv  UP - /UT User Programs  * 
     C                     CALL 'PDPRINCL'             90  UPD Pricing Fil
     C           WUECST    PARM *BLANK    WQ0001  1        Error Status
     C                     PARM P1SJCD    WQ0002  2        Event Called Fr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRINCL'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * DEL Shp Dtl Price Wrk  RT - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP6C4NB    WL0002           Order Number
     C                     Z-ADDP6DPNB    WL0003           Order Sequence
     C                     Z-ADDP6UENB    WL0004           Order Secondary
     C                     EXSR SBRVGN
      * DEL Ship Formula Work  RT - Order Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     Z-ADDP6C4NB    WL0006           Order Number
     C                     Z-ADDP6DPNB    WL0007           Order Sequence
     C                     Z-ADDP6UENB    WL0008           Order Secondary
     C                     EXSR SDRVGN
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    P8WZST           Error Return
     C                     MOVEL'FPE'     P8WZST           Error Return
     C                     GOTO AAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Delete Rcds from Ord Dtl & Ship Pricing File for this line only
      * CASE: PAR.Event Called From is Not Price Only
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * Delete Order Line Price for Work File for Invoice
      * CASE: PAR.Event Called From is Pre-Update Invoice
     C           P1SJCD    IFEQ '**'                       *IF
      * DEL Shp Dtl Price Wrk  RT - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP6C4NB    WL0002           Order Number
     C                     Z-ADDP6DPNB    WL0003           Order Sequence
     C                     Z-ADDP6UENB    WL0004           Order Secondary
     C                     EXSR SBRVGN
      * DEL Ship Formula Work  RT - Order Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     Z-ADDP6C4NB    WL0006           Order Number
     C                     Z-ADDP6DPNB    WL0007           Order Sequence
     C                     Z-ADDP6UENB    WL0008           Order Secondary
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Delete Order Line Pricing for AutoCalc Order Entry
      * CASE: PAR.Event Called From is AutoCalc O/E
     C           P1SJCD    IFEQ 'AO'                       *IF
      * DEL Ship Detail Pricng RT - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP6C4NB    WL0010           Order Number
     C                     Z-ADDP6DPNB    WL0011           Order Sequence
     C                     Z-ADDP6UENB    WL0012           Order Secondary
     C                     EXSR SFRVGN
      * DEL Ship Dtl Formula   RT - Order Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0013           Company Number
     C                     Z-ADDP6C4NB    WL0014           Order Number
     C                     Z-ADDP6DPNB    WL0015           Order Sequence
     C                     Z-ADDP6UENB    WL0016           Order Secondary
     C                     EXSR SHRVGN
     C                     END                             *FI
      * Delete Order Line Pricing for AutoCalc Invoice
      * CASE: PAR.Event Called From is AutoCalc Inv
     C           P1SJCD    IFEQ 'AI'                       *IF
      * DEL Ship Detail Pricng RT - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP6C4NB    WL0010           Order Number
     C                     Z-ADDP6DPNB    WL0011           Order Sequence
     C                     Z-ADDP6UENB    WL0012           Order Secondary
     C                     EXSR SFRVGN
      * DEL Ship Dtl Formula   RT - Order Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0013           Company Number
     C                     Z-ADDP6C4NB    WL0014           Order Number
     C                     Z-ADDP6DPNB    WL0015           Order Sequence
     C                     Z-ADDP6UENB    WL0016           Order Secondary
     C                     EXSR SHRVGN
     C                     END                             *FI
      * Copy Order Line Pricing for Regular file Inv
      * CASE: PAR.Event Called From is Invoice Update
     C           P1SJCD    IFEQ '02'                       *IF
      * DEL Ship Detail Pricng RT - Order Detail Pricing  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP6C4NB    WL0010           Order Number
     C                     Z-ADDP6DPNB    WL0011           Order Sequence
     C                     Z-ADDP6UENB    WL0012           Order Secondary
     C                     EXSR SFRVGN
      * DEL Ship Dtl Formula   RT - Order Dtl Formula Dtl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0013           Company Number
     C                     Z-ADDP6C4NB    WL0014           Order Number
     C                     Z-ADDP6DPNB    WL0015           Order Sequence
     C                     Z-ADDP6UENB    WL0016           Order Secondary
     C                     EXSR SHRVGN
      * CPY Ship Prc f/Qtmp    RT - Order Detail Pricing  * 
     C                     EXSR SJRVGN
      * CPY Shp Dtl Form f/QtmpRT - Order Dtl Formula Dtl  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
     C                     END                             *FI
      * Exit Bypass pricing if Entry Code is 01 or 02 (Update), OR Proces
      * CASE: PAR.Event Called From is Invoice Update
     C           P1SJCD    IFEQ '02'                       *IF
      * ***** Price has already been performed in this case, records
      * ***** were copied from Qtemp.
     C                     MOVEL*BLANK    P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Process pricing per PD Price Method Detail
      * CLC Read/Proc. Detail  XF - Price Method Detail  * 
     C                     CALL 'PDPBXFR'              90  CLC Read/Proc.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1V8ST    WQ0003  1        Price Method Ty
     C                     PARM P1RMNY    WQ0004  20       Decimal Places
     C                     PARM P1H3ST    WQ0005  1        PMH Price Type
     C                     PARM P1AIC3    WQ0006  30       Company Number
     C                     PARM P1Q7CD    WQ0007  3        Price Method Co
     C                     PARM P1BKC7    WQ0008  70       Ship To Custome
     C                     PARM P1GNDT    WQ0009  70       Actual Shipped
     C                     PARM P6EIDT    WQ0010  70       Requested Deliv
     C                     PARM P1AGCD    WQ0011  2        U/M - Ordered
     C                     PARM P1AVQT    WQ0012 112       Quantity Ordere
     C                     PARM P1A5DT    WQ0013  70       Requested Ship
     C           P1AKPR    PARM P1AKPR    WQ0014 114       Unit Price
     C                     PARM P1HGCD    WQ0015  70       Item Code
     C                     PARM P1D3DT    WQ0016  70       Date of Orig. E
     C                     PARM P1LQCD    WQ0017  3        Commodity Marke
     C                     PARM P1EXDT    WQ0018  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WQ0019  1        Price Status
     C                     PARM P1RDCD    WQ0020  3        Date Method Cod
     C           P1GIDT    PARM P1GIDT    WQ0021  70       Pricing Date Us
     C           P1TPVA    PARM P1TPVA    WQ0022 114       Pricing Retriev
     C                     PARM P1SJCD    WQ0023  2        Event Called Fr
     C                     PARM P1DWPR    WQ0024 114       OD Ceiling Pric
     C                     PARM P1TKDT    WQ0025  70       OD Market Begin
     C                     PARM P1TLDT    WQ0026  70       OD Market Endin
     C           P8WZST    PARM P8WZST    WQ0027  5        Error Return
     C                     PARM P6C4NB    WQ0028  70       Order Number
     C                     PARM P6DPNB    WQ0029  30       Order Sequence
     C                     PARM P6UENB    WQ0030  30       Order Secondary
     C                     PARM P1BZPR    WQ0031 114       Price Overage O
     C           P7ADCD    PARM P7ADCD    WQ0032  2        U/M - Primary
     C           P7AECD    PARM P7AECD    WQ0033  2        U/M - Second
     C           P7AFCD    PARM P7AFCD    WQ0034  2        U/M - Third
     C           P7AICD    PARM P7AICD    WQ0035  2        U/M - Pricing
     C           P2APPR    PARM P2APPR    WQ0036 114       Price based on
     C           P2AQPR    PARM P2AQPR    WQ0037 114       Price based on
     C           P2ARPR    PARM P2ARPR    WQ0038 114       Price based on
     C                     PARM P9Y0ST    WQ0039  1        Price Type Stat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Extended Method=for Price, use Pricing U/M & Load Unit Price
      * CASE: PAR.Price Method Type is Extended Pricing
     C           P1V8ST    IFEQ 'X'                        *IF
      * If U/M Priced = Primary then execute
      * CASE: PAR.U/M - Pricing EQ PAR.U/M - Primary
     C           P7AICD    IFEQ P7ADCD                     *IF
     C                     Z-ADDP2APPR    P1AKPR           Unit Price
     C                     END                             *FI
      * If U/M Priced = Secondary then execute
      * CASE: PAR.U/M - Pricing EQ PAR.U/M - Second
     C           P7AICD    IFEQ P7AECD                     *IF
     C                     Z-ADDP2AQPR    P1AKPR           Unit Price
     C                     END                             *FI
      * If U/M Priced = Third then execute
      * CASE: PAR.U/M - Pricing EQ PAR.U/M - Third
     C           P7AICD    IFEQ P7AFCD                     *IF
     C                     Z-ADDP2ARPR    P1AKPR           Unit Price
     C                     END                             *FI
     C                     END                             *FI
      * Made the checking an OR condition so the price will not get
      * overridden if the second UM or the third UM is also the same
      * as the Primary UM.  -Purva 10/13/98
      * PAR.Unit Price Ordered U/M  -Purva 10/13/98
      * CASE: PAR.U/M - Ordered EQ PAR.U/M - Primary
     C           P1AGCD    IFEQ P7ADCD                     *IF
     C                     Z-ADDP2APPR    P1AUPR           Unit Price Orde
     C                     ELSE
      * CASE: PAR.U/M - Ordered EQ PAR.U/M - Second
     C           P1AGCD    IFEQ P7AECD                     *IF
     C                     Z-ADDP2AQPR    P1AUPR           Unit Price Orde
     C                     ELSE
      * CASE: PAR.U/M - Ordered EQ PAR.U/M - Third
     C           P1AGCD    IFEQ P7AFCD                     *IF
     C                     Z-ADDP2ARPR    P1AUPR           Unit Price Orde
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If Priced, check for 0 Price, if yes then Item setup Error
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Status is Priced
      *   |- c2    : PAR.Unit Price Ordered U/M is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1U1ST    IFEQ 'P'                        *IF
     C           P1AUPR    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Manual Price      RT - Company Item  * 
     C                     EXSR SNRVGN
      * RTV Item Str Type     RT - Item Default  * 
     C                     EXSR SORVGN
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0040  30       Company Number
     C                     PARM *BLANK    WQ0041  1        Plant Company S
     C           YL0003    PARM *BLANK    WQ0042  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Type Code          RT - Company Customer  * 
     C                     EXSR SPRVGN
      * Sample or Cut Loss Product Code   OR HPB OUT OF SPEC
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Organization is Daily's
      *   |- c2    : LCL.Type Code is Is Promotional/Samples
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'D'                        *IF
     C           YL0004    IFEQ 'PS'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Company Organization is High Plains Biodiesel
      *   |- c2    : LCL.Item Structure Type Code is Out of Spec   (HPB)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'H'                        *IF
     C           YL0002    IFEQ 800                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: LCL.Primal Group Code is NE Samples or Cut Loss
     C           YL0001    IFNE 'UNID'                     *IF
     C                     MOVEL'U'       P1U1ST           Price Status
     C                     MOVEL'ITERR'   P8WZST           Error Return
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Meth Type/Audit    RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     MOVELP1Q7CD    WAQ7CD           Price Method Co
      * Establish starting position
     C           KRSSA     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUU0ST           Price Audit
     C                     MOVEL*BLANK    P1V8ST           Price Method Ty
     C                     Z-ADD*ZERO     P1RMNY           Decimal Places
     C                     MOVEL*BLANK    P1H3ST           PMH Price Type
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAU0ST    WUU0ST           Price Audit
     C                     MOVELWAV8ST    P1V8ST           Price Method Ty
     C                     Z-ADDWARMNY    P1RMNY           Decimal Places
     C                     MOVELWAH3ST    P1H3ST           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * DEL Shp Dtl Price Wrk  RT - Order Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
     C           *LIKE     DEFN WBDPNB    WQSB03           Order Sequence
     C           *LIKE     DEFN WBUENB    WQSB04           Order Secondary
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
     C                     KFLD           WQSB03           Order Sequence
     C                     KFLD           WQSB04           Order Secondary
      * Setup key
     C                     Z-ADDWL0001    WQSB01           Company Number
     C                     Z-ADDWL0002    WQSB02           Order Number
     C                     Z-ADDWL0003    WQSB03           Order Sequence
     C                     Z-ADDWL0004    WQSB04           Order Secondary
      * Establish starting position
     C           KRSSB     SETLL@IMCPZ5                    *
     C           KRSSB     READE@IMCPZ5                  90*
      * Data record not found
     C   90                MOVEL'USR1675' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ship Dtl Price Wrk DL - Order Detail Pricing  * 
     C                     EXSR SCDLRC
     C           KRSSB     READE@IMCPZ5                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * DLT Ship Dtl Price Wrk DL - Order Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @IMCPZ4
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
     C                     Z-ADDWBDPNB    WCDPNB           Order Sequence
     C                     Z-ADDWBUENB    WCUENB           Order Secondary
     C                     MOVELWBQ9CD    WCQ9CD           Price Method Co
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C                     KFLD           WCQ9CD           Price Method Co
     C           KLDLSC    CHAIN@IMCPZ4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIMCPW0'MDACP
     C                     MOVEL'@IMCPZ4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@IMCPZ4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * DEL Ship Formula Work  RT - Order Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSD02           Order Number
     C           *LIKE     DEFN WDDPNB    WQSD03           Order Sequence
     C           *LIKE     DEFN WDUENB    WQSD04           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Order Sequence
     C                     KFLD           WQSD04           Order Secondary
      * Setup key
     C                     Z-ADDWL0005    WQSD01           Company Number
     C                     Z-ADDWL0006    WQSD02           Order Number
     C                     Z-ADDWL0007    WQSD03           Order Sequence
     C                     Z-ADDWL0008    WQSD04           Order Secondary
      * Establish starting position
     C           KRSSD     SETLL@JKCPZ7                    *
     C           KRSSD     READE@JKCPZ7                  90*
      * Data record not found
     C   90                MOVEL'USR1870' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ship Dtl Form Work DL - Order Dtl Formula Dtl  * 
     C                     EXSR SEDLRC
     C           KRSSD     READE@JKCPZ7                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * DLT Ship Dtl Form Work DL - Order Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JKCPZ6
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDC4NB    WEC4NB           Order Number
     C                     Z-ADDWDDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWDUENB    WEUENB           Order Secondary
     C                     MOVELWDQ9CD    WEQ9CD           Price Method Co
     C                     Z-ADDWDHGCD    WEHGCD           Item Code
     C                     Z-ADDWDZXNB    WEZXNB           Pricing Sequenc
      *
     C           KLDLSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEQ9CD           Price Method Co
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEZXNB           Pricing Sequenc
     C           KLDLSE    CHAIN@JKCPZ6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJKCPW0'MDACP
     C                     MOVEL'@JKCPZ6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JKCPZ6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * DEL Ship Detail Pricng RT - Order Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSF02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSF03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSF04           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WQSF03           Order Sequence
     C                     KFLD           WQSF04           Order Secondary
      * Setup key
     C                     Z-ADDWL0009    WQSF01           Company Number
     C                     Z-ADDWL0010    WQSF02           Order Number
     C                     Z-ADDWL0011    WQSF03           Order Sequence
     C                     Z-ADDWL0012    WQSF04           Order Secondary
      * Establish starting position
     C           KRSSF     SETLL@IMCPSE                    *
     C           KRSSF     READE@IMCPSE                  90*
      * Data record not found
     C   90                MOVEL'USR1675' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Ship Detail Pricng DL - PD Ship Detail Pricing  * 
     C                     EXSR SGDLRC
     C           KRSSF     READE@IMCPSE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * DEL Ship Detail Pricng DL - PD Ship Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @IMCPSD
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
     C                     MOVELWFQ9CD    WGQ9CD           Price Method Co
      *
     C           KLDLSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGQ9CD           Price Method Co
     C           KLDLSG    CHAIN@IMCPSD              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIMCPL0'MDACP
     C                     MOVEL'@IMCPSD' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@IMCPSD                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * DEL Ship Dtl Formula   RT - Order Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSH02           Order Number
     C           *LIKE     DEFN WHDPNB    WQSH03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQSH04           Order Secondary
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WQSH03           Order Sequence
     C                     KFLD           WQSH04           Order Secondary
      * Setup key
     C                     Z-ADDWL0013    WQSH01           Company Number
     C                     Z-ADDWL0014    WQSH02           Order Number
     C                     Z-ADDWL0015    WQSH03           Order Sequence
     C                     Z-ADDWL0016    WQSH04           Order Secondary
      * Establish starting position
     C           KRSSH     SETLL@JKCPYF                    *
     C           KRSSH     READE@JKCPYF                  90*
      * Data record not found
     C   90                MOVEL'USR1870' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Ship Dtl Formula   DL - PD Ship Dtl Formula Dtl  * 
     C                     EXSR SIDLRC
     C           KRSSH     READE@JKCPYF                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * DEL Ship Dtl Formula   DL - PD Ship Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JKCPYE
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
     C                     Z-ADDWHDPNB    WIDPNB           Order Sequence
     C                     Z-ADDWHUENB    WIUENB           Order Secondary
     C                     MOVELWHQ9CD    WIQ9CD           Price Method Co
     C                     Z-ADDWHHGCD    WIHGCD           Item Code
     C                     Z-ADDWHZXNB    WIZXNB           Pricing Sequenc
      *
     C           KLDLSI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIQ9CD           Price Method Co
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIZXNB           Pricing Sequenc
     C           KLDLSI    CHAIN@JKCPYE              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJKCPL0'MDACP
     C                     MOVEL'@JKCPYE' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JKCPYE                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * CPY Ship Prc f/Qtmp    RT - Order Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSJ02           Order Number
     C           *LIKE     DEFN WBDPNB    WQSJ03           Order Sequence
     C           *LIKE     DEFN WBUENB    WQSJ04           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WQSJ03           Order Sequence
     C                     KFLD           WQSJ04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSJ01           Company Number
     C                     Z-ADDP6C4NB    WQSJ02           Order Number
     C                     Z-ADDP6DPNB    WQSJ03           Order Sequence
     C                     Z-ADDP6UENB    WQSJ04           Order Secondary
      * Establish starting position
     C           KRSSJ     SETLL@IMCPZ5                    *
     C           KRSSJ     READE@IMCPZ5                  90*
      * Data record not found
     C   90                MOVEL'USR1675' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Ship Price Detail  CR - PD Ship Detail Pricing  * 
     C                     EXSR SKCRRC
     C           KRSSJ     READE@IMCPZ5                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT Ship Price Detail  CR - PD Ship Detail Pricing  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @IMCPSD
     C                     Z-ADDWBAIC3    WGAIC3           Company Number
     C                     Z-ADDWBC4NB    WGC4NB           Order Number
     C                     Z-ADDWBDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWBUENB    WGUENB           Order Secondary
     C                     MOVELWBQ9CD    WGQ9CD           Price Method Co
     C                     Z-ADDWBPDSQ    WGPDSQ           Price Detail Se
     C                     Z-ADDWBBNPR    WGBNPR           Componant Price
     C                     MOVELWBU6ST    WGU6ST           PD Status
     C                     MOVELWBUVST    WGUVST           EDI Status 1
     C                     MOVELWBUWST    WGUWST           EDI Status 2
     C                     MOVELWBUXST    WGUXST           EDI Status 3
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGQ9CD           Price Method Co
      * Check for duplicate primary key
     C           KLCRSK    SETLL@IMCPSD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1676' W0RTN   7
      * Send message 'Order Detail Pricing   EX'
     C                     MOVEL'USR1676' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@IMCPSD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * CPY Shp Dtl Form f/QtmpRT - Order Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSL02           Order Number
     C           *LIKE     DEFN WDDPNB    WQSL03           Order Sequence
     C           *LIKE     DEFN WDUENB    WQSL04           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WQSL03           Order Sequence
     C                     KFLD           WQSL04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSL01           Company Number
     C                     Z-ADDP6C4NB    WQSL02           Order Number
     C                     Z-ADDP6DPNB    WQSL03           Order Sequence
     C                     Z-ADDP6UENB    WQSL04           Order Secondary
      * Establish starting position
     C           KRSSL     SETLL@JKCPZ7                    *
     C           KRSSL     READE@JKCPZ7                  90*
      * Data record not found
     C   90                MOVEL'USR1870' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Ship Dtl Formula   CR - Order Dtl Formula Dtl  * 
     C                     EXSR SMCRRC
     C           KRSSL     READE@JKCPZ7                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * CRT Ship Dtl Formula   CR - Order Dtl Formula Dtl  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  60       Job Time
     C                     MOVEL*BLANK    WN0006 10        User Id
     C                     MOVEL*BLANK    WN0007 10        Job Name
     C                     Z-ADD*ZERO     WN0008  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JKCPYE
     C                     Z-ADDWDAIC3    WIAIC3           Company Number
     C                     Z-ADDWDC4NB    WIC4NB           Order Number
     C                     Z-ADDWDDPNB    WIDPNB           Order Sequence
     C                     Z-ADDWDUENB    WIUENB           Order Secondary
     C                     MOVELWDQ9CD    WIQ9CD           Price Method Co
     C                     Z-ADDWDHGCD    WIHGCD           Item Code
     C                     Z-ADDWDZXNB    WIZXNB           Pricing Sequenc
     C                     Z-ADDWDBOPR    WIBOPR           Sales Yield
     C                     Z-ADDWDCDPR    WICDPR           Market Value
     C                     Z-ADDWDCEPR    WICEPR           Credit Value
     C                     MOVELWDU6ST    WIU6ST           PD Status
     C                     MOVELWDUVST    WIUVST           EDI Status 1
     C                     MOVELWDUWST    WIUWST           EDI Status 2
     C                     MOVELWDUXST    WIUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRSM    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIQ9CD           Price Method Co
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIZXNB           Pricing Sequenc
      * Check for duplicate primary key
     C           KLCRSM    SETLL@JKCPYE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1871' W0RTN   7
      * Send message 'Order Dtl Formula Dtl  EX'
     C                     MOVEL'USR1871' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@JKCPYE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Val Manual Price      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WJAIC3           Company Number
     C                     Z-ADDP1HGCD    WJHGCD           Item Code
      * Establish starting position
     C           KRSSN     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Primal Group Co
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJXRCD    YL0001           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Item Str Type     RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WKHGCD           Item Code
      * Setup key
     C                     Z-ADDP1HGCD    WKHGCD           Item Code
      * Establish starting position
     C           KRSSO     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Item Structure
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKRGNB    YL0002           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Type Code          RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1AIC3    WLAIC3           Company Number
     C                     Z-ADDP1BKC7    WLBKC7           Ship To Custome
      * Establish starting position
     C           KRSSP     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Type Code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLBOCD    YL0004           Type Code
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1V8ST           Price Method Ty
     C                     Z-ADD*ZERO     P1RMNY           Decimal Places
     C                     MOVEL*BLANK    P1H3ST           PMH Price Type
     C                     Z-ADD*ZERO     P1TPVA           Pricing Retriev
     C                     Z-ADD*ZERO     P2APPR           Price based on
     C                     Z-ADD*ZERO     P2AQPR           Price based on
     C                     Z-ADD*ZERO     P2ARPR           Price based on
     C                     Z-ADD*ZERO     P3GTDT           Date Used for C
     C                     Z-ADD*ZERO     P4BLPR           Market Overage
     C                     Z-ADD*ZERO     P4BXPR           Formula Differe
     C                     Z-ADD*ZERO     P4BYPR           Formula Process
     C                     Z-ADD*ZERO     P5W2NB           Co/Cust Overage
     C                     MOVEL*BLANK    P7ADCD           U/M - Primary
     C                     MOVEL*BLANK    P7AECD           U/M - Second
     C                     MOVEL*BLANK    P7AFCD           U/M - Third
     C                     MOVEL*BLANK    P7AICD           U/M - Pricing
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Price Audit
     C                     MOVEL*BLANK    WUU0ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WARMNY           Decimal Places
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBPDSQ           Price Detail Se
     C                     Z-ADD*ZERO     WBBNPR           Componant Price
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDZXNB           Pricing Sequenc
     C                     Z-ADD*ZERO     WDBOPR           Sales Yield
     C                     Z-ADD*ZERO     WDCDPR           Market Value
     C                     Z-ADD*ZERO     WDCEPR           Credit Value
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Clear all neither parameters
      * CRT Ship Price Detail  CR - PD Ship Detail Pricing  * 
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Clear all neither parameters
      * CRT Ship Dtl Formula   CR - Order Dtl Formula Dtl  * 
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAIWG           Unit Weight
     C                     Z-ADD*ZERO     WJCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WJC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WJURTN           Number Cases On
     C                     Z-ADD*ZERO     WJAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJTFNB           Transportation
     C                     Z-ADD*ZERO     WJTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WJTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WJBLPR           Market Overage
     C                     Z-ADD*ZERO     WJBMPR           Standard Overag
     C                     Z-ADD*ZERO     WJCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WJCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WJSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WJPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WJICN1           Item Category N
     C                     Z-ADD*ZERO     WJICN2           Item Category N
     C                     Z-ADD*ZERO     WJV2NB           Item Category N
     C                     Z-ADD*ZERO     WJITCN           Item Category N
     C                     Z-ADD*ZERO     WJITC5           Item Category N
     C                     Z-ADD*ZERO     WJICN6           Item Category N
     C                     Z-ADD*ZERO     WJICN7           Item Category N
     C                     Z-ADD*ZERO     WJICN8           Item Category N
     C                     Z-ADD*ZERO     WJICN9           Item Category N
     C                     Z-ADD*ZERO     WJICN0           Item Category N
     C                     Z-ADD*ZERO     WJSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WJA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WJSJNB           Production Lead
     C                     Z-ADD*ZERO     WJSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WJSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WJSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WJCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WJCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WJILNB           Packages per ca
     C                     Z-ADD*ZERO     WJCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WJCINB           PM Batch Size
     C                     Z-ADD*ZERO     WJCJNB           Package Level s
     C                     Z-ADD*ZERO     WJCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WJCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WJCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WJCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WJCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WJCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WJCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WJCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WJC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WJB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WJB5NB           PM Line Number
     C                     Z-ADD*ZERO     WJBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WJBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WJF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WJF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WJF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WJBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WJBNNB           Production Qty
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WKAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WKAIWG           Unit Weight
     C                     Z-ADD*ZERO     WKCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WKC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WKURTN           Number Cases On
     C                     Z-ADD*ZERO     WKACC8           Vendor item Def
     C                     Z-ADD*ZERO     WKRINB           Item Structure
     C                     Z-ADD*ZERO     WKRHNB           Item Structure
     C                     Z-ADD*ZERO     WKRGNB           Item Structure
     C                     Z-ADD*ZERO     WKTFNB           Transportation
     C                     Z-ADD*ZERO     WKCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WKSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WKPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WKSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WKA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WKSJNB           Production Lead
     C                     Z-ADD*ZERO     WKSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WKSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WKSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WKCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WKCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WKILNB           Packages per ca
     C                     Z-ADD*ZERO     WKCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WKCINB           PM Batch Size
     C                     Z-ADD*ZERO     WKCJNB           Package Level s
     C                     Z-ADD*ZERO     WKCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WKCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WKCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WKCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WKCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WKCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WKCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WKCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WKC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WKB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WKTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WKTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WKBLPR           Market Overage
     C                     Z-ADD*ZERO     WKBMPR           Standard Overag
     C                     Z-ADD*ZERO     WKCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKICN1           Item Category N
     C                     Z-ADD*ZERO     WKICN2           Item Category N
     C                     Z-ADD*ZERO     WKV2NB           Item Category N
     C                     Z-ADD*ZERO     WKITCN           Item Category N
     C                     Z-ADD*ZERO     WKITC5           Item Category N
     C                     Z-ADD*ZERO     WKICN6           Item Category N
     C                     Z-ADD*ZERO     WKICN7           Item Category N
     C                     Z-ADD*ZERO     WKICN8           Item Category N
     C                     Z-ADD*ZERO     WKICN9           Item Category N
     C                     Z-ADD*ZERO     WKICN0           Item Category N
     C                     Z-ADD*ZERO     WKB5NB           PM Line Number
     C                     Z-ADD*ZERO     WKBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WKBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WKF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WKF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WKF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WKBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WKBNNB           Production Qty
     C                     Z-ADD*ZERO     WKAHTM           Job Time
     C                     Z-ADD*ZERO     WKEKDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WLR5NB           Deliver after t
     C                     Z-ADD*ZERO     WLR6NB           Deliver before
     C                     Z-ADD*ZERO     WLTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WLMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WLW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  30
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  30
      * Define null work field Description Line One
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Default Commod Mark basis
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Market Overage
     C                     Z-ADD*ZERO     YN0003 114
      * Define null work field Standard Overage/Underage
     C                     Z-ADD*ZERO     YN0004 114
      * Define null work field Commodity Price Group
     C                     MOVEL*BLANK    YN0005  7
      * Define null work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     YN0006 112
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0001  6
      * Define local work field Item Structure Type Code
     C                     Z-ADD*ZERO     YL0002  30
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0007  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0004  2
      * Define null work field Customer Group Code
     C                     MOVEL*BLANK    YN0008  3
      * Define null work field Customer Group Code 2
     C                     MOVEL*BLANK    YN0009  3
      *================================================================
     CSR         ZZEXIT    ENDSR
