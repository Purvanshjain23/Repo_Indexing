     H/TITLE UPD Allocate Std      XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 05/17/22  Time  : 16:38:09
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FCAAFREL8IF  E           K        DISK
      * RTV : Calendar                  Co/Date PrdDaySts=Y
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPBBFREL1IF  E           K        DISK
      * RTV : PS Production Capacity    Retrieval index
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FPMFDREL3IF  E           K        DISK
      * RSQ : Company Item Ext          Co/Capacity Code
      *
     FPDIORELKIF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Item/CItem StrWgtYld
      *
     FPDIOREL6IF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      *
     FPMFDREL1IF  E           K        DISK
      * RTV : Company Item Ext          Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     FPOB6CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      *
     FPOB6CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Consmd Retrieval index
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FPOB6CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Consmd Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@FDREAW
      * Company Item Ext          RTV, select Active
      * Renamed input format fields
     I              FDAIC3                          WAAIC3
     I              FDHGCD                          WAHGCD
     I              FDD0ST                          WAD0ST
     I              FDD2ST                          WAD2ST
     I              FDD6ST                          WAD6ST
     I              FDWESP                          WAWESP
     I              FDEDST                          WAEDST
     I              FDEFST                          WAEFST
     I              FDEHST                          WAEHST
     I              FDEMST                          WAEMST
     I              FDENST                          WAENST
     I              FDEOST                          WAEOST
     I              FDEPST                          WAEPST
     I              FDEQST                          WAEQST
     I              FDOQNY                          WAOQNY
     I              FDORNY                          WAORNY
     I              FDS2DT                          WAS2DT
     I              FDUFT1                          WAUFT1
     I              FDKUAA                          WAKUAA
     I              FDVSST                          WAVSST
     I              FDMJDT                          WAMJDT
     I              FDBETM                          WABETM
     I              FDCCVN                          WACCVN
     I              FDCDVN                          WACDVN
     I              FDMKDT                          WAMKDT
     I              FDBFTM                          WABFTM
     I              FDCEVN                          WACEVN
     I              FDCFVN                          WACFVN
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@AFREY1
      * Calendar                  Co/Date PrdDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WCAIC3
     I              AFBCDT                          WCBCDT
     I              AFCQNB                          WCCQNB
     I              AFESNB                          WCESNB
     I              AFETNB                          WCETNB
     I              AFBZNB                          WCBZNB
     I              AFA9ST                          WCA9ST
     I              AFEINB                          WCEINB
     I              AFC5ST                          WCC5ST
     I              AFAQNB                          WCAQNB
     I              AFCMST                          WCCMST
     I              AFV9ST                          WCV9ST
     I              AFWAST                          WCWAST
     I              AFX2ST                          WCX2ST
     I              AFOJDT                          WCOJDT
     I              AFNQNX                          WCNQNX
     I              AFNRNX                          WCNRNX
     I              AFI9SX                          WCI9SX
     I              AFJASX                          WCJASX
     I              AFOKDT                          WCOKDT
     I              AFOLDT                          WCOLDT
     I              AFUVST                          WCUVST
     I              AFUWST                          WCUWST
     I              AFUXST                          WCUXST
     I              AFAATM                          WCAATM
     I              AFAYNA                          WCAYNA
     I              AFA0NA                          WCA0NA
     I              AFAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADBWC3                          WFBWC3
     I              ADBTC3                          WFBTC3
     I              ADBUC3                          WFBUC3
     I              ADBVC3                          WFBVC3
     I              ADFCAA                          WFFCAA
     I              ADRQSX                          WFRQSX
     I              ADRRSX                          WFRRSX
     I              ADRSSX                          WFRSSX
     I              ADRTSX                          WFRTSX
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADRNSX                          WFRNSX
     I              ADROSX                          WFROSX
     I              ADRPSX                          WFRPSX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WGAIC3
     I              KMV8CD                          WGV8CD
     I              KMAUNA                          WGAUNA
     I              KMI5ST                          WGI5ST
     I              KMBXTX                          WGBXTX
     I              KMM8NB                          WGM8NB
     I              KMUVST                          WGUVST
     I              KMUWST                          WGUWST
     I              KMUXST                          WGUXST
     I              KMVSST                          WGVSST
     I              KMAATM                          WGAATM
     I              KMAYNA                          WGAYNA
     I              KMA0NA                          WGA0NA
     I              KMAXDT                          WGAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WHAIC3
     I              AFBCDT                          WHBCDT
     I              AFCQNB                          WHCQNB
     I              AFESNB                          WHESNB
     I              AFETNB                          WHETNB
     I              AFBZNB                          WHBZNB
     I              AFA9ST                          WHA9ST
     I              AFEINB                          WHEINB
     I              AFC5ST                          WHC5ST
     I              AFAQNB                          WHAQNB
     I              AFCMST                          WHCMST
     I              AFV9ST                          WHV9ST
     I              AFWAST                          WHWAST
     I              AFX2ST                          WHX2ST
     I              AFOJDT                          WHOJDT
     I              AFNQNX                          WHNQNX
     I              AFNRNX                          WHNRNX
     I              AFI9SX                          WHI9SX
     I              AFJASX                          WHJASX
     I              AFOKDT                          WHOKDT
     I              AFOLDT                          WHOLDT
     I              AFUVST                          WHUVST
     I              AFUWST                          WHUWST
     I              AFUXST                          WHUXST
     I              AFAATM                          WHAATM
     I              AFAYNA                          WHAYNA
     I              AFA0NA                          WHA0NA
     I              AFAXDT                          WHAXDT
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WIAIC3
     I              AFBCDT                          WIBCDT
     I              AFCQNB                          WICQNB
     I              AFESNB                          WIESNB
     I              AFETNB                          WIETNB
     I              AFBZNB                          WIBZNB
     I              AFA9ST                          WIA9ST
     I              AFEINB                          WIEINB
     I              AFC5ST                          WIC5ST
     I              AFAQNB                          WIAQNB
     I              AFCMST                          WICMST
     I              AFV9ST                          WIV9ST
     I              AFWAST                          WIWAST
     I              AFX2ST                          WIX2ST
     I              AFOJDT                          WIOJDT
     I              AFNQNX                          WINQNX
     I              AFNRNX                          WINRNX
     I              AFI9SX                          WII9SX
     I              AFJASX                          WIJASX
     I              AFOKDT                          WIOKDT
     I              AFOLDT                          WIOLDT
     I              AFUVST                          WIUVST
     I              AFUWST                          WIUWST
     I              AFUXST                          WIUXST
     I              AFAATM                          WIAATM
     I              AFAYNA                          WIAYNA
     I              AFA0NA                          WIA0NA
     I              AFAXDT                          WIAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WJAIC3
     I              BZHGCD                          WJHGCD
     I              BZAVNA                          WJAVNA
     I              BZAWNA                          WJAWNA
     I              BZL7NA                          WJL7NA
     I              BZL8NA                          WJL8NA
     I              BZL6NA                          WJL6NA
     I              BZMFNA                          WJMFNA
     I              BZADCD                          WJADCD
     I              BZAWPC                          WJAWPC
     I              BZLXST                          WJLXST
     I              BZAECD                          WJAECD
     I              BZAXPC                          WJAXPC
     I              BZLYST                          WJLYST
     I              BZAFCD                          WJAFCD
     I              BZAICD                          WJAICD
     I              BZAIWG                          WJAIWG
     I              BZHICD                          WJHICD
     I              BZRBCD                          WJRBCD
     I              BZFZST                          WJFZST
     I              BZAVST                          WJAVST
     I              BZCZWG                          WJCZWG
     I              BZC0WG                          WJC0WG
     I              BZURTN                          WJURTN
     I              BZAJC8                          WJAJC8
     I              BZRINB                          WJRINB
     I              BZRHNB                          WJRHNB
     I              BZRGNB                          WJRGNB
     I              BZLNCD                          WJLNCD
     I              BZTFNB                          WJTFNB
     I              BZN0CD                          WJN0CD
     I              BZX4ST                          WJX4ST
     I              BZTMVA                          WJTMVA
     I              BZTNVA                          WJTNVA
     I              BZBLPR                          WJBLPR
     I              BZBMPR                          WJBMPR
     I              BZLRCD                          WJLRCD
     I              BZU9ST                          WJU9ST
     I              BZCMCO                          WJCMCO
     I              BZQ1CD                          WJQ1CD
     I              BZQ8CD                          WJQ8CD
     I              BZCHTM                          WJCHTM
     I              BZQZCD                          WJQZCD
     I              BZXWST                          WJXWST
     I              BZXXST                          WJXXST
     I              BZVMST                          WJVMST
     I              BZSWGH                          WJSWGH
     I              BZPPHE                          WJPPHE
     I              BZR3CD                          WJR3CD
     I              BZSDCD                          WJSDCD
     I              BZICN1                          WJICN1
     I              BZSVCD                          WJSVCD
     I              BZICN2                          WJICN2
     I              BZSWCD                          WJSWCD
     I              BZV2NB                          WJV2NB
     I              BZSXCD                          WJSXCD
     I              BZITCN                          WJITCN
     I              BZSYCD                          WJSYCD
     I              BZITC5                          WJITC5
     I              BZSZCD                          WJSZCD
     I              BZICN6                          WJICN6
     I              BZS0CD                          WJS0CD
     I              BZICN7                          WJICN7
     I              BZS1CD                          WJS1CD
     I              BZICN8                          WJICN8
     I              BZS2CD                          WJS2CD
     I              BZICN9                          WJICN9
     I              BZS3CD                          WJS3CD
     I              BZICN0                          WJICN0
     I              BZS4CD                          WJS4CD
     I              BZSFNB                          WJSFNB
     I              BZA3WG                          WJA3WG
     I              BZSJNB                          WJSJNB
     I              BZLLCD                          WJLLCD
     I              BZLMCD                          WJLMCD
     I              BZP3ST                          WJP3ST
     I              BZSKNB                          WJSKNB
     I              BZSLNB                          WJSLNB
     I              BZSMNB                          WJSMNB
     I              BZP4ST                          WJP4ST
     I              BZCFNB                          WJCFNB
     I              BZCGNB                          WJCGNB
     I              BZILNB                          WJILNB
     I              BZCHNB                          WJCHNB
     I              BZCINB                          WJCINB
     I              BZCJNB                          WJCJNB
     I              BZCMNB                          WJCMNB
     I              BZCNNB                          WJCNNB
     I              BZCRNB                          WJCRNB
     I              BZCSNB                          WJCSNB
     I              BZCVNB                          WJCVNB
     I              BZCWNB                          WJCWNB
     I              BZCXNB                          WJCXNB
     I              BZCZNB                          WJCZNB
     I              BZC0NB                          WJC0NB
     I              BZN1CD                          WJN1CD
     I              BZB4NB                          WJB4NB
     I              BZB5NB                          WJB5NB
     I              BZX5ST                          WJX5ST
     I              BZX6ST                          WJX6ST
     I              BZX7ST                          WJX7ST
     I              BZPCCT                          WJPCCT
     I              BZBDNB                          WJBDNB
     I              BZBJNB                          WJBJNB
     I              BZSUST                          WJSUST
     I              BZSVST                          WJSVST
     I              BZSYST                          WJSYST
     I              BZSZST                          WJSZST
     I              BZS1ST                          WJS1ST
     I              BZXRCD                          WJXRCD
     I              BZXTCD                          WJXTCD
     I              BZXUCD                          WJXUCD
     I              BZF5WG                          WJF5WG
     I              BZF6WG                          WJF6WG
     I              BZF7WG                          WJF7WG
     I              BZBLNB                          WJBLNB
     I              BZBNNB                          WJBNNB
     I              BZS2ST                          WJS2ST
     I              BZS4ST                          WJS4ST
     I              BZS5ST                          WJS5ST
     I              BZS6ST                          WJS6ST
     I              BZS8ST                          WJS8ST
     I              BZS9ST                          WJS9ST
     I              BZTCST                          WJTCST
     I              BZTDST                          WJTDST
     I              BZUVST                          WJUVST
     I              BZUWST                          WJUWST
     I              BZUXST                          WJUXST
     I              BZVSST                          WJVSST
     I              BZAATM                          WJAATM
     I              BZAYNA                          WJAYNA
     I              BZA0NA                          WJA0NA
     I              BZAXDT                          WJAXDT
      *
     I@BFRERV
      * PS Production Capacity    Retrieval index
      * Renamed input format fields
     I              BFSFAA                          WKSFAA
     I              BFUVNA                          WKUVNA
     I              BFY6NY                          WKY6NY
     I              BFVKDT                          WKVKDT
     I              BFY7NY                          WKY7NY
     I              BFVSST                          WKVSST
     I              BFMJDT                          WKMJDT
     I              BFBETM                          WKBETM
     I              BFCCVN                          WKCCVN
     I              BFCDVN                          WKCDVN
     I              BFMKDT                          WKMKDT
     I              BFBFTM                          WKBFTM
     I              BFCEVN                          WKCEVN
     I              BFCFVN                          WKCFVN
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WLAIC3
     I              JCV5ST                          WLV5ST
     I              JCELDT                          WLELDT
     I              JCHVHD                          WLHVHD
     I              JCZ6NB                          WLZ6NB
     I              JCZ7NB                          WLZ7NB
     I              JCDGPC                          WLDGPC
     I              JCAVCW                          WLAVCW
     I              JCDIPC                          WLDIPC
     I              JCZ0NB                          WLZ0NB
     I              JCAVLE                          WLAVLE
     I              JCECWG                          WLECWG
     I              JCUVST                          WLUVST
     I              JCUWST                          WLUWST
     I              JCUXST                          WLUXST
     I              JCVSST                          WLVSST
     I              JCAATM                          WLAATM
     I              JCAYNA                          WLAYNA
     I              JCA0NA                          WLA0NA
     I              JCAXDT                          WLAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WMAIC3
     I              I8V5ST                          WMV5ST
     I              I8ELDT                          WMELDT
     I              I8HGCD                          WMHGCD
     I              I8AJCD                          WMAJCD
     I              I8GPDT                          WMGPDT
     I              I8WTSP                          WMWTSP
     I              I8QTSP                          WMQTSP
     I              I8DJPC                          WMDJPC
     I              I8F8WG                          WMF8WG
     I              I8WTIN                          WMWTIN
     I              I8D5NB                          WMD5NB
     I              I8DXWG                          WMDXWG
     I              I8B2NB                          WMB2NB
     I              I8WTCN                          WMWTCN
     I              I8PSCV                          WMPSCV
     I              I8SAWT                          WMSAWT
     I              I8B9NB                          WMB9NB
     I              I8D1WG                          WMD1WG
     I              I8CBNB                          WMCBNB
     I              I8EZWG                          WMEZWG
     I              I8CCNB                          WMCCNB
     I              I8E0WG                          WME0WG
     I              I8D6NB                          WMD6NB
     I              I8OAWT                          WMOAWT
     I              I8CDNB                          WMCDNB
     I              I8UNW2                          WMUNW2
     I              I8CENB                          WMCENB
     I              I8F9WG                          WMF9WG
     I              I8BPNB                          WMBPNB
     I              I8GAWG                          WMGAWG
     I              I8BQNB                          WMBQNB
     I              I8GBWG                          WMGBWG
     I              I8BRNB                          WMBRNB
     I              I8GCWG                          WMGCWG
     I              I8BSNB                          WMBSNB
     I              I8GDWG                          WMGDWG
     I              I8BWNB                          WMBWNB
     I              I8GEWG                          WMGEWG
     I              I8PS6U                          WMPS6U
     I              I8WCST                          WMWCST
     I              I8WPST                          WMWPST
     I              I8B5ST                          WMB5ST
     I              I8TFST                          WMTFST
     I              I8TEST                          WMTEST
     I              I8THST                          WMTHST
     I              I8UDST                          WMUDST
     I              I8UFST                          WMUFST
     I              I8UGST                          WMUGST
     I              I8UHST                          WMUHST
     I              I8B6ST                          WMB6ST
     I              I8B7ST                          WMB7ST
     I              I8DVWG                          WMDVWG
     I              I8D7NB                          WMD7NB
     I              I8FCAD                          WMFCAD
     I              I8D9NB                          WMD9NB
     I              I8DWWG                          WMDWWG
     I              I8EANB                          WMEANB
     I              I8SHWT                          WMSHWT
     I              I8EBNB                          WMEBNB
     I              I8AVWT                          WMAVWT
     I              I8ECNB                          WMECNB
     I              I8WTON                          WMWTON
     I              I8EDNB                          WMEDNB
     I              I8FNWT                          WMFNWT
     I              I8EENB                          WMEENB
     I              I8QTAS                          WMQTAS
     I              I8EFNB                          WMEFNB
     I              I8WAIO                          WMWAIO
     I              I8EGNB                          WMEGNB
     I              I8R3CD                          WMR3CD
     I              I8RGNB                          WMRGNB
     I              I8RHNB                          WMRHNB
     I              I8RINB                          WMRINB
     I              I8XRCD                          WMXRCD
     I              I8UVST                          WMUVST
     I              I8UWST                          WMUWST
     I              I8UXST                          WMUXST
     I              I8VSST                          WMVSST
     I              I8AATM                          WMAATM
     I              I8AYNA                          WMAYNA
     I              I8A0NA                          WMA0NA
     I              I8AXDT                          WMAXDT
      *
     I@FDRERW
      * Company Item Ext          Co/Capacity Code
      * Renamed input format fields
     I              FDAIC3                          WOAIC3
     I              FDHGCD                          WOHGCD
     I              FDD0ST                          WOD0ST
     I              FDD2ST                          WOD2ST
     I              FDD6ST                          WOD6ST
     I              FDWESP                          WOWESP
     I              FDEDST                          WOEDST
     I              FDEFST                          WOEFST
     I              FDEHST                          WOEHST
     I              FDEMST                          WOEMST
     I              FDENST                          WOENST
     I              FDEOST                          WOEOST
     I              FDEPST                          WOEPST
     I              FDEQST                          WOEQST
     I              FDOQNY                          WOOQNY
     I              FDORNY                          WOORNY
     I              FDS2DT                          WOS2DT
     I              FDUFT1                          WOUFT1
     I              FDKUAA                          WOKUAA
     I              FDVSST                          WOVSST
     I              FDMJDT                          WOMJDT
     I              FDBETM                          WOBETM
     I              FDCCVN                          WOCCVN
     I              FDCDVN                          WOCDVN
     I              FDMKDT                          WOMKDT
     I              FDBFTM                          WOBFTM
     I              FDCEVN                          WOCEVN
     I              FDCFVN                          WOCFVN
      *
     I@IOREA4
      * Item Bill Of Material     Co/Item/CItem StrWgtYld
      * Renamed input format fields
     I              IOAIC3                          WRAIC3
     I              IOHGCD                          WRHGCD
     I              IOC9NB                          WRC9NB
     I              IOV2ST                          WRV2ST
     I              IOBOPR                          WRBOPR
     I              IOBPPR                          WRBPPR
     I              IOHGQT                          WRHGQT
     I              IOHHCD                          WRHHCD
     I              IOYAST                          WRYAST
     I              IOCNSM                          WRCNSM
     I              IOBMY1                          WRBMY1
     I              IOBMY2                          WRBMY2
     I              IOIXQT                          WRIXQT
     I              IOIYQT                          WRIYQT
     I              IORSST                          WRRSST
     I              IORTST                          WRRTST
     I              IOUVST                          WRUVST
     I              IOUWST                          WRUWST
     I              IOUXST                          WRUXST
     I              IOVSST                          WRVSST
     I              IOAATM                          WRAATM
     I              IOAYNA                          WRAYNA
     I              IOA0NA                          WRA0NA
     I              IOAXDT                          WRAXDT
      *
     I@IOREGB
      * Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      * Renamed input format fields
     I              IOAIC3                          WSAIC3
     I              IOHGCD                          WSHGCD
     I              IOC9NB                          WSC9NB
     I              IOV2ST                          WSV2ST
     I              IOBOPR                          WSBOPR
     I              IOBPPR                          WSBPPR
     I              IOHGQT                          WSHGQT
     I              IOHHCD                          WSHHCD
     I              IOYAST                          WSYAST
     I              IOCNSM                          WSCNSM
     I              IOBMY1                          WSBMY1
     I              IOBMY2                          WSBMY2
     I              IOIXQT                          WSIXQT
     I              IOIYQT                          WSIYQT
     I              IORSST                          WSRSST
     I              IORTST                          WSRTST
     I              IOUVST                          WSUVST
     I              IOUWST                          WSUWST
     I              IOUXST                          WSUXST
     I              IOVSST                          WSVSST
     I              IOAATM                          WSAATM
     I              IOAYNA                          WSAYNA
     I              IOA0NA                          WSA0NA
     I              IOAXDT                          WSAXDT
      *
     I@FDREAP
      * Company Item Ext          Retrieval index
      * Renamed input format fields
     I              FDAIC3                          WTAIC3
     I              FDHGCD                          WTHGCD
     I              FDD0ST                          WTD0ST
     I              FDD2ST                          WTD2ST
     I              FDD6ST                          WTD6ST
     I              FDWESP                          WTWESP
     I              FDEDST                          WTEDST
     I              FDEFST                          WTEFST
     I              FDEHST                          WTEHST
     I              FDEMST                          WTEMST
     I              FDENST                          WTENST
     I              FDEOST                          WTEOST
     I              FDEPST                          WTEPST
     I              FDEQST                          WTEQST
     I              FDOQNY                          WTOQNY
     I              FDORNY                          WTORNY
     I              FDS2DT                          WTS2DT
     I              FDUFT1                          WTUFT1
     I              FDKUAA                          WTKUAA
     I              FDVSST                          WTVSST
     I              FDMJDT                          WTMJDT
     I              FDBETM                          WTBETM
     I              FDCCVN                          WTCCVN
     I              FDCDVN                          WTCDVN
     I              FDMKDT                          WTMKDT
     I              FDBFTM                          WTBFTM
     I              FDCEVN                          WTCEVN
     I              FDCFVN                          WTCFVN
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WVAJCD
     I              ADF8NA                          WVF8NA
     I              ADACNA                          WVACNA
     I              ADADNA                          WVADNA
     I              ADAENA                          WVAENA
     I              ADAJNA                          WVAJNA
     I              ADBTTX                          WVBTTX
     I              ADAOCD                          WVAOCD
     I              ADBGCD                          WVBGCD
     I              ADVHST                          WVVHST
     I              ADMPNA                          WVMPNA
     I              ADWPST                          WVWPST
     I              ADXUST                          WVXUST
     I              ADT0ST                          WVT0ST
     I              ADT1ST                          WVT1ST
     I              ADDBNB                          WVDBNB
     I              ADT2ST                          WVT2ST
     I              ADT3ST                          WVT3ST
     I              ADT4ST                          WVT4ST
     I              ADT6ST                          WVT6ST
     I              ADBWC3                          WVBWC3
     I              ADBTC3                          WVBTC3
     I              ADBUC3                          WVBUC3
     I              ADBVC3                          WVBVC3
     I              ADFCAA                          WVFCAA
     I              ADRQSX                          WVRQSX
     I              ADRRSX                          WVRRSX
     I              ADRSSX                          WVRSSX
     I              ADRTSX                          WVRTSX
     I              ADT7ST                          WVT7ST
     I              ADT8ST                          WVT8ST
     I              ADRNSX                          WVRNSX
     I              ADROSX                          WVROSX
     I              ADRPSX                          WVRPSX
     I              ADUVST                          WVUVST
     I              ADUWST                          WVUWST
     I              ADUXST                          WVUXST
     I              ADVSST                          WVVSST
     I              ADAATM                          WVAATM
     I              ADAYNA                          WVAYNA
     I              ADA0NA                          WVA0NA
     I              ADAXDT                          WVAXDT
      *
     I@I8CPXP
      * PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      * Renamed input format fields
     I              I8AIC3                          WWAIC3
     I              I8V5ST                          WWV5ST
     I              I8ELDT                          WWELDT
     I              I8HGCD                          WWHGCD
     I              I8AJCD                          WWAJCD
     I              I8GPDT                          WWGPDT
     I              I8WTSP                          WWWTSP
     I              I8QTSP                          WWQTSP
     I              I8DJPC                          WWDJPC
     I              I8F8WG                          WWF8WG
     I              I8WTIN                          WWWTIN
     I              I8D5NB                          WWD5NB
     I              I8DXWG                          WWDXWG
     I              I8B2NB                          WWB2NB
     I              I8WTCN                          WWWTCN
     I              I8PSCV                          WWPSCV
     I              I8SAWT                          WWSAWT
     I              I8B9NB                          WWB9NB
     I              I8D1WG                          WWD1WG
     I              I8CBNB                          WWCBNB
     I              I8EZWG                          WWEZWG
     I              I8CCNB                          WWCCNB
     I              I8E0WG                          WWE0WG
     I              I8D6NB                          WWD6NB
     I              I8OAWT                          WWOAWT
     I              I8CDNB                          WWCDNB
     I              I8UNW2                          WWUNW2
     I              I8CENB                          WWCENB
     I              I8F9WG                          WWF9WG
     I              I8BPNB                          WWBPNB
     I              I8GAWG                          WWGAWG
     I              I8BQNB                          WWBQNB
     I              I8GBWG                          WWGBWG
     I              I8BRNB                          WWBRNB
     I              I8GCWG                          WWGCWG
     I              I8BSNB                          WWBSNB
     I              I8GDWG                          WWGDWG
     I              I8BWNB                          WWBWNB
     I              I8GEWG                          WWGEWG
     I              I8PS6U                          WWPS6U
     I              I8WCST                          WWWCST
     I              I8WPST                          WWWPST
     I              I8B5ST                          WWB5ST
     I              I8TFST                          WWTFST
     I              I8TEST                          WWTEST
     I              I8THST                          WWTHST
     I              I8UDST                          WWUDST
     I              I8UFST                          WWUFST
     I              I8UGST                          WWUGST
     I              I8UHST                          WWUHST
     I              I8B6ST                          WWB6ST
     I              I8B7ST                          WWB7ST
     I              I8DVWG                          WWDVWG
     I              I8D7NB                          WWD7NB
     I              I8FCAD                          WWFCAD
     I              I8D9NB                          WWD9NB
     I              I8DWWG                          WWDWWG
     I              I8EANB                          WWEANB
     I              I8SHWT                          WWSHWT
     I              I8EBNB                          WWEBNB
     I              I8AVWT                          WWAVWT
     I              I8ECNB                          WWECNB
     I              I8WTON                          WWWTON
     I              I8EDNB                          WWEDNB
     I              I8FNWT                          WWFNWT
     I              I8EENB                          WWEENB
     I              I8QTAS                          WWQTAS
     I              I8EFNB                          WWEFNB
     I              I8WAIO                          WWWAIO
     I              I8EGNB                          WWEGNB
     I              I8R3CD                          WWR3CD
     I              I8RGNB                          WWRGNB
     I              I8RHNB                          WWRHNB
     I              I8RINB                          WWRINB
     I              I8XRCD                          WWXRCD
     I              I8UVST                          WWUVST
     I              I8UWST                          WWUWST
     I              I8UXST                          WWUXST
     I              I8VSST                          WWVSST
     I              I8AATM                          WWAATM
     I              I8AYNA                          WWAYNA
     I              I8A0NA                          WWA0NA
     I              I8AXDT                          WWAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WXAIC3
     I              I8V5ST                          WXV5ST
     I              I8ELDT                          WXELDT
     I              I8HGCD                          WXHGCD
     I              I8AJCD                          WXAJCD
     I              I8GPDT                          WXGPDT
     I              I8WTSP                          WXWTSP
     I              I8QTSP                          WXQTSP
     I              I8DJPC                          WXDJPC
     I              I8F8WG                          WXF8WG
     I              I8WTIN                          WXWTIN
     I              I8D5NB                          WXD5NB
     I              I8DXWG                          WXDXWG
     I              I8B2NB                          WXB2NB
     I              I8WTCN                          WXWTCN
     I              I8PSCV                          WXPSCV
     I              I8SAWT                          WXSAWT
     I              I8B9NB                          WXB9NB
     I              I8D1WG                          WXD1WG
     I              I8CBNB                          WXCBNB
     I              I8EZWG                          WXEZWG
     I              I8CCNB                          WXCCNB
     I              I8E0WG                          WXE0WG
     I              I8D6NB                          WXD6NB
     I              I8OAWT                          WXOAWT
     I              I8CDNB                          WXCDNB
     I              I8UNW2                          WXUNW2
     I              I8CENB                          WXCENB
     I              I8F9WG                          WXF9WG
     I              I8BPNB                          WXBPNB
     I              I8GAWG                          WXGAWG
     I              I8BQNB                          WXBQNB
     I              I8GBWG                          WXGBWG
     I              I8BRNB                          WXBRNB
     I              I8GCWG                          WXGCWG
     I              I8BSNB                          WXBSNB
     I              I8GDWG                          WXGDWG
     I              I8BWNB                          WXBWNB
     I              I8GEWG                          WXGEWG
     I              I8PS6U                          WXPS6U
     I              I8WCST                          WXWCST
     I              I8WPST                          WXWPST
     I              I8B5ST                          WXB5ST
     I              I8TFST                          WXTFST
     I              I8TEST                          WXTEST
     I              I8THST                          WXTHST
     I              I8UDST                          WXUDST
     I              I8UFST                          WXUFST
     I              I8UGST                          WXUGST
     I              I8UHST                          WXUHST
     I              I8B6ST                          WXB6ST
     I              I8B7ST                          WXB7ST
     I              I8DVWG                          WXDVWG
     I              I8D7NB                          WXD7NB
     I              I8FCAD                          WXFCAD
     I              I8D9NB                          WXD9NB
     I              I8DWWG                          WXDWWG
     I              I8EANB                          WXEANB
     I              I8SHWT                          WXSHWT
     I              I8EBNB                          WXEBNB
     I              I8AVWT                          WXAVWT
     I              I8ECNB                          WXECNB
     I              I8WTON                          WXWTON
     I              I8EDNB                          WXEDNB
     I              I8FNWT                          WXFNWT
     I              I8EENB                          WXEENB
     I              I8QTAS                          WXQTAS
     I              I8EFNB                          WXEFNB
     I              I8WAIO                          WXWAIO
     I              I8EGNB                          WXEGNB
     I              I8R3CD                          WXR3CD
     I              I8RGNB                          WXRGNB
     I              I8RHNB                          WXRHNB
     I              I8RINB                          WXRINB
     I              I8XRCD                          WXXRCD
     I              I8UVST                          WXUVST
     I              I8UWST                          WXUWST
     I              I8UXST                          WXUXST
     I              I8VSST                          WXVSST
     I              I8AATM                          WXAATM
     I              I8AYNA                          WXAYNA
     I              I8A0NA                          WXA0NA
     I              I8AXDT                          WXAXDT
      *
     I@B6CPAG
      * Order Detail Sched-Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      * Renamed input format fields
     I              B6AIC3                          WYAIC3
     I              B6C4NB                          WYC4NB
     I              B6DPNB                          WYDPNB
     I              B6UENB                          WYUENB
     I              B6JGDT                          WYJGDT
     I              B6OONY                          WYOONY
     I              B6AODT                          WYAODT
     I              B6AJCD                          WYAJCD
     I              B6NUDT                          WYNUDT
     I              B6HGCD                          WYHGCD
     I              B6IGQT                          WYIGQT
     I              B6FLWG                          WYFLWG
     I              B6NSQT                          WYNSQT
     I              B6JQWG                          WYJQWG
     I              B6NVDT                          WYNVDT
     I              B6BUTM                          WYBUTM
     I              B6UVST                          WYUVST
     I              B6UWST                          WYUWST
     I              B6UXST                          WYUXST
     I              B6VSST                          WYVSST
     I              B6AATM                          WYAATM
     I              B6AYNA                          WYAYNA
     I              B6A0NA                          WYA0NA
     I              B6AXDT                          WYAXDT
      *
     I@B6CPNB
      * Order Detail Sched-Consmd Retrieval index
      * Renamed input format fields
     I              B6AIC3                          TAAIC3
     I              B6C4NB                          TAC4NB
     I              B6DPNB                          TADPNB
     I              B6UENB                          TAUENB
     I              B6JGDT                          TAJGDT
     I              B6OONY                          TAOONY
     I              B6AODT                          TAAODT
     I              B6AJCD                          TAAJCD
     I              B6NUDT                          TANUDT
     I              B6HGCD                          TAHGCD
     I              B6IGQT                          TAIGQT
     I              B6FLWG                          TAFLWG
     I              B6NSQT                          TANSQT
     I              B6JQWG                          TAJQWG
     I              B6NVDT                          TANVDT
     I              B6BUTM                          TABUTM
     I              B6UVST                          TAUVST
     I              B6UWST                          TAUWST
     I              B6UXST                          TAUXST
     I              B6VSST                          TAVSST
     I              B6AATM                          TAAATM
     I              B6AYNA                          TAAYNA
     I              B6A0NA                          TAA0NA
     I              B6AXDT                          TAAXDT
      *
     I@B6CPNA
      * Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          TBAIC3
     I              B6C4NB                          TBC4NB
     I              B6DPNB                          TBDPNB
     I              B6UENB                          TBUENB
     I              B6JGDT                          TBJGDT
     I              B6OONY                          TBOONY
     I              B6AODT                          TBAODT
     I              B6AJCD                          TBAJCD
     I              B6NUDT                          TBNUDT
     I              B6HGCD                          TBHGCD
     I              B6IGQT                          TBIGQT
     I              B6FLWG                          TBFLWG
     I              B6NSQT                          TBNSQT
     I              B6JQWG                          TBJQWG
     I              B6NVDT                          TBNVDT
     I              B6BUTM                          TBBUTM
     I              B6UVST                          TBUVST
     I              B6UWST                          TBUWST
     I              B6UXST                          TBUXST
     I              B6VSST                          TBVSST
     I              B6AATM                          TBAATM
     I              B6AYNA                          TBAYNA
     I              B6A0NA                          TBA0NA
     I              B6AXDT                          TBAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          TCAIC3
     I              AFBCDT                          TCBCDT
     I              AFCQNB                          TCCQNB
     I              AFESNB                          TCESNB
     I              AFETNB                          TCETNB
     I              AFBZNB                          TCBZNB
     I              AFA9ST                          TCA9ST
     I              AFEINB                          TCEINB
     I              AFC5ST                          TCC5ST
     I              AFAQNB                          TCAQNB
     I              AFCMST                          TCCMST
     I              AFV9ST                          TCV9ST
     I              AFWAST                          TCWAST
     I              AFX2ST                          TCX2ST
     I              AFOJDT                          TCOJDT
     I              AFNQNX                          TCNQNX
     I              AFNRNX                          TCNRNX
     I              AFI9SX                          TCI9SX
     I              AFJASX                          TCJASX
     I              AFOKDT                          TCOKDT
     I              AFOLDT                          TCOLDT
     I              AFUVST                          TCUVST
     I              AFUWST                          TCUWST
     I              AFUXST                          TCUXST
     I              AFAATM                          TCAATM
     I              AFAYNA                          TCAYNA
     I              AFA0NA                          TCA0NA
     I              AFAXDT                          TCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WXAIC3
     I              I8V5ST                          WXV5ST
     I              I8ELDT                          WXELDT
     I              I8HGCD                          WXHGCD
     I              I8AJCD                          WXAJCD
     I              I8GPDT                          WXGPDT
     I              I8WTSP                          WXWTSP
     I              I8QTSP                          WXQTSP
     I              I8DJPC                          WXDJPC
     I              I8F8WG                          WXF8WG
     I              I8WTIN                          WXWTIN
     I              I8D5NB                          WXD5NB
     I              I8DXWG                          WXDXWG
     I              I8B2NB                          WXB2NB
     I              I8WTCN                          WXWTCN
     I              I8PSCV                          WXPSCV
     I              I8SAWT                          WXSAWT
     I              I8B9NB                          WXB9NB
     I              I8D1WG                          WXD1WG
     I              I8CBNB                          WXCBNB
     I              I8EZWG                          WXEZWG
     I              I8CCNB                          WXCCNB
     I              I8E0WG                          WXE0WG
     I              I8D6NB                          WXD6NB
     I              I8OAWT                          WXOAWT
     I              I8CDNB                          WXCDNB
     I              I8UNW2                          WXUNW2
     I              I8CENB                          WXCENB
     I              I8F9WG                          WXF9WG
     I              I8BPNB                          WXBPNB
     I              I8GAWG                          WXGAWG
     I              I8BQNB                          WXBQNB
     I              I8GBWG                          WXGBWG
     I              I8BRNB                          WXBRNB
     I              I8GCWG                          WXGCWG
     I              I8BSNB                          WXBSNB
     I              I8GDWG                          WXGDWG
     I              I8BWNB                          WXBWNB
     I              I8GEWG                          WXGEWG
     I              I8PS6U                          WXPS6U
     I              I8WCST                          WXWCST
     I              I8WPST                          WXWPST
     I              I8B5ST                          WXB5ST
     I              I8TFST                          WXTFST
     I              I8TEST                          WXTEST
     I              I8THST                          WXTHST
     I              I8UDST                          WXUDST
     I              I8UFST                          WXUFST
     I              I8UGST                          WXUGST
     I              I8UHST                          WXUHST
     I              I8B6ST                          WXB6ST
     I              I8B7ST                          WXB7ST
     I              I8DVWG                          WXDVWG
     I              I8D7NB                          WXD7NB
     I              I8FCAD                          WXFCAD
     I              I8D9NB                          WXD9NB
     I              I8DWWG                          WXDWWG
     I              I8EANB                          WXEANB
     I              I8SHWT                          WXSHWT
     I              I8EBNB                          WXEBNB
     I              I8AVWT                          WXAVWT
     I              I8ECNB                          WXECNB
     I              I8WTON                          WXWTON
     I              I8EDNB                          WXEDNB
     I              I8FNWT                          WXFNWT
     I              I8EENB                          WXEENB
     I              I8QTAS                          WXQTAS
     I              I8EFNB                          WXEFNB
     I              I8WAIO                          WXWAIO
     I              I8EGNB                          WXEGNB
     I              I8R3CD                          WXR3CD
     I              I8RGNB                          WXRGNB
     I              I8RHNB                          WXRHNB
     I              I8RINB                          WXRINB
     I              I8XRCD                          WXXRCD
     I              I8UVST                          WXUVST
     I              I8UWST                          WXUWST
     I              I8UXST                          WXUXST
     I              I8VSST                          WXVSST
     I              I8AATM                          WXAATM
     I              I8AYNA                          WXAYNA
     I              I8A0NA                          WXA0NA
     I              I8AXDT                          WXAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPOB61    E DSPOB6CPL0
      * UPD : Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          TBAIC3
     I              B6C4NB                          TBC4NB
     I              B6DPNB                          TBDPNB
     I              B6UENB                          TBUENB
     I              B6JGDT                          TBJGDT
     I              B6OONY                          TBOONY
     I              B6AODT                          TBAODT
     I              B6AJCD                          TBAJCD
     I              B6NUDT                          TBNUDT
     I              B6HGCD                          TBHGCD
     I              B6IGQT                          TBIGQT
     I              B6FLWG                          TBFLWG
     I              B6NSQT                          TBNSQT
     I              B6JQWG                          TBJQWG
     I              B6NVDT                          TBNVDT
     I              B6BUTM                          TBBUTM
     I              B6UVST                          TBUVST
     I              B6UWST                          TBUWST
     I              B6UXST                          TBUXST
     I              B6VSST                          TBVSST
     I              B6AATM                          TBAATM
     I              B6AYNA                          TBAYNA
     I              B6A0NA                          TBA0NA
     I              B6AXDT                          TBAXDT
      *
     IYBRDCS      DS                             91
     IYCRDCS      DS                            326
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Warehouse Code
     I                                        1   3 P1AJCD
      * I :  Company Number
     I                                    P   4   50P1AIC3
      * I :  Item Code
     I                                    P   6   90P1HGCD
      * B :  Production Date
     I                                    P  10  130P1ELDT
      * I :  UOM Primary
     I                                       14  15 P1ADCD
      * I :  Unit Weight
     I                                    P  16  212P1AIWG
      * I :  Fresh Chilling Time
     I                                    P  22  242P1CHTM
      * I :  Piece Count Item
     I                                       25  25 P1PCCT
      * I :  Pieces Per Bag
     I                                    P  26  290P1BDNB
      * I :  Bags Per Unit
     I                                    P  30  330P1BJNB
      * I :  Warehouse Type
     I                                       34  35 P1WPST
      * I :  Warehouse Std Chill Time
     I                                       36  36 P1T1ST
      * I :  Warehouse Chill Time
     I                                    P  37  392P1DBNB
      * I :  Order Number
     I                                    P  40  430P1C4NB
      * I :  Order Sequence Number
     I                                    P  44  450P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P  46  470P1UENB
      * I :  Production Date RGF
     I                                    P  48  510P1GVDT
      * I :  Production Date RGT
     I                                    P  52  550P1GWDT
      * I :  Quantity Ordered
     I                                    P  56  612P1AVQT
      * I :  Weight Ordered
     I                                    P  62  672P1D0WG
      * B :  Quantity Scheduled
     I                                    P  68  732P1CCQT
      * B :  Weight Scheduled
     I                                    P  74  792P1AUWG
      * B :  ATS Quantity Need USR
     I                                    P  80  852P1HWQT
      * B :  ATS Weight Need USR
     I                                    P  86  912P1ENWG
      * I :  Ship Date USR
     I                                    P  92  950P1HLDT
      * I :  ATS Adj Type USR 2
     I                                       96  97 P1QJST
      * I :  PSAA Program Name
     I                                       98 107 P1BXVN
     IP2PARM      DS
      * FLD: Order Detail Schedule
      * I :  Order From Warehouse
     I                                        1   3 P2AYAA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AJCD    PARM           WP0001  3        Warehouse Code
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1HGCD    PARM           WP0003  70       Item Code
     C           P1ELDT    PARM P1ELDT    WP0004  70       Production Date
     C           P1ADCD    PARM           WP0005  2        UOM Primary
     C           P1AIWG    PARM           WP0006 112       Unit Weight
     C           P1CHTM    PARM           WP0007  52       Fresh Chilling
     C           P1PCCT    PARM           WP0008  1        Piece Count Ite
     C           P1BDNB    PARM           WP0009  70       Pieces Per Bag
     C           P1BJNB    PARM           WP0010  70       Bags Per Unit
     C           P1WPST    PARM           WP0011  2        Warehouse Type
     C           P1T1ST    PARM           WP0012  1        Warehouse Std C
     C           P1DBNB    PARM           WP0013  52       Warehouse Chill
     C           P1C4NB    PARM           WP0014  70       Order Number
     C           P1DPNB    PARM           WP0015  30       Order Sequence
     C           P1UENB    PARM           WP0016  30       Order Secondary
     C           P1GVDT    PARM           WP0017  70       Production Date
     C           P1GWDT    PARM           WP0018  70       Production Date
     C           P1AVQT    PARM           WP0019 112       Quantity Ordere
     C           P1D0WG    PARM           WP0020 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WP0021 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WP0022 112       Weight Schedule
     C           P1HWQT    PARM P1HWQT    WP0023 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WP0024 112       ATS Weight Need
     C           P1HLDT    PARM           WP0025  70       Ship Date USR
     C           P1QJST    PARM           WP0026  2        ATS Adj Type US
     C           P1BXVN    PARM           WP0027 10        PSAA Program Na
     C           P2AYAA    PARM           WP0028  3        Order From Ware
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Allocate Std      XF
     C                     Z-ADDP1GVDT    YL0001           Date From
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
     C                     EXSR SARVGN
      * R13899 RMC 10/11/18-If OH Is a BLOCK order, then add 1 day to job
      *  - dont allocate current day prod to a block order UNLESS Sched O
      * CASE: PAR.PSAA Program Name is Sched as ordered-Override
     C           P1BXVN    IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    YL0005           Block Order Fla
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Block Order Flag  RT - Order Header TRG  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * R13899 RMC 10/11/18-If OD is price type= DST/TNK force to suspend
      * Rtv Price Type        RT - Order Detail  * 
     C                     EXSR SERVGN
      * DST TNK    -> force to allocation method I
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.OD Price Type is Distressed
      *   |- c2    : LCL.OD Price Type is Tanked
      *   '-
     C           YL0006    IFEQ 'DST'                      *IF
     C           YL0006    OREQ 'TNK'                      *OR
     C                     MOVEL'I'       YL0002           Allocation Meth
     C                     END                             *FI
      * R11918 DN 10/19/17-Do Not Process Allocation if 'I=Suspended Inve
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.Allocation Method is Suspended-Inventory Only
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'I'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Starting Production Date    - with JIT/ASAP for fresh 7/13
      * CASE: PAR.Production Date RGF LE JOB.*Job date
     C           P1GVDT    IFLE ##JDT                      *IF
      * Fresh or  Frozen is new for FP1054
      * CASE: PAR.Warehouse Type is Fresh
     C           P1WPST    IFEQ 'FR'                       *IF
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0002    IFEQ 'F'                        *IF
     C                     Z-ADD##JDT     P1ELDT           Production Date
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0005    IFEQ 'B'                        *IF
      * PAR.Production Date = PAR.Production Date + CON.1 *DAYS
     C           P1ELDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1ELDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1ELDT
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * default Backward - JIT
     C                     Z-ADD##JDT     YL0001           Date From
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
     C                     END                             *FI
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0005    IFEQ 'B'                        *IF
      * LCL.Date From             USR = LCL.Date From             USR + C
     C           YL0001    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Warehouse Type is Frozen
     C           P1WPST    IFEQ 'FZ'                       *IF
     C                     Z-ADD##JDT     YL0001           Date From
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
      * CASE: LCL.Block Order Flag is Block Order
     C           YL0005    IFEQ 'B'                        *IF
      * LCL.Date From             USR = LCL.Date From             USR + C
     C           YL0001    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Fresh or Frozen is new for FP1054
      * CASE: PAR.Warehouse Type is Fresh
     C           P1WPST    IFEQ 'FR'                       *IF
      * CASE: LCL.Allocation Method is Forward - ASAP
     C           YL0002    IFEQ 'F'                        *IF
     C                     Z-ADDP1GVDT    P1ELDT           Production Date
     C                     ELSE
      * CASE: *OTHERWISE
      * default Backward - JIT
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Warehouse Type is Frozen
     C           P1WPST    IFEQ 'FZ'                       *IF
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0001  1        Production Type
     C                     Z-ADD*ZERO     WN0002  70       OD Production D
     C                     Z-ADD*ZERO     WN0003 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0004 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0005  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0006 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0007  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0008  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0009  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0010  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0011  70       Production Date
     C                     MOVEL*BLANK    WN0012  1        Base Frozen
     C                     Z-ADD*ZERO     WN0013  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0014 112       SM Weight Need
     C                     Z-ADD*ZERO     WN0015  70       Production Piec
     C                     Z-ADD*ZERO     WN0016  52       Production Yiel
     C                     MOVEL*BLANK    WN0017  2        Base_Conv_Loss
     C                     MOVEL*BLANK    WN0018  6        Department Code
     C                     Z-ADD*ZERO     WN0019  70       Production Qty
     C                     Z-ADD*ZERO     WN0020  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0021  50       Aging Day
     C                     MOVEL*BLANK    WN0022  6        CIE Capacity Co
      *
      * UPD Allocate Std      IF
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0001    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0007    P      Production Ware
     C                     Z-ADDWL0003    YL0008           Accounting Comp
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P1T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1DBNB    WN0009           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1CHTM    WN0009           Chilling Time U
     C                     END                             *FI
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SGRVGN
     C                     MOVELWUBXTX    WN0012           Base Frozen
      * FP1054 do forward or backwards per comp item ext sts for FRESH
      * CASE: PAR.Warehouse Type is Fresh
     C           P1WPST    IFEQ 'FR'                       *IF
      * CASE: PAR.Allocation Method is Forward - ASAP
     C           YL0002    IFEQ 'F'                        *IF
      * ITR:  Allocate Availability of Standard Mix
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE PAR.Production Date RGT
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFLE P1GWDT                     *IF
     C           P1HWQT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0004           Company Number
     C                     Z-ADDP1ELDT    WL0005           Post to G/L Dat
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0009    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0007           Company Number
     C                     Z-ADDP1HGCD    WL0008           Item Code
     C                     Z-ADDP1ELDT    WL0009           Production Date
     C                     MOVELYL0010    WL0010    P      Production Day
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YL0010    P      Production Day
      * Allocate Base & Production for Item On Order
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFEQ 'Y'                        *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C           YL0010    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Item Prod Limit   RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0011           Company Number
     C                     Z-ADDP1HGCD    WL0012           Item Code
     C                     Z-ADDP1ELDT    WL0014           Production Date
     C                     MOVELWN0022    WL0016    P      CIE Capacity Co
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    WN0017    P      Base_Conv_Loss
     C                     Z-ADDWL0015    YL0012           Production Qty
     C                     MOVELWL0016    WN0022    P      CIE Capacity Co
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0001           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0017           Company Number
     C                     MOVELWN0001    WL0018    P      Production Type
     C                     Z-ADDP1ELDT    WL0019           Production Date
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * Adjust Need based on Item Limit
      * CASE: LCL.Production Qty Limit USR is GT Zero
     C           YL0012    IFGT 0                          *IF
      * CASE: PAR.CIE Capacity Code is Not Entered
     C           WN0022    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     YL0014           Weight Producti
     C                     Z-ADD*ZERO     YL0015           Pieces Producti
      * Rtv Production-AllWhs RT - PS Prod Item Schedule  * Scheduled Pro
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0021           Company Number
     C                     MOVELWN0001    WL0022    P      Production Type
     C                     Z-ADDP1ELDT    WL0023           Production Date
     C                     Z-ADDP1HGCD    WL0024           Item Code
     C                     Z-ADDYL0014    WL0025           Weight Producti
     C                     Z-ADDYL0015    WL0026           Pieces Producti
     C                     Z-ADDYL0017    WL0028           Production Qty
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    YL0014           Weight Producti
     C                     Z-ADDWL0026    YL0015           Pieces Producti
     C                     MOVELWL0027    YL0016    P      PS Production W
     C                     Z-ADDWL0028    YL0017           Production Qty
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prod f/Capcty Cde RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0029           Company Number
     C                     MOVELWN0022    WL0030    P      CIE Capacity Co
     C                     MOVELWN0001    WL0031    P      Production Type
     C                     Z-ADDP1ELDT    WL0032           Production Date
     C                     Z-ADDYL0014    WL0033           Weight Producti
     C                     Z-ADDYL0015    WL0034           Pieces Producti
     C                     Z-ADDYL0017    WL0036           Production Qty
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    YL0014           Weight Producti
     C                     Z-ADDWL0034    YL0015           Pieces Producti
     C                     MOVELWL0035    YL0016    P      PS Production W
     C                     Z-ADDWL0036    YL0017           Production Qty
     C                     END                             *FI
      * Available Production
      * CASE: LCL.Production Qty LT LCL.Production Qty Limit USR
     C           YL0017    IFLT YL0012                     *IF
      * Available Production
      * LCL.Available Production =
      *    *COMPUTE (x1 - x2)
      * x1    : LCL.Production Qty Limit USR
      * -     : PGM.*Synon (15,0) work field
      * x2    : LCL.Production Qty
     C           YL0012    SUB  YL0017    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0018           Available Produ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0018           Available Produ
     C                     END                             *FI
      * Need exceeds Production Capacity Available for the Item.
      * CASE: PAR.ATS Quantity Need USR GE LCL.Available Production
     C           P1HWQT    IFGE YL0018                     *IF
     C                     Z-ADDYL0018    P1HWQT           ATS Quantity Ne
     C           P1HWQT    MULT P1AIWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
     C                     END                             *FI
      * Convert Standard Mix Production for the Item on the Order.
      * CASE: PAR.ATS Quantity Need USR is Greater than zero
     C           P1HWQT    IFGT 0                          *IF
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * Accounting Co
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0037           Company Number
     C                     Z-ADDP1HGCD    WL0038           Item Code
     C                     Z-ADDWN0016    WL0039           Production Yiel
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    WN0016           Production Yiel
     C                     MOVELWL0040    WUWXST    P      Record Found US
      * Allocate Base
      * CASE: PAR.Production Yield is Greater than zero
     C           WN0016    IFGT 0                          *IF
      * control rounding 6/11/09
      * Standard Mix Weight Need
      * WRK.Copies 15.5           USR =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.ATS Weight Need USR
      * /     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0016    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1ENWG    DIV  W0WB01    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WULXNX           Copies 15.5
     C           WULXNX    MULT 1         WN0014    H      SM Weight Need
      * Pieces Needed
      * CASE: PAR.Piece Count Item is yes
     C           P1PCCT    IFEQ 'Y'                        *IF
      * SM Pieces Need USR
      * PAR.SM Pieces Need USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.ATS Quantity Need USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           P1HWQT    MULT P1BDNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT P1BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0013           SM Pieces Need
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0013           SM Pieces Need
     C                     END                             *FI
      * FP1054 RMC 2/27/09 Adjust need per consumed items avail if not sc
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * BLD BPS Consumed Itm  XF - Item Bill Of Material  * 
     C                     CALL 'PMFQXFR'              90  BLD BPS Consume
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1HGCD    WQ0002  70       Item Code
     C           WN0014    PARM WN0014    WQ0003 112       Weight Need USR
     C           WN0013    PARM WN0013    WQ0004  70       Pieces Need USR
     C                     PARM P1PCCT    WQ0005  1        Piece Count Ite
     C                     PARM P1AJCD    WQ0006  3        Warehouse Code
     C                     PARM P1ELDT    WQ0007  70       Production Date
     C                     PARM WN0001    WQ0008  1        Production Type
     C                     PARM WN0010    WQ0009  92       PS Avg Piece Wg
     C           YL0019    PARM *ZERO     WQ0010  52       Percent Availab
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 06/24/2014 JJH E3160 - Logic changed in this function to
      * ** only process Item Bill of Material records with Upd Standard
      * ** Production = Blank(Yes).
      * Upd Allocate Std      RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0041           Company Number
     C                     Z-ADDP1HGCD    WL0042           Item Code
     C                     MOVELP1AJCD    WL0043    P      Warehouse Code
     C                     Z-ADDP1ELDT    WL0044           Production Date
     C                     MOVELWN0001    WL0045    P      Production Type
     C                     MOVELP1ADCD    WL0046    P      UOM Primary
     C                     Z-ADDP1CHTM    WL0047           Fresh Chilling
     C                     MOVELP1PCCT    WL0048    P      Piece Count Ite
     C                     MOVELP1WPST    WL0049    P      Warehouse Type
     C                     MOVELP1T1ST    WL0050    P      Warehouse Std C
     C                     Z-ADDP1DBNB    WL0051           Warehouse Chill
     C                     Z-ADDP1C4NB    WL0052           Order Number
     C                     Z-ADDP1DPNB    WL0053           Order Sequence
     C                     Z-ADDP1UENB    WL0054           Order Secondary
     C                     MOVELP1QJST    WL0055    P      ATS Adj Type US
     C                     Z-ADDWN0013    WL0056           SM Pieces Need
     C                     Z-ADDWN0014    WL0057           SM Weight Need
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0056    WN0013           SM Pieces Need
     C                     Z-ADDWL0057    WN0014           SM Weight Need
      * The following will be called even if there is not BOM
     C                     END                             *FI
      * * Allocate Production for Item on the Order. *
     C                     Z-ADDP1ELDT    YL0031           Production Date
     C                     Z-ADDP1ELDT    YL0032           Production Date
     C                     Z-ADDP1ELDT    YL0033           Production Date
      * UPD Allocate Prd      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'POQKXFR'              90  UPD Allocate Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AJCD    WQ0011  3        Warehouse Code
     C                     PARM P1AIC3    WQ0012  30       Company Number
     C                     PARM P1HGCD    WQ0013  70       Item Code
     C           YL0031    PARM YL0031    WQ0014  70       Production Date
     C                     PARM P1ADCD    WQ0015  2        UOM Primary
     C                     PARM P1AIWG    WQ0016 112       Unit Weight
     C                     PARM P1CHTM    WQ0017  52       Fresh Chilling
     C                     PARM P1PCCT    WQ0018  1        Piece Count Ite
     C                     PARM P1BDNB    WQ0019  70       Pieces Per Bag
     C                     PARM P1BJNB    WQ0020  70       Bags Per Unit
     C                     PARM P1WPST    WQ0021  2        Warehouse Type
     C                     PARM P1T1ST    WQ0022  1        Warehouse Std C
     C                     PARM P1DBNB    WQ0023  52       Warehouse Chill
     C                     PARM P1C4NB    WQ0024  70       Order Number
     C                     PARM P1DPNB    WQ0025  30       Order Sequence
     C                     PARM P1UENB    WQ0026  30       Order Secondary
     C                     PARM YL0032    WQ0027  70       Production Date
     C                     PARM YL0033    WQ0028  70       Production Date
     C                     PARM P1AVQT    WQ0029 112       Quantity Ordere
     C                     PARM P1D0WG    WQ0030 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WQ0031 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WQ0032 112       Weight Schedule
     C           P1HWQT    PARM P1HWQT    WQ0033 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WQ0034 112       ATS Weight Need
     C                     PARM P1HLDT    WQ0035  70       Ship Date USR
     C                     PARM P1QJST    WQ0036  2        ATS Adj Type US
     C                     PARM P1BXVN    WQ0037 10        PSAA Program Na
     C                     PARM WN0017    WQ0038  2        Base_Conv_Loss
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT 0                          *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0122           Company Number
     C                     Z-ADDP1ELDT    WL0123           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0125           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0126           *Duration (fact
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0124    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0127           Company Number
     C                     Z-ADDP1ELDT    WL0128           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0130           *Date2 (beginni
     C                     Z-ADD1         WL0131           *Duration (fact
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ 0                          *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     ELSE
      * CASE: *OTHERWISE
      * Default is Backwards-JIT
     C                     Z-ADDYL0001    YL0032           Production Date
      * ITR:  Allocate Availability of Standard Mix
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFGE YL0032                     *IF
     C           P1HWQT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0004           Company Number
     C                     Z-ADDP1ELDT    WL0005           Post to G/L Dat
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0009    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0007           Company Number
     C                     Z-ADDP1HGCD    WL0008           Item Code
     C                     Z-ADDP1ELDT    WL0009           Production Date
     C                     MOVELYL0010    WL0010    P      Production Day
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YL0010    P      Production Day
      * Allocate Base & Production for Item On Order
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFEQ 'Y'                        *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C           YL0010    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Item Prod Limit   RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0011           Company Number
     C                     Z-ADDP1HGCD    WL0012           Item Code
     C                     Z-ADDP1ELDT    WL0014           Production Date
     C                     MOVELWN0022    WL0016    P      CIE Capacity Co
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    WN0017    P      Base_Conv_Loss
     C                     Z-ADDWL0015    YL0012           Production Qty
     C                     MOVELWL0016    WN0022    P      CIE Capacity Co
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0001           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0017           Company Number
     C                     MOVELWN0001    WL0018    P      Production Type
     C                     Z-ADDP1ELDT    WL0019           Production Date
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * Adjust Need based on Item Limit
      * CASE: LCL.Production Qty Limit USR is GT Zero
     C           YL0012    IFGT 0                          *IF
      * FP1054 ?? needs to combine prod sched for item on order all whses
      * CASE: PAR.CIE Capacity Code is Not Entered
     C           WN0022    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     YL0014           Weight Producti
     C                     Z-ADD*ZERO     YL0015           Pieces Producti
      * Rtv Production-AllWhs RT - PS Prod Item Schedule  * Scheduled Pro
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0021           Company Number
     C                     MOVELWN0001    WL0022    P      Production Type
     C                     Z-ADDP1ELDT    WL0023           Production Date
     C                     Z-ADDP1HGCD    WL0024           Item Code
     C                     Z-ADDYL0014    WL0025           Weight Producti
     C                     Z-ADDYL0015    WL0026           Pieces Producti
     C                     Z-ADDYL0017    WL0028           Production Qty
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    YL0014           Weight Producti
     C                     Z-ADDWL0026    YL0015           Pieces Producti
     C                     MOVELWL0027    YL0016    P      PS Production W
     C                     Z-ADDWL0028    YL0017           Production Qty
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prod f/Capcty Cde RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0029           Company Number
     C                     MOVELWN0022    WL0030    P      CIE Capacity Co
     C                     MOVELWN0001    WL0031    P      Production Type
     C                     Z-ADDP1ELDT    WL0032           Production Date
     C                     Z-ADDYL0014    WL0033           Weight Producti
     C                     Z-ADDYL0015    WL0034           Pieces Producti
     C                     Z-ADDYL0017    WL0036           Production Qty
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    YL0014           Weight Producti
     C                     Z-ADDWL0034    YL0015           Pieces Producti
     C                     MOVELWL0035    YL0016    P      PS Production W
     C                     Z-ADDWL0036    YL0017           Production Qty
     C                     END                             *FI
      * Available Production
      * CASE: LCL.Production Qty LT LCL.Production Qty Limit USR
     C           YL0017    IFLT YL0012                     *IF
      * Available Production
      * LCL.Available Production =
      *    *COMPUTE (x1 - x2)
      * x1    : LCL.Production Qty Limit USR
      * -     : PGM.*Synon (15,0) work field
      * x2    : LCL.Production Qty
     C           YL0012    SUB  YL0017    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0018           Available Produ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0018           Available Produ
     C                     END                             *FI
      * Need exceeds Production Capacity Available for the Item.
      * CASE: PAR.ATS Quantity Need USR GE LCL.Available Production
     C           P1HWQT    IFGE YL0018                     *IF
     C                     Z-ADDYL0018    P1HWQT           ATS Quantity Ne
     C           P1HWQT    MULT P1AIWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
     C                     END                             *FI
      * Convert Standard Mix Production for the Item on the Order.
      * CASE: PAR.ATS Quantity Need USR is Greater than zero
     C           P1HWQT    IFGT 0                          *IF
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0037           Company Number
     C                     Z-ADDP1HGCD    WL0038           Item Code
     C                     Z-ADDWN0016    WL0039           Production Yiel
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    WN0016           Production Yiel
     C                     MOVELWL0040    WUWXST    P      Record Found US
      * Allocate Base
      * CASE: PAR.Production Yield is Greater than zero
     C           WN0016    IFGT 0                          *IF
      * control rounding 6/11
      * Standard Mix Weight Need
      * WRK.Copies 15.5           USR =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.ATS Weight Need USR
      * /     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0016    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1ENWG    DIV  W0WB01    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WULXNX           Copies 15.5
     C           WULXNX    MULT 1         WN0014    H      SM Weight Need
      * Pieces Needed
      * CASE: PAR.Piece Count Item is yes
     C           P1PCCT    IFEQ 'Y'                        *IF
      * SM Pieces Need USR
      * PAR.SM Pieces Need USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.ATS Quantity Need USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           P1HWQT    MULT P1BDNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT P1BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0013           SM Pieces Need
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0013           SM Pieces Need
     C                     END                             *FI
      * FP1054 RMC 2/27/09 Adjust need per consumed items avail
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * BLD BPS Consumed Itm  XF - Item Bill Of Material  * 
     C                     CALL 'PMFQXFR'              90  BLD BPS Consume
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0039  30       Company Number
     C                     PARM P1HGCD    WQ0040  70       Item Code
     C           WN0014    PARM WN0014    WQ0041 112       Weight Need USR
     C           WN0013    PARM WN0013    WQ0042  70       Pieces Need USR
     C                     PARM P1PCCT    WQ0043  1        Piece Count Ite
     C                     PARM P1AJCD    WQ0044  3        Warehouse Code
     C                     PARM P1ELDT    WQ0045  70       Production Date
     C                     PARM WN0001    WQ0046  1        Production Type
     C                     PARM WN0010    WQ0047  92       PS Avg Piece Wg
     C           YL0019    PARM *ZERO     WQ0048  52       Percent Availab
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: PAR.SM Weight Need USR is Greater than zero
     C           WN0014    IFGT 0                          *IF
      * Upd Allocate Std      RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0041           Company Number
     C                     Z-ADDP1HGCD    WL0042           Item Code
     C                     MOVELP1AJCD    WL0043    P      Warehouse Code
     C                     Z-ADDP1ELDT    WL0044           Production Date
     C                     MOVELWN0001    WL0045    P      Production Type
     C                     MOVELP1ADCD    WL0046    P      UOM Primary
     C                     Z-ADDP1CHTM    WL0047           Fresh Chilling
     C                     MOVELP1PCCT    WL0048    P      Piece Count Ite
     C                     MOVELP1WPST    WL0049    P      Warehouse Type
     C                     MOVELP1T1ST    WL0050    P      Warehouse Std C
     C                     Z-ADDP1DBNB    WL0051           Warehouse Chill
     C                     Z-ADDP1C4NB    WL0052           Order Number
     C                     Z-ADDP1DPNB    WL0053           Order Sequence
     C                     Z-ADDP1UENB    WL0054           Order Secondary
     C                     MOVELP1QJST    WL0055    P      ATS Adj Type US
     C                     Z-ADDWN0013    WL0056           SM Pieces Need
     C                     Z-ADDWN0014    WL0057           SM Weight Need
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0056    WN0013           SM Pieces Need
     C                     Z-ADDWL0057    WN0014           SM Weight Need
     C                     END                             *FI
      * The following will be called even if there is not BOM
     C                     END                             *FI
      * * Allocate Production for Item on the Order. *
     C                     Z-ADDP1ELDT    YL0031           Production Date
      * UPD Allocate Prd      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'POQKXFR'              90  UPD Allocate Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AJCD    WQ0049  3        Warehouse Code
     C                     PARM P1AIC3    WQ0050  30       Company Number
     C                     PARM P1HGCD    WQ0051  70       Item Code
     C           YL0031    PARM YL0031    WQ0052  70       Production Date
     C                     PARM P1ADCD    WQ0053  2        UOM Primary
     C                     PARM P1AIWG    WQ0054 112       Unit Weight
     C                     PARM P1CHTM    WQ0055  52       Fresh Chilling
     C                     PARM P1PCCT    WQ0056  1        Piece Count Ite
     C                     PARM P1BDNB    WQ0057  70       Pieces Per Bag
     C                     PARM P1BJNB    WQ0058  70       Bags Per Unit
     C                     PARM P1WPST    WQ0059  2        Warehouse Type
     C                     PARM P1T1ST    WQ0060  1        Warehouse Std C
     C                     PARM P1DBNB    WQ0061  52       Warehouse Chill
     C                     PARM P1C4NB    WQ0062  70       Order Number
     C                     PARM P1DPNB    WQ0063  30       Order Sequence
     C                     PARM P1UENB    WQ0064  30       Order Secondary
     C                     PARM YL0031    WQ0065  70       Production Date
     C                     PARM YL0031    WQ0066  70       Production Date
     C                     PARM P1AVQT    WQ0067 112       Quantity Ordere
     C                     PARM P1D0WG    WQ0068 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WQ0069 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WQ0070 112       Weight Schedule
     C           P1HWQT    PARM P1HWQT    WQ0071 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WQ0072 112       ATS Weight Need
     C                     PARM P1HLDT    WQ0073  70       Ship Date USR
     C                     PARM P1QJST    WQ0074  2        ATS Adj Type US
     C                     PARM P1BXVN    WQ0075 10        PSAA Program Na
     C                     PARM WN0017    WQ0076  2        Base_Conv_Loss
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0122           Company Number
     C                     Z-ADDP1ELDT    WL0123           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0125           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0126           *Duration (fact
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0124    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0127           Company Number
     C                     Z-ADDP1ELDT    WL0128           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0130           *Date2 (beginni
     C                     Z-ADD-1        WL0131           *Duration (fact
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 do backwards for Frozen
      * CASE: PAR.Warehouse Type is Frozen
     C           P1WPST    IFEQ 'FZ'                       *IF
      * 08/27/10 PKD/SLM Per Damon, do not skip current date.
     C                     Z-ADDYL0001    YL0032           Production Date
      * ITR:  Allocate Availability of Standard Mix
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFGE YL0032                     *IF
     C           P1HWQT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0004           Company Number
     C                     Z-ADDP1ELDT    WL0005           Post to G/L Dat
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0009    P      Production Day
      * FP1054 Check day for a production day per company item ext file
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0007           Company Number
     C                     Z-ADDP1HGCD    WL0008           Item Code
     C                     Z-ADDP1ELDT    WL0009           Production Date
     C                     MOVELYL0010    WL0010    P      Production Day
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YL0010    P      Production Day
      * Allocate Base & Production for Item On Order
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Production Day Status is yes
      *   |- c2    : LCL.Production Day Status USR is not no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFEQ 'Y'                        *IF
     C           YL0010    IFEQ *BLANK                     *IF
     C           YL0010    OREQ 'Y'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Item Prod Limit   RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0011           Company Number
     C                     Z-ADDP1HGCD    WL0012           Item Code
     C                     Z-ADDP1ELDT    WL0014           Production Date
     C                     MOVELWN0022    WL0016    P      CIE Capacity Co
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    WN0017    P      Base_Conv_Loss
     C                     Z-ADDWL0015    YL0012           Production Qty
     C                     MOVELWL0016    WN0022    P      CIE Capacity Co
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0001           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0017           Company Number
     C                     MOVELWN0001    WL0018    P      Production Type
     C                     Z-ADDP1ELDT    WL0019           Production Date
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0001           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * Adjust Need based on Item Limit
      * CASE: LCL.Production Qty Limit USR is GT Zero
     C           YL0012    IFGT 0                          *IF
      * FP1054 ?? needs to combine prod sched for item on order all whses
      * CASE: PAR.CIE Capacity Code is Not Entered
     C           WN0022    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     YL0014           Weight Producti
     C                     Z-ADD*ZERO     YL0015           Pieces Producti
      * Rtv Production-AllWhs RT - PS Prod Item Schedule  * Scheduled Pro
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0021           Company Number
     C                     MOVELWN0001    WL0022    P      Production Type
     C                     Z-ADDP1ELDT    WL0023           Production Date
     C                     Z-ADDP1HGCD    WL0024           Item Code
     C                     Z-ADDYL0014    WL0025           Weight Producti
     C                     Z-ADDYL0015    WL0026           Pieces Producti
     C                     Z-ADDYL0017    WL0028           Production Qty
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    YL0014           Weight Producti
     C                     Z-ADDWL0026    YL0015           Pieces Producti
     C                     MOVELWL0027    YL0016    P      PS Production W
     C                     Z-ADDWL0028    YL0017           Production Qty
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prod f/Capcty Cde RT - Company Item Ext  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0029           Company Number
     C                     MOVELWN0022    WL0030    P      CIE Capacity Co
     C                     MOVELWN0001    WL0031    P      Production Type
     C                     Z-ADDP1ELDT    WL0032           Production Date
     C                     Z-ADDYL0014    WL0033           Weight Producti
     C                     Z-ADDYL0015    WL0034           Pieces Producti
     C                     Z-ADDYL0017    WL0036           Production Qty
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    YL0014           Weight Producti
     C                     Z-ADDWL0034    YL0015           Pieces Producti
     C                     MOVELWL0035    YL0016    P      PS Production W
     C                     Z-ADDWL0036    YL0017           Production Qty
     C                     END                             *FI
      * Available Production
      * CASE: LCL.Production Qty LT LCL.Production Qty Limit USR
     C           YL0017    IFLT YL0012                     *IF
      * Available Production
      * LCL.Available Production =
      *    *COMPUTE (x1 - x2)
      * x1    : LCL.Production Qty Limit USR
      * -     : PGM.*Synon (15,0) work field
      * x2    : LCL.Production Qty
     C           YL0012    SUB  YL0017    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0018           Available Produ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0018           Available Produ
     C                     END                             *FI
      * Need exceeds Production Capacity Available for the Item.
      * CASE: PAR.ATS Quantity Need USR GE LCL.Available Production
     C           P1HWQT    IFGE YL0018                     *IF
     C                     Z-ADDYL0018    P1HWQT           ATS Quantity Ne
     C           P1HWQT    MULT P1AIWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
     C                     END                             *FI
      * Convert Standard Mix Production for the Item on the Order.
      * CASE: PAR.ATS Quantity Need USR is Greater than zero
     C           P1HWQT    IFGT 0                          *IF
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0037           Company Number
     C                     Z-ADDP1HGCD    WL0038           Item Code
     C                     Z-ADDWN0016    WL0039           Production Yiel
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    WN0016           Production Yiel
     C                     MOVELWL0040    WUWXST    P      Record Found US
      * Allocate Base
      * CASE: PAR.Production Yield is Greater than zero
     C           WN0016    IFGT 0                          *IF
      * control rounding 6/11
      * Standard Mix Weight Need
      * WRK.Copies 15.5           USR =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.ATS Weight Need USR
      * /     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0016    DIV  100       W0WB01    H      *Synon (15,5) w
     C           P1ENWG    DIV  W0WB01    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WULXNX           Copies 15.5
     C           WULXNX    MULT 1         WN0014    H      SM Weight Need
      * Pieces Needed
      * CASE: PAR.Piece Count Item is yes
     C           P1PCCT    IFEQ 'Y'                        *IF
      * SM Pieces Need USR
      * PAR.SM Pieces Need USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.ATS Quantity Need USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           P1HWQT    MULT P1BDNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT P1BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0013           SM Pieces Need
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0013           SM Pieces Need
     C                     END                             *FI
      * FP1054 RMC 2/27/09 Adjust need per consumed items avail
      * BLD BPS Consumed Itm  XF - Item Bill Of Material  * 
     C                     CALL 'PMFQXFR'              90  BLD BPS Consume
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0077  30       Company Number
     C                     PARM P1HGCD    WQ0078  70       Item Code
     C           WN0014    PARM WN0014    WQ0079 112       Weight Need USR
     C           WN0013    PARM WN0013    WQ0080  70       Pieces Need USR
     C                     PARM P1PCCT    WQ0081  1        Piece Count Ite
     C                     PARM P1AJCD    WQ0082  3        Warehouse Code
     C                     PARM P1ELDT    WQ0083  70       Production Date
     C                     PARM WN0001    WQ0084  1        Production Type
     C                     PARM WN0010    WQ0085  92       PS Avg Piece Wg
     C           YL0019    PARM *ZERO     WQ0086  52       Percent Availab
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.SM Weight Need USR is Greater than zero
     C           WN0014    IFGT 0                          *IF
      * Upd Allocate Std      RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0041           Company Number
     C                     Z-ADDP1HGCD    WL0042           Item Code
     C                     MOVELP1AJCD    WL0043    P      Warehouse Code
     C                     Z-ADDP1ELDT    WL0044           Production Date
     C                     MOVELWN0001    WL0045    P      Production Type
     C                     MOVELP1ADCD    WL0046    P      UOM Primary
     C                     Z-ADDP1CHTM    WL0047           Fresh Chilling
     C                     MOVELP1PCCT    WL0048    P      Piece Count Ite
     C                     MOVELP1WPST    WL0049    P      Warehouse Type
     C                     MOVELP1T1ST    WL0050    P      Warehouse Std C
     C                     Z-ADDP1DBNB    WL0051           Warehouse Chill
     C                     Z-ADDP1C4NB    WL0052           Order Number
     C                     Z-ADDP1DPNB    WL0053           Order Sequence
     C                     Z-ADDP1UENB    WL0054           Order Secondary
     C                     MOVELP1QJST    WL0055    P      ATS Adj Type US
     C                     Z-ADDWN0013    WL0056           SM Pieces Need
     C                     Z-ADDWN0014    WL0057           SM Weight Need
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0056    WN0013           SM Pieces Need
     C                     Z-ADDWL0057    WN0014           SM Weight Need
     C                     END                             *FI
      * The following will be called even if there is not BOM
     C                     END                             *FI
      * * Allocate Production for Item on the Order. *
     C                     Z-ADDP1ELDT    YL0031           Production Date
      * UPD Allocate Prd      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'POQKXFR'              90  UPD Allocate Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AJCD    WQ0087  3        Warehouse Code
     C                     PARM P1AIC3    WQ0088  30       Company Number
     C                     PARM P1HGCD    WQ0089  70       Item Code
     C           YL0031    PARM YL0031    WQ0090  70       Production Date
     C                     PARM P1ADCD    WQ0091  2        UOM Primary
     C                     PARM P1AIWG    WQ0092 112       Unit Weight
     C                     PARM P1CHTM    WQ0093  52       Fresh Chilling
     C                     PARM P1PCCT    WQ0094  1        Piece Count Ite
     C                     PARM P1BDNB    WQ0095  70       Pieces Per Bag
     C                     PARM P1BJNB    WQ0096  70       Bags Per Unit
     C                     PARM P1WPST    WQ0097  2        Warehouse Type
     C                     PARM P1T1ST    WQ0098  1        Warehouse Std C
     C                     PARM P1DBNB    WQ0099  52       Warehouse Chill
     C                     PARM P1C4NB    WQ0100  70       Order Number
     C                     PARM P1DPNB    WQ0101  30       Order Sequence
     C                     PARM P1UENB    WQ0102  30       Order Secondary
     C                     PARM YL0031    WQ0103  70       Production Date
     C                     PARM YL0031    WQ0104  70       Production Date
     C                     PARM P1AVQT    WQ0105 112       Quantity Ordere
     C                     PARM P1D0WG    WQ0106 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WQ0107 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WQ0108 112       Weight Schedule
     C           P1HWQT    PARM P1HWQT    WQ0109 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WQ0110 112       ATS Weight Need
     C                     PARM P1HLDT    WQ0111  70       Ship Date USR
     C                     PARM P1QJST    WQ0112  2        ATS Adj Type US
     C                     PARM P1BXVN    WQ0113 10        PSAA Program Na
     C                     PARM WN0017    WQ0114  2        Base_Conv_Loss
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT 0                          *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0122           Company Number
     C                     Z-ADDP1ELDT    WL0123           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0125           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0126           *Duration (fact
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0124    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT 0                          *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0127           Company Number
     C                     Z-ADDP1ELDT    WL0128           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0130           *Date2 (beginni
     C                     Z-ADD-1        WL0131           *Duration (fact
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0129    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ 0                          *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2885 RMC 12/4/13 new alloc method="S"tandard -- if shipping with
      *   3 days, force Alloc Method to F-ASAP, else use B-JIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSA02           Item Code
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1HGCD    WQSA02           Item Code
      * Establish starting position
     C           KRSSA     SETLL@FDREAW                    *
     C           KRSSA     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Allocation Meth
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv SchShpDte         RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * CASE: DB1.Allocation Method is Standard or Blank
     C           WAENST    IFEQ *BLANK                     *IF
     C           WAENST    OREQ 'S'
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
     C                     EXSR SCRVGN
      * CASE: LCL.Scheduled Ship Date LE LCL.Date                  USR
     C           YL0003    IFLE YL0004                     *IF
     C                     MOVEL'F'       YL0002           Allocation Meth
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'B'       YL0002           Allocation Meth
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWAENST    YL0002           Allocation Meth
     C                     END                             *FI
     C           KRSSA     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv SchShpDte         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBC4NB    WQSB01           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Order Number
      * Setup key
     C                     Z-ADDP1C4NB    WQSB01           Order Number
      * Establish starting position
     C           KRSSB     SETLL@BFCPY2                    *
     C           KRSSB     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Scheduled Ship
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAODT    YL0003           Scheduled Ship
     C           KRSSB     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WCBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     Z-ADD##JDT     WCBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSC     SETLL@AFREY1                    *
     C           KRSSC     READE@AFREY1                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDWCBCDT    YL0004           *DATE
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSC     READE@AFREY1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Block Order Flag  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADDP1C4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           Block Order Fla
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDBCST    YL0005           Block Order Fla
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Price Type        RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WEAIC3           Company Number
     C                     Z-ADDP1C4NB    WEC4NB           Order Number
     C                     Z-ADDP1DPNB    WEDPNB           Order Sequence
     C                     Z-ADDP1UENB    WEUENB           Order Secondary
      * Establish starting position
     C           KRSSE     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           OD Price Type
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEF7SX    YL0006           OD Price Type
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Production Ware
     C                     Z-ADD*ZERO     WL0003           Accounting Comp
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAOCD    WL0002           Production Ware
     C                     Z-ADDWFBTC3    WL0003           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    WGAIC3           Company Number
     C                     MOVEL@CN,002   WGV8CD           Company Value C
      * Establish starting position
     C           KRSSG     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGBXTX    WUBXTX           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Prd Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0004    WHAIC3           Company Number
     C                     Z-ADDWL0005    WHBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSH     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Production Day
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHWAST    WL0006           Production Day
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv CIE Prod Day Sts  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSI02           Item Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Item Code
      * Setup key
     C                     Z-ADDWL0007    WQSI01           Company Number
     C                     Z-ADDWL0008    WQSI02           Item Code
      * Establish starting position
     C           KRSSI     SETLL@FDREAW                    *
     C           KRSSI     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * default to "Y"es if rcd not found. user isnt overriding it to No
     C                     MOVEL*BLANK    WL0010           Production Day
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Day and Week No.   RT - Calendar  * 
     C                     EXSR SJRVGN
      * CASE: LCL.Day of Week is Sunday
     C           YL0011    IFEQ '1'                        *IF
     C                     MOVELWAD0ST    WL0010           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Monday
     C           YL0011    IFEQ '2'                        *IF
     C                     MOVELWAD2ST    WL0010           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Tuesday
     C           YL0011    IFEQ '3'                        *IF
     C                     MOVELWAD6ST    WL0010           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Wednesday
     C           YL0011    IFEQ '4'                        *IF
     C                     MOVELWAWESP    WL0010           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Thursday
     C           YL0011    IFEQ '5'                        *IF
     C                     MOVELWAEDST    WL0010           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Friday
     C           YL0011    IFEQ '6'                        *IF
     C                     MOVELWAEFST    WL0010           Production Day
     C                     ELSE
      * CASE: LCL.Day of Week is Saturday
     C           YL0011    IFEQ '7'                        *IF
     C                     MOVELWAEHST    WL0010           Production Day
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WIBCDT    WQSJ02           Post to G/L Dat
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0007    WQSJ01           Company Number
     C                     Z-ADDWL0009    WQSJ02           Post to G/L Dat
      * Establish starting position
     C           KRSSJ     SETLL@AFREYY                    *
     C           KRSSJ     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWIA9ST    YL0011           Day of Week
     C           KRSSJ     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Item Prod Limit   RT - Company Item  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0023  70       Production Piec
     C                     Z-ADD*ZERO     WN0024 112       Production Weig
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0011    WJAIC3           Company Number
     C                     Z-ADDWL0012    WJHGCD           Item Code
      * Establish starting position
     C           KRSSK     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0013           Base_Conv_Loss
     C                     Z-ADD*ZERO     WN0023           Production Piec
     C                     Z-ADD*ZERO     WN0024           Production Weig
     C                     Z-ADD*ZERO     WL0015           Production Qty
     C                     MOVEL*BLANK    WL0016           CIE Capacity Co
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJQZCD    WL0013           Base_Conv_Loss
      * Rtv CIE Capacity Qty  RT - Company Item Ext  * 
     C                     EXSR SLRVGN
      * CASE: PAR.CIE Capacity Code is Entered
     C           WL0016    IFNE *BLANK                     *IF
     C                     Z-ADDYL0013    WL0015           Production Qty
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWJBNNB    WL0015           Production Qty
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv CIE Capacity Qty  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2885 RMC 12/9/13 new capacity field in CIE, get qty from PS Prod
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSL02           Item Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Item Code
      * Setup key
     C                     Z-ADDWJAIC3    WQSL01           Company Number
     C                     Z-ADDWJHGCD    WQSL02           Item Code
      * Establish starting position
     C           KRSSL     SETLL@FDREAW                    *
     C           KRSSL     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0016           CIE Capacity Co
     C                     Z-ADD*ZERO     YL0013           PS Max Qty per
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CIE Capacity Code is Entered
     C           WAKUAA    IFNE *BLANK                     *IF
      * RTV PS Prod Cap Max   RT - PS Production Capacity  * 
     C                     EXSR SMRVGN
     C                     MOVELWAKUAA    WL0016           CIE Capacity Co
     C                     END                             *FI
     C           KRSSL     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV PS Prod Cap Max   RT - PS Production Capacity  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WKSFAA           PS Prod Capacit
      * Setup key
     C                     MOVELWAKUAA    WKSFAA           PS Prod Capacit
      * Establish starting position
     C           KRSSM     CHAIN@BFRERV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4671' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0013           PS Max Qty per
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKY6NY    YL0013           PS Max Qty per
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLV5ST           Production Type
     C                     KFLD           WLELDT           Production Date
      * Setup key
     C                     Z-ADDWL0017    WLAIC3           Company Number
     C                     MOVELWL0018    WLV5ST           Production Type
     C                     Z-ADDWL0019    WLELDT           Production Date
      * Establish starting position
     C           KRSSN     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0020           Record Found US
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0020           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Production-AllWhs RT - PS Prod Item Schedule  * Scheduled Pr
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * accumulate for items in a capacity code - so dont zero out
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WMV5ST    WQSO02           Production Type
     C           *LIKE     DEFN WMELDT    WQSO03           Production Date
     C           *LIKE     DEFN WMHGCD    WQSO04           Item Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Production Type
     C                     KFLD           WQSO03           Production Date
     C                     KFLD           WQSO04           Item Code
      * Setup key
     C                     Z-ADDWL0021    WQSO01           Company Number
     C                     MOVELWL0022    WQSO02           Production Type
     C                     Z-ADDWL0023    WQSO03           Production Date
     C                     Z-ADDWL0024    WQSO04           Item Code
      * Establish starting position
     C           KRSSO     SETLL@I8CPUS                    *
     C           KRSSO     READE@I8CPUS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     ADD  0         WL0025           Weight Producti
     C                     ADD  0         WL0026           Pieces Producti
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Weight Production
      * WRK.Weight Production USR =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whs Tfr Adj
     C           WMDXWG    ADD  WMD1WG    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  WMWTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WMGAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUFUWG           Weight Producti
      * CASE: DB1.PS Piece Count Item is Not Yes
     C           WMTHST    IFEQ *BLANK                     *IF
     C           WMTHST    OREQ 'N'
      * CASE: DB1.PS Unit Weight is Greater than zero
     C           WMF9WG    IFGT 0                          *IF
     C           WUFUWG    DIV  WMF9WG    WUT8NX    H      Production Qty
     C                     ADD  WUT8NX    WL0028           Production Qty
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WUFUWG    WL0025           Weight Producti
      * Pieces Production
      * WRK.Pieces Production USR =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whs Tfr Adj
     C           WMB2NB    ADD  WMCBNB    W0WJ02           *Synon (15,0) w
     C           W0WJ02    SUB  WMPSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WMBPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUERNB           Pieces Producti
      * CASE: DB1.PS Piece Count Item is yes
     C           WMTHST    IFEQ 'Y'                        *IF
      * RTV Pces/Bag,Bag/Unt,umRT - Company Item  * 
     C                     EXSR SPRVGN
      * Production Quantity
      * WRK.Production Qty =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : WRK.Pieces Production USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : WRK.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : WRK.Bags Per Unit
     C           WUBDNB    MULT WUBJNB    W0WJ01           *Synon (15,0) w
     C           WUERNB    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUT8NX           Production Qty
     C                     ADD  WUT8NX    WL0028           Production Qty
     C                     ADD  WUERNB    WL0026           Pieces Producti
     C                     END                             *FI
     C                     MOVELWMB7ST    WL0027           PS Production W
     C           KRSSO     READE@I8CPUS                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Pces/Bag,Bag/Unt,umRT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADDWMAIC3    WJAIC3           Company Number
     C                     Z-ADDWMHGCD    WJHGCD           Item Code
      * Establish starting position
     C           KRSSP     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJPCCT    WUPCCT           Piece Count Ite
     C                     Z-ADDWJBDNB    WUBDNB           Pieces Per Bag
     C                     Z-ADDWJBJNB    WUBJNB           Bags Per Unit
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Prod f/Capcty Cde RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0033           Weight Producti
     C                     Z-ADD*ZERO     WL0034           Pieces Producti
     C                     MOVEL*BLANK    WL0035           PS Production W
     C                     Z-ADD*ZERO     WL0036           Production Qty
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN WOKUAA    WQSQ02           CIE Capacity Co
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           CIE Capacity Co
      * Setup key
     C                     Z-ADDWL0029    WQSQ01           Company Number
     C                     MOVELWL0030    WQSQ02           CIE Capacity Co
      * Establish starting position
     C           KRSSQ     SETLL@FDRERW                    *
     C           KRSSQ     READE@FDRERW                  90*
      * Data record not found
     C   90                MOVEL'USR4125' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Production-AllWhs RT - PS Prod Item Schedule  * Scheduled Pro
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0021           Company Number
     C                     MOVELWL0031    WL0022    P      Production Type
     C                     Z-ADDWL0032    WL0023           Production Date
     C                     Z-ADDWOHGCD    WL0024           Item Code
     C                     Z-ADDWL0033    WL0025           Weight Producti
     C                     Z-ADDWL0034    WL0026           Pieces Producti
     C                     Z-ADDWL0036    WL0028           Production Qty
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    WL0033           Weight Producti
     C                     Z-ADDWL0026    WL0034           Pieces Producti
     C                     MOVELWL0027    WL0035    P      PS Production W
     C                     Z-ADDWL0028    WL0036           Production Qty
     C           KRSSQ     READE@FDRERW                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * Accounting C
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0039           Production Yiel
     C                     MOVEL*BLANK    WL0040           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WRHGCD    WQSR02           Item Code
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Item Code
      * Setup key
     C                     Z-ADDWL0037    WQSR01           Company Number
     C                     Z-ADDWL0038    WQSR02           Item Code
      * Establish starting position
     C           KRSSR     SETLL@IOREA4                    *
     C           KRSSR     READE@IOREA4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0040           Record Found US
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WRBPPR    WL0039           Production Yiel
     C                     MOVEL'Y'       WL0040           Record Found US
     C           KRSSR     READE@IOREA4                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Upd Allocate Std      RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0025 112       Unit Weight
     C                     Z-ADD*ZERO     WN0026  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0027  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0028 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0029 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0030  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0031  52       Export Pass Rat
     C                     Z-ADD*ZERO     WN0032  70       CDS CV Pieces A
     C                     Z-ADD*ZERO     WN0033 112       CDS CV Weight A
     C                     Z-ADD*ZERO     WN0034  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0035  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0036  70       SM Pieces Remai
     C                     Z-ADD*ZERO     WN0037 112       SM Weight Remai
     C                     Z-ADD*ZERO     WN0038  70       RM Pieces Avail
     C                     Z-ADD*ZERO     WN0039 112       RM Weight Avail
     C                     Z-ADD*ZERO     WN0040  70       RM Pieces Need
     C                     Z-ADD*ZERO     WN0041 112       RM Weight Need
     C                     Z-ADD*ZERO     WN0042  70       RM Pieces Alloc
     C                     Z-ADD*ZERO     WN0043 112       RM Weight Alloc
     C                     Z-ADD*ZERO     WN0044  70       Pieces Schedule
     C                     Z-ADD*ZERO     WN0045 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0046  70       Pieces Schedule
     C                     Z-ADD*ZERO     WN0047 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0048  70       Pieces Need USR
     C                     Z-ADD*ZERO     WN0049 112       Weight Need USR
     C                     Z-ADD*ZERO     WN0050  70       Pieces Consumed
     C                     Z-ADD*ZERO     WN0051 112       Weight Consumed
     C                     Z-ADD*ZERO     WN0052  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0053  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0054  70       Pieces Per Head
     C                     MOVEL*BLANK    WN0055  6        Department Code
     C                     MOVEL*BLANK    WN0056  1        Export_Domestic
     C                     MOVEL*BLANK    WN0057  1        100 % Already U
     C                     MOVEL*BLANK    WN0058  1        Piece Count Ite
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0057           100 % Already U
     C                     Z-ADD*ZERO     WN0050           Pieces Consumed
     C                     Z-ADD*ZERO     WN0051           Weight Consumed
     C                     Z-ADDWL0057    WN0041           RM Weight Need
     C                     Z-ADDWL0056    WN0040           RM Pieces Need
     C                     Z-ADDWL0057    WN0043           RM Weight Alloc
     C                     Z-ADDWL0056    WN0042           RM Pieces Alloc
      * FP1054 01/20/09 use production warehouse when alloc consumed item
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0043    WL0001    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0020    P      Production Ware
     C                     Z-ADDWL0003    YL0021           Accounting Comp
      * 02/15/10 PKD C000527 Retrieve Adjust Credit Pieces from Company
      *              Item Ext.  This will be used for the Produced Items.
      * Rtv Adj Credit Pieces RT - Company Item Ext  * 
     C                     EXSR STRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WSHGCD    WQSS02           Item Code
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Item Code
      * Setup key
     C                     Z-ADDWL0041    WQSS01           Company Number
     C                     Z-ADDWL0042    WQSS02           Item Code
      * Establish starting position
     C           KRSSS     SETLL@IOREGB                    *
     C           KRSSS     READE@IOREGB                  90*
      * Data record not found
     C   90                MOVEL'USR1679' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Consumed Items
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.BOM Type is Consumed - Meat
      *   |- c2    : DB1.Consume Priority % is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WSV2ST    IFEQ 'C'                        *IF
     C           WSBMY1    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * FP1054  use lcl.production warehouse, acctng co
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0059 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0058           Company Number
     C                     Z-ADDWSC9NB    WL0059           Item Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    WUAVNA    P      Description Lin
     C                     MOVELWL0061    WUADCD    P      UOM Primary
     C                     Z-ADDWL0062    WN0025           Unit Weight
     C                     Z-ADDWL0063    WURINB           Item Structure
     C                     Z-ADDWL0064    WURHNB           Item Structure
     C                     Z-ADDWL0065    WURGNB           Item Structure
     C                     MOVELWL0066    WUN0CD    P      Item Type Code
     C                     MOVELWL0067    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0068    WUCHTM           Fresh Chilling
     C                     MOVELWL0069    WUQZCD    P      Base_Conv_Loss
     C                     MOVELWL0070    WUXWST    P      Variety_Rendere
     C                     MOVELWL0071    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0072    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0073    WN0054           Pieces Per Head
     C                     MOVELWL0074    WUR3CD    P      Department Code
     C                     MOVELWL0075    WUSDCD    P      Group for Packa
     C                     MOVELWL0076    WUX5ST    P      Seconds Item
     C                     MOVELWL0077    WN0058    P      Piece Count Ite
     C                     Z-ADDWL0078    WN0026           Pieces Per Bag
     C                     Z-ADDWL0079    WN0027           Bags Per Unit
     C                     MOVELWL0080    WUSUST    P      Export_Domestic
     C                     MOVELWL0081    WUSVST    P      Print On Schedu
     C                     MOVELWL0082    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0083    WUSZST    P      Fresh Sched As
     C                     MOVELWL0084    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0085    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0020    WL0086    P      Warehouse Code
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0087    WUWPST    P      Warehouse Type
     C                     MOVELWL0088    WUXUST    P      Trans Contol AS
     C                     MOVELWL0089    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0090    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0091    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WUWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WUWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chilling Time
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDWUDBNB    WN0053           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCHTM    WN0053           Chilling Time U
     C                     END                             *FI
      * FP1054 use lcl.production warehouse, acctng comp for  avail prod
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
     C                     EXSR SWRVGN
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           WL0055    IFEQ 'AO'                       *IF
      * CASE: PAR.Piece Count Item is yes
     C           WL0048    IFEQ 'Y'                        *IF
      * CASE: PAR.RM Pieces Need USR GT PAR.RM Pieces Avail USR
     C           WN0040    IFGT WN0038                     *IF
     C                     Z-ADDWN0040    WN0038           RM Pieces Avail
     C                     Z-ADDWN0041    WN0039           RM Weight Avail
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.RM Weight Need USR GT PAR.RM Weight Avail USR
     C           WN0041    IFGT WN0039                     *IF
     C                     Z-ADDWN0040    WN0038           RM Pieces Avail
     C                     Z-ADDWN0041    WN0039           RM Weight Avail
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Allocate consumed items or Deallocate consumed items.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.ATS Adj Type USR 2 is Order Allocate
      *   |- c2    : PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
      *   '-
     C           WL0055    IFEQ 'OA'                       *IF
     C           WL0055    OREQ 'AO'                       *OR
     C                     Z-ADD*ZERO     WN0046           Pieces Schedule
     C                     Z-ADD*ZERO     WN0047           Weight Schedule
      * Changed to process the Consumption based on Pieces Per Head of
      * the Component Item Code.  Mark Arensberg  9/11/97
      * Process by Pieces Per Head from Component Item
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pieces Per Head is GT Zero
      *   |- c2    : PAR.Piece Count Item USR is yes
      *   '-
     C           WN0054    IFGT 0                          *IF
     C           WN0058    OREQ 'Y'                        *OR
      * CASE: PAR.RM Pieces Need USR is GT Zero
     C           WN0040    IFGT 0                          *IF
      * Process by Consume Priority % using Pieces
      * CASE: DB1.Consume Priority % is Equal to 100 Pct
     C           WSBMY1    IFEQ 100                        *IF
     C                     Z-ADDWN0040    WN0048           Pieces Need USR
      * Weight Need
      * PAR.Weight Need USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Need USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0048    MULT WN0052    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0049           Weight Need USR
      * Pieces/Weight Scheduled
      * CASE: PAR.Pieces Need USR GT PAR.RM Pieces Avail USR
     C           WN0048    IFGT WN0038                     *IF
     C                     Z-ADDWN0038    WN0046           Pieces Schedule
     C                     Z-ADDWN0039    WN0047           Weight Schedule
     C                     SUB  WN0038    WN0040           RM Pieces Need
     C                     SUB  WN0039    WN0041           RM Weight Need
     C                     SUB  WN0038    WN0042           RM Pieces Alloc
     C                     SUB  WN0039    WN0043           RM Weight Alloc
     C                     ELSE
      * CASE: PAR.Pieces Need USR LE PAR.RM Pieces Avail USR
     C           WN0048    IFLE WN0038                     *IF
     C                     Z-ADDWN0048    WN0046           Pieces Schedule
     C                     Z-ADDWN0049    WN0047           Weight Schedule
     C                     SUB  WN0048    WN0040           RM Pieces Need
     C                     SUB  WN0049    WN0041           RM Weight Need
     C                     SUB  WN0048    WN0042           RM Pieces Alloc
     C                     SUB  WN0049    WN0043           RM Weight Alloc
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Consume Priority % is Not Equal to 100 PCt
     C           WSBMY1    IFNE 100                        *IF
      * Pieces Need
      * PAR.Pieces Need USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.RM Pieces Alloc USR
      * *     : PGM.*Synon (15,0) work field *
      * x2    : DB1.Consume Priority Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WSBMY1    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0042    MULT W0WB01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0048           Pieces Need USR
      * Weight Need
      * PAR.Weight Need USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Need USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0048    MULT WN0052    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0049           Weight Need USR
      * Pieces/Weight Scheduled
      * CASE: PAR.Pieces Need USR GT PAR.RM Pieces Avail USR
     C           WN0048    IFGT WN0038                     *IF
     C                     Z-ADDWN0038    WN0046           Pieces Schedule
     C                     Z-ADDWN0039    WN0047           Weight Schedule
     C                     SUB  WN0038    WN0040           RM Pieces Need
     C                     SUB  WN0039    WN0041           RM Weight Need
     C                     ELSE
      * CASE: PAR.Pieces Need USR LE PAR.RM Pieces Avail USR
     C           WN0048    IFLE WN0038                     *IF
     C                     Z-ADDWN0048    WN0046           Pieces Schedule
     C                     Z-ADDWN0049    WN0047           Weight Schedule
     C                     SUB  WN0048    WN0040           RM Pieces Need
     C                     SUB  WN0049    WN0041           RM Weight Need
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.RM Weight Need USR is Greater than zero
     C           WN0041    IFGT 0                          *IF
      * Process by Consume Priority % using Weight
      * CASE: DB1.Consume Priority % is Equal to 100 Pct
     C           WSBMY1    IFEQ 100                        *IF
     C                     Z-ADDWN0041    WN0049           Weight Need USR
      * Pieces Need
      * CASE: PAR.PS Avg Piece Wgt is GT Zero
     C           WN0052    IFGT 0                          *IF
      * Pieces Need USR
      * PAR.Pieces Need USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Need USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0049    DIV  WN0052    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0048           Pieces Need USR
     C                     END                             *FI
      * Pieces/Weight Scheduled
      * CASE: PAR.Weight Need USR GT PAR.RM Weight Avail USR
     C           WN0049    IFGT WN0039                     *IF
     C                     Z-ADDWN0038    WN0046           Pieces Schedule
     C                     Z-ADDWN0039    WN0047           Weight Schedule
     C                     SUB  WN0038    WN0040           RM Pieces Need
     C                     SUB  WN0039    WN0041           RM Weight Need
     C                     SUB  WN0038    WN0042           RM Pieces Alloc
     C                     SUB  WN0039    WN0043           RM Weight Alloc
     C                     ELSE
      * CASE: PAR.Weight Need USR LE PAR.RM Weight Avail USR
     C           WN0049    IFLE WN0039                     *IF
     C                     Z-ADDWN0048    WN0046           Pieces Schedule
     C                     Z-ADDWN0049    WN0047           Weight Schedule
     C                     SUB  WN0048    WN0040           RM Pieces Need
     C                     SUB  WN0049    WN0041           RM Weight Need
     C                     SUB  WN0048    WN0042           RM Pieces Alloc
     C                     SUB  WN0049    WN0043           RM Weight Alloc
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Consume Priority % is Not Equal to 100 PCt
     C           WSBMY1    IFNE 100                        *IF
      * Weight Need
      * PAR.Weight Need USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.RM Weight Alloc USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : DB1.Consume Priority Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WSBMY1    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0043    MULT W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0049           Weight Need USR
      * Pieces Need
      * CASE: PAR.PS Avg Piece Wgt is GT Zero
     C           WN0052    IFGT 0                          *IF
      * Pieces Need
      * PAR.Pieces Need USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.Weight Need USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0049    DIV  WN0052    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0048           Pieces Need USR
     C                     END                             *FI
      * Pieces/Weight Scheduled
      * CASE: PAR.Weight Need USR GT PAR.RM Weight Avail USR
     C           WN0049    IFGT WN0039                     *IF
     C                     Z-ADDWN0038    WN0046           Pieces Schedule
     C                     Z-ADDWN0039    WN0047           Weight Schedule
     C                     SUB  WN0038    WN0040           RM Pieces Need
     C                     SUB  WN0039    WN0041           RM Weight Need
     C                     ELSE
      * CASE: PAR.Weight Need USR LE PAR.RM Weight Avail USR
     C           WN0049    IFLE WN0039                     *IF
     C                     Z-ADDWN0048    WN0046           Pieces Schedule
     C                     Z-ADDWN0049    WN0047           Weight Schedule
     C                     SUB  WN0048    WN0040           RM Pieces Need
     C                     SUB  WN0049    WN0041           RM Weight Need
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WN0046    WN0050           Pieces Consumed
     C                     ADD  WN0047    WN0051           Weight Consumed
      * **UPDATE**
      * FP1054  use lcl.production warehouse
      * BPS Upd Pcs/Wgt Conv  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0021    WL0092           Company Number
     C                     MOVELWL0045    WL0093    P      Production Type
     C                     Z-ADDWL0044    WL0094           Production Date
     C                     Z-ADDWSC9NB    WL0095           Item Code
     C                     MOVELYL0020    WL0096    P      Warehouse Code
     C                     Z-ADDWN0046    WL0097           Pieces Schedule
     C                     Z-ADDWN0047    WL0098           Weight Schedule
     C                     Z-ADDWL0052    WL0099           Order Number
     C                     Z-ADDWL0053    WL0100           Order Sequence
     C                     Z-ADDWL0054    WL0101           Order Secondary
     C                     Z-ADDWSHGCD    WL0102           Item Code USR
     C                     EXSR SYRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Deallocate here:
     C                     Z-ADD*ZERO     WN0046           Pieces Schedule
     C                     Z-ADD*ZERO     WN0047           Weight Schedule
      * Rtv Order cnsmd wgt,pc RT - Order Detail Sched-Consmd  * 
     C                     EXSR THRVGN
     C           *ZERO     SUB  YL0028    WN0047           Weight Schedule
     C           *ZERO     SUB  YL0027    WN0046           Pieces Schedule
     C                     ADD  WN0046    WN0050           Pieces Consumed
     C                     ADD  WN0047    WN0051           Weight Consumed
      * **UPDATE**
      * FP1054  use lcl.production warehouse, acctng co
      * BPS Upd Pcs/Wgt Conv  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0021    WL0092           Company Number
     C                     MOVELWL0045    WL0093    P      Production Type
     C                     Z-ADDWL0044    WL0094           Production Date
     C                     Z-ADDWSC9NB    WL0095           Item Code
     C                     MOVELYL0020    WL0096    P      Warehouse Code
     C                     Z-ADDWN0046    WL0097           Pieces Schedule
     C                     Z-ADDWN0047    WL0098           Weight Schedule
     C                     Z-ADDWL0052    WL0099           Order Number
     C                     Z-ADDWL0053    WL0100           Order Sequence
     C                     Z-ADDWL0054    WL0101           Order Secondary
     C                     Z-ADDWSHGCD    WL0102           Item Code USR
     C                     EXSR SYRVGN
     C                     END                             *FI
     C                     END                             *FI
      * ** 06/24/2014 JJH E3160
      * ** Changed the definition of the "Average if WPA" field to "Upd
      * ** Standard Production".  Include Item Bill of Material records
      * ** with Upd Standard Production = Blank(yes).
      * Produced Item
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.BOM Type is Produced - Meat
      *   |- c2    : DB1.Production Yield is not equal to zeros
      *   |- c3    : DB1.Upd Standard Production is blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WSV2ST    IFEQ 'P'                        *IF
     C           WSBPPR    IFNE 0                          *IF
     C           WSYAST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * FP1054 RMC 5/14/09 Chg above CASE to ne 0 , it was GT 0
      * CASE: DB1.Component Item Code NE DB1.Item Code
     C           WSC9NB    IFNE WSHGCD                     *IF
      * RTV Pces/Bag/Unit Chil RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0103           Company Number
     C                     Z-ADDWSC9NB    WL0104           Item Code
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0105    YN0006    P      Description Lin
     C                     Z-ADDWL0106    YN0007           Unit Weight
     C                     Z-ADDWL0107    YN0008           Fresh Chilling
     C                     MOVELWL0108    YL0029    P      Piece Count Ite
     C                     Z-ADDWL0109    YN0009           Pieces Per Bag
     C                     Z-ADDWL0110    YN0010           Bags Per Unit
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWL0048    YL0029           Piece Count Ite
     C                     END                             *FI
      * Weight Scheduled
      * WRK.Copies 15.5           USR =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.Weight Consumed USR
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : DB1.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WSBPPR    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0051    MULT W0WB01    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WULXNX           Copies 15.5
      * 9/28/11 dont control rounding with +.005
      * 6/03/09   control rounding.. needed in case a number is like nnnn
      *   because we want it to round up
     C           WULXNX    MULT 1         WN0047    H      Weight Schedule
      * The number of Pieces Scheduled for a Produced Item is based
      * on the Piece Count Item sts of the Component Item Code.
      * Pieces Scheduled
      * CASE: LCL.Piece Count Item is yes
     C           YL0029    IFEQ 'Y'                        *IF
      * CHANGE LOG
     C                     EXSR UASUBR                     CHANGE LOG
      * 02/15/2010 PKD C000527 Added Adjust Credit Pieces logic.
      * CASE: LCL.Adjust Credit Pieces is No
     C           YL0022    IFEQ 'N'                        *IF
      * CASE: DB1.Item Code EQ DB1.Component Item Code
     C           WSHGCD    IFEQ WSC9NB                     *IF
      * * Converted Finished Goods *
     C                     Z-ADDWN0050    WN0046           Pieces Schedule
     C                     ELSE
      * CASE: *OTHERWISE
      * * Credit Items *
     C                     Z-ADD*ZERO     WN0046           Pieces Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * * Base Finished Goods *
     C                     Z-ADDWN0050    WN0046           Pieces Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0046           Pieces Schedule
     C                     END                             *FI
      * **UPDATE**
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0041    WL0111           Company Number
     C                     MOVELWL0045    WL0112    P      Production Type
     C                     Z-ADDWL0044    WL0113           Production Date
     C                     Z-ADDWSC9NB    WL0114           Item Code
     C                     MOVELWL0043    WL0115    P      Warehouse Code
     C                     Z-ADDWN0046    WL0116           Pieces Schedule
     C                     Z-ADDWN0047    WL0117           Weight Schedule
     C                     EXSR TJRVGN
     C                     END                             *FI
     C           KRSSS     READE@IOREGB                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Adj Credit Pieces RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0041    WTAIC3           Company Number
     C                     Z-ADDWL0042    WTHGCD           Item Code
      * Establish starting position
     C           KRSST     CHAIN@FDREAP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0022           Adjust Credit P
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTEOST    YL0022           Adjust Credit P
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0058    WJAIC3           Company Number
     C                     Z-ADDWL0059    WJHGCD           Item Code
      * Establish starting position
     C           KRSSU     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0060           Description Lin
     C                     MOVEL*BLANK    WL0061           UOM Primary
     C                     Z-ADD*ZERO     WL0062           Unit Weight
     C                     Z-ADD*ZERO     WL0063           Item Structure
     C                     Z-ADD*ZERO     WL0064           Item Structure
     C                     Z-ADD*ZERO     WL0065           Item Structure
     C                     MOVEL*BLANK    WL0066           Item Type Code
     C                     MOVEL*BLANK    WL0067           Default Warehou
     C                     Z-ADD*ZERO     WL0068           Fresh Chilling
     C                     MOVEL*BLANK    WL0069           Base_Conv_Loss
     C                     MOVEL*BLANK    WL0070           Variety_Rendere
     C                     MOVEL*BLANK    WL0071           Credit Item Sta
     C                     Z-ADD*ZERO     WL0072           Std Weight_Head
     C                     Z-ADD*ZERO     WL0073           Pieces Per Head
     C                     MOVEL*BLANK    WL0074           Department Code
     C                     MOVEL*BLANK    WL0075           Group for Packa
     C                     MOVEL*BLANK    WL0076           Seconds Item
     C                     MOVEL*BLANK    WL0077           Piece Count Ite
     C                     Z-ADD*ZERO     WL0078           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0079           Bags Per Unit
     C                     MOVEL*BLANK    WL0080           Export_Domestic
     C                     MOVEL*BLANK    WL0081           Print On Schedu
     C                     MOVEL*BLANK    WL0082           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0083           Fresh Sched As
     C                     MOVEL*BLANK    WL0084           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0085           Primal Group Co
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJAVNA    WL0060           Description Lin
     C                     MOVELWJADCD    WL0061           UOM Primary
     C                     Z-ADDWJAIWG    WL0062           Unit Weight
     C                     Z-ADDWJRINB    WL0063           Item Structure
     C                     Z-ADDWJRHNB    WL0064           Item Structure
     C                     Z-ADDWJRGNB    WL0065           Item Structure
     C                     MOVELWJN0CD    WL0066           Item Type Code
     C                     MOVELWJQ1CD    WL0067           Default Warehou
     C                     Z-ADDWJCHTM    WL0068           Fresh Chilling
     C                     MOVELWJQZCD    WL0069           Base_Conv_Loss
     C                     MOVELWJXWST    WL0070           Variety_Rendere
     C                     MOVELWJVMST    WL0071           Credit Item Sta
     C                     Z-ADDWJSWGH    WL0072           Std Weight_Head
     C                     Z-ADDWJPPHE    WL0073           Pieces Per Head
     C                     MOVELWJR3CD    WL0074           Department Code
     C                     MOVELWJSDCD    WL0075           Group for Packa
     C                     MOVELWJX5ST    WL0076           Seconds Item
     C                     MOVELWJPCCT    WL0077           Piece Count Ite
     C                     Z-ADDWJBDNB    WL0078           Pieces Per Bag
     C                     Z-ADDWJBJNB    WL0079           Bags Per Unit
     C                     MOVELWJSUST    WL0080           Export_Domestic
     C                     MOVELWJSVST    WL0081           Print On Schedu
     C                     MOVELWJSYST    WL0082           Fresh Inv Alloc
     C                     MOVELWJSZST    WL0083           Fresh Sched As
     C                     MOVELWJS1ST    WL0084           Frozen Inv Allo
     C                     MOVELWJXRCD    WL0085           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WVAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0086    WVAJCD           Warehouse Code
      * Establish starting position
     C           KRSSV     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0087           Warehouse Type
     C                     MOVEL*BLANK    WL0088           Trans Contol AS
     C                     MOVEL*BLANK    WL0089           Warehouse Locat
     C                     MOVEL*BLANK    WL0090           Warehouse Std C
     C                     Z-ADD*ZERO     WL0091           Warehouse Chill
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWVWPST    WL0087           Warehouse Type
     C                     MOVELWVXUST    WL0088           Trans Contol AS
     C                     MOVELWVT0ST    WL0089           Warehouse Locat
     C                     MOVELWVT1ST    WL0090           Warehouse Std C
     C                     Z-ADDWVDBNB    WL0091           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0060  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0061  70       PS Pieces Ship
     C                     MOVEL*BLANK    WN0062  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0063  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0064  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0065  92       Weight Producti
     C                     Z-ADD*ZERO     WN0066  70       Pieces Producti
     C                     Z-ADD*ZERO     WN0067 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0068 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0069  70       Pieces Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0052           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0060           PS Weight Ship
     C                     Z-ADD*ZERO     WN0061           PS Pieces Ship
     C                     Z-ADD*ZERO     WN0039           ATS Weight Avai
     C                     Z-ADD*ZERO     WN0038           ATS Pieces Avai
     C                     MOVEL*BLANK    WN0062           Piece Count Ite
     C                     Z-ADD*ZERO     WN0063           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0064           Bags Per Unit
     C                     Z-ADD*ZERO     WN0065           Weight Producti
     C                     Z-ADD*ZERO     WN0066           Pieces Producti
     C                     Z-ADD*ZERO     WN0067           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0068           OD Weight Sched
     C                     Z-ADD*ZERO     WN0069           Pieces Allocate
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMV5ST           Production Type
     C                     KFLD           WMELDT           Production Date
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDYL0021    WMAIC3           Company Number
     C                     MOVELWL0045    WMV5ST           Production Type
     C                     Z-ADDWL0044    WMELDT           Production Date
     C                     Z-ADDWSC9NB    WMHGCD           Item Code
     C                     MOVELYL0020    WMAJCD           Warehouse Code
      * Establish starting position
     C           KRSSW     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * so calc is: Production = Planned Prod + Standard + Prod Adj - Con
      *  instead of:
      * Production = Standard + Prod Adj - Converted
      * Prod Avail = Production + Ship Cut Adj + Ship Adj - Prod Alloc
      * CASE: DB1.PS Lock Status is NOT LOCKED
     C           WMB5ST    IFEQ 'N'                        *IF
      * Ship Cut Adjust
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Chilling Time USR is GT Zero
      *   |- c2    : DB1.Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0053    IFGT 0                          *IF
     C           WMELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
      * FP1054 06/02/06 add planned prod wt and pieces to Weight Prod & P
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Weight Planned Prod
      * +     : PGM.*Synon (15,2) work field
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whs Tfr Adj
     C           WMWTSP    ADD  WMDXWG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WMD1WG    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WMWTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WMGAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0065           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x5+ x1 + x2 - x3 - x4)
      * x5    : DB1.PS Pieces Planned Prod
      * +     : PGM.*Synon (15,0) work field
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whs Tfr Adj
     C           WMQTSP    ADD  WMB2NB    W0WJ03           *Synon (15,0) w
     C           W0WJ03    ADD  WMCBNB    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WMPSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WMBPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0066           Pieces Producti
      * Weight Available
      * PAR.ATS Weight Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Weight Production USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Shipping Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Prod Allocated
     C           WN0065    ADD  WN0060    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WMSAWT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WMOAWT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0039           ATS Weight Avai
      * Pieces Available
      * PAR.ATS Pieces Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Pieces Production USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * +     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Shipping Adj
      * -     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Prod Allocated
     C           WN0066    ADD  WN0061    W0WJ02           *Synon (15,0) w
     C           W0WJ02    ADD  WMB9NB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WMCDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0038           ATS Pieces Avai
      * Weight Avail E1971 RMC   2/27/12 change to leave pieces if > 0
      * CASE: PAR.ATS Weight Available USR is Less than zero
     C           WN0039    IFLT 0                          *IF
      * CASE: PAR.ATS Pieces Available USR is LE Zero
     C           WN0038    IFLE 0                          *IF
     C                     Z-ADD*ZERO     WN0039           ATS Weight Avai
     C                     Z-ADD*ZERO     WN0038           ATS Pieces Avai
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWMF8WG    WN0052           PS Avg Piece Wg
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQSX01           Company Number
     C           *LIKE     DEFN WWHGCD    WQSX02           Item Code
     C           *LIKE     DEFN WWAJCD    WQSX03           Warehouse Code
     C           *LIKE     DEFN WWELDT    WQSX04           Production Date
     C           *LIKE     DEFN WWV5ST    WQSX05           Production Type
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Item Code
     C                     KFLD           WQSX03           Warehouse Code
     C                     KFLD           WQSX04           Production Date
     C                     KFLD           WQSX05           Production Type
      * Setup key
     C                     Z-ADDWMAIC3    WQSX01           Company Number
     C                     Z-ADDWMHGCD    WQSX02           Item Code
     C                     MOVELWMAJCD    WQSX03           Warehouse Code
     C                     Z-ADDWMGPDT    WQSX04           Production Date
     C                     MOVEL'P'       WQSX05           Production Type
      * Establish starting position
     C           KRSSX     SETLL@I8CPXP                    *
     C           KRSSX     READE@I8CPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0060           PS Weight Ship
     C                     Z-ADD*ZERO     WN0061           PS Pieces Ship
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWWE0WG    WN0060           PS Weight Ship
     C                     Z-ADDWWD6NB    WN0061           PS Pieces Ship
     C           KRSSX     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Conv  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0070  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0071  70       PS Pieces Conve
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMV5ST           Production Type
     C                     KFLD           WMELDT           Production Date
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0092    WMAIC3           Company Number
     C                     MOVELWL0093    WMV5ST           Production Type
     C                     Z-ADDWL0094    WMELDT           Production Date
     C                     Z-ADDWL0095    WMHGCD           Item Code
     C                     MOVELWL0096    WMAJCD           Warehouse Code
      * Establish starting position
     C           KRSSY     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WMPSCV    ADD  WL0097    WN0071           PS Pieces Conve
     C           WMWTCN    ADD  WL0098    WN0070           PS Weight Conve
      * If weight OR pieces converted is LT 0 then make zero
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Converted is LT Zero
      *   |- c2    : PAR.PS Pieces Converted is LT Zeros
      *   '-
     C           WN0070    IFLT 0                          *IF
     C           WN0071    ORLT 0                          *OR
     C                     Z-ADD*ZERO     WN0070           PS Weight Conve
     C                     Z-ADD*ZERO     WN0071           PS Pieces Conve
     C                     END                             *FI
      * BPS Chg Pcs/Wgt Conv  CH - PS Prod Item Schedule  * 
     C                     EXSR SZCHRC
      * FP1054 create consumed records   -- 10/05/2020 WITH SHIPP CO ON O
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0099    IFGT 0                          *IF
      * WAS UPD WITH PAR.COMPANY NUMBER WHICH IS THE ACCTNG CO 10-05-2020
      * RTV Company for Ord   RT - Order Header TRG  * 
     C                     EXSR TARVGN
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
     C                     EXSR TBRVGN
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0024    IFEQ 0                          *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
     C                     EXSR TCRVGN
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Conv  CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0072  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0073  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0074  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0075  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0076  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0077  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0078  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0079  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0080  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0081  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0082  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0083  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0084  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0085  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0086  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0087  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0088  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0089  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0090  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0091  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0092  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0093 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0094  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0095 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0096  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0097 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0098  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0099 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0100  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0101 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0102  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0103 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0104  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0105  3        PS Item Id
     C                     MOVEL*BLANK    WN0106  2        Warehouse Type
     C                     MOVEL*BLANK    WN0107  1        PS Lock Status
     C                     MOVEL*BLANK    WN0108  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0109  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0110  1        PS Piece Count
     C                     MOVEL*BLANK    WN0111  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0112  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0113  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0114  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0115  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0116  3        PS Production W
     C                     Z-ADD*ZERO     WN0117  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0118  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0119  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0120  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0121  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0122  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0123  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0124  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0125  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0126  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0127  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0128  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0129  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0130  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0131  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0132  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0133  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0134  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0135  6        Department Code
     C                     Z-ADD*ZERO     WN0136  30       Item Structure
     C                     Z-ADD*ZERO     WN0137  30       Item Structure
     C                     Z-ADD*ZERO     WN0138  30       Item Structure
     C                     MOVEL*BLANK    WN0139  6        Primal Group Co
     C                     MOVEL*BLANK    WN0140  1        EDI Status 1
     C                     MOVEL*BLANK    WN0141  1        EDI Status 2
     C                     MOVEL*BLANK    WN0142  1        EDI Status 3
     C                     MOVEL*BLANK    WN0143  1        Record Status
     C                     Z-ADD*ZERO     WN0144  60       Job Time
     C                     MOVEL*BLANK    WN0145 10        User Id
     C                     MOVEL*BLANK    WN0146 10        Job Name
     C                     Z-ADD*ZERO     WN0147  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWMAIC3    WXAIC3           Company Number
     C                     MOVELWMV5ST    WXV5ST    P      Production Type
     C                     Z-ADDWMELDT    WXELDT           Production Date
     C                     Z-ADDWMHGCD    WXHGCD           Item Code
     C                     MOVELWMAJCD    WXAJCD    P      Warehouse Code
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXV5ST           Production Type
     C                     KFLD           WXELDT           Production Date
     C                     KFLD           WXHGCD           Item Code
     C                     KFLD           WXAJCD           Warehouse Code
     C           KLCHSZ    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0070    WXWTCN           PS Weight Conve
     C                     Z-ADDWN0071    WXPSCV           PS Pieces Conve
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WXAATM           Job Time
     C                     MOVEL##USR     WXAYNA           User Id
     C                     MOVEL##PGM     WXA0NA           Job Name
     C                     Z-ADD##JDT     WXAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Company for Ord   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBC4NB    WQTA01           Order Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Order Number
      * Setup key
     C                     Z-ADDWL0099    WQTA01           Order Number
      * Establish starting position
     C           KRSTA     SETLL@BFCPY2                    *
     C           KRSTA     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAIC3    YL0023           Company Number
     C           KRSTA     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0024           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYAIC3    WQTB01           Company Number
     C           *LIKE     DEFN WYC4NB    WQTB02           Order Number
     C           *LIKE     DEFN WYDPNB    WQTB03           Order Sequence
     C           *LIKE     DEFN WYUENB    WQTB04           Order Secondary
     C           *LIKE     DEFN WYJGDT    WQTB05           OD Production D
     C           *LIKE     DEFN WYNUDT    WQTB06           Consumed Item C
     C           *LIKE     DEFN WYHGCD    WQTB07           Item Code
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
     C                     KFLD           WQTB03           Order Sequence
     C                     KFLD           WQTB04           Order Secondary
     C                     KFLD           WQTB05           OD Production D
     C                     KFLD           WQTB06           Consumed Item C
     C                     KFLD           WQTB07           Item Code
      * Setup key
     C                     Z-ADDYL0023    WQTB01           Company Number
     C                     Z-ADDWL0099    WQTB02           Order Number
     C                     Z-ADDWL0100    WQTB03           Order Sequence
     C                     Z-ADDWL0101    WQTB04           Order Secondary
     C                     Z-ADDWMELDT    WQTB05           OD Production D
     C                     Z-ADDWL0095    WQTB06           Consumed Item C
     C                     Z-ADDWL0102    WQTB07           Item Code
      * Establish starting position
     C           KRSTB     SETLL@B6CPAG                    *
     C           KRSTB     READE@B6CPAG                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWYOONY    YL0024           ODS Sequence Nu
     C           KRSTB     READE@B6CPAG                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0024           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAAIC3    WQTC01           Company Number
     C           *LIKE     DEFN TAC4NB    WQTC02           Order Number
     C           *LIKE     DEFN TADPNB    WQTC03           Order Sequence
     C           *LIKE     DEFN TAUENB    WQTC04           Order Secondary
     C           *LIKE     DEFN TAJGDT    WQTC05           OD Production D
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Company Number
     C                     KFLD           WQTC02           Order Number
     C                     KFLD           WQTC03           Order Sequence
     C                     KFLD           WQTC04           Order Secondary
     C                     KFLD           WQTC05           OD Production D
      * Setup key
     C                     Z-ADDYL0023    WQTC01           Company Number
     C                     Z-ADDWL0099    WQTC02           Order Number
     C                     Z-ADDWL0100    WQTC03           Order Sequence
     C                     Z-ADDWL0101    WQTC04           Order Secondary
     C                     Z-ADDWMELDT    WQTC05           OD Production D
      * Establish starting position
     C           KRSTC     SETLL@B6CPNB                    *
     C           KRSTC     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDTAOONY    YL0024           ODS Sequence Nu
     C           KRSTC     READE@B6CPNB                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         YL0024           ODS Sequence Nu
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0148  1        EDI Status 1
     C                     MOVEL*BLANK    WN0149  1        EDI Status 2
     C                     MOVEL*BLANK    WN0150  1        EDI Status 3
     C                     MOVEL*BLANK    WN0151  1        Record Status
     C                     Z-ADD*ZERO     WN0152  60       Job Time
     C                     MOVEL*BLANK    WN0153 10        User Id
     C                     MOVEL*BLANK    WN0154 10        Job Name
     C                     Z-ADD*ZERO     WN0155  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAC4NB           Order Number
     C                     KFLD           TADPNB           Order Sequence
     C                     KFLD           TAUENB           Order Secondary
     C                     KFLD           TAJGDT           OD Production D
     C                     KFLD           TAOONY           ODS Sequence Nu
      * Setup key
     C                     Z-ADDYL0023    TAAIC3           Company Number
     C                     Z-ADDWL0099    TAC4NB           Order Number
     C                     Z-ADDWL0100    TADPNB           Order Sequence
     C                     Z-ADDWL0101    TAUENB           Order Secondary
     C                     Z-ADDWMELDT    TAJGDT           OD Production D
     C                     Z-ADDYL0024    TAOONY           ODS Sequence Nu
      * Establish starting position
     C           KRSTD     CHAIN@B6CPNB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3152' W0RTN   7
      * USER: Processing if Data record not found
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.OD Pieces Scheduled is Greater than zero
      *   |- c2    : PAR.OD Weight Scheduled is Greater than zero
      *   '-
     C           WL0097    IFGT 0                          *IF
     C           WL0098    ORGT 0                          *OR
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
     C                     EXSR TECRRC
     C                     END                             *FI
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           TAFLWG    ADD  WL0098    YL0025           OD Weight Sched
     C           TAIGQT    ADD  WL0097    YL0026           OD Qty/Cnsmd Pi
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.OD Pieces Scheduled is Less than or equal zero
      *   |- c2    : LCL.OD Weight Scheduled is Less than or equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0026    IFLE 0                          *IF
     C           YL0025    IFLE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
     C                     EXSR TFDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
     C                     EXSR TGCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPNA
     C                     Z-ADDYL0023    TBAIC3           Company Number
     C                     Z-ADDWL0099    TBC4NB           Order Number
     C                     Z-ADDWL0100    TBDPNB           Order Sequence
     C                     Z-ADDWL0101    TBUENB           Order Secondary
     C                     Z-ADDWMELDT    TBJGDT           OD Production D
     C                     Z-ADDYL0024    TBOONY           ODS Sequence Nu
     C                     Z-ADD*ZERO     TBAODT           Scheduled Ship
     C                     MOVELWMAJCD    TBAJCD           Warehouse Code
     C                     Z-ADDWL0095    TBNUDT           Consumed Item C
     C                     Z-ADDWL0102    TBHGCD           Item Code
     C                     Z-ADDWL0097    TBIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDWL0098    TBFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     TBNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     TBJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     TBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     TBBUTM           Deadline Depart
     C                     MOVELWN0148    TBUVST           EDI Status 1
     C                     MOVELWN0149    TBUWST           EDI Status 2
     C                     MOVELWN0150    TBUXST           EDI Status 3
     C                     MOVELWN0151    TBVSST           Record Status
     C                     Z-ADDWN0152    TBAATM           Job Time
     C                     MOVELWN0153    TBAYNA           User Id
     C                     MOVELWN0154    TBA0NA           Job Name
     C                     Z-ADDWN0155    TBAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TBVSST           Record Status
     C                     Z-ADD##JTM     TBAATM           Job Time
     C                     MOVEL##USR     TBAYNA           User Id
     C                     MOVEL##PGM     TBA0NA           Job Name
     C                     Z-ADD##JDT     TBAXDT           Job Date
     C           KLCRTE    KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBC4NB           Order Number
     C                     KFLD           TBDPNB           Order Sequence
     C                     KFLD           TBUENB           Order Secondary
     C                     KFLD           TBJGDT           OD Production D
     C                     KFLD           TBOONY           ODS Sequence Nu
      * Check for duplicate primary key
     C           KLCRTE    SETLL@B6CPNA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3153' W0RTN   7
      * Send message 'Order Detail Sched-Con EX'
     C                     MOVEL'USR3153' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPNA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFDLRC    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPNA
     C                     Z-ADDTAAIC3    TBAIC3           Company Number
     C                     Z-ADDTAC4NB    TBC4NB           Order Number
     C                     Z-ADDTADPNB    TBDPNB           Order Sequence
     C                     Z-ADDTAUENB    TBUENB           Order Secondary
     C                     Z-ADDTAJGDT    TBJGDT           OD Production D
     C                     Z-ADDTAOONY    TBOONY           ODS Sequence Nu
      *
     C           KLDLTF    KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBC4NB           Order Number
     C                     KFLD           TBDPNB           Order Sequence
     C                     KFLD           TBUENB           Order Secondary
     C                     KFLD           TBJGDT           OD Production D
     C                     KFLD           TBOONY           ODS Sequence Nu
     C           KLDLTF    CHAIN@B6CPNA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPNA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0156  1        EDI Status 1
     C                     MOVEL*BLANK    WN0157  1        EDI Status 2
     C                     MOVEL*BLANK    WN0158  1        EDI Status 3
     C                     MOVEL*BLANK    WN0159  1        Record Status
     C                     Z-ADD*ZERO     WN0160  60       Job Time
     C                     MOVEL*BLANK    WN0161 10        User Id
     C                     MOVEL*BLANK    WN0162 10        Job Name
     C                     Z-ADD*ZERO     WN0163  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B6CPNA
     C                     Z-ADDTAAIC3    TBAIC3           Company Number
     C                     Z-ADDTAC4NB    TBC4NB           Order Number
     C                     Z-ADDTADPNB    TBDPNB           Order Sequence
     C                     Z-ADDTAUENB    TBUENB           Order Secondary
     C                     Z-ADDTAJGDT    TBJGDT           OD Production D
     C                     Z-ADDTAOONY    TBOONY           ODS Sequence Nu
      *
     C           KLCHTG    KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBC4NB           Order Number
     C                     KFLD           TBDPNB           Order Sequence
     C                     KFLD           TBUENB           Order Secondary
     C                     KFLD           TBJGDT           OD Production D
     C                     KFLD           TBOONY           ODS Sequence Nu
     C           KLCHTG    CHAIN@B6CPNA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB61    YBRDCS
      * Move non-key fields to @B6CPNA
     C                     Z-ADD*ZERO     TBAODT           Scheduled Ship
     C                     MOVELWMAJCD    TBAJCD    P      Warehouse Code
     C                     Z-ADDWL0095    TBNUDT           Consumed Item C
     C                     Z-ADDWL0102    TBHGCD           Item Code
     C                     Z-ADDYL0026    TBIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADDYL0025    TBFLWG           OD Weight Sched
     C                     Z-ADDTANSQT    TBNSQT           ODS Quantity Sh
     C                     Z-ADDTAJQWG    TBJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     TBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     TBBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TBAATM           Job Time
     C                     MOVEL##USR     TBAYNA           User Id
     C                     MOVEL##JOB     TBA0NA           Job Name
     C                     Z-ADD##JDT     TBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B6CPNA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Order cnsmd wgt,pc RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0027           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     YL0028           OD Weight Sched
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYAIC3    WQTH01           Company Number
     C           *LIKE     DEFN WYC4NB    WQTH02           Order Number
     C           *LIKE     DEFN WYDPNB    WQTH03           Order Sequence
     C           *LIKE     DEFN WYUENB    WQTH04           Order Secondary
     C           *LIKE     DEFN WYJGDT    WQTH05           OD Production D
     C           *LIKE     DEFN WYNUDT    WQTH06           Consumed Item C
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WQTH02           Order Number
     C                     KFLD           WQTH03           Order Sequence
     C                     KFLD           WQTH04           Order Secondary
     C                     KFLD           WQTH05           OD Production D
     C                     KFLD           WQTH06           Consumed Item C
      * Setup key
     C                     Z-ADDWL0041    WQTH01           Company Number
     C                     Z-ADDWL0052    WQTH02           Order Number
     C                     Z-ADDWL0053    WQTH03           Order Sequence
     C                     Z-ADDWL0054    WQTH04           Order Secondary
     C                     Z-ADDWL0044    WQTH05           OD Production D
     C                     Z-ADDWSC9NB    WQTH06           Consumed Item C
      * Establish starting position
     C           KRSTH     SETLL@B6CPAG                    *
     C           KRSTH     READE@B6CPAG                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWYIGQT    YL0027           OD Qty/Cnsmd Pi
     C                     Z-ADDWYFLWG    YL0028           OD Weight Sched
     C           KRSTH     READE@B6CPAG                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV Pces/Bag/Unit Chil RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0103    WJAIC3           Company Number
     C                     Z-ADDWL0104    WJHGCD           Item Code
      * Establish starting position
     C           KRSTI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJAVNA    WL0105           Description Lin
     C                     Z-ADDWJAIWG    WL0106           Unit Weight
     C                     Z-ADDWJCHTM    WL0107           Fresh Chilling
     C                     MOVELWJPCCT    WL0108           Piece Count Ite
     C                     Z-ADDWJBDNB    WL0109           Pieces Per Bag
     C                     Z-ADDWJBJNB    WL0110           Bags Per Unit
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0164  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0165  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0166  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0167  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0168  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0169  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0170  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0171  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0172  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0173  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0174  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0175  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0176  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0177  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0178  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0179  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0180  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0181  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0182  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0183  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0184  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0185  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0186  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0187 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0188  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0189 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0190  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0191 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0192  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0193 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0194  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0195 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0196  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0197 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0198  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0199  3        PS Item Id
     C                     MOVEL*BLANK    WN0200  2        Warehouse Type
     C                     MOVEL*BLANK    WN0201  1        PS Lock Status
     C                     MOVEL*BLANK    WN0202  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0203  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0204  1        PS Piece Count
     C                     MOVEL*BLANK    WN0205  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0206  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0207  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0208  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0209  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0210  3        PS Production W
     C                     Z-ADD*ZERO     WN0211  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0212  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0213  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0214  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0215  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0216  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0217  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0218  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0219  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0220  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0221  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0222  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0223  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0224  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0225  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0226  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0227  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0228  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0229  6        Department Code
     C                     Z-ADD*ZERO     WN0230  30       Item Structure
     C                     Z-ADD*ZERO     WN0231  30       Item Structure
     C                     Z-ADD*ZERO     WN0232  30       Item Structure
     C                     MOVEL*BLANK    WN0233  6        Primal Group Co
     C                     MOVEL*BLANK    WN0234  1        EDI Status 1
     C                     MOVEL*BLANK    WN0235  1        EDI Status 2
     C                     MOVEL*BLANK    WN0236  1        EDI Status 3
     C                     MOVEL*BLANK    WN0237  1        Record Status
     C                     Z-ADD*ZERO     WN0238  60       Job Time
     C                     MOVEL*BLANK    WN0239 10        User Id
     C                     MOVEL*BLANK    WN0240 10        Job Name
     C                     Z-ADD*ZERO     WN0241  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMV5ST           Production Type
     C                     KFLD           WMELDT           Production Date
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0111    WMAIC3           Company Number
     C                     MOVELWL0112    WMV5ST           Production Type
     C                     Z-ADDWL0113    WMELDT           Production Date
     C                     Z-ADDWL0114    WMHGCD           Item Code
     C                     MOVELWL0115    WMAJCD           Warehouse Code
      * Establish starting position
     C           KRSTJ     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0117    WN0171           PS Weight Stand
     C                     Z-ADDWL0116    WN0172           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0172    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0171    DIV  WN0172    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0168           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0168    IFLT 0                          *IF
     C                     MULT -1        WN0168           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Standard is NE Zero
      *   |- c2    : PAR.PS Pieces Standard is NE Zeros
      *   '-
     C           WN0171    IFNE 0                          *IF
     C           WN0172    ORNE 0                          *OR
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
     C                     EXSR TKCRRC
     C                     END                             *FI
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WMDXWG    ADD  WL0117    WN0171           PS Weight Stand
     C           WMB2NB    ADD  WL0116    WN0172           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0172    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0171    DIV  WN0172    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0168           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0168    IFLT 0                          *IF
     C                     MULT -1        WN0168           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 RMC 5/14/09 dont do below case - they may be negative now
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
     C                     EXSR TMCHRC
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0111    WXAIC3           Company Number
     C                     MOVELWL0112    WXV5ST           Production Type
     C                     Z-ADDWL0113    WXELDT           Production Date
     C                     Z-ADDWL0114    WXHGCD           Item Code
     C                     MOVELWL0115    WXAJCD           Warehouse Code
     C                     Z-ADDWN0164    WXGPDT           PS Available Sh
     C                     Z-ADDWN0165    WXWTSP           PS Weight Plann
     C                     Z-ADDWN0166    WXQTSP           PS Pieces Plann
     C                     Z-ADDWN0167    WXDJPC           PS Pct of Carca
     C                     Z-ADDWN0168    WXF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0169    WXWTIN           PS Weight Inv O
     C                     Z-ADDWN0170    WXD5NB           PS Pieces Inv O
     C                     Z-ADDWN0171    WXDXWG           PS Weight Stand
     C                     Z-ADDWN0172    WXB2NB           PS Pieces Stand
     C                     Z-ADDWN0173    WXWTCN           PS Weight Conve
     C                     Z-ADDWN0174    WXPSCV           PS Pieces Conve
     C                     Z-ADDWN0175    WXSAWT           PS Weight Shipp
     C                     Z-ADDWN0176    WXB9NB           PS Pieces Shipp
     C                     Z-ADDWN0177    WXD1WG           PS Weight Prod
     C                     Z-ADDWN0178    WXCBNB           PS Pieces Prod
     C                     Z-ADDWN0179    WXEZWG           PS Weight Inv A
     C                     Z-ADDWN0180    WXCCNB           PS Pieces Inv A
     C                     Z-ADDWN0181    WXE0WG           PS Weight Ship
     C                     Z-ADDWN0182    WXD6NB           PS Pieces Ship
     C                     Z-ADDWN0183    WXOAWT           PS Weight Prod
     C                     Z-ADDWN0184    WXCDNB           PS Pieces Prod
     C                     Z-ADDWN0185    WXUNW2           PS Weight Inv A
     C                     Z-ADDWN0186    WXCENB           PS Pieces Inv A
     C                     Z-ADDWN0187    WXF9WG           PS Unit Weight
     C                     Z-ADDWN0188    WXBPNB           PS Pieces Whs T
     C                     Z-ADDWN0189    WXGAWG           PS Weight Whs T
     C                     Z-ADDWN0190    WXBQNB           PS Pieces Unuse
     C                     Z-ADDWN0191    WXGBWG           PS Weight Unuse
     C                     Z-ADDWN0192    WXBRNB           PS Pieces Unuse
     C                     Z-ADDWN0193    WXGCWG           PS Weight Unuse
     C                     Z-ADDWN0194    WXBSNB           PS Pieces Unuse
     C                     Z-ADDWN0195    WXGDWG           PS Weight Unuse
     C                     Z-ADDWN0196    WXBWNB           PS Pieces Unuse
     C                     Z-ADDWN0197    WXGEWG           PS Weight Unuse
     C                     Z-ADDWN0198    WXPS6U           PS Pieces Unuse
     C                     MOVELWN0199    WXWCST           PS Item Id
     C                     MOVELWN0200    WXWPST           Warehouse Type
     C                     MOVELWN0201    WXB5ST           PS Lock Status
     C                     MOVELWN0202    WXTFST           PS Export/Domes
     C                     MOVELWN0203    WXTEST           PS Print On Sch
     C                     MOVELWN0204    WXTHST           PS Piece Count
     C                     MOVELWN0205    WXUDST           PS Unused Sts 1
     C                     MOVELWN0206    WXUFST           PS Unused Sts 2
     C                     MOVELWN0207    WXUGST           PS Unused Sts 3
     C                     MOVELWN0208    WXUHST           PS Unused Sts 4
     C                     MOVELWN0209    WXB6ST           PS Item Sched N
     C                     MOVELWN0210    WXB7ST           PS Production W
     C                     Z-ADDWN0211    WXDVWG           PS Weight Order
     C                     Z-ADDWN0212    WXD7NB           PS Pieces Order
     C                     Z-ADDWN0213    WXFCAD           PS Weight FC Ad
     C                     Z-ADDWN0214    WXD9NB           PS Pieces FC Ad
     C                     Z-ADDWN0215    WXDWWG           PS Weight FX Ad
     C                     Z-ADDWN0216    WXEANB           PS Pieces FX Ad
     C                     Z-ADDWN0217    WXSHWT           PS Weight Sched
     C                     Z-ADDWN0218    WXEBNB           PS Pieces Sched
     C                     Z-ADDWN0219    WXAVWT           PS Weight Avail
     C                     Z-ADDWN0220    WXECNB           PS Pieces Avail
     C                     Z-ADDWN0221    WXWTON           PS Weight Produ
     C                     Z-ADDWN0222    WXEDNB           PS Pieces Produ
     C                     Z-ADDWN0223    WXFNWT           PS Weight Fab N
     C                     Z-ADDWN0224    WXEENB           PS Pieces Fab N
     C                     Z-ADDWN0225    WXQTAS           PS Weight Sched
     C                     Z-ADDWN0226    WXEFNB           PS Pieces Sched
     C                     Z-ADDWN0227    WXWAIO           PS Weight Sched
     C                     Z-ADDWN0228    WXEGNB           PS Pieces Sched
     C                     MOVELWN0229    WXR3CD           Department Code
     C                     Z-ADDWN0230    WXRGNB           Item Structure
     C                     Z-ADDWN0231    WXRHNB           Item Structure
     C                     Z-ADDWN0232    WXRINB           Item Structure
     C                     MOVELWN0233    WXXRCD           Primal Group Co
     C                     MOVELWN0234    WXUVST           EDI Status 1
     C                     MOVELWN0235    WXUWST           EDI Status 2
     C                     MOVELWN0236    WXUXST           EDI Status 3
     C                     MOVELWN0237    WXVSST           Record Status
     C                     Z-ADDWN0238    WXAATM           Job Time
     C                     MOVELWN0239    WXAYNA           User Id
     C                     MOVELWN0240    WXA0NA           Job Name
     C                     Z-ADDWN0241    WXAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0242 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0058           Company Number
     C                     Z-ADDWXHGCD    WL0059           Item Code
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    WUAVNA    P      Description Lin
     C                     MOVELWL0061    WUADCD    P      UOM Primary
     C                     Z-ADDWL0062    WUAIWG           Unit Weight
     C                     Z-ADDWL0063    WXRINB           Item Structure
     C                     Z-ADDWL0064    WXRHNB           Item Structure
     C                     Z-ADDWL0065    WXRGNB           Item Structure
     C                     MOVELWL0066    WUN0CD    P      Item Type Code
     C                     MOVELWL0067    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0068    WUCHTM           Fresh Chilling
     C                     MOVELWL0069    WUQZCD    P      Base_Conv_Loss
     C                     MOVELWL0070    WUXWST    P      Variety_Rendere
     C                     MOVELWL0071    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0072    WUSWGH           Std Weight_Head
     C                     Z-ADDWL0073    WUPPHE           Pieces Per Head
     C                     MOVELWL0074    WXR3CD    P      Department Code
     C                     MOVELWL0075    WUSDCD    P      Group for Packa
     C                     MOVELWL0076    WUX5ST    P      Seconds Item
     C                     MOVELWL0077    WXTHST    P      Piece Count Ite
     C                     Z-ADDWL0078    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0079    WUBJNB           Bags Per Unit
     C                     MOVELWL0080    WXTFST    P      Export_Domestic
     C                     MOVELWL0081    WXTEST    P      Print On Schedu
     C                     MOVELWL0082    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0083    WUSZST    P      Fresh Sched As
     C                     MOVELWL0084    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0085    WXXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWXAJCD    WL0086    P      Warehouse Code
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0087    WXWPST    P      Warehouse Type
     C                     MOVELWL0088    WUXUST    P      Trans Contol AS
     C                     MOVELWL0089    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0090    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0091    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WXWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WXWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WXWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWXAJCD    WL0001    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WXB7ST    P      Production Ware
     C                     Z-ADDWL0003    YL0030           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0118           Company Number
     C                     Z-ADDWL0113    WL0119           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0120           Fresh Chilling
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0121    WXGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWXAIC3    WL0118           Company Number
     C                     Z-ADDWL0113    WL0119           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0120           Fresh Chilling
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0121    WXGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WN0166    IFGT 0                          *IF
     C           WN0165    DIV  WN0166    WXF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WXVSST           Record Status
     C                     Z-ADD##JTM     WXAATM           Job Time
     C                     MOVEL##USR     WXAYNA           User Id
     C                     MOVEL##PGM     WXA0NA           Job Name
     C                     Z-ADD##JDT     WXAXDT           Job Date
     C                     MOVEL'N'       WXB5ST           PS Lock Status
     C           KLCRTK    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXV5ST           Production Type
     C                     KFLD           WXELDT           Production Date
     C                     KFLD           WXHGCD           Item Code
     C                     KFLD           WXAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRTK    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQTL01           Company Number
      * Define keylist
     C           KPSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WHBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
      * Setup key
     C                     Z-ADDWL0118    WQTL01           Company Number
     C                     Z-ADDWL0119    WHBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTL     SETLL@AFREBE                    *
     C           KRSTL     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0120                     *IF
     C                     Z-ADDWHBCDT    WL0121           PS Available Sh
     C                     GOTO TLEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WHA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSTL     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0243  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0244  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0245  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0246  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0247  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0248  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0249  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0250  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0251  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0252  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0253  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0254  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0255  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0256  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0257  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0258  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0259  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0260  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0261  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0262  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0263 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0264  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0265 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0266  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0267 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0268  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0269 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0270  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0271 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0272  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0273 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0274  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0275  3        PS Item Id
     C                     MOVEL*BLANK    WN0276  2        Warehouse Type
     C                     MOVEL*BLANK    WN0277  1        PS Lock Status
     C                     MOVEL*BLANK    WN0278  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0279  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0280  1        PS Piece Count
     C                     MOVEL*BLANK    WN0281  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0282  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0283  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0284  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0285  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0286  3        PS Production W
     C                     Z-ADD*ZERO     WN0287  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0288  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0289  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0290  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0291  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0292  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0293  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0294  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0295  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0296  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0297  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0298  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0299  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0300  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0301  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0302  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0303  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0304  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0305  6        Department Code
     C                     Z-ADD*ZERO     WN0306  30       Item Structure
     C                     Z-ADD*ZERO     WN0307  30       Item Structure
     C                     Z-ADD*ZERO     WN0308  30       Item Structure
     C                     MOVEL*BLANK    WN0309  6        Primal Group Co
     C                     MOVEL*BLANK    WN0310  1        EDI Status 1
     C                     MOVEL*BLANK    WN0311  1        EDI Status 2
     C                     MOVEL*BLANK    WN0312  1        EDI Status 3
     C                     MOVEL*BLANK    WN0313  1        Record Status
     C                     Z-ADD*ZERO     WN0314  60       Job Time
     C                     MOVEL*BLANK    WN0315 10        User Id
     C                     MOVEL*BLANK    WN0316 10        Job Name
     C                     Z-ADD*ZERO     WN0317  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWMAIC3    WXAIC3           Company Number
     C                     MOVELWMV5ST    WXV5ST    P      Production Type
     C                     Z-ADDWMELDT    WXELDT           Production Date
     C                     Z-ADDWMHGCD    WXHGCD           Item Code
     C                     MOVELWMAJCD    WXAJCD    P      Warehouse Code
      *
     C           KLCHTM    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXV5ST           Production Type
     C                     KFLD           WXELDT           Production Date
     C                     KFLD           WXHGCD           Item Code
     C                     KFLD           WXAJCD           Warehouse Code
     C           KLCHTM    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YCRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0168    WXF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0171    WXDXWG           PS Weight Stand
     C                     Z-ADDWN0172    WXB2NB           PS Pieces Stand
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Clc Date (descending) RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN TCAIC3    WQTN01           Company Number
      * Define keylist
     C           KPSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           TCBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Company Number
      * Setup key
     C                     Z-ADDWL0122    WQTN01           Company Number
     C                     Z-ADDWL0123    TCBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTN     SETLL@AFREPU                    *
     C           KRSTN     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0123    IFEQ TCBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0126                     *IF
     C                     Z-ADDTCBCDT    WL0124           *Date1 (ending)
     C                     GOTO TNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTN     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Clc Date (ascending)  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQTO01           Company Number
      * Define keylist
     C           KPSTO     KLIST
     C                     KFLD           WQTO01           Company Number
     C                     KFLD           WIBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Company Number
      * Setup key
     C                     Z-ADDWL0127    WQTO01           Company Number
     C                     Z-ADDWL0128    WIBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTO     SETLL@AFREYY                    *
     C           KRSTO     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0128    IFEQ WIBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0131                     *IF
     C                     Z-ADDWIBCDT    WL0129           *Date1 (ending)
     C                     GOTO TOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTO     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * CHANGE LOG
      *================================================================
      * S00965 PKD 10/14/09 Pieces scheduled needs to be reduced if
      *                     the yield is negative.
      * C000527 PKD 02/12/09 When we have a negative yield, only the weig
      *                      needs to be adjusted and not the pieces.
      * C000527 PKD 02/12/09 The Pieces should not be adjusted at all.
      *                      Added Adjust Credit Pieces logig.
      *                      * Business Rule *
      *                      If an Item is converted from a Base Boneless
      *                      Loin, then do not adjust the Pieces of the
      *                      Credit Items.  Only the Weight needs to be
      *                      adjusted.  The Pieces of the Tenderloins and
      *                      Sirloins, for example, were already produced
      *                      when the Base Boneless Loin was produced in
      *                      the Standard Mix.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAOQNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WAORNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WAS2DT           CIE Unused Date
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WCCQNB           Julian Date
     C                     Z-ADD*ZERO     WCESNB           Accounting Year
     C                     Z-ADD*ZERO     WCETNB           Accounting Peri
     C                     Z-ADD*ZERO     WCBZNB           OM Week
     C                     Z-ADD*ZERO     WCEINB           Week Number
     C                     Z-ADD*ZERO     WCAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WCOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WCNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WCNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WCOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WCOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WECFC7           Order Group Cod
     C                     Z-ADD*ZERO     WEMAVA           Billing Detail
     C                     Z-ADD*ZERO     WEKDVA           Billing Detail
     C                     Z-ADD*ZERO     WEL8VA           Billing Detail
     C                     Z-ADD*ZERO     WEL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WEEXDT           Market Pricing
     C                     Z-ADD*ZERO     WEBZPR           Price Overage O
     C                     Z-ADD*ZERO     WEL6NB           Contract Number
     C                     Z-ADD*ZERO     WEGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WEAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WED0WG           Weight Ordered
     C                     Z-ADD*ZERO     WECCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WECBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WEATWG           Weight Shipped
     C                     Z-ADD*ZERO     WEAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAKPR           Unit Price
     C                     Z-ADD*ZERO     WEALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WEAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WEAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WEA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WEB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WEA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WENTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WENUDT           Consumed Item C
     C                     Z-ADD*ZERO     WENVDT           Deadline Depart
     C                     Z-ADD*ZERO     WENWDT           OD Price Type R
     C                     Z-ADD*ZERO     WENXDT           OD Firm Date
     C                     Z-ADD*ZERO     WEBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WEBVTM           Price Code
     C                     Z-ADD*ZERO     WEBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WEBXTM           Substitution Li
     C                     Z-ADD*ZERO     WEBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WEH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WEH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WEH7NX           OD Item Target
     C                     Z-ADD*ZERO     WEH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WEH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WEDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WEDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WEDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WEDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WEDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WEGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WEGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WEGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WEPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WERINY           Item Age Days
     C                     Z-ADD*ZERO     WETIDT           Production Ovr
     C                     Z-ADD*ZERO     WETJDT           Production Ovr
     C                     Z-ADD*ZERO     WETKDT           OD Market Begin
     C                     Z-ADD*ZERO     WETLDT           OD Market Endin
     C                     Z-ADD*ZERO     WETMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WFBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WFBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WFBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WFBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field System Value Alpha
     C                     MOVEL*BLANK    WUBXTX 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGM8NB           System Value Nu
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAIWG           Unit Weight
     C                     Z-ADD*ZERO     WJCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WJC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WJURTN           Number Cases On
     C                     Z-ADD*ZERO     WJAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJTFNB           Transportation
     C                     Z-ADD*ZERO     WJTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WJTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WJBLPR           Market Overage
     C                     Z-ADD*ZERO     WJBMPR           Standard Overag
     C                     Z-ADD*ZERO     WJCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WJCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WJSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WJPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WJICN1           Item Category N
     C                     Z-ADD*ZERO     WJICN2           Item Category N
     C                     Z-ADD*ZERO     WJV2NB           Item Category N
     C                     Z-ADD*ZERO     WJITCN           Item Category N
     C                     Z-ADD*ZERO     WJITC5           Item Category N
     C                     Z-ADD*ZERO     WJICN6           Item Category N
     C                     Z-ADD*ZERO     WJICN7           Item Category N
     C                     Z-ADD*ZERO     WJICN8           Item Category N
     C                     Z-ADD*ZERO     WJICN9           Item Category N
     C                     Z-ADD*ZERO     WJICN0           Item Category N
     C                     Z-ADD*ZERO     WJSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WJA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WJSJNB           Production Lead
     C                     Z-ADD*ZERO     WJSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WJSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WJSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WJCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WJCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WJILNB           Packages per ca
     C                     Z-ADD*ZERO     WJCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WJCINB           PM Batch Size
     C                     Z-ADD*ZERO     WJCJNB           Package Level s
     C                     Z-ADD*ZERO     WJCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WJCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WJCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WJCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WJCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WJCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WJCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WJCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WJC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WJB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WJB5NB           PM Line Number
     C                     Z-ADD*ZERO     WJBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WJBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WJF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WJF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WJF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WJBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WJBNNB           Production Qty
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKY6NY           PS Max Qty per
     C                     Z-ADD*ZERO     WKVKDT           PS Prod Capacit
     C                     Z-ADD*ZERO     WKY7NY           PS Prod Capacit
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLELDT           Production Date
     C                     Z-ADD*ZERO     WLHVHD           Hog Volume
     C                     Z-ADD*ZERO     WLZ6NB           Average Live We
     C                     Z-ADD*ZERO     WLZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WLDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WLAVCW           Average Cold We
     C                     Z-ADD*ZERO     WLDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WLZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WLAVLE           Average Loin Ey
     C                     Z-ADD*ZERO     WLECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMELDT           Production Date
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WMWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WMQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WMDJPC           PS Pct of Carca
     C                     Z-ADD*ZERO     WMF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WMWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WMD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WMDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WMB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WMWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WMPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WMSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WMB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WMD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WMCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WMEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WMCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WME0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WMD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WMOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WMCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WMUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WMCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WMF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WMBPNB           PS Pieces Whs T
     C                     Z-ADD*ZERO     WMGAWG           PS Weight Whs T
     C                     Z-ADD*ZERO     WMBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WMGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WMBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WMGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WMBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WMGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WMBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WMGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WMPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WMDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WMD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WMFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WMD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WMDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WMEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WMSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WMEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WMAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WMECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WMWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WMEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WMFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WMEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WMQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WMEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WMWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WMEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Weight Production USR
     C                     Z-ADD*ZERO     WUFUWG  92
      * Define work field Production Qty
     C                     Z-ADD*ZERO     WUT8NX  70
      * Define work field Pieces Production USR
     C                     Z-ADD*ZERO     WUERNB  70
      * Define work field Piece Count Item
     C                     MOVEL*BLANK    WUPCCT  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRHGCD           Item Code
     C                     Z-ADD*ZERO     WRC9NB           Component Item
     C                     Z-ADD*ZERO     WRBOPR           Sales Yield
     C                     Z-ADD*ZERO     WRBPPR           Production Yiel
     C                     Z-ADD*ZERO     WRHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WRCNSM           Consume Priorit
     C                     Z-ADD*ZERO     WRBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WRBMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WRIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WRIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Copies 15.5           USR
     C                     Z-ADD*ZERO     WULXNX 155
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field UOM Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety_Rendered_Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight_Head_Var_Ren
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export_Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field PS Item Id
     C                     MOVEL*BLANK    WUWCST  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYC4NB           Order Number
     C                     Z-ADD*ZERO     WYDPNB           Order Sequence
     C                     Z-ADD*ZERO     WYUENB           Order Secondary
     C                     Z-ADD*ZERO     WYJGDT           OD Production D
     C                     Z-ADD*ZERO     WYOONY           ODS Sequence Nu
     C                     Z-ADD*ZERO     WYAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WYNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WYHGCD           Item Code
     C                     Z-ADD*ZERO     WYIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WYFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WYNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     WYJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WYNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WYBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ03 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
     C                     Z-ADD*ZERO     WL0003  30
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006  1
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     MOVEL*BLANK    WL0013  2
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  50
     C                     MOVEL*BLANK    WL0016  6
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  1
     C                     Z-ADD*ZERO     WL0019  70
     C                     MOVEL*BLANK    WL0020  1
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     MOVEL*BLANK    WL0022  1
     C                     Z-ADD*ZERO     WL0023  70
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025  92
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  3
     C                     Z-ADD*ZERO     WL0028  70
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0029  30
     C                     MOVEL*BLANK    WL0030  6
     C                     MOVEL*BLANK    WL0031  1
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  92
     C                     Z-ADD*ZERO     WL0034  70
     C                     MOVEL*BLANK    WL0035  3
     C                     Z-ADD*ZERO     WL0036  70
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  52
     C                     MOVEL*BLANK    WL0040  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0041  30
     C                     Z-ADD*ZERO     WL0042  70
     C                     MOVEL*BLANK    WL0043  3
     C                     Z-ADD*ZERO     WL0044  70
     C                     MOVEL*BLANK    WL0045  1
     C                     MOVEL*BLANK    WL0046  2
     C                     Z-ADD*ZERO     WL0047  52
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  2
     C                     MOVEL*BLANK    WL0050  1
     C                     Z-ADD*ZERO     WL0051  52
     C                     Z-ADD*ZERO     WL0052  70
     C                     Z-ADD*ZERO     WL0053  30
     C                     Z-ADD*ZERO     WL0054  30
     C                     MOVEL*BLANK    WL0055  2
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057 112
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0058  30
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060 30
     C                     MOVEL*BLANK    WL0061  2
     C                     Z-ADD*ZERO     WL0062 112
     C                     Z-ADD*ZERO     WL0063  30
     C                     Z-ADD*ZERO     WL0064  30
     C                     Z-ADD*ZERO     WL0065  30
     C                     MOVEL*BLANK    WL0066  3
     C                     MOVEL*BLANK    WL0067  3
     C                     Z-ADD*ZERO     WL0068  52
     C                     MOVEL*BLANK    WL0069  2
     C                     MOVEL*BLANK    WL0070  1
     C                     MOVEL*BLANK    WL0071  1
     C                     Z-ADD*ZERO     WL0072 112
     C                     Z-ADD*ZERO     WL0073  70
     C                     MOVEL*BLANK    WL0074  6
     C                     MOVEL*BLANK    WL0075  1
     C                     MOVEL*BLANK    WL0076  1
     C                     MOVEL*BLANK    WL0077  1
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  70
     C                     MOVEL*BLANK    WL0080  1
     C                     MOVEL*BLANK    WL0081  1
     C                     MOVEL*BLANK    WL0082  1
     C                     MOVEL*BLANK    WL0083  1
     C                     MOVEL*BLANK    WL0084  1
     C                     MOVEL*BLANK    WL0085  6
      * Define local variables for subroutine SVRVGN.
     C                     MOVEL*BLANK    WL0086  3
     C                     MOVEL*BLANK    WL0087  2
     C                     MOVEL*BLANK    WL0088  1
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     Z-ADD*ZERO     WL0091  52
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0092  30
     C                     MOVEL*BLANK    WL0093  1
     C                     Z-ADD*ZERO     WL0094  70
     C                     Z-ADD*ZERO     WL0095  70
     C                     MOVEL*BLANK    WL0096  3
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098 112
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100  30
     C                     Z-ADD*ZERO     WL0101  30
     C                     Z-ADD*ZERO     WL0102  70
      * Define local variables for subroutine TIRVGN.
     C                     Z-ADD*ZERO     WL0103  30
     C                     Z-ADD*ZERO     WL0104  70
     C                     MOVEL*BLANK    WL0105 30
     C                     Z-ADD*ZERO     WL0106 112
     C                     Z-ADD*ZERO     WL0107  52
     C                     MOVEL*BLANK    WL0108  1
     C                     Z-ADD*ZERO     WL0109  70
     C                     Z-ADD*ZERO     WL0110  70
      * Define local variables for subroutine TJRVGN.
     C                     Z-ADD*ZERO     WL0111  30
     C                     MOVEL*BLANK    WL0112  1
     C                     Z-ADD*ZERO     WL0113  70
     C                     Z-ADD*ZERO     WL0114  70
     C                     MOVEL*BLANK    WL0115  3
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117 112
      * Define local variables for subroutine TLRVGN.
     C                     Z-ADD*ZERO     WL0118  30
     C                     Z-ADD*ZERO     WL0119  70
     C                     Z-ADD*ZERO     WL0120  52
     C                     Z-ADD*ZERO     WL0121  70
      * Define local variables for subroutine TNRVGN.
     C                     Z-ADD*ZERO     WL0122  30
     C                     Z-ADD*ZERO     WL0123  70
     C                     Z-ADD*ZERO     WL0124  70
     C                     Z-ADD*ZERO     WL0125  70
     C                     Z-ADD*ZERO     WL0126  80
      * Define local variables for subroutine TORVGN.
     C                     Z-ADD*ZERO     WL0127  30
     C                     Z-ADD*ZERO     WL0128  70
     C                     Z-ADD*ZERO     WL0129  70
     C                     Z-ADD*ZERO     WL0130  70
     C                     Z-ADD*ZERO     WL0131  80
      * Define local work field Date From             USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Allocation Method
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field OD Price Type
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0008  30
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Production Day Status USR
     C                     MOVEL*BLANK    YL0010  1
      * Define null work field Accounting Period Code
     C                     Z-ADD*ZERO     YN0001  20
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0011  1
      * Define null work field Week Number
     C                     Z-ADD*ZERO     YN0002  20
      * Define local work field Production Qty Limit USR
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field PS Max Qty per Day
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Weight Production USR
     C                     Z-ADD*ZERO     YL0014  92
      * Define local work field Pieces Production USR
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field PS Production Warehouse
     C                     MOVEL*BLANK    YL0016  3
      * Define local work field Production Qty
     C                     Z-ADD*ZERO     YL0017  70
      * Define null work field Description Line One
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field UOM Primary
     C                     MOVEL*BLANK    YN0004  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0005 112
      * Define local work field Available Production
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Percent Available for ord
     C                     Z-ADD*ZERO     YL0019  52
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0021  30
      * Define local work field Adjust Credit Pieces
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0023  30
      * Define local work field ODS Sequence Number
     C                     Z-ADD*ZERO     YL0024  30
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0025 112
      * Define local work field OD Qty/Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0026 112
      * Define local work field OD Qty/Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0028 112
      * Define null work field Description Line One
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0007 112
      * Define null work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YN0008  52
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0029  1
      * Define null work field Pieces Per Bag
     C                     Z-ADD*ZERO     YN0009  70
      * Define null work field Bags Per Unit
     C                     Z-ADD*ZERO     YN0010  70
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0030  30
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field Production Date RGT
     C                     Z-ADD*ZERO     YL0033  70
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 SCHASORD
00002 FRZTRMPROD
