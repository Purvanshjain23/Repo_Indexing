     H/TITLE EDT Load Header        E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPJAKH
     H* Date          : 08/21/24  Time  : 03:26:04
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDCIE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Load Header        E1 Edit record(1 screen)
      *
     FOMFJCPL0IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Load Header               Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier Info              Retrieval index
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size new            Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FCAACREL2IF  E           K        DISK
      * RTV : State Master              Active only
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State Master              Retrieval index       NV
      *
     FPMAMREL2IF  E           K        DISK
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPNHAREL1IF  E           K        DISK
      * RTV : Country EXT               Retrieval index
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier Info              Active records
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse Codes           ShipCo/Warehouse
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FPOCKREL1IF  E           K        DISK
      * RTV : Carrier Insurance         Retrieval index
      *
     FPOCJREL0IF  E           K        DISK
      * RTV : Insurance Type            Retrieval index
      *
     FPDLYREL1IF  E           K        DISK
      * RTV : Trailer Master            Retrieval index
      *
     FOMFJCPMOIF  E           K        DISK
      * RSQ : Load Header               Trailer/Carrier/Load
      *
     FPMAMRELNIF  E           K        DISK
      * RSQ : Order Header Extension    ShipLine/Container/Load
      *
     FOMFJCPLKIF  E           K        DISK
      * RSQ : Load Header               Carrier/Trailer
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : Order Header TRG          Load(Desc) not bl
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPMAMREL0UF  E           K        DISK
      * UPD : Order Header Extension    Update index
      *
     FPDLYREL0UF  E           K        DISK                      A
      * UPD : Trailer Master            Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   1 001  5 0A
     E                    W0END   1 001  5 0A
     E                    W0NAM   1 001 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 037  5 0A
     E                    W1END   7 037  5 0A
     E                    W1NAM   7 037 10
      * Long constants
     E                    @CN#    1  08  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@ACREAH
      * State Master              Retrieval index       NV
      * Renamed input format fields
     I              ACBGCD                          WBBGCD
     I              ACAUNA                          WBAUNA
     I              ACUVST                          WBUVST
     I              ACUWST                          WBUWST
     I              ACUXST                          WBUXST
     I              ACVSST                          WBVSST
     I              ACAATM                          WBAATM
     I              ACAYNA                          WBAYNA
     I              ACA0NA                          WBA0NA
     I              ACAXDT                          WBAXDT
      *
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@FFREUG
      * Carrier Info              Active records
      * Renamed input format fields
     I              FFBZNA                          WEBZNA
     I              FFADTX                          WEADTX
     I              FFACNA                          WEACNA
     I              FFADNA                          WEADNA
     I              FFAENA                          WEAENA
     I              FFAJNA                          WEAJNA
     I              FFBTTX                          WEBTTX
     I              FFEZNB                          WEEZNB
     I              FFBGCD                          WEBGCD
     I              FFEEDT                          WEEEDT
     I              FFDUTX                          WEDUTX
     I              FFNRVA                          WENRVA
     I              FFNSVA                          WENSVA
     I              FFNTVA                          WENTVA
     I              FFNUVA                          WENUVA
     I              FFP1ST                          WEP1ST
     I              FFDVTX                          WEDVTX
     I              FFDWTX                          WEDWTX
     I              FFLVCD                          WELVCD
     I              FFS8NB                          WES8NB
     I              FFS9NB                          WES9NB
     I              FFNMVA                          WENMVA
     I              FFNOVA                          WENOVA
     I              FFNPVA                          WENPVA
     I              FFNQVA                          WENQVA
     I              FFMFCD                          WEMFCD
     I              FFQXNB                          WEQXNB
     I              FFQ1NB                          WEQ1NB
     I              FFMRNG                          WEMRNG
     I              FFMRNE                          WEMRNE
     I              FFRFNB                          WERFNB
     I              FFMREG                          WEMREG
     I              FFBQPR                          WEBQPR
     I              FFBRPR                          WEBRPR
     I              FFBSPR                          WEBSPR
     I              FFBTPR                          WEBTPR
     I              FFBUPR                          WEBUPR
     I              FFBVPR                          WEBVPR
     I              FFDJWG                          WEDJWG
     I              FFDKWG                          WEDKWG
     I              FFDLWG                          WEDLWG
     I              FFDMWG                          WEDMWG
     I              FFDNWG                          WEDNWG
     I              FFDOWG                          WEDOWG
     I              FFB2PR                          WEB2PR
     I              FFB3PR                          WEB3PR
     I              FFB4PR                          WEB4PR
     I              FFB5PR                          WEB5PR
     I              FFB6PR                          WEB6PR
     I              FFB7PR                          WEB7PR
     I              FFAAC7                          WEAAC7
     I              FFCOFI                          WECOFI
     I              FFK6TX                          WEK6TX
     I              FFOCNA                          WEOCNA
     I              FFODNA                          WEODNA
     I              FFW7CD                          WEW7CD
     I              FFK7TX                          WEK7TX
     I              FFTENO                          WETENO
     I              FFK8TX                          WEK8TX
     I              FFAOFC                          WEAOFC
     I              FFAOLI                          WEAOLI
     I              FFKHDT                          WEKHDT
     I              FFUNUS                          WEUNUS
     I              FFUNU2                          WEUNU2
     I              FFUNU3                          WEUNU3
     I              FFUVST                          WEUVST
     I              FFUWST                          WEUWST
     I              FFUXST                          WEUXST
     I              FFVSST                          WEVSST
     I              FFAATM                          WEAATM
     I              FFAYNA                          WEAYNA
     I              FFA0NA                          WEA0NA
     I              FFAXDT                          WEAXDT
      *
     I@ADREWA
      * Warehouse Codes           ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADBWC3                          WFBWC3
     I              ADBTC3                          WFBTC3
     I              ADBUC3                          WFBUC3
     I              ADBVC3                          WFBVC3
     I              ADFCAA                          WFFCAA
     I              ADRQSX                          WFRQSX
     I              ADRRSX                          WFRRSX
     I              ADRSSX                          WFRSSX
     I              ADRTSX                          WFRTSX
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADRNSX                          WFRNSX
     I              ADROSX                          WFROSX
     I              ADRPSX                          WFRPSX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WGRMNB
     I              FLRUNB                          WGRUNB
     I              FLRVNB                          WGRVNB
     I              FLDQTX                          WGDQTX
     I              FLRWNB                          WGRWNB
     I              FLRXNB                          WGRXNB
     I              FLSQNB                          WGSQNB
     I              FLT0NB                          WGT0NB
     I              FLT1NB                          WGT1NB
     I              FLR1NB                          WGR1NB
     I              FLAIC3                          WGAIC3
     I              FLC4NB                          WGC4NB
     I              FLVCST                          WGVCST
     I              FLKEDT                          WGKEDT
     I              FLSXNB                          WGSXNB
     I              FLKFDT                          WGKFDT
     I              FLACTM                          WGACTM
     I              FLK5TX                          WGK5TX
     I              FLW5CD                          WGW5CD
     I              FLEJDT                          WGEJDT
     I              FLAGTM                          WGAGTM
     I              FLKJDT                          WGKJDT
     I              FLATTM                          WGATTM
     I              FLHDDT                          WGHDDT
     I              FLAUTM                          WGAUTM
     I              FLKKDT                          WGKKDT
     I              FLAVTM                          WGAVTM
     I              FLZ4NB                          WGZ4NB
     I              FLY7ST                          WGY7ST
     I              FLY2ST                          WGY2ST
     I              FLWHTX                          WGWHTX
     I              FLWITX                          WGWITX
     I              FLWJTX                          WGWJTX
     I              FLWKTX                          WGWKTX
     I              FLWLTX                          WGWLTX
     I              FLN7DT                          WGN7DT
     I              FLN8DT                          WGN8DT
     I              FLN9DT                          WGN9DT
     I              FLB3TM                          WGB3TM
     I              FLB4TM                          WGB4TM
     I              FLB5TM                          WGB5TM
     I              FLIASX                          WGIASX
     I              FLIBSX                          WGIBSX
     I              FLICSX                          WGICSX
     I              FLWVTX                          WGWVTX
     I              FLWWTX                          WGWWTX
     I              FLWXTX                          WGWXTX
     I              FLUVST                          WGUVST
     I              FLUWST                          WGUWST
     I              FLUXST                          WGUXST
     I              FLAATM                          WGAATM
     I              FLAYNA                          WGAYNA
     I              FLA0NA                          WGA0NA
     I              FLAXDT                          WGAXDT
      *
     I@FJCPMJ
      * Load Header               Trailer/Carrier/Load
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     I@AMREU0
      * Order Header Extension    ShipLine/Container/Load
      * Renamed input format fields
     I              AMAIC3                          WIAIC3
     I              AMC4NB                          WIC4NB
     I              AMRMNB                          WIRMNB
     I              AMRUNB                          WIRUNB
     I              AMXACD                          WIXACD
     I              AMOANA                          WIOANA
     I              AMHBAA                          WIHBAA
     I              AMJ0T1                          WIJ0T1
     I              AMGENY                          WIGENY
     I              AMJ1T1                          WIJ1T1
     I              AMHCAA                          WIHCAA
     I              AMQWDT                          WIQWDT
     I              AMQXDT                          WIQXDT
     I              AMQYDT                          WIQYDT
     I              AMHDAA                          WIHDAA
     I              AMCCTX                          WICCTX
     I              AMJ2T1                          WIJ2T1
     I              AMRLNA                          WIRLNA
     I              AMRMNA                          WIRMNA
     I              AMGINY                          WIGINY
     I              AMGFNY                          WIGFNY
     I              AMGGNY                          WIGGNY
     I              AMGHNY                          WIGHNY
     I              AMHEVL                          WIHEVL
     I              AMHFVL                          WIHFVL
     I              AMHGVL                          WIHGVL
     I              AMQZDT                          WIQZDT
     I              AMQ0DT                          WIQ0DT
     I              AMQ1DT                          WIQ1DT
     I              AMQ2DT                          WIQ2DT
     I              AMC2TX                          WIC2TX
     I              AMC3TX                          WIC3TX
     I              AMC6TX                          WIC6TX
     I              AMCHTX                          WICHTX
     I              AMCITX                          WICITX
     I              AMCLTX                          WICLTX
     I              AMB4TX                          WIB4TX
     I              AMCUTX                          WICUTX
     I              AMCVTX                          WICVTX
     I              AMB9TX                          WIB9TX
     I              AMJWSC                          WIJWSC
     I              AMITNY                          WIITNY
     I              AMLMT1                          WILMT1
     I              AMLWAA                          WILWAA
     I              AMFVST                          WIFVST
     I              AMF0ST                          WIF0ST
     I              AMF2ST                          WIF2ST
     I              AMF3ST                          WIF3ST
     I              AMJUSC                          WIJUSC
     I              AMJVSC                          WIJVSC
     I              AMV3T1                          WIV3T1
     I              AMV4T1                          WIV4T1
     I              AMV5T1                          WIV5T1
     I              AMV6T1                          WIV6T1
     I              AMV7T1                          WIV7T1
     I              AMV8T1                          WIV8T1
     I              AMV9T1                          WIV9T1
     I              AMWAT1                          WIWAT1
     I              AMWBT1                          WIWBT1
     I              AMWCT1                          WIWCT1
     I              AMWDT1                          WIWDT1
     I              AMQJNY                          WIQJNY
     I              AMQKNY                          WIQKNY
     I              AMQLNY                          WIQLNY
     I              AMP8NY                          WIP8NY
     I              AMP9NY                          WIP9NY
     I              AMQANY                          WIQANY
     I              AMQCNY                          WIQCNY
     I              AMQDNY                          WIQDNY
     I              AMQENY                          WIQENY
     I              AMQFNY                          WIQFNY
     I              AMQGNY                          WIQGNY
     I              AMQHNY                          WIQHNY
     I              AMQINY                          WIQINY
     I              AMQMNY                          WIQMNY
     I              AMMYU1                          WIMYU1
     I              AMJXSC                          WIJXSC
     I              AMJYSC                          WIJYSC
     I              AMJZSC                          WIJZSC
     I              AMJ0SC                          WIJ0SC
     I              AMMZU1                          WIMZU1
     I              AMM0U1                          WIM0U1
     I              AMM1U1                          WIM1U1
     I              AMM2U1                          WIM2U1
     I              AMM3U1                          WIM3U1
     I              AMW5DT                          WIW5DT
     I              AMW6DT                          WIW6DT
     I              AMUVST                          WIUVST
     I              AMUWST                          WIUWST
     I              AMUXST                          WIUXST
     I              AMVSST                          WIVSST
     I              AMAATM                          WIAATM
     I              AMAYNA                          WIAYNA
     I              AMA0NA                          WIA0NA
     I              AMAXDT                          WIAXDT
      *
     I@FJCPR4
      * Load Header               Carrier/Trailer
      * Renamed input format fields
     I              FJRMNB                          WJRMNB
     I              FJAIC3                          WJAIC3
     I              FJAODT                          WJAODT
     I              FJPJST                          WJPJST
     I              FJPKST                          WJPKST
     I              FJRNNB                          WJRNNB
     I              FJDMTX                          WJDMTX
     I              FJDNTX                          WJDNTX
     I              FJDOTX                          WJDOTX
     I              FJWTTX                          WJWTTX
     I              FJWUTX                          WJWUTX
     I              FJRPNB                          WJRPNB
     I              FJFLAM                          WJFLAM
     I              FJXQST                          WJXQST
     I              FJRRNB                          WJRRNB
     I              FJDXTX                          WJDXTX
     I              FJDYTX                          WJDYTX
     I              FJSBNB                          WJSBNB
     I              FJBZNA                          WJBZNA
     I              FJRONB                          WJRONB
     I              FJSQNB                          WJSQNB
     I              FJR1NB                          WJR1NB
     I              FJVCST                          WJVCST
     I              FJVDST                          WJVDST
     I              FJSDNB                          WJSDNB
     I              FJPAOU                          WJPAOU
     I              FJDGWG                          WJDGWG
     I              FJSXNB                          WJSXNB
     I              FJHADT                          WJHADT
     I              FJAART                          WJAART
     I              FJDHWG                          WJDHWG
     I              FJDIWG                          WJDIWG
     I              FJAQDT                          WJAQDT
     I              FJS6NB                          WJS6NB
     I              FJT4NB                          WJT4NB
     I              FJPRTM                          WJPRTM
     I              FJNPSV                          WJNPSV
     I              FJJ8TX                          WJJ8TX
     I              FJTLMI                          WJTLMI
     I              FJJ9TX                          WJJ9TX
     I              FJQ2CD                          WJQ2CD
     I              FJVPCD                          WJVPCD
     I              FJDBCD                          WJDBCD
     I              FJGRWE                          WJGRWE
     I              FJXCCD                          WJXCCD
     I              FJU2ST                          WJU2ST
     I              FJF9DT                          WJF9DT
     I              FJONTM                          WJONTM
     I              FJJ4DT                          WJJ4DT
     I              FJTRTM                          WJTRTM
     I              FJJ5DT                          WJJ5DT
     I              FJSPTM                          WJSPTM
     I              FJJ6DT                          WJJ6DT
     I              FJLFTM                          WJLFTM
     I              FJJ7DT                          WJJ7DT
     I              FJBOTM                          WJBOTM
     I              FJJ8DT                          WJJ8DT
     I              FJBLTM                          WJBLTM
     I              FJKIDT                          WJKIDT
     I              FJASTM                          WJASTM
     I              FJKADT                          WJKADT
     I              FJAJCM                          WJAJCM
     I              FJXACD                          WJXACD
     I              FJOANA                          WJOANA
     I              FJK4TX                          WJK4TX
     I              FJVOAG                          WJVOAG
     I              FJKBDT                          WJKBDT
     I              FJNBBO                          WJNBBO
     I              FJW4CD                          WJW4CD
     I              FJEFDT                          WJEFDT
     I              FJCNTN                          WJCNTN
     I              FJKCDT                          WJKCDT
     I              FJTMIN                          WJTMIN
     I              FJKDDT                          WJKDDT
     I              FJVMNB                          WJVMNB
     I              FJOCFR                          WJOCFR
     I              FJKJDT                          WJKJDT
     I              FJATTM                          WJATTM
     I              FJOTRS                          WJOTRS
     I              FJRNST                          WJRNST
     I              FJBRBK                          WJBRBK
     I              FJEIDT                          WJEIDT
     I              FJRMST                          WJRMST
     I              FJAJCD                          WJAJCD
     I              FJKKDT                          WJKKDT
     I              FJAVTM                          WJAVTM
     I              FJKZDT                          WJKZDT
     I              FJAXTM                          WJAXTM
     I              FJLHOS                          WJLHOS
     I              FJLHOR                          WJLHOR
     I              FJWNTX                          WJWNTX
     I              FJOITX                          WJOITX
     I              FJOJTX                          WJOJTX
     I              FJLLDT                          WJLLDT
     I              FJLSHG                          WJLSHG
     I              FJYPST                          WJYPST
     I              FJK0DT                          WJK0DT
     I              FJAYTM                          WJAYTM
     I              FJKNNX                          WJKNNX
     I              FJICWG                          WJICWG
     I              FJIDWG                          WJIDWG
     I              FJH9SX                          WJH9SX
     I              FJWOTX                          WJWOTX
     I              FJK1DT                          WJK1DT
     I              FJAZTM                          WJAZTM
     I              FJK2DT                          WJK2DT
     I              FJA0TM                          WJA0TM
     I              FJROST                          WJROST
     I              FJRPST                          WJRPST
     I              FJRQST                          WJRQST
     I              FJRRST                          WJRRST
     I              FJZBVA                          WJZBVA
     I              FJWPTX                          WJWPTX
     I              FJWQTX                          WJWQTX
     I              FJWRTX                          WJWRTX
     I              FJWSTX                          WJWSTX
     I              FJRVSX                          WJRVSX
     I              FJRUSX                          WJRUSX
     I              FJRWSX                          WJRWSX
     I              FJRXSX                          WJRXSX
     I              FJRYSX                          WJRYSX
     I              FJRZSX                          WJRZSX
     I              FJR0SX                          WJR0SX
     I              FJR1SX                          WJR1SX
     I              FJR2SX                          WJR2SX
     I              FJR3SX                          WJR3SX
     I              FJR4SX                          WJR4SX
     I              FJPYDT                          WJPYDT
     I              FJCKTM                          WJCKTM
     I              FJPZDT                          WJPZDT
     I              FJCLTM                          WJCLTM
     I              FJP0DT                          WJP0DT
     I              FJCMTM                          WJCMTM
     I              FJP1DT                          WJP1DT
     I              FJCNTM                          WJCNTM
     I              FJP2DT                          WJP2DT
     I              FJCOTM                          WJCOTM
     I              FJP3DT                          WJP3DT
     I              FJCQTM                          WJCQTM
     I              FJUVST                          WJUVST
     I              FJUWST                          WJUWST
     I              FJUXST                          WJUXST
     I              FJAATM                          WJAATM
     I              FJAYNA                          WJAYNA
     I              FJA0NA                          WJA0NA
     I              FJAXDT                          WJAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WKRMNB
     I              FLRUNB                          WKRUNB
     I              FLRVNB                          WKRVNB
     I              FLDQTX                          WKDQTX
     I              FLRWNB                          WKRWNB
     I              FLRXNB                          WKRXNB
     I              FLSQNB                          WKSQNB
     I              FLT0NB                          WKT0NB
     I              FLT1NB                          WKT1NB
     I              FLR1NB                          WKR1NB
     I              FLAIC3                          WKAIC3
     I              FLC4NB                          WKC4NB
     I              FLVCST                          WKVCST
     I              FLKEDT                          WKKEDT
     I              FLSXNB                          WKSXNB
     I              FLKFDT                          WKKFDT
     I              FLACTM                          WKACTM
     I              FLK5TX                          WKK5TX
     I              FLW5CD                          WKW5CD
     I              FLEJDT                          WKEJDT
     I              FLAGTM                          WKAGTM
     I              FLKJDT                          WKKJDT
     I              FLATTM                          WKATTM
     I              FLHDDT                          WKHDDT
     I              FLAUTM                          WKAUTM
     I              FLKKDT                          WKKKDT
     I              FLAVTM                          WKAVTM
     I              FLZ4NB                          WKZ4NB
     I              FLY7ST                          WKY7ST
     I              FLY2ST                          WKY2ST
     I              FLWHTX                          WKWHTX
     I              FLWITX                          WKWITX
     I              FLWJTX                          WKWJTX
     I              FLWKTX                          WKWKTX
     I              FLWLTX                          WKWLTX
     I              FLN7DT                          WKN7DT
     I              FLN8DT                          WKN8DT
     I              FLN9DT                          WKN9DT
     I              FLB3TM                          WKB3TM
     I              FLB4TM                          WKB4TM
     I              FLB5TM                          WKB5TM
     I              FLIASX                          WKIASX
     I              FLIBSX                          WKIBSX
     I              FLICSX                          WKICSX
     I              FLWVTX                          WKWVTX
     I              FLWWTX                          WKWWTX
     I              FLWXTX                          WKWXTX
     I              FLUVST                          WKUVST
     I              FLUWST                          WKUWST
     I              FLUXST                          WKUXST
     I              FLAATM                          WKAATM
     I              FLAYNA                          WKAYNA
     I              FLA0NA                          WKA0NA
     I              FLAXDT                          WKAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WLRMNB
     I              FLRUNB                          WLRUNB
     I              FLRVNB                          WLRVNB
     I              FLDQTX                          WLDQTX
     I              FLRWNB                          WLRWNB
     I              FLRXNB                          WLRXNB
     I              FLSQNB                          WLSQNB
     I              FLT0NB                          WLT0NB
     I              FLT1NB                          WLT1NB
     I              FLR1NB                          WLR1NB
     I              FLAIC3                          WLAIC3
     I              FLC4NB                          WLC4NB
     I              FLVCST                          WLVCST
     I              FLKEDT                          WLKEDT
     I              FLSXNB                          WLSXNB
     I              FLKFDT                          WLKFDT
     I              FLACTM                          WLACTM
     I              FLK5TX                          WLK5TX
     I              FLW5CD                          WLW5CD
     I              FLEJDT                          WLEJDT
     I              FLAGTM                          WLAGTM
     I              FLKJDT                          WLKJDT
     I              FLATTM                          WLATTM
     I              FLHDDT                          WLHDDT
     I              FLAUTM                          WLAUTM
     I              FLKKDT                          WLKKDT
     I              FLAVTM                          WLAVTM
     I              FLZ4NB                          WLZ4NB
     I              FLY7ST                          WLY7ST
     I              FLY2ST                          WLY2ST
     I              FLWHTX                          WLWHTX
     I              FLWITX                          WLWITX
     I              FLWJTX                          WLWJTX
     I              FLWKTX                          WLWKTX
     I              FLWLTX                          WLWLTX
     I              FLN7DT                          WLN7DT
     I              FLN8DT                          WLN8DT
     I              FLN9DT                          WLN9DT
     I              FLB3TM                          WLB3TM
     I              FLB4TM                          WLB4TM
     I              FLB5TM                          WLB5TM
     I              FLIASX                          WLIASX
     I              FLIBSX                          WLIBSX
     I              FLICSX                          WLICSX
     I              FLWVTX                          WLWVTX
     I              FLWWTX                          WLWWTX
     I              FLWXTX                          WLWXTX
     I              FLUVST                          WLUVST
     I              FLUWST                          WLUWST
     I              FLUXST                          WLUXST
     I              FLAATM                          WLAATM
     I              FLAYNA                          WLAYNA
     I              FLA0NA                          WLA0NA
     I              FLAXDT                          WLAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WMAIC3
     I              OMC4NB                          WMC4NB
     I              OMDPNB                          WMDPNB
     I              OMUENB                          WMUENB
     I              OMHGCD                          WMHGCD
     I              OMAJCD                          WMAJCD
     I              OMBKC7                          WMBKC7
     I              OMCFC7                          WMCFC7
     I              OMGMST                          WMGMST
     I              OMGNST                          WMGNST
     I              OMMAVA                          WMMAVA
     I              OMKDVA                          WMKDVA
     I              OML8VA                          WML8VA
     I              OML9VA                          WML9VA
     I              OMGTST                          WMGTST
     I              OMGVST                          WMGVST
     I              OMGUST                          WMGUST
     I              OMQFST                          WMQFST
     I              OMAYVA                          WMAYVA
     I              OMEXDT                          WMEXDT
     I              OMLQCD                          WMLQCD
     I              OMRDCD                          WMRDCD
     I              OMQ7CD                          WMQ7CD
     I              OMBZPR                          WMBZPR
     I              OML6NB                          WML6NB
     I              OMU1ST                          WMU1ST
     I              OMGIDT                          WMGIDT
     I              OMCRCD                          WMCRCD
     I              OMAGCD                          WMAGCD
     I              OMRZST                          WMRZST
     I              OMR0ST                          WMR0ST
     I              OMR1ST                          WMR1ST
     I              OMG7NA                          WMG7NA
     I              OMG8NA                          WMG8NA
     I              OMRPCD                          WMRPCD
     I              OMVEST                          WMVEST
     I              OMVGST                          WMVGST
     I              OMAVST                          WMAVST
     I              OMU0ST                          WMU0ST
     I              OMRFCD                          WMRFCD
     I              OMFZST                          WMFZST
     I              OMR1NB                          WMR1NB
     I              OMAVQT                          WMAVQT
     I              OMD0WG                          WMD0WG
     I              OMCCQT                          WMCCQT
     I              OMAUWG                          WMAUWG
     I              OMCBQT                          WMCBQT
     I              OMATWG                          WMATWG
     I              OMAQCS                          WMAQCS
     I              OMAGCS                          WMAGCS
     I              OMAKPR                          WMAKPR
     I              OMALPR                          WMALPR
     I              OMAUPR                          WMAUPR
     I              OMAVWG                          WMAVWG
     I              OMA4WG                          WMA4WG
     I              OMA5DT                          WMA5DT
     I              OMAODT                          WMAODT
     I              OMGNDT                          WMGNDT
     I              OMAMST                          WMAMST
     I              OMANST                          WMANST
     I              OMVAST                          WMVAST
     I              OMRGNB                          WMRGNB
     I              OMRHNB                          WMRHNB
     I              OMRINB                          WMRINB
     I              OMRBCD                          WMRBCD
     I              OMHICD                          WMHICD
     I              OMRNCD                          WMRNCD
     I              OMROCD                          WMROCD
     I              OMCXDT                          WMCXDT
     I              OMAJVN                          WMAJVN
     I              OMKXCD                          WMKXCD
     I              OMJPCD                          WMJPCD
     I              OMCQCD                          WMCQCD
     I              OMR4CD                          WMR4CD
     I              OMZ1ST                          WMZ1ST
     I              OMZ3ST                          WMZ3ST
     I              OMZ4ST                          WMZ4ST
     I              OMDUPR                          WMDUPR
     I              OMB6VL                          WMB6VL
     I              OMA1AA                          WMA1AA
     I              OMFZSX                          WMFZSX
     I              OMF0SX                          WMF0SX
     I              OMF1SX                          WMF1SX
     I              OMF2SX                          WMF2SX
     I              OMF3SX                          WMF3SX
     I              OMF4SX                          WMF4SX
     I              OMF5SX                          WMF5SX
     I              OMF6SX                          WMF6SX
     I              OMF7SX                          WMF7SX
     I              OMNTDT                          WMNTDT
     I              OMNUDT                          WMNUDT
     I              OMNVDT                          WMNVDT
     I              OMNWDT                          WMNWDT
     I              OMNXDT                          WMNXDT
     I              OMBUTM                          WMBUTM
     I              OMBVTM                          WMBVTM
     I              OMBWTM                          WMBWTM
     I              OMBXTM                          WMBXTM
     I              OMBYTM                          WMBYTM
     I              OMH5NX                          WMH5NX
     I              OMH6NX                          WMH6NX
     I              OMH7NX                          WMH7NX
     I              OMH8NX                          WMH8NX
     I              OMH9NX                          WMH9NX
     I              OMDVPR                          WMDVPR
     I              OMDWPR                          WMDWPR
     I              OMDXPR                          WMDXPR
     I              OMDYPR                          WMDYPR
     I              OMDZPR                          WMDZPR
     I              OMGSPR                          WMGSPR
     I              OMGTPR                          WMGTPR
     I              OMGUPR                          WMGUPR
     I              OMHOST                          WMHOST
     I              OMHPST                          WMHPST
     I              OMIOST                          WMIOST
     I              OMPEWG                          WMPEWG
     I              OMRINY                          WMRINY
     I              OMTIDT                          WMTIDT
     I              OMTJDT                          WMTJDT
     I              OMH2ST                          WMH2ST
     I              OMH0ST                          WMH0ST
     I              OMH1ST                          WMH1ST
     I              OMTKDT                          WMTKDT
     I              OMTLDT                          WMTLDT
     I              OMTMDT                          WMTMDT
     I              OMUVST                          WMUVST
     I              OMUWST                          WMUWST
     I              OMUXST                          WMUXST
     I              OMAATM                          WMAATM
     I              OMAYNA                          WMAYNA
     I              OMA0NA                          WMA0NA
     I              OMAXDT                          WMAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WORMNB
     I              FLRUNB                          WORUNB
     I              FLRVNB                          WORVNB
     I              FLDQTX                          WODQTX
     I              FLRWNB                          WORWNB
     I              FLRXNB                          WORXNB
     I              FLSQNB                          WOSQNB
     I              FLT0NB                          WOT0NB
     I              FLT1NB                          WOT1NB
     I              FLR1NB                          WOR1NB
     I              FLAIC3                          WOAIC3
     I              FLC4NB                          WOC4NB
     I              FLVCST                          WOVCST
     I              FLKEDT                          WOKEDT
     I              FLSXNB                          WOSXNB
     I              FLKFDT                          WOKFDT
     I              FLACTM                          WOACTM
     I              FLK5TX                          WOK5TX
     I              FLW5CD                          WOW5CD
     I              FLEJDT                          WOEJDT
     I              FLAGTM                          WOAGTM
     I              FLKJDT                          WOKJDT
     I              FLATTM                          WOATTM
     I              FLHDDT                          WOHDDT
     I              FLAUTM                          WOAUTM
     I              FLKKDT                          WOKKDT
     I              FLAVTM                          WOAVTM
     I              FLZ4NB                          WOZ4NB
     I              FLY7ST                          WOY7ST
     I              FLY2ST                          WOY2ST
     I              FLWHTX                          WOWHTX
     I              FLWITX                          WOWITX
     I              FLWJTX                          WOWJTX
     I              FLWKTX                          WOWKTX
     I              FLWLTX                          WOWLTX
     I              FLN7DT                          WON7DT
     I              FLN8DT                          WON8DT
     I              FLN9DT                          WON9DT
     I              FLB3TM                          WOB3TM
     I              FLB4TM                          WOB4TM
     I              FLB5TM                          WOB5TM
     I              FLIASX                          WOIASX
     I              FLIBSX                          WOIBSX
     I              FLICSX                          WOICSX
     I              FLWVTX                          WOWVTX
     I              FLWWTX                          WOWWTX
     I              FLWXTX                          WOWXTX
     I              FLUVST                          WOUVST
     I              FLUWST                          WOUWST
     I              FLUXST                          WOUXST
     I              FLAATM                          WOAATM
     I              FLAYNA                          WOAYNA
     I              FLA0NA                          WOA0NA
     I              FLAXDT                          WOAXDT
      *
     I@BFCPNQ
      * Order Header TRG          Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          WRAIC3
     I              BEC4NB                          WRC4NB
     I              BEJNCD                          WRJNCD
     I              BEANC7                          WRANC7
     I              BEBKC7                          WRBKC7
     I              BEBRTX                          WRBRTX
     I              BEHMNA                          WRHMNA
     I              BEHONA                          WRHONA
     I              BEHPNA                          WRHPNA
     I              BEHNNA                          WRHNNA
     I              BEDBCD                          WRDBCD
     I              BECKTX                          WRCKTX
     I              BEB0C7                          WRB0C7
     I              BEAETX                          WRAETX
     I              BEB1NA                          WRB1NA
     I              BEB3NA                          WRB3NA
     I              BEB4NA                          WRB4NA
     I              BEB2NA                          WRB2NA
     I              BEBHCD                          WRBHCD
     I              BEC8TX                          WRC8TX
     I              BEBCNA                          WRBCNA
     I              BEA0DT                          WRA0DT
     I              BEA5DT                          WRA5DT
     I              BEGNDT                          WRGNDT
     I              BEACDT                          WRACDT
     I              BEAQCD                          WRAQCD
     I              BEB6NA                          WRB6NA
     I              BEBYNA                          WRBYNA
     I              BEBZNA                          WRBZNA
     I              BEGTST                          WRGTST
     I              BEGVST                          WRGVST
     I              BEGUST                          WRGUST
     I              BEQFST                          WRQFST
     I              BECQCD                          WRCQCD
     I              BEGJST                          WRGJST
     I              BEGWST                          WRGWST
     I              BEGXST                          WRGXST
     I              BEGYST                          WRGYST
     I              BEAODT                          WRAODT
     I              BEAIVN                          WRAIVN
     I              BECXDT                          WRCXDT
     I              BEJZVA                          WRJZVA
     I              BEA1WG                          WRA1WG
     I              BEXIST                          WRXIST
     I              BEXJST                          WRXJST
     I              BEXKST                          WRXKST
     I              BEEIDT                          WREIDT
     I              BEAFTM                          WRAFTM
     I              BEE8CD                          WRE8CD
     I              BEE9CD                          WRE9CD
     I              BERMNB                          WRRMNB
     I              BETBNB                          WRTBNB
     I              BER1NB                          WRR1NB
     I              BEPJST                          WRPJST
     I              BEU0ST                          WRU0ST
     I              BEU1ST                          WRU1ST
     I              BEQ2CD                          WRQ2CD
     I              BEU2ST                          WRU2ST
     I              BEVEST                          WRVEST
     I              BEVFST                          WRVFST
     I              BEVGST                          WRVGST
     I              BERPCD                          WRRPCD
     I              BERNNB                          WRRNNB
     I              BEVDST                          WRVDST
     I              BEATIN                          WRATIN
     I              BEU4ST                          WRU4ST
     I              BEU5ST                          WRU5ST
     I              BERSRN                          WRRSRN
     I              BEMHNA                          WRMHNA
     I              BEMINA                          WRMINA
     I              BEWBST                          WRWBST
     I              BER4CD                          WRR4CD
     I              BEBFCD                          WRBFCD
     I              BEQ4CD                          WRQ4CD
     I              BET3NB                          WRT3NB
     I              BESICD                          WRSICD
     I              BECONB                          WRCONB
     I              BECEST                          WRCEST
     I              BEAWDT                          WRAWDT
     I              BEJPCD                          WRJPCD
     I              BEXUST                          WRXUST
     I              BEZ1ST                          WRZ1ST
     I              BEVRVA                          WRVRVA
     I              BEOBST                          WROBST
     I              BEBCST                          WRBCST
     I              BEBDST                          WRBDST
     I              BEB7VL                          WRB7VL
     I              BEGASX                          WRGASX
     I              BEGBSX                          WRGBSX
     I              BEGCSX                          WRGCSX
     I              BEGDSX                          WRGDSX
     I              BEFNSX                          WRFNSX
     I              BEFOSX                          WRFOSX
     I              BEFPSX                          WRFPSX
     I              BEFQSX                          WRFQSX
     I              BEFRSX                          WRFRSX
     I              BEFSSX                          WRFSSX
     I              BEFTSX                          WRFTSX
     I              BEFUSX                          WRFUSX
     I              BEFVSX                          WRFVSX
     I              BEFWSX                          WRFWSX
     I              BEFXSX                          WRFXSX
     I              BEFYSX                          WRFYSX
     I              BENODT                          WRNODT
     I              BENPDT                          WRNPDT
     I              BENQDT                          WRNQDT
     I              BENRDT                          WRNRDT
     I              BENSDT                          WRNSDT
     I              BEBPTM                          WRBPTM
     I              BEBQTM                          WRBQTM
     I              BEBRTM                          WRBRTM
     I              BEBSTM                          WRBSTM
     I              BEBTTM                          WRBTTM
     I              BEH0NX                          WRH0NX
     I              BEH1NX                          WRH1NX
     I              BEH2NX                          WRH2NX
     I              BEH3NX                          WRH3NX
     I              BEH4NX                          WRH4NX
     I              BEC0C7                          WRC0C7
     I              BEUVST                          WRUVST
     I              BEUWST                          WRUWST
     I              BEUXST                          WRUXST
     I              BEAATM                          WRAATM
     I              BEAYNA                          WRAYNA
     I              BEA0NA                          WRA0NA
     I              BEAXDT                          WRAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WSAIC3
     I              BEC4NB                          WSC4NB
     I              BEJNCD                          WSJNCD
     I              BEANC7                          WSANC7
     I              BEBKC7                          WSBKC7
     I              BEBRTX                          WSBRTX
     I              BEHMNA                          WSHMNA
     I              BEHONA                          WSHONA
     I              BEHPNA                          WSHPNA
     I              BEHNNA                          WSHNNA
     I              BEDBCD                          WSDBCD
     I              BECKTX                          WSCKTX
     I              BEB0C7                          WSB0C7
     I              BEAETX                          WSAETX
     I              BEB1NA                          WSB1NA
     I              BEB3NA                          WSB3NA
     I              BEB4NA                          WSB4NA
     I              BEB2NA                          WSB2NA
     I              BEBHCD                          WSBHCD
     I              BEC8TX                          WSC8TX
     I              BEBCNA                          WSBCNA
     I              BEA0DT                          WSA0DT
     I              BEA5DT                          WSA5DT
     I              BEGNDT                          WSGNDT
     I              BEACDT                          WSACDT
     I              BEAQCD                          WSAQCD
     I              BEB6NA                          WSB6NA
     I              BEBYNA                          WSBYNA
     I              BEBZNA                          WSBZNA
     I              BEGTST                          WSGTST
     I              BEGVST                          WSGVST
     I              BEGUST                          WSGUST
     I              BEQFST                          WSQFST
     I              BECQCD                          WSCQCD
     I              BEGJST                          WSGJST
     I              BEGWST                          WSGWST
     I              BEGXST                          WSGXST
     I              BEGYST                          WSGYST
     I              BEAODT                          WSAODT
     I              BEAIVN                          WSAIVN
     I              BECXDT                          WSCXDT
     I              BEJZVA                          WSJZVA
     I              BEA1WG                          WSA1WG
     I              BEXIST                          WSXIST
     I              BEXJST                          WSXJST
     I              BEXKST                          WSXKST
     I              BEEIDT                          WSEIDT
     I              BEAFTM                          WSAFTM
     I              BEE8CD                          WSE8CD
     I              BEE9CD                          WSE9CD
     I              BERMNB                          WSRMNB
     I              BETBNB                          WSTBNB
     I              BER1NB                          WSR1NB
     I              BEPJST                          WSPJST
     I              BEU0ST                          WSU0ST
     I              BEU1ST                          WSU1ST
     I              BEQ2CD                          WSQ2CD
     I              BEU2ST                          WSU2ST
     I              BEVEST                          WSVEST
     I              BEVFST                          WSVFST
     I              BEVGST                          WSVGST
     I              BERPCD                          WSRPCD
     I              BERNNB                          WSRNNB
     I              BEVDST                          WSVDST
     I              BEATIN                          WSATIN
     I              BEU4ST                          WSU4ST
     I              BEU5ST                          WSU5ST
     I              BERSRN                          WSRSRN
     I              BEMHNA                          WSMHNA
     I              BEMINA                          WSMINA
     I              BEWBST                          WSWBST
     I              BER4CD                          WSR4CD
     I              BEBFCD                          WSBFCD
     I              BEQ4CD                          WSQ4CD
     I              BET3NB                          WST3NB
     I              BESICD                          WSSICD
     I              BECONB                          WSCONB
     I              BECEST                          WSCEST
     I              BEAWDT                          WSAWDT
     I              BEJPCD                          WSJPCD
     I              BEXUST                          WSXUST
     I              BEZ1ST                          WSZ1ST
     I              BEVRVA                          WSVRVA
     I              BEOBST                          WSOBST
     I              BEBCST                          WSBCST
     I              BEBDST                          WSBDST
     I              BEB7VL                          WSB7VL
     I              BEGASX                          WSGASX
     I              BEGBSX                          WSGBSX
     I              BEGCSX                          WSGCSX
     I              BEGDSX                          WSGDSX
     I              BEFNSX                          WSFNSX
     I              BEFOSX                          WSFOSX
     I              BEFPSX                          WSFPSX
     I              BEFQSX                          WSFQSX
     I              BEFRSX                          WSFRSX
     I              BEFSSX                          WSFSSX
     I              BEFTSX                          WSFTSX
     I              BEFUSX                          WSFUSX
     I              BEFVSX                          WSFVSX
     I              BEFWSX                          WSFWSX
     I              BEFXSX                          WSFXSX
     I              BEFYSX                          WSFYSX
     I              BENODT                          WSNODT
     I              BENPDT                          WSNPDT
     I              BENQDT                          WSNQDT
     I              BENRDT                          WSNRDT
     I              BENSDT                          WSNSDT
     I              BEBPTM                          WSBPTM
     I              BEBQTM                          WSBQTM
     I              BEBRTM                          WSBRTM
     I              BEBSTM                          WSBSTM
     I              BEBTTM                          WSBTTM
     I              BEH0NX                          WSH0NX
     I              BEH1NX                          WSH1NX
     I              BEH2NX                          WSH2NX
     I              BEH3NX                          WSH3NX
     I              BEH4NX                          WSH4NX
     I              BEC0C7                          WSC0C7
     I              BEUVST                          WSUVST
     I              BEUWST                          WSUWST
     I              BEUXST                          WSUXST
     I              BEAATM                          WSAATM
     I              BEAYNA                          WSAYNA
     I              BEA0NA                          WSA0NA
     I              BEAXDT                          WSAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WTAIC3
     I              OMC4NB                          WTC4NB
     I              OMDPNB                          WTDPNB
     I              OMUENB                          WTUENB
     I              OMHGCD                          WTHGCD
     I              OMAJCD                          WTAJCD
     I              OMBKC7                          WTBKC7
     I              OMCFC7                          WTCFC7
     I              OMGMST                          WTGMST
     I              OMGNST                          WTGNST
     I              OMMAVA                          WTMAVA
     I              OMKDVA                          WTKDVA
     I              OML8VA                          WTL8VA
     I              OML9VA                          WTL9VA
     I              OMGTST                          WTGTST
     I              OMGVST                          WTGVST
     I              OMGUST                          WTGUST
     I              OMQFST                          WTQFST
     I              OMAYVA                          WTAYVA
     I              OMEXDT                          WTEXDT
     I              OMLQCD                          WTLQCD
     I              OMRDCD                          WTRDCD
     I              OMQ7CD                          WTQ7CD
     I              OMBZPR                          WTBZPR
     I              OML6NB                          WTL6NB
     I              OMU1ST                          WTU1ST
     I              OMGIDT                          WTGIDT
     I              OMCRCD                          WTCRCD
     I              OMAGCD                          WTAGCD
     I              OMRZST                          WTRZST
     I              OMR0ST                          WTR0ST
     I              OMR1ST                          WTR1ST
     I              OMG7NA                          WTG7NA
     I              OMG8NA                          WTG8NA
     I              OMRPCD                          WTRPCD
     I              OMVEST                          WTVEST
     I              OMVGST                          WTVGST
     I              OMAVST                          WTAVST
     I              OMU0ST                          WTU0ST
     I              OMRFCD                          WTRFCD
     I              OMFZST                          WTFZST
     I              OMR1NB                          WTR1NB
     I              OMAVQT                          WTAVQT
     I              OMD0WG                          WTD0WG
     I              OMCCQT                          WTCCQT
     I              OMAUWG                          WTAUWG
     I              OMCBQT                          WTCBQT
     I              OMATWG                          WTATWG
     I              OMAQCS                          WTAQCS
     I              OMAGCS                          WTAGCS
     I              OMAKPR                          WTAKPR
     I              OMALPR                          WTALPR
     I              OMAUPR                          WTAUPR
     I              OMAVWG                          WTAVWG
     I              OMA4WG                          WTA4WG
     I              OMA5DT                          WTA5DT
     I              OMAODT                          WTAODT
     I              OMGNDT                          WTGNDT
     I              OMAMST                          WTAMST
     I              OMANST                          WTANST
     I              OMVAST                          WTVAST
     I              OMRGNB                          WTRGNB
     I              OMRHNB                          WTRHNB
     I              OMRINB                          WTRINB
     I              OMRBCD                          WTRBCD
     I              OMHICD                          WTHICD
     I              OMRNCD                          WTRNCD
     I              OMROCD                          WTROCD
     I              OMCXDT                          WTCXDT
     I              OMAJVN                          WTAJVN
     I              OMKXCD                          WTKXCD
     I              OMJPCD                          WTJPCD
     I              OMCQCD                          WTCQCD
     I              OMR4CD                          WTR4CD
     I              OMZ1ST                          WTZ1ST
     I              OMZ3ST                          WTZ3ST
     I              OMZ4ST                          WTZ4ST
     I              OMDUPR                          WTDUPR
     I              OMB6VL                          WTB6VL
     I              OMA1AA                          WTA1AA
     I              OMFZSX                          WTFZSX
     I              OMF0SX                          WTF0SX
     I              OMF1SX                          WTF1SX
     I              OMF2SX                          WTF2SX
     I              OMF3SX                          WTF3SX
     I              OMF4SX                          WTF4SX
     I              OMF5SX                          WTF5SX
     I              OMF6SX                          WTF6SX
     I              OMF7SX                          WTF7SX
     I              OMNTDT                          WTNTDT
     I              OMNUDT                          WTNUDT
     I              OMNVDT                          WTNVDT
     I              OMNWDT                          WTNWDT
     I              OMNXDT                          WTNXDT
     I              OMBUTM                          WTBUTM
     I              OMBVTM                          WTBVTM
     I              OMBWTM                          WTBWTM
     I              OMBXTM                          WTBXTM
     I              OMBYTM                          WTBYTM
     I              OMH5NX                          WTH5NX
     I              OMH6NX                          WTH6NX
     I              OMH7NX                          WTH7NX
     I              OMH8NX                          WTH8NX
     I              OMH9NX                          WTH9NX
     I              OMDVPR                          WTDVPR
     I              OMDWPR                          WTDWPR
     I              OMDXPR                          WTDXPR
     I              OMDYPR                          WTDYPR
     I              OMDZPR                          WTDZPR
     I              OMGSPR                          WTGSPR
     I              OMGTPR                          WTGTPR
     I              OMGUPR                          WTGUPR
     I              OMHOST                          WTHOST
     I              OMHPST                          WTHPST
     I              OMIOST                          WTIOST
     I              OMPEWG                          WTPEWG
     I              OMRINY                          WTRINY
     I              OMTIDT                          WTTIDT
     I              OMTJDT                          WTTJDT
     I              OMH2ST                          WTH2ST
     I              OMH0ST                          WTH0ST
     I              OMH1ST                          WTH1ST
     I              OMTKDT                          WTTKDT
     I              OMTLDT                          WTTLDT
     I              OMTMDT                          WTTMDT
     I              OMUVST                          WTUVST
     I              OMUWST                          WTUWST
     I              OMUXST                          WTUXST
     I              OMAATM                          WTAATM
     I              OMAYNA                          WTAYNA
     I              OMA0NA                          WTA0NA
     I              OMAXDT                          WTAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WVAIC3
     I              AMC4NB                          WVC4NB
     I              AMRMNB                          WVRMNB
     I              AMRUNB                          WVRUNB
     I              AMXACD                          WVXACD
     I              AMOANA                          WVOANA
     I              AMHBAA                          WVHBAA
     I              AMJ0T1                          WVJ0T1
     I              AMGENY                          WVGENY
     I              AMJ1T1                          WVJ1T1
     I              AMHCAA                          WVHCAA
     I              AMQWDT                          WVQWDT
     I              AMQXDT                          WVQXDT
     I              AMQYDT                          WVQYDT
     I              AMHDAA                          WVHDAA
     I              AMCCTX                          WVCCTX
     I              AMJ2T1                          WVJ2T1
     I              AMRLNA                          WVRLNA
     I              AMRMNA                          WVRMNA
     I              AMGINY                          WVGINY
     I              AMGFNY                          WVGFNY
     I              AMGGNY                          WVGGNY
     I              AMGHNY                          WVGHNY
     I              AMHEVL                          WVHEVL
     I              AMHFVL                          WVHFVL
     I              AMHGVL                          WVHGVL
     I              AMQZDT                          WVQZDT
     I              AMQ0DT                          WVQ0DT
     I              AMQ1DT                          WVQ1DT
     I              AMQ2DT                          WVQ2DT
     I              AMC2TX                          WVC2TX
     I              AMC3TX                          WVC3TX
     I              AMC6TX                          WVC6TX
     I              AMCHTX                          WVCHTX
     I              AMCITX                          WVCITX
     I              AMCLTX                          WVCLTX
     I              AMB4TX                          WVB4TX
     I              AMCUTX                          WVCUTX
     I              AMCVTX                          WVCVTX
     I              AMB9TX                          WVB9TX
     I              AMJWSC                          WVJWSC
     I              AMITNY                          WVITNY
     I              AMLMT1                          WVLMT1
     I              AMLWAA                          WVLWAA
     I              AMFVST                          WVFVST
     I              AMF0ST                          WVF0ST
     I              AMF2ST                          WVF2ST
     I              AMF3ST                          WVF3ST
     I              AMJUSC                          WVJUSC
     I              AMJVSC                          WVJVSC
     I              AMV3T1                          WVV3T1
     I              AMV4T1                          WVV4T1
     I              AMV5T1                          WVV5T1
     I              AMV6T1                          WVV6T1
     I              AMV7T1                          WVV7T1
     I              AMV8T1                          WVV8T1
     I              AMV9T1                          WVV9T1
     I              AMWAT1                          WVWAT1
     I              AMWBT1                          WVWBT1
     I              AMWCT1                          WVWCT1
     I              AMWDT1                          WVWDT1
     I              AMQJNY                          WVQJNY
     I              AMQKNY                          WVQKNY
     I              AMQLNY                          WVQLNY
     I              AMP8NY                          WVP8NY
     I              AMP9NY                          WVP9NY
     I              AMQANY                          WVQANY
     I              AMQCNY                          WVQCNY
     I              AMQDNY                          WVQDNY
     I              AMQENY                          WVQENY
     I              AMQFNY                          WVQFNY
     I              AMQGNY                          WVQGNY
     I              AMQHNY                          WVQHNY
     I              AMQINY                          WVQINY
     I              AMQMNY                          WVQMNY
     I              AMMYU1                          WVMYU1
     I              AMJXSC                          WVJXSC
     I              AMJYSC                          WVJYSC
     I              AMJZSC                          WVJZSC
     I              AMJ0SC                          WVJ0SC
     I              AMMZU1                          WVMZU1
     I              AMM0U1                          WVM0U1
     I              AMM1U1                          WVM1U1
     I              AMM2U1                          WVM2U1
     I              AMM3U1                          WVM3U1
     I              AMW5DT                          WVW5DT
     I              AMW6DT                          WVW6DT
     I              AMUVST                          WVUVST
     I              AMUWST                          WVUWST
     I              AMUXST                          WVUXST
     I              AMVSST                          WVVSST
     I              AMAATM                          WVAATM
     I              AMAYNA                          WVAYNA
     I              AMA0NA                          WVA0NA
     I              AMAXDT                          WVAXDT
      *
     I@LYRER2
      * Trailer Master            Update index
      * Renamed input format fields
     I              LYBZNA                          WWBZNA
     I              LYDXTX                          WWDXTX
     I              LYAIC3                          WWAIC3
     I              LYVDST                          WWVDST
     I              LYX3ST                          WWX3ST
     I              LYXGST                          WWXGST
     I              LYSTOY                          WWSTOY
     I              LYKKDT                          WWKKDT
     I              LYAVTM                          WWAVTM
     I              LYSTAS                          WWSTAS
     I              LYXRST                          WWXRST
     I              LYX7CD                          WWX7CD
     I              LYGXTX                          WWGXTX
     I              LYXTST                          WWXTST
     I              LYXVST                          WWXVST
     I              LYSTU3                          WWSTU3
     I              LYSTU4                          WWSTU4
     I              LYSTU5                          WWSTU5
     I              LYLCDT                          WWLCDT
     I              LYLDDT                          WWLDDT
     I              LYLEDT                          WWLEDT
     I              LYLFDT                          WWLFDT
     I              LYLGDT                          WWLGDT
     I              LYUVST                          WWUVST
     I              LYUWST                          WWUWST
     I              LYUXST                          WWUXST
     I              LYVSST                          WWVSST
     I              LYAATM                          WWAATM
     I              LYAYNA                          WWAYNA
     I              LYA0NA                          WWA0NA
     I              LYAXDT                          WWAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WXAIC3
     I              AMC4NB                          WXC4NB
     I              AMRMNB                          WXRMNB
     I              AMRUNB                          WXRUNB
     I              AMXACD                          WXXACD
     I              AMOANA                          WXOANA
     I              AMHBAA                          WXHBAA
     I              AMJ0T1                          WXJ0T1
     I              AMGENY                          WXGENY
     I              AMJ1T1                          WXJ1T1
     I              AMHCAA                          WXHCAA
     I              AMQWDT                          WXQWDT
     I              AMQXDT                          WXQXDT
     I              AMQYDT                          WXQYDT
     I              AMHDAA                          WXHDAA
     I              AMCCTX                          WXCCTX
     I              AMJ2T1                          WXJ2T1
     I              AMRLNA                          WXRLNA
     I              AMRMNA                          WXRMNA
     I              AMGINY                          WXGINY
     I              AMGFNY                          WXGFNY
     I              AMGGNY                          WXGGNY
     I              AMGHNY                          WXGHNY
     I              AMHEVL                          WXHEVL
     I              AMHFVL                          WXHFVL
     I              AMHGVL                          WXHGVL
     I              AMQZDT                          WXQZDT
     I              AMQ0DT                          WXQ0DT
     I              AMQ1DT                          WXQ1DT
     I              AMQ2DT                          WXQ2DT
     I              AMC2TX                          WXC2TX
     I              AMC3TX                          WXC3TX
     I              AMC6TX                          WXC6TX
     I              AMCHTX                          WXCHTX
     I              AMCITX                          WXCITX
     I              AMCLTX                          WXCLTX
     I              AMB4TX                          WXB4TX
     I              AMCUTX                          WXCUTX
     I              AMCVTX                          WXCVTX
     I              AMB9TX                          WXB9TX
     I              AMJWSC                          WXJWSC
     I              AMITNY                          WXITNY
     I              AMLMT1                          WXLMT1
     I              AMLWAA                          WXLWAA
     I              AMFVST                          WXFVST
     I              AMF0ST                          WXF0ST
     I              AMF2ST                          WXF2ST
     I              AMF3ST                          WXF3ST
     I              AMJUSC                          WXJUSC
     I              AMJVSC                          WXJVSC
     I              AMV3T1                          WXV3T1
     I              AMV4T1                          WXV4T1
     I              AMV5T1                          WXV5T1
     I              AMV6T1                          WXV6T1
     I              AMV7T1                          WXV7T1
     I              AMV8T1                          WXV8T1
     I              AMV9T1                          WXV9T1
     I              AMWAT1                          WXWAT1
     I              AMWBT1                          WXWBT1
     I              AMWCT1                          WXWCT1
     I              AMWDT1                          WXWDT1
     I              AMQJNY                          WXQJNY
     I              AMQKNY                          WXQKNY
     I              AMQLNY                          WXQLNY
     I              AMP8NY                          WXP8NY
     I              AMP9NY                          WXP9NY
     I              AMQANY                          WXQANY
     I              AMQCNY                          WXQCNY
     I              AMQDNY                          WXQDNY
     I              AMQENY                          WXQENY
     I              AMQFNY                          WXQFNY
     I              AMQGNY                          WXQGNY
     I              AMQHNY                          WXQHNY
     I              AMQINY                          WXQINY
     I              AMQMNY                          WXQMNY
     I              AMMYU1                          WXMYU1
     I              AMJXSC                          WXJXSC
     I              AMJYSC                          WXJYSC
     I              AMJZSC                          WXJZSC
     I              AMJ0SC                          WXJ0SC
     I              AMMZU1                          WXMZU1
     I              AMM0U1                          WXM0U1
     I              AMM1U1                          WXM1U1
     I              AMM2U1                          WXM2U1
     I              AMM3U1                          WXM3U1
     I              AMW5DT                          WXW5DT
     I              AMW6DT                          WXW6DT
     I              AMUVST                          WXUVST
     I              AMUWST                          WXUWST
     I              AMUXST                          WXUXST
     I              AMVSST                          WXVSST
     I              AMAATM                          WXAATM
     I              AMAYNA                          WXAYNA
     I              AMA0NA                          WXA0NA
     I              AMAXDT                          WXAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            793
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      * Outward parameters
     IPARC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PARMNB
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            793
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop_Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
     IYCRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WORMNB
     I              FLRUNB                          WORUNB
     I              FLRVNB                          WORVNB
     I              FLDQTX                          WODQTX
     I              FLRWNB                          WORWNB
     I              FLRXNB                          WORXNB
     I              FLSQNB                          WOSQNB
     I              FLT0NB                          WOT0NB
     I              FLT1NB                          WOT1NB
     I              FLR1NB                          WOR1NB
     I              FLAIC3                          WOAIC3
     I              FLC4NB                          WOC4NB
     I              FLVCST                          WOVCST
     I              FLKEDT                          WOKEDT
     I              FLSXNB                          WOSXNB
     I              FLKFDT                          WOKFDT
     I              FLACTM                          WOACTM
     I              FLK5TX                          WOK5TX
     I              FLW5CD                          WOW5CD
     I              FLEJDT                          WOEJDT
     I              FLAGTM                          WOAGTM
     I              FLKJDT                          WOKJDT
     I              FLATTM                          WOATTM
     I              FLHDDT                          WOHDDT
     I              FLAUTM                          WOAUTM
     I              FLKKDT                          WOKKDT
     I              FLAVTM                          WOAVTM
     I              FLZ4NB                          WOZ4NB
     I              FLY7ST                          WOY7ST
     I              FLY2ST                          WOY2ST
     I              FLWHTX                          WOWHTX
     I              FLWITX                          WOWITX
     I              FLWJTX                          WOWJTX
     I              FLWKTX                          WOWKTX
     I              FLWLTX                          WOWLTX
     I              FLN7DT                          WON7DT
     I              FLN8DT                          WON8DT
     I              FLN9DT                          WON9DT
     I              FLB3TM                          WOB3TM
     I              FLB4TM                          WOB4TM
     I              FLB5TM                          WOB5TM
     I              FLIASX                          WOIASX
     I              FLIBSX                          WOIBSX
     I              FLICSX                          WOICSX
     I              FLWVTX                          WOWVTX
     I              FLWWTX                          WOWWTX
     I              FLWXTX                          WOWXTX
     I              FLUVST                          WOUVST
     I              FLUWST                          WOUWST
     I              FLUXST                          WOUXST
     I              FLAATM                          WOAATM
     I              FLAYNA                          WOAYNA
     I              FLA0NA                          WOA0NA
     I              FLAXDT                          WOAXDT
      *
     IYDRDCS      DS                            367
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WSAIC3
     I              BEC4NB                          WSC4NB
     I              BEJNCD                          WSJNCD
     I              BEANC7                          WSANC7
     I              BEBKC7                          WSBKC7
     I              BEBRTX                          WSBRTX
     I              BEHMNA                          WSHMNA
     I              BEHONA                          WSHONA
     I              BEHPNA                          WSHPNA
     I              BEHNNA                          WSHNNA
     I              BEDBCD                          WSDBCD
     I              BECKTX                          WSCKTX
     I              BEB0C7                          WSB0C7
     I              BEAETX                          WSAETX
     I              BEB1NA                          WSB1NA
     I              BEB3NA                          WSB3NA
     I              BEB4NA                          WSB4NA
     I              BEB2NA                          WSB2NA
     I              BEBHCD                          WSBHCD
     I              BEC8TX                          WSC8TX
     I              BEBCNA                          WSBCNA
     I              BEA0DT                          WSA0DT
     I              BEA5DT                          WSA5DT
     I              BEGNDT                          WSGNDT
     I              BEACDT                          WSACDT
     I              BEAQCD                          WSAQCD
     I              BEB6NA                          WSB6NA
     I              BEBYNA                          WSBYNA
     I              BEBZNA                          WSBZNA
     I              BEGTST                          WSGTST
     I              BEGVST                          WSGVST
     I              BEGUST                          WSGUST
     I              BEQFST                          WSQFST
     I              BECQCD                          WSCQCD
     I              BEGJST                          WSGJST
     I              BEGWST                          WSGWST
     I              BEGXST                          WSGXST
     I              BEGYST                          WSGYST
     I              BEAODT                          WSAODT
     I              BEAIVN                          WSAIVN
     I              BECXDT                          WSCXDT
     I              BEJZVA                          WSJZVA
     I              BEA1WG                          WSA1WG
     I              BEXIST                          WSXIST
     I              BEXJST                          WSXJST
     I              BEXKST                          WSXKST
     I              BEEIDT                          WSEIDT
     I              BEAFTM                          WSAFTM
     I              BEE8CD                          WSE8CD
     I              BEE9CD                          WSE9CD
     I              BERMNB                          WSRMNB
     I              BETBNB                          WSTBNB
     I              BER1NB                          WSR1NB
     I              BEPJST                          WSPJST
     I              BEU0ST                          WSU0ST
     I              BEU1ST                          WSU1ST
     I              BEQ2CD                          WSQ2CD
     I              BEU2ST                          WSU2ST
     I              BEVEST                          WSVEST
     I              BEVFST                          WSVFST
     I              BEVGST                          WSVGST
     I              BERPCD                          WSRPCD
     I              BERNNB                          WSRNNB
     I              BEVDST                          WSVDST
     I              BEATIN                          WSATIN
     I              BEU4ST                          WSU4ST
     I              BEU5ST                          WSU5ST
     I              BERSRN                          WSRSRN
     I              BEMHNA                          WSMHNA
     I              BEMINA                          WSMINA
     I              BEWBST                          WSWBST
     I              BER4CD                          WSR4CD
     I              BEBFCD                          WSBFCD
     I              BEQ4CD                          WSQ4CD
     I              BET3NB                          WST3NB
     I              BESICD                          WSSICD
     I              BECONB                          WSCONB
     I              BECEST                          WSCEST
     I              BEAWDT                          WSAWDT
     I              BEJPCD                          WSJPCD
     I              BEXUST                          WSXUST
     I              BEZ1ST                          WSZ1ST
     I              BEVRVA                          WSVRVA
     I              BEOBST                          WSOBST
     I              BEBCST                          WSBCST
     I              BEBDST                          WSBDST
     I              BEB7VL                          WSB7VL
     I              BEGASX                          WSGASX
     I              BEGBSX                          WSGBSX
     I              BEGCSX                          WSGCSX
     I              BEGDSX                          WSGDSX
     I              BEFNSX                          WSFNSX
     I              BEFOSX                          WSFOSX
     I              BEFPSX                          WSFPSX
     I              BEFQSX                          WSFQSX
     I              BEFRSX                          WSFRSX
     I              BEFSSX                          WSFSSX
     I              BEFTSX                          WSFTSX
     I              BEFUSX                          WSFUSX
     I              BEFVSX                          WSFVSX
     I              BEFWSX                          WSFWSX
     I              BEFXSX                          WSFXSX
     I              BEFYSX                          WSFYSX
     I              BENODT                          WSNODT
     I              BENPDT                          WSNPDT
     I              BENQDT                          WSNQDT
     I              BENRDT                          WSNRDT
     I              BENSDT                          WSNSDT
     I              BEBPTM                          WSBPTM
     I              BEBQTM                          WSBQTM
     I              BEBRTM                          WSBRTM
     I              BEBSTM                          WSBSTM
     I              BEBTTM                          WSBTTM
     I              BEH0NX                          WSH0NX
     I              BEH1NX                          WSH1NX
     I              BEH2NX                          WSH2NX
     I              BEH3NX                          WSH3NX
     I              BEH4NX                          WSH4NX
     I              BEC0C7                          WSC0C7
     I              BEUVST                          WSUVST
     I              BEUWST                          WSUWST
     I              BEUXST                          WSUXST
     I              BEAATM                          WSAATM
     I              BEAYNA                          WSAYNA
     I              BEA0NA                          WSA0NA
     I              BEAXDT                          WSAXDT
      *
     IYERDCS      DS                            779
      * Outward parameters
     IPCRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PCAIC3
      * I :  Order Number
     I                                    P   3   60PCC4NB
      * I :  Order Type_Sales
     I                                        7   8 PCJNCD
      * I :  AR Customer Number
     I                                    P   9  120PCANC7
      * I :  Ship To Customer
     I                                    P  13  160PCBKC7
      * I :  Ship To Name
     I                                       17  46 PCBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PCHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PCHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PCHPNA
      * I :  Ship To City
     I                                      137 156 PCHNNA
      * I :  Ship To State Code
     I                                      157 158 PCDBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PCCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PCB0C7
      * I :  Bill to Name
     I                                      174 203 PCAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PCB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PCB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PCB4NA
      * I :  Bill to City
     I                                      294 313 PCB2NA
      * I :  Bill to State Code
     I                                      314 315 PCBHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PCC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PCBCNA
      * I :  Order Date
     I                                    P 342 3450PCA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PCA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PCGNDT
      * I :  Cancel Date
     I                                    P 354 3570PCACDT
      * I :  Terms Code
     I                                      358 359 PCAQCD
      * I :  Special Instructions
     I                                      360 399 PCB6NA
      * I :  Special Instructions 2
     I                                      400 439 PCBYNA
      * I :  Carrier Code
     I                                      440 442 PCBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PCGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PCGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PCGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PCQFST
      * I :  Reason Code
     I                                      447 449 PCCQCD
      * I :  Order in Use
     I                                      450 450 PCGJST
      * I :  Header Status
     I                                      451 451 PCGWST
      * I :  Header Status Last
     I                                      452 452 PCGXST
      * I :  Order Type Print Status
     I                                      453 453 PCGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PCAODT
      * I :  User Original Entry
     I                                      458 467 PCAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PCCXDT
      * I :  Order Value Total
     I                                    P 472 4772PCJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PCA1WG
      * I :  Credit Hold
     I                                      484 484 PCXIST
      * I :  Production Hold
     I                                      485 485 PCXJST
      * I :  New Customer Hold
     I                                      486 486 PCXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PCEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PCAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PCE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PCE9CD
      * I :  Load ID
     I                                    P 510 5130PCRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PCTBNB
      * I :  Rated Freight
     I                                    P 517 5222PCR1NB
      * I :  LTL Flag
     I                                      523 523 PCPJST
      * I :  Price Audit
     I                                      524 524 PCU0ST
      * I :  Price Status
     I                                      525 525 PCU1ST
      * I :  Shipping Method
     I                                      526 527 PCQ2CD
      * I :  Export Status
     I                                      528 528 PCU2ST
      * I :  Palletize
     I                                      529 529 PCVEST
      * I :  Shrink Wrap
     I                                      530 530 PCVFST
      * I :  Slip Sheet
     I                                      531 531 PCVGST
      * I :  Age Code
     I                                      532 532 PCRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PCRNNB
      * I :  Load Type
     I                                      536 536 PCVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PCATIN
      * I :  Load Plan Order
     I                                      541 541 PCU4ST
      * I :  Print Pick Slip
     I                                      542 542 PCU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PCRSRN
      * I :  Special Comment 1
     I                                      547 576 PCMHNA
      * I :  Special Comment 2
     I                                      577 606 PCMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PCWBST
      * I :  Sales Route Code
     I                                      608 610 PCR4CD
      * I :  Manager Level Code
     I                                      611 612 PCBFCD
      * I :  VP Level Code
     I                                      613 615 PCQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PCT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PCSICD
      * I :  Invoice Number
     I                                    P 623 6260PCCONB
      * I :  Invoice Suffix
     I                                      627 628 PCCEST
      * I :  Invoice Date
     I                                    P 629 6320PCAWDT
      * I :  Event Code
     I                                      633 634 PCJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PCXUST
      * I :  Modified Flag
     I                                      636 636 PCZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PCVRVA
      * I :  Billing Activity Type
     I                                      643 643 PCOBST
      * I :  Block Order Flag
     I                                      644 644 PCBCST
      * I :  Order Certification Flag
     I                                      645 645 PCBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PCB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PCGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PCGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PCGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PCGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PCFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PCFOSX
      * I :  Order Emailed
     I                                      658 658 PCFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PCFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PCFRSX
      * I :  Broker Order Status
     I                                      661 661 PCFSSX
      * I :  Air Freight Order
     I                                      662 662 PCFTSX
      * I :  Order Requires Review
     I                                      663 664 PCFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PCFVSX
      * I :  Export USDA Approved
     I                                      667 668 PCFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PCFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PCFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PCNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PCNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PCNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PCNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PCNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PCBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PCBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PCBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PCBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PCBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PCH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PCH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PCH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PCH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PCH4NX
      * I :  Claim Number
     I                                    P 745 7480PCC0C7
      * I :  EDI Status 1
     I                                      749 749 PCUVST
      * I :  EDI Status 2
     I                                      750 750 PCUWST
      * I :  EDI Status 3
     I                                      751 751 PCUXST
      * I :  Job Time
     I                                    P 752 7550PCAATM
      * I :  User Id
     I                                      756 765 PCAYNA
      * I :  Job Name
     I                                      766 775 PCA0NA
      * I :  Job Date
     I                                    P 776 7790PCAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WTAIC3
     I              OMC4NB                          WTC4NB
     I              OMDPNB                          WTDPNB
     I              OMUENB                          WTUENB
     I              OMHGCD                          WTHGCD
     I              OMAJCD                          WTAJCD
     I              OMBKC7                          WTBKC7
     I              OMCFC7                          WTCFC7
     I              OMGMST                          WTGMST
     I              OMGNST                          WTGNST
     I              OMMAVA                          WTMAVA
     I              OMKDVA                          WTKDVA
     I              OML8VA                          WTL8VA
     I              OML9VA                          WTL9VA
     I              OMGTST                          WTGTST
     I              OMGVST                          WTGVST
     I              OMGUST                          WTGUST
     I              OMQFST                          WTQFST
     I              OMAYVA                          WTAYVA
     I              OMEXDT                          WTEXDT
     I              OMLQCD                          WTLQCD
     I              OMRDCD                          WTRDCD
     I              OMQ7CD                          WTQ7CD
     I              OMBZPR                          WTBZPR
     I              OML6NB                          WTL6NB
     I              OMU1ST                          WTU1ST
     I              OMGIDT                          WTGIDT
     I              OMCRCD                          WTCRCD
     I              OMAGCD                          WTAGCD
     I              OMRZST                          WTRZST
     I              OMR0ST                          WTR0ST
     I              OMR1ST                          WTR1ST
     I              OMG7NA                          WTG7NA
     I              OMG8NA                          WTG8NA
     I              OMRPCD                          WTRPCD
     I              OMVEST                          WTVEST
     I              OMVGST                          WTVGST
     I              OMAVST                          WTAVST
     I              OMU0ST                          WTU0ST
     I              OMRFCD                          WTRFCD
     I              OMFZST                          WTFZST
     I              OMR1NB                          WTR1NB
     I              OMAVQT                          WTAVQT
     I              OMD0WG                          WTD0WG
     I              OMCCQT                          WTCCQT
     I              OMAUWG                          WTAUWG
     I              OMCBQT                          WTCBQT
     I              OMATWG                          WTATWG
     I              OMAQCS                          WTAQCS
     I              OMAGCS                          WTAGCS
     I              OMAKPR                          WTAKPR
     I              OMALPR                          WTALPR
     I              OMAUPR                          WTAUPR
     I              OMAVWG                          WTAVWG
     I              OMA4WG                          WTA4WG
     I              OMA5DT                          WTA5DT
     I              OMAODT                          WTAODT
     I              OMGNDT                          WTGNDT
     I              OMAMST                          WTAMST
     I              OMANST                          WTANST
     I              OMVAST                          WTVAST
     I              OMRGNB                          WTRGNB
     I              OMRHNB                          WTRHNB
     I              OMRINB                          WTRINB
     I              OMRBCD                          WTRBCD
     I              OMHICD                          WTHICD
     I              OMRNCD                          WTRNCD
     I              OMROCD                          WTROCD
     I              OMCXDT                          WTCXDT
     I              OMAJVN                          WTAJVN
     I              OMKXCD                          WTKXCD
     I              OMJPCD                          WTJPCD
     I              OMCQCD                          WTCQCD
     I              OMR4CD                          WTR4CD
     I              OMZ1ST                          WTZ1ST
     I              OMZ3ST                          WTZ3ST
     I              OMZ4ST                          WTZ4ST
     I              OMDUPR                          WTDUPR
     I              OMB6VL                          WTB6VL
     I              OMA1AA                          WTA1AA
     I              OMFZSX                          WTFZSX
     I              OMF0SX                          WTF0SX
     I              OMF1SX                          WTF1SX
     I              OMF2SX                          WTF2SX
     I              OMF3SX                          WTF3SX
     I              OMF4SX                          WTF4SX
     I              OMF5SX                          WTF5SX
     I              OMF6SX                          WTF6SX
     I              OMF7SX                          WTF7SX
     I              OMNTDT                          WTNTDT
     I              OMNUDT                          WTNUDT
     I              OMNVDT                          WTNVDT
     I              OMNWDT                          WTNWDT
     I              OMNXDT                          WTNXDT
     I              OMBUTM                          WTBUTM
     I              OMBVTM                          WTBVTM
     I              OMBWTM                          WTBWTM
     I              OMBXTM                          WTBXTM
     I              OMBYTM                          WTBYTM
     I              OMH5NX                          WTH5NX
     I              OMH6NX                          WTH6NX
     I              OMH7NX                          WTH7NX
     I              OMH8NX                          WTH8NX
     I              OMH9NX                          WTH9NX
     I              OMDVPR                          WTDVPR
     I              OMDWPR                          WTDWPR
     I              OMDXPR                          WTDXPR
     I              OMDYPR                          WTDYPR
     I              OMDZPR                          WTDZPR
     I              OMGSPR                          WTGSPR
     I              OMGTPR                          WTGTPR
     I              OMGUPR                          WTGUPR
     I              OMHOST                          WTHOST
     I              OMHPST                          WTHPST
     I              OMIOST                          WTIOST
     I              OMPEWG                          WTPEWG
     I              OMRINY                          WTRINY
     I              OMTIDT                          WTTIDT
     I              OMTJDT                          WTTJDT
     I              OMH2ST                          WTH2ST
     I              OMH0ST                          WTH0ST
     I              OMH1ST                          WTH1ST
     I              OMTKDT                          WTTKDT
     I              OMTLDT                          WTTLDT
     I              OMTMDT                          WTTMDT
     I              OMUVST                          WTUVST
     I              OMUWST                          WTUWST
     I              OMUXST                          WTUXST
     I              OMAATM                          WTAATM
     I              OMAYNA                          WTAYNA
     I              OMA0NA                          WTA0NA
     I              OMAXDT                          WTAXDT
      *
     IYFRDCS      DS                            525
     IYGRDCS      DS                            779
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WVAIC3
     I              AMC4NB                          WVC4NB
     I              AMRMNB                          WVRMNB
     I              AMRUNB                          WVRUNB
     I              AMXACD                          WVXACD
     I              AMOANA                          WVOANA
     I              AMHBAA                          WVHBAA
     I              AMJ0T1                          WVJ0T1
     I              AMGENY                          WVGENY
     I              AMJ1T1                          WVJ1T1
     I              AMHCAA                          WVHCAA
     I              AMQWDT                          WVQWDT
     I              AMQXDT                          WVQXDT
     I              AMQYDT                          WVQYDT
     I              AMHDAA                          WVHDAA
     I              AMCCTX                          WVCCTX
     I              AMJ2T1                          WVJ2T1
     I              AMRLNA                          WVRLNA
     I              AMRMNA                          WVRMNA
     I              AMGINY                          WVGINY
     I              AMGFNY                          WVGFNY
     I              AMGGNY                          WVGGNY
     I              AMGHNY                          WVGHNY
     I              AMHEVL                          WVHEVL
     I              AMHFVL                          WVHFVL
     I              AMHGVL                          WVHGVL
     I              AMQZDT                          WVQZDT
     I              AMQ0DT                          WVQ0DT
     I              AMQ1DT                          WVQ1DT
     I              AMQ2DT                          WVQ2DT
     I              AMC2TX                          WVC2TX
     I              AMC3TX                          WVC3TX
     I              AMC6TX                          WVC6TX
     I              AMCHTX                          WVCHTX
     I              AMCITX                          WVCITX
     I              AMCLTX                          WVCLTX
     I              AMB4TX                          WVB4TX
     I              AMCUTX                          WVCUTX
     I              AMCVTX                          WVCVTX
     I              AMB9TX                          WVB9TX
     I              AMJWSC                          WVJWSC
     I              AMITNY                          WVITNY
     I              AMLMT1                          WVLMT1
     I              AMLWAA                          WVLWAA
     I              AMFVST                          WVFVST
     I              AMF0ST                          WVF0ST
     I              AMF2ST                          WVF2ST
     I              AMF3ST                          WVF3ST
     I              AMJUSC                          WVJUSC
     I              AMJVSC                          WVJVSC
     I              AMV3T1                          WVV3T1
     I              AMV4T1                          WVV4T1
     I              AMV5T1                          WVV5T1
     I              AMV6T1                          WVV6T1
     I              AMV7T1                          WVV7T1
     I              AMV8T1                          WVV8T1
     I              AMV9T1                          WVV9T1
     I              AMWAT1                          WVWAT1
     I              AMWBT1                          WVWBT1
     I              AMWCT1                          WVWCT1
     I              AMWDT1                          WVWDT1
     I              AMQJNY                          WVQJNY
     I              AMQKNY                          WVQKNY
     I              AMQLNY                          WVQLNY
     I              AMP8NY                          WVP8NY
     I              AMP9NY                          WVP9NY
     I              AMQANY                          WVQANY
     I              AMQCNY                          WVQCNY
     I              AMQDNY                          WVQDNY
     I              AMQENY                          WVQENY
     I              AMQFNY                          WVQFNY
     I              AMQGNY                          WVQGNY
     I              AMQHNY                          WVQHNY
     I              AMQINY                          WVQINY
     I              AMQMNY                          WVQMNY
     I              AMMYU1                          WVMYU1
     I              AMJXSC                          WVJXSC
     I              AMJYSC                          WVJYSC
     I              AMJZSC                          WVJZSC
     I              AMJ0SC                          WVJ0SC
     I              AMMZU1                          WVMZU1
     I              AMM0U1                          WVM0U1
     I              AMM1U1                          WVM1U1
     I              AMM2U1                          WVM2U1
     I              AMM3U1                          WVM3U1
     I              AMW5DT                          WVW5DT
     I              AMW6DT                          WVW6DT
     I              AMUVST                          WVUVST
     I              AMUWST                          WVUWST
     I              AMUXST                          WVUXST
     I              AMVSST                          WVVSST
     I              AMAATM                          WVAATM
     I              AMAYNA                          WVAYNA
     I              AMA0NA                          WVA0NA
     I              AMAXDT                          WVAXDT
      *
     IYHRDCS      DS                            894
     IYIRDCS      DS                            793
     IQPDLY1    E DSPDLYREL0
      * UPD : Trailer Master            Update index
      * Renamed input format fields
     I              LYBZNA                          WWBZNA
     I              LYDXTX                          WWDXTX
     I              LYAIC3                          WWAIC3
     I              LYVDST                          WWVDST
     I              LYX3ST                          WWX3ST
     I              LYXGST                          WWXGST
     I              LYSTOY                          WWSTOY
     I              LYKKDT                          WWKKDT
     I              LYAVTM                          WWAVTM
     I              LYSTAS                          WWSTAS
     I              LYXRST                          WWXRST
     I              LYX7CD                          WWX7CD
     I              LYGXTX                          WWGXTX
     I              LYXTST                          WWXTST
     I              LYXVST                          WWXVST
     I              LYSTU3                          WWSTU3
     I              LYSTU4                          WWSTU4
     I              LYSTU5                          WWSTU5
     I              LYLCDT                          WWLCDT
     I              LYLDDT                          WWLDDT
     I              LYLEDT                          WWLEDT
     I              LYLFDT                          WWLFDT
     I              LYLGDT                          WWLGDT
     I              LYUVST                          WWUVST
     I              LYUWST                          WWUWST
     I              LYUXST                          WWUXST
     I              LYVSST                          WWVSST
     I              LYAATM                          WWAATM
     I              LYAYNA                          WWAYNA
     I              LYA0NA                          WWA0NA
     I              LYAXDT                          WWAXDT
      *
     IYJRDCS      DS                            129
     IYKRDCS      DS                            894
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I : RST Load ID
     I                                    P   1   40P1RMNB
      * N :  Scheduled Ship Date
     I                                    P   5   80P1AODT
      * N :  Load Status
     I                                        9   9 P1PKST
      * N :  Trailer Id
     I                                       10  29 P1DXTX
      * N :  Carrier Code
     I                                       30  32 P1BZNA
      * N :  Schedule Sequence Number
     I                                    P  33  350P1T4NB
      * N :  Shipping Method
     I                                       36  37 P1Q2CD
      * N :  Shipping Line
     I                                       38  40 P1XACD
      * N :  Container Number
     I                                       41  52 P1CNTN
     IP2PARM      DS
      * FLD: Order Header TRG
      * N :  Order Number
     I                                    P   1   40P2C4NB
      * N :  Ship To Customer
     I                                    P   5   80P2BKC7
      * N :  Ship To Name
     I                                        9  38 P2BRTX
      * N :  Ship To Address Line 1
     I                                       39  68 P2HMNA
      * N :  Ship To Address Line 2
     I                                       69  98 P2HONA
      * N :  Ship To Address Line 3
     I                                       99 128 P2HPNA
      * N :  Ship To City
     I                                      129 148 P2HNNA
      * N :  Ship To State Code
     I                                      149 150 P2DBCD
      * N :  Ship To Zip_Postal Code
     I                                      151 161 P2CKTX
      * N :  Header Status
     I                                      162 162 P2GWST
      * N :  Trans Contol AS400_Plant
     I                                      163 163 P2XUST
      * N :  Block Order Flag
     I                                      164 164 P2BCST
     IP3PARM      DS
      * FLD: Truck Size new
      * N :  Maximum pounds
     I                                    P   1   40P3RSNB
      * N :  Minimum pounds
     I                                    P   5   80P3TANB
     IP4PARM      DS
      * FLD: *Arrays
      * N :  USR Update Flag
     I                                        1   1 P4R4ST
      * N :  USR Check Y/N Status
     I                                        2   2 P4JDST
     IP5PARM      DS
      * FLD: Shipping Line_Port
      * N :  Port Delv Terminal
     I                                        1  20 P5OANA
      * N :  Port Address Line 1
     I                                       21  45 P5LBTX
      * N :  Port Address Line 2
     I                                       46  70 P5LATX
      * N :  Sail Port State
     I                                       71  72 P5XBCD
     IP6PARM      DS
      * FLD: *Arrays
      * N :  Company Number Pass   USR
     I                                    P   1   85P6AJAA
      * N :  Order Number 1  PASS  USR
     I                                    P   9  165P6AJAE
      * N :  Change Flag USR
     I                                       17  17 P6HWSX
     IP7PARM      DS
      * N :  Destination City
     I                                        1  20 P7XECD
     IP8PARM      DS
      * B : MAP USR Flag 1
     I                                        1   1 P8D4ST
     IP9PARM      DS
      * FLD: *Arrays
      * O :  STATUS
     I                                        1   1 P9ATUS
      * N :  Status - Y or N
     I                                        2   2 P9B8ST
      * O :  USR Status (Y/N)
     I                                        3   3 P9E6ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'Trailer Co#<>Ld Str Co#'
      * Trailer ID USR
     I                                        1  12 ZA0001
      * Message data for 'Company not found or Inva'
      * Company Number
     I                                        1   3 ZA0002
      * Message data for 'Carrier Info           NF'
      * Carrier Code
     I                                        1   3 ZA0003
      * Message data for 'Invalid Carrier for Prepd'
      * Carrier Code
     I                                        1   3 ZA0004
      * Message data for 'Carrier Info           NF'
      * Carrier Code
     I                                        1   3 ZA0005
      * Message data for 'Carrier Info           NF'
      * Carrier Code
     I                                        1   3 ZA0006
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0007
      * Message data for 'No Orders Assigned'
      * Load ID
     I                                    P   1   40ZA0008
      * *SFLSEL
     I                                        5   5 ZA0009
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0010
      * Load ID
     I                                    P   2   50ZA0011
      * Message data for 'Load Cant be Locked'
      * *SFLSEL
     I                                        1   1 ZA0012
      * Load ID
     I                                    P   2   50ZA0013
      * Message data for 'Carrier must be entered'
      * Carrier Code
     I                                        1   3 ZA0014
      * Load ID
     I                                    P   4   70ZA0015
      * Message data for 'Truck size must be enter'
      * Truck Size
     I                                        1   7 ZA0016
      * Load ID
     I                                    P   8  110ZA0017
      * Message data for 'Shipping Method required'
      * Shipping Method
     I                                        1   2 ZA0018
      * Message data for 'Load has orders w/o stop'
      * Load ID
     I                                    P   1   40ZA0019
      * Message data for 'Load is not accepted'
      * Load ID
     I                                    P   1   40ZA0020
      * Message data for 'Load has Orders on Hold'
      * Load ID
     I                                    P   1   40ZA0021
      * *SFLSEL
     I                                        5   5 ZA0022
      * Message data for 'Load has Cancelled Orders'
      * Load ID
     I                                    P   1   40ZA0023
      * *SFLSEL
     I                                        5   5 ZA0024
      * Message data for 'Load has Orders in Use'
      * *SFLSEL
     I                                        1   1 ZA0025
      * Load ID
     I                                    P   2   50ZA0026
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0027
      * Load ID
     I                                    P   2   50ZA0028
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0029
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0030
      * Load ID
     I                                    P   2   50ZA0031
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0032
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0033
      * Message data for 'Unlock Inval, close exist'
      * *SFLSEL
     I                                        1   1 ZA0034
      * Message data for 'Value Required (numeric)'
      * @Numeric 15.2
     I                                    P   1   82ZA0035
      * Message data for 'Value Required (numeric)'
      * @Numeric 15.2
     I                                    P   1   82ZA0036
      * Message data for 'Carrier doesn't exists'
      * Carrier Code
     I                                        1   3 ZA0037
      * Message data for 'Ins. Certificate 'N'o'
      * Carrier Code
     I                                        1   3 ZA0038
      * Message data for 'Insurance Expired ERR'
      * Date of Expiration
     I                                    P   1   40ZA0039
      * Carrier Code
     I                                        5   7 ZA0040
      * Insurance Type Desc
     I                                        8  37 ZA0041
      * Message data for 'Insurance Expiration WRN'
      * Date of Expiration
     I                                    P   1   40ZA0042
      * Carrier Code
     I                                        5   7 ZA0043
      * Insurance Type Desc
     I                                        8  37 ZA0044
      * Message data for 'No Cargo Ins Certificate'
      * Carrier Code
     I                                        1   3 ZA0045
      * Message data for 'Insurance Amt LT Value'
      * Amount of Cargo
     I                                    P   1   60ZA0046
      * Carrier Code
     I                                        7   9 ZA0047
      * Insurance Type Desc
     I                                       10  39 ZA0048
      * Message data for 'Insurance Expired    WRN'
      * Date of Expiration
     I                                    P   1   40ZA0049
      * Carrier Code
     I                                        5   7 ZA0050
      * Insurance Type Desc
     I                                        8  37 ZA0051
      * Message data for 'Insurance Expiration WRN'
      * Date of Expiration
     I                                    P   1   40ZA0052
      * Carrier Code
     I                                        5   7 ZA0053
      * Insurance Type Desc
     I                                        8  37 ZA0054
      * Message data for 'Ins. Certificate 'N'o'
      * Carrier Code
     I                                        1   3 ZA0055
      * Message data for 'Carrier req to enter trlr'
      * Carrier Code
     I                                        1   3 ZA0056
      * Message data for 'Trailer crtd-not on yard'
      * Trailer Id
     I                                        1  20 ZA0057
      * Message data for 'Trailer is assigned...'
      * Load ID
     I                                    P   1   40ZA0058
      * Message data for 'Trailer is assigned...'
      * Load ID
     I                                    P   1   40ZA0059
      * Message data for 'Trailer Co#<>Ld Str Co#'
      * Trailer ID USR
     I                                        1  12 ZA0060
      * Message data for 'Load type must match load'
      * Load Type
     I                                        1   1 ZA0061
      * USR Load Type
     I                                        2   2 ZA0062
      * Trailer ID USR
     I                                        3  14 ZA0063
      * Message data for 'Trailer is already assgnd'
      * Trailer ID USR
     I                                        1  12 ZA0064
      * USR Load Assigned
     I                                    P  13  160ZA0065
      * Message data for 'Trailer is not On Yard.'
      * Trailer ID USR
     I                                        1  12 ZA0066
      * Message data for 'Trailer is not Available.'
      * Trailer ID USR
     I                                        1  12 ZA0067
      * Message data for 'Trailer is Sbd owned.'
      * Trailer ID USR
     I                                        1  12 ZA0068
      * Message data for 'Inv Ld Str Co - order nf'
      * Company Number
     I                                        1   3 ZA0069
      * Message data for 'Invalid Company Number'
      * Company Number
     I                                        1   3 ZA0070
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0071
      * USR CDE Parm 1
     I                                        4   6 ZA0072
      * USR CDE Parm 2
     I                                        7   9 ZA0073
      * USR CDE Parm 3
     I                                       10  12 ZA0074
      * USR CDE Parm 4
     I                                       13  15 ZA0075
      * USR CDE Parm 5
     I                                       16  18 ZA0076
      * USR CDE Parm 6
     I                                       19  21 ZA0077
      * USR CDE Parm 7
     I                                       22  24 ZA0078
      * USR CDE Parm 8
     I                                       25  27 ZA0079
      * USR CDE Parm 9
     I                                       28  30 ZA0080
      * Message data for 'No Orders Assinged - INF'
      * Load ID
     I                                    P   1   40ZA0081
      * *SFLSEL
     I                                        5   5 ZA0082
      * Message data for 'Blck Ord on Ld-no UPD-INF'
      * *SFLSEL
     I                                        1   1 ZA0083
      * Load ID
     I                                    P   2   50ZA0084
      * Message data for 'Load Cant be Locked - INF'
      * *SFLSEL
     I                                        1   1 ZA0085
      * Load ID
     I                                    P   2   50ZA0086
      * Message data for 'Carrier must be ent.- INF'
      * Carrier Code
     I                                        1   3 ZA0087
      * Load ID
     I                                    P   4   70ZA0088
      * Message data for 'Truck size needed - INF'
      * Truck Size
     I                                        1   7 ZA0089
      * Load ID
     I                                    P   8  110ZA0090
      * Message data for 'Shipping Mthd req - INF'
      * Shipping Method
     I                                        1   2 ZA0091
      * Message data for 'Load has ords w/o stp-INF'
      * Load ID
     I                                    P   1   40ZA0092
      * Message data for 'Load is not accepted- INF'
      * Load ID
     I                                    P   1   40ZA0093
      * Message data for 'Load has Ords on Hold-INF'
      * Load ID
     I                                    P   1   40ZA0094
      * *SFLSEL
     I                                        5   5 ZA0095
      * Message data for 'Load has Cncld Ords - INF'
      * Load ID
     I                                    P   1   40ZA0096
      * *SFLSEL
     I                                        5   5 ZA0097
      * Message data for 'Load has Ords in Use-INF'
      * *SFLSEL
     I                                        1   1 ZA0098
      * Load ID
     I                                    P   2   50ZA0099
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0100
      * Load ID
     I                                    P   2   50ZA0101
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0102
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0103
      * USR CDE Parm 1
     I                                        4   6 ZA0104
      * USR CDE Parm 2
     I                                        7   9 ZA0105
      * USR CDE Parm 3
     I                                       10  12 ZA0106
      * USR CDE Parm 4
     I                                       13  15 ZA0107
      * USR CDE Parm 5
     I                                       16  18 ZA0108
      * USR CDE Parm 6
     I                                       19  21 ZA0109
      * USR CDE Parm 7
     I                                       22  24 ZA0110
      * USR CDE Parm 8
     I                                       25  27 ZA0111
      * USR CDE Parm 9
     I                                       28  30 ZA0112
      * Message data for 'Load Locked'
      * Load ID
     I                                    P   1   40ZA0113
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P8D4ST    PARM P8D4ST    WP0002  1        USR Flag 1
     C                     PARM P9ATUS    WP0003  1        STATUS
     C                     PARM P9E6ST    WP0004  1        USR Status (Y/N
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Display and process key screen
     C                     EXSR BADSKY
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1RMNB    IFEQ *ZERO                      Load ID
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB
     C           KRTV      CHAIN@FJCPBN              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     99    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     99    *
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * RTV Name, Status       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0001    P      Carrier Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DGVTX    P      Name
     C                     MOVELWL0003    WUG0TX    P      Record Status
      * RTV Truck Size Desc.   RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1RONB    WL0004    P      Truck Size
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    #DDPTX    P      Truck Size Desc
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
     C                     EXSR SCRVGN
      * RTV Active Description RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1DBCD    WL0006    P      State Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #DHSNA    P      Description
     C                     MOVELWL0008    WUG0TX    P      Record Status
      * DTL.Status Description = Condition name of DTL.Load Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70       List number
     C                     PARM #1PKST    W0INVL 25        Load Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Description 14A      USR = Condition name of DTL.Shipping Met
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #1Q2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DI6TX    PARM           W0CNNM 25        Description 14A
      *
      * DTL.USR Desc. 10 = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0009           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    #DSQTX    P      Name
      * DTL.Text USR 5 = Condition name of DTL.LH Power Only Load
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1506876   Y2LSNO  70       List number
     C                     PARM #1RXSX    W0INVL 25        LH Power Only L
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DY7TX    PARM           W0CNNM 25        Text USR 5
      *
      * USER: Initialize detail screen (existing record)
      * DTL = DB1 By name
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJJ8TX    #1J8TX           Car_Veh_Initial
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJONTM    #1ONTM           On Time_Y_N
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U_M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     MOVELFJCNTN    P1CNTN           Container Numbe
      * ** Trailer ID will now have Container# if this is an Export P0007
      * * Put trailer id into the screen field
     C                     MOVELFJDXTX    #DS2TX           Trailer ID USR
      * If Export use container number
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * CASE: DTL.Container Number is Entered
     C           #1CNTN    IFNE *BLANK                     *IF
     C                     MOVELFJCNTN    #DS2TX           Trailer ID USR
     C                     END                             *FI
     C                     END                             *FI
      * Convert Trailer ID to all caps                        E004079
      * CASE: DTL.Trailer ID USR is Entered
     C           #DS2TX    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0001           Case Sensitive
     C                     MOVEL#DS2TX    YL0001           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0001 30        Case Sensitive
     C           YL0002    PARM *BLANK    WQ0002 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0002    #DS2TX           Trailer ID USR
     C                     END                             *FI
      * Convert Container to all caps (if Exports)            E004079
      * CASE: DTL.Container Number is Entered
     C           #1CNTN    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0001           Case Sensitive
     C                     MOVEL#1CNTN    YL0001           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0003 30        Case Sensitive
     C           YL0002    PARM *BLANK    WQ0004 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0002    #1CNTN           Container Numbe
     C                     END                             *FI
      * If truck size is blank default it
      * CASE: DTL.Truck Size is Not Entered
     C           #1RONB    IFEQ *BLANK                     *IF
      * Set truck default according to load type default
      * CASE: DTL.Load Type is Regular
     C           #1VDST    IFEQ 'R'                        *IF
     C                     MOVEL*BLANK    #1RONB           Truck Size
     C                     MOVEL'T'       #1RONB           Truck Size
     C                     ELSE
      * CASE: DTL.Load Type is Bulk
     C           #1VDST    IFEQ 'B'                        *IF
     C                     MOVEL*BLANK    #1RONB           Truck Size
     C                     MOVEL'B'       #1RONB           Truck Size
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0009           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    #DSQTX    P      Name
      * RTV Name, Status       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELFJBZNA    WL0001    P      Carrier Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DGVTX    P      Name
     C                     MOVELWL0003    WUG0TX    P      Record Status
      * RTV Name, Status       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELFJXCCD    WL0001    P      Carrier Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DADTX    P      Name
     C                     MOVELWL0003    WUG0TX    P      Record Status
      * RTV Name, Status       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELFJDYTX    WL0001    P      Carrier Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DL3NA    P      Name
     C                     MOVELWL0003    WUG0TX    P      Record Status
      * RTV Truck Size Desc.   RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1RONB    WL0004    P      Truck Size
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    #DDPTX    P      Truck Size Desc
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SFRVGN
      * RTV Active Description RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELFJDBCD    WL0006    P      State Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #DHSNA    P      Description
     C                     MOVELWL0008    WUG0TX    P      Record Status
      * DTL.Status Description = Condition name of DB1.Load Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70       List number
     C                     PARM FJPKST    W0INVL 25        Load Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.USR Desc. 10 = Condition name of DB1.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM FJVDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
      * DTL.Description 14A      USR = Condition name of DB1.Shipping Met
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM FJQ2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DI6TX    PARM           W0CNNM 25        Description 14A
      *
     C                     Z-ADDFJAODT    P1AODT           Scheduled Ship
     C                     MOVELFJBZNA    P1BZNA           Carrier Code
     C                     MOVELFJBZNA    WUH8AA           Carrier Code Us
     C                     MOVELFJQ2CD    P1Q2CD           Shipping Method
     C                     MOVELFJXACD    P1XACD           Shipping Line
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0011           Load ID
     C                     MOVELP2BCST    WL0013    P      Block Order Fla
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    P4JDST    P      USR Check Y/N S
     C                     MOVELWL0013    P2BCST    P      Block Order Fla
      * Set flag whether Load Type is updatable
      * CASE: Able to update Load Type?
      *  - c1 OR c2
      *   |- c1    : PAR.USR Check Y/N Status is yes
      *   |- c2    : DB1.Load Status is Locked thru Invoiced
      *   '-
     C           P4JDST    IFEQ 'Y'                        *IF
     C           FJPKST    OREQ 'I'                        *OR
     C           FJPKST    OREQ 'L'
     C           FJPKST    OREQ 'S'
     C                     MOVEL*BLANK    P4R4ST           USR Update Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P4R4ST           USR Update Flag
     C                     END                             *FI
     C                     MOVEL#DS2TX    WUS2TX           Trailer ID USR
     C                     Z-ADDFJAIC3    WUB0C3           Load Start Comp
     C                     Z-ADD#1AIC3    YL0003           Company Number
     C                     MOVELFJPKST    P1PKST           Load Status
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0014           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    WUBKC7           Ship To Custome
     C                     MOVELWL0016    WUBRTX    P      Ship To Name
     C                     MOVELWL0017    WUHMNA    P      Ship To Address
     C                     MOVELWL0018    WUHONA    P      Ship To Address
     C                     MOVELWL0019    WUHPNA    P      Ship To Address
     C                     MOVELWL0020    #DHNNA    P      Ship To City
     C                     MOVELWL0021    WUDBCD    P      Ship To State C
     C                     MOVELWL0022    WUCKTX    P      Ship To Zip_Pos
      * RTV State Description  RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUDBCD    WL0023    P      State Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0024    #DLHNA    P      Description
     C                     MOVELWL0025    WUVSST    P      Record Status
      * E4687A JJH 02/03/16 - Remove logic for OHE Mexican Buyer Truck
      * RTV Shipping Line-OHE  RT - Order Header Extension  * P000737
     C                     EXSR SKRVGN
      * ** Rtv Ship Line name, not an error if it is not there   P000737
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    #DEZTX           USR Work Field
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Name, Status       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DEZTX    WL0001    P      Carrier Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DEET1    P      Name
     C                     MOVELWL0003    WUG0TX    P      Record Status
     C                     END                             *FI
      * If shipping line is entered, use instead of carrier   E004079
      * CASE: DTL.USR Work Field 3A is Entered
     C           #DEZTX    IFNE *BLANK                     *IF
     C                     MOVEL#DEZTX    WUR6CD           USR Carrier Cod
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1BZNA    WUR6CD           USR Carrier Cod
     C                     END                             *FI
      * Chk load status
      * CASE: DB1.Load Status is Shipped or Invoiced
     C           FJPKST    IFEQ 'I'                        *IF
     C           FJPKST    OREQ 'S'
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * E7892-Replaced 'USR Deadline Deprt Time' with 'TMS Deadline Depar
     C           FJAXTM    DIV  100       #DAGTH           TMS Deadline De
      * ** Protect fields that are Shipped or Invoiced     FP1251 01/04/2
      * CASE: DTL.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
     C                     MOVEL'L'       WUF4ST           Lock/Unlock
     C                     END                             *FI
      * ** Protect Carrier Code from changes for Collect loads   FP1251 0
      * CASE: DTL.Shipping Method is Collect
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      * CASE: DTL.Carrier Code is entered
     C           #1BZNA    IFNE *BLANK                     *IF
     C                     MOVEL'L'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Carrier code OK to reset if Prepaid and Ld Sts not locked/ship
      * CASE: DTL.Shipping Method is Prepaid
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
      * CASE: DTL.Load Status is Prior to Invoiced
     C           #1PKST    IFEQ *BLANK                     *IF
     C           #1PKST    OREQ 'C'
     C           #1PKST    OREQ 'E'
     C           #1PKST    OREQ 'L'
     C           #1PKST    OREQ 'S'
     C           #1PKST    OREQ 'U'
     C                     MOVEL'U'       WUF4ST           Lock/Unlock
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Put Override miles on screen if they are entered and hilite  E
      * CASE: DB1.Override Total Load Miles is Entered
     C           FJK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDFJK2DT    #1TLMI           Total Load Mile
      * ** Save total load miles for db update          E00207
     C                     Z-ADDFJTLMI    YL0004           Total Load Mile
     C                     MOVEL'Y'       P6HWSX           Change Flag USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     Z-ADDFJTLMI    YL0004           Total Load Mile
     C                     MOVEL'N'       P6HWSX           Change Flag USR
     C                     END                             *FI
      * ***** Save to check for changes later
     C                     Z-ADD#1FLAM    WUFLAM           Flat Amount
      * DEFAULT: Power Only Load
      * CASE: DTL.LH Power Only Load is Blank
     C           #1RXSX    IFEQ *BLANK                     *IF
      * DFT Power Only Load   IF
      * Rtv Country Code/WHS  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0026           Load ID
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0027    YL0005    P      Warehouse Code
     C                     MOVELWL0028    YL0006    P      Country Code
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0005    WL0029    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    YL0007    P      Warehouse Type
      * Rtv Country EXT       RT - Country EXT  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0006    WL0031    P      Country Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0032    YL0008    P      Country Power O
     C                     MOVELWL0033    YN0001    P      ISO Alpha2 Code
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Country Power Only Ld Dft is Yes
      *   |- c2    : LCL.Warehouse Type is Fresh
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'Y'                        *IF
     C           YL0007    IFEQ 'FR'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       #1RXSX           LH Power Only L
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #1RXSX           LH Power Only L
     C                     END                             *FI
     C                     END                             *FI
      * DTL.Text USR 5 = Condition name of DTL.LH Power Only Load
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1506876   Y2LSNO  70       List number
     C                     PARM #1RXSX    W0INVL 25        LH Power Only L
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DY7TX    PARM           W0CNNM 25        Text USR 5
      *
     C                     Z-ADDFJT4NB    P1T4NB           Schedule Sequen
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           YPMTFD    IFNE *BLANK
      * Check restriction within
     C                     EXSR VACKRL
     C                     END
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MFIZ#2
     C                     END
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Load Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VDST'  IFEQ YPMTFD
      * Load Type
     C                     MOVEL#1VDST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVDST
     C                     SELEC
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD1         ZHVDST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD2         ZHVDST
     C                     ENDSL
     C                     EXFMTZGVDST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVDST    WHEQ 1
     C                     MOVEL'B'       W0INVL           B
     C           ZHVDST    WHEQ 2
     C                     MOVEL'R'       W0INVL           R
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VDST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate LH Power Only Load
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1RXSX'  IFEQ YPMTFD
      * LH Power Only Load
     C                     MOVEL#1RXSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHRXSX
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHRXSX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHRXSX
     C                     ENDSL
     C                     EXFMTZGRXSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHRXSX    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHRXSX    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1RXSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate LPT Load Plan Start Dt
      * External date
     C                     Z-ADDV1P0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDXDINDT    #1P0DT
      * Validate LPT Load Plan Start Tm
     C                     Z-ADD#1CMTM    XTTIM
      * Check time
     C                     EXSR XTCKTM
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
      * Validate Shipping Method
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1Q2CD'  IFEQ YPMTFD
      * Shipping Method
     C                     MOVEL#1Q2CD    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHQ2CD
     C                     SELEC
     C           W0INVL    WHEQ 'CR'                       CR
     C                     Z-ADD1         ZHQ2CD
     C           W0INVL    WHEQ 'CT'                       CT
     C                     Z-ADD2         ZHQ2CD
     C           W0INVL    WHEQ 'PR'                       PR
     C                     Z-ADD3         ZHQ2CD
     C           W0INVL    WHEQ 'PT'                       PT
     C                     Z-ADD4         ZHQ2CD
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD5         ZHQ2CD
     C                     ENDSL
     C                     EXFMTZGQ2CD
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHQ2CD    WHEQ 1
     C                     MOVEL'CR'      W0INVL           CR
     C           ZHQ2CD    WHEQ 2
     C                     MOVEL'CT'      W0INVL           CT
     C           ZHQ2CD    WHEQ 3
     C                     MOVEL'PR'      W0INVL           PR
     C           ZHQ2CD    WHEQ 4
     C                     MOVEL'PT'      W0INVL           PT
     C           ZHQ2CD    WHEQ 5
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1Q2CD
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * F4=Prompt Trailer
      * CASE: PGM.*Cursor field <IS> DTL.Trailer ID USR
     C           W0CFL     IFEQ '#DS2TX'                   *IF
      * Use Shipping Line if it is entered at this point      E004079
      * CASE: DTL.USR Work Field 3A is Entered
     C           #DEZTX    IFNE *BLANK                     *IF
     C                     MOVEL#DEZTX    YL0009           Carrier Code
     C                     END                             *FI
     C                     MOVEL#DS2TX    YL0010           Trailer ID USR
     C                     Z-ADD#1AIC3    YL0003           Company Number
      * Sel Trailer           SR - Trailer  * 
     C                     CALL 'PBRFSRR'              90  Sel Trailer
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0009    WQ0007  3        Carrier Code
     C           YL0010    PARM *BLANK    WQ0008 20        Trailer Id
     C           YL0003    PARM YL0003    WQ0009  30       Company Number
     C                     PARM *BLANK    WQ0010  1        On Yard Status
     C                     PARM *ZERO     WQ0011  70       On Yard Date
     C                     PARM *ZERO     WQ0012  60       On Yard Time
     C                     PARM *BLANK    WQ0013  1        Available Statu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Trailer Co# <> Load Start Co# warning    E00117  LJB 03/12/200
      * CASE: LCL.Company Number NE DTL.Company Number
     C           YL0003    IFNE #1AIC3                     *IF
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0001           Trailer ID USR
      * Send message 'Trailer Co#<>Ld Str Co#'
     C                     MOVEL'USR3902' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * CASE: LCL.Trailer ID USR is Entered
     C           YL0010    IFNE *BLANK                     *IF
     C                     MOVELYL0010    #DS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     MOVEL#DS2TX    #1DXTX           Trailer Id
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * F4=Prompt Transloader
      * CASE: PGM.*Cursor field <IS> DTL.Transloader Carrier Code
     C           W0CFL     IFEQ '#1DYTX'                   *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1DYTX    PARM #1DYTX    WQ0014  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * F17=WW Trailer
      * CASE: DTL.*CMD key is CF17
     C           *IN17     IFEQ '1'                        *IF
      * WW Trailer             DF - PD Trailer  * 
     C                     CALL 'PDGNDFR'              90  WW Trailer
     C                     PARM *BLANK    W0RTN   7
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGNDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * 02/13/07 PKD Removed hardcoding of Company Number.
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0034           Company Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    YL0011    P      Plant Company S
     C                     MOVEL#DEZTX    #1XACD           Shipping Line
      * Check for Plant Company                      DLY029
      * CASE: LCL.Plant Company Sts is Plant Company
     C           YL0011    IFEQ 'P'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0002           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Company not found or Inva'
     C                     MOVEL'USR2270' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * Validate active carrier if entered
      * CASE: DTL.Carrier Code is entered
     C           #1BZNA    IFNE *BLANK                     *IF
      * Val Carrier Active     RT - OM Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0036    P      Carrier Code
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0003           Carrier Code
      * Send message 'Carrier Info           NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
      * CASE: DTL.Shipping Method is Prepaid
     C           #1Q2CD    IFEQ 'PR'                       *IF
     C           #1Q2CD    OREQ 'PT'
      * CASE: DTL.Carrier Code is Buyer's Truck
     C           #1BZNA    IFEQ 'BUY'                      *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0004           Carrier Code
      * Send message 'Invalid Carrier for Prepd'
     C                     MOVEL'USR4632' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate active Transloader Carrier if entered P000737
      * CASE: DTL.Transloader Carrier Code NE LCL.Blank for 4           U
     C           #DC3TX    IFNE YL0012                     *IF
      * ** Use first 3 characters for testing
     C                     MOVEL#DC3TX    YL0013           USR CDE Parm 1
      * Val Carrier Active     RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0013    WL0036    P      Carrier Code
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVELYL0013    ZA0005           USR CDE Parm 1
      * Send message 'Carrier Info           NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate active Mexican Buyer Carrier if entered P000737
      * CASE: DTL.Mexican Buyer Truck NE LCL.Blank for 4           USR
     C           #DC2TX    IFNE YL0012                     *IF
      * ** Use first 3 characters for testing
     C                     MOVEL#DC2TX    YL0013           USR CDE Parm 1
      * Val Carrier Active     RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0013    WL0036    P      Carrier Code
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVELYL0013    ZA0006           USR CDE Parm 1
      * Send message 'Carrier Info           NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * F20=Add Traffic Comments
      * CASE: DTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
      * EDT PD Traffic Comment EF - PD Traffic Comments  * 
     C                     CALL 'PDCZEFR'              90  EDT PD Traffic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0015  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCZEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * No scheduled ship date entered
      * CASE: Sched ship date not entered with orders on load
      *  - c1 AND c2
      *   |- c1    : DTL.Scheduled Ship Date EQ WRK.ZERO
      *   |- c2    : PAR.USR Check Y/N Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AODT    IFEQ WUW0NB                     *IF
     C           P4JDST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0007
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * F15=Lock Load request
      * CASE: DTL.*CMD key is *Lock Load
     C           *IN15     IFEQ '1'                        *IF
      * ** Don't allow lock load if errors pending in Order Detail  P0012
      *
     C                     Z-ADD*ZERO     WN0001  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0002  70       Minimum pounds
     C                     MOVEL*BLANK    WN0003  1        USR Orders on L
     C                     MOVEL*BLANK    WN0004  1        Order in Use
     C                     MOVEL*BLANK    WN0005  1        Header Status
     C                     MOVEL*BLANK    WN0006  1        Access Denied (
      *
      * EDT Lock Load Edits    IF
      * assume will have error
     C                     MOVEL'Y'       WUECST           Error Status
      *
     C                     MOVEL*BLANK    WN0007 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0007           User Profile Na
      *
     C                     MOVEL*BLANK    WN0008 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0007    WL0037    P      User Profile Na
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    WUG0TX    P      Allow Multi_Com
     C                     MOVELWL0039    WUG0TX    P      Default Printer
     C                     MOVELWL0040    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0041    YL0014           Company Number
     C                     MOVELWL0042    WN0008    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0008    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0007    WL0043    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0044    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    WUAIC3           Company Number
     C                     MOVELWL0046    YL0015    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0008    WL0043    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0044    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    WUAIC3           Company Number
     C                     MOVELWL0046    YL0015    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0015    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0014    IFGT 0                          *IF
     C                     Z-ADDYL0014    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0015    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0016    WL0048           Shipping Compan
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0006           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WUG0TX    P      Name
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0006    IFEQ 'Y'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0049           Load ID
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    WN0003    P      Status - Y or N
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0008           Load ID
     C                     MOVELWUSEL     ZA0009           *SFLSEL
      * Send message 'No Orders Assigned'
     C                     MOVEL'USR1276' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           P2BCST    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0010           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0011           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'L'
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVELWUSEL     ZA0012           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0013           Load ID
      * Send message 'Load Cant be Locked'
     C                     MOVEL'USR2189' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Carrier Code EQ WRK.BLANK
     C           #1BZNA    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0014           Carrier Code
     C                     Z-ADD#1RMNB    ZA0015           Load ID
      * Send message 'Carrier must be entered'
     C                     MOVEL'USR1253' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           #1RONB    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1RONB    ZA0016           Truck Size
     C                     Z-ADD#1RMNB    ZA0017           Load ID
      * Send message 'Truck size must be enter'
     C                     MOVEL'USR1255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9941  *
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           #1Q2CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1Q2CD    ZA0018           Shipping Method
      * Send message 'Shipping Method required'
     C                     MOVEL'USR2197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0003    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0019           Load ID
      * Send message 'Load has orders w/o stop'
     C                     MOVEL'USR2196' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           #1RMST    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0020           Load ID
      * Send message 'Load is not accepted'
     C                     MOVEL'USR2514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - OP Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0053           Load ID
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WN0004    P      Order in Use
     C                     MOVELWL0052    WN0005    P      Header Status
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0005    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0021           Load ID
     C                     MOVELWUSEL     ZA0022           *SFLSEL
      * Send message 'Load has Orders on Hold'
     C                     MOVEL'USR1921' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0005    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0023           Load ID
     C                     MOVELWUSEL     ZA0024           *SFLSEL
      * Send message 'Load has Cancelled Orders'
     C                     MOVEL'USR2236' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0004    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0025           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0026           Load ID
      * Send message 'Load has Orders in Use'
     C                     MOVEL'USR2280' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Check if Export Order Automation Upload had errors  P001251
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0054           Load ID
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    YL0017    P      Order Requires
      * ** Cannot lock if Upload had errors                  P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0017    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0027           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0028           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1RONB    WL0056    P      Truck Size
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0057    WN0001           Maximum pounds
     C                     Z-ADDWL0058    WN0002           Minimum pounds
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           #1RPNB    IFLT WN0002                     *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0029           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           #1RPNB    IFGT WN0001                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * CASE: WRK.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * F16=Unlock load request
      * CASE: DTL.*CMD key is *Unlock Load
     C           *IN16     IFEQ '1'                        *IF
      * RMC PFS017 06/05/06  new par.allow unlock if picked = N
      *
     C                     MOVEL*BLANK    WN0009  1        Access Denied (
      *
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       WUECST           Error Status
      *
     C                     MOVEL*BLANK    WN0010 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0010           User Profile Na
      *
     C                     MOVEL*BLANK    WN0011 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0010    WL0037    P      User Profile Na
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    WUG0TX    P      Allow Multi_Com
     C                     MOVELWL0039    WUG0TX    P      Default Printer
     C                     MOVELWL0040    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0041    YL0014           Company Number
     C                     MOVELWL0042    WN0011    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0011    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0010    WL0043    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0044    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    WUAIC3           Company Number
     C                     MOVELWL0046    YL0015    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0011    WL0043    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0044    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    WUAIC3           Company Number
     C                     MOVELWL0046    YL0015    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0015    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0014    IFGT 0                          *IF
     C                     Z-ADDYL0014    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0015    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0016    WL0048           Shipping Compan
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0009           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WUG0TX    P      Name
     C                     END                             *FI
      * check the entry control field too.  4/28/05 so christa can do.
      * Rtv Unlock Load Authr RT - Entry Control  * 
     C                     EXSR SYRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : WRK.Unlock Load Authority is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0009    IFEQ 'Y'                        *IF
     C           WUHTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't unlock. RMC Chg for picked 5/31/0
      * CASE: PAR.Block Order Flag is Block Order
     C           P2BCST    IFEQ 'B'                        *IF
      *   (load contains a block order)
      * Setup message data for message
     C                     MOVELWUSEL     ZA0030           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0031           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0032           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Do this one if par is NO. We dont want an UNLOCK if there are XOx
      *   and it isnt shipping doing it.
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0016  70       Load ID
     C                     PARM #1AIC3    WQ0017  30       Company Number
     C           WUZMST    PARM WUZMST    WQ0018  1        Pick Status USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
      * Allow if picked but not Close Order or Close Truck  5/31/06
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * CASE: PAR.Allow Unlock if Picked St is No
     C           'N'       IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0033           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Close Ord/Trk XF - PFS Ship Load/Order Sts  * 
     C                     CALL 'PPYIXFR'              90  PFS Val Close O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0019  70       Load ID
     C           WUB8ST    PARM *BLANK    WQ0020  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0034           *SFLSEL
      * Send message 'Unlock Inval, close exist'
     C                     MOVEL'USR3629' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
     C                     MOVEL'U'       P1PKST           Load Status
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     Z-ADD*ZERO     #1FLAM           Flat Amount
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * convert trailer id
      * CASE: WRK.Trailer ID Numeric    USR EQ WRK.ZERO
     C           WUGQNX    IFEQ WUW0NB                     *IF
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUO7NA           Trailer Number
     C                     MOVELWUGQNX    WUO7NA           Trailer Number
     C                     MOVELWUO7NA    #1DXTX           Trailer Id
     C                     END                             *FI
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     MOVEL#DS2TX    #1DXTX           Trailer Id
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0014           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    WUBKC7           Ship To Custome
     C                     MOVELWL0016    WUBRTX    P      Ship To Name
     C                     MOVELWL0017    WUHMNA    P      Ship To Address
     C                     MOVELWL0018    WUHONA    P      Ship To Address
     C                     MOVELWL0019    WUHPNA    P      Ship To Address
     C                     MOVELWL0020    #DHNNA    P      Ship To City
     C                     MOVELWL0021    WUDBCD    P      Ship To State C
     C                     MOVELWL0022    WUCKTX    P      Ship To Zip_Pos
      * RTV State Description  RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUDBCD    WL0023    P      State Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0024    #DLHNA    P      Description
     C                     MOVELWL0025    WUVSST    P      Record Status
      * Fill in ship from warehouse, if none entered             S00558
      * CASE: DTL.Ship From Warehouse EQ WRK.BLANK
     C           #1VPCD    IFEQ WUGSTX                     *IF
      * RTV First Order Whse   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0059           Load ID
     C                     Z-ADD*ZERO     WL0060           Stop_Drop
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0061    #1VPCD    P      Warehouse Code
     C                     END                             *FI
      * If Date entered, Time s/b entered too
      * CASE: DTL.LPT Load Plan Start Dt is GT 0
     C           #1P0DT    IFGT *ZERO                      *IF
      * CASE: DTL.LPT Load Plan Start Tm is 00:00:00
     C           #1CMTM    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1CMTM    ZA0035           LPT Load Plan S
      * Send message 'Value Required (numeric)'
     C                     MOVEL'USR1962' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9936  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If Time entered, Date s/b entered too
      * CASE: DTL.LPT Load Plan Start Tm is GT 0
     C           #1CMTM    IFGT 0                          *IF
      * CASE: DTL.LPT Load Plan Start Dt is NOT ENTERED
     C           #1P0DT    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Convert LPT Load Plan Start Dt to display format
      * Convert date
     C           1000000   ADD  #1P0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0036
      * Send message 'Value Required (numeric)'
     C                     MOVEL'USR1962' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9935  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Calendar Master
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Check reference to Carrier Info
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9937  *
     C                     END
      * Check reference to Truck Size new
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9941  *
     C                     END
      * Check reference to Warehouse Codes
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State Master
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9943  *
     C                     END
      * Check reference to Carrier Info
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9938  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
      * RTV Name, Status       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0001    P      Carrier Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DGVTX    P      Name
     C                     MOVELWL0003    WUG0TX    P      Record Status
      * RTV Truck Size Desc.   RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1RONB    WL0004    P      Truck Size
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    #DDPTX    P      Truck Size Desc
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
     C                     EXSR TDRVGN
      * RTV Active Description RT - State  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1DBCD    WL0006    P      State Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0007    #DHSNA    P      Description
     C                     MOVELWL0008    WUG0TX    P      Record Status
      * DTL.Status Description = Condition name of DTL.Load Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1195931   Y2LSNO  70       List number
     C                     PARM #1PKST    W0INVL 25        Load Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * DTL.Description 14A      USR = Condition name of DTL.Shipping Met
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM #1Q2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DI6TX    PARM           W0CNNM 25        Description 14A
      *
      * DTL.USR Desc. 10 = Condition name of DTL.Load Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1250409   Y2LSNO  70       List number
     C                     PARM #1VDST    W0INVL 25        Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DNCNA    PARM           W0CNNM 25        USR Desc. 10
      *
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0009           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    #DSQTX    P      Name
      * DTL.Text USR 5 = Condition name of DTL.LH Power Only Load
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1506876   Y2LSNO  70       List number
     C                     PARM #1RXSX    W0INVL 25        LH Power Only L
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DY7TX    PARM           W0CNNM 25        Text USR 5
      *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Set load sts if O.E. created load and has stops
      * CASE: DTL.Load Status is Entered or Combined
     C           #1PKST    IFEQ 'E'                        *IF
     C           #1PKST    OREQ 'C'
      * CASE: Lock or Unlock key pressed
      *  - c1 OR c2
      *   |- c1    : DTL.*CMD key is *Lock Load
      *   |- c2    : DTL.*CMD key is *Unlock Load
      *   '-
     C           *IN15     IFEQ '1'                        *IF
     C           *IN16     OREQ '1'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0049           Load ID
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    P9B8ST    P      Status - Y or N
      * All details have stop
      * CASE: PAR.Status - Y or N is no
     C           P9B8ST    IFEQ 'N'                        *IF
     C                     MOVEL'U'       P1PKST           Load Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Load has orders w/ no stp'
     C                     MOVEL'USR2195' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Fill in ship from whse, ship to state when lock load
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Lock Load
      *   |- c2    : WRK.Error Status is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN15     IFEQ '1'                        *IF
     C           WUECST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Fill in ship from warehouse, if locking load and none entered
      * CASE: DTL.Ship From Warehouse EQ WRK.BLANK
     C           #1VPCD    IFEQ WUGSTX                     *IF
      * RTV First Order Whse   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0059           Load ID
     C                     Z-ADD*ZERO     WL0060           Stop_Drop
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0061    #1VPCD    P      Warehouse Code
     C                     END                             *FI
      * Fill in ship to state, if locking load and none entered
      * CASE: DTL.Ship To State Code EQ WRK.BLANK
     C           #1DBCD    IFEQ WUGSTX                     *IF
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0014           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    WUBKC7           Ship To Custome
     C                     MOVELWL0016    WUBRTX    P      Ship To Name
     C                     MOVELWL0017    WUHMNA    P      Ship To Address
     C                     MOVELWL0018    WUHONA    P      Ship To Address
     C                     MOVELWL0019    WUHPNA    P      Ship To Address
     C                     MOVELWL0020    WUHNNA    P      Ship To City
     C                     MOVELWL0021    #1DBCD    P      Ship To State C
     C                     MOVELWL0022    WUCKTX    P      Ship To Zip_Pos
     C                     END                             *FI
      * OMS132:  Fill in Flat amount, if possible, from Carr Dest Rate fi
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Flat Amount EQ WRK.ZERO
      *   |- c2    : DTL.Total Stops is One Stop
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FLAM    IFEQ WUW0NB                     *IF
     C           #1RRNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0062           Load ID
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    P7XECD    P      Ship To City
     C                     MOVELWL0064    WUBGCD    P      Ship To State C
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAP7XECD    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    P7XECD           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XCCD    WL0065    P      Carrier Code
     C                     MOVEL#1VPCD    WL0066    P      Warehouse Code
     C                     MOVELP7XECD    WL0067    P      Destination Cit
     C                     MOVELWUBGCD    WL0068    P      State Code
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    #1FLAM           Flat Rate
      * ** If NRF, try using state in city         7/13/2007 LJB DLY029
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    P7XECD           Destination Cit
     C                     MOVELWUBGCD    P7XECD           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XCCD    WL0065    P      Carrier Code
     C                     MOVEL#1VPCD    WL0066    P      Warehouse Code
     C                     MOVELP7XECD    WL0067    P      Destination Cit
     C                     MOVELWUBGCD    WL0068    P      State Code
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    #1FLAM           Flat Rate
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set confirm for shipped, invoiced loads
      * CASE: DTL.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * VAL: Carrier exists & Carrier Insurance exists           E00230
      * CASE: DTL.Carrier Code is entered
     C           #1BZNA    IFNE *BLANK                     *IF
      * Val Carrier Active     RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0036    P      Carrier Code
     C                     EXSR SQRVGN
      * ** Quit if no carrier
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0037           Carrier Code
      * Send message 'Carrier doesn't exists'
     C                     MOVEL'USR1252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Validate Insurance if NOT MG Created Load
      * CASE: DTL.MG Created Load is Not MG Created Load
     C           #1RYSX    IFEQ *BLANK                     *IF
      * Val Ins Existance     RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0070    P      Carrier Code
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    WUWXST    P      Record Found US
      * ** Quit if carrier has no insurance records           E00230
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0038           Carrier Code
      * Send message 'Ins. Certificate 'N'o'
     C                     MOVEL'USR2418' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * VAL: Auto insurance expiration date                      E00230
      * Val Insurance Expire  RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0072    P      Carrier Code
     C                     MOVEL'AUTO'    WL0073    P      Insurance Type
     C                     Z-ADD#1AODT    WL0074           Scheduled Ship
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0075    YL0018    P      Error Flag
      * ** quit if insurance cert has already expired
      * CASE: LCL.Error Flag            USR is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * ***
      * VAL: Cargo insurance expiration date                     E00230
      * Val Insurance Expire  RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0072    P      Carrier Code
     C                     MOVEL'CARGO'   WL0073    P      Insurance Type
     C                     Z-ADD#1AODT    WL0074           Scheduled Ship
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0075    YL0018    P      Error Flag
      * ** quit if insurance cert has already expired
      * CASE: LCL.Error Flag            USR is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * ***
     C                     Z-ADD*ZERO     #DVSVA           USR Total Order
      * RTV Load Dollar Amount RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0078           Load ID
     C                     Z-ADD#DVSVA    WL0079           USR Total Order
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    #DVSVA           USR Total Order
      * Val Cargo Insurance    RT - Carrier Insurance  *      E00230
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0080    P      Carrier Code
     C                     MOVEL'CARGO'   WL0081    P      Insurance Type
     C                     Z-ADD#1AODT    WL0082           Scheduled Ship
     C                     Z-ADD#DVSVA    WL0084           USR Total Order
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0018    P      Error Flag
      * ** quit if Cargo Insurance amt is less than Load cargo amount
      * CASE: LCL.Error Flag            USR is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * ***
      * VAL: General insurance expiration date-WARNING only, don't quit
      * Val Ins Expire/Warning RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0085    P      Carrier Code
     C                     MOVEL'GEN'     WL0086    P      Insurance Type
     C                     Z-ADD#1AODT    WL0087           Scheduled Ship
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0088    YL0018    P      Error Flag
      * ***
      * VAL: Workers Comp expiration date-WARNING only, don't quit
      * Val Ins Expire/Warning RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0085    P      Carrier Code
     C                     MOVEL'WRKCMP'  WL0086    P      Insurance Type
     C                     Z-ADD#1AODT    WL0087           Scheduled Ship
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0088    YL0018    P      Error Flag
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Mexican Carrier exists & has valid insurance        P000737
      * CASE: DTL.OHE Mexican Buyer Truck NE WRK.Blank for 4           US
     C           #DC2TX    IFNE WUOTTX                     *IF
      * ** move mexican carrier code to a 3 char field
     C                     MOVEL#DC2TX    YL0024           Text 3 Length U
      * Val Carrier Active     RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0036    P      Carrier Code
     C                     EXSR SQRVGN
      * ** Don't Quit if no carrier
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * ** for now, just set return code to normal
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
      * Validate Insurance if NOT an MG Created load
      * CASE: DTL.MG Created Load is Not MG Created Load
     C           #1RYSX    IFEQ *BLANK                     *IF
      * Val Ins Existance     RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0070    P      Carrier Code
     C                     EXSR TGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    WUWXST    P      Record Found US
      * ** Don't quit at this time for Mexican Carriers
      * ** Don't quit if carrier has no insurance records           E0023
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#DC2TX    ZA0055           OHE Carrier SCA
      * Send message 'Ins. Certificate 'N'o'
     C                     MOVEL'USR2418' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * VAL: Auto insurance expiration date                      E00230
      * Val Insurance Expire  RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0072    P      Carrier Code
     C                     MOVEL'AUTO'    WL0073    P      Insurance Type
     C                     Z-ADD#1AODT    WL0074           Scheduled Ship
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0075    YL0018    P      Error Flag
      * ** Don't quit at this time for Mexican Carriers
      * ** don't quit if insurance cert has already expired
      * CASE: LCL.Error Flag            USR is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     END                             *FI
      * ***
      * VAL: Cargo insurance expiration date                     E00230
      * Val Insurance Expire  RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0072    P      Carrier Code
     C                     MOVEL'CARGO'   WL0073    P      Insurance Type
     C                     Z-ADD#1AODT    WL0074           Scheduled Ship
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0075    YL0018    P      Error Flag
      * ** Don't quit at this time for Mexican Carriers
      * ** don't quit if insurance cert has already expired
      * CASE: LCL.Error Flag            USR is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     END                             *FI
      * ***
     C                     Z-ADD*ZERO     #DVSVA           USR Total Order
      * RTV Load Dollar Amount RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0078           Load ID
     C                     Z-ADD#DVSVA    WL0079           USR Total Order
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0079    #DVSVA           USR Total Order
      * Val Cargo Insurance    RT - Carrier Insurance  *      E00230
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0080    P      Carrier Code
     C                     MOVEL'CARGO'   WL0081    P      Insurance Type
     C                     Z-ADD#1AODT    WL0082           Scheduled Ship
     C                     Z-ADD#DVSVA    WL0084           USR Total Order
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0083    YL0018    P      Error Flag
      * ** Don't quit at this time for Mexican Carriers
      * ** don't quit if Cargo Insurance amt is less than Load cargo amou
      * CASE: LCL.Error Flag            USR is Yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     END                             *FI
      * ***
      * VAL: General insurance expiration date-WARNING only, don't quit
      * Val Ins Expire/Warning RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0085    P      Carrier Code
     C                     MOVEL'GEN'     WL0086    P      Insurance Type
     C                     Z-ADD#1AODT    WL0087           Scheduled Ship
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0088    YL0018    P      Error Flag
      * ***
      * VAL: Workers Comp expiration date-WARNING only, don't quit
      * Val Ins Expire/Warning RT - Carrier Insurance  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0024    WL0085    P      Carrier Code
     C                     MOVEL'WRKCMP'  WL0086    P      Insurance Type
     C                     Z-ADD#1AODT    WL0087           Scheduled Ship
     C                     EXSR TLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0088    YL0018    P      Error Flag
     C                     END                             *FI
     C                     END                             *FI
      * If carrier code is entered and carrier broker is not default brok
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Carrier Code is entered
      *   |- c2    : DTL.Carrier Broker is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BZNA    IFNE *BLANK                     *IF
     C           #1XCCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL#1BZNA    #1XCCD           Carrier Broker
      * C7674:  Fill in Flat amount, if possible
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Flat Amount EQ WRK.ZERO
      *   |- c2    : DTL.Total Stops is One Stop
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1FLAM    IFEQ WUW0NB                     *IF
     C           #1RRNB    IFEQ 1                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0062           Load ID
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    P7XECD    P      Ship To City
     C                     MOVELWL0064    WUBGCD    P      Ship To State C
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAP7XECD    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       YL0025           LOAD OUTPUT
     C                     MOVELYL0025    P7XECD           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XCCD    WL0065    P      Carrier Code
     C                     MOVEL#1VPCD    WL0066    P      Warehouse Code
     C                     MOVELP7XECD    WL0067    P      Destination Cit
     C                     MOVELWUBGCD    WL0068    P      State Code
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    #1FLAM           Flat Rate
      * ** If NRF, try again with State code in place of the city
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    P7XECD           Destination Cit
     C                     MOVELWUBGCD    P7XECD           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XCCD    WL0065    P      Carrier Code
     C                     MOVEL#1VPCD    WL0066    P      Warehouse Code
     C                     MOVELP7XECD    WL0067    P      Destination Cit
     C                     MOVELWUBGCD    WL0068    P      State Code
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    #1FLAM           Flat Rate
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Carrier Name       RT - OM Carrier  * 
     C                     EXSR TMRVGN
      * Not an error if Carrier Broker name is not there
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     END                             *FI
      * If Export put dtl.trailer into container
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Export Status is yes
      *   |- c2    : DTL.Shipping Line is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFEQ 'Y'                        *IF
     C           #1XACD    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DTL.Trailer ID USR is Entered
     C           #DS2TX    IFNE *BLANK                     *IF
     C                     MOVEL#DS2TX    #1CNTN           Container Numbe
     C                     END                             *FI
     C                     END                             *FI
      * Convert Container to all caps (for Exports)           E004079
      * CASE: LCL.Trailer ID USR is Entered
     C           YL0010    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0001           Case Sensitive
     C                     MOVEL#1CNTN    YL0001           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0026 30        Case Sensitive
     C           YL0002    PARM *BLANK    WQ0027 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0002    #1CNTN           Container Numbe
     C                     END                             *FI
      * Convert Trailer ID to all caps                        E004079
      * CASE: LCL.Trailer ID USR is Entered
     C           YL0010    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0001           Case Sensitive
     C                     MOVEL#DS2TX    YL0001           Case Sensitive
      * CVT to Upper Alpha 3   XF - /UT User Source  * 
     C                     CALL 'PBSBXFR'              90  CVT to Upper Al
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0028 30        Case Sensitive
     C           YL0002    PARM *BLANK    WQ0029 30        Case Upper Fiel
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBSBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0002    #DS2TX           Trailer ID USR
     C                     END                             *FI
      * If Shipping Line is entered, use instead of Carrier   E004079
      * CASE: DTL.USR Work Field 3A is Entered
     C           #DEZTX    IFNE *BLANK                     *IF
     C                     MOVEL#DEZTX    YL0009           Carrier Code
     C                     MOVEL#DEZTX    #1XACD           Shipping Line
     C                     MOVEL#1CNTN    YL0010           Trailer ID USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1BZNA    YL0009           Carrier Code
     C                     MOVEL#DS2TX    YL0010           Trailer ID USR
     C                     END                             *FI
      * OMS301 -- Validate Trailer        +changes for E004079
      * CASE: IF Trailer entered & trailer/carr/shipline changed
      *  - c1 AND (c2 OR c3)
      *   |- c1    : LCL.Trailer ID USR NE WRK.Blank for 12          USR
      *   |- c2    : LCL.Trailer ID USR NE WRK.Trailer ID USR
      *   |- c3    : LCL.Carrier Code NE WRK.USR Carrier Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFNE WUS3TX                     *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0010    IFNE WUS2TX                     *IF
     C           YL0009    ORNE WUR6CD                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Output Co# to lcl context for comparison to ld str co#   FP125
      * ** Output Carr or ShipLine to lcl context for compare       E0040
      * ** Rtv new trailer info for Shipline or for Carrier
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0009    WL0089    P      Carrier Code
     C                     MOVELYL0010    WL0090    P      Trailer Id
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0091    YL0003           Company Number
     C                     MOVELWL0092    WUWNST    P      Load Type
     C                     MOVELWL0093    WUX3ST    P      Trailer Type
     C                     MOVELWL0094    WUXGST    P      Seaboard Owned
     C                     MOVELWL0095    WUSTOY    P      On Yard Status
     C                     Z-ADDWL0096    WULMDT           On Yard Date
     C                     Z-ADDWL0097    WUA2TM           On Yard Time
     C                     MOVELWL0098    WUSTAS    P      Assigned Status
     C                     MOVELWL0099    WUXRST    P      Available Statu
     C                     MOVELWL0100    WUX7CD    P      Not Available R
     C                     MOVELWL0101    WUGXTX    P      Comment Line
     C                     MOVELWL0102    WUVSST    P      Record Status
      * Carrier required to add Trailer. Add trailer if it doesn't exist.
      * CASE: WRK.USR Load Type is Blank
     C           WUWNST    IFEQ *BLANK                     *IF
      * error: carr or shipline req'd
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Carrier Code EQ WRK.BLANK
      *   |- c2    : DTL.Shipping Line is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1BZNA    IFEQ WUGSTX                     *IF
     C           #1XACD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0056           Carrier Code
      * Send message 'Carrier req to enter trlr'
     C                     MOVEL'USR2668' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** E002966 If trailer is not on yard, add to file with zeros in d
      * ** Put the Trailer ID in the Load Hdr and zeroes in the OYD/T
      * CASE: WRK.On Yard Status is no
     C           WUSTOY    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0057           Trailer ID USR
      * Send message 'Trailer crtd-not on yard'
     C                     MOVEL'USR4692' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     END                             *FI
      * * If shipline entered put trailer in container for exports  E0040
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * CASE: DTL.USR Work Field 3A is Entered
     C           #DEZTX    IFNE *BLANK                     *IF
     C                     MOVEL#DS2TX    #1CNTN           Container Numbe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Record Status is Active
     C           WUVSST    IFEQ 'A'                        *IF
      * Validate using shipline if entered, else carrier      E004079
      * Validate carr/trailer are not already assigned    E002105
      * CASE: DTL.Export Status is no
     C           #1U2ST    IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     YL0026           Load ID USR
      * VAL Trailer assignmnt RT - Load Header  * 
     C                     EXSR TORVGN
      * Trailer
      * CASE: PGM.*Return code is Trailer already assigned
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     Z-ADDYL0027    ZA0058           Load Id 3
      * Send message 'Trailer is assigned...'
     C                     MOVEL'USR2822' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Otherwise, fill in On Yard Dt/Tm from Trailer file   E002966
     C                     Z-ADDWULMDT    #1KKDT           On Yard Date
     C                     Z-ADDWUA2TM    #1AVTM           On Yard Time
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0026           Load ID USR
      * VAL ShpLin/Cntnr-dup   RT - Order Header Extension  * 
     C                     EXSR TPRVGN
     C                     MOVEL'N'       YL0030           Record Found US
      * Export Load
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * CASE: PGM.*Return code is Trailer already assigned
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     Z-ADDYL0031    ZA0059           Load Id 1
      * Send message 'Trailer is assigned...'
     C                     MOVEL'USR2822' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       YL0030           Record Found US
     C                     ELSE
      * CASE: PGM.*Return code is Trailer Available to assn
     C           W0RTN     IFEQ @CN,004                    *IF
      * ** Populate Ld Hdr on yard date and time             E002966
      * ** This will update the Load Header file
      * ** Put the Trailer ID in Container ID for exports     E002966
     C                     MOVEL#DS2TX    #1CNTN           Container Numbe
     C                     MOVEL#DEZTX    #1XACD           Shipping Line
     C                     Z-ADDWULMDT    #1KKDT           On Yard Date
     C                     Z-ADDWUA2TM    #1AVTM           On Yard Time
     C                     ELSE
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * ** Populate Ld Hdr on yard date and time             E002966
      * ** This will update the Load Header file
     C                     Z-ADDWULMDT    #1KKDT           On Yard Date
     C                     Z-ADDWUA2TM    #1AVTM           On Yard Time
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Company Number NE DTL.Company Number
     C           YL0003    IFNE #1AIC3                     *IF
      * ** Info test moved to after error tests               E002105
      * ** Trailer Co# <> Load Start Co# - warining msg       E00117  3/1
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0060           Trailer ID USR
      * Send message 'Trailer Co#<>Ld Str Co#'
     C                     MOVEL'USR3902' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Load type
      * CASE: WRK.USR Load Type NE DTL.Load Type
     C           WUWNST    IFNE #1VDST                     *IF
      * Setup message data for message
     C                     MOVEL#1VDST    ZA0061           Load Type
     C                     MOVELWUWNST    ZA0062           USR Load Type
     C                     MOVEL#DS2TX    ZA0063           Trailer ID USR
      * Send message 'Load type must match load'
     C                     MOVEL'USR2613' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993239*
      *
     C                     END                             *FI
      * Assigned Status
      * CASE: WRK.Assigned Status is yes
     C           WUSTAS    IFEQ 'Y'                        *IF
      * RTV Load ID for Trailr RT - Load Header  * 
     C                     EXSR TRRVGN
      * CASE: WRK.USR Active Load is yes
     C           WUZJST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0064           Trailer ID USR
     C                     Z-ADDWUL1LD    ZA0065           USR Load Assign
      * Send message 'Trailer is already assgnd'
     C                     MOVEL'USR2618' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * On Yard date
      * CASE: WRK.USR On Yard Date New is not entered
     C           WULMDT    IFEQ *ZERO                      *IF
      * ** If trailer is not on yard, put zeroes in OYD/T   E002966 2/12/
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0066           Trailer ID USR
      * Send message 'Trailer is not On Yard.'
     C                     MOVEL'USR2619' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Populate the fields with the on yard date and time  E002966
      * ** This will update the Load Header file
     C                     Z-ADDWULMDT    #1KKDT           On Yard Date
     C                     Z-ADDWUA2TM    #1AVTM           On Yard Time
     C                     END                             *FI
      * Available sts
      * CASE: WRK.Available Status is Not Yes
     C           WUXRST    IFEQ *BLANK                     *IF
     C           WUXRST    OREQ 'N'
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0067           Trailer ID USR
      * Send message 'Trailer is not Available.'
     C                     MOVEL'USR2616' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Seaboard owned
      * CASE: WRK.Seaboard Owned Status is yes
     C           WUXGST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#DS2TX    ZA0068           Trailer ID USR
      * Send message 'Trailer is Sbd owned.'
     C                     MOVEL'USR2617' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
      * Put Trailer in Container for exports if ShipLine entered    E0040
      * CASE: DTL.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * CASE: DTL.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
     C                     MOVEL#DS2TX    #1CNTN           Container Numbe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * OMS132:  default Allocate Pounds/Miles based on load type
      * CASE: PAR.USR Update Flag is Yes
     C           P4R4ST    IFEQ 'Y'                        *IF
      * CASE: DTL.Load Type is Regular
     C           #1VDST    IFEQ 'R'                        *IF
     C                     MOVEL'M'       #1XQST           Allocate Pounds
     C                     ELSE
      * CASE: DTL.Load Type is Bulk
     C           #1VDST    IFEQ 'B'                        *IF
     C                     MOVEL'T'       #1XQST           Allocate Pounds
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       #1XQST           Allocate Pounds
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 02/13/07 PKD Removed hardcoding of company number.
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0034           Company Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    YL0011    P      Plant Company S
      * Validate load start co
      * CASE: LCL.Plant Company Sts is Plant Company
     C           YL0011    IFEQ 'P'                        *IF
      * VAL Load Start Co      RT - Load Detail  * 
     C                     EXSR TSRVGN
      * CASE: PAR.Status - Y or N is no
     C           P9B8ST    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0069           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0069           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Inv Ld Str Co - order nf'
     C                     MOVEL'USR3365' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0070           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0070           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Invalid Company Number'
     C                     MOVEL'USR1783' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
      * ** Match Rated Freight to the Flat Amount        dly029
      * CASE: DTL.Flat Amount NE WRK.Flat Amount
     C           #1FLAM    IFNE WUFLAM                     *IF
     C                     Z-ADD#1FLAM    #1R1NB           Rated Freight
     C                     END                             *FI
     C                     END
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * F15=Lock Load
      * CASE: DTL.*CMD key is *Lock Load
     C           *IN15     IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0012  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0013 112       Flat Amount
     C                     Z-ADD*ZERO     WN0014  50       Total Stops
     C                     Z-ADD*ZERO     WN0015  70       Total Load Mile
     C                     MOVEL*BLANK    WN0016  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0017  2        Ship To State C
     C                     MOVEL*BLANK    WN0018  3        Carrier Broker
     C                     MOVEL*BLANK    WN0019  1        Export Status
     C                     MOVEL*BLANK    WN0020  3        Shipping Line
     C                     MOVEL*BLANK    WN0021 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0022  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0023  60       Deadline Depart
     C                     MOVEL*BLANK    WN0024  1        MG Created Load
     C                     MOVEL*BLANK    WN0025  2        Load U_M
     C                     MOVEL*BLANK    WN0026  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0027 20        Destination Cit
     C                     MOVEL*BLANK    WN0028  2        State Code
     C                     MOVEL*BLANK    WN0029  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0030  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN0031  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN0032  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN0033  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN0034  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN0035  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN0036  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN0037  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN0038  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN0039 155       Company Number
     C                     Z-ADD*ZERO     WN0040 155       Date 1
     C                     Z-ADD*ZERO     WN0041 155       Order Number 1
     C                     Z-ADD*ZERO     WN0042  40       Requested Deliv
     C                     MOVEL*BLANK    WN0043  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0103           Load ID
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0104    WN0012           Scheduled Ship
     C                     MOVELWL0105    WUG0TX    P      LTL Flag
     C                     MOVELWL0106    WUG0TX    P      Load Status
     C                     Z-ADDWL0107    WUNFNN           Reefer Temperat
     C                     MOVELWL0108    WUG0TX    P      Seal 1
     C                     MOVELWL0109    WUG0TX    P      Seal 2
     C                     MOVELWL0110    WUG0TX    P      Seal 3
     C                     Z-ADDWL0111    WUNFNN           Total Load Orde
     C                     Z-ADDWL0112    WN0013           Flat Amount
     C                     MOVELWL0113    WUG0TX    P      Allocate Pounds
     C                     Z-ADDWL0114    WN0014           Total Stops
     C                     MOVELWL0115    WUG0TX    P      Trailer Id
     C                     MOVELWL0116    WUG0TX    P      Transloader Car
     C                     Z-ADDWL0117    WUNFNN           BOL Time
     C                     MOVELWL0118    WUG0TX    P      Carrier Code
     C                     MOVELWL0119    WUG0TX    P      Truck Size
     C                     Z-ADDWL0120    WUNFNN           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0121    WUNFNN           Rated Freight
     C                     MOVELWL0122    WUG0TX    P      Ship Status
     C                     MOVELWL0123    WUG0TX    P      Load Type
     C                     Z-ADDWL0124    WUNFNN           Number Pallets
     C                     Z-ADDWL0125    WUNFNN           Number Pallets
     C                     Z-ADDWL0126    WUNFNN           Load Carrier Pa
     C                     Z-ADDWL0127    WUNFNN           Estimated Arriv
     C                     Z-ADDWL0128    WUNFNN           Actual Arrival
     C                     Z-ADDWL0129    WUNFNN           Actual Arrival
     C                     Z-ADDWL0130    WUNFNN           Trailer IN Weig
     C                     Z-ADDWL0131    WUNFNN           Trailer OUT Wei
     C                     Z-ADDWL0132    WUNFNN           Actual Departur
     C                     Z-ADDWL0133    WUNFNN           Departure Time
     C                     Z-ADDWL0134    WUNFNN           Schedule Sequen
     C                     Z-ADDWL0135    WUNFNN           Product Tempera
     C                     Z-ADDWL0136    WUNFNN           Number Spacers
     C                     MOVELWL0137    WUG0TX    P      Car_Veh_Initial
     C                     Z-ADDWL0138    WN0015           Total Load Mile
     C                     MOVELWL0139    WUG0TX    P      Recorder ID
     C                     MOVELWL0140    WUG0TX    P      Shipping Method
     C                     MOVELWL0141    WN0016    P      Ship From Wareh
     C                     MOVELWL0142    WN0017    P      Ship To State C
     C                     Z-ADDWL0143    WUNFNN           Gross Weight
     C                     MOVELWL0144    WN0018    P      Carrier Broker
     C                     MOVELWL0145    WN0019    P      Export Status
     C                     Z-ADDWL0146    WUNFNN           Actual Ship Dat
     C                     MOVELWL0147    WUG0TX    P      On Time_Y_N
     C                     Z-ADDWL0148    WUNFNN           Truck Ready Dat
     C                     Z-ADDWL0149    WUNFNN           Truck Ready Tim
     C                     Z-ADDWL0150    WUNFNN           Spotted Date
     C                     Z-ADDWL0151    WUNFNN           Spotted Time
     C                     Z-ADDWL0152    WUNFNN           Load Finished D
     C                     Z-ADDWL0153    WUNFNN           Load Finished T
     C                     Z-ADDWL0154    WUNFNN           BOL Complete Da
     C                     Z-ADDWL0155    WUNFNN           BOL Complete Ti
     C                     Z-ADDWL0156    WUNFNN           BOL Received Da
     C                     Z-ADDWL0157    WUNFNN           BOL Received Ti
     C                     Z-ADDWL0158    WUNFNN           Truck Departure
     C                     Z-ADDWL0159    WUNFNN           Truck Departure
     C                     Z-ADDWL0160    WUNFNN           Adjusted Depart
     C                     Z-ADDWL0161    WUNFNN           Adjusted Depart
     C                     MOVELWL0162    WUG0TX    P      Shipping Line
     C                     MOVELWL0163    WUG0TX    P      Port Delv Termi
     C                     MOVELWL0164    WUG0TX    P      Vessel Name
     C                     Z-ADDWL0165    WUNFNN           Voyage
     C                     Z-ADDWL0166    WUNFNN           Sail Date
     C                     MOVELWL0167    WUG0TX    P      Booking Number
     C                     MOVELWL0168    WUG0TX    P      Discharge Port
     C                     Z-ADDWL0169    WUNFNN           Arrival Date
     C                     MOVELWL0170    WUG0TX    P      Container Numbe
     C                     Z-ADDWL0171    WUNFNN           Date In
     C                     Z-ADDWL0172    WUNFNN           Time In
     C                     Z-ADDWL0173    WUNFNN           Date Out
     C                     Z-ADDWL0174    WUNFNN           Time Out
     C                     Z-ADDWL0175    WUNFNN           Load Total Frei
     C                     Z-ADDWL0176    WUNFNN           Scheduled Deliv
     C                     Z-ADDWL0177    WUNFNN           Scheduled Deliv
     C                     MOVELWL0178    WUG0TX    P      LH Unused Sts
     C                     Z-ADDWL0179    WUNFNN           On Yard Date
     C                     Z-ADDWL0180    WUNFNN           On Yard Time
     C                     Z-ADDWL0181    WN0022           Deadline Depart
     C                     Z-ADDWL0182    WN0023           Deadline Depart
     C                     MOVELWL0183    WN0024    P      MG Created Load
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN0016    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0184           Load ID
     C                     EXSR TURVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0024    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0185           Load ID
     C                     Z-ADD*ZERO     WL0186           Stop_Drop
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0187    WUN7DT           LD Carrier Appt
     C                     Z-ADDWL0188    WN0023           LD Carrier Appt
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN0022           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0189           Load ID
     C                     Z-ADD*ZERO     WL0190           Stop_Drop
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0191    WN0022           Requested Deliv
     C                     Z-ADDWL0192    WN0042           Requested Deliv
     C           WN0042    MULT 100       WN0023           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0189  51       Hours Required
     C                     Z-ADD*ZERO     WN0190  50       Miles to next s
     C                     Z-ADD*ZERO     WN0191  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0192  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0193  50       @Days 5
     C                     Z-ADD*ZERO     WN0194  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0195  20       USR Period
     C                     Z-ADD*ZERO     WN0196  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0197  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UFSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0193           Load ID
     C                     EXSR TZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0194    YL0032    P      Shipping Method
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0032    IFEQ 'CT'                       *IF
     C           YL0032    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0195           Load ID
     C                     Z-ADD*ZERO     WL0196           Stop_Drop
     C                     Z-ADD*ZERO     WL0197           Order Number
     C                     EXSR NARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    WN0190           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0190    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0032  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0033  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0195           Load ID
     C                     Z-ADD*ZERO     WL0196           Stop_Drop
     C                     Z-ADD*ZERO     WL0197           Order Number
     C                     EXSR NARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    WN0190           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0190    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN0022           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0023           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0189           Hours Required
     C                     Z-ADD*ZERO     YL0033           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0190    WL0199           Miles to First
     C                     EXSR NBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0200    YL0033           Hours Required
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0034  70       Load ID
     C           YL0034    PARM YL0034    WQ0035  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           YL0033    ADD  YL0034    WN0189           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0189    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0189    DIV  24        WN0193           @Days 5
     C           WN0193    MULT 24        WU               USR Hours 5.0
     C           WN0189    SUB  WU        WN0191           USR Hours 5.0
     C           WN0191    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0193    IFGT 0                          *IF
     C                     MULT -1        WN0193           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0022    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0193    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0022
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0022
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0023                     *IF
     C                     SUB  WN0023    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0193           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0022    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0193    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0022
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0022
     C                     END
     C           240000    SUB  WUPINB    WN0023           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0023           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0201           Load ID
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0202    WUG0TX    P      Load Status
     C                     Z-ADDWL0203    WUTLMI           Total Load Mile
     C                     Z-ADDWL0204    WUK2DT           Override Total
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0014           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    WUBKC7           Ship To Custome
     C                     MOVELWL0016    WUBRTX    P      Ship To Name
     C                     MOVELWL0017    WUHMNA    P      Ship To Address
     C                     MOVELWL0018    WUHONA    P      Ship To Address
     C                     MOVELWL0019    WUHPNA    P      Ship To Address
     C                     MOVELWL0020    WUHNNA    P      Ship To City
     C                     MOVELWL0021    WN0017    P      Ship To State C
     C                     MOVELWL0022    WUCKTX    P      Ship To Zip_Pos
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0014    IFEQ 1                          *IF
     C           WN0013    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0062           Load ID
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    WN0027    P      Ship To City
     C                     MOVELWL0064    WN0028    P      Ship To State C
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN0027    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN0027           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0018    WL0065    P      Carrier Code
     C                     MOVELWN0016    WL0066    P      Warehouse Code
     C                     MOVELWN0027    WL0067    P      Destination Cit
     C                     MOVELWN0028    WL0068    P      State Code
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    WN0013           Flat Rate
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UGSUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0205           Load ID
     C                     Z-ADDWN0012    WL0206           Scheduled Ship
     C                     MOVEL'L'       WL0207    P      Load Status
     C                     Z-ADDWN0013    WL0208           Flat Amount
     C                     MOVELWN0016    WL0209    P      Ship From Wareh
     C                     MOVELWN0017    WL0210    P      Ship To State C
     C                     Z-ADDWN0022    WL0211           Deadline Depart
     C                     Z-ADDWN0023    WL0212           Deadline Depart
     C                     MOVELWN0025    WL0213    P      Load U_M
     C                     EXSR NDCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0012    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0214           Load ID
     C                     MOVELWN0029    WL0215    P      USR Warehouse C
     C                     MOVELWN0030    WL0216    P      USR CDE Parm 1
     C                     MOVELWN0031    WL0217    P      USR CDE Parm 2
     C                     MOVELWN0032    WL0218    P      USR CDE Parm 3
     C                     MOVELWN0033    WL0219    P      USR CDE Parm 4
     C                     MOVELWN0034    WL0220    P      USR CDE Parm 5
     C                     MOVELWN0035    WL0221    P      USR CDE Parm 6
     C                     MOVELWN0036    WL0222    P      USR CDE Parm 7
     C                     MOVELWN0037    WL0223    P      USR CDE Parm 8
     C                     MOVELWN0038    WL0224    P      USR CDE Parm 9
     C                     EXSR NERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0215    WN0029    P      USR Warehouse C
     C                     MOVELWL0216    WN0030    P      USR CDE Parm 1
     C                     MOVELWL0217    WN0031    P      USR CDE Parm 2
     C                     MOVELWL0218    WN0032    P      USR CDE Parm 3
     C                     MOVELWL0219    WN0033    P      USR CDE Parm 4
     C                     MOVELWL0220    WN0034    P      USR CDE Parm 5
     C                     MOVELWL0221    WN0035    P      USR CDE Parm 6
     C                     MOVELWL0222    WN0036    P      USR CDE Parm 7
     C                     MOVELWL0223    WN0037    P      USR CDE Parm 8
     C                     MOVELWL0224    WN0038    P      USR CDE Parm 9
     C                     Z-ADD#1AIC3    WN0039           Company Number
     C                     Z-ADD#1RMNB    WN0041           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0012    WN0040           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0029    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN0043    PARM *BLANK    WQ0038  7        Return Code Usr
     C                     PARM 'OMS'     WQ0039  6        Application Cod
     C                     PARM @CN,005   WQ0040 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0041  1        USR Detail or S
     C                     PARM @CN,006   WQ0042 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0043 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0044  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0045  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0046  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0047 10        PRT Night Queue
     C           WN0039    PARM WN0039    WQ0048 155       Company Number
     C           WN0040    PARM WN0040    WQ0049 155       Date 1
     C           WN0041    PARM WN0041    WQ0050 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0051 155       System Value Nu
     C           WN0029    PARM WN0029    WQ0052  3        USR Warehouse C
     C           WN0030    PARM WN0030    WQ0053  3        USR CDE Parm 1
     C           WN0031    PARM WN0031    WQ0054  3        USR CDE Parm 2
     C           WN0032    PARM WN0032    WQ0055  3        USR CDE Parm 3
     C           WN0033    PARM WN0033    WQ0056  3        USR CDE Parm 4
     C           WN0034    PARM WN0034    WQ0057  3        USR CDE Parm 5
     C           WN0035    PARM WN0035    WQ0058  3        USR CDE Parm 6
     C           WN0036    PARM WN0036    WQ0059  3        USR CDE Parm 7
     C           WN0037    PARM WN0037    WQ0060  3        USR CDE Parm 8
     C           WN0038    PARM WN0038    WQ0061  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0062  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0063  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0335  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0225           Load ID
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0226    WN0335    P      Trans Contol AS
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0227           PFS Company Num
     C                     MOVEL'LDORDD'  WL0228    P      PFS Interface C
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0229    YL0035    P      PFS AccuSort Ac
     C                     MOVELWL0230    YL0036    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0035    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0335    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0064  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  CRT AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0065  70       Load ID
     C                     PARM #1AIC3    WQ0066  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0067  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0036    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0068  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0069  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,007                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0012    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0029    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0029    WQ0070  3        Warehouse Code
     C                     PARM *BLANK    WQ0071 10        Default Printer
     C           YL0037    PARM *BLANK    WQ0072  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0037    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN0029    ZA0071           USR Warehouse C
     C                     MOVELWN0030    ZA0072           USR CDE Parm 1
     C                     MOVELWN0031    ZA0073           USR CDE Parm 2
     C                     MOVELWN0032    ZA0074           USR CDE Parm 3
     C                     MOVELWN0033    ZA0075           USR CDE Parm 4
     C                     MOVELWN0034    ZA0076           USR CDE Parm 5
     C                     MOVELWN0035    ZA0077           USR CDE Parm 6
     C                     MOVELWN0036    ZA0078           USR CDE Parm 7
     C                     MOVELWN0037    ZA0079           USR CDE Parm 8
     C                     MOVELWN0038    ZA0080           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR UHSUBR                     ***** Change Lo
     C                     MOVEL'L'       P1PKST           Load Status
     C                     MOVEL*BLANK    WURVST           Load Change Typ
     C                     MOVEL'LOCK'    WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVEL#1PKST    PBMNTX    P      Change Log Prio
     C                     MOVEL'L'       PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993731*
     C                     END
     C                     END                             *FI
      * F16=Update processing for Unlock
      * CASE: DTL.*CMD key is *Unlock Load
     C           *IN16     IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN0336  3        Shipping Line
     C                     MOVEL*BLANK    WN0337 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0338  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0339  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0231           Load ID
     C                     MOVEL'U'       WL0232    P      Load Status
     C                     Z-ADD*ZERO     WL0233           Rated Freight
     C                     EXSR NLCHRC
      *
     C                     MOVEL*BLANK    WN0483  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0484  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN0485  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN0486  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0225           Load ID
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0226    WN0483    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL@CN,008   WL0234    P      System Value Co
     C                     EXSR NMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0235    YL0038    P      System Value Al
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0227           PFS Company Num
     C                     MOVEL'LDORDD'  WL0228    P      PFS Interface C
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0229    YL0039    P      PFS AccuSort Ac
     C                     MOVELWL0230    YL0040    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0039    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0483    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0073  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0074  70       Load ID
     C                     PARM #1AIC3    WQ0075  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0076  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0040    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0077  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0078  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0079  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0236           Load ID
     C                     Z-ADD*ZERO     WL0237           Stop_Drop Seque
     C                     EXSR NNRVGN
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load/Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVEL#1PKST    PBMNTX    P      Change Log Prio
     C                     MOVEL'U'       PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993731*
     C                     END
     C                     END                             *FI
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * * DTL.Load Status is the load status prior to update.
      * ** If "fax carrier=Y" for deleted SSI carrier, send to PowerPro F
      * Update order header with changed carrier, flag to fax booking con
      * CASE: PAR.Carrier Code NE DTL.Carrier Code
     C           P1BZNA    IFNE #1BZNA                     *IF
      * Chg Carrier           RT - Order Header TRG  * 
     C                     EXSR NTRVGN
      * ** This flag controls faxing to carrier in WW Load Plans
     C                     MOVEL'N'       P8D4ST           USR Flag 1
      * Flag to Fax Booking Confirmation if Carrier code changes
     C                     END                             *FI
     C                     MOVEL'N'       YL0041           Status Flag 20
      * Prompt to Fax and try to lock load only if carrier is not blank
      * CASE: DTL.Carrier Code is entered
     C           #1BZNA    IFNE *BLANK                     *IF
      * ** Prompt to fax, fax, then send msg to screen for each fax sent
      * ** Return Carrier Fax Flag for testing SSI/PowerPro
      * ** default "Fax to carrier" to Yes         P000737
     C                     MOVEL'Y'       P9B8ST           Status - Y or N
      * PMT Fax Load Confirmtn PV - Load Header  * 
     C                     CALL 'POICPVR'              90  PMT Fax Load Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0080  70       Load ID
     C                     PARM #1AIC3    WQ0081  30       Company Number
     C                     PARM #1DYTX    WQ0082  3        Transloader Car
     C                     PARM #1BZNA    WQ0083  3        Carrier Code
     C                     PARM #1XACD    WQ0084  3        Shipping Line
     C                     PARM #DC2TX    WQ0085  4        OHE Carrier SCA
     C           P9B8ST    PARM P9B8ST    WQ0086  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POICPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993140*
     C                     SETON                     37    *
     C                     END
      * ** If Fax to Carrier is "Y" then check SSI/PowerPro also
      * CASE: PAR.Status - Y or N is yes
     C           P9B8ST    IFEQ 'Y'                        *IF
      * ** Only send to SSI if SSI download flag is set to Yes
      * RTV SSI Carrier flag   RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1BZNA    WL0243    P      Carrier Code
     C                     EXSR NVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0244    WUUNUS    P      SSI Download Fl
      * ONLY do SSI from as400 if not an MG Created load (mg sends them t
      * CASE: DTL.MG Created Load is Not MG Created Load
     C           #1RYSX    IFEQ *BLANK                     *IF
      * ** Handle deletes for SSI Carriers
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
      * RTV SSI Fax'd Flag     RT - Load Header  * 
     C                     EXSR NWRVGN
      * ** Carrier is new or changed to SBD
      * CASE: DTL.Fax Sent to SSI Carrier is Not Fax'd to Carrier
     C           #1RUSX    IFEQ *BLANK                     *IF
     C           #1RUSX    OREQ 'N'
     C                     MOVEL'00'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0087  70       Load ID
     C                     PARM #1BZNA    WQ0088  3        Carrier Code
     C                     PARM WUAHST    WQ0089  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'04'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0090  70       Load ID
     C                     PARM #1BZNA    WQ0091  3        Carrier Code
     C                     PARM WUAHST    WQ0092  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.SSI Download Flag is No
      *   |- c2    : WRK.SSI Download Flag is Not Entered
      *   '-
     C           WUUNUS    IFEQ 'N'                        *IF
     C           WUUNUS    OREQ *BLANK                     *OR
      * ** If old carrier is SBD, send a delete record to SSI
      * ** New/Changes for SBD will be sent from the Accept Screen
      * RTV SSI Carrier flag   RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1BZNA    WL0243    P      Carrier Code
     C                     EXSR NVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0244    WUUNUS    P      SSI Download Fl
      * ** Only send to SSI if SSI download flag is set to Yes
      * CASE: WRK.SSI Download Flag is Yes, Download to SSI
     C           WUUNUS    IFEQ 'Y'                        *IF
      * ** Only send "Delete" record if a fax was previously sent
      * CASE: DTL.Fax Sent to SSI Carrier is Yes, Fax'd to Carrier
     C           #1RUSX    IFEQ 'Y'                        *IF
      * ** Carrier was changed from SBD to someone else
     C                     MOVEL'01'      WUAHST           SSI Add, Chg, D
      * BLD SSI Download       XF - SSI Control  * 
     C                     CALL 'PNPNXFR'              90  BLD SSI Downloa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0093  70       Load ID
     C                     PARM P1BZNA    WQ0094  3        Carrier Code
     C                     PARM WUAHST    WQ0095  2        SSI Add, Chg, D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNPNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1AIC3    P6AJAA           Company Number
      * Order number is really load number
     C                     Z-ADD#1RMNB    P6AJAE           Order Number 1
     C                     MOVEL#1BZNA    P1BZNA           Carrier Code
     C                     MOVEL'Y'       P8D4ST           USR Flag 1
      * ** Pass flags back-fax to carrier and FAX (to fax, not print only
     C                     MOVEL'Y'       P9ATUS           STATUS
     C                     MOVEL'F'       P9E6ST           USR Status (Y/N
     C                     END                             *FI
      * OMS330 Try to Lock load if carrier entered.
      * CASE: DTL.Load Status is Lock
     C           #1PKST    IFEQ 'L'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUATUS           STATUS
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0096  30       Company Number
     C           YL0011    PARM *BLANK    WQ0097  1        Plant Company S
     C           YL0042    PARM *BLANK    WQ0098  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: LCL.Company Organization is Seaboard
     C           YL0042    IFEQ 'S'                        *IF
      * FP1054 7/24/09 pass NO for lock option override for Seaboard only
     C                     MOVEL'N'       YL0043           Lock option ove
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0043           Lock option ove
     C                     END                             *FI
      * ** Don't lock if errors pending in Order Detail       P0012851
      *
     C                     MOVEL*BLANK    WN0910  1        Load Status
     C                     Z-ADD*ZERO     WN0911  70       Total Load Orde
     C                     MOVEL*BLANK    WN0912  3        Carrier Code
     C                     MOVEL*BLANK    WN0913  7        Truck Size
     C                     MOVEL*BLANK    WN0914  2        Shipping Method
     C                     MOVEL*BLANK    WN0915  1        Load Acceptance
     C                     MOVEL*BLANK    WN0916  1        Block Order Fla
      *
      * EDT Lock Load Edit/INF IF
      * ** Chk for ord detail errors still pending  9.20.2011 P001251 LJB
      * ** Chg lock option override sts to *job date chk   8.23.09 E00495
      * ** Add lock option override sts for sched ship date chk  7.24.09
      * ** Add Override Total Load Miles - WRK context     E00207 8/13/08
      * RTV Load for Load Plan RT - Load Header  * 
     C                     EXSR NXRVGN
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0011           Load ID
     C                     MOVELWN0916    WL0013    P      Block Order Fla
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0012    WUJDST    P      USR Check Y/N S
     C                     MOVELWL0013    WN0916    P      Block Order Fla
      *
     C                     Z-ADD*ZERO     WN0917  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0918  70       Minimum pounds
     C                     MOVEL*BLANK    WN0919  1        USR Orders on L
     C                     MOVEL*BLANK    WN0920  1        Order in Use
     C                     MOVEL*BLANK    WN0921  1        Header Status
     C                     MOVEL*BLANK    WN0922  1        Access Denied (
      *
      * EDT Lock Load Edits-INFIF
      * assume will have error
     C                     MOVEL'Y'       WUECST           Error Status
      *
     C                     MOVEL*BLANK    WN0923 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0923           User Profile Na
      *
     C                     MOVEL*BLANK    WN0924 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0923    WL0037    P      User Profile Na
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    WUG0TX    P      Allow Multi_Com
     C                     MOVELWL0039    WUG0TX    P      Default Printer
     C                     MOVELWL0040    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0041    YL0014           Company Number
     C                     MOVELWL0042    WN0924    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0924    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0923    WL0043    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0044    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    WUAIC3           Company Number
     C                     MOVELWL0046    YL0015    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0924    WL0043    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0044    P      Application Cod
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    WUAIC3           Company Number
     C                     MOVELWL0046    YL0015    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0015    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0014    IFGT 0                          *IF
     C                     Z-ADDYL0014    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0015    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0016    WL0048           Shipping Compan
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0047    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0922           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0009           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WUG0TX    P      Name
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0922    IFEQ 'Y'                        *IF
      * Send message 'Usr Cant Lock/Unlk Ld-INF'
     C                     MOVEL'USR2543' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0049           Load ID
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    WN0919    P      Status - Y or N
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0081           Load ID
     C                     MOVELWUSEL     ZA0082           *SFLSEL
      * Send message 'No Orders Assinged - INF'
     C                     MOVEL'USR2544' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           WN0916    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0083           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0084           Load ID
      * Send message 'Blck Ord on Ld-no UPD-INF'
     C                     MOVEL'USR2545' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           WN0910    IFEQ 'I'                        *IF
     C           WN0910    OREQ 'L'
     C           WN0910    OREQ 'S'
      * Setup message data for message
     C                     MOVELWUSEL     ZA0085           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0086           Load ID
      * Send message 'Load Cant be Locked - INF'
     C                     MOVEL'USR2546' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Carrier Code EQ WRK.BLANK
      *   |- c2    : PAR.STATUS is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0912    IFEQ WUGSTX                     *IF
     C           WUATUS    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVELWN0912    ZA0087           Carrier Code
     C                     Z-ADD#1RMNB    ZA0088           Load ID
      * Send message 'Carrier must be ent.- INF'
     C                     MOVEL'USR2547' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           WN0913    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0913    ZA0089           Truck Size
     C                     Z-ADD#1RMNB    ZA0090           Load ID
      * Send message 'Truck size needed - INF'
     C                     MOVEL'USR2548' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           WN0914    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVELWN0914    ZA0091           Shipping Method
      * Send message 'Shipping Mthd req - INF'
     C                     MOVEL'USR2549' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0919    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0092           Load ID
      * Send message 'Load has ords w/o stp-INF'
     C                     MOVEL'USR2550' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           WN0915    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0093           Load ID
      * Send message 'Load is not accepted- INF'
     C                     MOVEL'USR2551' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0053           Load ID
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0051    WN0920    P      Order in Use
     C                     MOVELWL0052    WN0921    P      Header Status
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0921    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0094           Load ID
     C                     MOVELWUSEL     ZA0095           *SFLSEL
      * Send message 'Load has Ords on Hold-INF'
     C                     MOVEL'USR2552' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0921    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0096           Load ID
     C                     MOVELWUSEL     ZA0097           *SFLSEL
      * Send message 'Load has Cncld Ords - INF'
     C                     MOVEL'USR2553' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0920    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWUSEL     ZA0098           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0099           Load ID
      * Send message 'Load has Ords in Use-INF'
     C                     MOVEL'USR2554' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0054           Load ID
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    YL0044    P      Order Requires
      * ** Check for errors in Export Order Automation Upload   P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0044    IFEQ 'Y'                        *IF
      * ** Cannot lock load if errors in Order Detail         P001251
      * Setup message data for message
     C                     MOVELWUSEL     ZA0100           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0101           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0913    WL0056    P      Truck Size
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0057    WN0917           Maximum pounds
     C                     Z-ADDWL0058    WN0918           Minimum pounds
      * Do not want to lock the load if the Load Weight is not
      * within range.  -Purva 5/5/99 C0007042
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           WN0911    IFLT WN0918                     *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0102           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           WN0911    IFGT WN0917                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Sched ship date if not called from a LOCK option  FP1054 7/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Lock option override sts is No
      *   |- c2    : PAR.Scheduled Ship Date GT JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0043    IFEQ 'N'                        *IF
     C           WUAODT    IFGT ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UISUBR                     ***** Change Lo
      * CASE: WRK.Error Status is no
     C           WUECST    IFEQ 'N'                        *IF
      *
     C                     Z-ADD*ZERO     WN0925  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0926 112       Flat Amount
     C                     Z-ADD*ZERO     WN0927  50       Total Stops
     C                     Z-ADD*ZERO     WN0928  70       Total Load Mile
     C                     MOVEL*BLANK    WN0929  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0930  2        Ship To State C
     C                     MOVEL*BLANK    WN0931  3        Carrier Broker
     C                     MOVEL*BLANK    WN0932  1        Export Status
     C                     MOVEL*BLANK    WN0933  3        Shipping Line
     C                     MOVEL*BLANK    WN0934 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0935  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0936  60       Deadline Depart
     C                     MOVEL*BLANK    WN0937  1        MG Created Load
     C                     MOVEL*BLANK    WN0938  2        Load U_M
     C                     MOVEL*BLANK    WN0939  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0940 20        Destination Cit
     C                     MOVEL*BLANK    WN0941  2        State Code
     C                     MOVEL*BLANK    WN0942  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0943  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN0944  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN0945  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN0946  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN0947  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN0948  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN0949  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN0950  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN0951  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN0952 155       Company Number
     C                     Z-ADD*ZERO     WN0953 155       Date 1
     C                     Z-ADD*ZERO     WN0954 155       Order Number 1
     C                     Z-ADD*ZERO     WN0955  40       Requested Deliv
     C                     MOVEL*BLANK    WN0956  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0103           Load ID
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0104    WN0925           Scheduled Ship
     C                     MOVELWL0105    WUG0TX    P      LTL Flag
     C                     MOVELWL0106    WUG0TX    P      Load Status
     C                     Z-ADDWL0107    WUNFNN           Reefer Temperat
     C                     MOVELWL0108    WUG0TX    P      Seal 1
     C                     MOVELWL0109    WUG0TX    P      Seal 2
     C                     MOVELWL0110    WUG0TX    P      Seal 3
     C                     Z-ADDWL0111    WUNFNN           Total Load Orde
     C                     Z-ADDWL0112    WN0926           Flat Amount
     C                     MOVELWL0113    WUG0TX    P      Allocate Pounds
     C                     Z-ADDWL0114    WN0927           Total Stops
     C                     MOVELWL0115    WUG0TX    P      Trailer Id
     C                     MOVELWL0116    WUG0TX    P      Transloader Car
     C                     Z-ADDWL0117    WUNFNN           BOL Time
     C                     MOVELWL0118    WUG0TX    P      Carrier Code
     C                     MOVELWL0119    WUG0TX    P      Truck Size
     C                     Z-ADDWL0120    WUNFNN           Ld Hdr_Ld Dtl U
     C                     Z-ADDWL0121    WUNFNN           Rated Freight
     C                     MOVELWL0122    WUG0TX    P      Ship Status
     C                     MOVELWL0123    WUG0TX    P      Load Type
     C                     Z-ADDWL0124    WUNFNN           Number Pallets
     C                     Z-ADDWL0125    WUNFNN           Number Pallets
     C                     Z-ADDWL0126    WUNFNN           Load Carrier Pa
     C                     Z-ADDWL0127    WUNFNN           Estimated Arriv
     C                     Z-ADDWL0128    WUNFNN           Actual Arrival
     C                     Z-ADDWL0129    WUNFNN           Actual Arrival
     C                     Z-ADDWL0130    WUNFNN           Trailer IN Weig
     C                     Z-ADDWL0131    WUNFNN           Trailer OUT Wei
     C                     Z-ADDWL0132    WUNFNN           Actual Departur
     C                     Z-ADDWL0133    WUNFNN           Departure Time
     C                     Z-ADDWL0134    WUNFNN           Schedule Sequen
     C                     Z-ADDWL0135    WUNFNN           Product Tempera
     C                     Z-ADDWL0136    WUNFNN           Number Spacers
     C                     MOVELWL0137    WUG0TX    P      Car_Veh_Initial
     C                     Z-ADDWL0138    WN0928           Total Load Mile
     C                     MOVELWL0139    WUG0TX    P      Recorder ID
     C                     MOVELWL0140    WUG0TX    P      Shipping Method
     C                     MOVELWL0141    WN0929    P      Ship From Wareh
     C                     MOVELWL0142    WN0930    P      Ship To State C
     C                     Z-ADDWL0143    WUNFNN           Gross Weight
     C                     MOVELWL0144    WN0931    P      Carrier Broker
     C                     MOVELWL0145    WN0932    P      Export Status
     C                     Z-ADDWL0146    WUNFNN           Actual Ship Dat
     C                     MOVELWL0147    WUG0TX    P      On Time_Y_N
     C                     Z-ADDWL0148    WUNFNN           Truck Ready Dat
     C                     Z-ADDWL0149    WUNFNN           Truck Ready Tim
     C                     Z-ADDWL0150    WUNFNN           Spotted Date
     C                     Z-ADDWL0151    WUNFNN           Spotted Time
     C                     Z-ADDWL0152    WUNFNN           Load Finished D
     C                     Z-ADDWL0153    WUNFNN           Load Finished T
     C                     Z-ADDWL0154    WUNFNN           BOL Complete Da
     C                     Z-ADDWL0155    WUNFNN           BOL Complete Ti
     C                     Z-ADDWL0156    WUNFNN           BOL Received Da
     C                     Z-ADDWL0157    WUNFNN           BOL Received Ti
     C                     Z-ADDWL0158    WUNFNN           Truck Departure
     C                     Z-ADDWL0159    WUNFNN           Truck Departure
     C                     Z-ADDWL0160    WUNFNN           Adjusted Depart
     C                     Z-ADDWL0161    WUNFNN           Adjusted Depart
     C                     MOVELWL0162    WUG0TX    P      Shipping Line
     C                     MOVELWL0163    WUG0TX    P      Port Delv Termi
     C                     MOVELWL0164    WUG0TX    P      Vessel Name
     C                     Z-ADDWL0165    WUNFNN           Voyage
     C                     Z-ADDWL0166    WUNFNN           Sail Date
     C                     MOVELWL0167    WUG0TX    P      Booking Number
     C                     MOVELWL0168    WUG0TX    P      Discharge Port
     C                     Z-ADDWL0169    WUNFNN           Arrival Date
     C                     MOVELWL0170    WUG0TX    P      Container Numbe
     C                     Z-ADDWL0171    WUNFNN           Date In
     C                     Z-ADDWL0172    WUNFNN           Time In
     C                     Z-ADDWL0173    WUNFNN           Date Out
     C                     Z-ADDWL0174    WUNFNN           Time Out
     C                     Z-ADDWL0175    WUNFNN           Load Total Frei
     C                     Z-ADDWL0176    WUNFNN           Scheduled Deliv
     C                     Z-ADDWL0177    WUNFNN           Scheduled Deliv
     C                     MOVELWL0178    WUG0TX    P      LH Unused Sts
     C                     Z-ADDWL0179    WUNFNN           On Yard Date
     C                     Z-ADDWL0180    WUNFNN           On Yard Time
     C                     Z-ADDWL0181    WN0935           Deadline Depart
     C                     Z-ADDWL0182    WN0936           Deadline Depart
     C                     MOVELWL0183    WN0937    P      MG Created Load
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN0929    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0184           Load ID
     C                     EXSR TURVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0937    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0185           Load ID
     C                     Z-ADD*ZERO     WL0186           Stop_Drop
     C                     EXSR TWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0187    WUN7DT           LD Carrier Appt
     C                     Z-ADDWL0188    WN0936           LD Carrier Appt
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN0935           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0189           Load ID
     C                     Z-ADD*ZERO     WL0190           Stop_Drop
     C                     EXSR TXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0191    WN0935           Requested Deliv
     C                     Z-ADDWL0192    WN0955           Requested Deliv
     C           WN0955    MULT 100       WN0936           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0957  51       Hours Required
     C                     Z-ADD*ZERO     WN0958  50       Miles to next s
     C                     Z-ADD*ZERO     WN0959  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0960  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0961  50       @Days 5
     C                     Z-ADD*ZERO     WN0962  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0963  20       USR Period
     C                     Z-ADD*ZERO     WN0964  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0965  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UJSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0193           Load ID
     C                     EXSR TZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0194    YL0032    P      Shipping Method
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0032    IFEQ 'CT'                       *IF
     C           YL0032    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0195           Load ID
     C                     Z-ADD*ZERO     WL0196           Stop_Drop
     C                     Z-ADD*ZERO     WL0197           Order Number
     C                     EXSR NARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    WN0958           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0958    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0099  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0100  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0195           Load ID
     C                     Z-ADD*ZERO     WL0196           Stop_Drop
     C                     Z-ADD*ZERO     WL0197           Order Number
     C                     EXSR NARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0198    WN0958           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0958    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN0935           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0936           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0957           Hours Required
     C                     Z-ADD*ZERO     YL0033           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0958    WL0199           Miles to First
     C                     EXSR NBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0200    YL0033           Hours Required
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0101  70       Load ID
     C           YL0034    PARM YL0034    WQ0102  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           YL0033    ADD  YL0034    WN0957           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0957    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0957    DIV  24        WN0961           @Days 5
     C           WN0961    MULT 24        WU               USR Hours 5.0
     C           WN0957    SUB  WU        WN0959           USR Hours 5.0
     C           WN0959    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0961    IFGT 0                          *IF
     C                     MULT -1        WN0961           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0935    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0961    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0935
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0935
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0936                     *IF
     C                     SUB  WN0936    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0961           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0935    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0961    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0935
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0935
     C                     END
     C           240000    SUB  WUPINB    WN0936           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0936           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0201           Load ID
     C                     EXSR NCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0202    WUG0TX    P      Load Status
     C                     Z-ADDWL0203    WUTLMI           Total Load Mile
     C                     Z-ADDWL0204    WUK2DT           Override Total
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0014           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    WUBKC7           Ship To Custome
     C                     MOVELWL0016    WUBRTX    P      Ship To Name
     C                     MOVELWL0017    WUHMNA    P      Ship To Address
     C                     MOVELWL0018    WUHONA    P      Ship To Address
     C                     MOVELWL0019    WUHPNA    P      Ship To Address
     C                     MOVELWL0020    WUHNNA    P      Ship To City
     C                     MOVELWL0021    WN0930    P      Ship To State C
     C                     MOVELWL0022    WUCKTX    P      Ship To Zip_Pos
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0927    IFEQ 1                          *IF
     C           WN0926    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0062           Load ID
     C                     EXSR TERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0063    WN0940    P      Ship To City
     C                     MOVELWL0064    WN0941    P      Ship To State C
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN0940    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN0940           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0931    WL0065    P      Carrier Code
     C                     MOVELWN0929    WL0066    P      Warehouse Code
     C                     MOVELWN0940    WL0067    P      Destination Cit
     C                     MOVELWN0941    WL0068    P      State Code
     C                     EXSR TFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    WN0926           Flat Rate
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UKSUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0205           Load ID
     C                     Z-ADDWN0925    WL0206           Scheduled Ship
     C                     MOVEL'L'       WL0207    P      Load Status
     C                     Z-ADDWN0926    WL0208           Flat Amount
     C                     MOVELWN0929    WL0209    P      Ship From Wareh
     C                     MOVELWN0930    WL0210    P      Ship To State C
     C                     Z-ADDWN0935    WL0211           Deadline Depart
     C                     Z-ADDWN0936    WL0212           Deadline Depart
     C                     MOVELWN0938    WL0213    P      Load U_M
     C                     EXSR NDCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0925    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0214           Load ID
     C                     MOVELWN0942    WL0215    P      USR Warehouse C
     C                     MOVELWN0943    WL0216    P      USR CDE Parm 1
     C                     MOVELWN0944    WL0217    P      USR CDE Parm 2
     C                     MOVELWN0945    WL0218    P      USR CDE Parm 3
     C                     MOVELWN0946    WL0219    P      USR CDE Parm 4
     C                     MOVELWN0947    WL0220    P      USR CDE Parm 5
     C                     MOVELWN0948    WL0221    P      USR CDE Parm 6
     C                     MOVELWN0949    WL0222    P      USR CDE Parm 7
     C                     MOVELWN0950    WL0223    P      USR CDE Parm 8
     C                     MOVELWN0951    WL0224    P      USR CDE Parm 9
     C                     EXSR NERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0215    WN0942    P      USR Warehouse C
     C                     MOVELWL0216    WN0943    P      USR CDE Parm 1
     C                     MOVELWL0217    WN0944    P      USR CDE Parm 2
     C                     MOVELWL0218    WN0945    P      USR CDE Parm 3
     C                     MOVELWL0219    WN0946    P      USR CDE Parm 4
     C                     MOVELWL0220    WN0947    P      USR CDE Parm 5
     C                     MOVELWL0221    WN0948    P      USR CDE Parm 6
     C                     MOVELWL0222    WN0949    P      USR CDE Parm 7
     C                     MOVELWL0223    WN0950    P      USR CDE Parm 8
     C                     MOVELWL0224    WN0951    P      USR CDE Parm 9
     C                     Z-ADD#1AIC3    WN0952           Company Number
     C                     Z-ADD#1RMNB    WN0954           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0925    WN0953           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0942    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN0956    PARM *BLANK    WQ0105  7        Return Code Usr
     C                     PARM 'OMS'     WQ0106  6        Application Cod
     C                     PARM @CN,005   WQ0107 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0108  1        USR Detail or S
     C                     PARM @CN,006   WQ0109 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0110 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0111  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0112  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0113  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0114 10        PRT Night Queue
     C           WN0952    PARM WN0952    WQ0115 155       Company Number
     C           WN0953    PARM WN0953    WQ0116 155       Date 1
     C           WN0954    PARM WN0954    WQ0117 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0118 155       System Value Nu
     C           WN0942    PARM WN0942    WQ0119  3        USR Warehouse C
     C           WN0943    PARM WN0943    WQ0120  3        USR CDE Parm 1
     C           WN0944    PARM WN0944    WQ0121  3        USR CDE Parm 2
     C           WN0945    PARM WN0945    WQ0122  3        USR CDE Parm 3
     C           WN0946    PARM WN0946    WQ0123  3        USR CDE Parm 4
     C           WN0947    PARM WN0947    WQ0124  3        USR CDE Parm 5
     C           WN0948    PARM WN0948    WQ0125  3        USR CDE Parm 6
     C           WN0949    PARM WN0949    WQ0126  3        USR CDE Parm 7
     C           WN0950    PARM WN0950    WQ0127  3        USR CDE Parm 8
     C           WN0951    PARM WN0951    WQ0128  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0129  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0130  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0966  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0225           Load ID
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0226    WN0966    P      Trans Contol AS
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0227           PFS Company Num
     C                     MOVEL'LDORDD'  WL0228    P      PFS Interface C
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0229    YL0035    P      PFS AccuSort Ac
     C                     MOVELWL0230    YL0036    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0035    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0966    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0131  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  CRT AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0132  70       Load ID
     C                     PARM #1AIC3    WQ0133  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0134  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0036    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0135  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0136  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,007                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0925    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0942    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0942    WQ0137  3        Warehouse Code
     C                     PARM *BLANK    WQ0138 10        Default Printer
     C           YL0037    PARM *BLANK    WQ0139  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0037    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN0942    ZA0103           USR Warehouse C
     C                     MOVELWN0943    ZA0104           USR CDE Parm 1
     C                     MOVELWN0944    ZA0105           USR CDE Parm 2
     C                     MOVELWN0945    ZA0106           USR CDE Parm 3
     C                     MOVELWN0946    ZA0107           USR CDE Parm 4
     C                     MOVELWN0947    ZA0108           USR CDE Parm 5
     C                     MOVELWN0948    ZA0109           USR CDE Parm 6
     C                     MOVELWN0949    ZA0110           USR CDE Parm 7
     C                     MOVELWN0950    ZA0111           USR CDE Parm 8
     C                     MOVELWN0951    ZA0112           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR ULSUBR                     ***** Change Lo
     C                     MOVEL*BLANK    WURVST           Load Change Typ
     C                     MOVEL'LOCK'    WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVEL#1PKST    PBMNTX    P      Change Log Prio
     C                     MOVEL'L'       PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##JOB     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADDP2C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993731*
     C                     END
     C                     MOVEL'L'       #1PKST           Load Status
     C                     MOVEL#1PKST    P1PKST           Load Status
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0113           Load ID
      * Send message 'Load Locked'
     C                     MOVEL'USR2559' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Set this so it doesnt do it again below
     C                     MOVEL'Y'       YL0041           Status Flag 20
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Lock or Chg Carrier, Trailer -- Carlisle processing
      * CASE: Chg carrier or trailer (load locked)
      *  - ((c1 OR c2 OR c4) AND c3)
      *   |- c1    : PAR.Carrier Code NE DTL.Carrier Code
      *   |- c2    : PAR.Trailer Id NE DTL.Trailer Id
      *   |- c4    : PAR.Shipping Method NE DTL.Shipping Method
      *   |- c3    : DTL.Load Status is Lock
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           P1BZNA    IFNE #1BZNA                     *IF
     C           P1DXTX    ORNE #1DXTX                     *OR
     C           P1Q2CD    ORNE #1Q2CD                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           #1PKST    IFEQ 'L'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Any Order Picked   RT - Load Detail  * 
     C                     EXSR NYRVGN
      * Carlisle processing if Lock request or no orders picked
      * CASE: Lock request or no orders picked
      *  - c1 OR c2
      *   |- c1    : DTL.*CMD key is *Lock Load
      *   |- c2    : LCL.USR Status (Y/N) is Not Yes
      *   '-
     C           *IN15     IFEQ '1'                        *IF
     C           YL0045    OREQ *BLANK                     *OR
     C           YL0045    OREQ 'N'
      * dont do this again if it was done in Carrier CASE above
      * CASE: LCL.Status Flag 20 Y/N is No
     C           YL0041    IFEQ 'N'                        *IF
      * ** Don't allow Carlisle processing if errors pending in OD P00125
      *
     C                     MOVEL*BLANK    WN0968  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0225           Load ID
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0226    WN0968    P      Trans Contol AS
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0227           PFS Company Num
     C                     MOVEL'LDORDD'  WL0228    P      PFS Interface C
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0229    YL0035    P      PFS AccuSort Ac
     C                     MOVELWL0230    YL0036    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0035    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0968    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0140  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  CRT AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0141  70       Load ID
     C                     PARM #1AIC3    WQ0142  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0143  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0036    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0144  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0145  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Update the Mexican Carrier in OHE    P000737
      * CASE: DTL.OHE Mexican Buyer Truck NE WRK.Blank for 4           US
     C           #DC2TX    IFNE WUOTTX                     *IF
      * RTV/Chg Mex Carr - All RT - Order Header Extension  * 
     C                     EXSR OARVGN
     C                     END                             *FI
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      *
     C                     MOVEL*BLANK    WN1061  1        On Yard Status
     C                     MOVEL*BLANK    WN1062  1        Assigned Status
     C                     MOVEL*BLANK    WN1063  1        Available Statu
     C                     MOVEL*BLANK    WN1064  1        Record Status
     C                     Z-ADD*ZERO     WN1065  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1066  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1067  40       Requested Deliv
      *
      * CHG Load Header/Trlr   IF
      * Pre set On Yard, Assigned for Trailer
      * CASE: PAR.On Yard Date EQ WRK.ZERO
     C           #1KKDT    IFEQ WUW0NB                     *IF
     C                     MOVEL'N'       WN1061           On Yard Status
     C                     MOVEL'N'       WN1063           Available Statu
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN1061           On Yard Status
     C                     MOVEL'Y'       WN1063           Available Statu
     C                     END                             *FI
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           #1RYSX    IFEQ *BLANK                     *IF
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0146  70       Load ID
     C           WN1065    PARM WN1065    WQ0147  70       Deadline Depart
     C           WN1066    PARM *ZERO     WQ0148  60       Deadline Depart
     C           YL0046    PARM *ZERO     WQ0149  70       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1EIDT    YL0046           Requested Deliv
     C                     Z-ADD#1KZDT    WN1065           Deadline Depart
     C                     Z-ADD#1AXTM    WN1066           Deadline Depart
     C                     END                             *FI
      * 02/09/09 PKD Removed Schedule Ship Date update
      * For exports, default container to trailer & upd       E004079
      * CASE: PAR.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL#DS2TX    YL0047           Container Numbe
      * RTV UPD Cntnr-ords/ld  XF - Order Header Extension  * 
     C                     CALL 'PBRXXFR'              90  RTV UPD Cntnr-o
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0150  70       Load ID
     C                     PARM #DEZTX    WQ0151  3        Shipping Line
     C                     PARM YL0047    WQ0152 12        OHE Container N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CHG Load for Trailer   CH - Load Header  * 
     C                     EXSR OCCHRC
      * C3910  02/10/15 RMC Added this for then they blank out the carrie
      * If carrier blanked out, unlock the load  2/10/2015
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : PAR.Carrier Code Usr is entered
      *   |- c2    : PAR.Carrier Code is not entered
      *   |- c3    : PAR.Load Status is Lock
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUH8AA    IFNE *BLANK                     *IF
     C           #1BZNA    IFEQ *BLANK                     *IF
     C           P1PKST    IFEQ 'L'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     MOVEL*BLANK    WN1118  3        Shipping Line
     C                     MOVEL*BLANK    WN1119 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1120  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1121  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0231           Load ID
     C                     MOVEL'U'       WL0232    P      Load Status
     C                     Z-ADD*ZERO     WL0233           Rated Freight
     C                     EXSR NLCHRC
      *
     C                     MOVEL*BLANK    WN1122  1        Trans Contol AS
     C                     MOVEL*BLANK    WN1123  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN1124  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN1125  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0225           Load ID
     C                     EXSR NGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0226    WN1122    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL@CN,008   WL0234    P      System Value Co
     C                     EXSR NMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0235    YL0038    P      System Value Al
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0227           PFS Company Num
     C                     MOVEL'LDORDD'  WL0228    P      PFS Interface C
     C                     EXSR NKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0229    YL0039    P      PFS AccuSort Ac
     C                     MOVELWL0230    YL0040    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0039    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN1122    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0168  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0169  70       Load ID
     C                     PARM #1AIC3    WQ0170  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0171  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0040    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0172  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0173  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0174  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0236           Load ID
     C                     Z-ADD*ZERO     WL0237           Stop_Drop Seque
     C                     EXSR NNRVGN
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELP1PKST    PBMNTX    P      Change Log Prio
     C                     MOVEL'U'       PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993731*
     C                     END
     C                     END                             *FI
      * * Load Order Log entries:
      * Load Str company change -write load order change log   RMC     03
      * CASE: PAR.Company Number NE PAR.Load Start Company USR
     C           #1AIC3    IFNE WUB0C3                     *IF
     C                     MOVEL'CHGLCO'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUE6TX           Company Number
     C                     MOVELWUB0C3    WUE6TX           Company Number
     C                     MOVEL*BLANK    WUEIT1           Company Number
     C                     MOVEL#1AIC3    WUEIT1           Company Number
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWUE6TX    PBMNTX    P      Change Log Prio
     C                     MOVELWUEIT1    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993731*
     C                     END
      * ** Log entry for "from" company         LJB TRF021 08/21/2006
     C                     MOVEL'LDDLTD'  WURVST           Load Change Typ
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWUE6TX    PBMNTX    P      Change Log Prio
     C                     MOVELWUEIT1    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADDWUB0C3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     END                             *FI
      * Default carrier to Shipping Line. If blanks, use carrier code
      * CASE: PAR.Shipping Line is entered
     C           #DEZTX    IFNE *BLANK                     *IF
     C                     MOVEL#DEZTX    YL0054           Carrier Code
     C                     MOVEL#DS2TX    YL0055           Trailer Id
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1BZNA    YL0054           Carrier Code
     C                     MOVEL#DS2TX    YL0055           Trailer Id
     C                     END                             *FI
      * Create/Update trailer
      * CASE: LCL.Trailer Id NE WRK.Blank for 30          USR
     C           YL0055    IFNE WUW4TX                     *IF
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0089    P      Carrier Code
     C                     MOVELYL0055    WL0090    P      Trailer Id
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0091    YL0056           Company Number
     C                     MOVELWL0092    YL0057    P      Load Type
     C                     MOVELWL0093    YL0058    P      Trailer Type
     C                     MOVELWL0094    YL0059    P      Seaboard Owned
     C                     MOVELWL0095    WN1061    P      On Yard Status
     C                     Z-ADDWL0096    #1KKDT           On Yard Date
     C                     Z-ADDWL0097    #1AVTM           On Yard Time
     C                     MOVELWL0098    WN1062    P      Assigned Status
     C                     MOVELWL0099    WN1063    P      Available Statu
     C                     MOVELWL0100    YL0060    P      Not Available R
     C                     MOVELWL0101    YL0061    P      Comment Line
     C                     MOVELWL0102    WN1064    P      Record Status
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * * Create trailer with zeros in the on yard dt/tm      E002966
      * Create trailer
      * CASE: PAR.Load Type is Regular
     C           #1VDST    IFEQ 'R'                        *IF
      * Regular:  Reefer
      * Crt PD Trailer         CR - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0245    P      Carrier Code
     C                     MOVELYL0055    WL0246    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0247           Company Number
     C                     MOVEL#1VDST    WL0248    P      Load Type
     C                     MOVEL'R'       WL0249    P      Trailer Type
     C                     MOVEL'N'       WL0250    P      Seaboard Owned
     C                     MOVEL'N'       WL0251    P      On Yard Status
     C                     Z-ADD##JDT     WL0252           On Yard Date
     C                     Z-ADD##JTM     WL0253           On Yard Time
     C                     MOVEL'Y'       WL0254    P      Assigned Status
     C                     MOVEL'N'       WL0255    P      Available Statu
     C                     MOVELWUGSTX    WL0256    P      Not Available R
     C                     MOVEL*BLANK    WL0257           Comment Line
     C                     MOVELWUGSTX    WL0258    P      Status Unused 1
     C                     MOVELWUGSTX    WL0259    P      Status Unused 2
     C                     MOVELWUGSTX    WL0260    P      Status Unused 3
     C                     MOVELWUGSTX    WL0261    P      Status Unused 4
     C                     MOVELWUGSTX    WL0262    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0263           Date Unused 1
     C                     Z-ADDWUW0NB    WL0264           Date Unused 2
     C                     Z-ADDWUW0NB    WL0265           Date Unused 3
     C                     Z-ADDWUW0NB    WL0266           Date Unused 4
     C                     Z-ADDWUW0NB    WL0267           Date Unused 5
     C                     MOVELWUGSTX    WL0268    P      EDI Status 1
     C                     MOVELWUGSTX    WL0269    P      EDI Status 2
     C                     MOVELWUGSTX    WL0270    P      EDI Status 3
     C                     MOVEL'A'       WL0271    P      Record Status
     C                     Z-ADD##JTM     WL0272           Job Time
     C                     MOVEL##USR     WL0273    P      User Id
     C                     MOVEL##PGM     WL0274    P      Job Name
     C                     Z-ADD##JDT     WL0275           Job Date
     C                     EXSR ODCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Bulk:  Tanker
      * Crt PD Trailer         CR - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0245    P      Carrier Code
     C                     MOVELYL0055    WL0246    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0247           Company Number
     C                     MOVEL#1VDST    WL0248    P      Load Type
     C                     MOVEL'T'       WL0249    P      Trailer Type
     C                     MOVEL'N'       WL0250    P      Seaboard Owned
     C                     MOVEL'N'       WL0251    P      On Yard Status
     C                     Z-ADD##JDT     WL0252           On Yard Date
     C                     Z-ADD##JTM     WL0253           On Yard Time
     C                     MOVEL'Y'       WL0254    P      Assigned Status
     C                     MOVEL'N'       WL0255    P      Available Statu
     C                     MOVELWUGSTX    WL0256    P      Not Available R
     C                     MOVEL*BLANK    WL0257           Comment Line
     C                     MOVELWUGSTX    WL0258    P      Status Unused 1
     C                     MOVELWUGSTX    WL0259    P      Status Unused 2
     C                     MOVELWUGSTX    WL0260    P      Status Unused 3
     C                     MOVELWUGSTX    WL0261    P      Status Unused 4
     C                     MOVELWUGSTX    WL0262    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0263           Date Unused 1
     C                     Z-ADDWUW0NB    WL0264           Date Unused 2
     C                     Z-ADDWUW0NB    WL0265           Date Unused 3
     C                     Z-ADDWUW0NB    WL0266           Date Unused 4
     C                     Z-ADDWUW0NB    WL0267           Date Unused 5
     C                     MOVELWUGSTX    WL0268    P      EDI Status 1
     C                     MOVELWUGSTX    WL0269    P      EDI Status 2
     C                     MOVELWUGSTX    WL0270    P      EDI Status 3
     C                     MOVEL'A'       WL0271    P      Record Status
     C                     Z-ADD##JTM     WL0272           Job Time
     C                     MOVEL##USR     WL0273    P      User Id
     C                     MOVEL##PGM     WL0274    P      Job Name
     C                     Z-ADD##JDT     WL0275           Job Date
     C                     EXSR ODCRRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Update trailer
      * CASE: PAR.Load Type is Regular
     C           #1VDST    IFEQ 'R'                        *IF
      * Regular:  Reefer
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0276    P      Carrier Code
     C                     MOVELYL0055    WL0277    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0278           Company Number
     C                     MOVELYL0057    WL0279    P      Load Type
     C                     MOVEL'R'       WL0280    P      Trailer Type
     C                     MOVEL'N'       WL0281    P      Seaboard Owned
     C                     MOVELWN1061    WL0282    P      On Yard Status
     C                     Z-ADD#1KKDT    WL0283           On Yard Date
     C                     Z-ADD#1AVTM    WL0284           On Yard Time
     C                     MOVEL'Y'       WL0285    P      Assigned Status
     C                     MOVEL'N'       WL0286    P      Available Statu
     C                     MOVELWUGSTX    WL0287    P      Not Available R
     C                     MOVEL*BLANK    WL0288           Comment Line
     C                     MOVELWUGSTX    WL0289    P      Status Unused 1
     C                     MOVELWUGSTX    WL0290    P      Status Unused 2
     C                     MOVELWUGSTX    WL0291    P      Status Unused 3
     C                     MOVELWUGSTX    WL0292    P      Status Unused 4
     C                     MOVELWUGSTX    WL0293    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0294           Date Unused 1
     C                     Z-ADDWUW0NB    WL0295           Date Unused 2
     C                     Z-ADDWUW0NB    WL0296           Date Unused 3
     C                     Z-ADDWUW0NB    WL0297           Date Unused 4
     C                     Z-ADDWUW0NB    WL0298           Date Unused 5
     C                     MOVELWUGSTX    WL0299    P      EDI Status 1
     C                     MOVELWUGSTX    WL0300    P      EDI Status 2
     C                     MOVELWUGSTX    WL0301    P      EDI Status 3
     C                     MOVEL'A'       WL0302    P      Record Status
     C                     Z-ADD##JTM     WL0303           Job Time
     C                     MOVEL##USR     WL0304    P      User Id
     C                     MOVEL##PGM     WL0305    P      Job Name
     C                     Z-ADD##JDT     WL0306           Job Date
     C                     EXSR OECHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Bulk:  Tanker
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0276    P      Carrier Code
     C                     MOVELYL0055    WL0277    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0278           Company Number
     C                     MOVEL#1VDST    WL0279    P      Load Type
     C                     MOVEL'T'       WL0280    P      Trailer Type
     C                     MOVEL'N'       WL0281    P      Seaboard Owned
     C                     MOVELWN1061    WL0282    P      On Yard Status
     C                     Z-ADD#1KKDT    WL0283           On Yard Date
     C                     Z-ADD#1AVTM    WL0284           On Yard Time
     C                     MOVEL'Y'       WL0285    P      Assigned Status
     C                     MOVEL'N'       WL0286    P      Available Statu
     C                     MOVELWUGSTX    WL0287    P      Not Available R
     C                     MOVEL*BLANK    WL0288           Comment Line
     C                     MOVELWUGSTX    WL0289    P      Status Unused 1
     C                     MOVELWUGSTX    WL0290    P      Status Unused 2
     C                     MOVELWUGSTX    WL0291    P      Status Unused 3
     C                     MOVELWUGSTX    WL0292    P      Status Unused 4
     C                     MOVELWUGSTX    WL0293    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0294           Date Unused 1
     C                     Z-ADDWUW0NB    WL0295           Date Unused 2
     C                     Z-ADDWUW0NB    WL0296           Date Unused 3
     C                     Z-ADDWUW0NB    WL0297           Date Unused 4
     C                     Z-ADDWUW0NB    WL0298           Date Unused 5
     C                     MOVELWUGSTX    WL0299    P      EDI Status 1
     C                     MOVELWUGSTX    WL0300    P      EDI Status 2
     C                     MOVELWUGSTX    WL0301    P      EDI Status 3
     C                     MOVEL'A'       WL0302    P      Record Status
     C                     Z-ADD##JTM     WL0303           Job Time
     C                     MOVEL##USR     WL0304    P      User Id
     C                     MOVEL##PGM     WL0305    P      Job Name
     C                     Z-ADD##JDT     WL0306           Job Date
     C                     EXSR OECHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV/Chg Container     RT - Order Header Extension  * 
     C                     EXSR OFRVGN
      * Chg container number if export and trailer changed    E004079
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Container Number usr 1 NE LCL.Trailer Id
      *   |- c2    : PAR.Container Number usr 1 is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1CNTN    IFNE YL0055                     *IF
     C           P1CNTN    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * * Get info for the original trailer
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0089    P      Carrier Code
     C                     MOVELP1CNTN    WL0090    P      Trailer Id
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0091    YN0008           Company Number
     C                     MOVELWL0092    WUVDST    P      Load Type
     C                     MOVELWL0093    YN0009    P      Trailer Type
     C                     MOVELWL0094    YN0010    P      Seaboard Owned
     C                     MOVELWL0095    YN0011    P      On Yard Status
     C                     Z-ADDWL0096    WUKKDT           On Yard Date
     C                     Z-ADDWL0097    WUAVTM           On Yard Time
     C                     MOVELWL0098    YN0012    P      Assigned Status
     C                     MOVELWL0099    YN0013    P      Available Statu
     C                     MOVELWL0100    YN0014    P      Not Available R
     C                     MOVELWL0101    YN0015    P      Comment Line
     C                     MOVELWL0102    WN1064    P      Record Status
      * Don't add if doesn't exist, just update existing      E004079
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * * okay if it does not exist
     C                     ELSE
      * CASE: *OTHERWISE
      * * else, update to unassigned status
      * Regular versus Bulk
      * CASE: WRK.Load Type is Regular
     C           WUVDST    IFEQ 'R'                        *IF
      * Regular:  Reefer
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0276    P      Carrier Code
     C                     MOVELP1CNTN    WL0277    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0278           Company Number
     C                     MOVEL#1VDST    WL0279    P      Load Type
     C                     MOVEL'R'       WL0280    P      Trailer Type
     C                     MOVEL'N'       WL0281    P      Seaboard Owned
     C                     MOVEL'Y'       WL0282    P      On Yard Status
     C                     Z-ADDWUKKDT    WL0283           On Yard Date
     C                     Z-ADDWUAVTM    WL0284           On Yard Time
     C                     MOVEL'N'       WL0285    P      Assigned Status
     C                     MOVEL'Y'       WL0286    P      Available Statu
     C                     MOVELWUGSTX    WL0287    P      Not Available R
     C                     MOVEL*BLANK    WL0288           Comment Line
     C                     MOVELWUGSTX    WL0289    P      Status Unused 1
     C                     MOVELWUGSTX    WL0290    P      Status Unused 2
     C                     MOVELWUGSTX    WL0291    P      Status Unused 3
     C                     MOVELWUGSTX    WL0292    P      Status Unused 4
     C                     MOVELWUGSTX    WL0293    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0294           Date Unused 1
     C                     Z-ADDWUW0NB    WL0295           Date Unused 2
     C                     Z-ADDWUW0NB    WL0296           Date Unused 3
     C                     Z-ADDWUW0NB    WL0297           Date Unused 4
     C                     Z-ADDWUW0NB    WL0298           Date Unused 5
     C                     MOVELWUGSTX    WL0299    P      EDI Status 1
     C                     MOVELWUGSTX    WL0300    P      EDI Status 2
     C                     MOVELWUGSTX    WL0301    P      EDI Status 3
     C                     MOVEL'A'       WL0302    P      Record Status
     C                     Z-ADD##JTM     WL0303           Job Time
     C                     MOVEL##USR     WL0304    P      User Id
     C                     MOVEL##PGM     WL0305    P      Job Name
     C                     Z-ADD##JDT     WL0306           Job Date
     C                     EXSR OECHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Bulk:  Tanker
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0276    P      Carrier Code
     C                     MOVELP1CNTN    WL0277    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0278           Company Number
     C                     MOVEL#1VDST    WL0279    P      Load Type
     C                     MOVEL'T'       WL0280    P      Trailer Type
     C                     MOVEL'N'       WL0281    P      Seaboard Owned
     C                     MOVEL'Y'       WL0282    P      On Yard Status
     C                     Z-ADDWUKKDT    WL0283           On Yard Date
     C                     Z-ADDWUAVTM    WL0284           On Yard Time
     C                     MOVEL'N'       WL0285    P      Assigned Status
     C                     MOVEL'Y'       WL0286    P      Available Statu
     C                     MOVELWUGSTX    WL0287    P      Not Available R
     C                     MOVEL*BLANK    WL0288           Comment Line
     C                     MOVELWUGSTX    WL0289    P      Status Unused 1
     C                     MOVELWUGSTX    WL0290    P      Status Unused 2
     C                     MOVELWUGSTX    WL0291    P      Status Unused 3
     C                     MOVELWUGSTX    WL0292    P      Status Unused 4
     C                     MOVELWUGSTX    WL0293    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0294           Date Unused 1
     C                     Z-ADDWUW0NB    WL0295           Date Unused 2
     C                     Z-ADDWUW0NB    WL0296           Date Unused 3
     C                     Z-ADDWUW0NB    WL0297           Date Unused 4
     C                     Z-ADDWUW0NB    WL0298           Date Unused 5
     C                     MOVELWUGSTX    WL0299    P      EDI Status 1
     C                     MOVELWUGSTX    WL0300    P      EDI Status 2
     C                     MOVELWUGSTX    WL0301    P      EDI Status 3
     C                     MOVEL'A'       WL0302    P      Record Status
     C                     Z-ADD##JTM     WL0303           Job Time
     C                     MOVEL##USR     WL0304    P      User Id
     C                     MOVEL##PGM     WL0305    P      Job Name
     C                     Z-ADD##JDT     WL0306           Job Date
     C                     EXSR OECHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Change original trailer if there was a trailer change    E004079
      * CASE: PAR.Trailer Id            USR NE LCL.Trailer Id
     C           WUS2TX    IFNE YL0055                     *IF
      * * Get info for the original trailer
      * Rtv Trailer            RT - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0089    P      Carrier Code
     C                     MOVELWUS2TX    WL0090    P      Trailer Id
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0091    YN0008           Company Number
     C                     MOVELWL0092    WUVDST    P      Load Type
     C                     MOVELWL0093    YN0009    P      Trailer Type
     C                     MOVELWL0094    YN0010    P      Seaboard Owned
     C                     MOVELWL0095    YN0011    P      On Yard Status
     C                     Z-ADDWL0096    WUKKDT           On Yard Date
     C                     Z-ADDWL0097    WUAVTM           On Yard Time
     C                     MOVELWL0098    YN0012    P      Assigned Status
     C                     MOVELWL0099    YN0013    P      Available Statu
     C                     MOVELWL0100    YN0014    P      Not Available R
     C                     MOVELWL0101    YN0015    P      Comment Line
     C                     MOVELWL0102    WN1064    P      Record Status
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * * okay if it does not exist
     C                     ELSE
      * CASE: *OTHERWISE
      * * else, update to unassigned status
      * Regular versus Bulk
      * CASE: WRK.Load Type is Regular
     C           WUVDST    IFEQ 'R'                        *IF
      * Regular:  Reefer
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0276    P      Carrier Code
     C                     MOVELWUS2TX    WL0277    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0278           Company Number
     C                     MOVEL#1VDST    WL0279    P      Load Type
     C                     MOVEL'R'       WL0280    P      Trailer Type
     C                     MOVEL'N'       WL0281    P      Seaboard Owned
     C                     MOVEL'Y'       WL0282    P      On Yard Status
     C                     Z-ADDWUKKDT    WL0283           On Yard Date
     C                     Z-ADDWUAVTM    WL0284           On Yard Time
     C                     MOVEL'N'       WL0285    P      Assigned Status
     C                     MOVEL'Y'       WL0286    P      Available Statu
     C                     MOVELWUGSTX    WL0287    P      Not Available R
     C                     MOVEL*BLANK    WL0288           Comment Line
     C                     MOVELWUGSTX    WL0289    P      Status Unused 1
     C                     MOVELWUGSTX    WL0290    P      Status Unused 2
     C                     MOVELWUGSTX    WL0291    P      Status Unused 3
     C                     MOVELWUGSTX    WL0292    P      Status Unused 4
     C                     MOVELWUGSTX    WL0293    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0294           Date Unused 1
     C                     Z-ADDWUW0NB    WL0295           Date Unused 2
     C                     Z-ADDWUW0NB    WL0296           Date Unused 3
     C                     Z-ADDWUW0NB    WL0297           Date Unused 4
     C                     Z-ADDWUW0NB    WL0298           Date Unused 5
     C                     MOVELWUGSTX    WL0299    P      EDI Status 1
     C                     MOVELWUGSTX    WL0300    P      EDI Status 2
     C                     MOVELWUGSTX    WL0301    P      EDI Status 3
     C                     MOVEL'A'       WL0302    P      Record Status
     C                     Z-ADD##JTM     WL0303           Job Time
     C                     MOVEL##USR     WL0304    P      User Id
     C                     MOVEL##PGM     WL0305    P      Job Name
     C                     Z-ADD##JDT     WL0306           Job Date
     C                     EXSR OECHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Bulk:  Tanker
      * Chg PD Trailer         CH - Trailer  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0054    WL0276    P      Carrier Code
     C                     MOVELWUS2TX    WL0277    P      Trailer Id
     C                     Z-ADD#1AIC3    WL0278           Company Number
     C                     MOVEL#1VDST    WL0279    P      Load Type
     C                     MOVEL'T'       WL0280    P      Trailer Type
     C                     MOVEL'N'       WL0281    P      Seaboard Owned
     C                     MOVEL'Y'       WL0282    P      On Yard Status
     C                     Z-ADDWUKKDT    WL0283           On Yard Date
     C                     Z-ADDWUAVTM    WL0284           On Yard Time
     C                     MOVEL'N'       WL0285    P      Assigned Status
     C                     MOVEL'Y'       WL0286    P      Available Statu
     C                     MOVELWUGSTX    WL0287    P      Not Available R
     C                     MOVEL*BLANK    WL0288           Comment Line
     C                     MOVELWUGSTX    WL0289    P      Status Unused 1
     C                     MOVELWUGSTX    WL0290    P      Status Unused 2
     C                     MOVELWUGSTX    WL0291    P      Status Unused 3
     C                     MOVELWUGSTX    WL0292    P      Status Unused 4
     C                     MOVELWUGSTX    WL0293    P      Status Unused 5
     C                     Z-ADDWUW0NB    WL0294           Date Unused 1
     C                     Z-ADDWUW0NB    WL0295           Date Unused 2
     C                     Z-ADDWUW0NB    WL0296           Date Unused 3
     C                     Z-ADDWUW0NB    WL0297           Date Unused 4
     C                     Z-ADDWUW0NB    WL0298           Date Unused 5
     C                     MOVELWUGSTX    WL0299    P      EDI Status 1
     C                     MOVELWUGSTX    WL0300    P      EDI Status 2
     C                     MOVELWUGSTX    WL0301    P      EDI Status 3
     C                     MOVEL'A'       WL0302    P      Record Status
     C                     Z-ADD##JTM     WL0303           Job Time
     C                     MOVEL##USR     WL0304    P      User Id
     C                     MOVEL##PGM     WL0305    P      Job Name
     C                     Z-ADD##JDT     WL0306           Job Date
     C                     EXSR OECHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Trailer Change - write load order change log            6/24/03
      * CASE: PAR.Trailer Id NE PAR.Trailer Id            USR
     C           #DS2TX    IFNE WUS2TX                     *IF
     C                     MOVEL'ASNTRL'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWUS2TX    PBMNTX    P      Change Log Prio
     C                     MOVELYL0055    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993731*
     C                     END
     C                     END                             *FI
      * Carrier Change - write load order change log            9/04/07
      * CASE: PAR.Carrier Code NE PAR.Carrier Code Usr
     C           #1BZNA    IFNE WUH8AA                     *IF
     C                     MOVEL'CARCHG'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop_Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVELWUH8AA    PBMNTX    P      Change Log Prio
     C                     MOVELYL0054    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD*ZERO     PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993731*
     C                     END
     C                     END                             *FI
      * If flat amount is GT zero then calc Rated Freight.
      * CASE: PAR.Flat Amount is GT Zero
     C           #1FLAM    IFGT 0                          *IF
      * UPD Rated Frt Post Shp XF - OM Load Detail  * 
     C                     CALL 'PDJVXFR'              90  UPD Rated Frt P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0175  70       Load ID
     C                     PARM #1AIC3    WQ0176  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YKRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           YL0063    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C                     MOVEL'0'       *IN77
     C           P4R4ST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN78
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C           WUF4ST    IFEQ 'L'                        *IF
     C                     MOVEL'1'       *IN75
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           #1PKST    IFEQ 'L'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C                     MOVEL'0'       *IN73
     C           P6HWSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN73
     C                     END                             *FI
     C                     MOVEL'0'       *IN72
     C           #1RYSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN72
     C                     END                             *FI
      * Disable key screen
     C                     SETOF                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVELP8D4ST    #PD4ST           USR Flag 1
     C                     Z-ADD*ZERO     #DVSVA           USR Total Order
     C                     Z-ADD*ZERO     #DKHDT           Date of Expirat
     C                     Z-ADD*ZERO     #DAOFC           Amount of Cargo
     C                     MOVEL*BLANK    #DCOFI           Certificate of
     C                     Z-ADD*ZERO     #DOTNB           USR Deadline De
     C                     Z-ADD*ZERO     #1AXTM           Deadline Depart
     C                     MOVEL*BLANK    #1LHOS           Load Held Over
     C                     MOVEL*BLANK    #1LHOR           Load Held Over
     C                     MOVEL*BLANK    #1WNTX           Load Held Over
     C                     MOVEL*BLANK    #1OITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    #1OJTX           Express Mail Nu
     C                     Z-ADD*ZERO     #1LLDT           Express Mail Da
     C                     MOVEL*BLANK    #1LSHG           Load Shag Flag
     C                     MOVEL*BLANK    #1YPST           Load Wash Flag
     C                     MOVEL*BLANK    #DC2TX           OHE Carrier SCA
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     MOVEL*BLANK    #1J8TX           Car_Veh_Initial
     C                     MOVEL*BLANK    #DC3TX           OHE Spot Buy
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     Z-ADD*ZERO     #1PRTM           Product Tempera
     C                     MOVEL*BLANK    #1DMTX           Seal 1
     C                     MOVEL*BLANK    #1DNTX           Seal 2
     C                     MOVEL*BLANK    #1DOTX           Seal 3
     C                     MOVEL*BLANK    #1WTTX           Seal 4
     C                     MOVEL*BLANK    #1WUTX           Seal 2 Unused
     C                     MOVEL*BLANK    #1J9TX           Recorder ID
     C                     Z-ADD*ZERO     #1RPNB           Total Load Orde
     C                     MOVEL*BLANK    #1XQST           Allocate Pounds
     C                     Z-ADD*ZERO     #1RRNB           Total Stops
     C                     Z-ADD*ZERO     #1SBNB           BOL Time
     C                     Z-ADD*ZERO     #1DHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     #1DIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     #1DGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1VCST           Ship Status
     C                     Z-ADD*ZERO     #1SDNB           Number Pallets
     C                     Z-ADD*ZERO     #1PAOU           Number Pallets
     C                     Z-ADD*ZERO     #1NPSV           Number Spacers
     C                     Z-ADD*ZERO     #1SXNB           Estimated Arriv
     C                     Z-ADD*ZERO     #1HADT           Actual Arrival
     C                     Z-ADD*ZERO     #1AART           Actual Arrival
     C                     Z-ADD*ZERO     #1AQDT           Actual Departur
     C                     Z-ADD*ZERO     #1S6NB           Departure Time
     C                     Z-ADD*ZERO     #1GRWE           Gross Weight
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     Z-ADD*ZERO     #1F9DT           Actual Ship Dat
     C                     MOVEL*BLANK    #1ONTM           On Time_Y_N
     C                     Z-ADD*ZERO     #1J4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     #1TRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     #1J5DT           Spotted Date
     C                     Z-ADD*ZERO     #1SPTM           Spotted Time
     C                     Z-ADD*ZERO     #1J6DT           Load Finished D
     C                     Z-ADD*ZERO     #1LFTM           Load Finished T
     C                     Z-ADD*ZERO     #1J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     #1BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     #1J8DT           BOL Received Da
     C                     Z-ADD*ZERO     #1BLTM           BOL Received Ti
     C                     Z-ADD*ZERO     #1KIDT           Truck Departure
     C                     Z-ADD*ZERO     #1ASTM           Truck Departure
     C                     Z-ADD*ZERO     #1KADT           Adjusted Depart
     C                     Z-ADD*ZERO     #1AJCM           Adjusted Depart
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     MOVEL*BLANK    #1K4TX           Vessel Name
     C                     Z-ADD*ZERO     #1VOAG           Voyage
     C                     Z-ADD*ZERO     #1KBDT           Sail Date
     C                     MOVEL*BLANK    #1NBBO           Booking Number
     C                     MOVEL*BLANK    #1W4CD           Discharge Port
     C                     Z-ADD*ZERO     #1EFDT           Arrival Date
     C                     MOVEL*BLANK    #1CNTN           Container Numbe
     C                     Z-ADD*ZERO     #1KCDT           Date In
     C                     Z-ADD*ZERO     #1TMIN           Time In
     C                     Z-ADD*ZERO     #1KDDT           Date Out
     C                     Z-ADD*ZERO     #1VMNB           Time Out
     C                     Z-ADD*ZERO     #1OCFR           Load Total Frei
     C                     Z-ADD*ZERO     #1KJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     #1ATTM           Scheduled Deliv
     C                     MOVEL*BLANK    #1OTRS           LH Unused Sts
     C                     MOVEL*BLANK    #1RNST           LH Carrier Paym
     C                     Z-ADD*ZERO     #1BRBK           Bring Back Mile
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
     C                     MOVEL*BLANK    #1RMST           Load Acceptance
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     Z-ADD*ZERO     #1K0DT           Product Complet
     C                     Z-ADD*ZERO     #1AYTM           Product Complet
     C                     Z-ADD*ZERO     #1KNNX           Pallets Loaded
     C                     Z-ADD*ZERO     #1ICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     #1IDWG           Tot Pallet Tare
     C                     MOVEL*BLANK    #1H9SX           Load Confirmed
     C                     MOVEL*BLANK    #1WOTX           Load Confirmed
     C                     Z-ADD*ZERO     #1K1DT           Load Confirmati
     C                     Z-ADD*ZERO     #1AZTM           Load Door 1
     C                     Z-ADD*ZERO     #1K2DT           Override Total
     C                     Z-ADD*ZERO     #1A0TM           Load Door 2
     C                     MOVEL*BLANK    #1ROST           Partial Load
     C                     MOVEL*BLANK    #1RPST           Load Confirmati
     C                     MOVEL*BLANK    #1RQST           Export Load USD
     C                     MOVEL*BLANK    #1RRST           Late Delivery E
     C                     Z-ADD*ZERO     #1ZBVA           Load Actual Fre
     C                     MOVEL*BLANK    #1WPTX           Hide on WW Load
     C                     MOVEL*BLANK    #1WQTX           Late Billing Em
     C                     MOVEL*BLANK    #1WRTX           Shipping Temp C
     C                     MOVEL*BLANK    #1WSTX           LH Held Over Rs
     C                     MOVEL*BLANK    #1RVSX           Multi Company L
     C                     MOVEL*BLANK    #1RUSX           Fax Sent to SSI
     C                     MOVEL*BLANK    #1RWSX           Schedule Pos Lo
     C                     MOVEL*BLANK    #1RYSX           MG Created Load
     C                     MOVEL*BLANK    #1RZSX           LH Unused Sts 5
     C                     MOVEL*BLANK    #1R0SX           Load U_M
     C                     MOVEL*BLANK    #1R1SX           TPM Shipment St
     C                     MOVEL*BLANK    #1R2SX           LH Unused Sts 8
     C                     MOVEL*BLANK    #1R3SX           LH On-Time Reas
     C                     MOVEL*BLANK    #1R4SX           LH Held Over Re
     C                     Z-ADD*ZERO     #1PYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     #1CKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     #1PZDT           LH Last Combo P
     C                     Z-ADD*ZERO     #1CLTM           LH Last Combo P
     C                     Z-ADD*ZERO     #1P1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     #1CNTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P2DT           LH Unused Date
     C                     Z-ADD*ZERO     #1COTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P3DT           LH Unused Date
     C                     Z-ADD*ZERO     #1CQTM           LH Unused Time
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1PKST           Load Status
     C                     MOVEL*BLANK    #DHKNA           Status Descript
     C                     Z-ADD*ZERO     #1KZDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     V1KZDT
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     Z-ADD*ZERO     #DAGTH           TMS Deadline De
     C                     Z-ADD*ZERO     #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     MOVEL*BLANK    #DNCNA           USR Desc. 10
     C                     MOVEL*BLANK    #1RXSX           LH Power Only L
     C                     MOVEL*BLANK    #DY7TX           Text USR 5
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADD*ZERO     #1T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #1P0DT           LPT Load Plan S
      * Clear external version also
     C                     Z-ADD*ZERO     V1P0DT
     C                     Z-ADD*ZERO     #1CMTM           LPT Load Plan S
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #DGVTX           USR Carrier Nam
     C                     MOVEL*BLANK    #1XCCD           Carrier Broker
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    #DS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #1DYTX           Transloader Car
     C                     MOVEL*BLANK    #DL3NA           USR Description
     C                     Z-ADD*ZERO     #1TLMI           Total Load Mile
     C                     MOVEL*BLANK    #DEZTX           USR Work Field
     C                     MOVEL*BLANK    #DEET1           Description 21A
     C                     MOVEL*BLANK    #1RONB           Truck Size
     C                     MOVEL*BLANK    #DDPTX           Truck Size Desc
     C                     Z-ADD*ZERO     #1FLAM           Flat Amount
     C                     MOVEL*BLANK    #1VPCD           Ship From Wareh
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     MOVEL*BLANK    #DHSNA           State Descripti
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     MOVEL*BLANK    #DI6TX           Description 14A
     C                     MOVEL*BLANK    #DHNNA           Ship To City
     C                     MOVEL*BLANK    #DLHNA           USR State Name
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPBN fields to screen
      *================================================================
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJJ8TX    #1J8TX           Car_Veh_Initial
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJONTM    #1ONTM           On Time_Y_N
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U_M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP8D4ST    #PD4ST           USR Flag 1
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MFIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     MOVEL*BLANK    #DSQTX           Company Name DR
      *================================================================
     CSR         MFEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Deadline Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1KZDT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert LPT Load Plan Start Dt to display format
      * Convert date
     C           1000000   ADD  #1P0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1P0DT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQNA02           Load ID
      * Define keylist
     C           KPSNA     KLIST
     C                     KFLD           WQNA02           Load ID
     C                     KFLD           WGRVNB           Stop_Drop
     C                     KFLD           WGC4NB           Order Number
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WQNA02           Load ID
      * Setup key
     C                     Z-ADDWL0195    WQNA02           Load ID
     C                     Z-ADDWL0196    WGRVNB           Stop_Drop
     C                     Z-ADDWL0197    WGC4NB           Order Number
      * Establish starting position
     C           KPSNA     SETLL@FLCPEB                    *
     C           KRSNA     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGRWNB    WL0198           Miles to next s
     C                     GOTO NAEXIT                     *QUIT
     C           KRSNA     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSNB     KLIST
     C                     KFLD           LGMILE           Miles to First
      * Setup key
     C                     Z-ADDWL0199    LGMILE           Miles to First
      * Establish starting position
     C           KPSNB     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLGHRRQ    WL0200           Hours Required
     C                     GOTO NBEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0201    FJRMNB           Load ID
      * Establish starting position
     C           KRSNC     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    WL0202           Load Status
     C                     Z-ADDFJTLMI    WL0203           Total Load Mile
     C                     Z-ADDFJK2DT    WL0204           Override Total
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDCHRC    BEGSR
      *================================================================
      * CHG Lock Load Update   CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0198  30       Company Number
     C                     MOVEL*BLANK    WN0199  1        LTL Flag
     C                     Z-ADD*ZERO     WN0200  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0201 15        Seal 1
     C                     MOVEL*BLANK    WN0202 15        Seal 2
     C                     MOVEL*BLANK    WN0203 15        Seal 3
     C                     MOVEL*BLANK    WN0204 15        Seal 4
     C                     MOVEL*BLANK    WN0205 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0206  70       Total Load Orde
     C                     MOVEL*BLANK    WN0207  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0208  50       Total Stops
     C                     MOVEL*BLANK    WN0209 20        Trailer Id
     C                     MOVEL*BLANK    WN0210  3        Transloader Car
     C                     Z-ADD*ZERO     WN0211  40       BOL Time
     C                     MOVEL*BLANK    WN0212  3        Carrier Code
     C                     MOVEL*BLANK    WN0213  7        Truck Size
     C                     Z-ADD*ZERO     WN0214  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0215 112       Rated Freight
     C                     MOVEL*BLANK    WN0216  1        Ship Status
     C                     MOVEL*BLANK    WN0217  1        Load Type
     C                     Z-ADD*ZERO     WN0218  50       Number Pallets
     C                     Z-ADD*ZERO     WN0219  50       Number Pallets
     C                     Z-ADD*ZERO     WN0220 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0221  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0222  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0223  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0224 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0225 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0226  70       Actual Departur
     C                     Z-ADD*ZERO     WN0227  40       Departure Time
     C                     Z-ADD*ZERO     WN0228  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0229  52       Product Tempera
     C                     Z-ADD*ZERO     WN0230  50       Number Spacers
     C                     MOVEL*BLANK    WN0231 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0232  70       Total Load Mile
     C                     MOVEL*BLANK    WN0233 12        Recorder ID
     C                     MOVEL*BLANK    WN0234  2        Shipping Method
     C                     Z-ADD*ZERO     WN0235  70       Gross Weight
     C                     MOVEL*BLANK    WN0236  3        Carrier Broker
     C                     MOVEL*BLANK    WN0237  1        Export Status
     C                     Z-ADD*ZERO     WN0238  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0239  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0240  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0241  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0242  70       Spotted Date
     C                     Z-ADD*ZERO     WN0243  60       Spotted Time
     C                     Z-ADD*ZERO     WN0244  70       Load Finished D
     C                     Z-ADD*ZERO     WN0245  60       Load Finished T
     C                     Z-ADD*ZERO     WN0246  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0247  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0248  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0249  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0250  70       Truck Departure
     C                     Z-ADD*ZERO     WN0251  60       Truck Departure
     C                     Z-ADD*ZERO     WN0252  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0253  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0254  3        Shipping Line
     C                     MOVEL*BLANK    WN0255 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0256 30        Vessel Name
     C                     Z-ADD*ZERO     WN0257  50       Voyage
     C                     Z-ADD*ZERO     WN0258  70       Sail Date
     C                     MOVEL*BLANK    WN0259 12        Booking Number
     C                     MOVEL*BLANK    WN0260 20        Discharge Port
     C                     Z-ADD*ZERO     WN0261  70       Arrival Date
     C                     MOVEL*BLANK    WN0262 12        Container Numbe
     C                     Z-ADD*ZERO     WN0263  70       Date In
     C                     Z-ADD*ZERO     WN0264  60       Time In
     C                     Z-ADD*ZERO     WN0265  70       Date Out
     C                     Z-ADD*ZERO     WN0266  60       Time Out
     C                     Z-ADD*ZERO     WN0267 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0268  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0269  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0270  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0271  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0272  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0273  70       Requested Deliv
     C                     MOVEL*BLANK    WN0274  1        Load Acceptance
     C                     MOVEL*BLANK    WN0275  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0276  70       On Yard Date
     C                     Z-ADD*ZERO     WN0277  60       On Yard Time
     C                     MOVEL*BLANK    WN0278  1        Load Held Over
     C                     MOVEL*BLANK    WN0279  1        Load Held Over
     C                     MOVEL*BLANK    WN0280 15        Load Held Over
     C                     MOVEL*BLANK    WN0281 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0282 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0283  70       Express Mail Da
     C                     MOVEL*BLANK    WN0284  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0285  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0286  70       Product Complet
     C                     Z-ADD*ZERO     WN0287  60       Product Complet
     C                     Z-ADD*ZERO     WN0288  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0289  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0290  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0291  1        Load Confirmed
     C                     MOVEL*BLANK    WN0292 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0293  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0294  60       Load Door 1
     C                     Z-ADD*ZERO     WN0295  70       Override Total
     C                     Z-ADD*ZERO     WN0296  60       Load Door 2
     C                     MOVEL*BLANK    WN0297  1        Partial Load
     C                     MOVEL*BLANK    WN0298  1        Load Confirmati
     C                     MOVEL*BLANK    WN0299  1        Export Load USD
     C                     MOVEL*BLANK    WN0300  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0301 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0302 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0303 15        Late Billing Em
     C                     MOVEL*BLANK    WN0304 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0305 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0306  1        Multi Company L
     C                     MOVEL*BLANK    WN0307  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0308  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0309  1        LH Power Only L
     C                     MOVEL*BLANK    WN0310  1        MG Created Load
     C                     MOVEL*BLANK    WN0311  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0312  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0313  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0314  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0315  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0316  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0317  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0318  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0319  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0320  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0321  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0322  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0323  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0324  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0325  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0326  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0327  60       LH Unused Time
     C                     MOVEL*BLANK    WN0328  1        EDI Status 1
     C                     MOVEL*BLANK    WN0329  1        EDI Status 2
     C                     MOVEL*BLANK    WN0330  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0331  60       Job Time
     C                     MOVEL*BLANK    WN0332 10        User Id
     C                     MOVEL*BLANK    WN0333 10        Job Name
     C                     Z-ADD*ZERO     WN0334  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0205    FJRMNB           Load ID
      *
     C           KLCHND    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHND    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0206    FJAODT           Scheduled Ship
     C                     MOVELWL0207    FJPKST    P      Load Status
     C                     Z-ADDWL0208    FJFLAM           Flat Amount
     C                     MOVELWL0209    FJVPCD    P      Ship From Wareh
     C                     MOVELWL0210    FJDBCD    P      Ship To State C
     C                     Z-ADDWL0211    FJKZDT           Deadline Depart
     C                     Z-ADDWL0212    FJAXTM           Deadline Depart
     C                     MOVELWL0213    FJR0SX    P      Load U_M
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##JOB     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0215           USR Warehouse C
     C                     MOVEL*BLANK    WL0216           USR CDE Parm 1
     C                     MOVEL*BLANK    WL0217           USR CDE Parm 2
     C                     MOVEL*BLANK    WL0218           USR CDE Parm 3
     C                     MOVEL*BLANK    WL0219           USR CDE Parm 4
     C                     MOVEL*BLANK    WL0220           USR CDE Parm 5
     C                     MOVEL*BLANK    WL0221           USR CDE Parm 6
     C                     MOVEL*BLANK    WL0222           USR CDE Parm 7
     C                     MOVEL*BLANK    WL0223           USR CDE Parm 8
     C                     MOVEL*BLANK    WL0224           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKRMNB    WQNE02           Load ID
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WQNE02           Load ID
      * Setup key
     C                     Z-ADDWL0214    WQNE02           Load ID
      * Establish starting position
     C           KRSNE     SETLL@FLCPKF                    *
     C           KRSNE     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR NFRVGN
     C           KRSNE     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQNF01           Company Number
     C           *LIKE     DEFN OMC4NB    WQNF02           Order Number
      * Define keylist
     C           KPSNF     KLIST
     C                     KFLD           WQNF01           Company Number
     C                     KFLD           WQNF02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           Company Number
     C                     KFLD           WQNF02           Order Number
      * Setup key
     C                     Z-ADDWKAIC3    WQNF01           Company Number
     C                     Z-ADDWKC4NB    WQNF02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSNF     SETLL@BGWKAE                    *
     C           KRSNF     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           OMAJCD    IFEQ WL0215                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           OMAJCD    IFEQ WL0216                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           OMAJCD    IFEQ WL0217                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           OMAJCD    IFEQ WL0218                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           OMAJCD    IFEQ WL0219                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           OMAJCD    IFEQ WL0220                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           OMAJCD    IFEQ WL0221                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           OMAJCD    IFEQ WL0222                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           OMAJCD    IFEQ WL0223                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           OMAJCD    IFEQ WL0224                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           WL0215    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0215           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           WL0216    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0216           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           WL0217    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0217           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           WL0218    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0218           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           WL0219    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0219           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           WL0220    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0220           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           WL0221    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0221           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           WL0222    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0222           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           WL0223    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0223           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           WL0224    IFEQ WUGSTX                     *IF
     C                     MOVELOMAJCD    WL0224           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNF     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLRMNB    WQNG01           Load ID
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           WQNG01           Load ID
      * Setup key
     C                     Z-ADDWL0225    WQNG01           Load ID
      * Establish starting position
     C           KRSNG     SETLL@FLCPBW                    *
     C           KRSNG     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR NHRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WL0226           Trans Contol AS
     C                     GOTO NGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNG     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDWLAIC3    WAAIC3           Company Number
     C                     Z-ADDWLC4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSNH     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR NIRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO NHEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NIRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQNI01           Company Number
     C           *LIKE     DEFN WMC4NB    WQNI02           Order Number
      * Define keylist
     C           KRSNI     KLIST
     C                     KFLD           WQNI01           Company Number
     C                     KFLD           WQNI02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQNI01           Company Number
     C                     Z-ADDWAC4NB    WQNI02           Order Number
      * Establish starting position
     C           KRSNI     SETLL@BGWKL1                    *
     C           KRSNI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WMGMST    IFEQ 'L'                        *IF
     C           WMGMST    OREQ 'A'
     C           WMGMST    OREQ 'C'
     C           WMGMST    OREQ 'R'
     C           WMGMST    OREQ 'E'
     C           WMGMST    OREQ 'H'
     C           WMGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR NJRVGN
     C                     GOTO NIEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNJ     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWMAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSNJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDF8NA    WUF8NA           Warehouse Descr
     C                     MOVELWDXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0227    BUY1NX           PFS Company Num
     C                     MOVELWL0228    BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSNK     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0229           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0230           PFS Carlisle Ac
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    WL0229           PFS AccuSort Ac
     C                     MOVELBUWUSX    WL0230           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCHRC    BEGSR
      *================================================================
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0340  30       Company Number
     C                     Z-ADD*ZERO     WN0341  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0342  1        LTL Flag
     C                     Z-ADD*ZERO     WN0343  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0344 15        Seal 1
     C                     MOVEL*BLANK    WN0345 15        Seal 2
     C                     MOVEL*BLANK    WN0346 15        Seal 3
     C                     MOVEL*BLANK    WN0347 15        Seal 4
     C                     MOVEL*BLANK    WN0348 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0349  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0350 112       Flat Amount
     C                     MOVEL*BLANK    WN0351  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0352  50       Total Stops
     C                     MOVEL*BLANK    WN0353 20        Trailer Id
     C                     MOVEL*BLANK    WN0354  3        Transloader Car
     C                     Z-ADD*ZERO     WN0355  40       BOL Time
     C                     MOVEL*BLANK    WN0356  3        Carrier Code
     C                     MOVEL*BLANK    WN0357  7        Truck Size
     C                     Z-ADD*ZERO     WN0358  70       Ld Hdr_Ld Dtl U
     C                     MOVEL*BLANK    WN0359  1        Ship Status
     C                     MOVEL*BLANK    WN0360  1        Load Type
     C                     Z-ADD*ZERO     WN0361  50       Number Pallets
     C                     Z-ADD*ZERO     WN0362  50       Number Pallets
     C                     Z-ADD*ZERO     WN0363 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0364  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0365  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0366  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0367 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0368 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0369  70       Actual Departur
     C                     Z-ADD*ZERO     WN0370  40       Departure Time
     C                     Z-ADD*ZERO     WN0371  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0372  52       Product Tempera
     C                     Z-ADD*ZERO     WN0373  50       Number Spacers
     C                     MOVEL*BLANK    WN0374 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0375  70       Total Load Mile
     C                     MOVEL*BLANK    WN0376 12        Recorder ID
     C                     MOVEL*BLANK    WN0377  2        Shipping Method
     C                     MOVEL*BLANK    WN0378  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0379  2        Ship To State C
     C                     Z-ADD*ZERO     WN0380  70       Gross Weight
     C                     MOVEL*BLANK    WN0381  3        Carrier Broker
     C                     MOVEL*BLANK    WN0382  1        Export Status
     C                     Z-ADD*ZERO     WN0383  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0384  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0385  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0386  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0387  70       Spotted Date
     C                     Z-ADD*ZERO     WN0388  60       Spotted Time
     C                     Z-ADD*ZERO     WN0389  70       Load Finished D
     C                     Z-ADD*ZERO     WN0390  60       Load Finished T
     C                     Z-ADD*ZERO     WN0391  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0392  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0393  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0394  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0395  70       Truck Departure
     C                     Z-ADD*ZERO     WN0396  60       Truck Departure
     C                     Z-ADD*ZERO     WN0397  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0398  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0399  3        Shipping Line
     C                     MOVEL*BLANK    WN0400 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0401 30        Vessel Name
     C                     Z-ADD*ZERO     WN0402  50       Voyage
     C                     Z-ADD*ZERO     WN0403  70       Sail Date
     C                     MOVEL*BLANK    WN0404 12        Booking Number
     C                     MOVEL*BLANK    WN0405 20        Discharge Port
     C                     Z-ADD*ZERO     WN0406  70       Arrival Date
     C                     MOVEL*BLANK    WN0407 12        Container Numbe
     C                     Z-ADD*ZERO     WN0408  70       Date In
     C                     Z-ADD*ZERO     WN0409  60       Time In
     C                     Z-ADD*ZERO     WN0410  70       Date Out
     C                     Z-ADD*ZERO     WN0411  60       Time Out
     C                     Z-ADD*ZERO     WN0412 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0413  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0414  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0415  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0416  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0417  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0418  70       Requested Deliv
     C                     MOVEL*BLANK    WN0419  1        Load Acceptance
     C                     MOVEL*BLANK    WN0420  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0421  70       On Yard Date
     C                     Z-ADD*ZERO     WN0422  60       On Yard Time
     C                     Z-ADD*ZERO     WN0423  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0424  60       Deadline Depart
     C                     MOVEL*BLANK    WN0425  1        Load Held Over
     C                     MOVEL*BLANK    WN0426  1        Load Held Over
     C                     MOVEL*BLANK    WN0427 15        Load Held Over
     C                     MOVEL*BLANK    WN0428 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0429 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0430  70       Express Mail Da
     C                     MOVEL*BLANK    WN0431  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0432  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0433  70       Product Complet
     C                     Z-ADD*ZERO     WN0434  60       Product Complet
     C                     Z-ADD*ZERO     WN0435  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0436  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0437  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0438  1        Load Confirmed
     C                     MOVEL*BLANK    WN0439 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0440  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0441  60       Load Door 1
     C                     Z-ADD*ZERO     WN0442  70       Override Total
     C                     Z-ADD*ZERO     WN0443  60       Load Door 2
     C                     MOVEL*BLANK    WN0444  1        Partial Load
     C                     MOVEL*BLANK    WN0445  1        Load Confirmati
     C                     MOVEL*BLANK    WN0446  1        Export Load USD
     C                     MOVEL*BLANK    WN0447  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0448 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0449 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0450 15        Late Billing Em
     C                     MOVEL*BLANK    WN0451 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0452 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0453  1        Multi Company L
     C                     MOVEL*BLANK    WN0454  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0455  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0456  1        LH Power Only L
     C                     MOVEL*BLANK    WN0457  1        MG Created Load
     C                     MOVEL*BLANK    WN0458  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0459  2        Load U_M
     C                     MOVEL*BLANK    WN0460  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0461  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0462  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0463  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0464  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0465  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0466  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0467  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0468  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0469  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0470  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0471  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0472  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0473  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0474  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0475  60       LH Unused Time
     C                     MOVEL*BLANK    WN0476  1        EDI Status 1
     C                     MOVEL*BLANK    WN0477  1        EDI Status 2
     C                     MOVEL*BLANK    WN0478  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0479  60       Job Time
     C                     MOVEL*BLANK    WN0480 10        User Id
     C                     MOVEL*BLANK    WN0481 10        Job Name
     C                     Z-ADD*ZERO     WN0482  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0231    FJRMNB           Load ID
      *
     C           KLCHNL    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHNL    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YCRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELWL0232    FJPKST    P      Load Status
     C                     Z-ADDWL0233    FJR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##PGM     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMRVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNM     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVELWL0234    DPDOCD           System Value Co
      * Establish starting position
     C           KRSNM     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0235           System Value Al
     C                     GOTO NMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDPBXTX    WL0235           System Value Al
     C                     ENDIF
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQNN02           Load ID
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           WQNN02           Load ID
      * Setup key
     C                     Z-ADDWL0236    WQNN02           Load ID
      * Establish starting position
     C           KRSNN     SETLL@FLCPEB                    *
     C           KRSNN     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Recovery Freight   CH - Load Detail  * 
     C                     EXSR NOCHRC
      * CHG Clear Rated Frt    RT - PD Order Header  * 
     C                     EXSR NPRVGN
     C           KRSNN     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NOCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0487  50       Stop_Drop
     C                     MOVEL*BLANK    WN0488 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0489  72       Freight Charge
     C                     Z-ADD*ZERO     WN0490  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0491  30       Company Number
     C                     Z-ADD*ZERO     WN0492  70       Order Number
     C                     MOVEL*BLANK    WN0493  1        Ship Status
     C                     Z-ADD*ZERO     WN0494  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0495  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0496  70       Appointment Con
     C                     Z-ADD*ZERO     WN0497  60       Appointment Con
     C                     MOVEL*BLANK    WN0498 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0499 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0500  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0501  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0502  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0503  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0504  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0505  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0506  70       On Yard Date
     C                     Z-ADD*ZERO     WN0507  60       On Yard Time
     C                     Z-ADD*ZERO     WN0508  70       MPC Number
     C                     MOVEL*BLANK    WN0509  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0510  1        On Time Addl Rs
     C                     MOVEL*BLANK    WN0511 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0512 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0513 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0514 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0515 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0516  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0517  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0518  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0519  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0520  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0521  60       LD Unused Time
     C                     MOVEL*BLANK    WN0522  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0523  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0524  2        HPB Transload S
     C                     MOVEL*BLANK    WN0525 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0526 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN0527 25        Cust Assigned A
     C                     MOVEL*BLANK    WN0528  1        EDI Status 1
     C                     MOVEL*BLANK    WN0529  1        EDI Status 2
     C                     MOVEL*BLANK    WN0530  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0531  60       Job Time
     C                     MOVEL*BLANK    WN0532 10        User Id
     C                     MOVEL*BLANK    WN0533 10        Job Name
     C                     Z-ADD*ZERO     WN0534  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWGRMNB    WORMNB           Load ID
     C                     Z-ADDWGRUNB    WORUNB           Stop_Drop Seque
      *
     C           KLCHNO    KLIST
     C                     KFLD           WORMNB           Load ID
     C                     KFLD           WORUNB           Stop_Drop Seque
     C           KLCHNO    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YDRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWGRWNB    WORWNB           Miles to next s
     C                     Z-ADD*ZERO     WOT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WOT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WOR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WOAATM' defaulted for 'Job Time'.
      * Field '(DB1) WOAYNA' defaulted for 'User Id'.
      * Field '(DB1) WOA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WOAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WOAATM           Job Time
     C                     MOVEL##USR     WOAYNA           User Id
     C                     MOVEL##JOB     WOA0NA           Job Name
     C                     Z-ADD##JDT     WOAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRRMNB    WQNP02           Load ID
     C           *LIKE     DEFN WRC4NB    WQNP03           Order Number
      * Define keylist
     C           KRSNP     KLIST
     C                     KFLD           WQNP02           Load ID
     C                     KFLD           WQNP03           Order Number
      * Setup key
     C                     Z-ADDWGRMNB    WQNP02           Load ID
     C                     Z-ADDWGC4NB    WQNP03           Order Number
      * Establish starting position
     C           KRSNP     SETLL@BFCPNQ                    *
     C           KRSNP     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rated Freight      CH - PD Order Header  * 
     C                     EXSR NQCHRC
      * 05/13/04 slm Multi-Company - Order Header lv remove co must use d
      *                               was using the par replace with db1
      * UPD Rated Freight      RT - Order Detail  * 
     C                     EXSR NRRVGN
     C           KRSNP     READE@BFCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0535  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0536  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0537  70       Ship To Custome
     C                     MOVEL*BLANK    WN0538 30        Ship To Name
     C                     MOVEL*BLANK    WN0539 30        Ship To Address
     C                     MOVEL*BLANK    WN0540 30        Ship To Address
     C                     MOVEL*BLANK    WN0541 30        Ship To Address
     C                     MOVEL*BLANK    WN0542 20        Ship To City
     C                     MOVEL*BLANK    WN0543  2        Ship To State C
     C                     MOVEL*BLANK    WN0544 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0545  70       Bill to Custome
     C                     MOVEL*BLANK    WN0546 30        Bill to Name
     C                     MOVEL*BLANK    WN0547 30        Bill to Address
     C                     MOVEL*BLANK    WN0548 30        Bill to Address
     C                     MOVEL*BLANK    WN0549 30        Bill to Address
     C                     MOVEL*BLANK    WN0550 20        Bill to City
     C                     MOVEL*BLANK    WN0551  2        Bill to State C
     C                     MOVEL*BLANK    WN0552 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0553 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0554  70       Order Date
     C                     Z-ADD*ZERO     WN0555  70       Requested Ship
     C                     Z-ADD*ZERO     WN0556  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0557  70       Cancel Date
     C                     MOVEL*BLANK    WN0558  2        Terms Code
     C                     MOVEL*BLANK    WN0559 40        Special Instruc
     C                     MOVEL*BLANK    WN0560 40        Special Instruc
     C                     MOVEL*BLANK    WN0561  3        Carrier Code
     C                     MOVEL*BLANK    WN0562  1        Comment Print A
     C                     MOVEL*BLANK    WN0563  1        Comment Print I
     C                     MOVEL*BLANK    WN0564  1        Comment Print P
     C                     MOVEL*BLANK    WN0565  1        Comment Print S
     C                     MOVEL*BLANK    WN0566  3        Reason Code
     C                     MOVEL*BLANK    WN0567  1        Order in Use
     C                     MOVEL*BLANK    WN0568  1        Header Status
     C                     MOVEL*BLANK    WN0569  1        Header Status L
     C                     MOVEL*BLANK    WN0570  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0571  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0572 10        User Original E
     C                     Z-ADD*ZERO     WN0573  70       Date of Origina
     C                     Z-ADD*ZERO     WN0574 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0575 112       Order Weight To
     C                     MOVEL*BLANK    WN0576  1        Credit Hold
     C                     MOVEL*BLANK    WN0577  1        Production Hold
     C                     MOVEL*BLANK    WN0578  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0579  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0580  40       Requested Deliv
     C                     MOVEL*BLANK    WN0581  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0582 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0583  70       Load ID
     C                     Z-ADD*ZERO     WN0584  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0585  1        LTL Flag
     C                     MOVEL*BLANK    WN0586  1        Price Audit
     C                     MOVEL*BLANK    WN0587  1        Price Status
     C                     MOVEL*BLANK    WN0588  2        Shipping Method
     C                     MOVEL*BLANK    WN0589  1        Export Status
     C                     MOVEL*BLANK    WN0590  1        Palletize
     C                     MOVEL*BLANK    WN0591  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0592  1        Slip Sheet
     C                     MOVEL*BLANK    WN0593  1        Age Code
     C                     Z-ADD*ZERO     WN0594  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0595  1        Load Type
     C                     Z-ADD*ZERO     WN0596  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0597  1        Load Plan Order
     C                     MOVEL*BLANK    WN0598  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0599  70       Resell Referenc
     C                     MOVEL*BLANK    WN0600 30        Special Comment
     C                     MOVEL*BLANK    WN0601 30        Special Comment
     C                     MOVEL*BLANK    WN0602  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0603  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0604  2        Manager Level C
     C                     MOVEL*BLANK    WN0605  3        VP Level Code
     C                     Z-ADD*ZERO     WN0606  70       Attach to Order
     C                     MOVEL*BLANK    WN0607  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0608  70       Invoice Number
     C                     MOVEL*BLANK    WN0609  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0610  70       Invoice Date
     C                     MOVEL*BLANK    WN0611  2        Event Code
     C                     MOVEL*BLANK    WN0612  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0613  1        Modified Flag
     C                     Z-ADD*ZERO     WN0614 112       A_R order Value
     C                     MOVEL*BLANK    WN0615  1        Billing Activit
     C                     MOVEL*BLANK    WN0616  1        Block Order Fla
     C                     MOVEL*BLANK    WN0617  1        Order Certifica
     C                     Z-ADD*ZERO     WN0618 112       Invoice Order V
     C                     MOVEL*BLANK    WN0619  1        Process Sts for
     C                     MOVEL*BLANK    WN0620  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0621  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0622  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0623  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0624  1        Email Cust On O
     C                     MOVEL*BLANK    WN0625  1        Order Emailed
     C                     MOVEL*BLANK    WN0626  1        Export Docs Go
     C                     MOVEL*BLANK    WN0627  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0628  1        Broker Order St
     C                     MOVEL*BLANK    WN0629  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0630  2        Order Requires
     C                     MOVEL*BLANK    WN0631  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0632  2        Export USDA App
     C                     MOVEL*BLANK    WN0633  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0634  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0635  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0636  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0637  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0638  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0639  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0640  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0641  60       Time of Origina
     C                     Z-ADD*ZERO     WN0642  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0643  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0644  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0645 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0646 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0647 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0648 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0649 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0650  70       Claim Number
     C                     MOVEL*BLANK    WN0651  1        EDI Status 1
     C                     MOVEL*BLANK    WN0652  1        EDI Status 2
     C                     MOVEL*BLANK    WN0653  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0654  60       Job Time
     C                     MOVEL*BLANK    WN0655 10        User Id
     C                     MOVEL*BLANK    WN0656 10        Job Name
     C                     Z-ADD*ZERO     WN0657  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWRAIC3    WSAIC3           Company Number
     C                     Z-ADDWRC4NB    WSC4NB           Order Number
      *
     C           KLCHNQ    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
     C           KLCHNQ    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YERDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     WSR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##PGM     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWSAIC3    PCAIC3           Company Number
     C                     Z-ADDWSC4NB    PCC4NB           Order Number
     C                     MOVELWSJNCD    PCJNCD    P      Order Type_Sale
     C                     Z-ADDWSANC7    PCANC7           AR Customer Num
     C                     Z-ADDWSBKC7    PCBKC7           Ship To Custome
     C                     MOVELWSBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWSHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWSHONA    PCHONA    P      Ship To Address
     C                     MOVELWSHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWSHNNA    PCHNNA    P      Ship To City
     C                     MOVELWSDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWSCKTX    PCCKTX    P      Ship To Zip_Pos
     C                     Z-ADDWSB0C7    PCB0C7           Bill to Custome
     C                     MOVELWSAETX    PCAETX    P      Bill to Name
     C                     MOVELWSB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWSB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWSB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWSB2NA    PCB2NA    P      Bill to City
     C                     MOVELWSBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWSC8TX    PCC8TX    P      Bill to Zip_Pos
     C                     MOVELWSBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWSA0DT    PCA0DT           Order Date
     C                     Z-ADDWSA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWSGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWSACDT    PCACDT           Cancel Date
     C                     MOVELWSAQCD    PCAQCD    P      Terms Code
     C                     MOVELWSB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWSBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWSBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWSGTST    PCGTST    P      Comment Print A
     C                     MOVELWSGVST    PCGVST    P      Comment Print I
     C                     MOVELWSGUST    PCGUST    P      Comment Print P
     C                     MOVELWSQFST    PCQFST    P      Comment Print S
     C                     MOVELWSCQCD    PCCQCD    P      Reason Code
     C                     MOVELWSGJST    PCGJST    P      Order in Use
     C                     MOVELWSGWST    PCGWST    P      Header Status
     C                     MOVELWSGXST    PCGXST    P      Header Status L
     C                     MOVELWSGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWSAODT    PCAODT           Scheduled Ship
     C                     MOVELWSAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWSCXDT    PCCXDT           Date of Origina
     C                     Z-ADDWSJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWSA1WG    PCA1WG           Order Weight To
     C                     MOVELWSXIST    PCXIST    P      Credit Hold
     C                     MOVELWSXJST    PCXJST    P      Production Hold
     C                     MOVELWSXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWSEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWSAFTM    PCAFTM           Requested Deliv
     C                     MOVELWSE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWSE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWSRMNB    PCRMNB           Load ID
     C                     Z-ADDWSTBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWSR1NB    PCR1NB           Rated Freight
     C                     MOVELWSPJST    PCPJST    P      LTL Flag
     C                     MOVELWSU0ST    PCU0ST    P      Price Audit
     C                     MOVELWSU1ST    PCU1ST    P      Price Status
     C                     MOVELWSQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWSU2ST    PCU2ST    P      Export Status
     C                     MOVELWSVEST    PCVEST    P      Palletize
     C                     MOVELWSVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWSVGST    PCVGST    P      Slip Sheet
     C                     MOVELWSRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWSRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWSVDST    PCVDST    P      Load Type
     C                     Z-ADDWSATIN    PCATIN           Attach to Invoi
     C                     MOVELWSU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWSU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWSRSRN    PCRSRN           Resell Referenc
     C                     MOVELWSMHNA    PCMHNA    P      Special Comment
     C                     MOVELWSMINA    PCMINA    P      Special Comment
     C                     MOVELWSWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWSR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWSBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWSQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWST3NB    PCT3NB           Attach to Order
     C                     MOVELWSSICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWSCONB    PCCONB           Invoice Number
     C                     MOVELWSCEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWSAWDT    PCAWDT           Invoice Date
     C                     MOVELWSJPCD    PCJPCD    P      Event Code
     C                     MOVELWSXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWSZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWSVRVA    PCVRVA           A_R order Value
     C                     MOVELWSOBST    PCOBST    P      Billing Activit
     C                     MOVELWSBCST    PCBCST    P      Block Order Fla
     C                     MOVELWSBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWSB7VL    PCB7VL           Invoice Order V
     C                     MOVELWSGASX    PCGASX    P      Process Sts for
     C                     MOVELWSGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWSGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWSGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWSFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWSFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWSFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWSFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWSFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWSFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWSFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWSFUSX    PCFUSX    P      Order Requires
     C                     MOVELWSFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWSFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWSFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWSFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWSNODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWSNPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWSNQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWSNRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWSNSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWSBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWSBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWSBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWSBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWSBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWSH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWSH1NX    PCH1NX           Act Non_Ref Frt
     C                     Z-ADDWSH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWSH3NX    PCH3NX           OH Total Non_Re
     C                     Z-ADDWSH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWSC0C7    PCC0C7           Claim Number
     C                     MOVELWSUVST    PCUVST    P      EDI Status 1
     C                     MOVELWSUWST    PCUWST    P      EDI Status 2
     C                     MOVELWSUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWSAATM    PCAATM           Job Time
     C                     MOVELWSAYNA    PCAYNA    P      User Id
     C                     MOVELWSA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWSAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRRVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0658  30       Order Sequence
     C                     Z-ADD*ZERO     WN0659  30       Order Secondary
     C                     Z-ADD*ZERO     WN0660 112       Rated Freight
     C                     Z-ADD*ZERO     WN0661 112       @Rated Freight
     C                     MOVEL*BLANK    WN0662  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD*ZERO     WN0661           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN0662           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQNR01           Company Number
     C           *LIKE     DEFN WMC4NB    WQNR02           Order Number
      * Define keylist
     C           KRSNR     KLIST
     C                     KFLD           WQNR01           Company Number
     C                     KFLD           WQNR02           Order Number
      * Setup key
     C                     Z-ADDWRAIC3    WQNR01           Company Number
     C                     Z-ADDWRC4NB    WQNR02           Order Number
      * Establish starting position
     C           KRSNR     SETLL@BGWKL1                    *
     C           KRSNR     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WMGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0238           Company Number
     C                     Z-ADDWMC4NB    WL0239           Order Number
     C                     Z-ADDWMDPNB    WL0240           Order Sequence
     C                     Z-ADDWMUENB    WL0241           Order Secondary
     C                     Z-ADD*ZERO     WL0242           Rated Freight
     C                     EXSR NSCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0662           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           WRA1WG    IFEQ 0                          *IF
     C           *ZERO     OREQ 0                          *OR
     C                     Z-ADD*ZERO     WN0660           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           WMGMST    IFEQ 'C'                        *IF
     C           WMGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WMATWG    DIV  WRA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U_M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WMAVQT    MULT WMAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  WRA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT *ZERO     W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN0660    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0238           Company Number
     C                     Z-ADDWMC4NB    WL0239           Order Number
     C                     Z-ADDWMDPNB    WL0240           Order Sequence
     C                     Z-ADDWMUENB    WL0241           Order Secondary
     C                     Z-ADDWN0660    WL0242           Rated Freight
     C                     EXSR NSCHRC
     C                     ADD  WN0660    WN0661           @Rated Freight
     C                     Z-ADDWMDPNB    WN0658           Order Sequence
     C                     Z-ADDWMUENB    WN0659           Order Secondary
     C                     END                             *FI
     C           KRSNR     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0661    IFNE *ZERO                      *IF
     C           WN0662    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           *ZERO     SUB  WN0661    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN0660           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0238           Company Number
     C                     Z-ADDWRC4NB    WL0239           Order Number
     C                     Z-ADDWN0658    WL0240           Order Sequence
     C                     Z-ADDWN0659    WL0241           Order Secondary
     C                     Z-ADDWN0660    WL0242           Rated Freight
     C                     EXSR NSCHRC
     C                     END                             *FI
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0663  70       Item Code
     C                     MOVEL*BLANK    WN0664  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0665  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0666  70       Order Group Cod
     C                     MOVEL*BLANK    WN0667  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0668  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0669 112       Billing Detail
     C                     Z-ADD*ZERO     WN0670 112       Billing Detail
     C                     Z-ADD*ZERO     WN0671 112       Billing Detail
     C                     Z-ADD*ZERO     WN0672 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0673  1        Comment Print A
     C                     MOVEL*BLANK    WN0674  1        Comment Print I
     C                     MOVEL*BLANK    WN0675  1        Comment Print P
     C                     MOVEL*BLANK    WN0676  1        Comment Print S
     C                     Z-ADD*ZERO     WN0677 112       Extended Amount
     C                     Z-ADD*ZERO     WN0678  70       Market Pricing
     C                     MOVEL*BLANK    WN0679  3        Commodity Marke
     C                     MOVEL*BLANK    WN0680  3        Date Method Cod
     C                     MOVEL*BLANK    WN0681  3        Price Method Co
     C                     Z-ADD*ZERO     WN0682 114       Price Overage O
     C                     Z-ADD*ZERO     WN0683  70       Contract Number
     C                     MOVEL*BLANK    WN0684  1        Price Status
     C                     Z-ADD*ZERO     WN0685  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0686  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0687  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0688  1        Work Confirm St
     C                     MOVEL*BLANK    WN0689  1        Work Over_Short
     C                     MOVEL*BLANK    WN0690  1        OD Production P
     C                     MOVEL*BLANK    WN0691 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0692 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0693  1        Age Code
     C                     MOVEL*BLANK    WN0694  1        Palletize
     C                     MOVEL*BLANK    WN0695  1        Slip Sheet
     C                     MOVEL*BLANK    WN0696  1        Catch Weight St
     C                     MOVEL*BLANK    WN0697  1        Price Audit
     C                     MOVEL*BLANK    WN0698  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0699  1        Production Date
     C                     Z-ADD*ZERO     WN0700 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0701 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0702 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0703 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0704 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0705 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0706 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0707 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0708 114       Unit Price
     C                     Z-ADD*ZERO     WN0709 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0710 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0711 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0712 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0713  70       Requested Ship
     C                     Z-ADD*ZERO     WN0714  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0715  70       Actual Shipped
     C                     MOVEL*BLANK    WN0716  1        Affect Inventor
     C                     MOVEL*BLANK    WN0717  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0718  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0719  30       Item Structure
     C                     Z-ADD*ZERO     WN0720  30       Item Structure
     C                     Z-ADD*ZERO     WN0721  30       Item Structure
     C                     MOVEL*BLANK    WN0722  2        Item Level
     C                     MOVEL*BLANK    WN0723  2        Quality Level
     C                     MOVEL*BLANK    WN0724  2        Pricing Product
     C                     MOVEL*BLANK    WN0725  2        Season Product
     C                     Z-ADD*ZERO     WN0726  70       Date of Origina
     C                     MOVEL*BLANK    WN0727 10        User Profile Na
     C                     MOVEL*BLANK    WN0728  6        Country Code
     C                     MOVEL*BLANK    WN0729  2        Event Code
     C                     MOVEL*BLANK    WN0730  3        Reason Code
     C                     MOVEL*BLANK    WN0731  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0732  1        Modified Flag
     C                     MOVEL*BLANK    WN0733  1        Substituted Fla
     C                     MOVEL*BLANK    WN0734  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0735 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0736 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0737  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0738  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0739  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0740  1        Affect Commissi
     C                     MOVEL*BLANK    WN0741  1        Affect Pricing
     C                     MOVEL*BLANK    WN0742  1        Released by Use
     C                     MOVEL*BLANK    WN0743  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0744  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0745  3        Production Ware
     C                     MOVEL*BLANK    WN0746  3        OD Price Type
     C                     Z-ADD*ZERO     WN0747  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0748  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0749  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0750  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0751  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0752  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0753  60       Price Code
     C                     Z-ADD*ZERO     WN0754  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0755  60       Substitution Li
     C                     Z-ADD*ZERO     WN0756  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0757 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0758 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0759 112       OD Item Target
     C                     Z-ADD*ZERO     WN0760 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0761 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0762 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0763 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0764 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0765 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0766 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0767 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0768 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0769 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0770  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0771  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0772  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0773 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0774  40       Item Age Days
     C                     Z-ADD*ZERO     WN0775  70       Production Ovr
     C                     Z-ADD*ZERO     WN0776  70       Production Ovr
     C                     MOVEL*BLANK    WN0777  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0778  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0779  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0780  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0781  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0782  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0783  1        EDI Status 1
     C                     MOVEL*BLANK    WN0784  1        EDI Status 2
     C                     MOVEL*BLANK    WN0785  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0786  60       Job Time
     C                     MOVEL*BLANK    WN0787 10        User Id
     C                     MOVEL*BLANK    WN0788 10        Job Name
     C                     Z-ADD*ZERO     WN0789  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0238    WTAIC3           Company Number
     C                     Z-ADDWL0239    WTC4NB           Order Number
     C                     Z-ADDWL0240    WTDPNB           Order Sequence
     C                     Z-ADDWL0241    WTUENB           Order Secondary
      *
     C           KLCHNS    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTDPNB           Order Sequence
     C                     KFLD           WTUENB           Order Secondary
     C           KLCHNS    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YFRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0242    WTR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##JOB     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * Chg Carrier           RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Function was changed
      *                                    to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQNT02           Load ID
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WQNT02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQNT02           Load ID
      * Establish starting position
     C           KRSNT     SETLL@BFCPD9                    *
     C           KRSNT     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Load Information   CH - Order Header TRG  * 
     C                     EXSR NUCHRC
     C           KRSNT     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NUCHRC    BEGSR
      *================================================================
      * Chg Load Information   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0790  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0791  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0792  70       Ship To Custome
     C                     MOVEL*BLANK    WN0793 30        Ship To Name
     C                     MOVEL*BLANK    WN0794 30        Ship To Address
     C                     MOVEL*BLANK    WN0795 30        Ship To Address
     C                     MOVEL*BLANK    WN0796 30        Ship To Address
     C                     MOVEL*BLANK    WN0797 20        Ship To City
     C                     MOVEL*BLANK    WN0798  2        Ship To State C
     C                     MOVEL*BLANK    WN0799 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0800  70       Bill to Custome
     C                     MOVEL*BLANK    WN0801 30        Bill to Name
     C                     MOVEL*BLANK    WN0802 30        Bill to Address
     C                     MOVEL*BLANK    WN0803 30        Bill to Address
     C                     MOVEL*BLANK    WN0804 30        Bill to Address
     C                     MOVEL*BLANK    WN0805 20        Bill to City
     C                     MOVEL*BLANK    WN0806  2        Bill to State C
     C                     MOVEL*BLANK    WN0807 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0808 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0809  70       Order Date
     C                     Z-ADD*ZERO     WN0810  70       Requested Ship
     C                     Z-ADD*ZERO     WN0811  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0812  70       Cancel Date
     C                     MOVEL*BLANK    WN0813  2        Terms Code
     C                     MOVEL*BLANK    WN0814 40        Special Instruc
     C                     MOVEL*BLANK    WN0815 40        Special Instruc
     C                     MOVEL*BLANK    WN0816  1        Comment Print A
     C                     MOVEL*BLANK    WN0817  1        Comment Print I
     C                     MOVEL*BLANK    WN0818  1        Comment Print P
     C                     MOVEL*BLANK    WN0819  1        Comment Print S
     C                     MOVEL*BLANK    WN0820  3        Reason Code
     C                     MOVEL*BLANK    WN0821  1        Order in Use
     C                     MOVEL*BLANK    WN0822  1        Header Status
     C                     MOVEL*BLANK    WN0823  1        Header Status L
     C                     MOVEL*BLANK    WN0824  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0825  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0826 10        User Original E
     C                     Z-ADD*ZERO     WN0827  70       Date of Origina
     C                     Z-ADD*ZERO     WN0828 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0829 112       Order Weight To
     C                     MOVEL*BLANK    WN0830  1        Credit Hold
     C                     MOVEL*BLANK    WN0831  1        Production Hold
     C                     MOVEL*BLANK    WN0832  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0833  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0834  40       Requested Deliv
     C                     MOVEL*BLANK    WN0835  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0836 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0837  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0838  1        LTL Flag
     C                     MOVEL*BLANK    WN0839  1        Price Audit
     C                     MOVEL*BLANK    WN0840  1        Price Status
     C                     MOVEL*BLANK    WN0841  2        Shipping Method
     C                     MOVEL*BLANK    WN0842  1        Export Status
     C                     MOVEL*BLANK    WN0843  1        Palletize
     C                     MOVEL*BLANK    WN0844  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0845  1        Slip Sheet
     C                     MOVEL*BLANK    WN0846  1        Age Code
     C                     Z-ADD*ZERO     WN0847  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0848  1        Load Type
     C                     Z-ADD*ZERO     WN0849  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0850  1        Load Plan Order
     C                     MOVEL*BLANK    WN0851  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0852  70       Resell Referenc
     C                     MOVEL*BLANK    WN0853 30        Special Comment
     C                     MOVEL*BLANK    WN0854 30        Special Comment
     C                     MOVEL*BLANK    WN0855  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0856  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0857  2        Manager Level C
     C                     MOVEL*BLANK    WN0858  3        VP Level Code
     C                     Z-ADD*ZERO     WN0859  70       Attach to Order
     C                     MOVEL*BLANK    WN0860  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0861  70       Invoice Number
     C                     MOVEL*BLANK    WN0862  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0863  70       Invoice Date
     C                     MOVEL*BLANK    WN0864  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0865  1        Modified Flag
     C                     Z-ADD*ZERO     WN0866 112       A_R order Value
     C                     MOVEL*BLANK    WN0867  1        Billing Activit
     C                     MOVEL*BLANK    WN0868  1        Block Order Fla
     C                     MOVEL*BLANK    WN0869  1        Order Certifica
     C                     Z-ADD*ZERO     WN0870 112       Invoice Order V
     C                     MOVEL*BLANK    WN0871  1        Process Sts for
     C                     MOVEL*BLANK    WN0872  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0873  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0874  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0875  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0876  1        Email Cust On O
     C                     MOVEL*BLANK    WN0877  1        Order Emailed
     C                     MOVEL*BLANK    WN0878  1        Export Docs Go
     C                     MOVEL*BLANK    WN0879  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0880  1        Broker Order St
     C                     MOVEL*BLANK    WN0881  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0882  2        Order Requires
     C                     MOVEL*BLANK    WN0883  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0884  2        Export USDA App
     C                     MOVEL*BLANK    WN0885  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0886  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0887  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0888  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0889  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0890  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0891  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0892  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0893  60       Time of Origina
     C                     Z-ADD*ZERO     WN0894  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0895  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0896  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0897 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0898 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0899 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0900 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0901 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0902  70       Claim Number
     C                     MOVEL*BLANK    WN0903  1        EDI Status 1
     C                     MOVEL*BLANK    WN0904  1        EDI Status 2
     C                     MOVEL*BLANK    WN0905  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0906  60       Job Time
     C                     MOVEL*BLANK    WN0907 10        User Id
     C                     MOVEL*BLANK    WN0908 10        Job Name
     C                     Z-ADD*ZERO     WN0909  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDBEAIC3    WSAIC3           Company Number
     C                     Z-ADDBEC4NB    WSC4NB           Order Number
      *
     C           KLCHNU    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
     C           KLCHNU    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YGRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL#1BZNA    WSBZNA    P      Carrier Code
     C                     Z-ADDBERMNB    WSRMNB           Load ID
     C                     Z-ADDBER1NB    WSR1NB           Rated Freight
     C                     MOVELBEJPCD    WSJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##PGM     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPCRC
     C                     Z-ADDWSAIC3    PCAIC3           Company Number
     C                     Z-ADDWSC4NB    PCC4NB           Order Number
     C                     MOVELWSJNCD    PCJNCD    P      Order Type_Sale
     C                     Z-ADDWSANC7    PCANC7           AR Customer Num
     C                     Z-ADDWSBKC7    PCBKC7           Ship To Custome
     C                     MOVELWSBRTX    PCBRTX    P      Ship To Name
     C                     MOVELWSHMNA    PCHMNA    P      Ship To Address
     C                     MOVELWSHONA    PCHONA    P      Ship To Address
     C                     MOVELWSHPNA    PCHPNA    P      Ship To Address
     C                     MOVELWSHNNA    PCHNNA    P      Ship To City
     C                     MOVELWSDBCD    PCDBCD    P      Ship To State C
     C                     MOVELWSCKTX    PCCKTX    P      Ship To Zip_Pos
     C                     Z-ADDWSB0C7    PCB0C7           Bill to Custome
     C                     MOVELWSAETX    PCAETX    P      Bill to Name
     C                     MOVELWSB1NA    PCB1NA    P      Bill to Address
     C                     MOVELWSB3NA    PCB3NA    P      Bill to Address
     C                     MOVELWSB4NA    PCB4NA    P      Bill to Address
     C                     MOVELWSB2NA    PCB2NA    P      Bill to City
     C                     MOVELWSBHCD    PCBHCD    P      Bill to State C
     C                     MOVELWSC8TX    PCC8TX    P      Bill to Zip_Pos
     C                     MOVELWSBCNA    PCBCNA    P      Customer Purcha
     C                     Z-ADDWSA0DT    PCA0DT           Order Date
     C                     Z-ADDWSA5DT    PCA5DT           Requested Ship
     C                     Z-ADDWSGNDT    PCGNDT           Actual Shipped
     C                     Z-ADDWSACDT    PCACDT           Cancel Date
     C                     MOVELWSAQCD    PCAQCD    P      Terms Code
     C                     MOVELWSB6NA    PCB6NA    P      Special Instruc
     C                     MOVELWSBYNA    PCBYNA    P      Special Instruc
     C                     MOVELWSBZNA    PCBZNA    P      Carrier Code
     C                     MOVELWSGTST    PCGTST    P      Comment Print A
     C                     MOVELWSGVST    PCGVST    P      Comment Print I
     C                     MOVELWSGUST    PCGUST    P      Comment Print P
     C                     MOVELWSQFST    PCQFST    P      Comment Print S
     C                     MOVELWSCQCD    PCCQCD    P      Reason Code
     C                     MOVELWSGJST    PCGJST    P      Order in Use
     C                     MOVELWSGWST    PCGWST    P      Header Status
     C                     MOVELWSGXST    PCGXST    P      Header Status L
     C                     MOVELWSGYST    PCGYST    P      Order Type Prin
     C                     Z-ADDWSAODT    PCAODT           Scheduled Ship
     C                     MOVELWSAIVN    PCAIVN    P      User Original E
     C                     Z-ADDWSCXDT    PCCXDT           Date of Origina
     C                     Z-ADDWSJZVA    PCJZVA           Order Value Tot
     C                     Z-ADDWSA1WG    PCA1WG           Order Weight To
     C                     MOVELWSXIST    PCXIST    P      Credit Hold
     C                     MOVELWSXJST    PCXJST    P      Production Hold
     C                     MOVELWSXKST    PCXKST    P      New Customer Ho
     C                     Z-ADDWSEIDT    PCEIDT           Requested Deliv
     C                     Z-ADDWSAFTM    PCAFTM           Requested Deliv
     C                     MOVELWSE8CD    PCE8CD    P      Accounts Receiv
     C                     MOVELWSE9CD    PCE9CD    P      Accounts Receiv
     C                     Z-ADDWSRMNB    PCRMNB           Load ID
     C                     Z-ADDWSTBNB    PCTBNB           Absorbed Freigh
     C                     Z-ADDWSR1NB    PCR1NB           Rated Freight
     C                     MOVELWSPJST    PCPJST    P      LTL Flag
     C                     MOVELWSU0ST    PCU0ST    P      Price Audit
     C                     MOVELWSU1ST    PCU1ST    P      Price Status
     C                     MOVELWSQ2CD    PCQ2CD    P      Shipping Method
     C                     MOVELWSU2ST    PCU2ST    P      Export Status
     C                     MOVELWSVEST    PCVEST    P      Palletize
     C                     MOVELWSVFST    PCVFST    P      Shrink Wrap
     C                     MOVELWSVGST    PCVGST    P      Slip Sheet
     C                     MOVELWSRPCD    PCRPCD    P      Age Code
     C                     Z-ADDWSRNNB    PCRNNB           Reefer Temperat
     C                     MOVELWSVDST    PCVDST    P      Load Type
     C                     Z-ADDWSATIN    PCATIN           Attach to Invoi
     C                     MOVELWSU4ST    PCU4ST    P      Load Plan Order
     C                     MOVELWSU5ST    PCU5ST    P      Print Pick Slip
     C                     Z-ADDWSRSRN    PCRSRN           Resell Referenc
     C                     MOVELWSMHNA    PCMHNA    P      Special Comment
     C                     MOVELWSMINA    PCMINA    P      Special Comment
     C                     MOVELWSWBST    PCWBST    P      Affect Auto Acc
     C                     MOVELWSR4CD    PCR4CD    P      Sales Route Cod
     C                     MOVELWSBFCD    PCBFCD    P      Manager Level C
     C                     MOVELWSQ4CD    PCQ4CD    P      VP Level Code
     C                     Z-ADDWST3NB    PCT3NB           Attach to Order
     C                     MOVELWSSICD    PCSICD    P      Reason for Pric
     C                     Z-ADDWSCONB    PCCONB           Invoice Number
     C                     MOVELWSCEST    PCCEST    P      Invoice Suffix
     C                     Z-ADDWSAWDT    PCAWDT           Invoice Date
     C                     MOVELWSJPCD    PCJPCD    P      Event Code
     C                     MOVELWSXUST    PCXUST    P      Trans Contol AS
     C                     MOVELWSZ1ST    PCZ1ST    P      Modified Flag
     C                     Z-ADDWSVRVA    PCVRVA           A_R order Value
     C                     MOVELWSOBST    PCOBST    P      Billing Activit
     C                     MOVELWSBCST    PCBCST    P      Block Order Fla
     C                     MOVELWSBDST    PCBDST    P      Order Certifica
     C                     Z-ADDWSB7VL    PCB7VL           Invoice Order V
     C                     MOVELWSGASX    PCGASX    P      Process Sts for
     C                     MOVELWSGBSX    PCGBSX    P      Order Conf Fax
     C                     MOVELWSGCSX    PCGCSX    P      Manifest Fax St
     C                     MOVELWSGDSX    PCGDSX    P      Invoice Fax Sts
     C                     MOVELWSFNSX    PCFNSX    P      Transfer in Sto
     C                     MOVELWSFOSX    PCFOSX    P      Email Cust On O
     C                     MOVELWSFPSX    PCFPSX    P      Order Emailed
     C                     MOVELWSFQSX    PCFQSX    P      Export Docs Go
     C                     MOVELWSFRSX    PCFRSX    P      Shipping Temp C
     C                     MOVELWSFSSX    PCFSSX    P      Broker Order St
     C                     MOVELWSFTSX    PCFTSX    P      Air Freight Ord
     C                     MOVELWSFUSX    PCFUSX    P      Order Requires
     C                     MOVELWSFVSX    PCFVSX    P      OH Load Plan Re
     C                     MOVELWSFWSX    PCFWSX    P      Export USDA App
     C                     MOVELWSFXSX    PCFXSX    P      HPB Ship to War
     C                     MOVELWSFYSX    PCFYSX    P      OH TF Exempt Co
     C                     Z-ADDWSNODT    PCNODT           OH Appt Confirm
     C                     Z-ADDWSNPDT    PCNPDT           JPN Invoice Iss
     C                     Z-ADDWSNQDT    PCNQDT           Load Actual Shi
     C                     Z-ADDWSNRDT    PCNRDT           Load BOL Comple
     C                     Z-ADDWSNSDT    PCNSDT           Load Truck Depa
     C                     Z-ADDWSBPTM    PCBPTM           Maximum Gross W
     C                     Z-ADDWSBQTM    PCBQTM           Time of Origina
     C                     Z-ADDWSBRTM    PCBRTM           OH Appt Confirm
     C                     Z-ADDWSBSTM    PCBSTM           Load BOL Comple
     C                     Z-ADDWSBTTM    PCBTTM           Load Truck Depa
     C                     Z-ADDWSH0NX    PCH0NX           Act Frt Referen
     C                     Z-ADDWSH1NX    PCH1NX           Act Non_Ref Frt
     C                     Z-ADDWSH2NX    PCH2NX           OH Fuel Surchar
     C                     Z-ADDWSH3NX    PCH3NX           OH Total Non_Re
     C                     Z-ADDWSH4NX    PCH4NX           OH Total Ref Fr
     C                     Z-ADDWSC0C7    PCC0C7           Claim Number
     C                     MOVELWSUVST    PCUVST    P      EDI Status 1
     C                     MOVELWSUWST    PCUWST    P      EDI Status 2
     C                     MOVELWSUXST    PCUXST    P      EDI Status 3
     C                     Z-ADDWSAATM    PCAATM           Job Time
     C                     MOVELWSAYNA    PCAYNA    P      User Id
     C                     MOVELWSA0NA    PCA0NA    P      Job Name
     C                     Z-ADDWSAXDT    PCAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVRVGN    BEGSR
      *================================================================
      * RTV SSI Carrier flag   RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNV     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0243    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSNV     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0244           SSI Download Fl
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFUNUS    WL0244           SSI Download Fl
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWRVGN    BEGSR
      *================================================================
      * RTV SSI Fax'd Flag     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNW     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSNW     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXRVGN    BEGSR
      *================================================================
      * RTV Load for Load Plan RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNX     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSNX     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAODT           Scheduled Ship
     C                     MOVEL*BLANK    WN0910           Load Status
     C                     Z-ADD*ZERO     WURNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WN0911           Total Load Orde
     C                     Z-ADD*ZERO     WUFLAM           Flat Amount
     C                     MOVEL*BLANK    WUXQST           Allocate Pounds
     C                     MOVEL*BLANK    WN0912           Carrier Code
     C                     MOVEL*BLANK    WN0913           Truck Size
     C                     Z-ADD*ZERO     WUR1NB           Rated Freight
     C                     MOVEL*BLANK    WUVDST           Load Type
     C                     Z-ADD*ZERO     WUT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WUTLMI           Total Load Mile
     C                     MOVEL*BLANK    WN0914           Shipping Method
     C                     MOVEL*BLANK    WUVPCD           Ship From Wareh
     C                     MOVEL*BLANK    WUDBCD           Ship To State C
     C                     MOVEL*BLANK    WUXCCD           Carrier Broker
     C                     MOVEL*BLANK    WN0915           Load Acceptance
     C                     Z-ADD*ZERO     WUK2DT           Override Total
     C                     MOVEL*BLANK    WUWRTX           Shipping Temp C
     C                     GOTO NXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WUAODT           Scheduled Ship
     C                     MOVELFJPKST    WN0910           Load Status
     C                     Z-ADDFJRNNB    WURNNB           Reefer Temperat
     C                     Z-ADDFJRPNB    WN0911           Total Load Orde
     C                     Z-ADDFJFLAM    WUFLAM           Flat Amount
     C                     MOVELFJXQST    WUXQST           Allocate Pounds
     C                     MOVELFJBZNA    WN0912           Carrier Code
     C                     MOVELFJRONB    WN0913           Truck Size
     C                     Z-ADDFJR1NB    WUR1NB           Rated Freight
     C                     MOVELFJVDST    WUVDST           Load Type
     C                     Z-ADDFJT4NB    WUT4NB           Schedule Sequen
     C                     Z-ADDFJTLMI    WUTLMI           Total Load Mile
     C                     MOVELFJQ2CD    WN0914           Shipping Method
     C                     MOVELFJVPCD    WUVPCD           Ship From Wareh
     C                     MOVELFJDBCD    WUDBCD           Ship To State C
     C                     MOVELFJXCCD    WUXCCD           Carrier Broker
     C                     MOVELFJRMST    WN0915           Load Acceptance
     C                     Z-ADDFJK2DT    WUK2DT           Override Total
     C                     MOVELFJWRTX    WUWRTX           Shipping Temp C
     C                     ENDIF
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYRVGN    BEGSR
      *================================================================
      * RTV Any Order Picked   RT - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0967  1        Header Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0045           USR Status (Y/N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLRMNB    WQNY01           Load ID
      * Define keylist
     C           KPSNY     KLIST
     C                     KFLD           WQNY01           Load ID
     C                     KFLD           WLRUNB           Stop_Drop Seque
      * Define keylist
     C           KRSNY     KLIST
     C                     KFLD           WQNY01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQNY01           Load ID
     C                     Z-ADD*ZERO     WLRUNB           Stop_Drop Seque
      * Establish starting position
     C           KPSNY     SETLL@FLCPBW                    *
     C           KRSNY     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Assume no orders picked, unless find one that is
      * RTV Check Pick Event   RT - OP Order Events  * 
     C                     EXSR NZRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       YL0045           USR Status (Y/N
     C                     GOTO NYEXIT                     *QUIT
     C                     END                             *FI
     C           KRSNY     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZRVGN    BEGSR
      *================================================================
      * RTV Check Pick Event   RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQNZ01           Company Number
     C           *LIKE     DEFN EYC4NB    WQNZ02           Order Number
     C           *LIKE     DEFN EYJPCD    WQNZ03           Event Code
      * Define keylist
     C           KRSNZ     KLIST
     C                     KFLD           WQNZ01           Company Number
     C                     KFLD           WQNZ02           Order Number
     C                     KFLD           WQNZ03           Event Code
      * Setup key
     C                     Z-ADDWLAIC3    WQNZ01           Company Number
     C                     Z-ADDWLC4NB    WQNZ02           Order Number
     C                     MOVEL'03'      WQNZ03           Event Code
      * Establish starting position
     C           KRSNZ     SETLL@EYCPZE                    *
     C           KRSNZ     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO NZEXIT                     *QUIT
     C           KRSNZ     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OARVGN    BEGSR
      *================================================================
      * RTV/Chg Mex Carr - All RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQOA01           Load ID
      * Define keylist
     C           KRSOA     KLIST
     C                     KFLD           WQOA01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQOA01           Load ID
      * Establish starting position
     C           KRSOA     SETLL@AMREJM                    *
     C           KRSOA     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO OAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Mexican Carrier    CH - Order Header Extension  * 
     C                     EXSR OBCHRC
     C           KRSOA     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBCHRC    BEGSR
      *================================================================
      * CHG Mexican Carrier    CH - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0969  70       Load ID
     C                     Z-ADD*ZERO     WN0970  50       Stop_Drop Seque
     C                     MOVEL*BLANK    WN0971  3        Shipping Line
     C                     MOVEL*BLANK    WN0972 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0973 25        OHE City
     C                     MOVEL*BLANK    WN0974 30        OHE Vessel_Airl
     C                     MOVEL*BLANK    WN0975 15        OHE Voyage_Flig
     C                     MOVEL*BLANK    WN0976 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0977 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0978  70       OHE Sail_Flight
     C                     Z-ADD*ZERO     WN0979  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0980  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0981  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0982  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0983 12        OHE Container N
     C                     MOVEL*BLANK    WN0984 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0985 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0986 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0987 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0988 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0989 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0990 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0991 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0992 112       Transload Termi
     C                     Z-ADD*ZERO     WN0993  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0994  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0995  70       OHE Port_Pier P
     C                     Z-ADD*ZERO     WN0996  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0997  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0998  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0999  2        OHE Override Ty
     C                     MOVEL*BLANK    WN1000  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN1001  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN1002  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN1003  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN1004  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN1005  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN1006  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN1007  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN1008 38        Delivery P_O  N
     C                     MOVEL*BLANK    WN1009  6        OHE Intended fo
     C                     MOVEL*BLANK    WN1010  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN1011  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN1012  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN1013  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN1014  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN1015  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN1016 10        OHE Transload S
     C                     MOVEL*BLANK    WN1017 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN1018 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN1019 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN1020 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN1021 15        OHE Transload C
     C                     MOVEL*BLANK    WN1022 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN1023 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN1024 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN1025 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN1026 50        Letter of Credi
     C                     Z-ADD*ZERO     WN1027  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN1028  30       LD Stop_Drop
     C                     Z-ADD*ZERO     WN1029  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN1030  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN1031  52       OHE Port Check
     C                     Z-ADD*ZERO     WN1032  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN1033  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN1034  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN1035  60       Original Appoin
     C                     Z-ADD*ZERO     WN1036  60       Original Appoin
     C                     Z-ADD*ZERO     WN1037  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN1038  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN1039  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN1040  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN1041 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN1042  1        OHE Email BOL_S
     C                     MOVEL*BLANK    WN1043  1        OHE EDI Order A
     C                     MOVEL*BLANK    WN1044  2        OHE EDI 601 Act
     C                     MOVEL*BLANK    WN1045  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN1046  5        OHE Unused Text
     C                     MOVEL*BLANK    WN1047  5        OHE Unused Text
     C                     MOVEL*BLANK    WN1048 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN1049 15        OHE EDI 824 AES
     C                     MOVEL*BLANK    WN1050 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN1051  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN1052  70       OHE Unused Date
     C                     MOVEL*BLANK    WN1053  1        EDI Status 1
     C                     MOVEL*BLANK    WN1054  1        EDI Status 2
     C                     MOVEL*BLANK    WN1055  1        EDI Status 3
     C                     MOVEL*BLANK    WN1056  1        Record Status
     C                     Z-ADD*ZERO     WN1057  60       Job Time
     C                     MOVEL*BLANK    WN1058 10        User Id
     C                     MOVEL*BLANK    WN1059 10        Job Name
     C                     Z-ADD*ZERO     WN1060  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDAMAIC3    WVAIC3           Company Number
     C                     Z-ADDAMC4NB    WVC4NB           Order Number
      *
     C           KLCHOB    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C           KLCHOB    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YHRDCS
      * Move non-key fields to @AMREJE
     C                     MOVEL#DC2TX    WVC2TX    P      OHE Carrier SCA
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     Z-ADD##JDT     WVAXDT           Job Date
     C                     MOVEL##PGM     WVA0NA           Job Name
     C                     MOVEL##USR     WVAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCCHRC    BEGSR
      *================================================================
      * CHG Load for Trailer   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1068  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1069 15        Seal 4
     C                     MOVEL*BLANK    WN1070 15        Seal 2 Unused
     C                     MOVEL*BLANK    WN1071 15        Load Held Over
     C                     Z-ADD*ZERO     WN1072  70       Product Complet
     C                     Z-ADD*ZERO     WN1073  60       Product Complet
     C                     Z-ADD*ZERO     WN1074  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN1075  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN1076  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN1077  1        Load Confirmed
     C                     MOVEL*BLANK    WN1078 25        Load Confirmed
     C                     Z-ADD*ZERO     WN1079  70       Load Confirmati
     C                     Z-ADD*ZERO     WN1080  60       Load Door 1
     C                     Z-ADD*ZERO     WN1081  70       Override Total
     C                     Z-ADD*ZERO     WN1082  60       Load Door 2
     C                     MOVEL*BLANK    WN1083  1        Partial Load
     C                     MOVEL*BLANK    WN1084  1        Load Confirmati
     C                     MOVEL*BLANK    WN1085  1        Export Load USD
     C                     MOVEL*BLANK    WN1086  1        Late Delivery E
     C                     Z-ADD*ZERO     WN1087 112       Load Actual Fre
     C                     MOVEL*BLANK    WN1088 15        Hide on WW Load
     C                     MOVEL*BLANK    WN1089 15        Late Billing Em
     C                     MOVEL*BLANK    WN1090 25        Shipping Temp C
     C                     MOVEL*BLANK    WN1091 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN1092  1        Multi Company L
     C                     MOVEL*BLANK    WN1093  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN1094  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN1095  1        MG Created Load
     C                     MOVEL*BLANK    WN1096  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN1097  2        Load U_M
     C                     MOVEL*BLANK    WN1098  2        TPM Shipment St
     C                     MOVEL*BLANK    WN1099  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN1100  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN1101  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1102  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN1103  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN1104  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN1105  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN1106  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1107  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1108  60       LH Unused Time
     C                     Z-ADD*ZERO     WN1109  70       LH Unused Date
     C                     Z-ADD*ZERO     WN1110  60       LH Unused Time
     C                     MOVEL*BLANK    WN1111  1        EDI Status 1
     C                     MOVEL*BLANK    WN1112  1        EDI Status 2
     C                     MOVEL*BLANK    WN1113  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1114  60       Job Time
     C                     MOVEL*BLANK    WN1115 10        User Id
     C                     MOVEL*BLANK    WN1116 10        Job Name
     C                     Z-ADD*ZERO     WN1117  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * ***** Change Log and Comments
     C                     EXSR UMSUBR                     ***** Change Lo
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      *
     C           KLCHOC    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHOC    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YIRDCS
      * USER: Processing after Data read
      * If Trailer, sched seq changes: Write TMS Load trigger
      * CASE:
      *  - c3AND(c1ORc2)
      *   |- c3    : DB1.MG Created Load is Yes
      *   |- c1    : PAR.Trailer Id NE DB1.Trailer Id
      *   |- c2    : PAR.Schedule Sequence Number NE DB1.Schedule Sequenc
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           FJRYSX    IFEQ 'Y'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #DS2TX    IFNE FJDXTX                     *IF
     C           #1T4NB    ORNE FJT4NB                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Trailer Id NE DB1.Trailer Id
     C           #DS2TX    IFNE FJDXTX                     *IF
     C                     MOVEL'ASNTRL'  YL0048           Load Change Typ
     C                     END                             *FI
      * CASE: PAR.Schedule Sequence Number NE DB1.Schedule Sequence Numbe
     C           #1T4NB    IFNE FJT4NB                     *IF
      * CASE: LCL.Load Change Type EQ WRK.Blank for 12          USR
     C           YL0048    IFEQ WUS3TX                     *IF
     C                     MOVEL'SCHSEQ'  YL0048           Load Change Typ
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SCHSEQ'  YL0049           Load Change Typ
     C                     END                             *FI
     C                     END                             *FI
      * Exc Crt TMS Load Trg  XF - TMS Load Trigger  * 
     C                     CALL 'PBXOXFR'              90  Exc Crt TMS Loa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##JDT     WQ0153  70       Job Date
     C                     PARM ##JTM     WQ0154  60       Job Time
     C                     PARM FJRMNB    WQ0155  70       Load ID
     C                     PARM #1AIC3    WQ0156  30       TMS LH Load Str
     C                     PARM YL0050    WQ0157 35        TMS LH Field Ch
     C                     PARM 'A'       WQ0158  1        TMS Record Stat
     C                     PARM *ZERO     WQ0159  30       TMS Process Sta
     C                     PARM *BLANK    WQ0160  6        TMS Error Reaso
     C                     PARM *ZERO     WQ0161  80       TMS Change Date
     C                     PARM *ZERO     WQ0162  60       TMS Change time
     C                     PARM YL0048    WQ0163  6        Load Change Typ
     C                     PARM YL0049    WQ0164  6        Load Change Typ
     C                     PARM YL0051    WQ0165  6        Load Change Typ
     C                     PARM YL0052    WQ0166  6        Load Change Typ
     C                     PARM YL0053    WQ0167  6        Load Change Typ
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#1AIC3    FJAIC3           Company Number
     C                     MOVEL#1PJST    FJPJST    P      LTL Flag
     C                     MOVELP1PKST    FJPKST    P      Load Status
     C                     Z-ADD#1RNNB    FJRNNB           Reefer Temperat
     C                     MOVEL#1DMTX    FJDMTX    P      Seal 1
     C                     MOVEL#1DNTX    FJDNTX    P      Seal 2
     C                     MOVEL#1DOTX    FJDOTX    P      Seal 3
     C                     Z-ADD#1RPNB    FJRPNB           Total Load Orde
     C                     Z-ADD#1FLAM    FJFLAM           Flat Amount
     C                     MOVEL#1XQST    FJXQST    P      Allocate Pounds
     C                     Z-ADD#1RRNB    FJRRNB           Total Stops
     C                     MOVEL#DS2TX    FJDXTX    P      Trailer Id
     C                     MOVEL#1DYTX    FJDYTX    P      Transloader Car
     C                     Z-ADD#1SBNB    FJSBNB           BOL Time
     C                     MOVEL#1BZNA    FJBZNA    P      Carrier Code
     C                     MOVEL#1RONB    FJRONB    P      Truck Size
     C                     Z-ADD#1SQNB    FJSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD#1R1NB    FJR1NB           Rated Freight
     C                     MOVEL#1VCST    FJVCST    P      Ship Status
     C                     MOVEL#1VDST    FJVDST    P      Load Type
     C                     Z-ADD#1SDNB    FJSDNB           Number Pallets
     C                     Z-ADD#1PAOU    FJPAOU           Number Pallets
     C                     Z-ADD#1DGWG    FJDGWG           Load Carrier Pa
     C                     Z-ADD#1SXNB    FJSXNB           Estimated Arriv
     C                     Z-ADD#1HADT    FJHADT           Actual Arrival
     C                     Z-ADD#1AART    FJAART           Actual Arrival
     C                     Z-ADD#1DHWG    FJDHWG           Trailer IN Weig
     C                     Z-ADD#1DIWG    FJDIWG           Trailer OUT Wei
     C                     Z-ADD#1AQDT    FJAQDT           Actual Departur
     C                     Z-ADD#1S6NB    FJS6NB           Departure Time
     C                     Z-ADD#1T4NB    FJT4NB           Schedule Sequen
     C                     Z-ADD#1PRTM    FJPRTM           Product Tempera
     C                     Z-ADD#1NPSV    FJNPSV           Number Spacers
     C                     MOVEL#1J8TX    FJJ8TX    P      Car_Veh_Initial
     C                     Z-ADDYL0004    FJTLMI           Total Load Mile
     C                     MOVEL#1J9TX    FJJ9TX    P      Recorder ID
     C                     MOVEL#1Q2CD    FJQ2CD    P      Shipping Method
     C                     MOVEL#1VPCD    FJVPCD    P      Ship From Wareh
     C                     MOVEL#1DBCD    FJDBCD    P      Ship To State C
     C                     Z-ADD#1GRWE    FJGRWE           Gross Weight
     C                     MOVEL#1XCCD    FJXCCD    P      Carrier Broker
     C                     MOVEL#1U2ST    FJU2ST    P      Export Status
     C                     Z-ADD#1F9DT    FJF9DT           Actual Ship Dat
     C                     MOVEL#1ONTM    FJONTM    P      On Time_Y_N
     C                     Z-ADD#1J4DT    FJJ4DT           Truck Ready Dat
     C                     Z-ADD#1TRTM    FJTRTM           Truck Ready Tim
     C                     Z-ADD#1J5DT    FJJ5DT           Spotted Date
     C                     Z-ADD#1SPTM    FJSPTM           Spotted Time
     C                     Z-ADD#1J6DT    FJJ6DT           Load Finished D
     C                     Z-ADD#1LFTM    FJLFTM           Load Finished T
     C                     Z-ADD#1J7DT    FJJ7DT           BOL Complete Da
     C                     Z-ADD#1BOTM    FJBOTM           BOL Complete Ti
     C                     Z-ADD#1J8DT    FJJ8DT           BOL Received Da
     C                     Z-ADD#1BLTM    FJBLTM           BOL Received Ti
     C                     Z-ADD#1KIDT    FJKIDT           Truck Departure
     C                     Z-ADD#1ASTM    FJASTM           Truck Departure
     C                     Z-ADD#1KADT    FJKADT           Adjusted Depart
     C                     Z-ADD#1AJCM    FJAJCM           Adjusted Depart
     C                     MOVEL#DEZTX    FJXACD    P      Shipping Line
     C                     MOVEL#1OANA    FJOANA    P      Port Delv Termi
     C                     MOVEL#1K4TX    FJK4TX    P      Vessel Name
     C                     Z-ADD#1VOAG    FJVOAG           Voyage
     C                     Z-ADD#1KBDT    FJKBDT           Sail Date
     C                     MOVEL#1NBBO    FJNBBO    P      Booking Number
     C                     MOVEL#1W4CD    FJW4CD    P      Discharge Port
     C                     Z-ADD#1EFDT    FJEFDT           Arrival Date
     C                     MOVELYL0047    FJCNTN    P      Container Numbe
     C                     Z-ADD#1KCDT    FJKCDT           Date In
     C                     Z-ADD#1TMIN    FJTMIN           Time In
     C                     Z-ADD#1KDDT    FJKDDT           Date Out
     C                     Z-ADD#1VMNB    FJVMNB           Time Out
     C                     Z-ADD#1OCFR    FJOCFR           Load Total Frei
     C                     Z-ADD#1KJDT    FJKJDT           Scheduled Deliv
     C                     Z-ADD#1ATTM    FJATTM           Scheduled Deliv
     C                     MOVEL#1OTRS    FJOTRS    P      LH Unused Sts
     C                     MOVEL#1RNST    FJRNST    P      LH Carrier Paym
     C                     Z-ADD#1BRBK    FJBRBK           Bring Back Mile
     C                     Z-ADDYL0046    FJEIDT           Requested Deliv
     C                     MOVEL#1RMST    FJRMST    P      Load Acceptance
     C                     MOVEL#1AJCD    FJAJCD    P      Warehouse Code
     C                     Z-ADD#1KKDT    FJKKDT           On Yard Date
     C                     Z-ADD#1AVTM    FJAVTM           On Yard Time
     C                     Z-ADDWN1065    FJKZDT           Deadline Depart
     C                     Z-ADDWN1066    FJAXTM           Deadline Depart
     C                     MOVEL#1LHOS    FJLHOS    P      Load Held Over
     C                     MOVEL#1LHOR    FJLHOR    P      Load Held Over
     C                     MOVEL#1OITX    FJOITX    P      Ocean BOL Numbe
     C                     MOVEL#1OJTX    FJOJTX    P      Express Mail Nu
     C                     Z-ADD#1LLDT    FJLLDT           Express Mail Da
     C                     MOVEL#1LSHG    FJLSHG    P      Load Shag Flag
     C                     MOVEL#1YPST    FJYPST    P      Load Wash Flag
     C                     MOVEL#1RXSX    FJRXSX    P      LH Power Only L
     C                     MOVEL#1R3SX    FJR3SX    P      LH On-Time Reas
     C                     Z-ADD#1P0DT    FJP0DT           LPT Load Plan S
     C                     Z-ADD#1CMTM    FJCMTM           LPT Load Plan S
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) FJAATM' defaulted for 'Job Time'.
      * Field '(DB1) FJAYNA' defaulted for 'User Id'.
      * Field '(DB1) FJA0NA' defaulted for 'Job Name'.
      * Field '(DB1) FJAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##JOB     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODCRRC    BEGSR
      *================================================================
      * Crt PD Trailer         CR - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LYRER2
     C                     MOVELWL0245    WWBZNA           Carrier Code
     C                     MOVELWL0246    WWDXTX           Trailer Id
     C                     Z-ADDWL0247    WWAIC3           Company Number
     C                     MOVELWL0248    WWVDST           Load Type
     C                     MOVELWL0249    WWX3ST           Trailer Type
     C                     MOVELWL0250    WWXGST           Seaboard Owned
     C                     MOVELWL0251    WWSTOY           On Yard Status
     C                     Z-ADDWL0252    WWKKDT           On Yard Date
     C                     Z-ADDWL0253    WWAVTM           On Yard Time
     C                     MOVELWL0254    WWSTAS           Assigned Status
     C                     MOVELWL0255    WWXRST           Available Statu
     C                     MOVELWL0256    WWX7CD           Not Available R
     C                     MOVELWL0257    WWGXTX           Comment Line
     C                     MOVELWL0258    WWXTST           Status Unused 1
     C                     MOVELWL0259    WWXVST           Status Unused 2
     C                     MOVELWL0260    WWSTU3           Status Unused 3
     C                     MOVELWL0261    WWSTU4           Status Unused 4
     C                     MOVELWL0262    WWSTU5           Status Unused 5
     C                     Z-ADDWL0263    WWLCDT           Date Unused 1
     C                     Z-ADDWL0264    WWLDDT           Date Unused 2
     C                     Z-ADDWL0265    WWLEDT           Date Unused 3
     C                     Z-ADDWL0266    WWLFDT           Date Unused 4
     C                     Z-ADDWL0267    WWLGDT           Date Unused 5
     C                     MOVELWL0268    WWUVST           EDI Status 1
     C                     MOVELWL0269    WWUWST           EDI Status 2
     C                     MOVELWL0270    WWUXST           EDI Status 3
     C                     MOVELWL0271    WWVSST           Record Status
     C                     Z-ADDWL0272    WWAATM           Job Time
     C                     MOVELWL0273    WWAYNA           User Id
     C                     MOVELWL0274    WWA0NA           Job Name
     C                     Z-ADDWL0275    WWAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WWVSST           Record Status
     C                     Z-ADD##JTM     WWAATM           Job Time
     C                     MOVEL##USR     WWAYNA           User Id
     C                     MOVEL##PGM     WWA0NA           Job Name
     C                     Z-ADD##JDT     WWAXDT           Job Date
     C           KLCROD    KLIST
     C                     KFLD           WWBZNA           Carrier Code
     C                     KFLD           WWDXTX           Trailer Id
      * Check for duplicate primary key
     C           KLCROD    SETLL@LYRER2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2599' W0RTN   7
      * Send message 'Trailer Master         EX'
     C                     MOVEL'USR2599' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO ODEXIT
     C                     ENDIF
      *
     C                     WRITE@LYRER2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OECHRC    BEGSR
      *================================================================
      * Chg PD Trailer         CH - Trailer  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @LYRER2
     C                     MOVELWL0276    WWBZNA    P      Carrier Code
     C                     MOVELWL0277    WWDXTX    P      Trailer Id
      *
     C           KLCHOE    KLIST
     C                     KFLD           WWBZNA           Carrier Code
     C                     KFLD           WWDXTX           Trailer Id
     C           KLCHOE    CHAIN@LYRER2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLYREL0'MDACP
     C                     MOVEL'@LYRER2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDLY1    YJRDCS
      * Move non-key fields to @LYRER2
     C                     Z-ADDWL0278    WWAIC3           Company Number
     C                     MOVELWL0279    WWVDST    P      Load Type
     C                     MOVELWL0280    WWX3ST    P      Trailer Type
     C                     MOVELWL0281    WWXGST    P      Seaboard Owned
     C                     MOVELWL0282    WWSTOY    P      On Yard Status
     C                     Z-ADDWL0283    WWKKDT           On Yard Date
     C                     Z-ADDWL0284    WWAVTM           On Yard Time
     C                     MOVELWL0285    WWSTAS    P      Assigned Status
     C                     MOVELWL0286    WWXRST    P      Available Statu
     C                     MOVELWL0287    WWX7CD    P      Not Available R
     C                     MOVELWL0288    WWGXTX    P      Comment Line
     C                     MOVELWL0289    WWXTST    P      Status Unused 1
     C                     MOVELWL0290    WWXVST    P      Status Unused 2
     C                     MOVELWL0291    WWSTU3    P      Status Unused 3
     C                     MOVELWL0292    WWSTU4    P      Status Unused 4
     C                     MOVELWL0293    WWSTU5    P      Status Unused 5
     C                     Z-ADDWL0294    WWLCDT           Date Unused 1
     C                     Z-ADDWL0295    WWLDDT           Date Unused 2
     C                     Z-ADDWL0296    WWLEDT           Date Unused 3
     C                     Z-ADDWL0297    WWLFDT           Date Unused 4
     C                     Z-ADDWL0298    WWLGDT           Date Unused 5
     C                     MOVELWL0299    WWUVST    P      EDI Status 1
     C                     MOVELWL0300    WWUWST    P      EDI Status 2
     C                     MOVELWL0301    WWUXST    P      EDI Status 3
     C                     MOVELWL0302    WWVSST    P      Record Status
     C                     Z-ADDWL0303    WWAATM           Job Time
     C                     MOVELWL0304    WWAYNA    P      User Id
     C                     MOVELWL0305    WWA0NA    P      Job Name
     C                     Z-ADDWL0306    WWAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WWAATM           Job Time
     C                     MOVEL##USR     WWAYNA           User Id
     C                     MOVEL##PGM     WWA0NA           Job Name
     C                     Z-ADD##JDT     WWAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDLY1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@LYRER2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDLYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFRVGN    BEGSR
      *================================================================
      * RTV/Chg Container     RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOF     KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WXAIC3           Company Number
     C                     Z-ADDYL0062    WXC4NB           Order Number
      * Establish starting position
     C           KRSOF     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO OFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG OHE Container Nbr  CH - Order Header Extension  * 
     C                     EXSR OGCHRC
     C                     ENDIF
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGCHRC    BEGSR
      *================================================================
      * CHG OHE Container Nbr  CH - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1126  50       Stop_Drop Seque
     C                     MOVEL*BLANK    WN1127  3        Shipping Line
     C                     MOVEL*BLANK    WN1128 20        Port Delv Termi
     C                     MOVEL*BLANK    WN1129 25        OHE City
     C                     MOVEL*BLANK    WN1130 30        OHE Vessel_Airl
     C                     MOVEL*BLANK    WN1131 15        OHE Voyage_Flig
     C                     MOVEL*BLANK    WN1132 15        OHE Booking Num
     C                     MOVEL*BLANK    WN1133 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN1134  70       OHE Sail_Flight
     C                     Z-ADD*ZERO     WN1135  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN1136  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN1137  3        OHE Late Delive
     C                     MOVEL*BLANK    WN1138  1        OHE Ship Status
     C                     MOVEL*BLANK    WN1139 35        OHE Comment 1
     C                     MOVEL*BLANK    WN1140 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN1141 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN1142 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN1143 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN1144 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN1145 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN1146 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN1147 112       Transload Termi
     C                     Z-ADD*ZERO     WN1148  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN1149  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN1150  70       OHE Port_Pier P
     C                     Z-ADD*ZERO     WN1151  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN1152  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN1153  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN1154  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN1155  2        OHE Override Ty
     C                     MOVEL*BLANK    WN1156  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN1157  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN1158  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN1159  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN1160  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN1161  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN1162  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN1163  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN1164 38        Delivery P_O  N
     C                     MOVEL*BLANK    WN1165  6        OHE Intended fo
     C                     MOVEL*BLANK    WN1166  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN1167  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN1168  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN1169  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN1170  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN1171  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN1172 10        OHE Transload S
     C                     MOVEL*BLANK    WN1173 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN1174 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN1175 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN1176 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN1177 15        OHE Transload C
     C                     MOVEL*BLANK    WN1178 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN1179 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN1180 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN1181 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN1182 50        Letter of Credi
     C                     Z-ADD*ZERO     WN1183  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN1184  30       LD Stop_Drop
     C                     Z-ADD*ZERO     WN1185  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN1186  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN1187  52       OHE Port Check
     C                     Z-ADD*ZERO     WN1188  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN1189  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN1190  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN1191  60       Original Appoin
     C                     Z-ADD*ZERO     WN1192  60       Original Appoin
     C                     Z-ADD*ZERO     WN1193  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN1194  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN1195  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN1196  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN1197 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN1198  1        OHE Email BOL_S
     C                     MOVEL*BLANK    WN1199  1        OHE EDI Order A
     C                     MOVEL*BLANK    WN1200  2        OHE EDI 601 Act
     C                     MOVEL*BLANK    WN1201  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN1202  5        OHE Unused Text
     C                     MOVEL*BLANK    WN1203  5        OHE Unused Text
     C                     MOVEL*BLANK    WN1204 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN1205 15        OHE EDI 824 AES
     C                     MOVEL*BLANK    WN1206 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN1207  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN1208  70       OHE Unused Date
     C                     MOVEL*BLANK    WN1209  1        EDI Status 1
     C                     MOVEL*BLANK    WN1210  1        EDI Status 2
     C                     MOVEL*BLANK    WN1211  1        EDI Status 3
     C                     MOVEL*BLANK    WN1212  1        Record Status
     C                     Z-ADD*ZERO     WN1213  60       Job Time
     C                     MOVEL*BLANK    WN1214 10        User Id
     C                     MOVEL*BLANK    WN1215 10        Job Name
     C                     Z-ADD*ZERO     WN1216  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWXAIC3    WVAIC3           Company Number
     C                     Z-ADDWXC4NB    WVC4NB           Order Number
      *
     C           KLCHOG    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C           KLCHOG    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YKRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWXRMNB    WVRMNB           Load ID
     C                     MOVELYL0055    WVJ2T1    P      OHE Container N
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     Z-ADD##JDT     WVAXDT           Job Date
     C                     MOVEL##PGM     WVA0NA           Job Name
     C                     MOVEL##USR     WVAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQOH01           Application Cod
      * Define keylist
     C           KRSOH     KLIST
     C                     KFLD           WQOH01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQOH01           Application Cod
     C                     MOVEL'OMS'     WQOH01           Application Cod
      * Establish starting position
     C           KRSOH     SETLL@DNRESF                    *
     C           KRSOH     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR OIRVGN
     C                     END                             *FI
     C           KRSOH     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OIRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQOI01           Application Cod
      * Define keylist
     C           KRSOI     KLIST
     C                     KFLD           WQOI01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQOI01           Application Cod
      * Establish starting position
     C           KRSOI     SETLL@DNRESF                    *
     C           KRSOI     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO OIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSOI     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         OJRVGN    BEGSR
      *================================================================
      * Rtv User Profile Info RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOJ     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSOJ     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0063           Allow Multi_Com
     C                     GOTO OJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    YL0063           Allow Multi_Com
     C                     ENDIF
      *================================================================
     CSR         OJEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0001    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSA     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     MOVEL*BLANK    WL0003           Record Status
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0002           Name
     C                     MOVELFFVSST    WL0003           Record Status
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Truck Size Desc.   RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVELWL0004    FKRONB           Truck Size
      * Establish starting position
     C           KRSSB     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Truck Size Desc
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFKDPTX    WL0005           Truck Size Desc
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1VPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    #DF8NA           Warehouse Descr
     C                     MOVELADXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Active Description RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ACBGCD           State Code
      * Setup key
     C                     MOVELWL0006    ACBGCD           State Code
      * Establish starting position
     C           KRSSD     CHAIN@ACRET7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0007           Description
     C                     MOVEL*BLANK    WL0008           Record Status
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAUNA    WL0007           Description
     C                     MOVELACVSST    WL0008           Record Status
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0009    ABAIC3           Company Number
      * Establish starting position
     C           KRSSE     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Name
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0010           Name
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELFJVPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    #DF8NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0012           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WL0013           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSG02           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Load ID
      * Setup key
     C                     Z-ADDWL0011    WQSG02           Load ID
      * Establish starting position
     C           KRSSG     SETLL@BFCPD9                    *
     C           KRSSG     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0012           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           BEBCST    IFEQ 'B'                        *IF
     C                     MOVELBEBCST    WL0013           Block Order Fla
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSH02           Load ID
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH02           Load ID
      * Setup key
     C                     Z-ADDWL0014    WQSH02           Load ID
      * Establish starting position
     C           KRSSH     SETLL@FLCPE8                    *
     C           KRSSH     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR SIRVGN
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WAAIC3           Company Number
     C                     Z-ADDFLC4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSI     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWABKC7    WL0015           Ship To Custome
     C                     MOVELWABRTX    WL0016           Ship To Name
     C                     MOVELWAHMNA    WL0017           Ship To Address
     C                     MOVELWAHONA    WL0018           Ship To Address
     C                     MOVELWAHPNA    WL0019           Ship To Address
     C                     MOVELWAHNNA    WL0020           Ship To City
     C                     MOVELWADBCD    WL0021           Ship To State C
     C                     MOVELWACKTX    WL0022           Ship To Zip_Pos
     C                     MOVELWABCNA    WUG0TX           Customer Purcha
     C                     MOVELWAB6NA    WUG0TX           Special Instruc
     C                     MOVELWABYNA    WUG0TX           Special Instruc
     C                     Z-ADDWAEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWAAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV State Description  RT - State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WBBGCD           State Code
      * Setup key
     C                     MOVELWL0023    WBBGCD           State Code
      * Establish starting position
     C           KRSSJ     CHAIN@ACREAH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0005' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0024           Description
     C                     MOVEL*BLANK    WL0025           Record Status
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAUNA    WL0024           Description
     C                     MOVELWBVSST    WL0025           Record Status
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Shipping Line-OHE  RT - Order Header Extension  * P000737
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AMRMNB    WQSK01           Load ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSK01           Load ID
      * Establish starting position
     C           KRSSK     SETLL@AMREJM                    *
     C           KRSSK     READE@AMREJM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DEZTX           Shipping Line
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** pass back the first record found with a shipping line
      * CASE: DB1.Shipping Line is not entered
     C           AMXACD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELAMXACD    #DEZTX           Shipping Line
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@AMREJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Country Code/WHS  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSL02           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
      * Setup key
     C                     Z-ADDWL0026    WQSL02           Load ID
      * Establish starting position
     C           KRSSL     SETLL@BFCPRQ                    *
     C           KRSSL     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Whse/Country   RT - Order Detail  * 
     C                     EXSR SMRVGN
     C           KRSSL     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV 1st Whse/Country   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSM01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSM01           Company Number
     C                     Z-ADDWCC4NB    WQSM02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSM     SETLL@BGWKAE                    *
     C           KRSSM     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WL0027           Warehouse Code
     C                     MOVELOMKXCD    WL0028           Country Code
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0029    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0030           Warehouse Type
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDWPST    WL0030           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Country EXT       RT - Country EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           HAKXCD           Country Code
      * Setup key
     C                     MOVELWL0031    HAKXCD           Country Code
      * Establish starting position
     C           KRSSO     CHAIN@HAREKV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4430' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0032           Country Power O
     C                     MOVEL*BLANK    WL0033           ISO Alpha2 Code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELHANAST    WL0032           Country Power O
     C                     MOVELHAX2AA    WL0033           ISO Alpha2 Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Plant Co Status   RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           JYAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0034    JYAIC3           Company Number
      * Establish starting position
     C           KRSSP     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0035           Plant Company S
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJYYISX    WL0035           Plant Company S
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Val Carrier Active     RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WEBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0036    WEBZNA           Carrier Code
      * Establish starting position
     C           KRSSQ     CHAIN@FFREUG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0037    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSR     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0038           Allow Multi_Com
     C                     MOVELDRMPNA    WL0039           Default Printer
     C                     MOVELDRBCCD    WL0040           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0041           Company Number
     C                     MOVELDRBUVN    WL0042           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0043    DTAJVN           User Profile Na
     C                     MOVELWL0044    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSS     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0045           Company Number
     C                     MOVELDTAJCD    WL0046           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFBWC3    WQST01           Shipping Compan
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Shipping Compan
      * Setup key
     C                     Z-ADDWL0048    WQST01           Shipping Compan
      * Establish starting position
     C           KRSST     SETLL@ADREWA                    *
     C           KRSST     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0047           Warehouse Code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WFVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WFAOCD    IFNE *BLANK                     *IF
     C                     MOVELWFAOCD    WL0047           Warehouse Code
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSST     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0050           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSU02           Load ID
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU02           Load ID
      * Setup key
     C                     Z-ADDWL0049    WQSU02           Load ID
      * Establish starting position
     C           KRSSU     SETLL@FLCPEB                    *
     C           KRSSU     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           WGRVNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       WL0050           Status - Y or N
     C                     GOTO SUEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSU     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0051           Order in Use
     C                     MOVEL*BLANK    WL0052           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSV02           Load ID
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV02           Load ID
      * Setup key
     C                     Z-ADDWL0053    WQSV02           Load ID
      * Establish starting position
     C           KRSSV     SETLL@BFCPD9                    *
     C           KRSSV     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           BEGWST    IFEQ 'H'                        *IF
     C                     MOVELBEGWST    WL0052           Header Status
     C                     GOTO SVEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           BEGWST    IFEQ 'X'                        *IF
     C                     MOVELBEGWST    WL0052           Header Status
     C                     GOTO SVEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           BEGJST    IFEQ 'Y'                        *IF
     C                     MOVELBEGJST    WL0051           Order in Use
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSV     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSW02           Load ID
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW02           Load ID
      * Setup key
     C                     Z-ADDWL0054    WQSW02           Load ID
      * Establish starting position
     C           KRSSW     SETLL@BFCPD9                    *
     C           KRSSW     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0055           Order Requires
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEFUSX    WL0055           Order Requires
     C           KRSSW     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVELWL0056    FKRONB           Truck Size
      * Establish starting position
     C           KRSSX     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0057           Maximum pounds
     C                     Z-ADD*ZERO     WL0058           Minimum pounds
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    WL0057           Maximum pounds
     C                     Z-ADDFKTANB    WL0058           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Unlock Load Authr RT - Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVEL##USR     C0AJVN           User Profile Na
     C                     MOVE *BLANK    C0DNCD           Application Cod
     C                     MOVEL'O/P'     C0DNCD           Application Cod
     C                     Z-ADD#1AIC3    C0AIC3           Company Number
      * Establish starting position
     C           KRSSY     CHAIN@C0REO4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0527' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUHTST           Unlock Load Aut
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0HTST    WUHTST           Unlock Load Aut
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKZGNX    WQSZ01           PFS Load ID
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           PFS Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSZ01           PFS Load ID
      * Establish starting position
     C           KRSSZ     SETLL@BKCPEK                    *
     C           KRSSZ     READE@BKCPEK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3504' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUZMST           Pick Status USR
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUZMST           Pick Status USR
     C                     GOTO SZEXIT                     *QUIT
     C           KRSSZ     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTA02           Load ID
      * Define keylist
     C           KPSTA     KLIST
     C                     KFLD           WQTA02           Load ID
     C                     KFLD           WGRVNB           Stop_Drop
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA02           Load ID
      * Setup key
     C                     Z-ADDWL0059    WQTA02           Load ID
     C                     Z-ADDWL0060    WGRVNB           Stop_Drop
      * Establish starting position
     C           KPSTA     SETLL@FLCPEB                    *
     C           KRSTA     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR TBRVGN
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTB02           Order Number
      * Define keylist
     C           KPSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
      * Setup key
     C                     Z-ADDWGAIC3    WQTB01           Company Number
     C                     Z-ADDWGC4NB    WQTB02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSTB     SETLL@BGWKAE                    *
     C           KRSTB     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0061           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR TCRVGN
      * PAR = DB1 By name
     C                     MOVELOMAJCD    WL0061           Warehouse Code
     C                     GOTO TBEXIT                     *QUIT
     C           KRSTB     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSTC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Actv Descr, Ctrl   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1VPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTD     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    #DF8NA           Warehouse Descr
     C                     MOVELADXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Ship To City/St-Ld RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQTE02           Load ID
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE02           Load ID
      * Setup key
     C                     Z-ADDWL0062    WQTE02           Load ID
      * Establish starting position
     C           KRSTE     SETLL@BFCPD9                    *
     C           KRSTE     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEHNNA    WL0063           Ship To City
     C                     MOVELBEDBCD    WL0064           Ship To State C
     C                     GOTO TEEXIT                     *QUIT
     C           KRSTE     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           LEBZNA           Carrier Code
     C                     KFLD           LEAJCD           Warehouse Code
     C                     KFLD           LEXECD           Destination Cit
     C                     KFLD           LEBGCD           State Code
      * Setup key
     C                     MOVELWL0065    LEBZNA           Carrier Code
     C                     MOVELWL0066    LEAJCD           Warehouse Code
     C                     MOVELWL0067    LEXECD           Destination Cit
     C                     MOVELWL0068    LEBGCD           State Code
      * Establish starting position
     C           KRSTF     CHAIN@LECPM7              90    *
      * Data record not found
     C   90                MOVEL'USR2455' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * only pass out FLAT amt.  (it could now be a ML rate too)  01/03/0
      * CASE: DB1.CDR Unit of Measure is Flat
     C           LEAVTX    IFEQ 'FL'                       *IF
      * PAR = DB1 By name
     C                     Z-ADDLENMVA    WL0069           Flat Rate
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Val Ins Existance     RT - Carrier Insurance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CKBZNA    WQTG01           Carrier Code
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Carrier Code
      * Setup key
     C                     MOVELWL0070    WQTG01           Carrier Code
      * Establish starting position
     C           KRSTG     SETLL@CKREPL                    *
     C           KRSTG     READE@CKREPL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3202' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0071           Record Found US
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0071           Record Found US
     C                     GOTO TGEXIT                     *QUIT
     C           KRSTG     READE@CKREPL                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Val Insurance Expire  RT - Carrier Insurance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0075           Error Flag
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           CKBZNA           Carrier Code
     C                     KFLD           CKENAA           Insurance Type
      * Setup key
     C                     MOVELWL0072    CKBZNA           Carrier Code
     C                     MOVELWL0073    CKENAA           Insurance Type
      * Establish starting position
     C           KRSTH     CHAIN@CKREPL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3202' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0075           Error Flag
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * VAL:  Insurance Expiration
      * CASE: PAR.Scheduled Ship Date USR is Entered
     C           WL0074    IFNE 0                          *IF
      * CASE: DB1.CI Date of Expiration LT PAR.Scheduled Ship Date USR
     C           CKO9DT    IFLT WL0074                     *IF
      * Rtv Insurance Desc    RT - Insurance Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELCKENAA    WL0076    P      Insurance Type
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0019    P      Insurance Type
      * Setup message data for message
      * Convert CI Date of Expiration to display format
      * Convert date
     C           1000000   ADD  CKO9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0039
     C                     MOVELCKBZNA    ZA0040           Carrier Code
     C                     MOVELYL0019    ZA0041           Insurance Type
      * Send message 'Insurance Expired ERR'
     C                     MOVEL'USR3204' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       WL0075           Error Flag
     C                     GOTO THEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Add 14 days to scheduled ship date to go 2 weeks out
      * LCL.Scheduled Ship Date USR = PAR.Scheduled Ship Date USR + CON.1
     C           WL0074    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD14        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0020
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0020
     C                     END
      * CASE: DB1.CI Date of Expiration LE LCL.Scheduled Ship Date USR
     C           CKO9DT    IFLE YL0020                     *IF
      * Rtv Insurance Desc    RT - Insurance Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELCKENAA    WL0076    P      Insurance Type
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0019    P      Insurance Type
      * Setup message data for message
      * Convert CI Date of Expiration to display format
      * Convert date
     C           1000000   ADD  CKO9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0042
     C                     MOVELCKBZNA    ZA0043           Carrier Code
     C                     MOVELYL0019    ZA0044           Insurance Type
      * Send message 'Insurance Expiration WRN'
     C                     MOVEL'USR3205' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Insurance Desc    RT - Insurance Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           CJENAA           Insurance Type
      * Setup key
     C                     MOVELWL0076    CJENAA           Insurance Type
      * Establish starting position
     C           KRSTI     CHAIN@CJREPI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3200' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0077           Insurance Type
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELCJP4NA    WL0077           Insurance Type
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Load Dollar Amount RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQTJ02           Load ID
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ02           Load ID
      * Setup key
     C                     Z-ADDWL0078    WQTJ02           Load ID
      * Establish starting position
     C           KRSTJ     SETLL@BFCPD9                    *
     C           KRSTJ     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Header Status is Not closed or cancelled
     C           BEGWST    IFEQ 'L'                        *IF
     C           BEGWST    OREQ 'A'
     C           BEGWST    OREQ 'R'
     C           BEGWST    OREQ 'E'
     C           BEGWST    OREQ 'H'
     C                     ADD  BEJZVA    WL0079           USR Total Order
     C                     END                             *FI
     C           KRSTJ     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Val Cargo Insurance    RT - Carrier Insurance  *      E00230
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0083           Error Flag
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           CKBZNA           Carrier Code
     C                     KFLD           CKENAA           Insurance Type
      * Setup key
     C                     MOVELWL0080    CKBZNA           Carrier Code
     C                     MOVELWL0081    CKENAA           Insurance Type
      * Establish starting position
     C           KRSTK     CHAIN@CKREPL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3202' W0RTN   7
      * USER: Processing if Data record not found
      * Setup message data for message
     C                     MOVELWL0080    ZA0045           Carrier Code
      * Send message 'No Cargo Ins Certificate'
     C                     MOVEL'USR3867' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     MOVEL'Y'       WL0083           Error Flag
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Insurance Type Code is Cargo
     C           CKENAA    IFEQ 'CARGO'                    *IF
      * VAL:  Liability Limit
      * CASE: PAR.USR Total Order Value GT DB1.CI Liability Amount
     C           WL0084    IFGT CKTRNX                     *IF
      * Rtv Insurance Desc    RT - Insurance Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELCKENAA    WL0076    P      Insurance Type
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0021    P      Insurance Type
      * Setup message data for message
     C                     Z-ADDCKTRNX    ZA0046           CI Liability Am
     C                     MOVELCKBZNA    ZA0047           Carrier Code
     C                     MOVELYL0021    ZA0048           Insurance Type
      * Send message 'Insurance Amt LT Value'
     C                     MOVEL'USR3206' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       WL0083           Error Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Val Ins Expire/Warning RT - Carrier Insurance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0088           Error Flag
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           CKBZNA           Carrier Code
     C                     KFLD           CKENAA           Insurance Type
      * Setup key
     C                     MOVELWL0085    CKBZNA           Carrier Code
     C                     MOVELWL0086    CKENAA           Insurance Type
      * Establish starting position
     C           KRSTL     CHAIN@CKREPL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3202' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0088           Error Flag
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * VAL:  Insurance Expiration
      * CASE: PAR.Scheduled Ship Date USR is Entered
     C           WL0087    IFNE 0                          *IF
      * CASE: DB1.CI Date of Expiration LT PAR.Scheduled Ship Date USR
     C           CKO9DT    IFLT WL0087                     *IF
      * Rtv Insurance Desc    RT - Insurance Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELCKENAA    WL0076    P      Insurance Type
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0022    P      Insurance Type
      * Setup message data for message
      * Convert CI Date of Expiration to display format
      * Convert date
     C           1000000   ADD  CKO9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0049
     C                     MOVELCKBZNA    ZA0050           Carrier Code
     C                     MOVELYL0022    ZA0051           Insurance Type
      * Send message 'Insurance Expired    WRN'
     C                     MOVEL'USR4049' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     GOTO TLEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Add 14 days to scheduled ship date to go 2 weeks out
      * LCL.Scheduled Ship Date USR = PAR.Scheduled Ship Date USR + CON.1
     C           WL0087    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD14        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0023
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0023
     C                     END
      * CASE: DB1.CI Date of Expiration LE LCL.Scheduled Ship Date USR
     C           CKO9DT    IFLE YL0023                     *IF
      * Rtv Insurance Desc    RT - Insurance Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELCKENAA    WL0076    P      Insurance Type
     C                     EXSR TIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0077    YL0022    P      Insurance Type
      * Setup message data for message
      * Convert CI Date of Expiration to display format
      * Convert date
     C           1000000   ADD  CKO9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0052
     C                     MOVELCKBZNA    ZA0053           Carrier Code
     C                     MOVELYL0022    ZA0054           Insurance Type
      * Send message 'Insurance Expiration WRN'
     C                     MOVEL'USR3205' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1XCCD    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSTM     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    #DADTX           Name
     C                     MOVELFFVSST    WUVSST           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Trailer            RT - Trailer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           LYBZNA           Carrier Code
     C                     KFLD           LYDXTX           Trailer Id
      * Setup key
     C                     MOVELWL0089    LYBZNA           Carrier Code
     C                     MOVELWL0090    LYDXTX           Trailer Id
      * Establish starting position
     C           KRSTN     CHAIN@LYRER3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2598' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0091           Company Number
     C                     MOVEL*BLANK    WL0092           Load Type
     C                     MOVEL*BLANK    WL0093           Trailer Type
     C                     MOVEL*BLANK    WL0094           Seaboard Owned
     C                     MOVEL*BLANK    WL0095           On Yard Status
     C                     Z-ADD*ZERO     WL0096           On Yard Date
     C                     Z-ADD*ZERO     WL0097           On Yard Time
     C                     MOVEL*BLANK    WL0098           Assigned Status
     C                     MOVEL*BLANK    WL0099           Available Statu
     C                     MOVEL*BLANK    WL0100           Not Available R
     C                     MOVEL*BLANK    WL0101           Comment Line
     C                     MOVEL*BLANK    WL0102           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLYAIC3    WL0091           Company Number
     C                     MOVELLYVDST    WL0092           Load Type
     C                     MOVELLYX3ST    WL0093           Trailer Type
     C                     MOVELLYXGST    WL0094           Seaboard Owned
     C                     MOVELLYSTOY    WL0095           On Yard Status
     C                     Z-ADDLYKKDT    WL0096           On Yard Date
     C                     Z-ADDLYAVTM    WL0097           On Yard Time
     C                     MOVELLYSTAS    WL0098           Assigned Status
     C                     MOVELLYXRST    WL0099           Available Statu
     C                     MOVELLYX7CD    WL0100           Not Available R
     C                     MOVELLYGXTX    WL0101           Comment Line
     C                     MOVELLYVSST    WL0102           Record Status
     C                     GOTO TNEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * VAL Trailer assignmnt RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Changes and comments
     C                     EXSR UDSUBR                     ***** Changes a
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHDXTX    WQTO01           Trailer Id
     C           *LIKE     DEFN WHBZNA    WQTO02           Carrier Code
      * Define keylist
     C           KPSTO     KLIST
     C                     KFLD           WQTO01           Trailer Id
     C                     KFLD           WQTO02           Carrier Code
     C                     KFLD           WHRMNB           Load ID
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           Trailer Id
     C                     KFLD           WQTO02           Carrier Code
      * Setup key
     C                     MOVELYL0010    WQTO01           Trailer Id
     C                     MOVELYL0009    WQTO02           Carrier Code
     C                     Z-ADD*ZERO     WHRMNB           Load ID
      * Establish starting position
     C           KPSTO     SETLL@FJCPMJ                    *
     C           KRSTO     READE@FJCPMJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'TRLRAVL' W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Load ID NE PAR.Load Id 2
     C           WHRMNB    IFNE #1RMNB                     *IF
      * CASE: DB1.Load Status is Prior to Shipped
     C           WHPKST    IFEQ 'C'                        *IF
     C           WHPKST    OREQ 'E'
     C           WHPKST    OREQ 'L'
     C           WHPKST    OREQ 'U'
     C                     MOVEL'TRLRASN' W0RTN            *Return code
      * PAR.USR Load ID = DB1.Load ID
     C                     Z-ADDWHRMNB    YL0027           USR Load ID
     C                     GOTO TOEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTO     READE@FJCPMJ                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * VAL ShpLin/Cntnr-dup   RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0028           Load Status New
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIXACD    WQTP01           Shipping Line
     C           *LIKE     DEFN WIJ2T1    WQTP02           OHE Container N
      * Define keylist
     C           KPSTP     KLIST
     C                     KFLD           WQTP01           Shipping Line
     C                     KFLD           WQTP02           OHE Container N
     C                     KFLD           WIRMNB           Load ID
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           Shipping Line
     C                     KFLD           WQTP02           OHE Container N
      * Setup key
     C                     MOVELYL0009    WQTP01           Shipping Line
     C                     MOVEL#DS2TX    WQTP02           OHE Container N
     C                     Z-ADDYL0026    WIRMNB           Load ID
      * Establish starting position
     C           KPSTP     SETLL@AMREU0                    *
     C           KRSTP     READE@AMREU0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Comments
     C                     EXSR UESUBR                     ** Comments
      * CASE: DB1.Load ID NE PAR.Load Id 1
     C           WIRMNB    IFNE #1RMNB                     *IF
      * RTV Load Status        RT - Load Header  * 
     C                     EXSR TQRVGN
      * CASE: LCL.Load Status is Entered,Comb,Unlck,Locked
     C           YL0029    IFEQ 'C'                        *IF
     C           YL0029    OREQ 'E'
     C           YL0029    OREQ 'L'
     C           YL0029    OREQ 'U'
     C                     MOVEL'TRLRASN' W0RTN            *Return code
     C                     Z-ADDWIRMNB    YL0027           Load Id 2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C           KRSTP     READE@AMREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWIRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTQ     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0029           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELFJPKST    YL0029           Load Status
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * RTV Load ID for Trailr RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WUZJST           USR Active Load
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJBZNA    WQTR01           Carrier Code
     C           *LIKE     DEFN WJDXTX    WQTR02           Trailer Id
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Carrier Code
     C                     KFLD           WQTR02           Trailer Id
      * Setup key
     C                     MOVELYL0009    WQTR01           Carrier Code
     C                     MOVEL#DS2TX    WQTR02           Trailer Id
      * Establish starting position
     C           KRSTR     SETLL@FJCPR4                    *
     C           KRSTR     READE@FJCPR4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAIC3           Company Number
     C                     MOVEL*BLANK    WUZJST           USR Active Load
     C                     Z-ADD*ZERO     WUL1LD           USR Load Assign
     C                     MOVEL'N'       WUZJST           USR Active Load
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Truck Departure Date is not entered
     C           WJKIDT    IFEQ 0                          *IF
      * Active load
      * If Load is not the Load currently being edited.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Load ID NE PAR.Load ID
      *   |- c2    : DB1.Load Status is Entered,Comb,Unlck,Locked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WJRMNB    IFNE #1RMNB                     *IF
     C           WJPKST    IFEQ 'C'                        *IF
     C           WJPKST    OREQ 'E'
     C           WJPKST    OREQ 'L'
     C           WJPKST    OREQ 'U'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUZJST           USR Active Load
     C                     Z-ADDWJRMNB    WUL1LD           USR Load Assign
     C                     Z-ADDWJAIC3    WUAIC3           Company Number
     C                     GOTO TREXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * NOT Active load
     C                     END                             *FI
     C           KRSTR     READE@FJCPR4                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * VAL Load Start Co      RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       P9B8ST           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTS02           Load ID
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTS02           Load ID
      * Establish starting position
     C           KRSTS     SETLL@FLCPEB                    *
     C           KRSTS     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y'       P9B8ST           Status - Y or N
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If at least one company matching the par, then quit.
      * CASE: DB1.Company Number EQ PAR.Company Number
     C           WGAIC3    IFEQ #1AIC3                     *IF
     C                     MOVEL'Y'       P9B8ST           Status - Y or N
     C                     GOTO TSEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTS     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV Load Header All,Mg RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0103    FJRMNB           Load ID
      * Establish starting position
     C           KRSTT     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WL0104           Scheduled Ship
     C                     MOVELFJPJST    WL0105           LTL Flag
     C                     MOVELFJPKST    WL0106           Load Status
     C                     Z-ADDFJRNNB    WL0107           Reefer Temperat
     C                     MOVELFJDMTX    WL0108           Seal 1
     C                     MOVELFJDNTX    WL0109           Seal 2
     C                     MOVELFJDOTX    WL0110           Seal 3
     C                     Z-ADDFJRPNB    WL0111           Total Load Orde
     C                     Z-ADDFJFLAM    WL0112           Flat Amount
     C                     MOVELFJXQST    WL0113           Allocate Pounds
     C                     Z-ADDFJRRNB    WL0114           Total Stops
     C                     MOVELFJDXTX    WL0115           Trailer Id
     C                     MOVELFJDYTX    WL0116           Transloader Car
     C                     Z-ADDFJSBNB    WL0117           BOL Time
     C                     MOVELFJBZNA    WL0118           Carrier Code
     C                     MOVELFJRONB    WL0119           Truck Size
     C                     Z-ADDFJSQNB    WL0120           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    WL0121           Rated Freight
     C                     MOVELFJVCST    WL0122           Ship Status
     C                     MOVELFJVDST    WL0123           Load Type
     C                     Z-ADDFJSDNB    WL0124           Number Pallets
     C                     Z-ADDFJPAOU    WL0125           Number Pallets
     C                     Z-ADDFJDGWG    WL0126           Load Carrier Pa
     C                     Z-ADDFJSXNB    WL0127           Estimated Arriv
     C                     Z-ADDFJHADT    WL0128           Actual Arrival
     C                     Z-ADDFJAART    WL0129           Actual Arrival
     C                     Z-ADDFJDHWG    WL0130           Trailer IN Weig
     C                     Z-ADDFJDIWG    WL0131           Trailer OUT Wei
     C                     Z-ADDFJAQDT    WL0132           Actual Departur
     C                     Z-ADDFJS6NB    WL0133           Departure Time
     C                     Z-ADDFJT4NB    WL0134           Schedule Sequen
     C                     Z-ADDFJPRTM    WL0135           Product Tempera
     C                     Z-ADDFJNPSV    WL0136           Number Spacers
     C                     MOVELFJJ8TX    WL0137           Car_Veh_Initial
     C                     Z-ADDFJTLMI    WL0138           Total Load Mile
     C                     MOVELFJJ9TX    WL0139           Recorder ID
     C                     MOVELFJQ2CD    WL0140           Shipping Method
     C                     MOVELFJVPCD    WL0141           Ship From Wareh
     C                     MOVELFJDBCD    WL0142           Ship To State C
     C                     Z-ADDFJGRWE    WL0143           Gross Weight
     C                     MOVELFJXCCD    WL0144           Carrier Broker
     C                     MOVELFJU2ST    WL0145           Export Status
     C                     Z-ADDFJF9DT    WL0146           Actual Ship Dat
     C                     MOVELFJONTM    WL0147           On Time_Y_N
     C                     Z-ADDFJJ4DT    WL0148           Truck Ready Dat
     C                     Z-ADDFJTRTM    WL0149           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WL0150           Spotted Date
     C                     Z-ADDFJSPTM    WL0151           Spotted Time
     C                     Z-ADDFJJ6DT    WL0152           Load Finished D
     C                     Z-ADDFJLFTM    WL0153           Load Finished T
     C                     Z-ADDFJJ7DT    WL0154           BOL Complete Da
     C                     Z-ADDFJBOTM    WL0155           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WL0156           BOL Received Da
     C                     Z-ADDFJBLTM    WL0157           BOL Received Ti
     C                     Z-ADDFJKIDT    WL0158           Truck Departure
     C                     Z-ADDFJASTM    WL0159           Truck Departure
     C                     Z-ADDFJKADT    WL0160           Adjusted Depart
     C                     Z-ADDFJAJCM    WL0161           Adjusted Depart
     C                     MOVELFJXACD    WL0162           Shipping Line
     C                     MOVELFJOANA    WL0163           Port Delv Termi
     C                     MOVELFJK4TX    WL0164           Vessel Name
     C                     Z-ADDFJVOAG    WL0165           Voyage
     C                     Z-ADDFJKBDT    WL0166           Sail Date
     C                     MOVELFJNBBO    WL0167           Booking Number
     C                     MOVELFJW4CD    WL0168           Discharge Port
     C                     Z-ADDFJEFDT    WL0169           Arrival Date
     C                     MOVELFJCNTN    WL0170           Container Numbe
     C                     Z-ADDFJKCDT    WL0171           Date In
     C                     Z-ADDFJTMIN    WL0172           Time In
     C                     Z-ADDFJKDDT    WL0173           Date Out
     C                     Z-ADDFJVMNB    WL0174           Time Out
     C                     Z-ADDFJOCFR    WL0175           Load Total Frei
     C                     Z-ADDFJKJDT    WL0176           Scheduled Deliv
     C                     Z-ADDFJATTM    WL0177           Scheduled Deliv
     C                     MOVELFJOTRS    WL0178           LH Unused Sts
     C                     Z-ADDFJKKDT    WL0179           On Yard Date
     C                     Z-ADDFJAVTM    WL0180           On Yard Time
     C                     Z-ADDFJKZDT    WL0181           Deadline Depart
     C                     Z-ADDFJAXTM    WL0182           Deadline Depart
     C                     MOVELFJRYSX    WL0183           MG Created Load
     C                     GOTO TTEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0044  70       Total Load Mile
     C                     MOVEL*BLANK    WN0045  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0046  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0047  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0184    FJRMNB           Load ID
      * Establish starting position
     C           KRSTU     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFJRMNB    WL0059           Load ID
     C                     Z-ADD1         WL0060           Stop_Drop
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0061    WN0045    P      Warehouse Code
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           FJAJCD    IFEQ WN0045                     *IF
     C                     MOVEL*BLANK    WN0046           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELFJAJCD    WN0046           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           FJRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDFJTLMI    WN0044           Total Load Mile
     C                     Z-ADDFJK2DT    WN0047           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADDFJRMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WN0044    PARM WN0044    WQ0030  70       Total Load Mile
     C           WN0047    PARM WN0047    WQ0031  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR TVCHRC
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0048  30       Company Number
     C                     Z-ADD*ZERO     WN0049  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0050  1        LTL Flag
     C                     MOVEL*BLANK    WN0051  1        Load Status
     C                     Z-ADD*ZERO     WN0052  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0053 15        Seal 1
     C                     MOVEL*BLANK    WN0054 15        Seal 2
     C                     MOVEL*BLANK    WN0055 15        Seal 3
     C                     MOVEL*BLANK    WN0056 15        Seal 4
     C                     MOVEL*BLANK    WN0057 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0058  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0059 112       Flat Amount
     C                     MOVEL*BLANK    WN0060  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0061  50       Total Stops
     C                     MOVEL*BLANK    WN0062 20        Trailer Id
     C                     MOVEL*BLANK    WN0063  3        Transloader Car
     C                     Z-ADD*ZERO     WN0064  40       BOL Time
     C                     MOVEL*BLANK    WN0065  3        Carrier Code
     C                     MOVEL*BLANK    WN0066  7        Truck Size
     C                     Z-ADD*ZERO     WN0067  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0068 112       Rated Freight
     C                     MOVEL*BLANK    WN0069  1        Ship Status
     C                     MOVEL*BLANK    WN0070  1        Load Type
     C                     Z-ADD*ZERO     WN0071  50       Number Pallets
     C                     Z-ADD*ZERO     WN0072  50       Number Pallets
     C                     Z-ADD*ZERO     WN0073 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0074  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0075  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0076  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0077 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0078 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0079  70       Actual Departur
     C                     Z-ADD*ZERO     WN0080  40       Departure Time
     C                     Z-ADD*ZERO     WN0081  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0082  52       Product Tempera
     C                     Z-ADD*ZERO     WN0083  50       Number Spacers
     C                     MOVEL*BLANK    WN0084 12        Car_Veh_Initial
     C                     MOVEL*BLANK    WN0085 12        Recorder ID
     C                     MOVEL*BLANK    WN0086  2        Shipping Method
     C                     MOVEL*BLANK    WN0087  2        Ship To State C
     C                     Z-ADD*ZERO     WN0088  70       Gross Weight
     C                     MOVEL*BLANK    WN0089  3        Carrier Broker
     C                     MOVEL*BLANK    WN0090  1        Export Status
     C                     Z-ADD*ZERO     WN0091  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0092  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0093  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0094  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0095  70       Spotted Date
     C                     Z-ADD*ZERO     WN0096  60       Spotted Time
     C                     Z-ADD*ZERO     WN0097  70       Load Finished D
     C                     Z-ADD*ZERO     WN0098  60       Load Finished T
     C                     Z-ADD*ZERO     WN0099  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0100  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0101  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0102  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0103  70       Truck Departure
     C                     Z-ADD*ZERO     WN0104  60       Truck Departure
     C                     Z-ADD*ZERO     WN0105  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0106  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0107  3        Shipping Line
     C                     MOVEL*BLANK    WN0108 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0109 30        Vessel Name
     C                     Z-ADD*ZERO     WN0110  50       Voyage
     C                     Z-ADD*ZERO     WN0111  70       Sail Date
     C                     MOVEL*BLANK    WN0112 12        Booking Number
     C                     MOVEL*BLANK    WN0113 20        Discharge Port
     C                     Z-ADD*ZERO     WN0114  70       Arrival Date
     C                     MOVEL*BLANK    WN0115 12        Container Numbe
     C                     Z-ADD*ZERO     WN0116  70       Date In
     C                     Z-ADD*ZERO     WN0117  60       Time In
     C                     Z-ADD*ZERO     WN0118  70       Date Out
     C                     Z-ADD*ZERO     WN0119  60       Time Out
     C                     Z-ADD*ZERO     WN0120 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0121  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0122  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0123  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0124  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0125  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0126  70       Requested Deliv
     C                     MOVEL*BLANK    WN0127  1        Load Acceptance
     C                     Z-ADD*ZERO     WN0128  70       On Yard Date
     C                     Z-ADD*ZERO     WN0129  60       On Yard Time
     C                     Z-ADD*ZERO     WN0130  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0131  60       Deadline Depart
     C                     MOVEL*BLANK    WN0132  1        Load Held Over
     C                     MOVEL*BLANK    WN0133  1        Load Held Over
     C                     MOVEL*BLANK    WN0134 15        Load Held Over
     C                     MOVEL*BLANK    WN0135 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0136 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0137  70       Express Mail Da
     C                     MOVEL*BLANK    WN0138  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0139  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0140  70       Product Complet
     C                     Z-ADD*ZERO     WN0141  60       Product Complet
     C                     Z-ADD*ZERO     WN0142  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0143  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0144  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0145  1        Load Confirmed
     C                     MOVEL*BLANK    WN0146 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0147  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0148  60       Load Door 1
     C                     Z-ADD*ZERO     WN0149  60       Load Door 2
     C                     MOVEL*BLANK    WN0150  1        Partial Load
     C                     MOVEL*BLANK    WN0151  1        Load Confirmati
     C                     MOVEL*BLANK    WN0152  1        Export Load USD
     C                     MOVEL*BLANK    WN0153  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0154 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0155 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0156 15        Late Billing Em
     C                     MOVEL*BLANK    WN0157 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0158 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0159  1        Multi Company L
     C                     MOVEL*BLANK    WN0160  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0161  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0162  1        LH Power Only L
     C                     MOVEL*BLANK    WN0163  1        MG Created Load
     C                     MOVEL*BLANK    WN0164  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0165  2        Load U_M
     C                     MOVEL*BLANK    WN0166  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0167  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0168  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0169  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0170  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0171  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0172  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0173  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0174  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0175  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0176  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0177  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0178  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0179  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0180  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0181  60       LH Unused Time
     C                     MOVEL*BLANK    WN0182  1        EDI Status 1
     C                     MOVEL*BLANK    WN0183  1        EDI Status 2
     C                     MOVEL*BLANK    WN0184  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0185  60       Job Time
     C                     MOVEL*BLANK    WN0186 10        User Id
     C                     MOVEL*BLANK    WN0187 10        Job Name
     C                     Z-ADD*ZERO     WN0188  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
      *
     C           KLCHTV    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHTV    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0044    FJTLMI           Total Load Mile
     C                     MOVELWN0045    FJVPCD    P      Ship From Wareh
     C                     MOVELWN0046    FJAJCD    P      Warehouse Code
     C                     Z-ADDWN0047    FJK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##PGM     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTW02           Load ID
      * Define keylist
     C           KPSTW     KLIST
     C                     KFLD           WQTW02           Load ID
     C                     KFLD           WGRVNB           Stop_Drop
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WQTW02           Load ID
      * Setup key
     C                     Z-ADDWL0185    WQTW02           Load ID
     C                     Z-ADDWL0186    WGRVNB           Stop_Drop
      * Establish starting position
     C           KPSTW     SETLL@FLCPEB                    *
     C           KRSTW     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWGN7DT    WL0187           LD Carrier Appt
     C                     Z-ADDWGB3TM    WL0188           LD Carrier Appt
     C                     GOTO TWEXIT                     *QUIT
     C           KRSTW     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTX02           Load ID
      * Define keylist
     C           KPSTX     KLIST
     C                     KFLD           WQTX02           Load ID
     C                     KFLD           WGRVNB           Stop_Drop
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WQTX02           Load ID
      * Setup key
     C                     Z-ADDWL0189    WQTX02           Load ID
     C                     Z-ADDWL0190    WGRVNB           Stop_Drop
      * Establish starting position
     C           KPSTX     SETLL@FLCPEB                    *
     C           KRSTX     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR TYRVGN
     C                     GOTO TXEXIT                     *QUIT
     C           KRSTX     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDWGAIC3    WAAIC3           Company Number
     C                     Z-ADDWGC4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSTY     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WL0191           Requested Deliv
     C                     Z-ADD*ZERO     WL0192           Requested Deliv
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABRTX    WUBRTX           Ship To Name
     C                     MOVELWAHNNA    WUHNNA           Ship To City
     C                     Z-ADDWAEIDT    WL0191           Requested Deliv
     C                     Z-ADDWAAFTM    WL0192           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0193    FJRMNB           Load ID
      * Establish starting position
     C           KRSTZ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJQ2CD    WL0194           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 09/20/2011 LJB P001251 Export Order Automation
      * ** Cannot lock if Export Order Automation Upload had errors
      * ** that have not been cleared up
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** Quit if a record is found with an expired date
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** Warning if a record is found with an expired date
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Changes and comments
      *================================================================
      * ** 05/14/2012 LJB E002105
      * ** Restrict to Carrier/Trailer, okay if multiple carriers have
      * ** the same trailer id
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ** Comments
      *================================================================
      * ** See if there is a load with this same Ship Line/Container numb
      * ** that does not match the load passed in. If there is, and it ha
      * ** not shipped, then flag as already assigned to a load and
      * ** pass back to the calling program
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0036  70       Load ID
     C           WN0025    PARM *BLANK    WQ0037  2        Load U_M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 09/20/2011 LJB P001251  Export Order Automation Upload
      * ** Cannot lock load if there are errors still pending in the
      * ** Order Detail record
      * *****
      * ** Auto lock if shipping today & no errors            E00495
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0103  70       Load ID
     C           WN0938    PARM *BLANK    WQ0104  2        Load U_M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 06/28/2006 LJB TRF011
      * ** Added 3 char LH On-Time Reason Code as an input parm to
      * ** replace the old 1 char On Time Reason Code
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0003' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0005  70       Load ID
     C           YL0003    PARM YL0003    WQ0006  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Calendar Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1AODT    IFEQ *ZERO                      Post to G_L Dat
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBAF    KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G_L Dat
      * Setup key
     C                     Z-ADD#1AIC3    AFAIC3
     C                     Z-ADD#1AODT    AFBCDT
     C           KLVBAF    CHAIN@AFREBE              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Calendar Master        NF'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0018' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Carrier Info
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0021  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9937  *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BZNA    IFEQ *BLANK                     Carrier Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCFF    KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    FFBZNA
     C           KLVCFF    CHAIN@FFREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Carrier Info           NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Truck Size new
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RONB    WK1X01  1
     C           WK1X01    IFEQ '?'                        Truck Size
     C           YPMTFD    OREQ '#1RONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RONB' defaulted for 'Truck Size'.
     C                     CALL 'PDEPSRR'              90  SEL Truck Size
     C                     PARM *BLANK    W0RTN   7
     C           #1RONB    PARM #1RONB    WQ0022  7        Truck Size
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9941  *
     C                     END
      *
     C           #1RONB    IFNE *BLANK                     Truck Size
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RONB    IFEQ *BLANK                     Truck Size
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDFK    KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVEL#1RONB    FKRONB
     C           KLVDFK    CHAIN@FKREBT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Truck Size new         NF'
     C                     MOVEL'USR1190' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1190' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Warehouse Codes
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1VPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1VPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1VPCD' defaulted for 'Ship From Warehouse'.
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #1VPCD    PARM #1VPCD    WQ0023  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1VPCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1VPCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWD    KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1VPCD    WDAJCD
     C           KLVEWD    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Warehouse Codes        NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to State Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1DBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0024  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9943  *
     C                     END
      *
     C           #1DBCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DBCD    IFEQ *BLANK                     State Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWB    KLIST
     C                     KFLD           WBBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    WBBGCD
     C           KLVFWB    CHAIN@ACREAH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'State Master           NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Carrier Info
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1XCCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1XCCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1XCCD' defaulted for 'Carrier Broker'.
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #1XCCD    PARM #1XCCD    WQ0025  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9938  *
     C                     END
      *
     C           #1XCCD    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1XCCD    IFEQ *BLANK                     Carrier Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGFF    KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1XCCD    FFBZNA
     C           KLVGFF    CHAIN@FFREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Carrier Info           NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         XTCKTM    BEGSR
      *================================================================
      * Validate time format
      *================================================================
      * If time is zero, do not check
     C           XTTIM     CABEQ*ZERO     XTCKTE
     C                     MOVEL*BLANK    W0RTN   7
     C           YPMTFD    CABNE*BLANK    XTCKTE
      *
      * Check hours in range 0 to 23
      * Check minutes in range 0 to 59
      * Check seconds in range 0 to 59
     C           XTHH      IFLT *ZERO
     C           XTHH      ORGT 23
     C           XTNN      ORLT *ZERO
     C           XTNN      ORGT 59
     C           XTSS      ORLT *ZERO
     C           XTSS      ORGT 59
      * Send error message
      * Send message '*Invalid time'
     C                     MOVEL'Y2U0019' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0019' W0RTN
     C                     END
      *================================================================
     CSR         XTCKTE    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#1VDST'  YPMTFD           Load Type
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ067
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1RXSX'  YPMTFD           LH Power Only L
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#1BZNA'  YPMTFD           Carrier Code
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#1XCCD'  YPMTFD           Carrier Broker
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE033
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#1RONB'  YPMTFD           Truck Size
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#1DBCD'  YPMTFD           Ship To State C
     C                     END
      *
     C           ZHCSRW    IFEQ 020
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#1Q2CD'  YPMTFD           Shipping Method
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AODT           Scheduled Ship
     C                     MOVEL*BLANK    P1PKST           Load Status
     C                     MOVEL*BLANK    P1DXTX           Trailer Id
     C                     MOVEL*BLANK    P1BZNA           Carrier Code
     C                     Z-ADD*ZERO     P1T4NB           Schedule Sequen
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
     C                     MOVEL*BLANK    P1XACD           Shipping Line
     C                     MOVEL*BLANK    P1CNTN           Container Numbe
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2C4NB           Order Number
     C                     Z-ADD*ZERO     P2BKC7           Ship To Custome
     C                     MOVEL*BLANK    P2BRTX           Ship To Name
     C                     MOVEL*BLANK    P2HMNA           Ship To Address
     C                     MOVEL*BLANK    P2HONA           Ship To Address
     C                     MOVEL*BLANK    P2HPNA           Ship To Address
     C                     MOVEL*BLANK    P2HNNA           Ship To City
     C                     MOVEL*BLANK    P2DBCD           Ship To State C
     C                     MOVEL*BLANK    P2CKTX           Ship To Zip_Pos
     C                     MOVEL*BLANK    P2GWST           Header Status
     C                     MOVEL*BLANK    P2XUST           Trans Contol AS
     C                     MOVEL*BLANK    P2BCST           Block Order Fla
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3RSNB           Maximum pounds
     C                     Z-ADD*ZERO     P3TANB           Minimum pounds
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4R4ST           USR Update Flag
     C                     MOVEL*BLANK    P4JDST           USR Check Y/N S
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5OANA           Port Delv Termi
     C                     MOVEL*BLANK    P5LBTX           Port Address Li
     C                     MOVEL*BLANK    P5LATX           Port Address Li
     C                     MOVEL*BLANK    P5XBCD           Sail Port State
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6AJAA           Company Number
     C                     Z-ADD*ZERO     P6AJAE           Order Number 1
     C                     MOVEL*BLANK    P6HWSX           Change Flag USR
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7XECD           Destination Cit
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9B8ST           Status - Y or N
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Carrier Code Usr
     C                     MOVEL*BLANK    WUH8AA  3
      * Define work field Trailer ID USR
     C                     MOVEL*BLANK    WUS2TX 12
      * Define work field Load Start Company USR
     C                     Z-ADD*ZERO     WUB0C3  30
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR Carrier Code
     C                     MOVEL*BLANK    WUR6CD  3
      * Define work field Lock/Unlock
     C                     MOVEL*BLANK    WUF4ST  1
      * Define work field Flat Amount
     C                     Z-ADD*ZERO     WUFLAM 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WEEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WENRVA           Pallet Balance
     C                     Z-ADD*ZERO     WENSVA           Long hook balan
     C                     Z-ADD*ZERO     WENTVA           Short hook bala
     C                     Z-ADD*ZERO     WENUVA           Tub Balance
     C                     Z-ADD*ZERO     WES8NB           Home Phone
     C                     Z-ADD*ZERO     WES9NB           Other Phone
     C                     Z-ADD*ZERO     WENMVA           Flat Rate
     C                     Z-ADD*ZERO     WENOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WENPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WENQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WEQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WEQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WEMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WEMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WERFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WEMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WEBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WEBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WEBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WEBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WEBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WEBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WEDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WEDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WEDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WEDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WEDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WEDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WEB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WEB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WEB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WEB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WEB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WEB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WEAAC7           Contact Number
     C                     Z-ADD*ZERO     WETENO           Carrier Unused
     C                     Z-ADD*ZERO     WEAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WEAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WEKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field *SFLSEL
     C                     MOVEL*BLANK    WUSEL   1
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WGRVNB           Stop_Drop
     C                     Z-ADD*ZERO     WGRWNB           Miles to next s
     C                     Z-ADD*ZERO     WGRXNB           Freight Charge
     C                     Z-ADD*ZERO     WGSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WGT0NB           Freight Misc_Ch
     C                     Z-ADD*ZERO     WGT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WGSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WGKFDT           Appointment Con
     C                     Z-ADD*ZERO     WGACTM           Appointment Con
     C                     Z-ADD*ZERO     WGEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WGAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WGKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WGATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WGHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WGAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGKKDT           On Yard Date
     C                     Z-ADD*ZERO     WGAVTM           On Yard Time
     C                     Z-ADD*ZERO     WGZ4NB           MPC Number
     C                     Z-ADD*ZERO     WGN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WGN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WGN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WGB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WGB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WGB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Unlock Load Authority
     C                     MOVEL*BLANK    WUHTST  1
      * Define work field Pick Status USR
     C                     MOVEL*BLANK    WUZMST  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Trailer ID Numeric    USR
     C                     Z-ADD*ZERO     WUGQNX 200
      * Define work field Trailer Number Alpha 20
     C                     MOVEL*BLANK    WUO7NA 20
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field State Code
     C                     MOVEL*BLANK    WUBGCD  2
      * Define work field Destination City
     C                     MOVEL*BLANK    WUXECD 20
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Blank for 12          USR
     C                     MOVEL*BLANK    WUS3TX 12
      * Define work field USR Load Type
     C                     MOVEL*BLANK    WUWNST  1
      * Define work field Trailer Type
     C                     MOVEL*BLANK    WUX3ST  1
      * Define work field Seaboard Owned Status
     C                     MOVEL*BLANK    WUXGST  1
      * Define work field On Yard Status
     C                     MOVEL*BLANK    WUSTOY  1
      * Define work field USR On Yard Date New
     C                     Z-ADD*ZERO     WULMDT  70
      * Define work field USR On Yard Time New
     C                     Z-ADD*ZERO     WUA2TM  60
      * Define work field Assigned Status
     C                     MOVEL*BLANK    WUSTAS  1
      * Define work field Available Status
     C                     MOVEL*BLANK    WUXRST  1
      * Define work field Not Available Reason Code
     C                     MOVEL*BLANK    WUX7CD  3
      * Define work field Comment Line
     C                     MOVEL*BLANK    WUGXTX 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WHRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WHFLAM           Flat Amount
     C                     Z-ADD*ZERO     WHRRNB           Total Stops
     C                     Z-ADD*ZERO     WHSBNB           BOL Time
     C                     Z-ADD*ZERO     WHSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHSDNB           Number Pallets
     C                     Z-ADD*ZERO     WHPAOU           Number Pallets
     C                     Z-ADD*ZERO     WHDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WHSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WHHADT           Actual Arrival
     C                     Z-ADD*ZERO     WHAART           Actual Arrival
     C                     Z-ADD*ZERO     WHDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WHDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WHAQDT           Actual Departur
     C                     Z-ADD*ZERO     WHS6NB           Departure Time
     C                     Z-ADD*ZERO     WHT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WHPRTM           Product Tempera
     C                     Z-ADD*ZERO     WHNPSV           Number Spacers
     C                     Z-ADD*ZERO     WHTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WHGRWE           Gross Weight
     C                     Z-ADD*ZERO     WHF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WHJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WHTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WHJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WHSPTM           Spotted Time
     C                     Z-ADD*ZERO     WHJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WHLFTM           Load Finished T
     C                     Z-ADD*ZERO     WHJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WHBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WHJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WHBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WHKIDT           Truck Departure
     C                     Z-ADD*ZERO     WHASTM           Truck Departure
     C                     Z-ADD*ZERO     WHKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WHAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WHVOAG           Voyage
     C                     Z-ADD*ZERO     WHKBDT           Sail Date
     C                     Z-ADD*ZERO     WHEFDT           Arrival Date
     C                     Z-ADD*ZERO     WHKCDT           Date In
     C                     Z-ADD*ZERO     WHTMIN           Time In
     C                     Z-ADD*ZERO     WHKDDT           Date Out
     C                     Z-ADD*ZERO     WHVMNB           Time Out
     C                     Z-ADD*ZERO     WHOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WHKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WHATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WHBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WHEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WHAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WHLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WHK0DT           Product Complet
     C                     Z-ADD*ZERO     WHAYTM           Product Complet
     C                     Z-ADD*ZERO     WHKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WHICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WHIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WHK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WHAZTM           Load Door 1
     C                     Z-ADD*ZERO     WHK2DT           Override Total
     C                     Z-ADD*ZERO     WHA0TM           Load Door 2
     C                     Z-ADD*ZERO     WHZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WHPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WHCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WHPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WHCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WHP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WHCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WHP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WHCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WHP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WHCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WIRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WIQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WIQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WIQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WIGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WIHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WIHGVL           Transload Termi
     C                     Z-ADD*ZERO     WIQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WIQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WIQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WIQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WIITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WIQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WIQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WIQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WIP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WIP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WIQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WIQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WIQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WIQENY           Original Appoin
     C                     Z-ADD*ZERO     WIQFNY           Original Appoin
     C                     Z-ADD*ZERO     WIQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WIQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WIQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WIQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WIW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WIW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field USR Active Load
     C                     MOVEL*BLANK    WUZJST  1
      * Define work field USR Load Assigned
     C                     Z-ADD*ZERO     WUL1LD  70
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field USR Detail or Summary
     C                     MOVEL*BLANK    WUSTST  1
      * Define work field AUTO PRINT PRELIM PICK
     C                     MOVEL*BLANK    WUCLST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field System Value Numeric
     C                     Z-ADD*ZERO     WUM8NB 155
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMDPNB           Order Sequence
     C                     Z-ADD*ZERO     WMUENB           Order Secondary
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WMMAVA           Billing Detail
     C                     Z-ADD*ZERO     WMKDVA           Billing Detail
     C                     Z-ADD*ZERO     WML8VA           Billing Detail
     C                     Z-ADD*ZERO     WML9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WMAYVA           Extended Amount
     C                     Z-ADD*ZERO     WMEXDT           Market Pricing
     C                     Z-ADD*ZERO     WMBZPR           Price Overage O
     C                     Z-ADD*ZERO     WML6NB           Contract Number
     C                     Z-ADD*ZERO     WMGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WMR1NB           Rated Freight
     C                     Z-ADD*ZERO     WMAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WMD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WMCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WMAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WMCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WMATWG           Weight Shipped
     C                     Z-ADD*ZERO     WMAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WMAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WMAKPR           Unit Price
     C                     Z-ADD*ZERO     WMALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WMAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WMAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WMA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WMA5DT           Requested Ship
     C                     Z-ADD*ZERO     WMAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WMGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMCXDT           Date of Origina
     C                     Z-ADD*ZERO     WMDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WMB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WMA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WMNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WMNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WMNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WMNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WMNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WMBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WMBVTM           Price Code
     C                     Z-ADD*ZERO     WMBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WMBXTM           Substitution Li
     C                     Z-ADD*ZERO     WMBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WMH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WMH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WMH7NX           OD Item Target
     C                     Z-ADD*ZERO     WMH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WMH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WMDVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WMDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WMDXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WMDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WMDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WMGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WMGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WMGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WMPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WMRINY           Item Age Days
     C                     Z-ADD*ZERO     WMTIDT           Production Ovr
     C                     Z-ADD*ZERO     WMTJDT           Production Ovr
     C                     Z-ADD*ZERO     WMTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WMTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WMTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define work field SSI Download Flag
     C                     MOVEL*BLANK    WUUNUS  1
      * Define work field SSI Add, Chg, Delete flag
     C                     MOVEL*BLANK    WUAHST  2
      * Define work field STATUS
     C                     MOVEL*BLANK    WUATUS  1
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Allocate Pounds_Miles
     C                     MOVEL*BLANK    WUXQST  1
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Schedule Sequence Number
     C                     Z-ADD*ZERO     WUT4NB  50
      * Define work field Ship From Warehouse
     C                     MOVEL*BLANK    WUVPCD  3
      * Define work field Carrier Broker
     C                     MOVEL*BLANK    WUXCCD  3
      * Define work field Shipping Temp C_F txt
     C                     MOVEL*BLANK    WUWRTX 25
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Define work field Company Number Alpha
     C                     MOVEL*BLANK    WUE6TX  3
      * Define work field Company Number Alpha Usr2
     C                     MOVEL*BLANK    WUEIT1  3
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWKKDT           On Yard Date
     C                     Z-ADD*ZERO     WWAVTM           On Yard Time
     C                     Z-ADD*ZERO     WWLCDT           Date Unused 1
     C                     Z-ADD*ZERO     WWLDDT           Date Unused 2
     C                     Z-ADD*ZERO     WWLEDT           Date Unused 3
     C                     Z-ADD*ZERO     WWLFDT           Date Unused 4
     C                     Z-ADD*ZERO     WWLGDT           Date Unused 5
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Define work field On Yard Date
     C                     Z-ADD*ZERO     WUKKDT  70
      * Define work field On Yard Time
     C                     Z-ADD*ZERO     WUAVTM  60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0004  7
     C                     MOVEL*BLANK    WL0005 30
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0006  2
     C                     MOVEL*BLANK    WL0007 30
     C                     MOVEL*BLANK    WL0008  1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010 30
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016 30
     C                     MOVEL*BLANK    WL0017 30
     C                     MOVEL*BLANK    WL0018 30
     C                     MOVEL*BLANK    WL0019 30
     C                     MOVEL*BLANK    WL0020 20
     C                     MOVEL*BLANK    WL0021  2
     C                     MOVEL*BLANK    WL0022 11
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024 30
     C                     MOVEL*BLANK    WL0025  1
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  3
     C                     MOVEL*BLANK    WL0028  6
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  2
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0031  6
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  2
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0034  30
     C                     MOVEL*BLANK    WL0035  1
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0036  3
      * Define local variables for subroutine SRRVGN.
     C                     MOVEL*BLANK    WL0037 10
     C                     MOVEL*BLANK    WL0038  1
     C                     MOVEL*BLANK    WL0039 10
     C                     MOVEL*BLANK    WL0040  3
     C                     Z-ADD*ZERO     WL0041  30
     C                     MOVEL*BLANK    WL0042 10
      * Define local variables for subroutine SSRVGN.
     C                     MOVEL*BLANK    WL0043 10
     C                     MOVEL*BLANK    WL0044  6
     C                     Z-ADD*ZERO     WL0045  30
     C                     MOVEL*BLANK    WL0046  3
      * Define local variables for subroutine STRVGN.
     C                     MOVEL*BLANK    WL0047  3
     C                     Z-ADD*ZERO     WL0048  30
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0049  70
     C                     MOVEL*BLANK    WL0050  1
      * Define local variables for subroutine SVRVGN.
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     Z-ADD*ZERO     WL0053  70
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  2
      * Define local variables for subroutine SXRVGN.
     C                     MOVEL*BLANK    WL0056  7
     C                     Z-ADD*ZERO     WL0057  70
     C                     Z-ADD*ZERO     WL0058  70
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  50
     C                     MOVEL*BLANK    WL0061  3
      * Define local variables for subroutine TERVGN.
     C                     Z-ADD*ZERO     WL0062  70
     C                     MOVEL*BLANK    WL0063 20
     C                     MOVEL*BLANK    WL0064  2
      * Define local variables for subroutine TFRVGN.
     C                     MOVEL*BLANK    WL0065  3
     C                     MOVEL*BLANK    WL0066  3
     C                     MOVEL*BLANK    WL0067 20
     C                     MOVEL*BLANK    WL0068  2
     C                     Z-ADD*ZERO     WL0069 112
      * Define local variables for subroutine TGRVGN.
     C                     MOVEL*BLANK    WL0070  3
     C                     MOVEL*BLANK    WL0071  1
      * Define local variables for subroutine THRVGN.
     C                     MOVEL*BLANK    WL0072  3
     C                     MOVEL*BLANK    WL0073  6
     C                     Z-ADD*ZERO     WL0074  70
     C                     MOVEL*BLANK    WL0075  1
      * Define local variables for subroutine TIRVGN.
     C                     MOVEL*BLANK    WL0076  6
     C                     MOVEL*BLANK    WL0077 30
      * Define local variables for subroutine TJRVGN.
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079 112
      * Define local variables for subroutine TKRVGN.
     C                     MOVEL*BLANK    WL0080  3
     C                     MOVEL*BLANK    WL0081  6
     C                     Z-ADD*ZERO     WL0082  70
     C                     MOVEL*BLANK    WL0083  1
     C                     Z-ADD*ZERO     WL0084 112
      * Define local variables for subroutine TLRVGN.
     C                     MOVEL*BLANK    WL0085  3
     C                     MOVEL*BLANK    WL0086  6
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  1
      * Define local variables for subroutine TNRVGN.
     C                     MOVEL*BLANK    WL0089  3
     C                     MOVEL*BLANK    WL0090 20
     C                     Z-ADD*ZERO     WL0091  30
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093  1
     C                     MOVEL*BLANK    WL0094  1
     C                     MOVEL*BLANK    WL0095  1
     C                     Z-ADD*ZERO     WL0096  70
     C                     Z-ADD*ZERO     WL0097  60
     C                     MOVEL*BLANK    WL0098  1
     C                     MOVEL*BLANK    WL0099  1
     C                     MOVEL*BLANK    WL0100  3
     C                     MOVEL*BLANK    WL0101 30
     C                     MOVEL*BLANK    WL0102  1
      * Define local variables for subroutine TTRVGN.
     C                     Z-ADD*ZERO     WL0103  70
     C                     Z-ADD*ZERO     WL0104  70
     C                     MOVEL*BLANK    WL0105  1
     C                     MOVEL*BLANK    WL0106  1
     C                     Z-ADD*ZERO     WL0107  52
     C                     MOVEL*BLANK    WL0108 15
     C                     MOVEL*BLANK    WL0109 15
     C                     MOVEL*BLANK    WL0110 15
     C                     Z-ADD*ZERO     WL0111  70
     C                     Z-ADD*ZERO     WL0112 112
     C                     MOVEL*BLANK    WL0113  1
     C                     Z-ADD*ZERO     WL0114  50
     C                     MOVEL*BLANK    WL0115 20
     C                     MOVEL*BLANK    WL0116  3
     C                     Z-ADD*ZERO     WL0117  40
     C                     MOVEL*BLANK    WL0118  3
     C                     MOVEL*BLANK    WL0119  7
     C                     Z-ADD*ZERO     WL0120  70
     C                     Z-ADD*ZERO     WL0121 112
     C                     MOVEL*BLANK    WL0122  1
     C                     MOVEL*BLANK    WL0123  1
     C                     Z-ADD*ZERO     WL0124  50
     C                     Z-ADD*ZERO     WL0125  50
     C                     Z-ADD*ZERO     WL0126 112
     C                     Z-ADD*ZERO     WL0127  60
     C                     Z-ADD*ZERO     WL0128  70
     C                     Z-ADD*ZERO     WL0129  40
     C                     Z-ADD*ZERO     WL0130 112
     C                     Z-ADD*ZERO     WL0131 112
     C                     Z-ADD*ZERO     WL0132  70
     C                     Z-ADD*ZERO     WL0133  40
     C                     Z-ADD*ZERO     WL0134  50
     C                     Z-ADD*ZERO     WL0135  52
     C                     Z-ADD*ZERO     WL0136  50
     C                     MOVEL*BLANK    WL0137 12
     C                     Z-ADD*ZERO     WL0138  70
     C                     MOVEL*BLANK    WL0139 12
     C                     MOVEL*BLANK    WL0140  2
     C                     MOVEL*BLANK    WL0141  3
     C                     MOVEL*BLANK    WL0142  2
     C                     Z-ADD*ZERO     WL0143  70
     C                     MOVEL*BLANK    WL0144  3
     C                     MOVEL*BLANK    WL0145  1
     C                     Z-ADD*ZERO     WL0146  70
     C                     MOVEL*BLANK    WL0147  1
     C                     Z-ADD*ZERO     WL0148  70
     C                     Z-ADD*ZERO     WL0149  60
     C                     Z-ADD*ZERO     WL0150  70
     C                     Z-ADD*ZERO     WL0151  60
     C                     Z-ADD*ZERO     WL0152  70
     C                     Z-ADD*ZERO     WL0153  60
     C                     Z-ADD*ZERO     WL0154  70
     C                     Z-ADD*ZERO     WL0155  60
     C                     Z-ADD*ZERO     WL0156  70
     C                     Z-ADD*ZERO     WL0157  60
     C                     Z-ADD*ZERO     WL0158  70
     C                     Z-ADD*ZERO     WL0159  60
     C                     Z-ADD*ZERO     WL0160  70
     C                     Z-ADD*ZERO     WL0161  60
     C                     MOVEL*BLANK    WL0162  3
     C                     MOVEL*BLANK    WL0163 20
     C                     MOVEL*BLANK    WL0164 30
     C                     Z-ADD*ZERO     WL0165  50
     C                     Z-ADD*ZERO     WL0166  70
     C                     MOVEL*BLANK    WL0167 12
     C                     MOVEL*BLANK    WL0168 20
     C                     Z-ADD*ZERO     WL0169  70
     C                     MOVEL*BLANK    WL0170 12
     C                     Z-ADD*ZERO     WL0171  70
     C                     Z-ADD*ZERO     WL0172  60
     C                     Z-ADD*ZERO     WL0173  70
     C                     Z-ADD*ZERO     WL0174  60
     C                     Z-ADD*ZERO     WL0175 112
     C                     Z-ADD*ZERO     WL0176  70
     C                     Z-ADD*ZERO     WL0177  60
     C                     MOVEL*BLANK    WL0178  1
     C                     Z-ADD*ZERO     WL0179  70
     C                     Z-ADD*ZERO     WL0180  60
     C                     Z-ADD*ZERO     WL0181  70
     C                     Z-ADD*ZERO     WL0182  60
     C                     MOVEL*BLANK    WL0183  1
      * Define local variables for subroutine TURVGN.
     C                     Z-ADD*ZERO     WL0184  70
      * Define local variables for subroutine TWRVGN.
     C                     Z-ADD*ZERO     WL0185  70
     C                     Z-ADD*ZERO     WL0186  50
     C                     Z-ADD*ZERO     WL0187  70
     C                     Z-ADD*ZERO     WL0188  60
      * Define local variables for subroutine TXRVGN.
     C                     Z-ADD*ZERO     WL0189  70
     C                     Z-ADD*ZERO     WL0190  50
     C                     Z-ADD*ZERO     WL0191  70
     C                     Z-ADD*ZERO     WL0192  40
      * Define local variables for subroutine TZRVGN.
     C                     Z-ADD*ZERO     WL0193  70
     C                     MOVEL*BLANK    WL0194  2
      * Define local variables for subroutine NARVGN.
     C                     Z-ADD*ZERO     WL0195  70
     C                     Z-ADD*ZERO     WL0196  50
     C                     Z-ADD*ZERO     WL0197  70
     C                     Z-ADD*ZERO     WL0198  50
      * Define local variables for subroutine NBRVGN.
     C                     Z-ADD*ZERO     WL0199  70
     C                     Z-ADD*ZERO     WL0200  51
      * Define local variables for subroutine NCRVGN.
     C                     Z-ADD*ZERO     WL0201  70
     C                     MOVEL*BLANK    WL0202  1
     C                     Z-ADD*ZERO     WL0203  70
     C                     Z-ADD*ZERO     WL0204  70
      * Define local variables for subroutine NDCHRC.
     C                     Z-ADD*ZERO     WL0205  70
     C                     Z-ADD*ZERO     WL0206  70
     C                     MOVEL*BLANK    WL0207  1
     C                     Z-ADD*ZERO     WL0208 112
     C                     MOVEL*BLANK    WL0209  3
     C                     MOVEL*BLANK    WL0210  2
     C                     Z-ADD*ZERO     WL0211  70
     C                     Z-ADD*ZERO     WL0212  60
     C                     MOVEL*BLANK    WL0213  2
      * Define local variables for subroutine NERVGN.
     C                     Z-ADD*ZERO     WL0214  70
     C                     MOVEL*BLANK    WL0215  3
     C                     MOVEL*BLANK    WL0216  3
     C                     MOVEL*BLANK    WL0217  3
     C                     MOVEL*BLANK    WL0218  3
     C                     MOVEL*BLANK    WL0219  3
     C                     MOVEL*BLANK    WL0220  3
     C                     MOVEL*BLANK    WL0221  3
     C                     MOVEL*BLANK    WL0222  3
     C                     MOVEL*BLANK    WL0223  3
     C                     MOVEL*BLANK    WL0224  3
      * Define local variables for subroutine NGRVGN.
     C                     Z-ADD*ZERO     WL0225  70
     C                     MOVEL*BLANK    WL0226  1
      * Define local variables for subroutine NKRVGN.
     C                     Z-ADD*ZERO     WL0227  30
     C                     MOVEL*BLANK    WL0228  6
     C                     MOVEL*BLANK    WL0229  1
     C                     MOVEL*BLANK    WL0230  1
      * Define local variables for subroutine NLCHRC.
     C                     Z-ADD*ZERO     WL0231  70
     C                     MOVEL*BLANK    WL0232  1
     C                     Z-ADD*ZERO     WL0233 112
      * Define local variables for subroutine NMRVGN.
     C                     MOVEL*BLANK    WL0234 10
     C                     MOVEL*BLANK    WL0235 40
      * Define local variables for subroutine NNRVGN.
     C                     Z-ADD*ZERO     WL0236  70
     C                     Z-ADD*ZERO     WL0237  50
      * Define local variables for subroutine NSCHRC.
     C                     Z-ADD*ZERO     WL0238  30
     C                     Z-ADD*ZERO     WL0239  70
     C                     Z-ADD*ZERO     WL0240  30
     C                     Z-ADD*ZERO     WL0241  30
     C                     Z-ADD*ZERO     WL0242 112
      * Define local variables for subroutine NVRVGN.
     C                     MOVEL*BLANK    WL0243  3
     C                     MOVEL*BLANK    WL0244  1
      * Define local variables for subroutine ODCRRC.
     C                     MOVEL*BLANK    WL0245  3
     C                     MOVEL*BLANK    WL0246 20
     C                     Z-ADD*ZERO     WL0247  30
     C                     MOVEL*BLANK    WL0248  1
     C                     MOVEL*BLANK    WL0249  1
     C                     MOVEL*BLANK    WL0250  1
     C                     MOVEL*BLANK    WL0251  1
     C                     Z-ADD*ZERO     WL0252  70
     C                     Z-ADD*ZERO     WL0253  60
     C                     MOVEL*BLANK    WL0254  1
     C                     MOVEL*BLANK    WL0255  1
     C                     MOVEL*BLANK    WL0256  3
     C                     MOVEL*BLANK    WL0257 30
     C                     MOVEL*BLANK    WL0258  1
     C                     MOVEL*BLANK    WL0259  1
     C                     MOVEL*BLANK    WL0260  1
     C                     MOVEL*BLANK    WL0261  1
     C                     MOVEL*BLANK    WL0262  1
     C                     Z-ADD*ZERO     WL0263  70
     C                     Z-ADD*ZERO     WL0264  70
     C                     Z-ADD*ZERO     WL0265  70
     C                     Z-ADD*ZERO     WL0266  70
     C                     Z-ADD*ZERO     WL0267  70
     C                     MOVEL*BLANK    WL0268  1
     C                     MOVEL*BLANK    WL0269  1
     C                     MOVEL*BLANK    WL0270  1
     C                     MOVEL*BLANK    WL0271  1
     C                     Z-ADD*ZERO     WL0272  60
     C                     MOVEL*BLANK    WL0273 10
     C                     MOVEL*BLANK    WL0274 10
     C                     Z-ADD*ZERO     WL0275  70
      * Define local variables for subroutine OECHRC.
     C                     MOVEL*BLANK    WL0276  3
     C                     MOVEL*BLANK    WL0277 20
     C                     Z-ADD*ZERO     WL0278  30
     C                     MOVEL*BLANK    WL0279  1
     C                     MOVEL*BLANK    WL0280  1
     C                     MOVEL*BLANK    WL0281  1
     C                     MOVEL*BLANK    WL0282  1
     C                     Z-ADD*ZERO     WL0283  70
     C                     Z-ADD*ZERO     WL0284  60
     C                     MOVEL*BLANK    WL0285  1
     C                     MOVEL*BLANK    WL0286  1
     C                     MOVEL*BLANK    WL0287  3
     C                     MOVEL*BLANK    WL0288 30
     C                     MOVEL*BLANK    WL0289  1
     C                     MOVEL*BLANK    WL0290  1
     C                     MOVEL*BLANK    WL0291  1
     C                     MOVEL*BLANK    WL0292  1
     C                     MOVEL*BLANK    WL0293  1
     C                     Z-ADD*ZERO     WL0294  70
     C                     Z-ADD*ZERO     WL0295  70
     C                     Z-ADD*ZERO     WL0296  70
     C                     Z-ADD*ZERO     WL0297  70
     C                     Z-ADD*ZERO     WL0298  70
     C                     MOVEL*BLANK    WL0299  1
     C                     MOVEL*BLANK    WL0300  1
     C                     MOVEL*BLANK    WL0301  1
     C                     MOVEL*BLANK    WL0302  1
     C                     Z-ADD*ZERO     WL0303  60
     C                     MOVEL*BLANK    WL0304 10
     C                     MOVEL*BLANK    WL0305 10
     C                     Z-ADD*ZERO     WL0306  70
      * Define local work field Case Sensitive Field
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field Case Upper Field
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Total Load Miles
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field Country Code
     C                     MOVEL*BLANK    YL0006  6
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Country Power Only Ld Dft
     C                     MOVEL*BLANK    YL0008  1
      * Define null work field ISO Alpha2 Code
     C                     MOVEL*BLANK    YN0001  2
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0009  3
      * Define local work field Trailer ID USR
     C                     MOVEL*BLANK    YL0010 12
      * Define null work field On Yard Status
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field On Yard Date
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field On Yard Time
     C                     Z-ADD*ZERO     YN0004  60
      * Define null work field Available Status
     C                     MOVEL*BLANK    YN0005  1
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Blank for 4           USR
     C                     MOVEL*BLANK    YL0012  4
      * Define local work field USR CDE Parm 1
     C                     MOVEL*BLANK    YL0013  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0014  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0015  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0016  30
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field Error Flag            USR
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Insurance Type Desc
     C                     MOVEL*BLANK    YL0019 30
      * Define local work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field Insurance Type Desc
     C                     MOVEL*BLANK    YL0021 30
      * Define local work field Insurance Type Desc
     C                     MOVEL*BLANK    YL0022 30
      * Define local work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     YL0023  70
      * Define local work field Text 3 Length USR
     C                     MOVEL*BLANK    YL0024  3
      * Define local work field Destination City
     C                     MOVEL*BLANK    YL0025 20
      * Define local work field Load ID USR
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field Load Id 3
     C                     Z-ADD*ZERO     YL0027  70
      * Define local work field Load Status New
     C                     MOVEL*BLANK    YL0028  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field Load Id 1
     C                     Z-ADD*ZERO     YL0031  70
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0006  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0032  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0033  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0034  50
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0036  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0007 10
      * Define local work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field Plant Floor System USR
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field Status Flag 20 Y/N
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field Lock option override sts
     C                     MOVEL*BLANK    YL0043  1
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0044  2
      * Define local work field USR Status (Y/N)
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0046  70
      * Define local work field Container Number
     C                     MOVEL*BLANK    YL0047 12
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0048  6
      * Define local work field Load Change Type 2
     C                     MOVEL*BLANK    YL0049  6
      * Define local work field TMS LH Field Chg Text
     C                     MOVEL*BLANK    YL0050 35
      * Define local work field Load Change Type 3
     C                     MOVEL*BLANK    YL0051  6
      * Define local work field Load Change Type 4
     C                     MOVEL*BLANK    YL0052  6
      * Define local work field Load Change Type 5
     C                     MOVEL*BLANK    YL0053  6
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0054  3
      * Define local work field Trailer Id
     C                     MOVEL*BLANK    YL0055 20
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0056  30
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0057  1
      * Define local work field Trailer Type
     C                     MOVEL*BLANK    YL0058  1
      * Define local work field Seaboard Owned Status
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field Not Available Reason Code
     C                     MOVEL*BLANK    YL0060  3
      * Define local work field Comment Line
     C                     MOVEL*BLANK    YL0061 30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0062  70
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0008  30
      * Define null work field Trailer Type
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field Seaboard Owned Status
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field On Yard Status
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Assigned Status
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Available Status
     C                     MOVEL*BLANK    YN0013  1
      * Define null work field Not Available Reason Code
     C                     MOVEL*BLANK    YN0014  3
      * Define null work field Comment Line
     C                     MOVEL*BLANK    YN0015 30
      * Define local work field Allow Multi_Company
     C                     MOVEL*BLANK    YL0063  1
      * Define null work field Description
     C                     MOVEL*BLANK    YN0016 30
      * Define null work field System Date Format
     C                     MOVEL*BLANK    YN0017  3
      * Define null work field Printer Device Str
     C                     MOVEL*BLANK    YN0018 10
      * Define null work field Application WHS Restrict
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Credit Hold Authority
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field Production Hold Authority
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field Allow Multi Warehouse
     C                     MOVEL*BLANK    YN0022  1
      * Define null work field Entity Number
     C                     Z-ADD*ZERO     YN0023  70
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0024 10
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0025  3
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0026  30
      * Define null work field Enterprise Code 1
     C                     MOVEL*BLANK    YN0027  4
      * Define null work field Enterprise Code 2
     C                     MOVEL*BLANK    YN0028 12
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field User Code Model
     C                     MOVEL*BLANK    YN0030 10
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR OHRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'N'       P6HWSX           Change Flag USR
      * Rtv User Profile Info RT - User Profile Control  * 
     C                     EXSR OJRVGN
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
01045
** W0END
01051
** W0NAM
#1RMNB
** W1BEG
01051010800108501307015630156501819
01825020750208102115021190233102587
02613026210284302849030990310503355
03611036170386703893038980412304134
04379046350463904891048970514705153
0540305424
** W1END
01057010800109601314015630156901821
01854020750209002115021230233802591
02618026280284502878031010313403366
03613036360387303895039180412904163
04390046370466804892049260514805166
0542205438
** W1NAM
#1RMNB    #1PKST    #DHKNA    V1KZDT    #1PJST    #DAGTH    V1AIC3
#DSQTX    #1VDST    #DNCNA    #1RXSX    #DY7TX    V1AODT    #1T4NB
V1P0DT    #1CMTM    #1BZNA    #DGVTX    #1XCCD    #DADTX    #DS2TX
#1DYTX    #DL3NA    #1TLMI    #DEZTX    #DEET1    #1RONB    #DDPTX
#1FLAM    #1VPCD    #DF8NA    #1DBCD    #DHSNA    #1Q2CD    #DI6TX
#DHNNA    #DLHNA
** @CN
00001 Y2U0005
00002 USR0752
00003 TRLRASN
00004 TRLRAVL
00005 PDIZPCLP
00006 Auto Print Prelim. Pick
00007 PDSNPFR
00008 PLTFLRSYS
