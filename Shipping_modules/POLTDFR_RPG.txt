     H/TITLE WW Load Frt Charge     DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 10/30/23  Time  : 08:40:57
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOLTDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Load Frt Charge     DF Display file
      *
     FOMFJCPMGIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Load Header               Ld/ASD/Carr LS=S,I SM=PT
      *
     FPOA9REL1IF  E           K        DISK
      * RTV : Freight Charge            Retrieval index
      *
     FPOBCCPL1IF  E           K        DISK
      * RTV : Load Freight Charge       Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOMHSTPN8IF  E           K        DISK
      * RSQ : Sales History             Load#/Order#
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMHSTPL0UF  E           K        DISK
      * UPD : Sales History             Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@FHSTD2
      * Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WAAIC3
     I              F4C4NB                          WAC4NB
     I              F4DPNB                          WADPNB
     I              F4UENB                          WAUENB
     I              F4MONA                          WAMONA
     I              F4RJCD                          WARJCD
     I              F4RKCD                          WARKCD
     I              F4GPTX                          WAGPTX
     I              F4ABTX                          WAABTX
     I              F4KXCD                          WAKXCD
     I              F4BOCD                          WABOCD
     I              F4BTC7                          WABTC7
     I              F4ANC7                          WAANC7
     I              F4AQTX                          WAAQTX
     I              F4BKC7                          WABKC7
     I              F4BRTX                          WABRTX
     I              F4HNNA                          WAHNNA
     I              F4DBCD                          WADBCD
     I              F4CKTX                          WACKTX
     I              F4BCNA                          WABCNA
     I              F4A0DT                          WAA0DT
     I              F4ACDT                          WAACDT
     I              F4R4CD                          WAR4CD
     I              F4R5CD                          WAR5CD
     I              F4BFCD                          WABFCD
     I              F4Q4CD                          WAQ4CD
     I              F4AQCD                          WAAQCD
     I              F4TBNB                          WATBNB
     I              F4BZNA                          WABZNA
     I              F4RLCD                          WARLCD
     I              F4JNCD                          WAJNCD
     I              F4Q2CD                          WAQ2CD
     I              F4U2ST                          WAU2ST
     I              F4ATIN                          WAATIN
     I              F4T3NB                          WAT3NB
     I              F4RSRN                          WARSRN
     I              F4ORIT                          WAORIT
     I              F4AJCD                          WAAJCD
     I              F4AVQT                          WAAVQT
     I              F4D0WG                          WAD0WG
     I              F4CCQT                          WACCQT
     I              F4AUWG                          WAAUWG
     I              F4AGCD                          WAAGCD
     I              F4AKPR                          WAAKPR
     I              F4AUPR                          WAAUPR
     I              F4CRCD                          WACRCD
     I              F4A5DT                          WAA5DT
     I              F4AWDT                          WAAWDT
     I              F4HDDT                          WAHDDT
     I              F4AGCS                          WAAGCS
     I              F4AQCS                          WAAQCS
     I              F4AVWG                          WAAVWG
     I              F4AYVA                          WAAYVA
     I              F4AMST                          WAAMST
     I              F4ANST                          WAANST
     I              F4VAST                          WAVAST
     I              F4L6NB                          WAL6NB
     I              F4UMCD                          WAUMCD
     I              F4HCDT                          WAHCDT
     I              F4ESNB                          WAESNB
     I              F4ETNB                          WAETNB
     I              F4BZNB                          WABZNB
     I              F4EXQT                          WAEXQT
     I              F4BYWG                          WABYWG
     I              F4S5NB                          WAS5NB
     I              F4MAVA                          WAMAVA
     I              F4KDVA                          WAKDVA
     I              F4USVA                          WAUSVA
     I              F4UTVA                          WAUTVA
     I              F4A4WG                          WAA4WG
     I              F4CKNB                          WACKNB
     I              F4BMST                          WABMST
     I              F4R8NB                          WAR8NB
     I              F4RMCD                          WARMCD
     I              F4BZPR                          WABZPR
     I              F4RDCD                          WARDCD
     I              F4Q7CD                          WAQ7CD
     I              F4EXDT                          WAEXDT
     I              F4LQCD                          WALQCD
     I              F4HICD                          WAHICD
     I              F4RBCD                          WARBCD
     I              F4RGNB                          WARGNB
     I              F4RHNB                          WARHNB
     I              F4RINB                          WARINB
     I              F4R1NB                          WAR1NB
     I              F4CONB                          WACONB
     I              F4CEST                          WACEST
     I              F4GNDT                          WAGNDT
     I              F4RMNB                          WARMNB
     I              F4AODT                          WAAODT
     I              F4LLCD                          WALLCD
     I              F4LMCD                          WALMCD
     I              F4SKNB                          WASKNB
     I              F4SLNB                          WASLNB
     I              F4SMNB                          WASMNB
     I              F4G7NA                          WAG7NA
     I              F4ONVA                          WAONVA
     I              F4N0CD                          WAN0CD
     I              F4B4NB                          WAB4NB
     I              F4B5NB                          WAB5NB
     I              F4N1CD                          WAN1CD
     I              F4GIDT                          WAGIDT
     I              F4Z1ST                          WAZ1ST
     I              F4ULVA                          WAULVA
     I              F4UNVA                          WAUNVA
     I              F4UOVA                          WAUOVA
     I              F4UPVA                          WAUPVA
     I              F4UQVA                          WAUQVA
     I              F4SDCD                          WASDCD
     I              F4QZCD                          WAQZCD
     I              F4XWST                          WAXWST
     I              F4T9CD                          WAT9CD
     I              F4UBCD                          WAUBCD
     I              F4CFC7                          WACFC7
     I              F4X1CD                          WAX1CD
     I              F4GASX                          WAGASX
     I              F4DUPR                          WADUPR
     I              F4B6VL                          WAB6VL
     I              F4IANX                          WAIANX
     I              F4IBNX                          WAIBNX
     I              F4RPCD                          WARPCD
     I              F4NYDT                          WANYDT
     I              F4BZTM                          WABZTM
     I              F4Z4NB                          WAZ4NB
     I              F4XACD                          WAXACD
     I              F4OANA                          WAOANA
     I              F4OKTX                          WAOKTX
     I              F4K4TX                          WAK4TX
     I              F4NBBO                          WANBBO
     I              F4OCFR                          WAOCFR
     I              F4C0C7                          WAC0C7
     I              F4A1AA                          WAA1AA
     I              F4VEST                          WAVEST
     I              F4A5PR                          WAA5PR
     I              F4CDPR                          WACDPR
     I              F4D0PR                          WAD0PR
     I              F4D0VL                          WAD0VL
     I              F4IRSX                          WAIRSX
     I              F4CEVL                          WACEVL
     I              F4ISSX                          WAISSX
     I              F4ITSX                          WAITSX
     I              F4IUSX                          WAIUSX
     I              F4OHDT                          WAOHDT
     I              F4D9PR                          WAD9PR
     I              F4CFVL                          WACFVL
     I              F4UVST                          WAUVST
     I              F4UWST                          WAUWST
     I              F4UXST                          WAUXST
     I              F4AATM                          WAAATM
     I              F4AYNA                          WAAYNA
     I              F4A0NA                          WAA0NA
     I              F4AXDT                          WAAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@HSTPUX
      * Sales History             Load#/Order#
      * Renamed input format fields
     I              F4AIC3                          WDAIC3
     I              F4C4NB                          WDC4NB
     I              F4DPNB                          WDDPNB
     I              F4UENB                          WDUENB
     I              F4MONA                          WDMONA
     I              F4RJCD                          WDRJCD
     I              F4RKCD                          WDRKCD
     I              F4GPTX                          WDGPTX
     I              F4ABTX                          WDABTX
     I              F4KXCD                          WDKXCD
     I              F4BOCD                          WDBOCD
     I              F4BTC7                          WDBTC7
     I              F4ANC7                          WDANC7
     I              F4AQTX                          WDAQTX
     I              F4BKC7                          WDBKC7
     I              F4BRTX                          WDBRTX
     I              F4HNNA                          WDHNNA
     I              F4DBCD                          WDDBCD
     I              F4CKTX                          WDCKTX
     I              F4BCNA                          WDBCNA
     I              F4A0DT                          WDA0DT
     I              F4ACDT                          WDACDT
     I              F4R4CD                          WDR4CD
     I              F4R5CD                          WDR5CD
     I              F4BFCD                          WDBFCD
     I              F4Q4CD                          WDQ4CD
     I              F4AQCD                          WDAQCD
     I              F4TBNB                          WDTBNB
     I              F4BZNA                          WDBZNA
     I              F4RLCD                          WDRLCD
     I              F4JNCD                          WDJNCD
     I              F4Q2CD                          WDQ2CD
     I              F4U2ST                          WDU2ST
     I              F4ATIN                          WDATIN
     I              F4T3NB                          WDT3NB
     I              F4RSRN                          WDRSRN
     I              F4ORIT                          WDORIT
     I              F4AJCD                          WDAJCD
     I              F4AVQT                          WDAVQT
     I              F4D0WG                          WDD0WG
     I              F4CCQT                          WDCCQT
     I              F4AUWG                          WDAUWG
     I              F4AGCD                          WDAGCD
     I              F4AKPR                          WDAKPR
     I              F4AUPR                          WDAUPR
     I              F4CRCD                          WDCRCD
     I              F4A5DT                          WDA5DT
     I              F4AWDT                          WDAWDT
     I              F4HDDT                          WDHDDT
     I              F4AGCS                          WDAGCS
     I              F4AQCS                          WDAQCS
     I              F4AVWG                          WDAVWG
     I              F4AYVA                          WDAYVA
     I              F4AMST                          WDAMST
     I              F4ANST                          WDANST
     I              F4VAST                          WDVAST
     I              F4L6NB                          WDL6NB
     I              F4UMCD                          WDUMCD
     I              F4HCDT                          WDHCDT
     I              F4ESNB                          WDESNB
     I              F4ETNB                          WDETNB
     I              F4BZNB                          WDBZNB
     I              F4EXQT                          WDEXQT
     I              F4BYWG                          WDBYWG
     I              F4S5NB                          WDS5NB
     I              F4MAVA                          WDMAVA
     I              F4KDVA                          WDKDVA
     I              F4USVA                          WDUSVA
     I              F4UTVA                          WDUTVA
     I              F4A4WG                          WDA4WG
     I              F4CKNB                          WDCKNB
     I              F4BMST                          WDBMST
     I              F4R8NB                          WDR8NB
     I              F4RMCD                          WDRMCD
     I              F4BZPR                          WDBZPR
     I              F4RDCD                          WDRDCD
     I              F4Q7CD                          WDQ7CD
     I              F4EXDT                          WDEXDT
     I              F4LQCD                          WDLQCD
     I              F4HICD                          WDHICD
     I              F4RBCD                          WDRBCD
     I              F4RGNB                          WDRGNB
     I              F4RHNB                          WDRHNB
     I              F4RINB                          WDRINB
     I              F4R1NB                          WDR1NB
     I              F4CONB                          WDCONB
     I              F4CEST                          WDCEST
     I              F4GNDT                          WDGNDT
     I              F4RMNB                          WDRMNB
     I              F4AODT                          WDAODT
     I              F4LLCD                          WDLLCD
     I              F4LMCD                          WDLMCD
     I              F4SKNB                          WDSKNB
     I              F4SLNB                          WDSLNB
     I              F4SMNB                          WDSMNB
     I              F4G7NA                          WDG7NA
     I              F4ONVA                          WDONVA
     I              F4N0CD                          WDN0CD
     I              F4B4NB                          WDB4NB
     I              F4B5NB                          WDB5NB
     I              F4N1CD                          WDN1CD
     I              F4GIDT                          WDGIDT
     I              F4Z1ST                          WDZ1ST
     I              F4ULVA                          WDULVA
     I              F4UNVA                          WDUNVA
     I              F4UOVA                          WDUOVA
     I              F4UPVA                          WDUPVA
     I              F4UQVA                          WDUQVA
     I              F4SDCD                          WDSDCD
     I              F4QZCD                          WDQZCD
     I              F4XWST                          WDXWST
     I              F4T9CD                          WDT9CD
     I              F4UBCD                          WDUBCD
     I              F4CFC7                          WDCFC7
     I              F4X1CD                          WDX1CD
     I              F4GASX                          WDGASX
     I              F4DUPR                          WDDUPR
     I              F4B6VL                          WDB6VL
     I              F4IANX                          WDIANX
     I              F4IBNX                          WDIBNX
     I              F4RPCD                          WDRPCD
     I              F4NYDT                          WDNYDT
     I              F4BZTM                          WDBZTM
     I              F4Z4NB                          WDZ4NB
     I              F4XACD                          WDXACD
     I              F4OANA                          WDOANA
     I              F4OKTX                          WDOKTX
     I              F4K4TX                          WDK4TX
     I              F4NBBO                          WDNBBO
     I              F4OCFR                          WDOCFR
     I              F4C0C7                          WDC0C7
     I              F4A1AA                          WDA1AA
     I              F4VEST                          WDVEST
     I              F4A5PR                          WDA5PR
     I              F4CDPR                          WDCDPR
     I              F4D0PR                          WDD0PR
     I              F4D0VL                          WDD0VL
     I              F4IRSX                          WDIRSX
     I              F4CEVL                          WDCEVL
     I              F4ISSX                          WDISSX
     I              F4ITSX                          WDITSX
     I              F4IUSX                          WDIUSX
     I              F4OHDT                          WDOHDT
     I              F4D9PR                          WDD9PR
     I              F4CFVL                          WDCFVL
     I              F4UVST                          WDUVST
     I              F4UWST                          WDUWST
     I              F4UXST                          WDUXST
     I              F4AATM                          WDAATM
     I              F4AYNA                          WDAYNA
     I              F4A0NA                          WDA0NA
     I              F4AXDT                          WDAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQOMHS1    E DSOMHSTPL0
      * UPD : Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WAAIC3
     I              F4C4NB                          WAC4NB
     I              F4DPNB                          WADPNB
     I              F4UENB                          WAUENB
     I              F4MONA                          WAMONA
     I              F4RJCD                          WARJCD
     I              F4RKCD                          WARKCD
     I              F4GPTX                          WAGPTX
     I              F4ABTX                          WAABTX
     I              F4KXCD                          WAKXCD
     I              F4BOCD                          WABOCD
     I              F4BTC7                          WABTC7
     I              F4ANC7                          WAANC7
     I              F4AQTX                          WAAQTX
     I              F4BKC7                          WABKC7
     I              F4BRTX                          WABRTX
     I              F4HNNA                          WAHNNA
     I              F4DBCD                          WADBCD
     I              F4CKTX                          WACKTX
     I              F4BCNA                          WABCNA
     I              F4A0DT                          WAA0DT
     I              F4ACDT                          WAACDT
     I              F4R4CD                          WAR4CD
     I              F4R5CD                          WAR5CD
     I              F4BFCD                          WABFCD
     I              F4Q4CD                          WAQ4CD
     I              F4AQCD                          WAAQCD
     I              F4TBNB                          WATBNB
     I              F4BZNA                          WABZNA
     I              F4RLCD                          WARLCD
     I              F4JNCD                          WAJNCD
     I              F4Q2CD                          WAQ2CD
     I              F4U2ST                          WAU2ST
     I              F4ATIN                          WAATIN
     I              F4T3NB                          WAT3NB
     I              F4RSRN                          WARSRN
     I              F4ORIT                          WAORIT
     I              F4AJCD                          WAAJCD
     I              F4AVQT                          WAAVQT
     I              F4D0WG                          WAD0WG
     I              F4CCQT                          WACCQT
     I              F4AUWG                          WAAUWG
     I              F4AGCD                          WAAGCD
     I              F4AKPR                          WAAKPR
     I              F4AUPR                          WAAUPR
     I              F4CRCD                          WACRCD
     I              F4A5DT                          WAA5DT
     I              F4AWDT                          WAAWDT
     I              F4HDDT                          WAHDDT
     I              F4AGCS                          WAAGCS
     I              F4AQCS                          WAAQCS
     I              F4AVWG                          WAAVWG
     I              F4AYVA                          WAAYVA
     I              F4AMST                          WAAMST
     I              F4ANST                          WAANST
     I              F4VAST                          WAVAST
     I              F4L6NB                          WAL6NB
     I              F4UMCD                          WAUMCD
     I              F4HCDT                          WAHCDT
     I              F4ESNB                          WAESNB
     I              F4ETNB                          WAETNB
     I              F4BZNB                          WABZNB
     I              F4EXQT                          WAEXQT
     I              F4BYWG                          WABYWG
     I              F4S5NB                          WAS5NB
     I              F4MAVA                          WAMAVA
     I              F4KDVA                          WAKDVA
     I              F4USVA                          WAUSVA
     I              F4UTVA                          WAUTVA
     I              F4A4WG                          WAA4WG
     I              F4CKNB                          WACKNB
     I              F4BMST                          WABMST
     I              F4R8NB                          WAR8NB
     I              F4RMCD                          WARMCD
     I              F4BZPR                          WABZPR
     I              F4RDCD                          WARDCD
     I              F4Q7CD                          WAQ7CD
     I              F4EXDT                          WAEXDT
     I              F4LQCD                          WALQCD
     I              F4HICD                          WAHICD
     I              F4RBCD                          WARBCD
     I              F4RGNB                          WARGNB
     I              F4RHNB                          WARHNB
     I              F4RINB                          WARINB
     I              F4R1NB                          WAR1NB
     I              F4CONB                          WACONB
     I              F4CEST                          WACEST
     I              F4GNDT                          WAGNDT
     I              F4RMNB                          WARMNB
     I              F4AODT                          WAAODT
     I              F4LLCD                          WALLCD
     I              F4LMCD                          WALMCD
     I              F4SKNB                          WASKNB
     I              F4SLNB                          WASLNB
     I              F4SMNB                          WASMNB
     I              F4G7NA                          WAG7NA
     I              F4ONVA                          WAONVA
     I              F4N0CD                          WAN0CD
     I              F4B4NB                          WAB4NB
     I              F4B5NB                          WAB5NB
     I              F4N1CD                          WAN1CD
     I              F4GIDT                          WAGIDT
     I              F4Z1ST                          WAZ1ST
     I              F4ULVA                          WAULVA
     I              F4UNVA                          WAUNVA
     I              F4UOVA                          WAUOVA
     I              F4UPVA                          WAUPVA
     I              F4UQVA                          WAUQVA
     I              F4SDCD                          WASDCD
     I              F4QZCD                          WAQZCD
     I              F4XWST                          WAXWST
     I              F4T9CD                          WAT9CD
     I              F4UBCD                          WAUBCD
     I              F4CFC7                          WACFC7
     I              F4X1CD                          WAX1CD
     I              F4GASX                          WAGASX
     I              F4DUPR                          WADUPR
     I              F4B6VL                          WAB6VL
     I              F4IANX                          WAIANX
     I              F4IBNX                          WAIBNX
     I              F4RPCD                          WARPCD
     I              F4NYDT                          WANYDT
     I              F4BZTM                          WABZTM
     I              F4Z4NB                          WAZ4NB
     I              F4XACD                          WAXACD
     I              F4OANA                          WAOANA
     I              F4OKTX                          WAOKTX
     I              F4K4TX                          WAK4TX
     I              F4NBBO                          WANBBO
     I              F4OCFR                          WAOCFR
     I              F4C0C7                          WAC0C7
     I              F4A1AA                          WAA1AA
     I              F4VEST                          WAVEST
     I              F4A5PR                          WAA5PR
     I              F4CDPR                          WACDPR
     I              F4D0PR                          WAD0PR
     I              F4D0VL                          WAD0VL
     I              F4IRSX                          WAIRSX
     I              F4CEVL                          WACEVL
     I              F4ISSX                          WAISSX
     I              F4ITSX                          WAITSX
     I              F4IUSX                          WAIUSX
     I              F4OHDT                          WAOHDT
     I              F4D9PR                          WAD9PR
     I              F4CFVL                          WACFVL
     I              F4UVST                          WAUVST
     I              F4UWST                          WAUWST
     I              F4UXST                          WAUXST
     I              F4AATM                          WAAATM
     I              F4AYNA                          WAAYNA
     I              F4A0NA                          WAA0NA
     I              F4AXDT                          WAAXDT
      *
     IYARDCS      DS                            792
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     IYBRDCS      DS                            793
     IYCRDCS      DS                            793
      * Outward parameters
     IPARC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I : RST Load ID
     I                                    P   1   40PARMNB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Application Code
     I                                        6  11 P1DNCD
      * N :  Enterprise Code 1
     I                                       12  15 P1DQCD
      * N :  Enterprise Code 2
     I                                       16  27 P1DRCD
      * N :  Salesperson Code
     I                                       28  30 P1BCCD
      * N :  System Date Format
     I                                       31  33 P1B8NA
      * N :  User Profile Name
     I                                       34  43 P1AJVN
      * N :  Allow Multi-Company
     I                                       44  44 P1I6ST
      * N :  Allow Multi Warehouse
     I                                       45  45 P1I8ST
      * N :  Default Printer
     I                                       46  55 P1MPNA
      * N :  First Time Flag
     I                                       56  56 P1TAST
      * N :  Name
     I                                       57  86 P1ADTX
      * N :  System Value Alpha
     I                                       87 126 P1BXTX
      * N :  Access Denied (Y/N)
     I                                      127 127 P1WVST
      * N :  Requested Delivery Date
     I                                    P 128 1310P1EIDT
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Live TMS Option Invalid'
      * SH Order Sales Channel
     I                                        1   2 ZA0001
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0002
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0003
      * Application Code
     I                                       11  16 ZA0004
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0005
      * Application Code
     I                                       11  16 ZA0006
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: LCL.First Time Flag is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     END                             *FI
      * ** Retrieve Charge Code Headings
      * Rtv Edit Freight Hdg  RT - Freight Charge  * 
     C                     EXSR SARVGN
      * ** Save Payment Status selector field
     C                     MOVEL#2RNST    YL0002           LH Carrier Paym
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           FJRNST           LH Carrier Paym
     C                     KFLD           FJF9DT           Actual Ship Dat
     C                     KFLD           FJRMNB           Load ID
     C                     KFLD           FJBZNA           Carrier Code
      * Setup key
     C                     MOVEL#2RNST    FJRNST
     C                     Z-ADD#2F9DT    FJF9DT
     C                     Z-ADD#2RMNB    FJRMNB
     C                     MOVEL#2BZNA    FJBZNA
     C           KPOS      SETLL@FJCPGU
     C                     READ @FJCPGU                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2TLMI    WZTLMI
     C                     MOVEL#2TLMI    WZTLMI           Total Load Mile
     C           *LIKE     DEFN #2PKST    WZPKST
     C                     MOVEL#2PKST    WZPKST           Load Status
     C           *LIKE     DEFN #2J7DT    WZJ7DT
     C                     MOVEL#2J7DT    WZJ7DT           BOL Complete Da
     C           *LIKE     DEFN #2ZBVA    WZZBVA
     C                     MOVEL#2ZBVA    WZZBVA           Load Actual Fre
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
     C           *LIKE     DEFN #2SQNB    WZSQNB
     C                     MOVEL#2SQNB    WZSQNB           Ld Hdr_Ld Dtl U
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2F9DT    WZF9DT
     C                     MOVEL#2F9DT    WZF9DT           Actual Ship Dat
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
     C           *LIKE     DEFN #2RNST    WZRNST
     C                     MOVEL#2RNST    WZRNST           LH Carrier Paym
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2U2ST    WZU2ST
     C                     MOVEL#2U2ST    WZU2ST           Export Status
     C           *LIKE     DEFN #2LSHG    WZLSHG
     C                     MOVEL#2LSHG    WZLSHG           Load Shag Flag
     C           *LIKE     DEFN #2YPST    WZYPST
     C                     MOVEL#2YPST    WZYPST           Load Wash Flag
     C           *LIKE     DEFN #2VPCD    WZVPCD
     C                     MOVEL#2VPCD    WZVPCD           Ship From Wareh
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2PYDT    WZPYDT
     C                     MOVEL#2PYDT    WZPYDT           LH Carrier Paid
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@FJCPGU                  90*
     C  N82                READ @FJCPGU                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  2
     C                     MOVEAWKIND0    *IN,42
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2TLMI    IFNE *ZERO                      Total Load Mile
     C           FJTLMI    CABNE#2TLMI    BB020            Total Load Mile
     C                     END
     C           #2PKST    IFNE *BLANK                     Load Status
     C           FJPKST    CABNE#2PKST    BB020            Load Status
     C                     END
     C           #2J7DT    IFNE *ZERO                      BOL Complete Da
     C           FJJ7DT    CABNE#2J7DT    BB020            BOL Complete Da
     C                     END
     C           #2ZBVA    IFNE *ZERO                      Load Actual Fre
     C           FJZBVA    CABNE#2ZBVA    BB020            Load Actual Fre
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           FJQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
     C           #2SQNB    IFNE *ZERO                      Ld Hdr_Ld Dtl U
     C           FJSQNB    CABNE#2SQNB    BB020            Ld Hdr_Ld Dtl U
     C                     END
     C           #2RNST    IFEQ *BLANK                     LH Carrier Paym
     C           #2F9DT    OREQ *ZERO                      Actual Ship Dat
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           FJRMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C                     END
     C           #2RNST    IFEQ *BLANK                     LH Carrier Paym
     C           #2F9DT    IFNE *ZERO                      Actual Ship Dat
     C           FJF9DT    CABNE#2F9DT    BB020            Actual Ship Dat
     C                     END
     C                     END
     C           #2RNST    IFEQ *BLANK                     LH Carrier Paym
     C           #2F9DT    OREQ *ZERO                      Actual Ship Dat
     C           #2RMNB    OREQ *ZERO                      Load ID
     C           #2BZNA    IFNE *BLANK                     Carrier Code
     C           FJBZNA    CABNE#2BZNA    BB020            Carrier Code
     C                     END
     C                     END
     C           #2VDST    IFNE *BLANK                     Load Type
     C           FJVDST    CABNE#2VDST    BB020            Load Type
     C                     END
     C           #2U2ST    IFNE *BLANK                     Export Status
     C           FJU2ST    CABNE#2U2ST    BB020            Export Status
     C                     END
     C           #2LSHG    IFNE *BLANK                     Load Shag Flag
     C           FJLSHG    CABNE#2LSHG    BB020            Load Shag Flag
     C                     END
     C           #2YPST    IFNE *BLANK                     Load Wash Flag
     C           FJYPST    CABNE#2YPST    BB020            Load Wash Flag
     C                     END
     C           #2VPCD    IFNE *BLANK                     Ship From Wareh
     C           FJVPCD    CABNE#2VPCD    BB020            Ship From Wareh
     C                     END
     C           #2DBCD    IFNE *BLANK                     Ship To State C
     C           FJDBCD    CABNE#2DBCD    BB020            Ship To State C
     C                     END
     C           #2PYDT    IFNE *ZERO                      LH Carrier Paid
     C           FJPYDT    CABNE#2PYDT    BB020            LH Carrier Paid
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     Z-ADDFJR1NB    #RDEVL           Rated Freight 7
     C                     Z-ADDFJDGWG    #RDFVL           Total Freight 7
      * SEL:  Load ID
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Load ID is NE Blank
      *   |- c2    : RCD.Load ID NE CTL.Load ID
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2RMNB    IFNE *ZERO                      *IF
     C           #1RMNB    IFNE #2RMNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * ** Add quit so synon stops loading subfile fields for non-matchin
     C                     GOTO BBEXIT                     *QUIT
     C                     END                             *FI
      * SEL: Toggle Rated Freight = 0
      * CASE: LCL.Select Status is yes
     C           YL0003    IFEQ 'Y'                        *IF
      * CASE: RCD.Rated Freight 7.2 USR is Entered
     C           #RDEVL    IFNE *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Carrier Payment Entered
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0004    IFEQ 'Y'                        *IF
      * CASE: RCD.Total Freight 7.2 USR is Not Entered
     C           #RDFVL    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       #RKUSX           Charge Output S
     C                     MOVEL'N'       #RKVSX           Charge Output S
     C                     MOVEL'N'       #RKWSX           Charge Output S
     C                     MOVEL'N'       #RKXSX           Charge Output S
     C                     MOVEL'N'       #RQKST           Display Flag
      * Rtv Freight Charges   RT - Load Freight Charge  * 
     C                     EXSR SBRVGN
      * SEL: Ocean > 0
      * CASE: LCL.Status Flag 2  Y/N is Yes
     C           YL0005    IFEQ 'Y'                        *IF
      * CASE: RCD.Charge Amount 3 USR is Not Entered
     C           #RC9VL    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Continue if record selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1VPCD    WL0001    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #RWPST    P      Warehouse Type
      * SFL Fold/Drop  RPG 2  US - /UT User Source  * 
     C           MODE      IFEQ '0'
     C                     SETON                     89
     C                     ELSE
     C                     SETOF                     89
     C                     ENDIF
     C                     MOVEL'N'       #RDKTX           Status Flag 14
      * Output Charges 1 - 4
      * CASE:
      *  - c1ORc2
      *   |- c1    : RCD.LH Carrier Payment Sts is Paid
      *   |- c2    : RCD.MG Created Load is Yes
      *   '-
     C           #1RNST    IFEQ 'P'                        *IF
     C           #1RYSX    OREQ 'Y'                        *OR
     C                     MOVEL'Y'       #RDKTX           Status Flag 14
     C                     MOVEL'Y'       #RKUSX           Charge Output S
     C                     MOVEL'Y'       #RKVSX           Charge Output S
     C                     MOVEL'Y'       #RKWSX           Charge Output S
     C                     MOVEL'Y'       #RKXSX           Charge Output S
     C                     END                             *FI
      * Output Charge 1
      * CASE:
      *  - c1ORc2
      *   |- c1    : CTL.Charge Code 1 USR is Not Entered
      *   |- c2    : RCD.MG Created Load is Yes
      *   '-
     C           #CCGAA    IFEQ *BLANK                     *IF
     C           #1RYSX    OREQ 'Y'                        *OR
     C                     MOVEL'Y'       #RKUSX           Charge Output S
     C                     END                             *FI
      * Output Charge 2
      * CASE:
      *  - c1ORc2
      *   |- c1    : CTL.Charge Code 2 USR is Not Entered
      *   |- c2    : RCD.MG Created Load is Yes
      *   '-
     C           #CCHAA    IFEQ *BLANK                     *IF
     C           #1RYSX    OREQ 'Y'                        *OR
     C                     MOVEL'Y'       #RKVSX           Charge Output S
     C                     END                             *FI
      * Output Charge 3
      * CASE: CTL.Charge Code 3 USR is Not Entered
     C           #CCIAA    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       #RKWSX           Charge Output S
     C                     END                             *FI
      * ** Retrieve Export info from Order Header Extension
      * RTV ExpOrd Info for LD XF - Order Header TRG  * 
     C                     CALL 'PMJMXFR'              90  RTV ExpOrd Info
     C                     PARM *BLANK    W0RTN   7
     C           YL0006    PARM *ZERO     WQ0001  70       Order Number
     C           YL0007    PARM *ZERO     WQ0002  70       Ship To Custome
     C           YL0008    PARM *BLANK    WQ0003 30        Ship To Name
     C           YL0009    PARM *BLANK    WQ0004 30        Ship To Address
     C           YL0010    PARM *BLANK    WQ0005 30        Ship To Address
     C           YL0011    PARM *BLANK    WQ0006 30        Ship To Address
     C           YL0012    PARM *BLANK    WQ0007 20        Ship To City
     C           YL0013    PARM *BLANK    WQ0008  2        Ship To State C
     C           YL0014    PARM *BLANK    WQ0009 11        Ship To Zip_Pos
     C           YL0015    PARM *BLANK    WQ0010  3        Carrier Code
     C                     PARM #1RMNB    WQ0011  70       Load ID
     C           YL0016    PARM *BLANK    WQ0012  1        Export Status
     C           YL0017    PARM *BLANK    WQ0013  1        Export Docs Go
     C           YL0018    PARM *BLANK    WQ0014  1        Air Freight Ord
     C           YL0019    PARM *BLANK    WQ0015  2        Export USDA App
     C           YL0020    PARM *ZERO     WQ0016  30       Company Number
     C           YL0021    PARM *ZERO     WQ0017  50       Stop_Drop Seque
     C           YL0022    PARM *BLANK    WQ0018  3        Shipping Line
     C           YL0023    PARM *BLANK    WQ0019 20        Port Delv Termi
     C           YL0024    PARM *BLANK    WQ0020 25        OHE City
     C           YL0025    PARM *BLANK    WQ0021 30        OHE Vessel_Airl
     C           YL0026    PARM *BLANK    WQ0022 15        OHE Voyage_Flig
     C           YL0027    PARM *BLANK    WQ0023 15        OHE Booking Num
     C           YL0028    PARM *BLANK    WQ0024 20        OHE Discharge P
     C           YL0029    PARM *ZERO     WQ0025  70       OHE Sail_Flight
     C           YL0030    PARM *ZERO     WQ0026  70       OHE Port Cut Da
     C           YL0031    PARM *ZERO     WQ0027  70       OHE Arrival Dat
     C           YL0032    PARM *BLANK    WQ0028  3        OHE Late Delive
     C           YL0033    PARM *BLANK    WQ0029  1        OHE Ship Status
     C           YL0034    PARM *BLANK    WQ0030 12        OHE Container N
     C           YL0035    PARM *BLANK    WQ0031 35        OHE Comment 1
     C           YL0036    PARM *BLANK    WQ0032 75        OHE Comment 2
     C           YL0037    PARM *BLANK    WQ0033 25        Port City
     C           YL0038    PARM *BLANK    WQ0034 25        Port Address Li
     C           YL0039    PARM *BLANK    WQ0035 25        Port Address Li
     C           YL0040    PARM *BLANK    WQ0036  2        Sail Port State
     C           YL0041    PARM *BLANK    WQ0037 11        Port Zip/Postal
     C           YL0042    PARM *ZERO     WQ0038 110       Port Phone Numb
     C           YL0043    PARM *BLANK    WQ0039 25        Port Fax Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMJMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Validate if type code is 'ES' = Export Seaboard Bookings
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Company Number is greater than zero
      *   |- c2    : LCL.Ship To Customer is not equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0020    IFGT *ZERO                      *IF
     C           YL0007    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV All fields - Company Customer  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * ** International accounts
      * CASE: LCL.Ship To State Code is International Accounts
     C           YL0013    IFEQ '.'                        *IF
     C                     MOVELYL0013    #1DBCD           Ship To State C
     C                     MOVELYL0022    #1XACD           Shipping Line
     C                     MOVELYL0028    #1W4CD           Discharge Port
     C                     END                             *FI
      * Output Actual Freight
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : RCD.Ship To State Code is Not International
      *   |- c2    : RCD.LH Carrier Payment Sts is Paid
      *   |- c3    : RCD.Warehouse Type is Fresh
      *   '-
     C           #1DBCD    IFNE '.'                        *IF
     C           #1RNST    OREQ 'P'                        *OR
     C           #RWPST    OREQ 'FR'                       *OR
     C                     MOVEL'Y'       #RQKST           Display Flag
     C                     END                             *FI
      * SEL:  Payment Status
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.LH Carrier Payment Sts is Paid
      *   |- c2    : RCD.LH Carrier Payment Sts NE CTL.LH Carrier Payment
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2RNST    IFEQ 'P'                        *IF
     C           #1RNST    IFNE #2RNST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: Select Not Paid Loads
      *  - c1 AND c2
      *   |- c1    : CTL.LH Carrier Payment Sts is Select Not Paid
      *   |- c2    : RCD.LH Carrier Payment Sts is Paid
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2RNST    IFEQ '*'                        *IF
     C           #1RNST    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#RDFVL    #RDHVL           Value 7.2 USR
     C                     MOVEL'N'       WUHLSX           Reverse Image F
     C                     MOVEL'N'       WUHWSX           Change Flag USR
      * ** Hilite if not paid and ocean or air freight charges exist
      * CASE: RCD.LH Carrier Payment Sts is Not Paid
     C           #1RNST    IFEQ *BLANK                     *IF
      * ** If ShipToState = ".", or if Export Load has Air Freight
      * CASE: RCD.Ship To State Code is International Accounts
     C           #1DBCD    IFEQ '.'                        *IF
     C                     MOVEL'Y'       WUHLSX           Reverse Image F
     C                     ELSE
      * CASE: RCD.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * CHK Air Frt Order      RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0003           Load ID
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUFTSX    P      Air Freight Ord
      * ** Reverse Image if Load has an Air Freight order
      * CASE: WRK.Air Freight Order is yes
     C           WUFTSX    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUHLSX           Reverse Image F
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Hilite if Override miles exist and put on screen   E00207
      * CASE: DB1.Override Total Load Miles is Entered
     C           FJK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDFJK2DT    #1TLMI           Total Load Mile
     C                     MOVEL'Y'       WUHWSX           Change Flag USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     END                             *FI
     C                     END                             *FI
      * USR Total Due
      * RCD.USR Total Due =
      *    *COMPUTE (x1 + x2)
      * x1    : RCD.Total Freight USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : RCD.Shag/Wash Charge USR
     C           #RDJVL    ADD  #RDDVL    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    #RV7VA           USR Total Due
      * Rtv Ld ShpCo/MultiCo  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0005           Load ID
     C                     Z-ADDYL0045    WL0006           Company Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0045           Company Number
     C                     MOVELWL0007    #1RVSX    P      Multi Company L
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @FJCPGU                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Actual Ship Date
      * External date
     C                     Z-ADDV2F9DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     Z-ADDXDINDT    #2F9DT
      * Validate LH Carrier Payment Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2RNST'  IFEQ YPMTFD
      * LH Carrier Payment Sts
     C                     MOVEL#2RNST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFRNST
     C                     SELEC
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD1         ZFRNST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD2         ZFRNST
     C           W0INVL    WHEQ '*'                        *
     C                     Z-ADD3         ZFRNST
     C                     ENDSL
     C                     EXFMTZERNST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFRNST    WHEQ 1
     C                     MOVEL'P'       W0INVL           P
     C           ZFRNST    WHEQ 2
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFRNST    WHEQ 3
     C                     MOVEL'*'       W0INVL           *
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2RNST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Export Status
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2U2ST    W0NSRQ  1        Export Status
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2U2ST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158374   Y2LSNO  70
     C           #2U2ST    PARM #2U2ST    W0EXVL 25        Export Status
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Load Shag Flag
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2LSHG    W0NSRQ  1        Load Shag Flag
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2LSHG'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158374   Y2LSNO  70
     C           #2LSHG    PARM #2LSHG    W0EXVL 25        Load Shag Flag
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Load Wash Flag
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2YPST    W0NSRQ  1        Load Wash Flag
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2YPST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158374   Y2LSNO  70
     C           #2YPST    PARM #2YPST    W0EXVL 25        Load Wash Flag
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate LH Carrier Paid Dte
      * External date
     C                     Z-ADDV2PYDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     Z-ADDXDINDT    #2PYDT
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZF9DT    CASNE#2F9DT    FBRQRL
     C           WZBZNA    CASNE#2BZNA    FBRQRL
     C           WZRNST    CASNE#2RNST    FBRQRL
     C           WZVDST    CASNE#2VDST    FBRQRL
     C           WZU2ST    CASNE#2U2ST    FBRQRL
     C           WZLSHG    CASNE#2LSHG    FBRQRL
     C           WZYPST    CASNE#2YPST    FBRQRL
     C           WZVPCD    CASNE#2VPCD    FBRQRL
     C           WZDBCD    CASNE#2DBCD    FBRQRL
     C           WZPYDT    CASNE#2PYDT    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * F08 toggle Rated Freight
      * CASE: CTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
      * CASE: LCL.Select Status is yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0003           Select Status
     C                     ELSE
      * CASE: LCL.Select Status is no
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0003           Select Status
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F10 toggle Carrier Payment = 0
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0004           Status Flag 1
     C                     ELSE
      * CASE: LCL.Status Flag 1  Y/N is No
     C           YL0004    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0004           Status Flag 1
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F11 toggle Ocean > 0
      * CASE: CTL.*CMD key is CF11
     C           *IN11     IFEQ '1'                        *IF
      * CASE: LCL.Status Flag 2  Y/N is Yes
     C           YL0005    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0005           Status Flag 2
     C                     ELSE
      * CASE: LCL.Status Flag 2  Y/N is No
     C           YL0005    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0005           Status Flag 2
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F13 toggle Payment Status
      * CASE: CTL.*CMD key is CF13
     C           *IN13     IFEQ '1'                        *IF
      * CASE: CTL.LH Carrier Payment Sts is Select Not Paid
     C           #2RNST    IFEQ '*'                        *IF
     C                     MOVEL'P'       #2RNST           LH Carrier Paym
     C                     ELSE
      * CASE: CTL.LH Carrier Payment Sts is Paid
     C           #2RNST    IFEQ 'P'                        *IF
     C                     MOVEL'*'       #2RNST           LH Carrier Paym
     C                     ELSE
      * CASE: CTL.LH Carrier Payment Sts is Not Paid
     C           #2RNST    IFEQ *BLANK                     *IF
     C                     MOVEL'*'       #2RNST           LH Carrier Paym
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * SFL Fold/Drop  RPG 2  US - /UT User Source  * 
     C           MODE      IFEQ '0'
     C                     SETON                     89
     C                     ELSE
     C                     SETOF                     89
     C                     ENDIF
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,42
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * ** Update Stop, Unload and Ocean charges, Total Frt, and Carrier
      * CASE: RCD.MG Created Load is Yes
     C           #1RYSX    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : RCD.*SFLSEL is Option 5
      *   |- c2    : RCD.*SFLSEL is Option 2
      *   '-
     C           #1SEL     IFEQ ' 5'                       *IF
     C           #1SEL     OREQ '5'
     C           #1SEL     OREQ '2'                        *OR
     C           #1SEL     OREQ ' 2'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0001           *SFLSEL
      * Send message 'Live TMS Option Invalid'
     C                     MOVEL'USR4601' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * 1=ReCalculate Rated Freight
      * CASE: RCD.*SFLSEL is Option 1
     C           #1SEL     IFEQ '1'                        *IF
     C           #1SEL     OREQ ' 1'
      * Calculate Rated Freight & Update Order Files
      * UPD Rated Frt Post Shp XF - Load Detail  * 
     C                     CALL 'PDJVXFR'              90  UPD Rated Frt P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0040  70       Load ID
     C                     PARM #1AIC3    WQ0041  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Update Sales History
      * Upd Fix Rated Freight RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0008           Load ID
     C                     EXSR SGRVGN
     C                     END                             *FI
      * 2=Edit Charge
      * CASE: RCD.*SFLSEL is *Edit
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * ** Rtv load miles and override miles for this load and pass
      * ** to the edit routine, rcd context may have either value in it
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR SKRVGN
      * Edt Load Frt Charge   EF - Load Freight Charge  * 
     C                     CALL 'POLSEFR'              90  Edt Load Frt Ch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0042  70       Load ID
     C                     PARM #1RRNB    WQ0043  50       Total Stops
     C                     PARM #1BZNA    WQ0044  3        Carrier Code
     C                     PARM #1R1NB    WQ0045 112       Rated Freight
     C                     PARM WUTLMI    WQ0046  70       Total Load Mile
     C                     PARM #1RNST    WQ0047  1        LH Carrier Paym
     C                     PARM WUK2DT    WQ0048  70       Override Total
     C                     PARM #1R3SX    WQ0049  3        LH On-Time Reas
     C                     PARM #1R4SX    WQ0050  3        LH Held Over Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POLSEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: RCD.LH Carrier Payment Sts is Not Paid
     C           #1RNST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * 5=Display Load Detail
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * DSP Load Plan          DF - Load Detail  * 
     C                     CALL 'PDSLDFR'              90  DSP Load Plan
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0051  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSLDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'N'       W0RSF            *Reload subfile
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * 7=Create Auto Charges
      * CASE: RCD.*SFLSEL is Option 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * CASE: RCD.LH Carrier Payment Sts is Paid
     C           #1RNST    IFEQ 'P'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0002           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9842  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Pass Override Miles                    E00207
      * Clc Freight Charges   XF - Freight Charge  * 
     C                     CALL 'POL2XFR'              90  Clc Freight Cha
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0052  70       Load ID
     C                     PARM #1AIC3    WQ0053  30       Company Number
     C                     PARM #1AODT    WQ0054  70       Scheduled Ship
     C                     PARM #1PKST    WQ0055  1        Load Status
     C                     PARM #1FLAM    WQ0056 112       Flat Amount
     C                     PARM #1RRNB    WQ0057  50       Total Stops
     C                     PARM #1BZNA    WQ0058  3        Carrier Code
     C                     PARM #1VDST    WQ0059  1        Load Type
     C                     PARM #1TLMI    WQ0060  70       Total Load Mile
     C                     PARM #1Q2CD    WQ0061  2        Shipping Method
     C                     PARM #1VPCD    WQ0062  3        Ship From Wareh
     C                     PARM #1DBCD    WQ0063  2        Ship To State C
     C                     PARM #1U2ST    WQ0064  1        Export Status
     C                     PARM #1J7DT    WQ0065  70       BOL Complete Da
     C                     PARM #1XACD    WQ0066  3        Shipping Line
     C                     PARM #1W4CD    WQ0067 20        Discharge Port
     C                     PARM #1LSHG    WQ0068  1        Load Shag Flag
     C                     PARM #1YPST    WQ0069  1        Load Wash Flag
     C                     PARM #1K2DT    WQ0070  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POL2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Carrier Payment, Check Export Sts to determine update process
      * CASE: RCD.Total Freight 7.2 USR NE RCD.Value 7.2 USR
     C           #RDFVL    IFNE #RDHVL                     *IF
      * ** If an Export, check for Air Freight
      * CASE: RCD.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * CHK Air Frt Order      RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0003           Load ID
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUFTSX    P      Air Freight Ord
      * RTV FR/FZ sts for Ord RT - Order Header TRG  * *RMC 11/9/6 Get fr
     C                     EXSR SLRVGN
      * ** Leave unpaid if International and Frozen & has Air Freight
      * CASE:
      *  - c1 OR (c2 AND c3 AND NOTc4)
      *   |- c1    : WRK.Air Freight Order is yes
      *   |- c2    : RCD.Ship To State Code is International Accounts
      *   |- c3    : LCL.Chilled/Frozen Sts USR is Frozen
      *   |- c4    : LCL.Type Code is Export Seaboard Bookings
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUFTSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #1DBCD    IFEQ '.'                        *IF
     C           YL0046    IFEQ 'F'                        *IF
     C           YL0044    IFEQ 'ES'                       *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 11/9/6 TRF015
      * Added c3  -- Intl and Frozen are Not marked as paid. Chilled (fre
     C                     MOVEL*BLANK    #1RNST           LH Carrier Paym
      * TRF015 RMC 11/15/06 Alloc Carrier Frt when still Unpaid
      * CASE: RCD.Total Freight 7.2 USR is Entered
     C           #RDFVL    IFNE *ZERO                      *IF
      *        The Actual Freight will be allocated when Paid
      * VAL Load ID in History RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0009           Load ID
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * UPD Alloc Frt to Hist  XF - Load Header  * 
     C                     CALL 'PLABXFR'              90  UPD Alloc Frt t
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0071  70       Load ID
     C                     PARM #RDFVL    WQ0072 112       Flat Amount
     C                     PARM #RDFVL    WQ0073 112       Load Total Frei
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLABXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     984343*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If export has no Air Freight, update payment sts flag and
      * ** update Sales History with distributed Actual and Ref Freight
     C                     MOVEL'P'       #1RNST           LH Carrier Paym
      * RMC 10/10/06 pass into Flat Amount the Rcd.actual frt tot usr
      *      instead of total freight usr
      * VAL Load ID in History RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0009           Load ID
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * UPD Alloc Frt to Hist  XF - Load Header  * 
     C                     CALL 'PLABXFR'              90  UPD Alloc Frt t
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0074  70       Load ID
     C                     PARM #RDCVL    WQ0075 112       Flat Amount
     C                     PARM #RDJVL    WQ0076 112       Load Total Frei
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLABXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If no export then update payment sts flag and
      * ** update Sales History with distributed Actual and Air Freight
     C                     MOVEL'P'       #1RNST           LH Carrier Paym
      * RMC 10/10/06 pass into Flat Amount the Rcd.actual frt tot usr
      *      instead of total freight usr
      * VAL Load ID in History RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0009           Load ID
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * UPD Alloc Frt to Hist  XF - Load Header  * 
     C                     CALL 'PLABXFR'              90  UPD Alloc Frt t
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0077  70       Load ID
     C                     PARM #RDCVL    WQ0078 112       Flat Amount
     C                     PARM #RDJVL    WQ0079 112       Load Total Frei
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLABXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * ** Update Load Header with the Actual Freight that is being paid
      * ** not the total freight charges. Update the Carrier Payment with
      * ** the amount entered on the screen. Update the payment status.
      * Upd Ld ActFrt/CarPay  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0010           Load ID
     C                     Z-ADD#RDFVL    WL0011           Load Carrier Pa
     C                     Z-ADD#RDJVL    WL0012           Load Total Frei
     C                     MOVEL#1RNST    WL0013    P      LH Carrier Paym
     C                     Z-ADD#RDCVL    WL0014           Load Actual Fre
     C                     EXSR SORVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * 8=Mark Paid & Alloc Frt
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * ** Update Sales History with distributed Actual and Air Freight
      * RMC 10/6/6 was passing the rcd.total freight usr into the Flat Am
      *         should pass the rcd.actual frt tot usr into the Flat Amou
      *         which is the same actual frt amount that goes to the Load
      * UPD Alloc Frt to Hist  XF - Load Header  * 
     C                     CALL 'PLABXFR'              90  UPD Alloc Frt t
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0080  70       Load ID
     C                     PARM #RDCVL    WQ0081 112       Flat Amount
     C                     PARM #RDJVL    WQ0082 112       Load Total Frei
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLABXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** Update Load Header with the Actual Freight that is being paid
      * ** not the total freight charges. Update the Carrier Payment with
      * ** the amount entered on the screen. Mark Paid.
      * Upd Ld ActFrt/CarPay  RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0010           Load ID
     C                     Z-ADD#RDFVL    WL0011           Load Carrier Pa
     C                     Z-ADD#RDJVL    WL0012           Load Total Frei
     C                     MOVEL'P'       WL0013    P      LH Carrier Paym
     C                     Z-ADD#RDCVL    WL0014           Load Actual Fre
     C                     EXSR SORVGN
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * 9=Mark Unpaid
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * ** UPDATE all of the charges as UnPaid.
      * Upd Carrier Pay Sts   RT - Load Header  * 
     C                     EXSR SQRVGN
      * TRF015 RMC 11/16/06 Alloc Carrier Freight when marked UnPaid
      * CASE: RCD.Total Freight 7.2 USR is Entered
     C           #RDFVL    IFNE *ZERO                      *IF
      *      The Actual Freight will be allocated when Paid
      * VAL Load ID in History RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0009           Load ID
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * UPD Alloc Frt to Hist  XF - Load Header  * 
     C                     CALL 'PLABXFR'              90  UPD Alloc Frt t
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0083  70       Load ID
     C                     PARM #RDFVL    WQ0084 112       Flat Amount
     C                     PARM #RDFVL    WQ0085 112       Load Total Frei
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLABXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     984343*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * 10=Edit Rated Freight
      * CASE: RCD.*SFLSEL is Option 10
     C           #1SEL     IFEQ '10'                       *IF
      * ** Pass Override Miles in                  E00207
      * EDT Calc Rated Freight ET - Load Header  * 
     C                     CALL 'PDYLETR'              90  EDT Calc Rated
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0086  70       Load ID
     C                     PARM #1RPNB    WQ0087  70       Total Load Orde
     C           #1FLAM    PARM #1FLAM    WQ0088 112       Flat Amount
     C           #1XQST    PARM #1XQST    WQ0089  1        Allocate Pounds
     C                     PARM #1BZNA    WQ0090  3        Carrier Code
     C           #1R1NB    PARM #1R1NB    WQ0091 112       Rated Freight
     C           #1TLMI    PARM #1TLMI    WQ0092  70       Total Load Mile
     C                     PARM #1VPCD    WQ0093  3        Ship From Wareh
     C                     PARM #1DBCD    WQ0094  2        Ship To State C
     C                     PARM #1XCCD    WQ0095  3        Carrier Broker
     C           #1K2DT    PARM #1K2DT    WQ0096  70       Override Total
     C                     PARM P1ADTX    WQ0097 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDYLETR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Update Sales History
      * Upd Fix Rated Freight RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0008           Load ID
     C                     EXSR SGRVGN
     C                     END                             *FI
      * 12=Calc Miles
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
      * EDT Stop Miles         EF - OM Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW7EFR'              90  EDT Stop Miles
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW7EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 77=Create Auto Charges
      * CASE: RCD.*SFLSEL is Option 77
     C           #1SEL     IFEQ '77'                       *IF
      * ** Pass in Override Miles                          E00207
      * Clc Freight Charges   XF - Freight Charge  * 
     C                     CALL 'POL2XFR'              90  Clc Freight Cha
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0098  70       Load ID
     C                     PARM #1AIC3    WQ0099  30       Company Number
     C                     PARM #1AODT    WQ0100  70       Scheduled Ship
     C                     PARM #1PKST    WQ0101  1        Load Status
     C                     PARM #1FLAM    WQ0102 112       Flat Amount
     C                     PARM #1RRNB    WQ0103  50       Total Stops
     C                     PARM #1BZNA    WQ0104  3        Carrier Code
     C                     PARM #1VDST    WQ0105  1        Load Type
     C                     PARM #1TLMI    WQ0106  70       Total Load Mile
     C                     PARM #1Q2CD    WQ0107  2        Shipping Method
     C                     PARM #1VPCD    WQ0108  3        Ship From Wareh
     C                     PARM #1DBCD    WQ0109  2        Ship To State C
     C                     PARM #1U2ST    WQ0110  1        Export Status
     C                     PARM #1J7DT    WQ0111  70       BOL Complete Da
     C                     PARM #1XACD    WQ0112  3        Shipping Line
     C                     PARM #1W4CD    WQ0113 20        Discharge Port
     C                     PARM #1LSHG    WQ0114  1        Load Shag Flag
     C                     PARM #1YPST    WQ0115  1        Load Wash Flag
     C                     PARM #1K2DT    WQ0116  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POL2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * 90=Allocate Freight
      * CASE: RCD.*SFLSEL is Option 90
     C           #1SEL     IFEQ '90'                       *IF
      * UPD Alloc Frt to Hist  XF - Load Header  * 
     C                     CALL 'PLABXFR'              90  UPD Alloc Frt t
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0117  70       Load ID
     C                     PARM #RDCVL    WQ0118 112       Flat Amount
     C                     PARM #RDJVL    WQ0119 112       Load Total Frei
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLABXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN79
     C           #1RVSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUHLSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           #RDKTX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           WUHWSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPGU fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     MOVELFJJ8TX    #1J8TX           Car_Veh. Initia
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJONTM    #1ONTM           On Time (Y_N)
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U_M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1F9DT
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
      * Clear external version also
     C                     Z-ADD*ZERO     V1J7DT
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
      * Clear external version also
     C                     Z-ADD*ZERO     V1PYDT
     C                     MOVEL*BLANK    #RKMSX           Additional Char
     C                     MOVEL*BLANK    #RKUSX           Charge Output S
     C                     MOVEL*BLANK    #RKVSX           Charge Output S
     C                     MOVEL*BLANK    #RQKST           Display Flag
     C                     Z-ADD*ZERO     #RDIVL           Actual Frt Tot
     C                     MOVEL*BLANK    #RKWSX           Charge Output S
     C                     MOVEL*BLANK    #RKXSX           Charge Output S
     C                     MOVEL*BLANK    #RDKTX           Status Flag 14
     C                     Z-ADD*ZERO     #RDHVL           Value 7.2 USR
     C                     MOVEL*BLANK    #RWPST           Warehouse Type
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RDEVL           Rated Freight 7
     C                     Z-ADD*ZERO     #RC6VL           Fuel Surcharge
     C                     Z-ADD*ZERO     #RC7VL           Charge Amount 1
     C                     Z-ADD*ZERO     #RC8VL           Charge Amount 2
     C                     Z-ADD*ZERO     #RC9VL           Charge Amount 3
     C                     Z-ADD*ZERO     #RDBVL           Actual Frt Othe
     C                     Z-ADD*ZERO     #RDCVL           Actual Frt Tot
     C                     Z-ADD*ZERO     #RDGVL           Freight Other T
     C                     Z-ADD*ZERO     #RDJVL           Total Freight U
     C                     Z-ADD*ZERO     #RDDVL           Shag/Wash Charg
     C                     Z-ADD*ZERO     #RDFVL           Total Freight 7
     C                     Z-ADD*ZERO     #RV7VA           USR Total Due
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADD*ZERO     #2TLMI           Total Load Mile
     C                     MOVEL*BLANK    #2PKST           Load Status
     C                     Z-ADD*ZERO     #2J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     #2ZBVA           Load Actual Fre
     C                     MOVEL*BLANK    #2Q2CD           Shipping Method
     C                     Z-ADD*ZERO     #2SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     Z-ADD*ZERO     #2F9DT           Actual Ship Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V2F9DT
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    #2RNST           LH Carrier Paym
     C                     Z-ADD*ZERO     #CDEVL           Rated Freight 7
     C                     Z-ADD*ZERO     #CC6VL           Fuel Surcharge
     C                     MOVEL*BLANK    #CCGAA           Charge Code 1 U
     C                     MOVEL*BLANK    #CCHAA           Charge Code 2 U
     C                     MOVEL*BLANK    #CCIAA           Charge Code 3 U
     C                     Z-ADD*ZERO     #CDBVL           Actual Frt Othe
     C                     Z-ADD*ZERO     #CDCVL           Actual Frt Tot
     C                     Z-ADD*ZERO     #CDGVL           Freight Other T
     C                     Z-ADD*ZERO     #CDJVL           Total Freight U
     C                     Z-ADD*ZERO     #CDDVL           Shag/Wash Charg
     C                     Z-ADD*ZERO     #CDFVL           Total Freight 7
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     MOVEL*BLANK    #2U2ST           Export Status
     C                     MOVEL*BLANK    #2LSHG           Load Shag Flag
     C                     MOVEL*BLANK    #2YPST           Load Wash Flag
     C                     MOVEL*BLANK    #2VPCD           Ship From Wareh
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #2PYDT           LH Carrier Paid
      * Clear external version also
     C                     Z-ADD*ZERO     V2PYDT
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Actual Ship Date to display format
      * Convert date
     C           1000000   ADD  #1F9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1F9DT
      * Convert BOL Complete Date to display format
      * Convert date
     C           1000000   ADD  #1J7DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1J7DT
      * Convert LH Carrier Paid Dte to display format
      * Convert date
     C           1000000   ADD  #1PYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1PYDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Actual Ship Date to display format
      * Convert date
     C           1000000   ADD  #2F9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2F9DT
      * Convert LH Carrier Paid Dte to display format
      * Convert date
     C           1000000   ADD  #2PYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2PYDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Edit Freight Hdg  RT - Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #CCGAA           Charge Code 1 U
     C                     MOVEL*BLANK    #CCHAA           Charge Code 2 U
     C                     MOVEL*BLANK    #CCIAA           Charge Code 3 U
      * Establish starting position
     C           *LOVAL    SETLL@A9REJZ                    *
     C                     READ @A9REJZ                  90*
      * Data record not found
     C   90                MOVEL'USR3052' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.FC Edit Sequence is One
     C           A9KRSX    IFEQ '1'                        *IF
     C                     MOVELA9CDAA    #CCGAA           Charge Code 1 U
     C                     ELSE
      * CASE: DB1.FC Edit Sequence is Two
     C           A9KRSX    IFEQ '2'                        *IF
     C                     MOVELA9CDAA    #CCHAA           Charge Code 2 U
     C                     ELSE
      * CASE: DB1.FC Edit Sequence is Three
     C           A9KRSX    IFEQ '3'                        *IF
     C                     MOVELA9CDAA    #CCIAA           Charge Code 3 U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @A9REJZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Freight Charges   RT - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RC6VL           Fuel Surcharge
     C                     Z-ADD*ZERO     #RC7VL           Charge Amount 1
     C                     Z-ADD*ZERO     #RC8VL           Charge Amount 2
     C                     Z-ADD*ZERO     #RDBVL           Actual Frt Othe
     C                     Z-ADD*ZERO     #RDCVL           Actual Frt Tot
     C                     Z-ADD*ZERO     #RDDVL           Shag/Wash Charg
     C                     Z-ADD*ZERO     #RC9VL           Charge Amount 3
     C                     Z-ADD*ZERO     #RDGVL           Freight Other T
     C                     Z-ADD*ZERO     #RDJVL           Total Freight U
     C                     Z-ADD#1R1NB    #RDCVL           Actual Frt Tot
     C                     Z-ADD#1R1NB    #RDJVL           Total Freight U
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN BCRMNB    WQSB01           Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSB01           Load ID
      * Establish starting position
     C           KRSSB     SETLL@BCCPJ8                    *
     C           KRSSB     READE@BCCPJ8                  90*
      * Data record not found
     C   90                MOVEL'USR3058' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Total Freight
      * CASE: DB1.LFC Tot Freight Inc Sts is Yes
     C           BCKSSX    IFEQ 'Y'                        *IF
     C                     ADD  BCC5VL    #RDJVL           Total Freight U
     C                     END                             *FI
      * Accum into buckets
      * CASE: DB1.LFC Special Type is Fuel Surcharge Component
     C           BCKTSX    IFEQ 'F'                        *IF
     C           BCKTSX    OREQ 'R'
     C           BCKTSX    OREQ 'S'
     C                     ADD  BCC5VL    #RC6VL           Fuel Surcharge
      * CASE: DB1.LFC Act Frt Include Sts is Yes
     C           BCKBSX    IFEQ 'Y'                        *IF
     C                     ADD  BCC5VL    #RDCVL           Actual Frt Tot
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.LFC Shag/Wash Comp is Shag/Wash
     C           BCKGSX    IFEQ 'S'                        *IF
     C           BCKGSX    OREQ 'W'
     C                     ADD  BCC5VL    #RDDVL           Shag/Wash Charg
     C                     ELSE
      * CASE: DB1.FC Code EQ PAR.Charge Code 1 USR
     C           BCCDAA    IFEQ #CCGAA                     *IF
     C                     ADD  BCC5VL    #RC7VL           Charge Amount 1
      * CASE: DB1.LFC Act Frt Include Sts is Yes
     C           BCKBSX    IFEQ 'Y'                        *IF
     C                     ADD  BCC5VL    #RDCVL           Actual Frt Tot
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Code EQ PAR.Charge Code 2 USR
     C           BCCDAA    IFEQ #CCHAA                     *IF
     C                     ADD  BCC5VL    #RC8VL           Charge Amount 2
      * CASE: DB1.LFC Act Frt Include Sts is Yes
     C           BCKBSX    IFEQ 'Y'                        *IF
     C                     ADD  BCC5VL    #RDCVL           Actual Frt Tot
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Code EQ PAR.Charge Code 3 USR
     C           BCCDAA    IFEQ #CCIAA                     *IF
     C                     ADD  BCC5VL    #RC9VL           Charge Amount 3
      * CASE: DB1.LFC Act Frt Include Sts is Yes
     C           BCKBSX    IFEQ 'Y'                        *IF
     C                     ADD  BCC5VL    #RDCVL           Actual Frt Tot
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.FC Code is Fuel -- MG created
     C           BCCDAA    IFEQ 'FUE'                      *IF
     C                     ADD  BCC5VL    #RC6VL           Fuel Surcharge
      * CASE: DB1.LFC Act Frt Include Sts is Yes
     C           BCKBSX    IFEQ 'Y'                        *IF
     C                     ADD  BCC5VL    #RDCVL           Actual Frt Tot
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.LFC Act Frt Include Sts is Yes
     C           BCKBSX    IFEQ 'Y'                        *IF
     C                     ADD  BCC5VL    #RDBVL           Actual Frt Othe
     C                     ADD  BCC5VL    #RDCVL           Actual Frt Tot
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  BCC5VL    #RDGVL           Freight Other T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BCCPJ8                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Warehouse Type
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0002           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV All fields - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0020    EOAIC3           Company Number
     C                     Z-ADDYL0007    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELEOBOCD    YL0044           Type Code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * CHK Air Frt Order      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSE02           Load ID
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE02           Load ID
      * Setup key
     C                     Z-ADDWL0003    WQSE02           Load ID
      * Establish starting position
     C           KRSSE     SETLL@BFCPRQ                    *
     C           KRSSE     READE@BFCPRQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Air Freight Ord
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Load parms and quit if this is an air freight order
      * CASE: DB1.Air Freight Order is yes
     C           BEFTSX    IFEQ 'Y'                        *IF
      * PAR = DB1 By name
     C                     MOVELBEFTSX    WL0004           Air Freight Ord
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SEEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Air Freight Ord
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C           KRSSE     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Ld ShpCo/MultiCo  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0007           Multi Company L
     C                     Z-ADD*ZERO     WL0006           Company Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSF01           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Load ID
      * Setup key
     C                     Z-ADDWL0005    WQSF01           Load ID
      * Establish starting position
     C           KRSSF     SETLL@FLCPBW                    *
     C           KRSSF     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Company Number is Equal to zero
     C           WL0006    IFEQ 0                          *IF
     C                     Z-ADDFLAIC3    WL0006           Company Number
     C                     END                             *FI
      * CASE: PAR.Company Number NE DB1.Company Number
     C           WL0006    IFNE FLAIC3                     *IF
     C                     MOVEL'Y'       WL0007           Multi Company L
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Upd Fix Rated Freight RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSG02           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Load ID
      * Setup key
     C                     Z-ADDWL0008    WQSG02           Load ID
      * Establish starting position
     C           KRSSG     SETLL@BFCPRQ                    *
     C           KRSSG     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Upd Fix Rated Freight RT - Order Detail  * 
     C                     EXSR SHRVGN
     C           KRSSG     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Upd Fix Rated Freight RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSH01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSH02           Order Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSH01           Company Number
     C                     Z-ADDBEC4NB    WQSH02           Order Number
      * Establish starting position
     C           KRSSH     SETLL@BGWKL1                    *
     C           KRSSH     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Upd Fix Rated Freight RT - Sales History  * 
     C                     EXSR SIRVGN
     C           KRSSH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Fix Rated Freight RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           F4AIC3           Company Number
     C                     KFLD           F4C4NB           Order Number
     C                     KFLD           F4DPNB           Order Sequence
     C                     KFLD           F4UENB           Order Secondary
      * Setup key
     C                     Z-ADDOMAIC3    F4AIC3           Company Number
     C                     Z-ADDOMC4NB    F4C4NB           Order Number
     C                     Z-ADDOMDPNB    F4DPNB           Order Sequence
     C                     Z-ADDOMUENB    F4UENB           Order Secondary
      * Establish starting position
     C           KRSSI     CHAIN@FHSTD3              90    *
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Fix Rated Freight CH - Sales History  * 
     C                     EXSR SJCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Fix Rated Freight CH - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 20        A_R City
     C                     MOVEL*BLANK    WN0002  2        A_R State
     C                     MOVEL*BLANK    WN0003  6        A_R County Code
     C                     MOVEL*BLANK    WN0004 11        A_R Zip_Postal
     C                     MOVEL*BLANK    WN0005 25        Alpha Search
     C                     MOVEL*BLANK    WN0006  6        Country Code
     C                     MOVEL*BLANK    WN0007  2        Type Code
     C                     Z-ADD*ZERO     WN0008  70       Parent Customer
     C                     Z-ADD*ZERO     WN0009  70       AR Customer Num
     C                     MOVEL*BLANK    WN0010 30        AR Customer Nam
     C                     Z-ADD*ZERO     WN0011  70       Ship To Custome
     C                     MOVEL*BLANK    WN0012 30        Ship To Name
     C                     MOVEL*BLANK    WN0013 20        Ship To City
     C                     MOVEL*BLANK    WN0014  2        Ship To State C
     C                     MOVEL*BLANK    WN0015 11        Ship To Zip_Pos
     C                     MOVEL*BLANK    WN0016 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0017  70       Order Date
     C                     Z-ADD*ZERO     WN0018  70       Cancel Date
     C                     MOVEL*BLANK    WN0019  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0020  3        Original Salesp
     C                     MOVEL*BLANK    WN0021  2        Manager Level C
     C                     MOVEL*BLANK    WN0022  3        VP Level Code
     C                     MOVEL*BLANK    WN0023  2        Terms Code
     C                     Z-ADD*ZERO     WN0024  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0025  3        Carrier Code
     C                     MOVEL*BLANK    WN0026  3        Order Header Re
     C                     MOVEL*BLANK    WN0027  2        Order Type_Sale
     C                     MOVEL*BLANK    WN0028  2        Shipping Method
     C                     MOVEL*BLANK    WN0029  1        Export Status
     C                     Z-ADD*ZERO     WN0030  70       Attach to Invoi
     C                     Z-ADD*ZERO     WN0031  70       Attach to Order
     C                     Z-ADD*ZERO     WN0032  70       Resell Referenc
     C                     Z-ADD*ZERO     WN0033  70       Original Item
     C                     MOVEL*BLANK    WN0034  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0035 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0036 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0037 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0038 112       Weight Schedule
     C                     MOVEL*BLANK    WN0039  2        U_M_Ordered
     C                     Z-ADD*ZERO     WN0040 114       Unit Price
     C                     Z-ADD*ZERO     WN0041 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0042  2        U_M_Base Price
     C                     Z-ADD*ZERO     WN0043  70       Requested Ship
     C                     Z-ADD*ZERO     WN0044  70       Invoice Date
     C                     Z-ADD*ZERO     WN0045  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0048 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0049 112       Extended Amount
     C                     MOVEL*BLANK    WN0050  1        Affect Inventor
     C                     MOVEL*BLANK    WN0051  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0052  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0053  70       Contract Number
     C                     MOVEL*BLANK    WN0054  6        Export Country
     C                     Z-ADD*ZERO     WN0055  70       LD Arrival Date
     C                     Z-ADD*ZERO     WN0056  40       Accounting Year
     C                     Z-ADD*ZERO     WN0057  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0058  30       OM Week
     C                     Z-ADD*ZERO     WN0059 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0060 112       Weight Billed
     C                     Z-ADD*ZERO     WN0061  70       Shipped Item Co
     C                     Z-ADD*ZERO     WN0062 112       Billing Detail
     C                     Z-ADD*ZERO     WN0063 112       Billing Detail
     C                     Z-ADD*ZERO     WN0064 112       FOB Gross Amoun
     C                     Z-ADD*ZERO     WN0065 112       Standard Overag
     C                     Z-ADD*ZERO     WN0066 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0067  80       GL Document Num
     C                     MOVEL*BLANK    WN0068  1        GL Update Statu
     C                     Z-ADD*ZERO     WN0069  30       Shipping Compan
     C                     MOVEL*BLANK    WN0070  3        Order Detail Re
     C                     Z-ADD*ZERO     WN0071 114       Price Overage O
     C                     MOVEL*BLANK    WN0072  3        Date Method Cod
     C                     MOVEL*BLANK    WN0073  3        Price Method Co
     C                     Z-ADD*ZERO     WN0074  70       Market Pricing
     C                     MOVEL*BLANK    WN0075  3        Commodity Marke
     C                     MOVEL*BLANK    WN0076  2        Quality Level
     C                     MOVEL*BLANK    WN0077  2        Item Level
     C                     Z-ADD*ZERO     WN0078  30       Item Structure
     C                     Z-ADD*ZERO     WN0079  30       Item Structure
     C                     Z-ADD*ZERO     WN0080  30       Item Structure
     C                     Z-ADD*ZERO     WN0081  70       Invoice Number
     C                     MOVEL*BLANK    WN0082  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0083  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0084  70       Load ID
     C                     Z-ADD*ZERO     WN0085  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0086  3        Packaging Code
     C                     MOVEL*BLANK    WN0087  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0088  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0089  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0090  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0091 30        Order Desc. Lin
     C                     Z-ADD*ZERO     WN0092 112       Actual Freight
     C                     MOVEL*BLANK    WN0093  3        Item Type Code
     C                     Z-ADD*ZERO     WN0094  30       PM Raw Material
     C                     Z-ADD*ZERO     WN0095  50       PM Line Number
     C                     MOVEL*BLANK    WN0096  3        SH Unused_was b
     C                     Z-ADD*ZERO     WN0097  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0098  1        Modified Flag
     C                     Z-ADD*ZERO     WN0099 112       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0100 112       Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WN0101 112       Commission Amou
     C                     Z-ADD*ZERO     WN0102 112       Financials Amou
     C                     Z-ADD*ZERO     WN0103 112       Financials Amou
     C                     MOVEL*BLANK    WN0104  1        Group for Packa
     C                     MOVEL*BLANK    WN0105  2        Base_Conv_Loss
     C                     MOVEL*BLANK    WN0106  1        Variety_Rendere
     C                     MOVEL*BLANK    WN0107  3        Customer Group
     C                     MOVEL*BLANK    WN0108  3        Customer Group
     C                     Z-ADD*ZERO     WN0109  70       Order Group Cod
     C                     MOVEL*BLANK    WN0110  4        Shipping Zone C
     C                     MOVEL*BLANK    WN0111  1        Process Sts for
     C                     Z-ADD*ZERO     WN0112 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0113 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0114  30       Req Shipping Te
     C                     Z-ADD*ZERO     WN0115  30       Actual Shipping
     C                     MOVEL*BLANK    WN0116  1        Age Code
     C                     Z-ADD*ZERO     WN0117  70       Req Delivery Da
     C                     Z-ADD*ZERO     WN0118  60       Req Delivery Ti
     C                     Z-ADD*ZERO     WN0119  70       MPC Number
     C                     MOVEL*BLANK    WN0120  3        Shipping Line
     C                     MOVEL*BLANK    WN0121 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0122 25        Port City
     C                     MOVEL*BLANK    WN0123 30        Vessel Name
     C                     MOVEL*BLANK    WN0124 12        Booking Number
     C                     Z-ADD*ZERO     WN0125 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0126  70       Claim Number
     C                     Z-ADD*ZERO     WN0127  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0128  1        Palletize
     C                     Z-ADD*ZERO     WN0129 114       Commodity Marke
     C                     Z-ADD*ZERO     WN0130 114       Market Value
     C                     Z-ADD*ZERO     WN0131 114       Default Cmdty M
     C                     Z-ADD*ZERO     WN0132 114       Raw Material Co
     C                     MOVEL*BLANK    WN0133  1        Sales Expense P
     C                     Z-ADD*ZERO     WN0134 112       Sales Expense T
     C                     MOVEL*BLANK    WN0135  1        Data Mart Proce
     C                     MOVEL*BLANK    WN0136  1        LH Load Type
     C                     MOVEL*BLANK    WN0137  2        Order TF Exempt
     C                     Z-ADD*ZERO     WN0138  70       LD Sail Date
     C                     Z-ADD*ZERO     WN0139 114       NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WN0140 112       HST Item Target
     C                     MOVEL*BLANK    WN0141  1        EDI Status 1
     C                     MOVEL*BLANK    WN0142  1        EDI Status 2
     C                     MOVEL*BLANK    WN0143  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0144  60       Job Time
     C                     MOVEL*BLANK    WN0145 10        User Id
     C                     MOVEL*BLANK    WN0146 10        Job Name
     C                     Z-ADD*ZERO     WN0147  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FHSTD2
     C                     Z-ADDF4AIC3    WAAIC3           Company Number
     C                     Z-ADDF4C4NB    WAC4NB           Order Number
     C                     Z-ADDF4DPNB    WADPNB           Order Sequence
     C                     Z-ADDF4UENB    WAUENB           Order Secondary
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
     C           KLCHSJ    CHAIN@FHSTD2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHSTPL0'MDACP
     C                     MOVEL'@FHSTD2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHS1    YARDCS
      * USER: Processing after Data read
     C                     MOVEL'N'       WAGASX           Process Sts for
     C                     MOVEL'N'       WAISSX           Data Mart Proce
      * Move non-key fields to @FHSTD2
     C                     Z-ADDOMR1NB    WAR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FHSTD2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHSTPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSSK     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBTLMI    WUTLMI           Total Load Mile
     C                     Z-ADDWBK2DT    WUK2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV FR/FZ sts for Ord RT - Order Header TRG  * *RMC 11/9/6 Get f
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVELWUOTTX    YL0046           Chilled/Frozen
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSL02           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSL02           Load ID
      * Establish starting position
     C           KRSSL     SETLL@BFCPD9                    *
     C           KRSSL     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse      RT - Order Detail  * 
     C                     EXSR SMRVGN
      * RTV Warehouse Type     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWUAJCD    WL0001    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUWPST    P      Warehouse Type
      * CASE: WRK.Warehouse Type is Fresh
     C           WUWPST    IFEQ 'FR'                       *IF
     C                     MOVEL'C'       YL0046           Chilled/Frozen
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'F'       YL0046           Chilled/Frozen
      * If any order is Frozen, then quit
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSL     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSM01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSM01           Company Number
     C                     Z-ADDWCC4NB    WQSM02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSM     SETLL@BGWKL1                    *
     C           KRSSM     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELOMAJCD    WUAJCD           Warehouse Code
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * VAL Load ID in History RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSN01           Load ID
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Load ID
      * Setup key
     C                     Z-ADDWL0009    WQSN01           Load ID
      * Establish starting position
     C           KRSSN     SETLL@HSTPUX                    *
     C           KRSSN     READE@HSTPUX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@HSTPUX                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Ld ActFrt/CarPay  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0010    WBRMNB           Load ID
      * Establish starting position
     C           KRSSO     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Ld ActFrt/CarPay  CH - Load Header  * 
     C                     EXSR SPCHRC
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg Ld ActFrt/CarPay  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0148  30       Company Number
     C                     Z-ADD*ZERO     WN0149  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0150  1        LTL Flag
     C                     MOVEL*BLANK    WN0151  1        Load Status
     C                     Z-ADD*ZERO     WN0152  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0153 15        Seal 1
     C                     MOVEL*BLANK    WN0154 15        Seal 2
     C                     MOVEL*BLANK    WN0155 15        Seal 3
     C                     MOVEL*BLANK    WN0156 15        Seal 4
     C                     MOVEL*BLANK    WN0157 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0158  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0159 112       Flat Amount
     C                     MOVEL*BLANK    WN0160  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0161  50       Total Stops
     C                     MOVEL*BLANK    WN0162 20        Trailer Id
     C                     MOVEL*BLANK    WN0163  3        Transloader Car
     C                     Z-ADD*ZERO     WN0164  40       BOL Time
     C                     MOVEL*BLANK    WN0165  3        Carrier Code
     C                     MOVEL*BLANK    WN0166  7        Truck Size
     C                     Z-ADD*ZERO     WN0167  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0168 112       Rated Freight
     C                     MOVEL*BLANK    WN0169  1        Ship Status
     C                     MOVEL*BLANK    WN0170  1        Load Type
     C                     Z-ADD*ZERO     WN0171  50       Number Pallets
     C                     Z-ADD*ZERO     WN0172  50       Number Pallets
     C                     Z-ADD*ZERO     WN0173  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0174  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0175  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0176 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0177 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0178  70       Actual Departur
     C                     Z-ADD*ZERO     WN0179  40       Departure Time
     C                     Z-ADD*ZERO     WN0180  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0181  52       Product Tempera
     C                     Z-ADD*ZERO     WN0182  50       Number Spacers
     C                     MOVEL*BLANK    WN0183 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0184  70       Total Load Mile
     C                     MOVEL*BLANK    WN0185 12        Recorder ID
     C                     MOVEL*BLANK    WN0186  2        Shipping Method
     C                     MOVEL*BLANK    WN0187  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0188  2        Ship To State C
     C                     Z-ADD*ZERO     WN0189  70       Gross Weight
     C                     MOVEL*BLANK    WN0190  3        Carrier Broker
     C                     MOVEL*BLANK    WN0191  1        Export Status
     C                     Z-ADD*ZERO     WN0192  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0193  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0194  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0195  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0196  70       Spotted Date
     C                     Z-ADD*ZERO     WN0197  60       Spotted Time
     C                     Z-ADD*ZERO     WN0198  70       Load Finished D
     C                     Z-ADD*ZERO     WN0199  60       Load Finished T
     C                     Z-ADD*ZERO     WN0200  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0201  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0202  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0203  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0204  70       Truck Departure
     C                     Z-ADD*ZERO     WN0205  60       Truck Departure
     C                     Z-ADD*ZERO     WN0206  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0207  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0208  3        Shipping Line
     C                     MOVEL*BLANK    WN0209 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0210 30        Vessel Name
     C                     Z-ADD*ZERO     WN0211  50       Voyage
     C                     Z-ADD*ZERO     WN0212  70       Sail Date
     C                     MOVEL*BLANK    WN0213 12        Booking Number
     C                     MOVEL*BLANK    WN0214 20        Discharge Port
     C                     Z-ADD*ZERO     WN0215  70       Arrival Date
     C                     MOVEL*BLANK    WN0216 12        Container Numbe
     C                     Z-ADD*ZERO     WN0217  70       Date In
     C                     Z-ADD*ZERO     WN0218  60       Time In
     C                     Z-ADD*ZERO     WN0219  70       Date Out
     C                     Z-ADD*ZERO     WN0220  60       Time Out
     C                     Z-ADD*ZERO     WN0221  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0222  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0223  1        LH Unused Sts
     C                     Z-ADD*ZERO     WN0224  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0225  70       Requested Deliv
     C                     MOVEL*BLANK    WN0226  1        Load Acceptance
     C                     MOVEL*BLANK    WN0227  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0228  70       On Yard Date
     C                     Z-ADD*ZERO     WN0229  60       On Yard Time
     C                     Z-ADD*ZERO     WN0230  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0231  60       Deadline Depart
     C                     MOVEL*BLANK    WN0232  1        Load Held Over
     C                     MOVEL*BLANK    WN0233  1        Load Held Over
     C                     MOVEL*BLANK    WN0234 15        Load Held Over
     C                     MOVEL*BLANK    WN0235 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0236 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0237  70       Express Mail Da
     C                     MOVEL*BLANK    WN0238  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0239  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0240  70       Product Complet
     C                     Z-ADD*ZERO     WN0241  60       Product Complet
     C                     Z-ADD*ZERO     WN0242  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0243  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0244  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0245  1        Load Confirmed
     C                     MOVEL*BLANK    WN0246 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0247  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0248  60       Load Door 1
     C                     Z-ADD*ZERO     WN0249  70       Override Total
     C                     Z-ADD*ZERO     WN0250  60       Load Door 2
     C                     MOVEL*BLANK    WN0251  1        Partial Load
     C                     MOVEL*BLANK    WN0252  1        Load Confirmati
     C                     MOVEL*BLANK    WN0253  1        Export Load USD
     C                     MOVEL*BLANK    WN0254  1        Late Delivery E
     C                     MOVEL*BLANK    WN0255 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0256 15        Late Billing Em
     C                     MOVEL*BLANK    WN0257 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0258 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0259  1        Multi Company L
     C                     MOVEL*BLANK    WN0260  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0261  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0262  1        LH Power Only L
     C                     MOVEL*BLANK    WN0263  1        MG Created Load
     C                     MOVEL*BLANK    WN0264  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0265  2        Load U_M
     C                     MOVEL*BLANK    WN0266  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0267  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0268  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0269  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0270  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0271  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0272  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0273  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0274  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0275  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0276  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0277  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0278  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0279  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0280  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0281  60       LH Unused Time
     C                     MOVEL*BLANK    WN0282  1        EDI Status 1
     C                     MOVEL*BLANK    WN0283  1        EDI Status 2
     C                     MOVEL*BLANK    WN0284  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0285  60       Job Time
     C                     MOVEL*BLANK    WN0286 10        User Id
     C                     MOVEL*BLANK    WN0287 10        Job Name
     C                     Z-ADD*ZERO     WN0288  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWBRMNB    WERMNB           Load ID
      *
     C           KLCHSP    KLIST
     C                     KFLD           WERMNB           Load ID
     C           KLCHSP    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0011    WEDGWG           Load Carrier Pa
     C                     Z-ADDWL0012    WEOCFR           Load Total Frei
     C                     MOVELWL0013    WERNST    P      LH Carrier Paym
     C                     Z-ADDWL0014    WEZBVA           Load Actual Fre
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * CASE: PAR.LH Carrier Payment Sts is Paid
     C           WL0013    IFEQ 'P'                        *IF
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Upd Carrier Pay Sts   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSSQ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Carrier Pay Sts   CH - Load Header  * 
     C                     EXSR SRCHRC
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Carrier Pay Sts   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0289  30       Company Number
     C                     Z-ADD*ZERO     WN0290  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0291  1        LTL Flag
     C                     MOVEL*BLANK    WN0292  1        Load Status
     C                     Z-ADD*ZERO     WN0293  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0294 15        Seal 1
     C                     MOVEL*BLANK    WN0295 15        Seal 2
     C                     MOVEL*BLANK    WN0296 15        Seal 3
     C                     MOVEL*BLANK    WN0297 15        Seal 4
     C                     MOVEL*BLANK    WN0298 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0299  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0300 112       Flat Amount
     C                     MOVEL*BLANK    WN0301  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0302  50       Total Stops
     C                     MOVEL*BLANK    WN0303 20        Trailer Id
     C                     MOVEL*BLANK    WN0304  3        Transloader Car
     C                     Z-ADD*ZERO     WN0305  40       BOL Time
     C                     MOVEL*BLANK    WN0306  3        Carrier Code
     C                     MOVEL*BLANK    WN0307  7        Truck Size
     C                     Z-ADD*ZERO     WN0308  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0309 112       Rated Freight
     C                     MOVEL*BLANK    WN0310  1        Ship Status
     C                     MOVEL*BLANK    WN0311  1        Load Type
     C                     Z-ADD*ZERO     WN0312  50       Number Pallets
     C                     Z-ADD*ZERO     WN0313  50       Number Pallets
     C                     Z-ADD*ZERO     WN0314 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0315  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0316  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0317  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0318 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0319 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0320  70       Actual Departur
     C                     Z-ADD*ZERO     WN0321  40       Departure Time
     C                     Z-ADD*ZERO     WN0322  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0323  52       Product Tempera
     C                     Z-ADD*ZERO     WN0324  50       Number Spacers
     C                     MOVEL*BLANK    WN0325 12        Car_Veh. Initia
     C                     Z-ADD*ZERO     WN0326  70       Total Load Mile
     C                     MOVEL*BLANK    WN0327 12        Recorder ID
     C                     MOVEL*BLANK    WN0328  2        Shipping Method
     C                     MOVEL*BLANK    WN0329  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0330  2        Ship To State C
     C                     Z-ADD*ZERO     WN0331  70       Gross Weight
     C                     MOVEL*BLANK    WN0332  3        Carrier Broker
     C                     MOVEL*BLANK    WN0333  1        Export Status
     C                     Z-ADD*ZERO     WN0334  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0335  1        On Time (Y_N)
     C                     Z-ADD*ZERO     WN0336  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0337  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0338  70       Spotted Date
     C                     Z-ADD*ZERO     WN0339  60       Spotted Time
     C                     Z-ADD*ZERO     WN0340  70       Load Finished D
     C                     Z-ADD*ZERO     WN0341  60       Load Finished T
     C                     Z-ADD*ZERO     WN0342  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0343  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0344  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0345  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0346  70       Truck Departure
     C                     Z-ADD*ZERO     WN0347  60       Truck Departure
     C                     Z-ADD*ZERO     WN0348  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0349  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0350  3        Shipping Line
     C                     MOVEL*BLANK    WN0351 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0352 30        Vessel Name
     C                     Z-ADD*ZERO     WN0353  50       Voyage
     C                     Z-ADD*ZERO     WN0354  70       Sail Date
     C                     MOVEL*BLANK    WN0355 12        Booking Number
     C                     MOVEL*BLANK    WN0356 20        Discharge Port
     C                     Z-ADD*ZERO     WN0357  70       Arrival Date
     C                     MOVEL*BLANK    WN0358 12        Container Numbe
     C                     Z-ADD*ZERO     WN0359  70       Date In
     C                     Z-ADD*ZERO     WN0360  60       Time In
     C                     Z-ADD*ZERO     WN0361  70       Date Out
     C                     Z-ADD*ZERO     WN0362  60       Time Out
     C                     Z-ADD*ZERO     WN0363 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0364  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0365  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0366  1        LH Unused Sts
     C                     Z-ADD*ZERO     WN0367  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0368  70       Requested Deliv
     C                     MOVEL*BLANK    WN0369  1        Load Acceptance
     C                     MOVEL*BLANK    WN0370  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0371  70       On Yard Date
     C                     Z-ADD*ZERO     WN0372  60       On Yard Time
     C                     Z-ADD*ZERO     WN0373  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0374  60       Deadline Depart
     C                     MOVEL*BLANK    WN0375  1        Load Held Over
     C                     MOVEL*BLANK    WN0376  1        Load Held Over
     C                     MOVEL*BLANK    WN0377 15        Load Held Over
     C                     MOVEL*BLANK    WN0378 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0379 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0380  70       Express Mail Da
     C                     MOVEL*BLANK    WN0381  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0382  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0383  70       Product Complet
     C                     Z-ADD*ZERO     WN0384  60       Product Complet
     C                     Z-ADD*ZERO     WN0385  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0386  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0387  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0388  1        Load Confirmed
     C                     MOVEL*BLANK    WN0389 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0390  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0391  60       Load Door 1
     C                     Z-ADD*ZERO     WN0392  70       Override Total
     C                     Z-ADD*ZERO     WN0393  60       Load Door 2
     C                     MOVEL*BLANK    WN0394  1        Partial Load
     C                     MOVEL*BLANK    WN0395  1        Load Confirmati
     C                     MOVEL*BLANK    WN0396  1        Export Load USD
     C                     MOVEL*BLANK    WN0397  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0398 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0399 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0400 15        Late Billing Em
     C                     MOVEL*BLANK    WN0401 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0402 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0403  1        Multi Company L
     C                     MOVEL*BLANK    WN0404  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0405  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0406  1        LH Power Only L
     C                     MOVEL*BLANK    WN0407  1        MG Created Load
     C                     MOVEL*BLANK    WN0408  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0409  2        Load U_M
     C                     MOVEL*BLANK    WN0410  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0411  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0412  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0413  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0414  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0415  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0416  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0417  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0418  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0419  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0420  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0421  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0422  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0423  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0424  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0425  60       LH Unused Time
     C                     MOVEL*BLANK    WN0426  1        EDI Status 1
     C                     MOVEL*BLANK    WN0427  1        EDI Status 2
     C                     MOVEL*BLANK    WN0428  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0429  60       Job Time
     C                     MOVEL*BLANK    WN0430 10        User Id
     C                     MOVEL*BLANK    WN0431 10        Job Name
     C                     Z-ADD*ZERO     WN0432  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWBRMNB    WERMNB           Load ID
      *
     C           KLCHSR    KLIST
     C                     KFLD           WERMNB           Load ID
     C           KLCHSR    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YCRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL*BLANK    WERNST    P      LH Carrier Paym
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * CASE: Only zero if carrier plaid dte <>0 on a not paid
      *  - c1 AND c2
      *   |- c1    : PAR.LH Carrier Payment Sts is Not Paid
      *   |- c2    : DB1.LH Carrier Paid Dte NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *BLANK    IFEQ *BLANK                     *IF
     C           WEPYDT    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     WEPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WECKTM           LH Carrier Paid
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0433    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSS     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P1MPNA           Default Printer
     C                     MOVELDRBCCD    P1BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0047           Company Number
     C                     MOVELDRBUVN    WN0434           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0015    DTAJVN           User Profile Na
     C                     MOVELWL0016    DTDNCD           Application Cod
      * Establish starting position
     C           KRSST     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0017           Company Number
     C                     MOVELDTAJCD    WL0018           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSU01           Application Cod
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSU01           Application Cod
     C                     MOVEL'OMS'     WQSU01           Application Cod
      * Establish starting position
     C           KRSSU     SETLL@DNRESF                    *
     C           KRSSU     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
     C           KRSSU     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSV01           Application Cod
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSV01           Application Cod
      * Establish starting position
     C           KRSSV     SETLL@DNRESF                    *
     C           KRSSV     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSV     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 03/10/2008 LJB FP1271
      * ** Comment out FC Code = Actual Freight calcs
      * ** 03/03/2008 PKD FP1271
      * ** If LFC Include In Actual Freight = "Y" then add to Actual
      * ** Freight Total
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 07/17/2006 LJB TRF018 - CHK Air Frt Order RT over OH
      * ** This routine checks to see if at least one order is an air
      * ** freight order. If yes the program quits (only one is needed).
      * *****
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD13        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD3         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2RNST'  YPMTFD           LH Carrier Paym
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ021
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2U2ST'  YPMTFD           Export Status
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2LSHG'  YPMTFD           Load Shag Flag
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ035
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2YPST'  YPMTFD           Load Wash Flag
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1DQCD           Enterprise Code
     C                     MOVEL*BLANK    P1DRCD           Enterprise Code
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     MOVEL*BLANK    P1ADTX           Name
     C                     MOVEL*BLANK    P1BXTX           System Value Al
     C                     MOVEL*BLANK    P1WVST           Access Denied (
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Reverse Image Flag USR
     C                     MOVEL*BLANK    WUHLSX  1
      * Define work field Change Flag USR
     C                     MOVEL*BLANK    WUHWSX  1
      * Define work field Air Freight Order
     C                     MOVEL*BLANK    WUFTSX  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAORIT           Original Item
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WABYWG           Weight Billed
     C                     Z-ADD*ZERO     WAS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WAUTVA           Standard Overag
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WACKNB           GL Document Num
     C                     Z-ADD*ZERO     WAR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WAONVA           Actual Freight
     C                     Z-ADD*ZERO     WAB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WAUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WAUOVA           Commission Amou
     C                     Z-ADD*ZERO     WAUPVA           Financials Amou
     C                     Z-ADD*ZERO     WAUQVA           Financials Amou
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WAIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WANYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WABZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WAA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WACDPR           Market Value
     C                     Z-ADD*ZERO     WAD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WAD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WACEVL           Sales Expense T
     C                     Z-ADD*ZERO     WAOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WAD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WACFVL           HST Item Target
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           AR Customer Num
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  2
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  30
     C                     MOVEL*BLANK    WL0007  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0008  70
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0009  70
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011 112
     C                     Z-ADD*ZERO     WL0012 112
     C                     MOVEL*BLANK    WL0013  1
     C                     Z-ADD*ZERO     WL0014 112
      * Define local variables for subroutine STRVGN.
     C                     MOVEL*BLANK    WL0015 10
     C                     MOVEL*BLANK    WL0016  6
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  3
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field LH Carrier Payment Sts
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Select Status
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Status Flag 2  Y/N
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0008 30
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0010 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0011 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0012 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    YL0014 11
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0015  3
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Export Docs Go w_Driver
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Air Freight Order
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Export USDA Approved
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0020  30
      * Define local work field Stop_Drop Sequence Number
     C                     Z-ADD*ZERO     YL0021  50
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field Port Delv Terminal
     C                     MOVEL*BLANK    YL0023 20
      * Define local work field OHE City
     C                     MOVEL*BLANK    YL0024 25
      * Define local work field OHE Vessel_Airline
     C                     MOVEL*BLANK    YL0025 30
      * Define local work field OHE Voyage_Flight
     C                     MOVEL*BLANK    YL0026 15
      * Define local work field OHE Booking Number
     C                     MOVEL*BLANK    YL0027 15
      * Define local work field OHE Discharge Port_Airprt
     C                     MOVEL*BLANK    YL0028 20
      * Define local work field OHE Sail_Flight Date
     C                     Z-ADD*ZERO     YL0029  70
      * Define local work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YL0032  3
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field OHE Container Number
     C                     MOVEL*BLANK    YL0034 12
      * Define local work field OHE Comment 1
     C                     MOVEL*BLANK    YL0035 35
      * Define local work field OHE Comment 2
     C                     MOVEL*BLANK    YL0036 75
      * Define local work field Port City
     C                     MOVEL*BLANK    YL0037 25
      * Define local work field Port Address Line 1
     C                     MOVEL*BLANK    YL0038 25
      * Define local work field Port Address Line 2
     C                     MOVEL*BLANK    YL0039 25
      * Define local work field Sail Port State
     C                     MOVEL*BLANK    YL0040  2
      * Define local work field Port Zip/Postal Code
     C                     MOVEL*BLANK    YL0041 11
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0042 110
      * Define local work field Port Fax Number
     C                     MOVEL*BLANK    YL0043 25
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0001  2
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0003 40
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0004 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0005  3
      * Define null work field Broker
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field P.O. Required Flag
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field Deliver after time
     C                     Z-ADD*ZERO     YN0008  40
      * Define null work field Deliver before time
     C                     Z-ADD*ZERO     YN0009  40
      * Define null work field Alt Remittance Flag
     C                     MOVEL*BLANK    YN0010  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0044  2
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0011  52
      * Define null work field Mileage To Customer
     C                     Z-ADD*ZERO     YN0012  92
      * Define null work field Co/Cust Overage Rate CWT
     C                     Z-ADD*ZERO     YN0013 112
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0015  3
      * Define null work field Outside Warehouse Flag
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Customer Group Code
     C                     MOVEL*BLANK    YN0017  3
      * Define null work field Customer Group Code 2
     C                     MOVEL*BLANK    YN0018  3
      * Define null work field G_L Code
     C                     MOVEL*BLANK    YN0019  8
      * Define null work field Commodity Market Code
     C                     MOVEL*BLANK    YN0020  3
      * Define null work field Credit Contact Name
     C                     MOVEL*BLANK    YN0021 30
      * Define null work field Credit Contact Telephone
     C                     MOVEL*BLANK    YN0022 25
      * Define null work field Credit Contact Bus. Title
     C                     MOVEL*BLANK    YN0023 30
      * Define null work field Credit Contact Fax Number
     C                     MOVEL*BLANK    YN0024 25
      * Define null work field Allow Man/Qt WO/Approval
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field Fax Invoice Flag
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field Fax Invoice Fax Number
     C                     MOVEL*BLANK    YN0027 25
      * Define null work field Fax Invoice Contact Name
     C                     MOVEL*BLANK    YN0028 30
      * Define null work field Distributor
     C                     MOVEL*BLANK    YN0029  1
      * Define null work field Default Shipping Co Sts
     C                     MOVEL*BLANK    YN0030  1
      * Define null work field Ord Ent Default Sls Rte
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field Bypass DDt/Delay w/Invcng
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0037  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0038 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0039 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0040  70
      * Define local work field Company Number     041405
     C                     Z-ADD*ZERO     YL0045  30
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0041  1
      * Define local work field Chilled/Frozen Sts USR
     C                     MOVEL*BLANK    YL0046  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0047  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0048  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD03        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0433 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0433           User Profile Na
      *
     C                     MOVEL*BLANK    WN0434 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SSRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0433    ZA0003           User Profile Na
     C                     MOVEL'OMS'     ZA0004           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0434    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0433    WL0015    P      User Profile Na
     C                     MOVEL'OMS'     WL0016    P      Application Cod
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    P1AIC3           Company Number
     C                     MOVELWL0018    YL0048    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0434    WL0015    P      User Profile Na
     C                     MOVEL'OMS'     WL0016    P      Application Cod
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0017    P1AIC3           Company Number
     C                     MOVELWL0018    YL0048    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0048    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0433    ZA0005           User Profile Na
     C                     MOVEL'OMS'     ZA0006           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0047    IFNE 0                          *IF
     C                     Z-ADDYL0047    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0048    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0120  3        Warehouse Code
     C                     PARM YL0047    WQ0121  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SURVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       YL0001           First Time Flag
     C                     Z-ADD9999999   W0SLM            *Scan limit
      * SFL Fold/Drop  RPG    US - /UT User Source  * 
     C                     Z-ADD12        ##SFPG
     C                     MOVEL'N'       YL0003           Select Status
     C                     MOVEL'N'       YL0004           Status Flag 1
     C                     MOVEL'N'       YL0005           Status Flag 2
      * ** Set condition for OCEAN or AIRFRT orders
     C                     MOVEL'N'       WUHLSX           Reverse Image F
      * ** Set condition for Override Total Load Miles           E00207
     C                     MOVEL'N'       WUHWSX           Change Flag USR
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 Y2U0005
