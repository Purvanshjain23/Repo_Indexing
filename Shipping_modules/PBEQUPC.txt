/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  THIS PROGRAM WILL BE CALLED FROM PLACES TO          */
/*          SEND AN EMAIL TO A SALES ADMIN THAT CARES       */
/*          ABOUT A REQ DELIV DATE CHANGE         */
/*         THE DIST LIST IS IN THE COMPANY VALUES.    */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  DATE      - 08/02/12                                            */
/*                                                                  */
/********************************************************************/
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*               &ORDER   - ORDER NUMBER                            */
/*               &REQDAT  - REQUESTED DELV DATE                     */
/*               &REQTIM  - REQ DELV TIME                           */
/*               &LOAD    - LOAD ID                                 */
/********************************************************************/
/* MODIFIED BY:                                                     */
/*   DATE   NAME       DESCRIPTION                                  */
/* -------- ---------- ---------------------------------------------*/
/********************************************************************/
 PBEQUPC:    PGM        PARM(&RETURN &ORDER &REQDAT &LOAD &REQTIM +
                          &INTNET)
/* PARMS */
         DCL     &RETURN     *CHAR    (7)
         DCL     &ORDER      *DEC     (7 0)
         DCL     &REQDAT     *DEC    (7 0)
         DCL     &REQTIM     *DEC    (6 0)
         DCL     &LOAD       *DEC    (7 0)
         DCL        VAR(&INTNET) TYPE(*CHAR) LEN(40)

         DCL     &ORDERA     *CHAR    7          /* ORDER NUMBER ALPHA        */
         DCL     &LOADA      *CHAR    7          /* LOAD         ALPHA        */
         DCL     &REQDATA    *CHAR    7          /* ORDER TIME   ALPHA        */
         DCL     &REQTIMA    *CHAR    6          /* ORDER TIME   ALPHA        */
         DCL     &REQTIM2    *CHAR    8          /* ORDER TIME   ALPHA        */
         DCL     &REQDAT2    *CHAR    8          /* REQ DLV DT   ALPHA        */
         DCL     &MSG        *CHAR    256        /* MESSAGE FOR ESNDMAIL CMD  */
         DCL     &WRK1       *CHAR    3
         DCL     &WRK2       *CHAR    3
         DCL     &WRK3       *CHAR    2

             DCL        VAR(&A) TYPE(*CHAR) LEN(21)
             DCL        VAR(&B) TYPE(*CHAR) LEN(31)
             DCL        VAR(&C) TYPE(*CHAR) LEN(40)

             CHGVAR     VAR(&ORDERA) VALUE(&ORDER)
             CHGVAR     VAR(&REQTIMA) VALUE(&REQTIM)
             CHGVAR     VAR(&REQDATA) VALUE(&REQDAT)
             CHGVAR     VAR(&LOADA) VALUE(&LOAD)

FORMAT:
             CVTDAT     DATE(&REQDATA) TOVAR(&REQDAT2) +
                          FROMFMT(*CYMD) TOFMT(*MDY) TOSEP(/)
             CHGVAR     VAR(&WRK1) VALUE(%SST(&REQTIMA 1 2) *CAT ':')
             CHGVAR     VAR(&WRK2) VALUE(%SST(&REQTIMA 3 2) *CAT ':')
             CHGVAR     VAR(&WRK3) VALUE(%SST(&REQTIMA 5 2))
             CHGVAR     VAR(&REQTIM2) VALUE(&WRK1 *CAT &WRK2 *CAT +
                          &WRK3)

MSG:         CHGVAR     VAR(&A) VALUE('ORDER NUMBER:' *BCAT &ORDERA)
             CHGVAR     VAR(&B) VALUE(' LOAD:' *BCAT &LOADA)
             CHGVAR     VAR(&C) VALUE(' REQUESTED DELIVERY:' *BCAT +
                          &REQDAT2 *BCAT &REQTIM2)

/*----------------------------------------------------------------------*/
/* ESNDMAIL                                                             */
/*----------------------------------------------------------------------*/
             ADDLIBLE   LIB(ESEND) POSITION(*LAST)
             MONMSG     MSGID(CPF0000)
             CHGVAR     VAR(&MSG) VALUE(&A +
                          *BCAT &B *BCAT &C)
             ESNDMAIL   RECIPIENT(&INTNET) SUBJECT('Requested +
                          Delivery Date Change') MSG(&MSG)
/*----------------------------------------------------------------------*/
 END:        ENDPGM
