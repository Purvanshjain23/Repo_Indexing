     H/TITLE UPD Avail-To-Sell  ORD XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 12/05/18  Time  : 16:49:33
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FCAAFREL8IF  E           K        DISK
      * RTV : Calendar                  Co/Date PrdDaySts=Y
      *
     E                    YDOW        7  1               *Days of week
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
      *
     I@FDREAW
      * Company Item Ext          RTV, select Active
      * Renamed input format fields
     I              FDAIC3                          WCAIC3
     I              FDHGCD                          WCHGCD
     I              FDD0ST                          WCD0ST
     I              FDD2ST                          WCD2ST
     I              FDD6ST                          WCD6ST
     I              FDWESP                          WCWESP
     I              FDEDST                          WCEDST
     I              FDEFST                          WCEFST
     I              FDEHST                          WCEHST
     I              FDEMST                          WCEMST
     I              FDENST                          WCENST
     I              FDEOST                          WCEOST
     I              FDEPST                          WCEPST
     I              FDEQST                          WCEQST
     I              FDOQNY                          WCOQNY
     I              FDORNY                          WCORNY
     I              FDS2DT                          WCS2DT
     I              FDUFT1                          WCUFT1
     I              FDKUAA                          WCKUAA
     I              FDVSST                          WCVSST
     I              FDMJDT                          WCMJDT
     I              FDBETM                          WCBETM
     I              FDCCVN                          WCCCVN
     I              FDCDVN                          WCCDVN
     I              FDMKDT                          WCMKDT
     I              FDBFTM                          WCBFTM
     I              FDCEVN                          WCCEVN
     I              FDCFVN                          WCCFVN
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@AFREY1
      * Calendar                  Co/Date PrdDaySts=Y
      * Renamed input format fields
     I              AFAIC3                          WEAIC3
     I              AFBCDT                          WEBCDT
     I              AFCQNB                          WECQNB
     I              AFESNB                          WEESNB
     I              AFETNB                          WEETNB
     I              AFBZNB                          WEBZNB
     I              AFA9ST                          WEA9ST
     I              AFEINB                          WEEINB
     I              AFC5ST                          WEC5ST
     I              AFAQNB                          WEAQNB
     I              AFCMST                          WECMST
     I              AFV9ST                          WEV9ST
     I              AFWAST                          WEWAST
     I              AFX2ST                          WEX2ST
     I              AFOJDT                          WEOJDT
     I              AFNQNX                          WENQNX
     I              AFNRNX                          WENRNX
     I              AFI9SX                          WEI9SX
     I              AFJASX                          WEJASX
     I              AFOKDT                          WEOKDT
     I              AFOLDT                          WEOLDT
     I              AFUVST                          WEUVST
     I              AFUWST                          WEUWST
     I              AFUXST                          WEUXST
     I              AFAATM                          WEAATM
     I              AFAYNA                          WEAYNA
     I              AFA0NA                          WEA0NA
     I              AFAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
      * I :  Item Code
     I                                    P  11  140P1HGCD
      * I :  Warehouse Code
     I                                       15  17 P1AJCD
      * I :  Ship Date USR
     I                                    P  18  210P1HLDT
      * I :  Quantity Ordered
     I                                    P  22  272P1AVQT
      * I :  Weight Ordered
     I                                    P  28  332P1D0WG
      * B :  Quantity Scheduled
     I                                    P  34  392P1CCQT
      * B :  Weight Scheduled
     I                                    P  40  452P1AUWG
      * I :  ATS Adj Type USR
     I                                       46  47 P1ZLST
      * I :  PSAA Program Name
     I                                       48  57 P1BXVN
      * N :  ATS Quantity Need USR
     I                                    P  58  632P1HWQT
      * N :  ATS Weight Need USR
     I                                    P  64  692P1ENWG
      * N :  ATS Weight Available USR
     I                                    P  70  752P1EOWG
      * N :  ATS Quantity Avail USR
     I                                    P  76  810P1HXQT
      * N :  Production Type
     I                                       82  82 P1V5ST
      * N :  Unit Weight
     I                                    P  83  882P1AIWG
      * N :  Production Date
     I                                    P  89  920P1ELDT
      * N :  Production Date RGF
     I                                    P  93  960P1GVDT
      * N :  Production Date RGT
     I                                    P  97 1000P1GWDT
      * N :  Weight Allocated USR
     I                                    P 101 1052P1E1WG
      * N :  Quantity Allocated USR
     I                                    P 106 1112P1IHQT
      * N :  ATS Adj Type USR 2
     I                                      112 113 P1QJST
      * N :  Week Number
     I                                    P 114 1150P1EINB
      * N :  Accounting Year Code
     I                                    P 116 1180P1ESNB
      * N :  Accounting Period Code
     I                                    P 119 1200P1ETNB
      * N :  OM Week
     I                                    P 121 1220P1BZNB
      * N :  Week Begin Date      USR
     I                                    P 123 1260P1LHDT
      * N :  Week End Date        USR
     I                                    P 127 1300P1LIDT
      * N :  Quantity Deallocated USR
     I                                    P 131 1362P1IPQT
      * N :  Weight Deallocate USR
     I                                    P 137 1412P1F1WG
      * N :  Quantity Sched Prod USR
     I                                    P 142 1451P1QSOY
      * N :  Weight Sched Prod SUM
     I                                    P 146 1502P1EAWG
      * N :  USR Warehouse Code
     I                                      151 153 P1CPCD
      * N :  Order Date
     I                                    P 154 1570P1A0DT
      * N :  Order Type - Sales
     I                                      158 159 P1JNCD
      * N :  Requested Delivery Date
     I                                    P 160 1630P1EIDT
      * I :  Item Age Days
     I                                    P 164 1660P1RINY
      * I :  Production Ovr AgeDte Fr
     I                                    P 167 1700P1TIDT
      * I :  Production Ovr AgeDte To
     I                                    P 171 1740P1TJDT
     IP2PARM      DS
      * FLD: Company Item
      * N :  U/M - Primary
     I                                        1   2 P2ADCD
      * N :  Fresh Chilling Time
     I                                    P   3   52P2CHTM
      * N :  Base/Conv/Loss Item
     I                                        6   7 P2QZCD
      * N :  Department Code
     I                                        8  13 P2R3CD
      * N :  Piece Count Item
     I                                       14  14 P2PCCT
      * N :  Pieces Per Bag
     I                                    P  15  180P2BDNB
      * N :  Bags Per Unit
     I                                    P  19  220P2BJNB
      * N :  Export/Domestic
     I                                       23  23 P2SUST
      * N :  Print On Schedule
     I                                       24  24 P2SVST
      * N :  Fresh Inv Allocation Seq
     I                                       25  25 P2SYST
      * N :  Fresh Sched As Ordered
     I                                       26  26 P2SZST
      * N :  Frozen Inv Allocation Seq
     I                                       27  27 P2S1ST
      * N :  Primal Group Code
     I                                       28  33 P2XRCD
     IP3PARM      DS
      * FLD: PS Prod Item Schedule
      * N :  PS Weight Inv Allocated
     I                                    P   1   52P3UNW2
     IP4PARM      DS
      * FLD: Order Detail Schedule
      * N :  Scheduled Ship Date
     I                                    P   1   40P4AODT
      * N :  Order From Warehouse
     I                                        5   7 P4AYAA
      * N :  OD Quantity Inv Sched
     I                                    P   8  132P4IUQT
      * N :  OD Weight Inv Sched
     I                                    P  14  192P4F3WG
     IP5PARM      DS
      * FLD: Warehouse
      * N :  Warehouse Type
     I                                        1   2 P5WPST
      * N :  Trans Contol AS400/Plant
     I                                        3   3 P5XUST
      * N :  Warehouse Location
     I                                        4   4 P5T0ST
      * N :  Warehouse Std Chill Time
     I                                        5   5 P5T1ST
      * N :  Warehouse Chill Time
     I                                    P   6   82P5DBNB
      * N :  WHS Sched Prod Max Days
     I                                    P   9  100P5BUC3
      * N :  WHS Inventory Chill Time
     I                                    P  11  120P5BVC3
     IP6PARM      DS
      * N :  Chill Time USR
     I                                    P   1   20P6CSHD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P1HGCD    PARM           WP0005  70       Item Code
     C           P1AJCD    PARM           WP0006  3        Warehouse Code
     C           P1HLDT    PARM           WP0007  70       Ship Date USR
     C           P1AVQT    PARM           WP0008 112       Quantity Ordere
     C           P1D0WG    PARM           WP0009 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WP0010 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WP0011 112       Weight Schedule
     C           P1ZLST    PARM           WP0012  2        ATS Adj Type US
     C           P1BXVN    PARM           WP0013 10        PSAA Program Na
     C           P1RINY    PARM           WP0014  40       Item Age Days
     C           P1TIDT    PARM           WP0015  70       Production Ovr
     C           P1TJDT    PARM           WP0016  70       Production Ovr
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Avail-To-Sell  ORD XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * FP1054 moved this up here so we have the warehouse type
      *
     C                     Z-ADD*ZERO     WN0001 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
     C                     EXSR SARVGN
      * BPS Rtv Whs Info      RT - Warehouse  * 
     C                     EXSR SBRVGN
      * E2073 RMC 8/01/12 Get Whs Inventory Chill time
      * RTV Warehouse Inv/Max RT - Warehouse  * 
     C                     EXSR SCRVGN
      * Rtv CIE Use Age Day   RT - Company Item Ext  * 
     C                     EXSR SDRVGN
      * E2885 RMC 12/4/13 added here
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
     C                     EXSR SERVGN
      * FP1054 7/13/09 - go to back age-code number of days for Prod allo
      * FP1309 Revd with Group ON this go ahead and use the Item Age Days
      * -----
      * 08/02/10 PKD Do not override. Need to consider days between
      *              Ship Date and Delivery Date if we need to do somethi
      * -----
     C                     Z-ADDP1RINY    YL0005           Item Age Days
     C                     Z-ADDP1TIDT    YL0006           Production Ovr
     C                     Z-ADDP1TJDT    YL0007           Production Ovr
      * FP1309 - Get order header info needed:   date and type Requested
      * RTV Avail-To-Sell RqShpRT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * *---------------------------------------------------------------*
      * 8/20/12 dont sched prod to be made more than n days for FZ too
      * 4/27/12 dont sched prod to be made more than 3 days prior ship da
      *    and keeping the age in mind.   E2073 RMC Per curt, 7/11 except
      * E3796 JJH 02/11/15 - Replace Ship Date USR with Requested Ship Da
      * FResh override max 3 days to Age Days  IF Alloc Method will be F(
      * CASE: PAR.Warehouse Type is Fresh
     C           P5WPST    IFEQ 'FR'                       *IF
      * CASE: PAR.Requested Delivery Date NE PAR.Ship Date USR
     C           P1EIDT    IFNE P1HLDT                     *IF
      * LCL.Days = PAR.Requested Delivery Date - PAR.Ship Date USR *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           P1EIDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0008
     C                     ELSE
     C           XDURR     MULT -1        YL0008
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0008           Days
     C                     END                             *FI
      * R11425 RMC 8/8/17 DONT DO ANY MORE! PER AVI AND TEAM
     C                     END                             *FI
      * FZ freezer -  override max N days to Age Days
      * CASE: PAR.Warehouse Type is Frozen
     C           P5WPST    IFEQ 'FZ'                       *IF
      * CASE: PAR.Requested Delivery Date NE PAR.Ship Date USR
     C           P1EIDT    IFNE P1HLDT                     *IF
      * LCL.Days = PAR.Requested Delivery Date - PAR.Ship Date USR *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           P1EIDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0008
     C                     ELSE
     C           XDURR     MULT -1        YL0008
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0008           Days
     C                     END                             *FI
      * Use Max days if Use Age Days over Max is not Y
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.CIE Use Age Days over Max is Not Yes
      *   |- c2    : PAR.WHS Sched Prod Max Days is greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ *BLANK                     *IF
     C           YL0001    OREQ 'N'
     C           P5BUC3    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * How many days back is N production days before req delivery date?
      * E3796 JJH 02/11/15 - Replace Ship Date USR with Requested Ship Da
      *  Replace "I  Post to G/L Date  FLD   PAR Ship Date USR"
      *  With    "I  Post to G/L Date  FLD   LCL Requested Ship Date"
      * RTV Prior Prod Day    XF - Calendar  * 
     C                     CALL 'PBD8XFR'              90  RTV Prior Prod
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1HLDT    WQ0002  70       Post to G/L Dat
     C                     PARM P5BUC3    WQ0003  30       CTL Prior Day
     C           YL0009    PARM *ZERO     WQ0004  70       Date From
     C           YL0010    PARM YL0010    WQ0005  50       Day 1 Productio
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBD8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  YL0010    YL0008           Days
      * CASE: LCL.Days LT PAR.Item Age Days
     C           YL0008    IFLT P1RINY                     *IF
     C                     Z-ADDYL0008    YL0005           Item Age Days
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *---------------------------------------------------------------*
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
      * CASE: PAR.ATS Weight Need USR is Equal to zero
     C           P1ENWG    IFEQ *ZERO                      *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Update Availability using Production Detail
     C                     EXSR UBSUBR                     Update Availabi
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    P2ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P1AIWG           Unit Weight
     C                     Z-ADD*ZERO     WURINB           Item Structure
     C                     Z-ADD*ZERO     WURHNB           Item Structure
     C                     Z-ADD*ZERO     WURGNB           Item Structure
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     Z-ADD*ZERO     P2CHTM           Fresh Chilling
     C                     MOVEL*BLANK    P2QZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    WUXWST           Variety/Rendere
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     Z-ADD*ZERO     WUSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WUPPHE           Pieces Per Head
     C                     MOVEL*BLANK    P2R3CD           Department Code
     C                     MOVEL*BLANK    WUSDCD           Group for Packa
     C                     MOVEL*BLANK    WUX5ST           Seconds Item
     C                     MOVEL*BLANK    P2PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     P2BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     P2BJNB           Bags Per Unit
     C                     MOVEL*BLANK    P2SUST           Export/Domestic
     C                     MOVEL*BLANK    P2SVST           Print On Schedu
     C                     MOVEL*BLANK    P2SYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    P2SZST           Fresh Sched As
     C                     MOVEL*BLANK    P2S1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    P2XRCD           Primal Group Co
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    WUAVNA           Description Lin
     C                     MOVELWAADCD    P2ADCD           U/M - Primary
     C                     Z-ADDWAAIWG    P1AIWG           Unit Weight
     C                     Z-ADDWARINB    WURINB           Item Structure
     C                     Z-ADDWARHNB    WURHNB           Item Structure
     C                     Z-ADDWARGNB    WURGNB           Item Structure
     C                     MOVELWAN0CD    WUN0CD           Item Type Code
     C                     MOVELWAQ1CD    WUQ1CD           Default Warehou
     C                     Z-ADDWACHTM    P2CHTM           Fresh Chilling
     C                     MOVELWAQZCD    P2QZCD           Base/Conv/Loss
     C                     MOVELWAXWST    WUXWST           Variety/Rendere
     C                     MOVELWAVMST    WUVMST           Credit Item Sta
     C                     Z-ADDWASWGH    WUSWGH           Std Weight/Head
     C                     Z-ADDWAPPHE    WUPPHE           Pieces Per Head
     C                     MOVELWAR3CD    P2R3CD           Department Code
     C                     MOVELWASDCD    WUSDCD           Group for Packa
     C                     MOVELWAX5ST    WUX5ST           Seconds Item
     C                     MOVELWAPCCT    P2PCCT           Piece Count Ite
     C                     Z-ADDWABDNB    P2BDNB           Pieces Per Bag
     C                     Z-ADDWABJNB    P2BJNB           Bags Per Unit
     C                     MOVELWASUST    P2SUST           Export/Domestic
     C                     MOVELWASVST    P2SVST           Print On Schedu
     C                     MOVELWASYST    P2SYST           Fresh Inv Alloc
     C                     MOVELWASZST    P2SZST           Fresh Sched As
     C                     MOVELWAS1ST    P2S1ST           Frozen Inv Allo
     C                     MOVELWAXRCD    P2XRCD           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1AJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P5WPST           Warehouse Type
     C                     MOVEL*BLANK    P5XUST           Trans Contol AS
     C                     MOVEL*BLANK    P5T0ST           Warehouse Locat
     C                     MOVEL*BLANK    P5T1ST           Warehouse Std C
     C                     Z-ADD*ZERO     P5DBNB           Warehouse Chill
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBWPST    P5WPST           Warehouse Type
     C                     MOVELWBXUST    P5XUST           Trans Contol AS
     C                     MOVELWBT0ST    P5T0ST           Warehouse Locat
     C                     MOVELWBT1ST    P5T1ST           Warehouse Std C
     C                     Z-ADDWBDBNB    P5DBNB           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Inv/Max RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1AJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P5BUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     P5BVC3           WHS Inventory C
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBUC3    P5BUC3           WHS Sched Prod
     C                     Z-ADDWBBVC3    P5BVC3           WHS Inventory C
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv CIE Use Age Day   RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WCHGCD    WQSD02           Item Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     Z-ADDP1HGCD    WQSD02           Item Code
      * Establish starting position
     C           KRSSD     SETLL@FDREAW                    *
     C           KRSSD     READE@FDREAW                  90*
      * Data record not found
     C   90                MOVEL'USR4125' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCEPST    YL0001           CIE Use Age Day
     C           KRSSD     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv CIE Alloc Method  RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E2885 RMC 12/4/13 new alloc method="S"tandard -- if shipping with
      *   3 days, force Alloc Method to F-ASAP, else use B-JIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WCHGCD    WQSE02           Item Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
     C                     Z-ADDP1HGCD    WQSE02           Item Code
      * Establish starting position
     C           KRSSE     SETLL@FDREAW                    *
     C           KRSSE     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Allocation Meth
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv SchShpDte         RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * CASE: DB1.Allocation Method is Standard or Blank
     C           WCENST    IFEQ *BLANK                     *IF
     C           WCENST    OREQ 'S'
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
     C                     EXSR SGRVGN
      * CASE: LCL.Scheduled Ship Date LE LCL.Date                  USR
     C           YL0003    IFLE YL0004                     *IF
     C                     MOVEL'F'       YL0002           Allocation Meth
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'B'       YL0002           Allocation Meth
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWCENST    YL0002           Allocation Meth
     C                     END                             *FI
     C           KRSSE     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv SchShpDte         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDC4NB    WQSF01           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Order Number
      * Setup key
     C                     Z-ADDP1C4NB    WQSF01           Order Number
      * Establish starting position
     C           KRSSF     SETLL@BFCPY2                    *
     C           KRSSF     READE@BFCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Scheduled Ship
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDAODT    YL0003           Scheduled Ship
     C           KRSSF     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv PrdDay Dte -Durtn RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSG01           Company Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
      * Setup key
     C                     Z-ADDWCAIC3    WQSG01           Company Number
     C                     Z-ADD##JDT     WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSG     SETLL@AFREY1                    *
     C           KRSSG     READE@AFREY1                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ 3                          *IF
     C                     Z-ADDWEBCDT    YL0004           *DATE
     C                     GOTO SGEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSG     READE@AFREY1                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Avail-To-Sell RqShpRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 12/5/18 chg access path to opbgcplo so it will wrk in  copy o
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDC4NB    WQSH01           Order Number
     C           *LIKE     DEFN WDAIC3    WQSH02           Company Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Order Number
     C                     KFLD           WQSH02           Company Number
      * Setup key
     C                     Z-ADDP1C4NB    WQSH01           Order Number
     C                     Z-ADDP1AIC3    WQSH02           Company Number
      * Establish starting position
     C           KRSSH     SETLL@BFCPY2                    *
     C           KRSSH     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDJNCD    P1JNCD           Order Type - Sa
     C                     Z-ADDWDA0DT    P1A0DT           Order Date
     C                     Z-ADDWDEIDT    P1EIDT           Requested Deliv
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * R11425 RMC 8/8/17 DONT DO the 3 day hard stop on fresh
      *  limiting fresh prod to only being made 3 days prior to ship- Per
      * E2073 RMC Per Curt
      * 8/21/12 RMC Use Whs Prod Sch MAx days when sched prod to be made-
      *   FZ Prod Sched chill time will still be 7 days, so this make a w
      *   of time -- from 7 days to say 21 days back instead of using the
      *   days. they can override the max days using the CIE Use Age Days
      *   to sched it farther back than the Whs Prod Sch Max days.
      * 8/01/12 RMC Use Whs Inv Chill from Whs file for Inv calcs. it wil
      *    different than the Warehouse Chilling time used for prod sched
      *  ie. for FZ whses, prod sched is 14 days, and Inv Chill is 7 days
      * E2073 RMC Per Curt
      * 7/11/12 Below, with exceptions, field stored in Comp Item Ext:
      *    Use Age Days over Max
      * 6/26/12 dont sched prod to be made more than 3 PROD Days - not ca
      * 4/27/12 dont sched prod to be made more than 3 days prior ship da
      *    and keeping the age in mind.   E2073 RMC Per curt
      * *---------------------------------------------------------------*
      * * FP1309 03/17/09  slm  Pass new fields thru to other functions
      * * Item age days, Production Override age From/To Date
      * *    change rtv on order header to pull other fields
      * *---------------------------------------------------------------*
      * FP1309 Revd with Group ON this go ahead and use the Item Age Days
      * FOR THE LCL. ITEM AGE DAYS
      * *---------------------------------------------------------------*
      * * FP1054 05/26/09  RMC  If ATS Adj Type USR="OA",
      * *    then set ATS Adj Type USR per Company item Inv alloc seq
      * * FP1054 05/26/09  RMC  new type: OL reallocate-alloc inv last (f
      * *               new type: OI reallocate-alloc inv First(for freez
      * * FP1054 04/14/09  RMC  new type: OF reallocate-override fz time
      * * FP1054 01/20/09  RMC
      * 2/25/09   Dont do this after all:
      * 2/13/09 Get the Order Date and check for CONVERTED items:
      *    If the Order Date<job date, allow allocating current day's BAS
      *    production for the order
      *    If the Order Date=job date, do not allocate current day's prod
      *    to the order.  So during order entry, the current day's BASE p
      *    won't be allocated to a converted item
      * *---------------------------------------------------------------*
      * * 04/24/02 PKD 1) Changed allocation to default Age Code = A
      * *              2) Changed PAR context to LCL context every place
      * *                 PAR.Age Code was used.
      * *---------------------------------------------------------------*
      * * 10/10/02 PKD 1) If Age Code is > D, then make it D
      * *---------------------------------------------------------------*
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * E3796 JJH 02/11/15 - Utilize Requested Ship Date for Production
      *  Schedule Reports
      *  - Modify "RTV Avail-To-Sell RqShpRT - Order Header TRG" to outpu
      *    Requested Ship Date.
      *  - Replace PAR.Ship Date USR with LCL.Requested Ship Date.  This
      *    is performed at 6 places in this program.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Update Availability using Production Detail
      *================================================================
     C                     MOVELP1ZLST    P1QJST           ATS Adj Type US
     C                     MOVELP1ZLST    YL0011           ATS Adj Type US
      * Modify Adjust Type for Order Alloc only
      * CASE: PAR.ATS Adj Type USR is Order Allocate
     C           P1ZLST    IFEQ 'OA'                       *IF
      * Modify Adj Type based on Company/Item Info.  (NEW)
      * CASE: PAR.Warehouse Type is Fresh
     C           P5WPST    IFEQ 'FR'                       *IF
      * CASE: PAR.Fresh Inv Allocation Seq is First
     C           P2SYST    IFEQ 'F'                        *IF
     C                     MOVEL'OI'      YL0011           ATS Adj Type US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'OL'      YL0011           ATS Adj Type US
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Warehouse Type is Frozen
     C           P5WPST    IFEQ 'FZ'                       *IF
      * CASE: PAR.Frozen Inv Allocation Seq is First
     C           P2S1ST    IFEQ 'F'                        *IF
     C                     MOVEL'OI'      YL0011           ATS Adj Type US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'OL'      YL0011           ATS Adj Type US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.ATS Adj Type USR is Order Allocates -override
     C           YL0011    IFEQ 'OI'                       *IF
     C           YL0011    OREQ 'OL'
     C           YL0011    OREQ 'OF'
     C           YL0011    OREQ 'FO'
     C                     MOVEL'OA'      P1QJST           ATS Adj Type US
     C                     END                             *FI
      * Ship Off Cut
      * CASE: PAR.ATS Adj Type USR is Ship Off Cut
     C           P1ZLST    IFEQ 'SC'                       *IF
      * FP1054 UNcomment this  3/30/09
     C                     MOVEL'AO'      P1QJST           ATS Adj Type US
     C                     Z-ADD*ZERO     P2CHTM           Fresh Chilling
     C                     END                             *FI
      * FP1054 - Get order header info needed:   date and type
      * FP1309 notes
     C                     EXSR UCSUBR                     FP1309 notes
      * Process Order Allocate / Order Deallocate / Allocate As Ordered
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.ATS Adj Type USR 2 is Order Allocate
      *   |- c2    : PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
      *   '-
     C           P1QJST    IFEQ 'OA'                       *IF
     C           P1QJST    OREQ 'AO'                       *OR
      * fp1309 pass in new parms
      * C2073 pass lcl.item age days for both parms. the 2nd one was par.
      * C2073 pass lcl.item age days - leave 2nd as par.item age -- used
      * E3796 JJH 02/11/15 - Replace Ship Date USR with Requested Ship Da
      *  Replace "I  Ship Date USR     FLD   PAR Ship Date USR"
      *  With    "I  Ship Date USR     FLD   LCL Requested Ship Date"
      * UPD ATS Order Allocate XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDCNXFR'              90  UPD ATS Order A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0006  30       Company Number
     C                     PARM P1C4NB    WQ0007  70       Order Number
     C                     PARM P1DPNB    WQ0008  30       Order Sequence
     C                     PARM P1UENB    WQ0009  30       Order Secondary
     C                     PARM P1HGCD    WQ0010  70       Item Code
     C                     PARM P1AJCD    WQ0011  3        Warehouse Code
     C                     PARM P1HLDT    WQ0012  70       Ship Date USR
     C                     PARM P1AVQT    WQ0013 112       Quantity Ordere
     C                     PARM P1D0WG    WQ0014 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WQ0015 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WQ0016 112       Weight Schedule
     C                     PARM YL0011    WQ0017  2        ATS Adj Type US
     C                     PARM P1BXVN    WQ0018 10        PSAA Program Na
     C           P1HWQT    PARM P1HWQT    WQ0019 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WQ0020 112       ATS Weight Need
     C                     PARM P1AIWG    WQ0021 112       Unit Weight
     C                     PARM P1QJST    WQ0022  2        ATS Adj Type US
     C                     PARM *ZERO     WQ0023  70       Production Date
     C                     PARM P1A0DT    WQ0024  70       Order Date
     C                     PARM P1JNCD    WQ0025  2        Order Type - Sa
     C                     PARM P1EIDT    WQ0026  70       Requested Deliv
     C                     PARM YL0005    WQ0027  40       Item Age Days
     C                     PARM YL0006    WQ0028  70       Production Ovr
     C                     PARM YL0007    WQ0029  70       Production Ovr
     C                     PARM P2ADCD    WQ0030  2        U/M - Primary
     C                     PARM P2CHTM    WQ0031  52       Fresh Chilling
     C                     PARM P2QZCD    WQ0032  2        Base/Conv/Loss
     C                     PARM P2R3CD    WQ0033  6        Department Code
     C                     PARM P2PCCT    WQ0034  1        Piece Count Ite
     C                     PARM P2BDNB    WQ0035  70       Pieces Per Bag
     C                     PARM P2BJNB    WQ0036  70       Bags Per Unit
     C                     PARM P2SUST    WQ0037  1        Export/Domestic
     C                     PARM P2SVST    WQ0038  1        Print On Schedu
     C                     PARM P2SYST    WQ0039  1        Fresh Inv Alloc
     C                     PARM P2SZST    WQ0040  1        Fresh Sched As
     C                     PARM P2S1ST    WQ0041  1        Frozen Inv Allo
     C                     PARM P2XRCD    WQ0042  6        Primal Group Co
     C                     PARM P5WPST    WQ0043  2        Warehouse Type
     C                     PARM P5T1ST    WQ0044  1        Warehouse Std C
     C                     PARM P5DBNB    WQ0045  52       Warehouse Chill
     C                     PARM P5BVC3    WQ0046  30       WHS Inventory C
     C                     PARM P1RINY    WQ0047  40       Item age days u
     C                     PARM P1TIDT    WQ0048  70       Prod Ovr AgeDte
     C                     PARM P1TJDT    WQ0049  70       Prod Ovr AgeDte
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.ATS Adj Type USR 2 is Order Deallocate
     C           P1QJST    IFEQ 'OD'                       *IF
      * E3796 JJH 02/11/15 - Replace Ship Date USR with Requested Ship Da
      *  Replace "I  Ship Date USR     FLD   PAR Ship Date USR"
      *  With    "I  Ship Date USR     FLD   LCL Requested Ship Date"
      * UPD ATS Order DeAlloc  XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDCPXFR'              90  UPD ATS Order D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0050  30       Company Number
     C                     PARM P1C4NB    WQ0051  70       Order Number
     C                     PARM P1DPNB    WQ0052  30       Order Sequence
     C                     PARM P1UENB    WQ0053  30       Order Secondary
     C                     PARM P1HGCD    WQ0054  70       Item Code
     C                     PARM P1AJCD    WQ0055  3        Warehouse Code
     C                     PARM P1HLDT    WQ0056  70       Ship Date USR
     C                     PARM P1AVQT    WQ0057 112       Quantity Ordere
     C                     PARM P1D0WG    WQ0058 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WQ0059 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WQ0060 112       Weight Schedule
     C                     PARM P1BXVN    WQ0061 10        PSAA Program Na
     C           P1HWQT    PARM P1HWQT    WQ0062 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WQ0063 112       ATS Weight Need
     C                     PARM P1AIWG    WQ0064 112       Unit Weight
     C                     PARM P1QJST    WQ0065  2        ATS Adj Type US
     C                     PARM *ZERO     WQ0066  70       Production Date
     C                     PARM P2ADCD    WQ0067  2        U/M - Primary
     C                     PARM P2CHTM    WQ0068  52       Fresh Chilling
     C                     PARM P2QZCD    WQ0069  2        Base/Conv/Loss
     C                     PARM P2R3CD    WQ0070  6        Department Code
     C                     PARM P2PCCT    WQ0071  1        Piece Count Ite
     C                     PARM P2BDNB    WQ0072  70       Pieces Per Bag
     C                     PARM P2BJNB    WQ0073  70       Bags Per Unit
     C                     PARM P2SUST    WQ0074  1        Export/Domestic
     C                     PARM P2SVST    WQ0075  1        Print On Schedu
     C                     PARM P2SYST    WQ0076  1        Fresh Inv Alloc
     C                     PARM P2SZST    WQ0077  1        Fresh Sched As
     C                     PARM P2S1ST    WQ0078  1        Frozen Inv Allo
     C                     PARM P2XRCD    WQ0079  6        Primal Group Co
     C                     PARM P5WPST    WQ0080  2        Warehouse Type
     C                     PARM P5T1ST    WQ0081  1        Warehouse Std C
     C                     PARM P5DBNB    WQ0082  52       Warehouse Chill
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * FP1309 notes
      *================================================================
      * FP1309  slm 03122010
      * FP1309  --- This function will be changed to pass the data
      * elements that are need to calculate a fromto production date
      * or the calculation of number of days aged.
      * Get the Order detail information
      * From the prior programs - Change the Parms for the new fields
      * Get the Order Header from the prv rtv
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1HWQT           ATS Quantity Ne
     C                     Z-ADD*ZERO     P1ENWG           ATS Weight Need
     C                     Z-ADD*ZERO     P1EOWG           ATS Weight Avai
     C                     Z-ADD*ZERO     P1HXQT           ATS Quantity Av
     C                     MOVEL*BLANK    P1V5ST           Production Type
     C                     Z-ADD*ZERO     P1AIWG           Unit Weight
     C                     Z-ADD*ZERO     P1ELDT           Production Date
     C                     Z-ADD*ZERO     P1GVDT           Production Date
     C                     Z-ADD*ZERO     P1GWDT           Production Date
     C                     Z-ADD*ZERO     P1E1WG           Weight Allocate
     C                     Z-ADD*ZERO     P1IHQT           Quantity Alloca
     C                     MOVEL*BLANK    P1QJST           ATS Adj Type US
     C                     Z-ADD*ZERO     P1EINB           Week Number
     C                     Z-ADD*ZERO     P1ESNB           Accounting Year
     C                     Z-ADD*ZERO     P1ETNB           Accounting Peri
     C                     Z-ADD*ZERO     P1BZNB           OM Week
     C                     Z-ADD*ZERO     P1LHDT           Week Begin Date
     C                     Z-ADD*ZERO     P1LIDT           Week End Date
     C                     Z-ADD*ZERO     P1IPQT           Quantity Deallo
     C                     Z-ADD*ZERO     P1F1WG           Weight Dealloca
     C                     Z-ADD*ZERO     P1QSOY           Quantity Sched
     C                     Z-ADD*ZERO     P1EAWG           Weight Sched Pr
     C                     MOVEL*BLANK    P1CPCD           USR Warehouse C
     C                     Z-ADD*ZERO     P1A0DT           Order Date
     C                     MOVEL*BLANK    P1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     MOVEL*BLANK    P2ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P2CHTM           Fresh Chilling
     C                     MOVEL*BLANK    P2QZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    P2R3CD           Department Code
     C                     MOVEL*BLANK    P2PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     P2BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     P2BJNB           Bags Per Unit
     C                     MOVEL*BLANK    P2SUST           Export/Domestic
     C                     MOVEL*BLANK    P2SVST           Print On Schedu
     C                     MOVEL*BLANK    P2SYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    P2SZST           Fresh Sched As
     C                     MOVEL*BLANK    P2S1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    P2XRCD           Primal Group Co
     C                     Z-ADD*ZERO     P3UNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     P4AODT           Scheduled Ship
     C                     MOVEL*BLANK    P4AYAA           Order From Ware
     C                     Z-ADD*ZERO     P4IUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     P4F3WG           OD Weight Inv S
     C                     MOVEL*BLANK    P5WPST           Warehouse Type
     C                     MOVEL*BLANK    P5XUST           Trans Contol AS
     C                     MOVEL*BLANK    P5T0ST           Warehouse Locat
     C                     MOVEL*BLANK    P5T1ST           Warehouse Std C
     C                     Z-ADD*ZERO     P5DBNB           Warehouse Chill
     C                     Z-ADD*ZERO     P5BUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     P5BVC3           WHS Inventory C
     C                     Z-ADD*ZERO     P6CSHD           Chill Time USR
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCOQNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WCORNY           CIE Unused Numb
     C                     Z-ADD*ZERO     WCS2DT           CIE Unused Date
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WECQNB           Julian Date
     C                     Z-ADD*ZERO     WEESNB           Accounting Year
     C                     Z-ADD*ZERO     WEETNB           Accounting Peri
     C                     Z-ADD*ZERO     WEBZNB           OM Week
     C                     Z-ADD*ZERO     WEEINB           Week Number
     C                     Z-ADD*ZERO     WEAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WEOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WENQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WENRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WEOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WEOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
     C                     MOVEL'N'       W0PMT   1
      * Define local work field CIE Use Age Days over Max
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field Allocation Method
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Date                  USR
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Item Age Days
     C                     Z-ADD*ZERO     YL0005  40
      * Define local work field Production Ovr AgeDte Fr
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Production Ovr AgeDte To
     C                     Z-ADD*ZERO     YL0007  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0001  70
      * Define local work field Days
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field Date From             USR
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Day 1 Production 5,0  USR
     C                     Z-ADD*ZERO     YL0010  50
      * Define local work field ATS Adj Type USR
     C                     MOVEL*BLANK    YL0011  2
      *================================================================
     CSR         ZZEXIT    ENDSR
