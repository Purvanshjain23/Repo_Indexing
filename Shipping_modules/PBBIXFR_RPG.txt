     H/TITLE EXC Order Req Rvw editsXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/08/21  Time  : 16:04:05
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFJCPLFIF  E           K        DISK
      * RSQ : Load Header               Whse/SchdShpDt/Load
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPOA3REL2IF  E           K        DISK
      * RSQ : Load Slotting Sched Ctl   Co/Whse/Day  (D)
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     E                    #L7         7  1
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@FJCPN3
      * Load Header               Whse/SchdShpDt/Load
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WEAIC3
     I              KMV8CD                          WEV8CD
     I              KMAUNA                          WEAUNA
     I              KMI5ST                          WEI5ST
     I              KMBXTX                          WEBXTX
     I              KMM8NB                          WEM8NB
     I              KMUVST                          WEUVST
     I              KMUWST                          WEUWST
     I              KMUXST                          WEUXST
     I              KMVSST                          WEVSST
     I              KMAATM                          WEAATM
     I              KMAYNA                          WEAYNA
     I              KMA0NA                          WEA0NA
     I              KMAXDT                          WEAXDT
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WFAIC3
     I              AFBCDT                          WFBCDT
     I              AFCQNB                          WFCQNB
     I              AFESNB                          WFESNB
     I              AFETNB                          WFETNB
     I              AFBZNB                          WFBZNB
     I              AFA9ST                          WFA9ST
     I              AFEINB                          WFEINB
     I              AFC5ST                          WFC5ST
     I              AFAQNB                          WFAQNB
     I              AFCMST                          WFCMST
     I              AFV9ST                          WFV9ST
     I              AFWAST                          WFWAST
     I              AFX2ST                          WFX2ST
     I              AFOJDT                          WFOJDT
     I              AFNQNX                          WFNQNX
     I              AFNRNX                          WFNRNX
     I              AFI9SX                          WFI9SX
     I              AFJASX                          WFJASX
     I              AFOKDT                          WFOKDT
     I              AFOLDT                          WFOLDT
     I              AFUVST                          WFUVST
     I              AFUWST                          WFUWST
     I              AFUXST                          WFUXST
     I              AFAATM                          WFAATM
     I              AFAYNA                          WFAYNA
     I              AFA0NA                          WFA0NA
     I              AFAXDT                          WFAXDT
      *
     I@A3REI3
      * Load Slotting Sched Ctl   Co/Whse/Day  (D)
      * Renamed input format fields
     I              A3AIC3                          WGAIC3
     I              A3AJCD                          WGAJCD
     I              A3A9ST                          WGA9ST
     I              A3NVNX                          WGNVNX
     I              A3NWNX                          WGNWNX
     I              A3NXNX                          WGNXNX
     I              A3IOWG                          WGIOWG
     I              A3IPWG                          WGIPWG
     I              A3IQWG                          WGIQWG
     I              A3JCSX                          WGJCSX
     I              A3NYNX                          WGNYNX
     I              A3IRWG                          WGIRWG
     I              A3UVST                          WGUVST
     I              A3UWST                          WGUWST
     I              A3UXST                          WGUXST
     I              A3VSST                          WGVSST
     I              A3AATM                          WGAATM
     I              A3AYNA                          WGAYNA
     I              A3A0NA                          WGA0NA
     I              A3AXDT                          WGAXDT
      *
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                          WHAIC3
     I              IHQ7CD                          WHQ7CD
     I              IHMLNA                          WHMLNA
     I              IHU0ST                          WHU0ST
     I              IHV8ST                          WHV8ST
     I              IHBYST                          WHBYST
     I              IHRMNY                          WHRMNY
     I              IHH3ST                          WHH3ST
     I              IHH5ST                          WHH5ST
     I              IHH6ST                          WHH6ST
     I              IHH7ST                          WHH7ST
     I              IHUVST                          WHUVST
     I              IHUWST                          WHUWST
     I              IHUXST                          WHUXST
     I              IHAATM                          WHAATM
     I              IHAYNA                          WHAYNA
     I              IHA0NA                          WHA0NA
     I              IHAXDT                          WHAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                              8
      * KEY : Order Header TRG          Load Exports
      * I : RST Load ID
     I                                    P   1   40PARMNB
      *
      * Outward parameters
     IPBRC        DS                             12
      * KEY : Order Detail              Ship To/Price Code/Item
      * I :  Ship To Customer
     I                                    P   1   40PBBKC7
      * I :  Price Code
     I                                    P   5   80PBBVTM
      * I :  Item Code
     I                                    P   9  120PBHGCD
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WIAIC3
     I              OMC4NB                          WIC4NB
     I              OMDPNB                          WIDPNB
     I              OMUENB                          WIUENB
     I              OMHGCD                          WIHGCD
     I              OMAJCD                          WIAJCD
     I              OMBKC7                          WIBKC7
     I              OMCFC7                          WICFC7
     I              OMGMST                          WIGMST
     I              OMGNST                          WIGNST
     I              OMMAVA                          WIMAVA
     I              OMKDVA                          WIKDVA
     I              OML8VA                          WIL8VA
     I              OML9VA                          WIL9VA
     I              OMGTST                          WIGTST
     I              OMGVST                          WIGVST
     I              OMGUST                          WIGUST
     I              OMQFST                          WIQFST
     I              OMAYVA                          WIAYVA
     I              OMEXDT                          WIEXDT
     I              OMLQCD                          WILQCD
     I              OMRDCD                          WIRDCD
     I              OMQ7CD                          WIQ7CD
     I              OMBZPR                          WIBZPR
     I              OML6NB                          WIL6NB
     I              OMU1ST                          WIU1ST
     I              OMGIDT                          WIGIDT
     I              OMCRCD                          WICRCD
     I              OMAGCD                          WIAGCD
     I              OMRZST                          WIRZST
     I              OMR0ST                          WIR0ST
     I              OMR1ST                          WIR1ST
     I              OMG7NA                          WIG7NA
     I              OMG8NA                          WIG8NA
     I              OMRPCD                          WIRPCD
     I              OMVEST                          WIVEST
     I              OMVGST                          WIVGST
     I              OMAVST                          WIAVST
     I              OMU0ST                          WIU0ST
     I              OMRFCD                          WIRFCD
     I              OMFZST                          WIFZST
     I              OMR1NB                          WIR1NB
     I              OMAVQT                          WIAVQT
     I              OMD0WG                          WID0WG
     I              OMCCQT                          WICCQT
     I              OMAUWG                          WIAUWG
     I              OMCBQT                          WICBQT
     I              OMATWG                          WIATWG
     I              OMAQCS                          WIAQCS
     I              OMAGCS                          WIAGCS
     I              OMAKPR                          WIAKPR
     I              OMALPR                          WIALPR
     I              OMAUPR                          WIAUPR
     I              OMAVWG                          WIAVWG
     I              OMA4WG                          WIA4WG
     I              OMA5DT                          WIA5DT
     I              OMAODT                          WIAODT
     I              OMGNDT                          WIGNDT
     I              OMAMST                          WIAMST
     I              OMANST                          WIANST
     I              OMVAST                          WIVAST
     I              OMRGNB                          WIRGNB
     I              OMRHNB                          WIRHNB
     I              OMRINB                          WIRINB
     I              OMRBCD                          WIRBCD
     I              OMHICD                          WIHICD
     I              OMRNCD                          WIRNCD
     I              OMROCD                          WIROCD
     I              OMCXDT                          WICXDT
     I              OMAJVN                          WIAJVN
     I              OMKXCD                          WIKXCD
     I              OMJPCD                          WIJPCD
     I              OMCQCD                          WICQCD
     I              OMR4CD                          WIR4CD
     I              OMZ1ST                          WIZ1ST
     I              OMZ3ST                          WIZ3ST
     I              OMZ4ST                          WIZ4ST
     I              OMDUPR                          WIDUPR
     I              OMB6VL                          WIB6VL
     I              OMA1AA                          WIA1AA
     I              OMFZSX                          WIFZSX
     I              OMF0SX                          WIF0SX
     I              OMF1SX                          WIF1SX
     I              OMF2SX                          WIF2SX
     I              OMF3SX                          WIF3SX
     I              OMF4SX                          WIF4SX
     I              OMF5SX                          WIF5SX
     I              OMF6SX                          WIF6SX
     I              OMF7SX                          WIF7SX
     I              OMNTDT                          WINTDT
     I              OMNUDT                          WINUDT
     I              OMNVDT                          WINVDT
     I              OMNWDT                          WINWDT
     I              OMNXDT                          WINXDT
     I              OMBUTM                          WIBUTM
     I              OMBVTM                          WIBVTM
     I              OMBWTM                          WIBWTM
     I              OMBXTM                          WIBXTM
     I              OMBYTM                          WIBYTM
     I              OMH5NX                          WIH5NX
     I              OMH6NX                          WIH6NX
     I              OMH7NX                          WIH7NX
     I              OMH8NX                          WIH8NX
     I              OMH9NX                          WIH9NX
     I              OMDVPR                          WIDVPR
     I              OMDWPR                          WIDWPR
     I              OMDXPR                          WIDXPR
     I              OMDYPR                          WIDYPR
     I              OMDZPR                          WIDZPR
     I              OMGSPR                          WIGSPR
     I              OMGTPR                          WIGTPR
     I              OMGUPR                          WIGUPR
     I              OMHOST                          WIHOST
     I              OMHPST                          WIHPST
     I              OMIOST                          WIIOST
     I              OMPEWG                          WIPEWG
     I              OMRINY                          WIRINY
     I              OMTIDT                          WITIDT
     I              OMTJDT                          WITJDT
     I              OMH2ST                          WIH2ST
     I              OMH0ST                          WIH0ST
     I              OMH1ST                          WIH1ST
     I              OMTKDT                          WITKDT
     I              OMTLDT                          WITLDT
     I              OMTMDT                          WITMDT
     I              OMUVST                          WIUVST
     I              OMUWST                          WIUWST
     I              OMUXST                          WIUXST
     I              OMAATM                          WIAATM
     I              OMAYNA                          WIAYNA
     I              OMA0NA                          WIA0NA
     I              OMAXDT                          WIAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     IYBRDCS      DS                            779
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I :  Ship To Customer
     I                                    P   7  100P1BKC7
      * I :  Requested Ship Date
     I                                    P  11  140P1A5DT
      * I :  Scheduled Ship Date
     I                                    P  15  180P1AODT
      * I :  Requested Delivery Date
     I                                    P  19  220P1EIDT
      * I :  Requested Delivery Time
     I                                    P  23  250P1AFTM
      * I : RST Load ID
     I                                    P  26  290P1RMNB
      * B :  Order Requires Review
     I                                       30  31 P1FUSX
     IP2PARM      DS
      * FLD: Order Detail
      * I :  Warehouse Code
     I                                        1   3 P2AJCD
      * B :  Order Line Error Type
     I                                        4   6 P2H1ST
     IP3PARM      DS
      * FLD: Load Header
      * I :  Deadline Departure Date
     I                                    P   1   40P3KZDT
      * I :  Deadline Departure Time
     I                                    P   5   80P3AXTM
     IP4PARM      DS
      * I :  Company Organization
     I                                        1   1 P4YJSX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0001
      * Weight Allocated USR
     I                                    P   5   92ZA0002
      * Maximum Contract Units
     I                                    P  10  152ZA0003
      * Item Code
     I                                       16  22 ZA0004
      * Message data for 'Price Code max wgt exceed'
      * Price Code
     I                                    P   1   40ZA0005
      * Weight Allocated USR
     I                                    P   5   92ZA0006
      * Maximum Contract Units
     I                                    P  10  152ZA0007
      * Item Code
     I                                       16  22 ZA0008
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0009
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0010
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0011
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0012
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0013
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0014
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0015
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0016
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0017
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0018
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0019
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0020
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0021
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0022
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0023
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0024
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0025
      * Production AgeDte To
     I                                    P   5   80ZA0026
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P1A5DT    PARM           WP0004  70       Requested Ship
     C           P1AODT    PARM           WP0005  70       Scheduled Ship
     C           P1EIDT    PARM           WP0006  70       Requested Deliv
     C           P1AFTM    PARM           WP0007  40       Requested Deliv
     C           P1RMNB    PARM           WP0008  70       Load ID
     C           P1FUSX    PARM P1FUSX    WP0009  2        Order Requires
     C           P2AJCD    PARM           WP0010  3        Warehouse Code
     C           P2H1ST    PARM P2H1ST    WP0011  3        Order Line Erro
     C           P3KZDT    PARM           WP0012  70       Deadline Depart
     C           P3AXTM    PARM           WP0013  60       Deadline Depart
     C           P4YJSX    PARM           WP0014  1        Company Organiz
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EXC Order Req Rvw editsXF
     C                     MOVEL'N'       WUECST           Error Status
     C                     MOVEL*BLANK    P1FUSX           Order Requires
      * ** Test start and end contract dates against the Scheduled Ship D
      * Rtv Price Code        RT - Order Detail  * 
     C                     EXSR SARVGN
      * Rtv Cust Prc Str/End  XF - Customer Price Header  * 
     C                     CALL 'PNTAXFR'              90  Rtv Cust Prc St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1BKC7    WQ0001  70       Ship To Custome
     C                     PARM WUBVTM    WQ0002  60       Price Code
     C           YL0001    PARM *ZERO     WQ0003  70       Price Start Dat
     C           YL0002    PARM *ZERO     WQ0004  70       Price End Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNTAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * test contract start and end dates
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Scheduled Ship Date LT LCL.Price Start Date
      *   |- c2    : PAR.Scheduled Ship Date GT LCL.Price End Date
      *   '-
     C           P1AODT    IFLT YL0001                     *IF
     C           P1AODT    ORGT YL0002                     *OR
     C                     MOVEL'Y'       WUECST           Error Status
     C                     MOVEL*BLANK    P2H1ST           Order Line Erro
     C                     MOVEL'DT'      P2H1ST           Order Line Erro
     C                     END                             *FI
      * ** Calc slots assigned for the SSD/Whse. If slots available is
      * ** exceeded, flag order header and detail with the errror and
      * ** continue with the next load
      * ** Test Slotting only if Load ID is entered           P001251
      * CASE: PAR.Load ID is GT Zero
     C           P1RMNB    IFGT *ZERO                      *IF
      * ** Only check slotting limits if Seaboard
      * CASE: PAR.Company Organization is Seaboard
     C           P4YJSX    IFEQ 'S'                        *IF
      * ** Retrieve number of loads slotted for SSD/Whse
      * RTV Limit Loads f/Slot RT - Load Header  * 
     C                     EXSR SBRVGN
      * RTV Day and Week No.   RT - Calendar  * 
     C                     EXSR SGRVGN
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
     C                     EXSR SHRVGN
      * CASE: WRK.Export Load Limit GT WRK.Slot Limit for Export
     C           WUIUNX    IFGT WUNVNX                     *IF
     C                     MOVEL*BLANK    P2H1ST           Order Line Erro
     C                     MOVEL'SL'      P2H1ST           Order Line Erro
     C                     MOVEL'E'       WUGMST           Detail Line Sta
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Test and update Order Detail lines
     C                     MOVEL'N'       YL0016           Error Status
      * RTV EOA Upl Err Valid RT - Order Detail  * 
     C                     EXSR SIRVGN
      * CASE: LCL.Error Status is yes
     C           YL0016    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C                     END                             *FI
      * ** Update Order Header & Detail error flags         P001251
      * CASE: WRK.Error Status is yes
     C           WUECST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    P1FUSX           Order Requires
     C                     MOVEL'Y'       P1FUSX           Order Requires
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0006           Company Number
     C                     Z-ADDP1C4NB    WL0007           Order Number
     C                     MOVELP1FUSX    WL0008    P      Order Requires
     C                     EXSR SLCHRC
      * CHG Ord Line Err       RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP1C4NB    WL0010           Order Number
     C                     Z-ADD1         WL0011           Order Sequence
     C                     Z-ADD1         WL0012           Order Secondary
     C                     MOVELP2H1ST    WL0013    P      Order Line Erro
     C                     EXSR SMRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P1FUSX           Order Requires
     C                     MOVEL*BLANK    P2H1ST           Order Line Erro
      * ** Update Header with cleared Order Requires Review if no more er
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0006           Company Number
     C                     Z-ADDP1C4NB    WL0007           Order Number
     C                     MOVELP1FUSX    WL0008    P      Order Requires
     C                     EXSR SLCHRC
      * CHG Ord Line Err       RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP1C4NB    WL0010           Order Number
     C                     Z-ADD1         WL0011           Order Sequence
     C                     Z-ADD1         WL0012           Order Secondary
     C                     MOVELP2H1ST    WL0013    P      Order Line Erro
     C                     EXSR SMRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Price Code        RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
     C                     Z-ADD1         WADPNB           Order Sequence
     C                     Z-ADD1         WAUENB           Order Secondary
      * Establish starting position
     C           KRSSA     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBVTM           Price Code
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWABVTM    WUBVTM           Price Code
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Limit Loads f/Slot RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUIUNX           Export Load Lim
     C                     Z-ADD*ZERO     WUBINX           Combo Load Limi
     C                     Z-ADD*ZERO     WUBHNX           Box Load Limit
     C                     MOVEL'N'       WUYIST           Record Found -O
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR SCRVGN
      * ** Retrieve needed values from System Values file     E000233
      * Rtv Company Ctl Vals  XF - Company Values  * 
     C                     CALL 'PNOQXFR'              90  Rtv Company Ctl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0005  30       Company Number
     C           YL0004    PARM *ZERO     WQ0006  50       Box Load Min Bo
     C           YL0005    PARM *ZERO     WQ0007  70       Partial Load Ma
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * change log
     C                     EXSR UASUBR                     change log
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBVPCD    WQSB02           Ship From Wareh
     C           *LIKE     DEFN WBAODT    WQSB03           Scheduled Ship
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB02           Ship From Wareh
     C                     KFLD           WQSB03           Scheduled Ship
      * Setup key
     C                     MOVELP2AJCD    WQSB02           Ship From Wareh
     C                     Z-ADDP1AODT    WQSB03           Scheduled Ship
      * Establish starting position
     C           KRSSB     SETLL@FJCPN3                    *
     C           KRSSB     READE@FJCPN3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC 9/11/13 E2709
      * Check for Mixed having box qty>BOXLOAD qty, if yes, then BX, else
      * Change Priority 3/14/01    RMC
      * Check for Mixed having a box qty > 60 to stay BX   6/12/01    RMC
      * Per Steve Burke - 6/27/01
      * Dont check just for Prepaid Trucks.  Collect and Prepaid trucks i
      * If Partial Load (<= 20000 lbs) dont count.
      * Priority :  Combo , Export, Box
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Load Type is Regular
      *   |- c2    : DB1.Total Load Order Weight GT LCL.Partial Load Max
      *   |- c3    : DB1.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBVDST    IFEQ 'R'                        *IF
     C           WBRPNB    IFGT YL0005                     *IF
     C           WBQ2CD    IFEQ 'CT'                       *IF
     C           WBQ2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Update load found so this load wont be counted again in the calli
      * CASE: DB1.Load ID EQ PAR.Load ID
     C           WBRMNB    IFEQ P1RMNB                     *IF
     C                     MOVEL'Y'       WUYIST           Record Found -O
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0006           Boxes Total Qua
      * 05/11/04 SLM PKTR01 Multi-Company - Function chgd-remove Company
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0007    IFEQ 'CB'                       *IF
     C                     ADD  1         WUBINX           Combo Load Limi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWBU2ST    YL0010           Export Status D
      * Count Load as Export if order whse = Ship-From-Whse & Export 8/3/
      * CASE: DB1.Export Status is yes
     C           WBU2ST    IFEQ 'Y'                        *IF
      * See if export order whse matches load Shipfrom whse  08/03/07 RMC
      * For example a load could be export sts=Y and ship from whse is GP
      * there are multiple orders, and the one that is export is out of C
      *  in that case, dont count the load as export- per Steve B and Jim
      * RTV ExpOrd Whse for LD XF - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWBRMNB    PARMNB           Load ID
      *
     C                     CALL 'PMK2XFR'              90  RTV ExpOrd Whse
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
     C                     PARM WBVPCD    WQ0008  3        Ship From Wareh
     C           YL0010    PARM YL0010    WQ0009  1        Export Status D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMK2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: LCL.Export Status Dft is yes
     C           YL0010    IFEQ 'Y'                        *IF
     C                     ADD  1         WUIUNX           Export Load Lim
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUBHNX           Box Load Limit
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@FJCPN3                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELP2AJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Shipping Compan
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCBWC3    YL0003           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Funt chg to rmv Co RST or Pos
     C                     MOVEL*BLANK    YL0007           USR Unit of Mea
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSD01           Load ID
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Load ID
     C                     KFLD           WDC4NB           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSD01           Load ID
     C                     Z-ADD*ZERO     WDC4NB           Order Number
      * Establish starting position
     C           KPSSD     SETLL@BFCPR0                    *
     C           KRSSD     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
     C                     EXSR SERVGN
     C           KRSSD     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * RMC E2709 added here so it wont need to be in every calling pgm
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0007    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SFRVGN
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0006    IFLT YL0009                     *IF
     C                     MOVEL'CB'      YL0007           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0007           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSE02           Order Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           WADPNB           Order Sequence
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDWDAIC3    WQSE01           Company Number
     C                     Z-ADDWDC4NB    WQSE02           Order Number
     C                     Z-ADD1         WADPNB           Order Sequence
      * Establish starting position
     C           KPSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0006           Boxes Total Qua
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SEEXIT                     *QUIT
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WAGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/08/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/08/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELWAAGCD    YL0008           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0008    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0008           U/M - Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration  6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0008    IFEQ 'BX'                       *IF
     C                     ADD  WAAVQT    YL0006           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           YL0007    IFEQ *BLANK                     *IF
     C                     MOVELYL0008    YL0007           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0008    IFEQ YL0007                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      YL0007           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV8CD           Company Value C
      * Setup key
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     MOVE *BLANK    WEV8CD           Company Value C
     C                     MOVEL'BOXLOAD' WEV8CD           Company Value C
      * Establish starting position
     C           KRSSF     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEM8NB    YL0009           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFBCDT    WQSG02           Post to G/L Dat
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Post to G/L Dat
      * Setup key
     C                     Z-ADDP1AIC3    WQSG01           Company Number
     C                     Z-ADDP1AODT    WQSG02           Post to G/L Dat
      * Establish starting position
     C           KRSSG     SETLL@AFREYY                    *
     C           KRSSG     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWFA9ST    WUA9ST           Day of Week
     C           KRSSG     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WGAJCD    WQSH02           Warehouse Code
     C           *LIKE     DEFN WGA9ST    WQSH03           Day of Week
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Warehouse Code
     C                     KFLD           WQSH03           Day of Week
      * Setup key
     C                     Z-ADDP1AIC3    WQSH01           Company Number
     C                     MOVELP2AJCD    WQSH02           Warehouse Code
     C                     MOVELWUA9ST    WQSH03           Day of Week
      * Establish starting position
     C           KRSSH     SETLL@A3REI3                    *
     C           KRSSH     READE@A3REI3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3033' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUNVNX           Slot Limit for
     C                     Z-ADD*ZERO     YL0011           Slot Limit for
     C                     Z-ADD*ZERO     YL0012           Slot Limit for
     C                     Z-ADD*ZERO     YL0013           Weight Limit fo
     C                     Z-ADD*ZERO     YL0014           Weight Limit fo
     C                     Z-ADD*ZERO     YL0015           Weight Limit fo
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGNVNX    WUNVNX           Slot Limit for
     C                     Z-ADDWGNWNX    YL0011           Slot Limit for
     C                     Z-ADDWGNXNX    YL0012           Slot Limit for
     C                     Z-ADDWGIOWG    YL0013           Weight Limit fo
     C                     Z-ADDWGIPWG    YL0014           Weight Limit fo
     C                     Z-ADDWGIQWG    YL0015           Weight Limit fo
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@A3REI3                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV EOA Upl Err Valid RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSI01           Company Number
     C                     Z-ADDP1C4NB    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BGWKL1                    *
     C           KRSSI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'N'       YL0016           Error Status
      * ** Test contracted Price Code Item maximum allowed weight
     C                     MOVEL'N'       YL0017           Error Status
      * Rtv Max Wt and price  XF - Customer Price Detail  * 
     C                     CALL 'PNTBXFR'              90  Rtv Max Wt and
     C                     PARM *BLANK    W0RTN   7
     C           W0RTN     PARM *BLANK    WQ0010  7        *Return code
     C                     PARM P1BKC7    WQ0011  70       Ship To Custome
     C                     PARM WUBVTM    WQ0012  60       Price Code
     C                     PARM WAHGCD    WQ0013  70       Item Code
     C           YL0018    PARM *ZERO     WQ0014 112       Maximum Contrac
     C           YL0019    PARM *ZERO     WQ0015 114       Customer Price
     C           YL0020    PARM *BLANK    WQ0016  3        Commodity Marke
     C           YL0021    PARM *BLANK    WQ0017  3        Price Method Co
     C           YL0022    PARM *BLANK    WQ0018  3        Date Method Cod
     C           YL0023    PARM *BLANK    WQ0019  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *
     C                     Z-ADD*ZERO     WN0001 112       Total Weight Or
     C                     Z-ADD*ZERO     WN0002 112       Total Quantity
     C                     Z-ADD*ZERO     WN0003 112       Maximum Contrac
     C                     Z-ADD*ZERO     WN0004 114       Customer Price
     C                     MOVEL*BLANK    WN0005  1        Contract Unit T
      *
      * Clc Sum Ship/Ord Unit IF
     C                     MOVEL'N'       YL0017           Error Status
     C           WAAVQT    MULT WAAVWG    YL0028           Weight Ordered
      * CLC Sum Ship/Ord Unit XF - Order Detail  * 
     C                     CLEARPBRC
     C                     Z-ADDP1BKC7    PBBKC7           Ship To Custome
     C                     Z-ADDWUBVTM    PBBVTM           Price Code
     C                     Z-ADDWAHGCD    PBHGCD           Item Code
      *
     C                     CALL 'PPA6XFR'              90  CLC Sum Ship/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Order Deta
     C           WN0001    PARM WN0001    WQ0020 112       Total Weight Or
     C                     PARM P1C4NB    WQ0021  70       Order Number
     C           WN0002    PARM WN0002    WQ0022 112       Total Quantity
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  YL0028    WN0001           Total Weight Or
     C                     ADD  WAAVQT    WN0002           Total Quantity
      * 5/13/10 SAZ P205-Add parm for Max Unit Type;rtv Contract Unit Typ
      * Rtv Cust Prc hdr/dtl  XF - Customer Price Header  * 
     C                     CALL 'PPA7XFR'              90  Rtv Cust Prc hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1BKC7    WQ0023  70       Ship To Custome
     C                     PARM WUBVTM    WQ0024  60       Price Code
     C           WUPLDT    PARM *ZERO     WQ0025  70       Price Start Dat
     C           WUPMDT    PARM *ZERO     WQ0026  70       Price End Date
     C                     PARM WAHGCD    WQ0027  70       Item Code
     C           WN0003    PARM *ZERO     WQ0028 112       Maximum Contrac
     C           WN0004    PARM *ZERO     WQ0029 114       Customer Price
     C           YL0020    PARM *BLANK    WQ0030  3        Commodity Marke
     C           YL0029    PARM *BLANK    WQ0031  3        Price Method Co
     C           YL0022    PARM *BLANK    WQ0032  3        Date Method Cod
     C           WN0005    PARM *BLANK    WQ0033  1        Contract Unit T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0029    YL0021           Price Method Co
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
     C                     EXSR SJRVGN
      * 5/13/10 SAZ P205-Use Contract Unit Type to check Qty or Weight-Lb
      * Use Contract Unit Type to check Qty or Weight-Lbs
      * VAL: Total Weight and Quantity w/Maximum
      * CASE: PAR.Contract Unit Type is Weight-LB
     C           WN0005    IFEQ 'W'                        *IF
      * CASE: PAR.Total Weight Ordered USR GT PAR.Maximum Contract Units
     C           WN0001    IFGT WN0003                     *IF
     C                     MOVEL'Y'       YL0017           Error Status
     C           WN0001    SUB  WN0003    YL0030           Weight Allocate
      * Setup message data for message
     C                     Z-ADDWUBVTM    ZA0001           Price Code
     C                     Z-ADDYL0030    ZA0002           Weight Allocate
     C                     Z-ADDWN0003    ZA0003           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WAHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWAHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0004           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract Unit type = Quantity
      * CASE: PAR.Total Quantity Ordered GT PAR.Maximum Contract Units
     C           WN0002    IFGT WN0003                     *IF
     C                     MOVEL'Y'       YL0017           Error Status
     C           WN0002    SUB  WN0003    YL0030           Weight Allocate
      * Setup message data for message
     C                     Z-ADDWUBVTM    ZA0005           Price Code
     C                     Z-ADDYL0030    ZA0006           Weight Allocate
     C                     Z-ADDWN0003    ZA0007           Maximum Contrac
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WAHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWAHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0008           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0008           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Price Code max wgt exceed'
     C                     MOVEL'USR3320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Original code
      * OUT: No Errors
      * CASE: PAR.Error Status is no
     C           YL0017    IFEQ 'N'                        *IF
     C                     Z-ADDWN0004    YL0024           Price Overage O
      * CASE: PAR.PMH Price Type is Invoice Price
     C           YL0027    IFEQ 'I'                        *IF
     C                     Z-ADDWN0004    YL0024           Price Overage O
     C                     Z-ADD*ZERO     YL0025           OD Ceiling Pric
     C                     ELSE
      * CASE: PAR.PMH Price Type is Ceiling Price
     C           YL0027    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     YL0024           Price Overage O
     C                     Z-ADDWN0004    YL0025           OD Ceiling Pric
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * contract weight exceeded
      * CASE: LCL.Error Status is yes
     C           YL0017    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0016           Error Status
     C                     MOVEL*BLANK    P2H1ST           Order Line Erro
     C                     MOVEL'WT'      P2H1ST           Order Line Erro
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     MOVELP2H1ST    WL0005    P      Order Line Erro
     C                     EXSR SKCHRC
     C                     END                             *FI
      * ** Test for valid Item Age Code
     C                     MOVEL'N'       YL0017           Error Status
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    YL0017           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           'S'       IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           P1EIDT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  P1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0009
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           P1AODT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  P1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0010
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHGCD    WQ0034  70       Item Code
     C                     PARM WAAJCD    WQ0035  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0036  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0037 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0038 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0039 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0040 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0041 30        Error Reason De
     C                     PARM P1AIC3    WQ0042  30       Company Number
     C                     PARM P1AODT    WQ0043  70       Scheduled Ship
     C                     PARM P1EIDT    WQ0044  70       Requested Deliv
     C                     PARM WARINY    WQ0045  40       Item Age Days
     C                     PARM WATIDT    WQ0046  70       Production Ovr
     C                     PARM WATJDT    WQ0047  70       Production Ovr
     C           YL0031    PARM YL0031    WQ0048  70       Production AgeD
     C           YL0032    PARM YL0032    WQ0049  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'V'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0031    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWARINY    ZA0012           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WATIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0013
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WATJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWARINY    ZA0015           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WATIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0016
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WATJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0017
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWARINY    ZA0018           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WATIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0019
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WATJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0020
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWARINY    ZA0021           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WATIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WATJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0023
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           WATIDT    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADDWARINY    ZA0024           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0031    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0025
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  YL0032    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0026
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       YL0017           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * item age code
      * CASE: LCL.Error Status is yes
     C           YL0017    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0016           Error Status
     C                     MOVEL*BLANK    P2H1ST           Order Line Erro
     C                     MOVEL'AC'      P2H1ST           Order Line Erro
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     MOVELP2H1ST    WL0005    P      Order Line Erro
     C                     EXSR SKCHRC
     C                     END                             *FI
      * ** Check for Weight Scheduled for all items
     C                     MOVEL'N'       YL0017           Error Status
      * no weight scheduled
      * CASE: DB1.OD Production Plan Sts is Yes
     C           WAR1ST    IFEQ *BLANK                     *IF
      * CASE: DB1.Weight Scheduled is Equal to zero
     C           WAAUWG    IFEQ 0                          *IF
     C                     MOVEL'Y'       YL0016           Error Status
     C                     MOVEL*BLANK    P2H1ST           Order Line Erro
     C                     MOVEL'PA'      P2H1ST           Order Line Erro
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     MOVELP2H1ST    WL0005    P      Order Line Erro
     C                     EXSR SKCHRC
     C                     END                             *FI
     C                     END                             *FI
      * ** Test for valid Deadline Departure Dates on orders
     C                     MOVEL'N'       YL0017           Error Status
      * no deadline date/time
      * CASE: DB1.Deadline Depart Date LH is not entered
     C           WANVDT    IFEQ 0                          *IF
     C                     MOVEL'Y'       YL0016           Error Status
     C                     MOVEL*BLANK    P2H1ST           Order Line Erro
     C                     MOVEL'DD'      P2H1ST           Order Line Erro
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     MOVELP2H1ST    WL0005    P      Order Line Erro
     C                     EXSR SKCHRC
     C                     END                             *FI
     C           KRSSI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV PrcMthTyp/PrcTyp  RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDP1AIC3    WHAIC3           Company Number
     C                     MOVELYL0029    WHQ7CD           Price Method Co
      * Establish starting position
     C           KRSSJ     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0026           Price Method Ty
     C                     MOVEL*BLANK    YL0027           PMH Price Type
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHV8ST    YL0026           Price Method Ty
     C                     MOVELWHH3ST    YL0027           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG Ord Line Error Typ CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006  70       Item Code
     C                     MOVEL*BLANK    WN0007  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0008  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0009  70       Order Group Cod
     C                     MOVEL*BLANK    WN0010  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0011  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0012 112       Billing Detail
     C                     Z-ADD*ZERO     WN0013 112       Billing Detail
     C                     Z-ADD*ZERO     WN0014 112       Billing Detail
     C                     Z-ADD*ZERO     WN0015 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0016  1        Comment Print A
     C                     MOVEL*BLANK    WN0017  1        Comment Print I
     C                     MOVEL*BLANK    WN0018  1        Comment Print P
     C                     MOVEL*BLANK    WN0019  1        Comment Print S
     C                     Z-ADD*ZERO     WN0020 112       Extended Amount
     C                     Z-ADD*ZERO     WN0021  70       Market Pricing
     C                     MOVEL*BLANK    WN0022  3        Commodity Marke
     C                     MOVEL*BLANK    WN0023  3        Date Method Cod
     C                     MOVEL*BLANK    WN0024  3        Price Method Co
     C                     Z-ADD*ZERO     WN0025 114       Price Overage O
     C                     Z-ADD*ZERO     WN0026  70       Contract Number
     C                     MOVEL*BLANK    WN0027  1        Price Status
     C                     Z-ADD*ZERO     WN0028  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0029  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0030  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0031  1        Work Confirm St
     C                     MOVEL*BLANK    WN0032  1        Work Over/Short
     C                     MOVEL*BLANK    WN0033  1        OD Production P
     C                     MOVEL*BLANK    WN0034 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0035 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0036  1        Age Code
     C                     MOVEL*BLANK    WN0037  1        Palletize
     C                     MOVEL*BLANK    WN0038  1        Slip Sheet
     C                     MOVEL*BLANK    WN0039  1        Catch Weight St
     C                     MOVEL*BLANK    WN0040  1        Price Audit
     C                     MOVEL*BLANK    WN0041  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0042  1        Production Date
     C                     Z-ADD*ZERO     WN0043 112       Rated Freight
     C                     Z-ADD*ZERO     WN0044 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0045 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0046 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0047 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0048 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0049 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0050 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0051 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0052 114       Unit Price
     C                     Z-ADD*ZERO     WN0053 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0054 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0055 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0056 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0057  70       Requested Ship
     C                     Z-ADD*ZERO     WN0058  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0059  70       Actual Shipped
     C                     MOVEL*BLANK    WN0060  1        Affect Inventor
     C                     MOVEL*BLANK    WN0061  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0062  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0063  30       Item Structure
     C                     Z-ADD*ZERO     WN0064  30       Item Structure
     C                     Z-ADD*ZERO     WN0065  30       Item Structure
     C                     MOVEL*BLANK    WN0066  2        Item Level
     C                     MOVEL*BLANK    WN0067  2        Quality Level
     C                     MOVEL*BLANK    WN0068  2        Pricing Product
     C                     MOVEL*BLANK    WN0069  2        Season Product
     C                     Z-ADD*ZERO     WN0070  70       Date of Origina
     C                     MOVEL*BLANK    WN0071 10        User Profile Na
     C                     MOVEL*BLANK    WN0072  6        Country Code
     C                     MOVEL*BLANK    WN0073  2        Event Code
     C                     MOVEL*BLANK    WN0074  3        Reason Code
     C                     MOVEL*BLANK    WN0075  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0076  1        Modified Flag
     C                     MOVEL*BLANK    WN0077  1        Substituted Fla
     C                     MOVEL*BLANK    WN0078  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0079 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0080 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0081  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0082  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0083  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0084  1        Affect Commissi
     C                     MOVEL*BLANK    WN0085  1        Affect Pricing
     C                     MOVEL*BLANK    WN0086  1        Released by Use
     C                     MOVEL*BLANK    WN0087  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0088  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0089  3        Production Ware
     C                     MOVEL*BLANK    WN0090  3        OD Price Type
     C                     Z-ADD*ZERO     WN0091  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0092  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0093  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0094  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0095  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0096  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0097  60       Price Code
     C                     Z-ADD*ZERO     WN0098  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0099  60       Substitution Li
     C                     Z-ADD*ZERO     WN0100  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0101 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0102 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0103 112       OD Item Target
     C                     Z-ADD*ZERO     WN0104 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0105 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0106 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0107 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0108 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0109 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0110 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0111 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0112 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0113 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0114  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0115  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0116  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0117 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0118  40       Item Age Days
     C                     Z-ADD*ZERO     WN0119  70       Production Ovr
     C                     Z-ADD*ZERO     WN0120  70       Production Ovr
     C                     MOVEL*BLANK    WN0121  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0122  2        OD Clm Full Ret
     C                     Z-ADD*ZERO     WN0123  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0124  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0125  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0126  1        EDI Status 1
     C                     MOVEL*BLANK    WN0127  1        EDI Status 2
     C                     MOVEL*BLANK    WN0128  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0129  60       Job Time
     C                     MOVEL*BLANK    WN0130 10        User Id
     C                     MOVEL*BLANK    WN0131 10        Job Name
     C                     Z-ADD*ZERO     WN0132  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * ** This routine does NOT update the change audit fields  P001251
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0001    WIAIC3           Company Number
     C                     Z-ADDWL0002    WIC4NB           Order Number
     C                     Z-ADDWL0003    WIDPNB           Order Sequence
     C                     Z-ADDWL0004    WIUENB           Order Secondary
      *
     C           KLCHSK    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C           KLCHSK    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0005    WIH1ST    P      Order Line Erro
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * CHG Ord Req Revw- flg CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0133  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0134  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0135  70       Ship To Custome
     C                     MOVEL*BLANK    WN0136 30        Ship To Name
     C                     MOVEL*BLANK    WN0137 30        Ship To Address
     C                     MOVEL*BLANK    WN0138 30        Ship To Address
     C                     MOVEL*BLANK    WN0139 30        Ship To Address
     C                     MOVEL*BLANK    WN0140 20        Ship To City
     C                     MOVEL*BLANK    WN0141  2        Ship To State C
     C                     MOVEL*BLANK    WN0142 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0143  70       Bill to Custome
     C                     MOVEL*BLANK    WN0144 30        Bill to Name
     C                     MOVEL*BLANK    WN0145 30        Bill to Address
     C                     MOVEL*BLANK    WN0146 30        Bill to Address
     C                     MOVEL*BLANK    WN0147 30        Bill to Address
     C                     MOVEL*BLANK    WN0148 20        Bill to City
     C                     MOVEL*BLANK    WN0149  2        Bill to State C
     C                     MOVEL*BLANK    WN0150 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0151 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0152  70       Order Date
     C                     Z-ADD*ZERO     WN0153  70       Requested Ship
     C                     Z-ADD*ZERO     WN0154  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0155  70       Cancel Date
     C                     MOVEL*BLANK    WN0156  2        Terms Code
     C                     MOVEL*BLANK    WN0157 40        Special Instruc
     C                     MOVEL*BLANK    WN0158 40        Special Instruc
     C                     MOVEL*BLANK    WN0159  3        Carrier Code
     C                     MOVEL*BLANK    WN0160  1        Comment Print A
     C                     MOVEL*BLANK    WN0161  1        Comment Print I
     C                     MOVEL*BLANK    WN0162  1        Comment Print P
     C                     MOVEL*BLANK    WN0163  1        Comment Print S
     C                     MOVEL*BLANK    WN0164  3        Reason Code
     C                     MOVEL*BLANK    WN0165  1        Order in Use
     C                     MOVEL*BLANK    WN0166  1        Header Status
     C                     MOVEL*BLANK    WN0167  1        Header Status L
     C                     MOVEL*BLANK    WN0168  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0169  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0170 10        User Original E
     C                     Z-ADD*ZERO     WN0171  70       Date of Origina
     C                     Z-ADD*ZERO     WN0172 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0173 112       Order Weight To
     C                     MOVEL*BLANK    WN0174  1        Credit Hold
     C                     MOVEL*BLANK    WN0175  1        Production Hold
     C                     MOVEL*BLANK    WN0176  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0177  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0178  40       Requested Deliv
     C                     MOVEL*BLANK    WN0179  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0180 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0181  70       Load ID
     C                     Z-ADD*ZERO     WN0182  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0183 112       Rated Freight
     C                     MOVEL*BLANK    WN0184  1        LTL Flag
     C                     MOVEL*BLANK    WN0185  1        Price Audit
     C                     MOVEL*BLANK    WN0186  1        Price Status
     C                     MOVEL*BLANK    WN0187  2        Shipping Method
     C                     MOVEL*BLANK    WN0188  1        Export Status
     C                     MOVEL*BLANK    WN0189  1        Palletize
     C                     MOVEL*BLANK    WN0190  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0191  1        Slip Sheet
     C                     MOVEL*BLANK    WN0192  1        Age Code
     C                     Z-ADD*ZERO     WN0193  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0194  1        Load Type
     C                     Z-ADD*ZERO     WN0195  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0196  1        Load Plan Order
     C                     MOVEL*BLANK    WN0197  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0198  70       Resell Referenc
     C                     MOVEL*BLANK    WN0199 30        Special Comment
     C                     MOVEL*BLANK    WN0200 30        Special Comment
     C                     MOVEL*BLANK    WN0201  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0202  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0203  2        Manager Level C
     C                     MOVEL*BLANK    WN0204  3        VP Level Code
     C                     Z-ADD*ZERO     WN0205  70       Attach to Order
     C                     MOVEL*BLANK    WN0206  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0207  70       Invoice Number
     C                     MOVEL*BLANK    WN0208  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0209  70       Invoice Date
     C                     MOVEL*BLANK    WN0210  2        Event Code
     C                     MOVEL*BLANK    WN0211  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0212  1        Modified Flag
     C                     Z-ADD*ZERO     WN0213 112       A/R order Value
     C                     MOVEL*BLANK    WN0214  1        Billing Activit
     C                     MOVEL*BLANK    WN0215  1        Block Order Fla
     C                     MOVEL*BLANK    WN0216  1        Order Certifica
     C                     Z-ADD*ZERO     WN0217 112       Invoice Order V
     C                     MOVEL*BLANK    WN0218  1        Process Sts for
     C                     MOVEL*BLANK    WN0219  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0220  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0221  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0222  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0223  1        Email Cust On O
     C                     MOVEL*BLANK    WN0224  1        Order Emailed
     C                     MOVEL*BLANK    WN0225  1        Export Docs Go
     C                     MOVEL*BLANK    WN0226  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0227  1        Broker Order St
     C                     MOVEL*BLANK    WN0228  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0229  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0230  2        Export USDA App
     C                     MOVEL*BLANK    WN0231  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0232  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0233  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0234  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0235  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0236  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0237  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0238  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0239  60       Time of Origina
     C                     Z-ADD*ZERO     WN0240  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0241  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0242  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0243 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0244 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0245 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0246 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0247 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0248  70       Claim Number
     C                     MOVEL*BLANK    WN0249  1        EDI Status 1
     C                     MOVEL*BLANK    WN0250  1        EDI Status 2
     C                     MOVEL*BLANK    WN0251  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0252  60       Job Time
     C                     MOVEL*BLANK    WN0253 10        User Id
     C                     MOVEL*BLANK    WN0254 10        Job Name
     C                     Z-ADD*ZERO     WN0255  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0006    WJAIC3           Company Number
     C                     Z-ADDWL0007    WJC4NB           Order Number
      *
     C           KLCHSL    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHSL    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YBRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0008    WJFUSX    P      Order Requires
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Does not update the record stamp fields
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * CHG Ord Line Err       RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADDWL0009    WQSM01           Company Number
     C                     Z-ADDWL0010    WQSM02           Order Number
     C                     Z-ADDWL0011    WADPNB           Order Sequence
     C                     Z-ADDWL0012    WAUENB           Order Secondary
      * Establish starting position
     C           KPSSM     SETLL@BGWKL1                    *
     C           KRSSM     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Update the upload error flag for all line items    C001956
      * CHG Ord Line Error Typ CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     MOVELWL0013    WL0005    P      Order Line Erro
     C                     EXSR SKCHRC
     C           KRSSM     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * change log
      *================================================================
      * 02/03/2010 LJB E000233
      *    Retrieve needed values from System Values file
      * 08/03/07 RMC dly029 Count Load as Export if export order whse
      *    matches ShipFrom Whse on the load   -- per jim n, steve b
      * 05/11/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *    from Logical View
      * 05/17/04 RMC PKTR01 Multi-Company - Use Shipping Co from Whse
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field Price Code
     C                     Z-ADD*ZERO     WUBVTM  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Export Load Limit
     C                     Z-ADD*ZERO     WUIUNX  30
      * Define work field Combo Load Limit
     C                     Z-ADD*ZERO     WUBINX  30
      * Define work field Box Load Limit        USR
     C                     Z-ADD*ZERO     WUBHNX  30
      * Define work field Record Found -OrdDtlUSR
     C                     MOVEL*BLANK    WUYIST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEM8NB           System Value Nu
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Day of Week
     C                     MOVEL*BLANK    WUA9ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WFCQNB           Julian Date
     C                     Z-ADD*ZERO     WFESNB           Accounting Year
     C                     Z-ADD*ZERO     WFETNB           Accounting Peri
     C                     Z-ADD*ZERO     WFBZNB           OM Week
     C                     Z-ADD*ZERO     WFEINB           Week Number
     C                     Z-ADD*ZERO     WFAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WFOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WFNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WFNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WFOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WFOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Slot Limit for Export
     C                     Z-ADD*ZERO     WUNVNX  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGNVNX           Slot Limit for
     C                     Z-ADD*ZERO     WGNWNX           Slot Limit for
     C                     Z-ADD*ZERO     WGNXNX           Slot Limit for
     C                     Z-ADD*ZERO     WGIOWG           Weight Limit fo
     C                     Z-ADD*ZERO     WGIPWG           Weight Limit fo
     C                     Z-ADD*ZERO     WGIQWG           Weight Limit fo
     C                     Z-ADD*ZERO     WGNYNX           LSSC Unused Lim
     C                     Z-ADD*ZERO     WGIRWG           LSSC Unused Lim
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Detail Line Status
     C                     MOVEL*BLANK    WUGMST  1
      * Define work field Price Start Date
     C                     Z-ADD*ZERO     WUPLDT  70
      * Define work field Price End Date
     C                     Z-ADD*ZERO     WUPMDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHRMNY           Decimal Places
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SKCHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  3
      * Define local variables for subroutine SLCHRC.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  2
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013  3
      * Define local work field Price Start Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Price End Date
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field Partial Load Max Lbs USR
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field Export Status Dft
     C                     MOVEL*BLANK    YL0010  1
      * Define null work field Accounting Period Code
     C                     Z-ADD*ZERO     YN0001  20
      * Define null work field Week Number
     C                     Z-ADD*ZERO     YN0002  20
      * Define local work field Slot Limit for Combo
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field Slot Limit for Box/Other
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field Weight Limit for Export
     C                     Z-ADD*ZERO     YL0013 110
      * Define local work field Weight Limit for Combo
     C                     Z-ADD*ZERO     YL0014 110
      * Define local work field Weight Limit for Box/Othr
     C                     Z-ADD*ZERO     YL0015 110
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Maximum Contract Units
     C                     Z-ADD*ZERO     YL0018 112
      * Define local work field Customer Price /UM Prc
     C                     Z-ADD*ZERO     YL0019 114
      * Define local work field Commodity Market Code
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0021  3
      * Define local work field Date Method Code
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field Contract Unit Type
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Price Overage Override
     C                     Z-ADD*ZERO     YL0024 114
      * Define local work field OD Ceiling Price
     C                     Z-ADD*ZERO     YL0025 114
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field Weight Ordered
     C                     Z-ADD*ZERO     YL0028 112
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0029  3
      * Define local work field Weight Allocated USR
     C                     Z-ADD*ZERO     YL0030  92
      * Define local work field Production AgeDte Fr
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field Production AgeDte To
     C                     Z-ADD*ZERO     YL0032  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
