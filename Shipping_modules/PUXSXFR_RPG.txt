     H/TITLE Crt EDI 601 Exp Shp InfXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSGOYA
     H* Date          : 05/01/25  Time  : 07:47:21
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL6  IF   E           K DISK
      * RSQ : Order Header TRG          Load Exports
      *
     FPMAMREL1  IF   E           K DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPUC1REL1  IF   E           K DISK
      * RTV : Shipping Line/Port Extsn  Retrieval index
      *
     FECP136L3  IF   E           K DISK
      * RSQ : EDI Export Shpmnt Inf HDR Load ID/Rcd Proc/Ctl# (D
      *
     FECP136L2  IF   E           K DISK
      * RSQ : EDI Export Shpmnt Inf HDR Trans Set Control # (D)
      *
     FPNHAREL1  IF   E           K DISK
      * RTV : Country EXT               Retrieval index
      *
     FOPBGWKLA  IF   E           K DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1  IF   E           K DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAABREL3  IF   E           K DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPMAMRELM  IF   E           K DISK
      * RSQ : Order Header Extension    Load/Co/Order
      *
     FECP136L1  IF   E           K DISK
      * RTV : EDI Export Shpmnt Inf HDR Retrieval index
      *
     FCAABREL1  IF   E           K DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FCADPREL1  IF   E           K DISK
      * RTV : System Values             Retrieval index       NV
      *
     FPDMRREL1  IF   E           K DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FECP136L0  UF A E           K DISK
      * UPD : EDI Export Shpmnt Inf HDR Update index
      *
     FECP137L0  IF A E           K DISK
      * UPD : EDI Export Shpmnt Inf DTL Update index
      *
     FECP135L0  IF A E           K DISK
      * UPD : EDI Export Shpmnt Inf NME Update index
      *
      * Long constants
     D @CN#            S              6    DIM(11)CTDATA PERRCD(1)
     D @CN             S             25    DIM(11) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QECP11        E DS                  EXTNAME(ECP136L0)
      * UPD : EDI Export Shpmnt Inf HDR Update index
      * Renamed input format fields
     D  WETSCN       E                     EXTFLD(COTSCN)
     D  WEA0ST       E                     EXTFLD(COA0ST)
     D  WEHPAA       E                     EXTFLD(COHPAA)
     D  WEA8AB       E                     EXTFLD(COA8AB)
     D  WEA9AB       E                     EXTFLD(COA9AB)
     D  WEBAAB       E                     EXTFLD(COBAAB)
     D  WEBBAB       E                     EXTFLD(COBBAB)
     D  WEHDNZ       E                     EXTFLD(COHDNZ)
     D  WEBEAB       E                     EXTFLD(COBEAB)
     D  WEVRNA       E                     EXTFLD(COVRNA)
     D  WEBCAB       E                     EXTFLD(COBCAB)
     D  WES5U1       E                     EXTFLD(COS5U1)
     D  WEBDAB       E                     EXTFLD(COBDAB)
     D  WEB7DX       E                     EXTFLD(COB7DX)
     D  WES6U1       E                     EXTFLD(COS6U1)
     D  WES7U1       E                     EXTFLD(COS7U1)
     D  WES8U1       E                     EXTFLD(COS8U1)
     D  WEBFAB       E                     EXTFLD(COBFAB)
     D  WES9U1       E                     EXTFLD(COS9U1)
     D  WETAU1       E                     EXTFLD(COTAU1)
     D  WETBU1       E                     EXTFLD(COTBU1)
     D  WETPU1       E                     EXTFLD(COTPU1)
     D  WETQU1       E                     EXTFLD(COTQU1)
     D  WETRU1       E                     EXTFLD(COTRU1)
     D  WECADX       E                     EXTFLD(COCADX)
     D  WEBETM       E                     EXTFLD(COBETM)
     D  WEN8SC       E                     EXTFLD(CON8SC)
      *
     D YARDCS          DS           287
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D YBRDCS          DS           287
     D YCRDCS          DS           287
     D QECP12        E DS                  EXTNAME(ECP137L0)
      * UPD : EDI Export Shpmnt Inf DTL Update index
      * Renamed input format fields
     D  WMTSCN       E                     EXTFLD(CPTSCN)
     D  WMTFU1       E                     EXTFLD(CPTFU1)
     D  WMQ8WG       E                     EXTFLD(CPQ8WG)
     D  WMN3VL       E                     EXTFLD(CPN3VL)
     D  WMHENZ       E                     EXTFLD(CPHENZ)
     D  WMBGAB       E                     EXTFLD(CPBGAB)
     D  WMTIQT       E                     EXTFLD(CPTIQT)
     D  WMQ2WG       E                     EXTFLD(CPQ2WG)
     D  WMTIU1       E                     EXTFLD(CPTIU1)
     D  WMBHAB       E                     EXTFLD(CPBHAB)
     D  WMBIAB       E                     EXTFLD(CPBIAB)
     D  WMBJAB       E                     EXTFLD(CPBJAB)
     D  WMTJU1       E                     EXTFLD(CPTJU1)
     D  WMBKAB       E                     EXTFLD(CPBKAB)
     D  WMBMAB       E                     EXTFLD(CPBMAB)
     D  WMBNAB       E                     EXTFLD(CPBNAB)
     D  WMBSAB       E                     EXTFLD(CPBSAB)
     D  WMTKU1       E                     EXTFLD(CPTKU1)
     D  WMBOAB       E                     EXTFLD(CPBOAB)
     D  WMBPAB       E                     EXTFLD(CPBPAB)
     D  WMBQAB       E                     EXTFLD(CPBQAB)
     D  WMH1PR       E                     EXTFLD(CPH1PR)
     D  WMBRAB       E                     EXTFLD(CPBRAB)
      *
     D QECP13        E DS                  EXTNAME(ECP135L0)
      * UPD : EDI Export Shpmnt Inf NME Update index
      * Renamed input format fields
     D  WSTSCN       E                     EXTFLD(CQTSCN)
     D  WSTYPC       E                     EXTFLD(CQTYPC)
     D  WSAMEX       E                     EXTFLD(CQAMEX)
     D  WSDCDQ       E                     EXTFLD(CQDCDQ)
     D  WSTLU1       E                     EXTFLD(CQTLU1)
     D  WSBTAB       E                     EXTFLD(CQBTAB)
     D  WSBUAB       E                     EXTFLD(CQBUAB)
     D  WSUDU1       E                     EXTFLD(CQUDU1)
     D  WSUEU1       E                     EXTFLD(CQUEU1)
     D  WSTMU1       E                     EXTFLD(CQTMU1)
     D  WSVSNA       E                     EXTFLD(CQVSNA)
     D  WSVTNA       E                     EXTFLD(CQVTNA)
     D  WSITYX       E                     EXTFLD(CQITYX)
     D  WSTATE       E                     EXTFLD(CQTATE)
     D  WSIPXX       E                     EXTFLD(CQIPXX)
     D  WSWFAA       E                     EXTFLD(CQWFAA)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              7  0
     D  WP0002         S              7  0
     D  WP0003         S              3
     D  WP0004         S             20
     D  WP0005         S             30
     D  WP0006         S              7  0
     D  WP0007         S             15
     D  WP0008         S              6
     D  WP0009         S              5  0
     D  WP0010         S              4
     D  WP0011         S              5  0
     D  WP0012         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              1
     D  YL0002         S             15
     D  YL0003         S             11  2
     D  YL0004         S              1
     D  WQSA02         S                   LIKE(WARMNB)
     D  YL0005         S              3
     D  YL0006         S             20
     D  YL0007         S             25
     D  YL0008         S             30
     D  YL0009         S             15
     D  YL0010         S             20
     D  YL0011         S              7  0
     D  YL0012         S              2
     D  YL0013         S              1
     D  YL0014         S             15
     D  YN0001         S              5  0
     D  YL0015         S              4
     D  Y0CX01         S              1
     D  YL0016         S              1
     D  YL0017         S              1
     D  WUYFU1         S             40
     D  WUYGU1         S             40
     D  WUYHU1         S             40
     D  WQSD02         S                   LIKE(WARMNB)
     D  WQSD03         S                   LIKE(WAC4NB)
     D  YL0018         S              1
     D  YL0019         S              2
     D  YL0020         S             15
     D  YL0021         S              1
     D  YL0022         S              2
     D  YL0023         S              1
     D  WQSF01         S                   LIKE(WDHDNZ)
     D  WQSF02         S                   LIKE(WDA0ST)
     D  WN0001         S              6
     D  WN0002         S              1
     D  WN0003         S              2
     D  WN0004         S              2
     D  WN0005         S              7  0
     D  WN0006         S              2
     D  WN0007         S             20
     D  WN0008         S              4
     D  WN0009         S             28
     D  WN0010         S              3
     D  WN0011         S              8  0
     D  WN0012         S             30
     D  WN0013         S             30
     D  WN0014         S             50
     D  WN0015         S              2
     D  WN0016         S             15
     D  WN0017         S             30
     D  WN0018         S              1
     D  WN0019         S              4
     D  WN0020         S             15
     D  WN0021         S             15
     D  WN0022         S              8  0
     D  WN0023         S              6  0
     D  WN0024         S              1
     D  YARDC          S              1
     D  WL0001         S              9  0
     D  WL0002         S              1
     D  WN0025         S              6
     D  WN0026         S              1
     D  WN0027         S              2
     D  WN0028         S              2
     D  WN0029         S              2
     D  WN0030         S              7  0
     D  WN0031         S              2
     D  WN0032         S             20
     D  WN0033         S              4
     D  WN0034         S             28
     D  WN0035         S              3
     D  WN0036         S              8  0
     D  WN0037         S             30
     D  WN0038         S             30
     D  WN0039         S             50
     D  WN0040         S              2
     D  WN0041         S             15
     D  WN0042         S             30
     D  WN0043         S              1
     D  WN0044         S              4
     D  WN0045         S             15
     D  WN0046         S             15
     D  WN0047         S              8  0
     D  WN0048         S              6  0
     D  WN0049         S              1
     D  YBRDC          S              1
     D  YL0024         S             15
     D  WQ0001         S              7  0
     D  WQ0002         S             15
     D  WQ0003         S              1
     D  WQ0004         S              1
     D  WQ0005         S             15
     D  W0CLPG         S             10
     D  WQ0006         S              7  0
     D  WQ0007         S             15
     D  WQ0008         S              1
     D  WQ0009         S              1
     D  WQ0010         S             15
     D  WQ0011         S              7  0
     D  WQ0012         S             15
     D  WQ0013         S              1
     D  WQ0014         S              1
     D  WQ0015         S             15
     D  WQ0016         S              7  0
     D  WQ0017         S             15
     D  WQ0018         S              1
     D  WQ0019         S              1
     D  WQ0020         S             15
     D  YL0025         S              9  0
     D  YL0026         S              2
     D  WL0003         S              6
     D  WL0004         S              2
     D  YL0027         S              3
     D  WL0005         S              3  0
     D  WL0006         S              7  0
     D  WL0007         S              3  0
     D  WL0008         S              3  0
     D  WL0009         S              3
     D  WQSK01         S                   LIKE(WHAIC3)
     D  WQSK02         S                   LIKE(WHC4NB)
     D  YL0028         S              3
     D  YL0029         S             55
     D  YL0030         S             55
     D  YL0031         S             20
     D  YL0032         S             15
     D  YL0033         S              2
     D  YL0034         S              2
     D  WL0010         S              3
     D  WL0011         S             30
     D  WL0012         S             30
     D  WL0013         S             20
     D  WL0014         S             11
     D  WL0015         S              2
     D  WL0016         S              2
     D  YN0002         S             20
     D  YL0035         S             20
     D  YN0003         S              2
     D  YL0036         S              4  0
     D  YL0037         S              4
     D  YL0038         S             30
     D  YL0039         S              8  0
     D  YL0040         S              5
     D  YL0041         S             30
     D  YL0042         S              8  0
     D  ZADFMF         S             10
     D  YL0043         S             11  2
     D  YL0044         S              7  0
     D  YL0045         S              3  0
     D  YL0046         S              7  0
     D  YL0047         S             11  2
     D  WN0050         S             11  2
     D  YL0048         S              9  0
     D  YL0049         S             11  2
     D  YL0050         S              1
     D  YL0051         S              5  0
     D  YL0052         S             11  2
     D  WQSO01         S                   LIKE(WKRMNB)
     D  WQ0021         S              3  0
     D  WQ0022         S              7  0
     D  WQ0023         S              3  0
     D  WQ0024         S              3  0
     D  WQ0025         S             11  2
     D  WQ0026         S             11  2
     D  WQ0027         S              9  2
     D  YL0053         S              3  0
     D  YL0054         S              7  0
     D  YL0055         S             11  2
     D  WL0017         S              3  0
     D  WL0018         S              7  0
     D  WL0019         S              1
     D  WL0020         S             11  2
     D  WQSP01         S                   LIKE(WHAIC3)
     D  WQSP02         S                   LIKE(WHC4NB)
     D  YCRDC          S              1
     D  YL0056         S              5  0
     D  YL0057         S             11  1
     D  YL0058         S             11  0
     D  YL0059         S             11  1
     D  YL0060         S             11  0
     D  YL0061         S             11  2
     D  YL0062         S             30
     D  YL0063         S             45
     D  YL0064         S             30
     D  YN0004         S             30
     D  YN0005         S             30
     D  YN0006         S             30
     D  YN0007         S             11
     D  YN0008         S             25
     D  YN0009         S             25
     D  YN0010         S             20
     D  YN0011         S             25
     D  YL0065         S              6
     D  YN0012         S              1
     D  YN0013         S              1
     D  YN0014         S              1
     D  YN0015         S              1
     D  YL0066         S             15
     D  WL0021         S             10
     D  WL0022         S             40
     D  YL0067         S             60
     D  YL0068         S              2  0
     D  YL0069         S              3  0
     D  YL0070         S             20
     D  ZQ             S              5  0
     D  YL0071         S              3  0
     D  YL0072         S             25
     D  YL0073         S              3  0
     D  YL0074         S              5
     D  YL0075         S              3  0
     D  YL0076         S              4
     D  WL0023         S              9  0
     D  WL0024         S              3
     D  WL0025         S             30
     D  WL0026         S              2
     D  WL0027         S             40
     D  WL0028         S              2
     D  WL0029         S              3
     D  WL0030         S             20
     D  WL0031         S             25
     D  WL0032         S             15
     D  WL0033         S             55
     D  WL0034         S             55
     D  WL0035         S             20
     D  WL0036         S              2
     D  WL0037         S             15
     D  WL0038         S              3
     D  YL0077         S             63
     D  YL0078         S             63
     D  YL0079         S             63
     D  YL0080         S             63
     D  YL0081         S             63
     D  YN0016         S              2
     D  YN0017         S             20
     D  YN0018         S              6
     D  WL0039         S              3  0
     D  WL0040         S              7  0
     D  WL0041         S              1
     D  WL0042         S             63
     D  WL0043         S             63
     D  WL0044         S             63
     D  WL0045         S             63
     D  WL0046         S             63
     D  WL0047         S              2
     D  WL0048         S             20
     D  WL0049         S              6
     D  WQSW01         S                   LIKE(WTAIC3)
     D  WQSW02         S                   LIKE(WTC4NB)
     D  WQSW03         S                   LIKE(WTDGSX)
     D  YL0082         S              2
     D  YL0083         S             40
     D  WQ0028         S              7  0
     D  WQ0029         S             15
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  YRSW00         S              5  0
     D  YRSW01         S              5  0
     D  W0PMT          S              1
     d $string2_data   s             60a   inz(*blank)
     d $var_char       s              1a   inz(*blank)
     d $pos2           s              5u 0 inz(*zero)
     D wkrhtx          s             63A                                        Consignee Name
     D wkritx          s             63A                                        Consignee Addr 1
     D wkrjtx          s             63A                                        Consignee Addr 2
     D wkityx          s             20A                                        Consignee City
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Order Header Extension
      * I :  Order Number
     D  P1C4NB                 1      4P 0
      * I :  Load ID
     D  P1RMNB                 5      8P 0
      * I :  Shipping Line
     D  P1XACD                 9     11
      * I :  Port Delv Terminal
     D  P1OANA                12     31
      * I :  OHE Vessel_Airline
     D  P1J0T1                32     61
      * I :  OHE Sail_Flight Date
     D  P1QWDT                62     65P 0
      * I :  OHE EDI 824 AES ITN #
     D  P1M2U1                66     80
     D P2PARM          DS
      * FLD: Order Detail
      * I :  Country Code
     D  P2KXCD                 1      6
     D P3PARM          DS
      * FLD: *Arrays
      * I :  CBP Export Port Code
     D  P3B1AB                 1      3P 0
      * I :  CBP Std Carrier Alpha Cde
     D  P3BYAB                 4      7
      * I :  CBP Foreign Port Code
     D  P3HFNZ                 8     10P 0
      * I :  Add/Change/Delete USR
     D  P3DQSC                11     11
     D                 DS
     D  ZAMSDA                 1    132
     I@BFCPMC
      * Order Header TRG          Load Exports
      * Renamed input format fields
     I              BEAIC3                      WAAIC3
     I              BEC4NB                      WAC4NB
     I              BEJNCD                      WAJNCD
     I              BEANC7                      WAANC7
     I              BEBKC7                      WABKC7
     I              BEBRTX                      WABRTX
     I              BEHMNA                      WAHMNA
     I              BEHONA                      WAHONA
     I              BEHPNA                      WAHPNA
     I              BEHNNA                      WAHNNA
     I              BEDBCD                      WADBCD
     I              BECKTX                      WACKTX
     I              BEB0C7                      WAB0C7
     I              BEAETX                      WAAETX
     I              BEB1NA                      WAB1NA
     I              BEB3NA                      WAB3NA
     I              BEB4NA                      WAB4NA
     I              BEB2NA                      WAB2NA
     I              BEBHCD                      WABHCD
     I              BEC8TX                      WAC8TX
     I              BEBCNA                      WABCNA
     I              BEA0DT                      WAA0DT
     I              BEA5DT                      WAA5DT
     I              BEGNDT                      WAGNDT
     I              BEACDT                      WAACDT
     I              BEAQCD                      WAAQCD
     I              BEB6NA                      WAB6NA
     I              BEBYNA                      WABYNA
     I              BEBZNA                      WABZNA
     I              BEGTST                      WAGTST
     I              BEGVST                      WAGVST
     I              BEGUST                      WAGUST
     I              BEQFST                      WAQFST
     I              BECQCD                      WACQCD
     I              BEGJST                      WAGJST
     I              BEGWST                      WAGWST
     I              BEGXST                      WAGXST
     I              BEGYST                      WAGYST
     I              BEAODT                      WAAODT
     I              BEAIVN                      WAAIVN
     I              BECXDT                      WACXDT
     I              BEJZVA                      WAJZVA
     I              BEA1WG                      WAA1WG
     I              BEXIST                      WAXIST
     I              BEXJST                      WAXJST
     I              BEXKST                      WAXKST
     I              BEEIDT                      WAEIDT
     I              BEAFTM                      WAAFTM
     I              BEE8CD                      WAE8CD
     I              BEE9CD                      WAE9CD
     I              BERMNB                      WARMNB
     I              BETBNB                      WATBNB
     I              BER1NB                      WAR1NB
     I              BEPJST                      WAPJST
     I              BEU0ST                      WAU0ST
     I              BEU1ST                      WAU1ST
     I              BEQ2CD                      WAQ2CD
     I              BEU2ST                      WAU2ST
     I              BEVEST                      WAVEST
     I              BEVFST                      WAVFST
     I              BEVGST                      WAVGST
     I              BERPCD                      WARPCD
     I              BERNNB                      WARNNB
     I              BEVDST                      WAVDST
     I              BEATIN                      WAATIN
     I              BEU4ST                      WAU4ST
     I              BEU5ST                      WAU5ST
     I              BERSRN                      WARSRN
     I              BEMHNA                      WAMHNA
     I              BEMINA                      WAMINA
     I              BEWBST                      WAWBST
     I              BER4CD                      WAR4CD
     I              BEBFCD                      WABFCD
     I              BEQ4CD                      WAQ4CD
     I              BET3NB                      WAT3NB
     I              BESICD                      WASICD
     I              BECONB                      WACONB
     I              BECEST                      WACEST
     I              BEAWDT                      WAAWDT
     I              BEJPCD                      WAJPCD
     I              BEXUST                      WAXUST
     I              BEZ1ST                      WAZ1ST
     I              BEVRVA                      WAVRVA
     I              BEOBST                      WAOBST
     I              BEBCST                      WABCST
     I              BEBDST                      WABDST
     I              BEB7VL                      WAB7VL
     I              BEGASX                      WAGASX
     I              BEGBSX                      WAGBSX
     I              BEGCSX                      WAGCSX
     I              BEGDSX                      WAGDSX
     I              BEFNSX                      WAFNSX
     I              BEFOSX                      WAFOSX
     I              BEFPSX                      WAFPSX
     I              BEFQSX                      WAFQSX
     I              BEFRSX                      WAFRSX
     I              BEFSSX                      WAFSSX
     I              BEFTSX                      WAFTSX
     I              BEFUSX                      WAFUSX
     I              BEFVSX                      WAFVSX
     I              BEFWSX                      WAFWSX
     I              BEFXSX                      WAFXSX
     I              BEFYSX                      WAFYSX
     I              BENODT                      WANODT
     I              BENPDT                      WANPDT
     I              BENQDT                      WANQDT
     I              BENRDT                      WANRDT
     I              BENSDT                      WANSDT
     I              BEBPTM                      WABPTM
     I              BEBQTM                      WABQTM
     I              BEBRTM                      WABRTM
     I              BEBSTM                      WABSTM
     I              BEBTTM                      WABTTM
     I              BEH0NX                      WAH0NX
     I              BEH1NX                      WAH1NX
     I              BEH2NX                      WAH2NX
     I              BEH3NX                      WAH3NX
     I              BEH4NX                      WAH4NX
     I              BEC0C7                      WAC0C7
     I              BEUVST                      WAUVST
     I              BEUWST                      WAUWST
     I              BEUXST                      WAUXST
     I              BEAATM                      WAAATM
     I              BEAYNA                      WAAYNA
     I              BEA0NA                      WAA0NA
     I              BEAXDT                      WAAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                      WBAIC3
     I              AMC4NB                      WBC4NB
     I              AMRMNB                      WBRMNB
     I              AMRUNB                      WBRUNB
     I              AMXACD                      WBXACD
     I              AMOANA                      WBOANA
     I              AMHBAA                      WBHBAA
     I              AMJ0T1                      WBJ0T1
     I              AMGENY                      WBGENY
     I              AMJ1T1                      WBJ1T1
     I              AMHCAA                      WBHCAA
     I              AMQWDT                      WBQWDT
     I              AMQXDT                      WBQXDT
     I              AMQYDT                      WBQYDT
     I              AMHDAA                      WBHDAA
     I              AMCCTX                      WBCCTX
     I              AMJ2T1                      WBJ2T1
     I              AMRLNA                      WBRLNA
     I              AMRMNA                      WBRMNA
     I              AMGINY                      WBGINY
     I              AMGFNY                      WBGFNY
     I              AMGGNY                      WBGGNY
     I              AMGHNY                      WBGHNY
     I              AMHEVL                      WBHEVL
     I              AMHFVL                      WBHFVL
     I              AMHGVL                      WBHGVL
     I              AMQZDT                      WBQZDT
     I              AMQ0DT                      WBQ0DT
     I              AMQ1DT                      WBQ1DT
     I              AMQ2DT                      WBQ2DT
     I              AMC2TX                      WBC2TX
     I              AMC3TX                      WBC3TX
     I              AMC6TX                      WBC6TX
     I              AMCHTX                      WBCHTX
     I              AMCITX                      WBCITX
     I              AMCLTX                      WBCLTX
     I              AMB4TX                      WBB4TX
     I              AMCUTX                      WBCUTX
     I              AMCVTX                      WBCVTX
     I              AMB9TX                      WBB9TX
     I              AMJWSC                      WBJWSC
     I              AMITNY                      WBITNY
     I              AMLMT1                      WBLMT1
     I              AMLWAA                      WBLWAA
     I              AMFVST                      WBFVST
     I              AMF0ST                      WBF0ST
     I              AMF2ST                      WBF2ST
     I              AMF3ST                      WBF3ST
     I              AMJUSC                      WBJUSC
     I              AMJVSC                      WBJVSC
     I              AMV3T1                      WBV3T1
     I              AMV4T1                      WBV4T1
     I              AMV5T1                      WBV5T1
     I              AMV6T1                      WBV6T1
     I              AMV7T1                      WBV7T1
     I              AMV8T1                      WBV8T1
     I              AMV9T1                      WBV9T1
     I              AMWAT1                      WBWAT1
     I              AMWBT1                      WBWBT1
     I              AMWCT1                      WBWCT1
     I              AMWDT1                      WBWDT1
     I              AMQJNY                      WBQJNY
     I              AMQKNY                      WBQKNY
     I              AMQLNY                      WBQLNY
     I              AMP8NY                      WBP8NY
     I              AMP9NY                      WBP9NY
     I              AMQANY                      WBQANY
     I              AMQCNY                      WBQCNY
     I              AMQDNY                      WBQDNY
     I              AMQENY                      WBQENY
     I              AMQFNY                      WBQFNY
     I              AMQGNY                      WBQGNY
     I              AMQHNY                      WBQHNY
     I              AMQINY                      WBQINY
     I              AMQMNY                      WBQMNY
     I              AMMYU1                      WBMYU1
     I              AMJXSC                      WBJXSC
     I              AMJYSC                      WBJYSC
     I              AMJZSC                      WBJZSC
     I              AMJ0SC                      WBJ0SC
     I              AMMZU1                      WBMZU1
     I              AMM0U1                      WBM0U1
     I              AMM1U1                      WBM1U1
     I              AMM2U1                      WBM2U1
     I              AMM3U1                      WBM3U1
     I              AMW5DT                      WBW5DT
     I              AMW6DT                      WBW6DT
     I              AMUVST                      WBUVST
     I              AMUWST                      WBUWST
     I              AMUXST                      WBUXST
     I              AMVSST                      WBVSST
     I              AMAATM                      WBAATM
     I              AMAYNA                      WBAYNA
     I              AMA0NA                      WBA0NA
     I              AMAXDT                      WBAXDT
      *
     I@C1REL2
      * Shipping Line/Port Extsn  Retrieval index
      * Renamed input format fields
     I              C1XACD                      WCXACD
     I              C1OANA                      WCOANA
     I              C1B1AB                      WCB1AB
     I              C1BYAB                      WCBYAB
     I              C1N1SC                      WCN1SC
     I              C1N2SC                      WCN2SC
     I              C1BZAB                      WCBZAB
     I              C1B0AB                      WCB0AB
     I              C1HLNZ                      WCHLNZ
     I              C1B9DX                      WCB9DX
     I              C1UAU1                      WCUAU1
     I              C1UBU1                      WCUBU1
     I              C1VSST                      WCVSST
     I              C1MJDT                      WCMJDT
     I              C1BETM                      WCBETM
     I              C1CCVN                      WCCCVN
     I              C1CDVN                      WCCDVN
     I              C1MKDT                      WCMKDT
     I              C1BFTM                      WCBFTM
     I              C1CEVN                      WCCEVN
     I              C1CFVN                      WCCFVN
      *
     I@P136LU
      * EDI Export Shpmnt Inf HDR Load ID/Rcd Proc/Ctl# (D
      * Renamed input format fields
     I              COTSCN                      WDTSCN
     I              COA0ST                      WDA0ST
     I              COHPAA                      WDHPAA
     I              COA8AB                      WDA8AB
     I              COA9AB                      WDA9AB
     I              COBAAB                      WDBAAB
     I              COBBAB                      WDBBAB
     I              COHDNZ                      WDHDNZ
     I              COBEAB                      WDBEAB
     I              COVRNA                      WDVRNA
     I              COBCAB                      WDBCAB
     I              COS5U1                      WDS5U1
     I              COBDAB                      WDBDAB
     I              COB7DX                      WDB7DX
     I              COS6U1                      WDS6U1
     I              COS7U1                      WDS7U1
     I              COS8U1                      WDS8U1
     I              COBFAB                      WDBFAB
     I              COS9U1                      WDS9U1
     I              COTAU1                      WDTAU1
     I              COTBU1                      WDTBU1
     I              COTPU1                      WDTPU1
     I              COTQU1                      WDTQU1
     I              COTRU1                      WDTRU1
     I              COCADX                      WDCADX
     I              COBETM                      WDBETM
     I              CON8SC                      WDN8SC
      *
     I@COCPKT
      * EDI Export Shpmnt Inf HDR Update index
      * Renamed input format fields
     I              COTSCN                      WETSCN
     I              COA0ST                      WEA0ST
     I              COHPAA                      WEHPAA
     I              COA8AB                      WEA8AB
     I              COA9AB                      WEA9AB
     I              COBAAB                      WEBAAB
     I              COBBAB                      WEBBAB
     I              COHDNZ                      WEHDNZ
     I              COBEAB                      WEBEAB
     I              COVRNA                      WEVRNA
     I              COBCAB                      WEBCAB
     I              COS5U1                      WES5U1
     I              COBDAB                      WEBDAB
     I              COB7DX                      WEB7DX
     I              COS6U1                      WES6U1
     I              COS7U1                      WES7U1
     I              COS8U1                      WES8U1
     I              COBFAB                      WEBFAB
     I              COS9U1                      WES9U1
     I              COTAU1                      WETAU1
     I              COTBU1                      WETBU1
     I              COTPU1                      WETPU1
     I              COTQU1                      WETQU1
     I              COTRU1                      WETRU1
     I              COCADX                      WECADX
     I              COBETM                      WEBETM
     I              CON8SC                      WEN8SC
      *
     I@P136K1
      * EDI Export Shpmnt Inf HDR Trans Set Control # (D)
      * Renamed input format fields
     I              COTSCN                      WFTSCN
     I              COA0ST                      WFA0ST
     I              COHPAA                      WFHPAA
     I              COA8AB                      WFA8AB
     I              COA9AB                      WFA9AB
     I              COBAAB                      WFBAAB
     I              COBBAB                      WFBBAB
     I              COHDNZ                      WFHDNZ
     I              COBEAB                      WFBEAB
     I              COVRNA                      WFVRNA
     I              COBCAB                      WFBCAB
     I              COS5U1                      WFS5U1
     I              COBDAB                      WFBDAB
     I              COB7DX                      WFB7DX
     I              COS6U1                      WFS6U1
     I              COS7U1                      WFS7U1
     I              COS8U1                      WFS8U1
     I              COBFAB                      WFBFAB
     I              COS9U1                      WFS9U1
     I              COTAU1                      WFTAU1
     I              COTBU1                      WFTBU1
     I              COTPU1                      WFTPU1
     I              COTQU1                      WFTQU1
     I              COTRU1                      WFTRU1
     I              COCADX                      WFCADX
     I              COBETM                      WFBETM
     I              CON8SC                      WFN8SC
      *
     I@HAREKV
      * Country EXT               Retrieval index
      * Renamed input format fields
     I              HAKXCD                      WGKXCD
     I              HANAST                      WGNAST
     I              HAX2AA                      WGX2AA
     I              HAVSST                      WGVSST
     I              HAMJDT                      WGMJDT
     I              HABETM                      WGBETM
     I              HACCVN                      WGCCVN
     I              HACDVN                      WGCDVN
     I              HAMKDT                      WGMKDT
     I              HABFTM                      WGBFTM
     I              HACEVN                      WGCEVN
     I              HACFVN                      WGCFVN
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                      WHAIC3
     I              OMC4NB                      WHC4NB
     I              OMDPNB                      WHDPNB
     I              OMUENB                      WHUENB
     I              OMHGCD                      WHHGCD
     I              OMAJCD                      WHAJCD
     I              OMBKC7                      WHBKC7
     I              OMCFC7                      WHCFC7
     I              OMGMST                      WHGMST
     I              OMGNST                      WHGNST
     I              OMMAVA                      WHMAVA
     I              OMKDVA                      WHKDVA
     I              OML8VA                      WHL8VA
     I              OML9VA                      WHL9VA
     I              OMGTST                      WHGTST
     I              OMGVST                      WHGVST
     I              OMGUST                      WHGUST
     I              OMQFST                      WHQFST
     I              OMAYVA                      WHAYVA
     I              OMEXDT                      WHEXDT
     I              OMLQCD                      WHLQCD
     I              OMRDCD                      WHRDCD
     I              OMQ7CD                      WHQ7CD
     I              OMBZPR                      WHBZPR
     I              OML6NB                      WHL6NB
     I              OMU1ST                      WHU1ST
     I              OMGIDT                      WHGIDT
     I              OMCRCD                      WHCRCD
     I              OMAGCD                      WHAGCD
     I              OMRZST                      WHRZST
     I              OMR0ST                      WHR0ST
     I              OMR1ST                      WHR1ST
     I              OMG7NA                      WHG7NA
     I              OMG8NA                      WHG8NA
     I              OMRPCD                      WHRPCD
     I              OMVEST                      WHVEST
     I              OMVGST                      WHVGST
     I              OMAVST                      WHAVST
     I              OMU0ST                      WHU0ST
     I              OMRFCD                      WHRFCD
     I              OMFZST                      WHFZST
     I              OMR1NB                      WHR1NB
     I              OMAVQT                      WHAVQT
     I              OMD0WG                      WHD0WG
     I              OMCCQT                      WHCCQT
     I              OMAUWG                      WHAUWG
     I              OMCBQT                      WHCBQT
     I              OMATWG                      WHATWG
     I              OMAQCS                      WHAQCS
     I              OMAGCS                      WHAGCS
     I              OMAKPR                      WHAKPR
     I              OMALPR                      WHALPR
     I              OMAUPR                      WHAUPR
     I              OMAVWG                      WHAVWG
     I              OMA4WG                      WHA4WG
     I              OMA5DT                      WHA5DT
     I              OMAODT                      WHAODT
     I              OMGNDT                      WHGNDT
     I              OMAMST                      WHAMST
     I              OMANST                      WHANST
     I              OMVAST                      WHVAST
     I              OMRGNB                      WHRGNB
     I              OMRHNB                      WHRHNB
     I              OMRINB                      WHRINB
     I              OMRBCD                      WHRBCD
     I              OMHICD                      WHHICD
     I              OMRNCD                      WHRNCD
     I              OMROCD                      WHROCD
     I              OMCXDT                      WHCXDT
     I              OMAJVN                      WHAJVN
     I              OMKXCD                      WHKXCD
     I              OMJPCD                      WHJPCD
     I              OMCQCD                      WHCQCD
     I              OMR4CD                      WHR4CD
     I              OMZ1ST                      WHZ1ST
     I              OMZ3ST                      WHZ3ST
     I              OMZ4ST                      WHZ4ST
     I              OMDUPR                      WHDUPR
     I              OMB6VL                      WHB6VL
     I              OMA1AA                      WHA1AA
     I              OMFZSX                      WHFZSX
     I              OMF0SX                      WHF0SX
     I              OMF1SX                      WHF1SX
     I              OMF2SX                      WHF2SX
     I              OMF3SX                      WHF3SX
     I              OMF4SX                      WHF4SX
     I              OMF5SX                      WHF5SX
     I              OMF6SX                      WHF6SX
     I              OMF7SX                      WHF7SX
     I              OMNTDT                      WHNTDT
     I              OMNUDT                      WHNUDT
     I              OMNVDT                      WHNVDT
     I              OMNWDT                      WHNWDT
     I              OMNXDT                      WHNXDT
     I              OMBUTM                      WHBUTM
     I              OMBVTM                      WHBVTM
     I              OMBWTM                      WHBWTM
     I              OMBXTM                      WHBXTM
     I              OMBYTM                      WHBYTM
     I              OMH5NX                      WHH5NX
     I              OMH6NX                      WHH6NX
     I              OMH7NX                      WHH7NX
     I              OMH8NX                      WHH8NX
     I              OMH9NX                      WHH9NX
     I              OMDVPR                      WHDVPR
     I              OMDWPR                      WHDWPR
     I              OMDXPR                      WHDXPR
     I              OMDYPR                      WHDYPR
     I              OMDZPR                      WHDZPR
     I              OMGSPR                      WHGSPR
     I              OMGTPR                      WHGTPR
     I              OMGUPR                      WHGUPR
     I              OMHOST                      WHHOST
     I              OMHPST                      WHHPST
     I              OMIOST                      WHIOST
     I              OMPEWG                      WHPEWG
     I              OMRINY                      WHRINY
     I              OMTIDT                      WHTIDT
     I              OMTJDT                      WHTJDT
     I              OMH2ST                      WHH2ST
     I              OMH0ST                      WHH0ST
     I              OMH1ST                      WHH1ST
     I              OMTKDT                      WHTKDT
     I              OMTLDT                      WHTLDT
     I              OMTMDT                      WHTMDT
     I              OMUVST                      WHUVST
     I              OMUWST                      WHUWST
     I              OMUXST                      WHUXST
     I              OMAATM                      WHAATM
     I              OMAYNA                      WHAYNA
     I              OMA0NA                      WHA0NA
     I              OMAXDT                      WHAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                      WIAJCD
     I              ADF8NA                      WIF8NA
     I              ADACNA                      WIACNA
     I              ADADNA                      WIADNA
     I              ADAENA                      WIAENA
     I              ADAJNA                      WIAJNA
     I              ADBTTX                      WIBTTX
     I              ADAOCD                      WIAOCD
     I              ADBGCD                      WIBGCD
     I              ADVHST                      WIVHST
     I              ADMPNA                      WIMPNA
     I              ADWPST                      WIWPST
     I              ADXUST                      WIXUST
     I              ADT0ST                      WIT0ST
     I              ADT1ST                      WIT1ST
     I              ADDBNB                      WIDBNB
     I              ADT2ST                      WIT2ST
     I              ADT3ST                      WIT3ST
     I              ADT4ST                      WIT4ST
     I              ADT6ST                      WIT6ST
     I              ADBWC3                      WIBWC3
     I              ADBTC3                      WIBTC3
     I              ADBUC3                      WIBUC3
     I              ADBVC3                      WIBVC3
     I              ADFCAA                      WIFCAA
     I              ADRQSX                      WIRQSX
     I              ADRRSX                      WIRRSX
     I              ADRSSX                      WIRSSX
     I              ADRTSX                      WIRTSX
     I              ADT7ST                      WIT7ST
     I              ADT8ST                      WIT8ST
     I              ADRNSX                      WIRNSX
     I              ADROSX                      WIROSX
     I              ADRPSX                      WIRPSX
     I              ADUVST                      WIUVST
     I              ADUWST                      WIUWST
     I              ADUXST                      WIUXST
     I              ADVSST                      WIVSST
     I              ADAATM                      WIAATM
     I              ADAYNA                      WIAYNA
     I              ADA0NA                      WIA0NA
     I              ADAXDT                      WIAXDT
     I              ADQDSC                      WIQDSC
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                      WJAIC3
     I              ABADTX                      WJADTX
     I              ABACNA                      WJACNA
     I              ABADNA                      WJADNA
     I              ABAENA                      WJAENA
     I              ABAJNA                      WJAJNA
     I              ABBTTX                      WJBTTX
     I              ABBVTX                      WJBVTX
     I              ABBWTX                      WJBWTX
     I              ABA2NA                      WJA2NA
     I              ABABTX                      WJABTX
     I              ABBGCD                      WJBGCD
     I              ABKXCD                      WJKXCD
     I              ABUVST                      WJUVST
     I              ABUWST                      WJUWST
     I              ABUXST                      WJUXST
     I              ABVSST                      WJVSST
     I              ABAATM                      WJAATM
     I              ABAYNA                      WJAYNA
     I              ABA0NA                      WJA0NA
     I              ABAXDT                      WJAXDT
      *
     I@AMREL3
      * Order Header Extension    Load/Co/Order
      * Renamed input format fields
     I              AMAIC3                      WKAIC3
     I              AMC4NB                      WKC4NB
     I              AMRMNB                      WKRMNB
     I              AMRUNB                      WKRUNB
     I              AMXACD                      WKXACD
     I              AMOANA                      WKOANA
     I              AMHBAA                      WKHBAA
     I              AMJ0T1                      WKJ0T1
     I              AMGENY                      WKGENY
     I              AMJ1T1                      WKJ1T1
     I              AMHCAA                      WKHCAA
     I              AMQWDT                      WKQWDT
     I              AMQXDT                      WKQXDT
     I              AMQYDT                      WKQYDT
     I              AMHDAA                      WKHDAA
     I              AMCCTX                      WKCCTX
     I              AMJ2T1                      WKJ2T1
     I              AMRLNA                      WKRLNA
     I              AMRMNA                      WKRMNA
     I              AMGINY                      WKGINY
     I              AMGFNY                      WKGFNY
     I              AMGGNY                      WKGGNY
     I              AMGHNY                      WKGHNY
     I              AMHEVL                      WKHEVL
     I              AMHFVL                      WKHFVL
     I              AMHGVL                      WKHGVL
     I              AMQZDT                      WKQZDT
     I              AMQ0DT                      WKQ0DT
     I              AMQ1DT                      WKQ1DT
     I              AMQ2DT                      WKQ2DT
     I              AMC2TX                      WKC2TX
     I              AMC3TX                      WKC3TX
     I              AMC6TX                      WKC6TX
     I              AMCHTX                      WKCHTX
     I              AMCITX                      WKCITX
     I              AMCLTX                      WKCLTX
     I              AMB4TX                      WKB4TX
     I              AMCUTX                      WKCUTX
     I              AMCVTX                      WKCVTX
     I              AMB9TX                      WKB9TX
     I              AMJWSC                      WKJWSC
     I              AMITNY                      WKITNY
     I              AMLMT1                      WKLMT1
     I              AMLWAA                      WKLWAA
     I              AMFVST                      WKFVST
     I              AMF0ST                      WKF0ST
     I              AMF2ST                      WKF2ST
     I              AMF3ST                      WKF3ST
     I              AMJUSC                      WKJUSC
     I              AMJVSC                      WKJVSC
     I              AMV3T1                      WKV3T1
     I              AMV4T1                      WKV4T1
     I              AMV5T1                      WKV5T1
     I              AMV6T1                      WKV6T1
     I              AMV7T1                      WKV7T1
     I              AMV8T1                      WKV8T1
     I              AMV9T1                      WKV9T1
     I              AMWAT1                      WKWAT1
     I              AMWBT1                      WKWBT1
     I              AMWCT1                      WKWCT1
     I              AMWDT1                      WKWDT1
     I              AMQJNY                      WKQJNY
     I              AMQKNY                      WKQKNY
     I              AMQLNY                      WKQLNY
     I              AMP8NY                      WKP8NY
     I              AMP9NY                      WKP9NY
     I              AMQANY                      WKQANY
     I              AMQCNY                      WKQCNY
     I              AMQDNY                      WKQDNY
     I              AMQENY                      WKQENY
     I              AMQFNY                      WKQFNY
     I              AMQGNY                      WKQGNY
     I              AMQHNY                      WKQHNY
     I              AMQINY                      WKQINY
     I              AMQMNY                      WKQMNY
     I              AMMYU1                      WKMYU1
     I              AMJXSC                      WKJXSC
     I              AMJYSC                      WKJYSC
     I              AMJZSC                      WKJZSC
     I              AMJ0SC                      WKJ0SC
     I              AMMZU1                      WKMZU1
     I              AMM0U1                      WKM0U1
     I              AMM1U1                      WKM1U1
     I              AMM2U1                      WKM2U1
     I              AMM3U1                      WKM3U1
     I              AMW5DT                      WKW5DT
     I              AMW6DT                      WKW6DT
     I              AMUVST                      WKUVST
     I              AMUWST                      WKUWST
     I              AMUXST                      WKUXST
     I              AMVSST                      WKVSST
     I              AMAATM                      WKAATM
     I              AMAYNA                      WKAYNA
     I              AMA0NA                      WKA0NA
     I              AMAXDT                      WKAXDT
      *
     I@COCPKU
      * EDI Export Shpmnt Inf HDR Retrieval index
      * Renamed input format fields
     I              COTSCN                      WLTSCN
     I              COA0ST                      WLA0ST
     I              COHPAA                      WLHPAA
     I              COA8AB                      WLA8AB
     I              COA9AB                      WLA9AB
     I              COBAAB                      WLBAAB
     I              COBBAB                      WLBBAB
     I              COHDNZ                      WLHDNZ
     I              COBEAB                      WLBEAB
     I              COVRNA                      WLVRNA
     I              COBCAB                      WLBCAB
     I              COS5U1                      WLS5U1
     I              COBDAB                      WLBDAB
     I              COB7DX                      WLB7DX
     I              COS6U1                      WLS6U1
     I              COS7U1                      WLS7U1
     I              COS8U1                      WLS8U1
     I              COBFAB                      WLBFAB
     I              COS9U1                      WLS9U1
     I              COTAU1                      WLTAU1
     I              COTBU1                      WLTBU1
     I              COTPU1                      WLTPU1
     I              COTQU1                      WLTQU1
     I              COTRU1                      WLTRU1
     I              COCADX                      WLCADX
     I              COBETM                      WLBETM
     I              CON8SC                      WLN8SC
      *
     I@CPCPKW
      * EDI Export Shpmnt Inf DTL Update index
      * Renamed input format fields
     I              CPTSCN                      WMTSCN
     I              CPTFU1                      WMTFU1
     I              CPQ8WG                      WMQ8WG
     I              CPN3VL                      WMN3VL
     I              CPHENZ                      WMHENZ
     I              CPBGAB                      WMBGAB
     I              CPTIQT                      WMTIQT
     I              CPQ2WG                      WMQ2WG
     I              CPTIU1                      WMTIU1
     I              CPBHAB                      WMBHAB
     I              CPBIAB                      WMBIAB
     I              CPBJAB                      WMBJAB
     I              CPTJU1                      WMTJU1
     I              CPBKAB                      WMBKAB
     I              CPBMAB                      WMBMAB
     I              CPBNAB                      WMBNAB
     I              CPBSAB                      WMBSAB
     I              CPTKU1                      WMTKU1
     I              CPBOAB                      WMBOAB
     I              CPBPAB                      WMBPAB
     I              CPBQAB                      WMBQAB
     I              CPH1PR                      WMH1PR
     I              CPBRAB                      WMBRAB
      *
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                      WOAIC3
     I              ABADTX                      WOADTX
     I              ABACNA                      WOACNA
     I              ABADNA                      WOADNA
     I              ABAENA                      WOAENA
     I              ABAJNA                      WOAJNA
     I              ABBTTX                      WOBTTX
     I              ABBVTX                      WOBVTX
     I              ABBWTX                      WOBWTX
     I              ABA2NA                      WOA2NA
     I              ABABTX                      WOABTX
     I              ABBGCD                      WOBGCD
     I              ABKXCD                      WOKXCD
     I              ABUVST                      WOUVST
     I              ABUWST                      WOUWST
     I              ABUXST                      WOUXST
     I              ABVSST                      WOVSST
     I              ABAATM                      WOAATM
     I              ABAYNA                      WOAYNA
     I              ABA0NA                      WOA0NA
     I              ABAXDT                      WOAXDT
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                      WRDOCD
     I              DPAUNA                      WRAUNA
     I              DPI5ST                      WRI5ST
     I              DPBXTX                      WRBXTX
     I              DPM8NB                      WRM8NB
     I              DPUVST                      WRUVST
     I              DPUWST                      WRUWST
     I              DPUXST                      WRUXST
     I              DPVSST                      WRVSST
     I              DPAATM                      WRAATM
     I              DPAYNA                      WRAYNA
     I              DPA0NA                      WRA0NA
     I              DPAXDT                      WRAXDT
      *
     I@CQCPKZ
      * EDI Export Shpmnt Inf NME Update index
      * Renamed input format fields
     I              CQTSCN                      WSTSCN
     I              CQTYPC                      WSTYPC
     I              CQAMEX                      WSAMEX
     I              CQDCDQ                      WSDCDQ
     I              CQTLU1                      WSTLU1
     I              CQBTAB                      WSBTAB
     I              CQBUAB                      WSBUAB
     I              CQUDU1                      WSUDU1
     I              CQUEU1                      WSUEU1
     I              CQTMU1                      WSTMU1
     I              CQVSNA                      WSVSNA
     I              CQVTNA                      WSVTNA
     I              CQITYX                      WSITYX
     I              CQTATE                      WSTATE
     I              CQIPXX                      WSIPXX
     I              CQWFAA                      WSWFAA
      *
     I@MRREWT
      * Export Doc Order Hdr      Retrieval index
      * Renamed input format fields
     I              MRAIC3                      WTAIC3
     I              MRC4NB                      WTC4NB
     I              MRDGSX                      WTDGSX
     I              MRKXCD                      WTKXCD
     I              MRZMCD                      WTZMCD
     I              MRPSTX                      WTPSTX
     I              MRPUTX                      WTPUTX
     I              MRPVTX                      WTPVTX
     I              MRPWTX                      WTPWTX
     I              MRRVTX                      WTRVTX
     I              MRPPU1                      WTPPU1
     I              MRZ7AA                      WTZ7AA
     I              MRPDU1                      WTPDU1
     I              MRZ8AA                      WTZ8AA
     I              MRRHTX                      WTRHTX
     I              MRRITX                      WTRITX
     I              MRRJTX                      WTRJTX
     I              MRSCTX                      WTSCTX
     I              MRSDTX                      WTSDTX
     I              MRAAAB                      WTAAAB
     I              MRPHU1                      WTPHU1
     I              MRABAB                      WTABAB
     I              MRPXTX                      WTPXTX
     I              MRZOCD                      WTZOCD
     I              MRZNCD                      WTZNCD
     I              MRCSSX                      WTCSSX
     I              MRCTSX                      WTCTSX
     I              MRCUSX                      WTCUSX
     I              MRCVSX                      WTCVSX
     I              MRPTTX                      WTPTTX
     I              MRORNA                      WTORNA
     I              MRRKTX                      WTRKTX
     I              MRPZTX                      WTPZTX
     I              MRRLTX                      WTRLTX
     I              MRP0TX                      WTP0TX
     I              MRP1TX                      WTP1TX
     I              MRP2TX                      WTP2TX
     I              MRP3TX                      WTP3TX
     I              MRP4TX                      WTP4TX
     I              MRP5TX                      WTP5TX
     I              MRP6TX                      WTP6TX
     I              MRYHTX                      WTYHTX
     I              MRYITX                      WTYITX
     I              MRCWSX                      WTCWSX
     I              MROUNA                      WTOUNA
     I              MRP7TX                      WTP7TX
     I              MRP9TX                      WTP9TX
     I              MROVNA                      WTOVNA
     I              MRQATX                      WTQATX
     I              MRQBTX                      WTQBTX
     I              MRQCTX                      WTQCTX
     I              MROWNA                      WTOWNA
     I              MROXNA                      WTOXNA
     I              MRABNX                      WTABNX
     I              MRACNX                      WTACNX
     I              MRADNX                      WTADNX
     I              MRQDTX                      WTQDTX
     I              MRQETX                      WTQETX
     I              MROYNA                      WTOYNA
     I              MROZNA                      WTOZNA
     I              MRO0NA                      WTO0NA
     I              MRO1NA                      WTO1NA
     I              MRCXSX                      WTCXSX
     I              MRCYSX                      WTCYSX
     I              MRAGNX                      WTAGNX
     I              MRCZSX                      WTCZSX
     I              MRC0SX                      WTC0SX
     I              MRC1SX                      WTC1SX
     I              MRQFTX                      WTQFTX
     I              MRAHNX                      WTAHNX
     I              MRQGTX                      WTQGTX
     I              MRQHTX                      WTQHTX
     I              MRQITX                      WTQITX
     I              MRQJTX                      WTQJTX
     I              MRQKTX                      WTQKTX
     I              MRQMTX                      WTQMTX
     I              MRQNTX                      WTQNTX
     I              MRQOTX                      WTQOTX
     I              MRQPTX                      WTQPTX
     I              MRQQTX                      WTQQTX
     I              MRQRTX                      WTQRTX
     I              MRQSTX                      WTQSTX
     I              MRQTTX                      WTQTTX
     I              MRQUTX                      WTQUTX
     I              MRQVTX                      WTQVTX
     I              MRQYTX                      WTQYTX
     I              MRQWTX                      WTQWTX
     I              MRQZTX                      WTQZTX
     I              MRAINX                      WTAINX
     I              MRQ1TX                      WTQ1TX
     I              MRQ2TX                      WTQ2TX
     I              MRQ3TX                      WTQ3TX
     I              MRQ4TX                      WTQ4TX
     I              MRQ5TX                      WTQ5TX
     I              MRQ6TX                      WTQ6TX
     I              MRQ7TX                      WTQ7TX
     I              MRQ8TX                      WTQ8TX
     I              MRQ9TX                      WTQ9TX
     I              MRSMTX                      WTSMTX
     I              MRZQCD                      WTZQCD
     I              MRZRCD                      WTZRCD
     I              MRA7VL                      WTA7VL
     I              MRA8VL                      WTA8VL
     I              MRC2SX                      WTC2SX
     I              MRC8SX                      WTC8SX
     I              MRHRWG                      WTHRWG
     I              MRBIVL                      WTBIVL
     I              MRK2QT                      WTK2QT
     I              MRO5NA                      WTO5NA
     I              MRHSWG                      WTHSWG
     I              MRBJVL                      WTBJVL
     I              MRRATX                      WTRATX
     I              MRRBTX                      WTRBTX
     I              MRRCTX                      WTRCTX
     I              MRRDTX                      WTRDTX
     I              MRRETX                      WTRETX
     I              MRC3SX                      WTC3SX
     I              MRC4SX                      WTC4SX
     I              MRC5SX                      WTC5SX
     I              MRC6SX                      WTC6SX
     I              MRC7SX                      WTC7SX
     I              MRMQDT                      WTMQDT
     I              MRMRDT                      WTMRDT
     I              MRMSDT                      WTMSDT
     I              MRAJNX                      WTAJNX
     I              MRYFTX                      WTYFTX
     I              MRX9TX                      WTX9TX
     I              MRYATX                      WTYATX
     I              MRYBTX                      WTYBTX
     I              MRB5AA                      WTB5AA
     I              MRYCTX                      WTYCTX
     I              MRYDTX                      WTYDTX
     I              MRYETX                      WTYETX
     I              MRB6AA                      WTB6AA
     I              MRPADT                      WTPADT
     I              MRPBDT                      WTPBDT
     I              MRPCDT                      WTPCDT
     I              MRPDDT                      WTPDDT
     I              MRPEDT                      WTPEDT
     I              MRO4SX                      WTO4SX
     I              MRO5SX                      WTO5SX
     I              MRC1T1                      WTC1T1
     I              MRC2T1                      WTC2T1
     I              MRLKSC                      WTLKSC
     I              MRLLSC                      WTLLSC
     I              MRPIU1                      WTPIU1
     I              MRPJU1                      WTPJU1
     I              MRFFNZ                      WTFFNZ
     I              MRBUDX                      WTBUDX
     I              MRUVST                      WTUVST
     I              MRUWST                      WTUWST
     I              MRUXST                      WTUXST
     I              MRVSST                      WTVSST
     I              MRAATM                      WTAATM
     I              MRAYNA                      WTAYNA
     I              MRA0NA                      WTA0NA
     I              MRAXDT                      WTAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1C4NB        PARM                    WP0001                         Order Number
     C     P1RMNB        PARM                    WP0002                         Load ID
     C     P1XACD        PARM                    WP0003                         Shipping Line
     C     P1OANA        PARM                    WP0004                         Port Delv Termi
     C     P1J0T1        PARM                    WP0005                         OHE Vessel_Airl
     C     P1QWDT        PARM                    WP0006                         OHE Sail_Flight
     C     P1M2U1        PARM                    WP0007                         OHE EDI 824 AES
     C     P2KXCD        PARM                    WP0008                         Country Code
     C     P3B1AB        PARM                    WP0009                         CBP Export Port
     C     P3BYAB        PARM                    WP0010                         CBP Std Carrier
     C     P3HFNZ        PARM                    WP0011                         CBP Foreign Por
     C     P3DQSC        PARM                    WP0012                         Add/Change/Dele
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Crt EDI 601 Exp Shp InfXF
      * Initialization.
      * CASE: *OTHERWISE
      * EUS EDI 601 Data Dfn  US - EDI Export Shpmnt Inf HDR  * 
      * Declare EDI 601 Data Definitions
      *
      * Validations.
      * CASE: *OTHERWISE
      * MUST revalidate that ALL Orders for Load has the same Booking #.
      * Val Crt EDI 601 Trsn  RT - Order Header TRG  * 
     C                   EXSR      SARVGN
      * Processing.
      * CASE: LCL.Create EDI 601 USR is Yes
      * Exc Crt EDI 601 Trsn  RT - Order Header TRG  * 
     C                   IF        YL0001 = 'Y'
     C                   EXSR      SDRVGN
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Val Crt EDI 601 Trsn  RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'Y'           YL0004                         First Time Thro
     C                   MOVEL     'N'           YL0001                         Create EDI 601
     C                   EVAL      YL0002 = ' '                                 OHE Booking Num
     C                   Z-ADD     *ZERO         YL0003                         L1306-Order Val
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA02                         Load ID
      * Setup key
     C                   Z-ADD     P1RMNB        WQSA02                         Load ID
      * Establish starting position
     C     KRSSA         SETLL     @BFCPMC                                      *
     C     KRSSA         READE     @BFCPMC                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * Access path selects Export Status = Y.
      * All Orders MUST have Booking # entered & are the SAME in order to
      * create the EDI 601 data sets.
      * CASE: DB1.Header Status is Not cancelled
     C                   DOW       NOT *IN90
      * Rtv EDI 601 Rqd Fields RT - Order Header Extension  * 
     C                   IF        WAGWST = 'L' OR
     C                             WAGWST = 'A' OR
     C                             WAGWST = 'C' OR
     C                             WAGWST = 'R' OR
     C                             WAGWST = 'E' OR
     C                             WAGWST = 'H' OR
     C                             WAGWST = 'I'
     C                   EXSR      SBRVGN
      * Rtv CBP Info f/EDI 601 RT - Shipping Line/Port Extsn  * 
     C                   EXSR      SCRVGN
      * Required Fields Must Be Entered & Booking # Entered and Matches.
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6 AND c7 AND c8 AND c9
      *  -  AND NOTc10
      *   |- c1    : LCL.OHE City is Entered
      *   |- c2    : LCL.OHE Discharge Port/Airprt is Not Blank
      *   |- c3    : LCL.OHE Sail/Flight Date is not equal zero
      *   |- c4    : LCL.Shipping Line is entered
      *   |- c5    : LCL.OHE Vessel/Airline is Not Blank
      *   |- c6    : LCL.OHE Booking Number is Entered
      *   |- c7    : LCL.OHE Override Type Code is ES
      *   |- c8    : LCL.Port Delv Terminal is Entered
      *   |- c9    : LCL.CBP Std Carrier Alpha Cde is Entered
      *   |- c10   : LCL.OHE EDI 824 AES ITN # is All 9s
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0007 <> ' '
     C                   IF        YL0010 <> ' '
     C                   IF        YL0011 <> 0
     C                   IF        YL0005 <> ' '
     C                   IF        YL0008 <> ' '
     C                   IF        YL0009 <> ' '
     C                   IF        YL0012 = 'ES'
     C                   IF        YL0006 <> ' '
     C                   IF        YL0015 <> ' '
     C                   IF        YL0014 = @CN(001)
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Save 1st Booking #.
      * CASE: LCL.First Time Through USR is Yes
     C                   IF        Y0CX01 = '1'
     C                   IF        YL0004 = 'Y'
     C                   MOVEL     'N'           YL0004                         First Time Thro
     C                   MOVEL     YL0009        YL0002                         OHE Booking Num
     C                   MOVEL     'Y'           YL0001                         Create EDI 601
     C                   ADD       WAJZVA        YL0003                         L1306-Order Val
     C                   ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.OHE Booking Number EQ PAR.OHE Booking Number
     C                   IF        YL0009 = YL0002
     C                   MOVEL     'Y'           YL0001                         Create EDI 601
     C                   ADD       WAJZVA        YL0003                         L1306-Order Val
     C                   ELSE
      * CASE: *OTHERWISE
      * This is consider a Transload if Booking # are different.
     C                   MOVEL     'N'           YL0001                         Create EDI 601
     C                   EVAL      YL0002 = ' '                                 OHE Booking Num
     C                   Z-ADD     *ZERO         YL0003                         L1306-Order Val
     C                   GOTO      SAEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           YL0001                         Create EDI 601
     C                   GOTO      SAEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSA         READE     @BFCPMC                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv EDI 601 Rqd Fields RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0005 = ' '                                 Shipping Line
     C                   EVAL      YL0006 = ' '                                 Port Delv Termi
     C                   EVAL      YL0007 = ' '                                 OHE City
     C                   EVAL      YL0008 = ' '                                 OHE Vessel_Airl
     C                   EVAL      YL0009 = ' '                                 OHE Booking Num
     C                   EVAL      YL0010 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         YL0011                         OHE Sail_Flight
     C                   EVAL      YL0012 = ' '                                 OHE Override Ty
     C                   EVAL      YL0013 = ' '                                 OHE EDI 824 Act
     C                   EVAL      YL0014 = ' '                                 OHE EDI 824 AES
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WBAIC3                         Company Number
     C                   Z-ADD     WAC4NB        WBC4NB                         Order Number
      * Establish starting position
     C     KRSSB         CHAIN     @AMREJF                            90        *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBXACD        YL0005                         Shipping Line
     C                   MOVEL     WBOANA        YL0006                         Port Delv Termi
     C                   MOVEL     WBHBAA        YL0007                         OHE City
     C                   MOVEL     WBJ0T1        YL0008                         OHE Vessel_Airl
     C                   MOVEL     WBJ1T1        YL0009                         OHE Booking Num
     C                   MOVEL     WBHCAA        YL0010                         OHE Discharge P
     C                   Z-ADD     WBQWDT        YL0011                         OHE Sail_Flight
     C                   MOVEL     WBCHTX        YL0012                         OHE Override Ty
     C                   MOVEL     WBJVSC        YL0013                         OHE EDI 824 Act
     C                   MOVEL     WBM2U1        YL0014                         OHE EDI 824 AES
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Rtv CBP Info f/EDI 601 RT - Shipping Line/Port Extsn  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0015 = ' '                                 CBP Std Carrier
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WCXACD                         Shipping Line
     C                   KFLD                    WCOANA                         Port Delv Termi
      * Setup key
     C                   MOVEL     YL0005        WCXACD                         Shipping Line
     C                   MOVEL     YL0006        WCOANA                         Port Delv Termi
      * Establish starting position
     C     KRSSC         CHAIN     @C1REL2                            90        *
      * Data record not found
     C   90              MOVEL     'USR5297'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WCBYAB        YL0015                         CBP Std Carrier
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Exc Crt EDI 601 Trsn  RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           YL0016                         Create EDI 601
     C                   MOVEL     'N'           YL0017                         Upd OHE EDI 601
     C                   EVAL      WUYFU1 = ' '                                 Spcl chars for
     C                   EVAL      WUYGU1 = ' '                                 Accent chars to
     C                   EVAL      WUYHU1 = ' '                                 Replacement cha
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WQSD02                         Load ID
     C                   KFLD                    WQSD03                         Order Number
      * Setup key
     C                   Z-ADD     P1RMNB        WQSD02                         Load ID
     C                   Z-ADD     P1C4NB        WQSD03                         Order Number
      * Establish starting position
     C     KRSSD         SETLL     @BFCPMC                                      *
     C     KRSSD         READE     @BFCPMC                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * RTV EDI 601/824 Sts    RT - Order Header Extension  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SERVGN
      * Sent for the 1st Time.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.OHE EDI 601 Action is Not Entered
      *   |- c2    : LCL.OHE EDI 824 Action is Blanks
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0019 = ' '
     C                   IF        YL0018 = ' '
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Create EDI 601 data sets & set EDI-Record Processed='N'ot Process
      * so GoAnywhere will process these records.
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           YL0016                         Create EDI 601
     C                   MOVEL     'Y'           YL0017                         Upd OHE EDI 601
     C                   MOVEL     'N'           YL0021                         EDI-Record Proc
     C                   EVAL      YL0022 = ' '                                 BA102-Action Co
     C                   MOVEL     '1'           YL0022                         BA102-Action Co
     C                   END                                                    *FI
      * Have Been Sent Before.
      * CASE: LCL.OHE EDI 601 Action is Sent
      * CASE: PAR.Add/Change/Delete USR is Delete
     C                   IF        YL0019 = 'S'
      * Create EDI 601 ECP136 HDR only & set EDI-Record Processed='N'ot
      * Process so GoAnywhere will process these records.
     C                   IF        P3DQSC = 'D'
     C                   MOVEL     'Y'           YL0016                         Create EDI 601
     C                   MOVEL     'N'           YL0021                         EDI-Record Proc
     C                   EVAL      YL0022 = ' '                                 BA102-Action Co
     C                   MOVEL     'C'           YL0022                         BA102-Action Co
      * Cancel any 'P'ending Records in ECP136 HDR. (Unlikely scenario.)
     C                   MOVEL     'N'           YL0023                         First Time Thro
      * Upd Pending EDI 601 RcdRT - EDI Export Shpmnt Inf HDR  * 
     C                   EXSR      SFRVGN
      * Check Return Code.
      * CASE: PGM.*Return code is *Normal
     C                   IF        W0RTN = ' '
     C                   ELSE
      * CASE: *OTHERWISE
      * Reset to 'Blank' to Reprocess.
      * Upd OHE EDI 824 Action XF - Order Header Extension  * 
     C                   CALL      'PUXXXFR'                            90      Upd OHE EDI 824
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WARMNB        WQ0006                         Load ID
     C                   PARM      YL0002        WQ0007                         OHE Booking Num
     C                   PARM      *BLANK        WQ0008                         EDI-Record Proc
     C                   PARM      '8'           WQ0009                         Update OHE EDI
     C                   PARM      *BLANK        WQ0010                         OHE EDI 824 AES
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUXXXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * For Record Change Processing.
      * CASE: LCL.OHE EDI 824 Action is Blanks
      * (EDI 824 transaction has not yet been received.)
      * Create EDI 601 data sets but set EDI-Record Processed='P'ending
      * so GoAnywhere will NOT process these records.
     C                   IF        YL0018 = ' '
     C                   MOVEL     'Y'           YL0016                         Create EDI 601
     C                   MOVEL     'P'           YL0021                         EDI-Record Proc
      * Set 'BA102-Action Code' Based on OHE ITN# is Entered.
      * CASE: LCL.OHE EDI 824 AES ITN # is *Blank
     C                   IF        YL0020 = ' '
     C                   EVAL      YL0022 = ' '                                 BA102-Action Co
     C                   MOVEL     '1'           YL0022                         BA102-Action Co
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'RX'          YL0022                         BA102-Action Co
     C                   END                                                    *FI
     C                   ELSE
      * CASE: LCL.OHE EDI 824 Action is Received
      * Create EDI 601 data sets & set EDI-Record Processed='N'ot Process
      * so GoAnywhere will process these records.
     C                   IF        YL0018 = 'R'
     C                   MOVEL     'Y'           YL0016                         Create EDI 601
     C                   MOVEL     'N'           YL0021                         EDI-Record Proc
      * Set 'BA102-Action Code' Based on OHE ITN# is Entered.
      * CASE: LCL.OHE EDI 824 AES ITN # is *Blank
     C                   IF        YL0020 = ' '
     C                   EVAL      YL0022 = ' '                                 BA102-Action Co
     C                   MOVEL     '1'           YL0022                         BA102-Action Co
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'RX'          YL0022                         BA102-Action Co
     C                   END                                                    *FI
      * Reset to 'Blank' to Reprocess.
      * Upd OHE EDI 824 Action XF - Order Header Extension  * 
     C                   CALL      'PUXXXFR'                            90      Upd OHE EDI 824
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WARMNB        WQ0011                         Load ID
     C                   PARM      YL0002        WQ0012                         OHE Booking Num
     C                   PARM      *BLANK        WQ0013                         EDI-Record Proc
     C                   PARM      '8'           WQ0014                         Update OHE EDI
     C                   PARM      *BLANK        WQ0015                         OHE EDI 824 AES
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUXXXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: LCL.OHE EDI 824 Action is Snd-Error
      * Create EDI 601 data sets & set EDI-Record Processed='N'ot Process
      * so GoAnywhere will process these records.
     C                   IF        YL0018 = 'E'
     C                   MOVEL     'Y'           YL0016                         Create EDI 601
     C                   MOVEL     'N'           YL0021                         EDI-Record Proc
      * Set 'BA102-Action Code' Based on OHE ITN# is Entered.
      * CASE: LCL.OHE EDI 824 AES ITN # is *Blank
     C                   IF        YL0020 = ' '
     C                   EVAL      YL0022 = ' '                                 BA102-Action Co
     C                   MOVEL     '1'           YL0022                         BA102-Action Co
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'RX'          YL0022                         BA102-Action Co
     C                   END                                                    *FI
      * Reset to 'Blank' to Reprocess.
      * Upd OHE EDI 824 Action XF - Order Header Extension  * 
     C                   CALL      'PUXXXFR'                            90      Upd OHE EDI 824
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WARMNB        WQ0016                         Load ID
     C                   PARM      YL0002        WQ0017                         OHE Booking Num
     C                   PARM      *BLANK        WQ0018                         EDI-Record Proc
     C                   PARM      '8'           WQ0019                         Update OHE EDI
     C                   PARM      *BLANK        WQ0020                         OHE EDI 824 AES
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUXXXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Create EDI 601 Shipment Export Info Transactions.
      * CASE: LCL.Create EDI 601 USR is Yes
      * Create EDI Export Shpmnt Inf HDR (ECP136).
      * CASE: *OTHERWISE
     C                   IF        YL0016 = 'Y'
     C                   Z-ADD     999999999     YL0025                         ST02-TRANS SET
      * Rtv Next Control #     RT - EDI Export Shpmnt Inf HDR  * 
     C                   EXSR      SIRVGN
      * Rtv Country ISO Code  RT - Country EXT  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  P2KXCD        WL0003                         Country Code
     C                   EXSR      SJRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0004        YL0026                         ISO Alpha2 Code
      * RTV 1st Warehouse 2    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0005                         Company Number
     C                   Z-ADD     WAC4NB        WL0006                         Order Number
     C                   Z-ADD     *ZERO         WL0007                         Order Sequence
     C                   Z-ADD     *ZERO         WL0008                         Order Secondary
     C                   EXSR      SKRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0009        YL0027                         Warehouse Code
     C                   MOVEL     YL0027        YL0028                         Ship From Wareh
      * Rtv for EDI 601 ESI   RT - Warehouse Codes  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0028        WL0010                         Warehouse Code
     C                   EXSR      SLRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0011        YL0029                         Address Line 1
     C                   MOVEL(P)  WL0012        YL0030                         Address Line 2
     C                   MOVEL(P)  WL0013        YL0031                         City
     C                   MOVEL(P)  WL0014        YL0032                         Zip Postal Code
     C                   MOVEL(P)  WL0015        YL0033                         State Code
     C                   MOVEL(P)  WL0016        YL0034                         Warehouse Type
      * RTV Federal ID,City,St RT - Company Name and Address  * 
     C                   EXSR      SMRVGN
      * This is the Trucking SCAC. Commented out.
      * CBP SCAC for Ocean Carrier resides in Shipping Line/Port Extsn fi
      * Format CBP Export Port Code.
      * CASE: PAR.CBP Export Port Code is Entered
     C                   IF        P3B1AB <> 0
     C                   Z-ADD     P3B1AB        YL0036                         Numeric 4,0
     C                   EVAL      YL0037 = ' '                                 Text USR 4
     C                   MOVEL     YL0036        YL0037                         Text USR 4
     C                   EVAL      YL0038 = ' '                                 PS03-Port of Ex
     C                   MOVEL     YL0037        YL0038                         PS03-Port of Ex
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0038 = ' '                                 PS03-Port of Ex
     C                   END                                                    *FI
      * LCL.DTM02-Sail Date = PAR.OHE Sail/Flight Date
     C                   IF        P1QWDT = *ZERO
     C                   Z-ADD     *ZERO         YL0039
     C                   ELSE
     C     P1QWDT        ADD       19000000      YL0039                         DTM02-Sail Date
     C                   END
      * Format CBP Foreign Port Code (Unlading).
      * CASE: PAR.CBP Foreign Port Code is Not zero
     C                   IF        P3HFNZ <> 0
     C                   EVAL      YL0040 = ' '                                 Text USR 5
     C                   MOVEL     P3HFNZ        YL0040                         Text USR 5
     C                   EVAL      YL0041 = ' '                                 P503-Port of Un
     C                   MOVEL     YL0040        YL0041                         P503-Port of Un
      * EUS TrimL Port of UnldgUS - Country Port of Unlading  * Suppress
      * Trim Left Port of Unlading; Suppress Leading Zero.
     c                   eval      YL0041 = %triml(YL0041 : '0 ')
      *
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0041 = ' '                                 P503-Port of Un
     C                   END                                                    *FI
      * LCL.Create Date D8# = JOB.*Job date
     C                   IF        ##JDT = *ZERO
     C                   Z-ADD     *ZERO         YL0042
     C                   ELSE
     C     ##JDT         ADD       19000000      YL0042                         Create Date D8#
     C                   END
      * Crt Exp Shpmnt Inf HDR CR - EDI Export Shpmnt Inf HDR  * 
     C                   EXSR      SNCRRC
      * Create EDI Export Shpmnt Inf DTL (ECP137).
      * CASE: *OTHERWISE
      * Set Qty/Wgt Total.
      * CASE: *OTHERWISE
      * Rtv Sum Qty/Wgt f/601  RT - Order Header Extension  * 
     C                   EXSR      SORVGN
      * Override State Code & Update ECP136 HDR Record.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Order Number Saved USR NE DB1.Order Number
      *   |- c2    : LCL.Order Number Saved USR is Not equal to zeros
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0046 <> WAC4NB
     C                   IF        YL0046 <> 0
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Order Number changed means another Whse have the most Qty Wgt.
      * Use this Whse address info when creating ECP135 NME 'EX' record.
      * RTV 1st Warehouse 2    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     YL0045        WL0005                         Company Number
     C                   Z-ADD     YL0046        WL0006                         Order Number
     C                   Z-ADD     *ZERO         WL0007                         Order Sequence
     C                   Z-ADD     *ZERO         WL0008                         Order Secondary
     C                   EXSR      SKRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0009        YL0027                         Warehouse Code
     C                   MOVEL     YL0027        YL0028                         Ship From Wareh
      * Rtv for EDI 601 ESI   RT - Warehouse Codes  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0028        WL0010                         Warehouse Code
     C                   EXSR      SLRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0011        YL0029                         Address Line 1
     C                   MOVEL(P)  WL0012        YL0030                         Address Line 2
     C                   MOVEL(P)  WL0013        YL0031                         City
     C                   MOVEL(P)  WL0014        YL0032                         Zip Postal Code
     C                   MOVEL(P)  WL0015        YL0033                         State Code
     C                   MOVEL(P)  WL0016        YL0034                         Warehouse Type
      * Update State Code in ECP136 HDR Record. Ship From Whse Address in
      * will be updated downstream.
      * Upd Ship From State CdeRT - EDI Export Shpmnt Inf HDR  * 
     C                   EXSR      SQRVGN
     C                   END                                                    *FI
     C                   Z-ADD     YL0044        YL0056                         L1304-Qty Shipp
      * Convert NET Weight from LBS to KG.
     C     YL0047        DIV(H)    2.2046        YL0057                         Net Weight Tota
      * Drop the Decimals for Net Weight.
     C                   Z-ADD     YL0057        YL0058                         USR Net Wgt LBS
     C                   Z-ADD     YL0058        YL0047                         L1304-Net Wgt S
      * Convert GROSS Weight from LBS to KG.
     C     YL0043        DIV(H)    2.2046        YL0059                         Gross Weight To
      * Drop the Decimals in Weight.
     C                   Z-ADD     YL0059        YL0060                         USR Gross Wgt L
     C                   Z-ADD     YL0060        YL0061                         L1311-Gross Wgt
      * Set L1302-Commodity Code & L1312-Chilled/Frozen Text.
      * CASE: LCL.Warehouse Type is Fresh
     C                   IF        YL0034 = 'FR'
     C                   EVAL      YL0062 = ' '                                 L1302-Commodity
     C                   MOVEL     @CN(002)      YL0062                         L1302-Commodity
     C                   EVAL      YL0063 = ' '                                 L1312-Chilled/F
     C                   MOVEL     @CN(003)      YL0063                         L1312-Chilled/F
     C                   ELSE
      * CASE: *OTHERWISE
      * Frozen.
     C                   EVAL      YL0062 = ' '                                 L1302-Commodity
     C                   MOVEL     @CN(004)      YL0062                         L1302-Commodity
     C                   EVAL      YL0063 = ' '                                 L1312-Chilled/F
     C                   MOVEL     @CN(005)      YL0063                         L1312-Chilled/F
     C                   END                                                    *FI
      * Crt Exp Shpmnt Inf DTL CR - EDI Export Shpmnt Inf DTL  * 
     C                   EXSR      SSCRRC
      * Create EDI Export Shpmnt Inf NME (ECP135).
      * CASE: *OTHERWISE
      * 'EX' (US Principle Party in Interest).
      * CASE: *OTHERWISE
      * ***Use Address Info from Ship From Warehouse.
      * Rtv for All           RT - Company Name and Address  * Corporate
     C                   EXSR      STRVGN
      * Get Country Code ISO 2A.
      * CASE: *OTHERWISE
      * Rtv Country ISO Code  RT - Country EXT  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0065        WL0003                         Country Code
     C                   EXSR      SJRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0004        YL0026                         ISO Alpha2 Code
      * Get N202-Contact Phone Nbr.
      * CASE: *OTHERWISE
      * RTV System Value Alpha RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  @CN(006)      WL0021                         System Value Co
     C                   EXSR      SURVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0022        YL0066                         System Value Al
      * RTV System Value Alpha RT - System Values  * Contact Name
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  @CN(007)      WL0021                         System Value Co
     C                   EXSR      SURVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0022        YL0067                         System Value Al
      * Substring Out First & Last Name.
      * CASE: LCL.N201-NAME is Entered
      * Eus Scan f/VarChar Pos US - /UT User Source  * Scan for 'blank'
     C                   IF        YL0067 <> ' '
      * Scan for Variable Character to know what position it was.
      /free
       $string2_data = *blank;
       $string2_data = YL0067;
       $var_char = ' ';
       $pos2 = %scan ($var_char : $string2_data);
       If $pos2 = 0;
         YL0068 = $pos2;  // Not Found
       Else;
         YL0068 = $pos2;  // Found
       EndIf;
      /end-free
     C     YL0068        SUB       1             YL0069                         First Name End
     C                   Z-ADD     YL0069        YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0067:ZQ     YL0070                 90      N201-FIRSTNAME
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C     YL0068        ADD       1             YL0071                         Last Name Beg P
     C                   Z-ADD     25            YRSW00
     C                   Z-ADD     YL0071        ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00060 OR
     C                             ZQ > 00060
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0067:ZQ     YL0072                 90      N201-LASTNAME
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0070 = ' '                                 N201-FIRSTNAME
     C                   EVAL      YL0072 = ' '                                 N201-LASTNAME
     C                   END                                                    *FI
      * Remove '-' Dash from Postal Code if Exist.
      * CASE: LCL.N403-POSTAL CODE is Entered
      * Eus Scan f/VarChar Pos US - /UT User Source  * Scan for 'dash'
     C                   IF        YL0032 <> ' '
      /free
       $string2_data = *blank;
       $string2_data = YL0032;
       $var_char = '-';
       $pos2 = %scan ($var_char : $string2_data);
       If $pos2 = 0;
         YL0068 = $pos2;  // Not Found
       Else;
         YL0068 = $pos2;  // Found
       EndIf;
      /end-free
      * Dash Found.
      * CASE: LCL.Starting Position USR is Entered
     C                   IF        YL0068 > 0
     C     YL0068        SUB       1             YL0073                         Zip Code End Po
     C                   Z-ADD     YL0073        YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00015 OR
     C                             ZQ > 00015
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0032:ZQ     YL0074                 90      Zip Code 5A USR
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C     YL0068        ADD       1             YL0075                         Zip +4 Code Beg
     C                   Z-ADD     4             YRSW00
     C                   Z-ADD     YL0075        ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00015 OR
     C                             ZQ > 00015
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0032:ZQ     YL0076                 90      Zip +4 Code 4A
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
      * Concat Zip Code.
     C                   EVAL      YL0032 = ' '                                 N403-POSTAL COD
     C                   Z-ADD     *ZERO         ZQ
     C     YL0074        CAT(P)    YL0076:ZQ     YL0032                         N403-POSTAL COD
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Crt Exp Shpmnt Inf DTL CR - EDI Export Shpmnt Inf NME  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     YL0025        WL0023                         ST02-TRANS SET
     C                   MOVEL(P)  'EX'          WL0024                         N101-NAME TYPE
     C                   MOVEL(P)  YL0064        WL0025                         N102-NAME
     C                   MOVEL(P)  '24'          WL0026                         N103-ID CODE QU
     C                   MOVEL(P)  @CN(008)      WL0027                         N104-Identifica
     C                   EVAL      WL0028 = ' '                                 N105-Entity Rel
     C                   EVAL      WL0029 = ' '                                 N106-Entity ID
     C                   MOVEL(P)  YL0070        WL0030                         N201-FIRSTNAME
     C                   MOVEL(P)  YL0072        WL0031                         N201-LASTNAME
     C                   MOVEL(P)  YL0066        WL0032                         N202-Contact Ph
     C                   MOVEL(P)  YL0029        WL0033                         N301-Address Li
     C                   MOVEL(P)  YL0030        WL0034                         N302-Address Li
     C                   MOVEL(P)  YL0031        WL0035                         N401-CITY
     C                   MOVEL(P)  YL0033        WL0036                         N402-STATE
     C                   MOVEL(P)  YL0032        WL0037                         N403-POSTAL COD
     C                   MOVEL(P)  YL0026        WL0038                         N404-COUNTRY CO
     C                   EXSR      SVCRRC
      * 'CN' (Ultimate Consignee).
      * CASE: *OTHERWISE
      * DN 5/5/23-Business wants to get Consignee Address info from PDMRR
      *  Commented out Ship To Address Info.
      * Get Consignee Address Line 1, 2 & City.
      * CASE: *OTHERWISE
      * Rtv Consignee Info    RT - Export Doc Order Hdr  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WAAIC3        WL0039                         Company Number
     C                   Z-ADD     WAC4NB        WL0040                         Order Number
     C                   MOVEL(P)  'H'           WL0041                         ED Export Docum
     C                   EXSR      SWRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0042        YL0077                         ED Consignee Na
     C                   MOVEL(P)  WL0043        YL0078                         ED Consignee Ad
     C                   MOVEL(P)  WL0044        YL0079                         ED Consignee Ad
     C                   MOVEL(P)  WL0045        YL0080                         ED Consignee Ad
     C                   MOVEL(P)  WL0046        YL0081                         ED Consignee Ad
     C                   MOVEL(P)  WL0047        YN0016                         ED Consignee St
     C                   MOVEL(P)  WL0048        YN0017                         ED Consignee Po
     C                   MOVEL(P)  WL0049        YN0018                         ED Consignee Co
      * Set Ship To City.
      * CASE: LCL.ED Consignee Addr 4 is Blank
     C                   IF        YL0081 = ' '
     C                   MOVEL     WAHNNA        YL0031                         N401-CITY
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     YL0081        YL0031                         N401-CITY
     C                   END                                                    *FI
      * Format Required Fields from PDMRREP to Replace Hex Value 41 to Bl
      * CASE: *OTHERWISE
      * This is due to user copying from a template onto the screen.
      * Cvt Hex 41 to Blank   US - Export Doc Order Hdr  * 
      * Cvt Hex 41 to Blank   US
      *
      * Consignee Name.
     C                   move      YL0077        wkrhtx
     C                   if        wkrhtx <> *blank
     C     x'41':' '     xlate     wkrhtx        YL0077
     C                   endif
      * Consignee Addr 1.
     C                   move      YL0078        wkritx
     C                   if        wkritx <> *blank
     C     x'41':' '     xlate     wkritx        YL0078
     C                   endif
      * Consignee Addr 2.
     C                   move      YL0079        wkrjtx
     C                   if        wkrjtx <> *blank
     C     x'41':' '     xlate     wkrjtx        YL0079
     C                   endif
      *
      * Consignee City.
     C                   move      YL0031        wkityx
     C                   if        wkityx <> *blank
     C     x'41':' '     xlate     wkityx        YL0031
     C                   endif
      *
      * Suppress State Code.
      * CASE: DB1.Ship To State Code is International Accounts
     C                   IF        WADBCD = '.'
     C                   EVAL      YL0082 = ' '                                 N402-STATE
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     WADBCD        YL0082                         N402-STATE
     C                   END                                                    *FI
      * Suppress Zip Code.
      * CASE: DB1.Ship To Zip/Postal Code is International
     C                   IF        WACKTX = '.'
     C                   EVAL      YL0032 = ' '                                 N403-POSTAL COD
     C                   ELSE
      * CASE: *OTHERWISE
      * Override Zip Code if Puerto Rico Else Set to Blank.
      * CASE: PAR.Country Code is Puerto Rico
     C                   IF        P2KXCD = 'PRI'
     C                   EVAL      YL0032 = ' '                                 N403-POSTAL COD
     C                   MOVEL     WACKTX        YL0032                         N403-POSTAL COD
      * Remove '-' Dash from Postal Code if Exist.
      * CASE: LCL.N403-POSTAL CODE is Entered
      * Eus Scan f/VarChar Pos US - /UT User Source  * Scan for 'dash'
     C                   IF        YL0032 <> ' '
      /free
       $string2_data = *blank;
       $string2_data = YL0032;
       $var_char = '-';
       $pos2 = %scan ($var_char : $string2_data);
       If $pos2 = 0;
         YL0068 = $pos2;  // Not Found
       Else;
         YL0068 = $pos2;  // Found
       EndIf;
      /end-free
      * Dash Found.
      * CASE: LCL.Starting Position USR is Entered
     C                   IF        YL0068 > 0
     C     YL0068        SUB       1             YL0073                         Zip Code End Po
     C                   Z-ADD     YL0073        YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00015 OR
     C                             ZQ > 00015
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0032:ZQ     YL0074                 90      Zip Code 5A USR
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C     YL0068        ADD       1             YL0075                         Zip +4 Code Beg
     C                   Z-ADD     4             YRSW00
     C                   Z-ADD     YL0075        ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00015 OR
     C                             ZQ > 00015
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  YL0032:ZQ     YL0076                 90      Zip +4 Code 4A
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
      * Concat Zip Code.
     C                   EVAL      YL0032 = ' '                                 N403-POSTAL COD
     C                   Z-ADD     *ZERO         ZQ
     C     YL0074        CAT(P)    YL0076:ZQ     YL0032                         N403-POSTAL COD
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
     C                   EVAL      YL0032 = ' '                                 N403-POSTAL COD
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Get Country Code ISO 2A.
      * CASE: *OTHERWISE
      * Rtv Country ISO Code  RT - Country EXT  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  P2KXCD        WL0003                         Country Code
     C                   EXSR      SJRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0004        YL0026                         ISO Alpha2 Code
      * Override the Country Code & State Code if Puerto Rico Country.
      * CASE: LCL.ISO Alpha-2 Code is Puerto Rico
     C                   IF        YL0026 = 'PR'
     C                   MOVEL     'US'          YL0026                         ISO Alpha2 Code
     C                   MOVEL     'PR'          YL0082                         N402-STATE
     C                   END                                                    *FI
      * Val addr flds spl char IF - Order Header TRG  * 
     C                   EXSR      SXINFN
      * Crt Exp Shpmnt Inf DTL CR - EDI Export Shpmnt Inf NME  * Ship To
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     YL0025        WL0023                         ST02-TRANS SET
     C                   MOVEL(P)  'CN'          WL0024                         N101-NAME TYPE
     C                   MOVEL(P)  YL0077        WL0025                         N102-NAME
     C                   EVAL      WL0026 = ' '                                 N103-ID CODE QU
     C                   EVAL      WL0027 = ' '                                 N104-Identifica
     C                   MOVEL(P)  '01'          WL0028                         N105-Entity Rel
     C                   MOVEL(P)  'DU'          WL0029                         N106-Entity ID
     C                   EVAL      WL0030 = ' '                                 N201-FIRSTNAME
     C                   EVAL      WL0031 = ' '                                 N201-LASTNAME
     C                   EVAL      WL0032 = ' '                                 N202-Contact Ph
     C                   MOVEL(P)  YL0078        WL0033                         N301-Address Li
     C                   MOVEL(P)  YL0079        WL0034                         N302-Address Li
     C                   MOVEL(P)  YL0031        WL0035                         N401-CITY
     C                   MOVEL(P)  YL0082        WL0036                         N402-STATE
     C                   MOVEL(P)  YL0032        WL0037                         N403-POSTAL COD
     C                   MOVEL(P)  YL0026        WL0038                         N404-COUNTRY CO
     C                   EXSR      SVCRRC
      * Update OHE EDI 601 Action = 'Sent' for All Orders by Load/Booking
      * CASE: LCL.Upd OHE EDI 601 Action U is Yes
      * Upd OHE EDI 601 Action XF - Order Header Extension  * 
     C                   IF        YL0017 = 'Y'
     C                   CALL      'PUXYXFR'                            90      Upd OHE EDI 601
     C                   PARM      *BLANK        W0RTN
     C                   PARM      P1RMNB        WQ0028                         Load ID
     C                   PARM      YL0002        WQ0029                         OHE Booking Num
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUXYXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSD         READE     @BFCPMC                                90    *
     C                   ENDDO
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * RTV EDI 601/824 Sts    RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0018 = ' '                                 OHE EDI 824 Act
     C                   EVAL      YL0019 = ' '                                 OHE EDI 601 Act
     C                   EVAL      YL0020 = ' '                                 OHE EDI 824 AES
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WAAIC3        WBAIC3                         Company Number
     C                   Z-ADD     WAC4NB        WBC4NB                         Order Number
      * Establish starting position
     C     KRSSE         CHAIN     @AMREJF                            90        *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBJVSC        YL0018                         OHE EDI 824 Act
     C                   MOVEL     WBJZSC        YL0019                         OHE EDI 601 Act
     C                   MOVEL     WBM2U1        YL0020                         OHE EDI 824 AES
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * Upd Pending EDI 601 RcdRT - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    WQSF01                         BA105-Shipment
     C                   KFLD                    WQSF02                         EDI-Record Proc
      * Setup key
     C                   Z-ADD     WARMNB        WQSF01                         BA105-Shipment
     C                   MOVEL     'P'           WQSF02                         EDI-Record Proc
      * Establish starting position
     C     KRSSF         SETLL     @P136LU                                      *
     C     KRSSF         READE     @P136LU                                90    *
      * Data record not found
     C   90              MOVEL     'USR5267'     W0RTN
      * USER: Process Data record
      * Update 'Pending' 601 Records.
      * CASE: PAR.First Time Through USR is Yes
     C                   DOW       NOT *IN90
     C                   IF        YL0023 = 'Y'
     C                   MOVEL     'N'           YL0023                         First Time Thro
      * GoAnywhere will process this record now.
      * Update 'BA102-Action Code' if Need To.
      * CASE: PAR.Upd BA102-Action Code USR is Yes
      * ITN# Received, Update to 'RX' (Change) if '1' (New).
      * CASE: DB1.BA102-Action Code is Add/New
     C                   IF        'N' = 'Y'
      * Chg Pending EDI 601 RcdCH - EDI Export Shpmnt Inf HDR  * 
     C                   IF        WDA9AB = '1'
     C                   EXSR      SGCHRC
     C                   ELSE
      * CASE: *OTHERWISE
      * Chg EDI Rcd Processed CH - EDI Export Shpmnt Inf HDR  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WDTSCN        WL0001                         ST02-TRANS SET
     C                   MOVEL(P)  'N'           WL0002                         EDI-Record Proc
     C                   EXSR      SHCHRC
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Chg EDI Rcd Processed CH - EDI Export Shpmnt Inf HDR  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WDTSCN        WL0001                         ST02-TRANS SET
     C                   MOVEL(P)  'N'           WL0002                         EDI-Record Proc
     C                   EXSR      SHCHRC
     C                   END                                                    *FI
      * Reset OHE EDI 824 Action to 'Blank' to Reprocess.
      * Upd OHE EDI 824 Action XF - Order Header Extension  * 
     C                   CALL      'PUXXXFR'                            90      Upd OHE EDI 824
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WDHDNZ        WQ0001                         Load ID
     C                   PARM      YL0024        WQ0002                         OHE Booking Num
     C                   PARM      *BLANK        WQ0003                         EDI-Record Proc
     C                   PARM      '8'           WQ0004                         Update OHE EDI
     C                   PARM      *BLANK        WQ0005                         OHE EDI 824 AES
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUXXXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   ELSE
      * CASE: *OTHERWISE
      * GoAnywhere will NOT process these records.
      * Chg EDI Rcd Processed CH - EDI Export Shpmnt Inf HDR  * Cancel
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WDTSCN        WL0001                         ST02-TRANS SET
     C                   MOVEL(P)  'X'           WL0002                         EDI-Record Proc
     C                   EXSR      SHCHRC
     C                   END                                                    *FI
     C     KRSSF         READE     @P136LU                                90    *
     C                   ENDDO
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGCHRC        BEGSR
      *================================================================
      * Chg Pending EDI 601 RcdCH - EDI Export Shpmnt Inf HDR  * 
      *================================================================
      *
     C                   EVAL      WN0001 = ' '                                 TRADE PARTNER C
     C                   EVAL      WN0002 = ' '                                 BA101-Related C
     C                   EVAL      WN0003 = ' '                                 BA103-Transport
     C                   EVAL      WN0004 = ' '                                 BA104-Country C
     C                   Z-ADD     *ZERO         WN0005                         BA105-Shipment
     C                   EVAL      WN0006 = ' '                                 BA108-Ship From
     C                   EVAL      WN0007 = ' '                                 BA109-IRS Ident
     C                   EVAL      WN0008 = ' '                                 BA110-SCAC
     C                   EVAL      WN0009 = ' '                                 BA112-Vessel Na
     C                   EVAL      WN0010 = ' '                                 YNQ01-Type of F
     C                   Z-ADD     *ZERO         WN0011                         DTM02-Sail Date
     C                   EVAL      WN0012 = ' '                                 PS03-Port of Ex
     C                   EVAL      WN0013 = ' '                                 P503-Port of Un
     C                   EVAL      WN0014 = ' '                                 REF02-Ref ITN
     C                   EVAL      WN0015 = ' '                                 M1201-Customs E
     C                   EVAL      WN0016 = ' '                                 M1202-Customs E
     C                   EVAL      WN0017 = ' '                                 M1203-Location
     C                   EVAL      WN0018 = ' '                                 M1204-Foreign P
     C                   EVAL      WN0019 = ' '                                 EDI ESIH-Unused
     C                   EVAL      WN0020 = ' '                                 ESIH OHE Bookin
     C                   EVAL      WN0021 = ' '                                 EDI ESIH-Unused
     C                   Z-ADD     *ZERO         WN0022                         Create Date D8#
     C                   Z-ADD     *ZERO         WN0023                         Create Time
     C                   EVAL      WN0024 = ' '                                 EDI 824 Receive
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @COCPKT
     C                   Z-ADD     WDTSCN        WETSCN                         ST02-TRANS SET
      *
     C     KLCHSG        KLIST
     C                   KFLD                    WETSCN                         ST02-TRANS SET
     C     KLCHSG        CHAIN     @COCPKT                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'ECP136L0'    MDACP
     C                   MOVEL     '@COCPKT'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SGEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QECP11        YARDCS
      * Move non-key fields to @COCPKT
     C                   MOVEL(P)  'N'           WEA0ST                         EDI-Record Proc
     C                   MOVEL(P)  'RX'          WEA9AB                         BA102-Action Co
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QECP11 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @COCPKT                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    ECP136L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHCHRC        BEGSR
      *================================================================
      * Chg EDI Rcd Processed CH - EDI Export Shpmnt Inf HDR  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   EVAL      WN0025 = ' '                                 TRADE PARTNER C
     C                   EVAL      WN0026 = ' '                                 BA101-Related C
     C                   EVAL      WN0027 = ' '                                 BA102-Action Co
     C                   EVAL      WN0028 = ' '                                 BA103-Transport
     C                   EVAL      WN0029 = ' '                                 BA104-Country C
     C                   Z-ADD     *ZERO         WN0030                         BA105-Shipment
     C                   EVAL      WN0031 = ' '                                 BA108-Ship From
     C                   EVAL      WN0032 = ' '                                 BA109-IRS Ident
     C                   EVAL      WN0033 = ' '                                 BA110-SCAC
     C                   EVAL      WN0034 = ' '                                 BA112-Vessel Na
     C                   EVAL      WN0035 = ' '                                 YNQ01-Type of F
     C                   Z-ADD     *ZERO         WN0036                         DTM02-Sail Date
     C                   EVAL      WN0037 = ' '                                 PS03-Port of Ex
     C                   EVAL      WN0038 = ' '                                 P503-Port of Un
     C                   EVAL      WN0039 = ' '                                 REF02-Ref ITN
     C                   EVAL      WN0040 = ' '                                 M1201-Customs E
     C                   EVAL      WN0041 = ' '                                 M1202-Customs E
     C                   EVAL      WN0042 = ' '                                 M1203-Location
     C                   EVAL      WN0043 = ' '                                 M1204-Foreign P
     C                   EVAL      WN0044 = ' '                                 EDI ESIH-Unused
     C                   EVAL      WN0045 = ' '                                 ESIH OHE Bookin
     C                   EVAL      WN0046 = ' '                                 EDI ESIH-Unused
     C                   Z-ADD     *ZERO         WN0047                         Create Date D8#
     C                   Z-ADD     *ZERO         WN0048                         Create Time
     C                   EVAL      WN0049 = ' '                                 EDI 824 Receive
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to @COCPKT
     C                   Z-ADD     WL0001        WETSCN                         ST02-TRANS SET
      *
     C     KLCHSH        KLIST
     C                   KFLD                    WETSCN                         ST02-TRANS SET
     C     KLCHSH        CHAIN     @COCPKT                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'ECP136L0'    MDACP
     C                   MOVEL     '@COCPKT'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SHEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SHEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QECP11        YBRDCS
      * Move non-key fields to @COCPKT
     C                   MOVEL(P)  WL0002        WEA0ST                         EDI-Record Proc
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QECP11 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    @COCPKT                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    ECP136L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   SIRVGN        BEGSR
      *================================================================
      * Rtv Next Control #     RT - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Establish starting position
     C     *HIVAL        SETLL     @P136K1                                      *
     C                   READ      @P136K1                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR5267'     W0RTN
      * USER: Processing if Data record not found
     C                   Z-ADD     100           YL0025                         ST02-TRANS SET
     C                   GOTO      SIEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C     WFTSCN        ADD       1             YL0025                         ST02-TRANS SET
     C                   GOTO      SIEXIT                                       *QUIT
     C                   READ      @P136K1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SIEXIT        ENDSR
      /EJECT
     CSR   SJRVGN        BEGSR
      *================================================================
      * Rtv Country ISO Code  RT - Country EXT  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSJ         KLIST
     C                   KFLD                    WGKXCD                         Country Code
      * Setup key
     C                   MOVEL     WL0003        WGKXCD                         Country Code
      * Establish starting position
     C     KRSSJ         CHAIN     @HAREKV                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR4430'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0004 = ' '                                 ISO Alpha2 Code
     C                   GOTO      SJEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WGX2AA        WL0004                         ISO Alpha2 Code
     C                   ENDIF
      *================================================================
     CSR   SJEXIT        ENDSR
      /EJECT
     CSR   SKRVGN        BEGSR
      *================================================================
      * RTV 1st Warehouse 2    RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0009 = ' '                                 Warehouse Code
      * Declare restrictor key work fields
      * Define keylist
     C     KPSSK         KLIST
     C                   KFLD                    WQSK01                         Company Number
     C                   KFLD                    WQSK02                         Order Number
     C                   KFLD                    WHDPNB                         Order Sequence
     C                   KFLD                    WHUENB                         Order Secondary
      * Define keylist
     C     KRSSK         KLIST
     C                   KFLD                    WQSK01                         Company Number
     C                   KFLD                    WQSK02                         Order Number
      * Setup key
     C                   Z-ADD     WL0005        WQSK01                         Company Number
     C                   Z-ADD     WL0006        WQSK02                         Order Number
     C                   Z-ADD     WL0007        WHDPNB                         Order Sequence
     C                   Z-ADD     WL0008        WHUENB                         Order Secondary
      * Establish starting position
     C     KPSSK         SETLL     @BGWKAE                                      *
     C     KRSSK         READE     @BGWKAE                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WHAJCD        WL0009                         Warehouse Code
     C                   GOTO      SKEXIT                                       *QUIT
     C     KRSSK         READE     @BGWKAE                                90    *
     C                   ENDDO
      *================================================================
     CSR   SKEXIT        ENDSR
      /EJECT
     CSR   SLRVGN        BEGSR
      *================================================================
      * Rtv for EDI 601 ESI   RT - Warehouse Codes  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0011 = ' '                                 Address Line 1
     C                   EVAL      WL0012 = ' '                                 Address Line 2
     C                   EVAL      WL0013 = ' '                                 City
     C                   EVAL      WL0014 = ' '                                 Zip Postal Code
     C                   EVAL      WL0015 = ' '                                 State Code
     C                   EVAL      WL0016 = ' '                                 Warehouse Type
      * Define keylist
     C     KRSSL         KLIST
     C                   KFLD                    WIAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     WL0010        WIAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSL         CHAIN     @ADREAO                            90        *
      * Data record not found
     C   90              MOVEL     'USR0007'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WIACNA        WL0011                         Address Line 1
     C                   MOVEL     WIADNA        WL0012                         Address Line 2
     C                   MOVEL     WIAJNA        WL0013                         City
     C                   MOVEL     WIBTTX        WL0014                         Zip Postal Code
     C                   MOVEL     WIBGCD        WL0015                         State Code
     C                   MOVEL     WIWPST        WL0016                         Warehouse Type
     C                   ENDIF
      *================================================================
     CSR   SLEXIT        ENDSR
      /EJECT
     CSR   SMRVGN        BEGSR
      *================================================================
      * RTV Federal ID,City,St RT - Company Name and Address  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSM         KLIST
     C                   KFLD                    WJAIC3                         Company Number
      * Setup key
     C                   Z-ADD     WAAIC3        WJAIC3                         Company Number
      * Establish starting position
     C     KRSSM         CHAIN     @ABREG3                            90        *
      * Data record not found
     C   90              MOVEL     'USR0003'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WJA2NA        YL0035                         Federal Tax Id
     C                   ENDIF
      *================================================================
     CSR   SMEXIT        ENDSR
      /EJECT
     CSR   SNCRRC        BEGSR
      *================================================================
      * Crt Exp Shpmnt Inf HDR CR - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @COCPKT
     C                   Z-ADD     YL0025        WETSCN                         ST02-TRANS SET
     C                   MOVEL     YL0021        WEA0ST                         EDI-Record Proc
     C                   EVALR     WEHPAA = ' '                                 TRADE PARTNER C
     C                   MOVEL     'USCBP'       WEHPAA                         TRADE PARTNER C
     C                   MOVEL     'N'           WEA8AB                         BA101-Related C
     C                   MOVEL     YL0022        WEA9AB                         BA102-Action Co
     C                   EVALR     WEBAAB = ' '                                 BA103-Transport
     C                   MOVEL     'O'           WEBAAB                         BA103-Transport
     C                   MOVEL     YL0026        WEBBAB                         BA104-Country C
     C                   Z-ADD     P1RMNB        WEHDNZ                         BA105-Shipment
     C                   MOVEL     YL0033        WEBEAB                         BA108-Ship From
     C                   MOVEL     YL0035        WEVRNA                         BA109-IRS Ident
     C                   MOVEL     P3BYAB        WEBCAB                         BA110-SCAC
     C                   MOVEL     P1J0T1        WES5U1                         BA112-Vessel Na
     C                   EVALR     WEBDAB = ' '                                 YNQ01-Type of F
     C                   MOVEL     'RZ'          WEBDAB                         YNQ01-Type of F
     C                   Z-ADD     YL0039        WEB7DX                         DTM02-Sail Date
     C                   MOVEL     YL0038        WES6U1                         PS03-Port of Ex
     C                   MOVEL     YL0041        WES7U1                         P503-Port of Un
     C                   MOVEL     P1M2U1        WES8U1                         REF02-Ref ITN
     C                   MOVEL     '70'          WEBFAB                         M1201-Customs E
     C                   EVAL      WES9U1 = ' '                                 M1202-Customs E
     C                   EVAL      WETAU1 = ' '                                 M1203-Location
     C                   MOVEL     'Y'           WETBU1                         M1204-Foreign P
     C                   EVAL      WETPU1 = ' '                                 EDI ESIH-Unused
     C                   MOVEL     YL0002        WETQU1                         ESIH OHE Bookin
     C                   EVAL      WETRU1 = ' '                                 EDI ESIH-Unused
     C                   Z-ADD     YL0042        WECADX                         Create Date D8#
     C                   Z-ADD     ##JTM         WEBETM                         Create Time
     C                   MOVEL     'N'           WEN8SC                         EDI 824 Receive
      *
     C     KLCRSN        KLIST
     C                   KFLD                    WETSCN                         ST02-TRANS SET
      * Check for duplicate primary key
     C     KLCRSN        SETLL     @COCPKT                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5268'     W0RTN
      * Send message 'EDI Exp Shpmnt Inf HDR EX'
     C                   MOVEL     'USR5268'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SNEXIT
     C                   ENDIF
      *
     C                   WRITE     @COCPKT                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SNEXIT        ENDSR
      /EJECT
     CSR   SORVGN        BEGSR
      *================================================================
      * Rtv Sum Qty/Wgt f/601  RT - Order Header Extension  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0050                         Total Weight Sh
      *
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0043                         USR Weight Accu
     C                   Z-ADD     *ZERO         YL0044                         USR Quantity, 9
     C                   Z-ADD     *ZERO         YL0045                         Company w/Most
     C                   Z-ADD     *ZERO         YL0046                         Order Number Sa
     C                   Z-ADD     *ZERO         YL0047                         L1304-Net Wgt S
     C                   Z-ADD     *ZERO         WN0050                         Total Weight Sh
     C                   Z-ADD     *ZERO         YL0048                         USR Quantity, 9
     C                   Z-ADD     *ZERO         YL0049                         USR Weight Accu
     C                   MOVEL     'Y'           YL0050                         First Time Thro
     C                   Z-ADD     *ZERO         YL0051                         Company count
     C                   Z-ADD     *ZERO         YL0052                         Total Weight Sh
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSO         KLIST
     C                   KFLD                    WQSO01                         Load ID
      * Setup key
     C                   Z-ADD     WARMNB        WQSO01                         Load ID
      * Establish starting position
     C     KRSSO         SETLL     @AMREL3                                      *
     C     KRSSO         READE     @AMREL3                                90    *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * Booking # Must Match.
      * CASE: PAR.OHE Booking Number EQ DB1.OHE Booking Number
     C                   DOW       NOT *IN90
     C                   IF        YL0002 = WKJ1T1
     C                   Z-ADD     *ZERO         YL0049                         USR Weight Accu
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                   CALL      'PQPQXFR'                            90      RTV Gross Wgt/Q
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WKAIC3        WQ0021                         Company Number
     C                   PARM      WKC4NB        WQ0022                         Order Number
     C                   PARM      *ZERO         WQ0023                         Order Sequence
     C                   PARM      *ZERO         WQ0024                         Order Secondary
     C     YL0049        PARM      YL0049        WQ0025                         USR Weight Accu
     C     YL0048        PARM      YL0048        WQ0026                         Order Quantity
     C                   PARM      *ZERO         WQ0027                         Avg Pallet Tare
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PQPQXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Accumulate Qty/Wgt.
     C                   ADD       YL0048        YL0044                         USR Quantity, 9
     C                   ADD       YL0049        YL0043                         USR Weight Accu
      * Break by Co to Save Which Co have the Most Qty Net Weight.
      * CASE: DB1.Company Number NE LCL.Company Number
     C                   IF        WKAIC3 <> YL0053
     C                   ADD       1             YL0051                         Company count
      * Save/Compare Total Weight Ship Save for Each Company Break.
      * CASE: LCL.Company count is >= 2
      * Save the Company Which have the Most Weight.
      * CASE: PAR.Total Weight Ship    USR GT LCL.Total Weight Ship Save
     C                   IF        YL0051 >= 2
     C                   IF        WN0050 > YL0052
     C                   Z-ADD     WN0050        YL0052                         Total Weight Sh
     C                   Z-ADD     YL0053        YL0045                         Company w/Most
     C                   Z-ADD     YL0054        YL0046                         Order Number Sa
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   Z-ADD     WKAIC3        YL0053                         Company Number
     C                   Z-ADD     WKC4NB        YL0054                         Order Number Sa
      * First Time Thru.
      * CASE: LCL.First Time Through USR is Yes
     C                   IF        YL0050 = 'Y'
     C                   MOVEL     'N'           YL0050                         First Time Thro
     C                   Z-ADD     WKAIC3        YL0045                         Company w/Most
     C                   Z-ADD     WKC4NB        YL0046                         Order Number Sa
     C                   ELSE
      * CASE: *OTHERWISE
      * Reset Accumulator.
     C                   Z-ADD     *ZERO         WN0050                         Total Weight Sh
     C                   END                                                    *FI
      * Rtv Sum Ord/Ship Wgt   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WKAIC3        WL0017                         Company Number
     C                   Z-ADD     WKC4NB        WL0018                         Order Number
     C                   MOVEL(P)  WAGWST        WL0019                         Header Status
     C                   Z-ADD     YL0055        WL0020                         Total Weight Sh
     C                   EXSR      SPRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0020        YL0055                         Total Weight Sh
     C                   ADD       YL0055        WN0050                         Total Weight Sh
     C                   ADD       YL0055        YL0047                         L1304-Net Wgt S
     C                   ELSE
      * CASE: *OTHERWISE
      * Accumulate Total Weight Ship    USR for Same Co.
      * Rtv Sum Ord/Ship Wgt   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     WKAIC3        WL0017                         Company Number
     C                   Z-ADD     WKC4NB        WL0018                         Order Number
     C                   MOVEL(P)  WAGWST        WL0019                         Header Status
     C                   Z-ADD     YL0055        WL0020                         Total Weight Sh
     C                   EXSR      SPRVGN
      * Move subroutine local variables to output parameters.
     C                   Z-ADD     WL0020        YL0055                         Total Weight Sh
     C                   ADD       YL0055        WN0050                         Total Weight Sh
     C                   ADD       YL0055        YL0047                         L1304-Net Wgt S
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSO         READE     @AMREL3                                90    *
     C                   ENDDO
      * USER: Exit processing
      * Last Record Processing.
      * CASE: LCL.Company count is >= 2
      * Save the Company Which have the Most Weight.
      * CASE: PAR.Total Weight Ship    USR GT LCL.Total Weight Ship Save
     C                   IF        YL0051 >= 2
     C                   IF        WN0050 > YL0052
     C                   Z-ADD     YL0053        YL0045                         Company w/Most
     C                   Z-ADD     YL0054        YL0046                         Order Number Sa
     C                   END                                                    *FI
     C                   END                                                    *FI
      *================================================================
     CSR   SOEXIT        ENDSR
      /EJECT
     CSR   SPRVGN        BEGSR
      *================================================================
      * Rtv Sum Ord/Ship Wgt   RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   Z-ADD     *ZERO         WL0020                         Total Weight Sh
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSP         KLIST
     C                   KFLD                    WQSP01                         Company Number
     C                   KFLD                    WQSP02                         Order Number
      * Setup key
     C                   Z-ADD     WL0017        WQSP01                         Company Number
     C                   Z-ADD     WL0018        WQSP02                         Order Number
      * Establish starting position
     C     KRSSP         SETLL     @BGWKAE                                      *
     C     KRSSP         READE     @BGWKAE                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * CASE: PAR.Header Status is Confirmed & Complete
     C                   DOW       NOT *IN90
     C                   IF        WL0019 = 'C' OR
     C                             WL0019 = 'R'
     C                   ADD       WHATWG        WL0020                         Total Weight Sh
     C                   ELSE
      * CASE: *OTHERWISE
     C                   ADD       WHD0WG        WL0020                         Total Weight Sh
     C                   END                                                    *FI
     C     KRSSP         READE     @BGWKAE                                90    *
     C                   ENDDO
      *================================================================
     CSR   SPEXIT        ENDSR
      /EJECT
     CSR   SQRVGN        BEGSR
      *================================================================
      * Upd Ship From State CdeRT - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSQ         KLIST
     C                   KFLD                    WLTSCN                         ST02-TRANS SET
      * Setup key
     C                   Z-ADD     YL0025        WLTSCN                         ST02-TRANS SET
      * Establish starting position
     C     KRSSQ         CHAIN     @COCPKU                            90        *
      * Data record not found
     C   90              MOVEL     'USR5267'     W0RTN
      * USER: Process Data record
      * Chg Exp Shpmnt Inf HDR CH - EDI Export Shpmnt Inf HDR  * 
     C                   IF        NOT *IN90
     C                   EXSR      SRCHRC
     C                   ENDIF
      *================================================================
     CSR   SQEXIT        ENDSR
      /EJECT
     CSR   SRCHRC        BEGSR
      *================================================================
      * Chg Exp Shpmnt Inf HDR CH - EDI Export Shpmnt Inf HDR  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YCRDC = ' '
      *
      * Move key fields to @COCPKT
     C                   Z-ADD     WLTSCN        WETSCN                         ST02-TRANS SET
      *
     C     KLCHSR        KLIST
     C                   KFLD                    WETSCN                         ST02-TRANS SET
     C     KLCHSR        CHAIN     @COCPKT                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'ECP136L0'    MDACP
     C                   MOVEL     '@COCPKT'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL003.
     C                   MOVEL     'LBL003'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SREXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SREXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QECP11        YCRDCS
      * Move non-key fields to @COCPKT
     C                   MOVEL(P)  WLA0ST        WEA0ST                         EDI-Record Proc
     C                   MOVEL(P)  WLHPAA        WEHPAA                         TRADE PARTNER C
     C                   MOVEL(P)  WLA8AB        WEA8AB                         BA101-Related C
     C                   MOVEL(P)  WLA9AB        WEA9AB                         BA102-Action Co
     C                   MOVEL(P)  WLBAAB        WEBAAB                         BA103-Transport
     C                   MOVEL(P)  WLBBAB        WEBBAB                         BA104-Country C
     C                   Z-ADD     WLHDNZ        WEHDNZ                         BA105-Shipment
     C                   MOVEL(P)  YL0033        WEBEAB                         BA108-Ship From
     C                   MOVEL(P)  WLVRNA        WEVRNA                         BA109-IRS Ident
     C                   MOVEL(P)  WLBCAB        WEBCAB                         BA110-SCAC
     C                   MOVEL(P)  WLS5U1        WES5U1                         BA112-Vessel Na
     C                   MOVEL(P)  WLBDAB        WEBDAB                         YNQ01-Type of F
     C                   Z-ADD     WLB7DX        WEB7DX                         DTM02-Sail Date
     C                   MOVEL(P)  WLS6U1        WES6U1                         PS03-Port of Ex
     C                   MOVEL(P)  WLS7U1        WES7U1                         P503-Port of Un
     C                   MOVEL(P)  WLS8U1        WES8U1                         REF02-Ref ITN
     C                   MOVEL(P)  WLBFAB        WEBFAB                         M1201-Customs E
     C                   MOVEL(P)  WLS9U1        WES9U1                         M1202-Customs E
     C                   MOVEL(P)  WLTAU1        WETAU1                         M1203-Location
     C                   MOVEL(P)  WLTBU1        WETBU1                         M1204-Foreign P
     C                   MOVEL(P)  WLTPU1        WETPU1                         EDI ESIH-Unused
     C                   MOVEL(P)  WLTQU1        WETQU1                         ESIH OHE Bookin
     C                   MOVEL(P)  WLTRU1        WETRU1                         EDI ESIH-Unused
     C                   Z-ADD     WLCADX        WECADX                         Create Date D8#
     C                   Z-ADD     WLBETM        WEBETM                         Create Time
     C                   MOVEL(P)  WLN8SC        WEN8SC                         EDI 824 Receive
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QECP11 <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YCRDC = 'Y'
     C                   UPDATE    @COCPKT                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    ECP136L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SREXIT        ENDSR
      /EJECT
     CSR   SSCRRC        BEGSR
      *================================================================
      * Crt Exp Shpmnt Inf DTL CR - EDI Export Shpmnt Inf DTL  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @CPCPKW
     C                   Z-ADD     YL0025        WMTSCN                         ST02-TRANS SET
     C                   MOVEL     YL0062        WMTFU1                         L1302-Commodity
     C                   Z-ADD     YL0047        WMQ8WG                         L1304-Net Wgt S
     C                   Z-ADD     YL0003        WMN3VL                         L1306-Order Val
     C                   Z-ADD     1             WMHENZ                         L1307-Assigned
     C                   EVAL      WMBGAB = ' '                                 L1308-UOM Code
     C                   Z-ADD     *ZERO         WMTIQT                         L1309-Quantity
     C                   Z-ADD     YL0061        WMQ2WG                         L1311-Gross Wgt
     C                   MOVEL     YL0063        WMTIU1                         L1312-Chilled/F
     C                   MOVEL     'OS'          WMBHAB                         L1313-Export Ex
     C                   EVALR     WMBIAB = ' '                                 L1314-Action Co
     C                   MOVEL     '1'           WMBIAB                         L1314-Action Co
     C                   EVAL      WMBJAB = ' '                                 X101-Licensing
     C                   EVALR     WMTJU1 = ' '                                 X102-Export Lic
     C                   MOVEL     'NLR'         WMTJU1                         X102-Export Lic
     C                   EVAL      WMBKAB = ' '                                 X103-Export Lic
     C                   EVAL      WMBMAB = ' '                                 X105-Export Lic
     C                   EVAL      WMBNAB = ' '                                 X106-Export Lic
     C                   MOVEL     'C33'         WMBSAB                         X107-BIS Licens
     C                   EVAL      WMTKU1 = ' '                                 X108-Schedule B
     C                   MOVEL     'D'           WMBOAB                         X109-Intl/Domes
     C                   Z-ADD     *ZERO         WMBPAB                         X110-Lading Qua
     C                   EVAL      WMBQAB = ' '                                 X113-DDTC UOM C
     C                   Z-ADD     *ZERO         WMH1PR                         X114-Unit Price
     C                   EVAL      WMBRAB = ' '                                 X115-US Govt Li
      *
     C     KLCRSS        KLIST
     C                   KFLD                    WMTSCN                         ST02-TRANS SET
      * Check for duplicate primary key
     C     KLCRSS        SETLL     @CPCPKW                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5270'     W0RTN
      * Send message 'EDI Exp Shpmnt Inf DTL EX'
     C                   MOVEL     'USR5270'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SSEXIT
     C                   ENDIF
      *
     C                   WRITE     @CPCPKW                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SSEXIT        ENDSR
      /EJECT
     CSR   STRVGN        BEGSR
      *================================================================
      * Rtv for All           RT - Company Name and Address  * Corporate
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0064 = ' '                                 Name
     C                   EVAL      YL0065 = ' '                                 Country Code
      * Define keylist
     C     KRSST         KLIST
     C                   KFLD                    WOAIC3                         Company Number
      * Setup key
     C                   Z-ADD     300           WOAIC3                         Company Number
      * Establish starting position
     C     KRSST         CHAIN     @ABREAK                            90        *
      * Data record not found
     C   90              MOVEL     'USR0003'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WOADTX        YL0064                         Name
     C                   MOVEL     WOKXCD        YL0065                         Country Code
     C                   ENDIF
      *================================================================
     CSR   STEXIT        ENDSR
      /EJECT
     CSR   SURVGN        BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSU         KLIST
     C                   KFLD                    WRDOCD                         System Value Co
      * Setup key
     C                   MOVEL     WL0021        WRDOCD                         System Value Co
      * Establish starting position
     C     KRSSU         CHAIN     @DPRETD                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0759'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0022 = ' '                                 System Value Al
     C                   GOTO      SUEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WRBXTX        WL0022                         System Value Al
     C                   ENDIF
      *================================================================
     CSR   SUEXIT        ENDSR
      /EJECT
     CSR   SVCRRC        BEGSR
      *================================================================
      * Crt Exp Shpmnt Inf DTL CR - EDI Export Shpmnt Inf NME  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move all fields to @CQCPKZ
     C                   Z-ADD     WL0023        WSTSCN                         ST02-TRANS SET
     C                   MOVEL     WL0024        WSTYPC                         N101-NAME TYPE
     C                   MOVEL     WL0025        WSAMEX                         N102-NAME
     C                   MOVEL     WL0026        WSDCDQ                         N103-ID CODE QU
     C                   MOVEL     WL0027        WSTLU1                         N104-Identifica
     C                   MOVEL     WL0028        WSBTAB                         N105-Entity Rel
     C                   MOVEL     WL0029        WSBUAB                         N106-Entity ID
     C                   MOVEL     WL0030        WSUDU1                         N201-FIRSTNAME
     C                   MOVEL     WL0031        WSUEU1                         N201-LASTNAME
     C                   MOVEL     WL0032        WSTMU1                         N202-Contact Ph
     C                   MOVEL     WL0033        WSVSNA                         N301-Address Li
     C                   MOVEL     WL0034        WSVTNA                         N302-Address Li
     C                   MOVEL     WL0035        WSITYX                         N401-CITY
     C                   MOVEL     WL0036        WSTATE                         N402-STATE
     C                   MOVEL     WL0037        WSIPXX                         N403-POSTAL COD
     C                   MOVEL     WL0038        WSWFAA                         N404-COUNTRY CO
      *
     C     KLCRSV        KLIST
     C                   KFLD                    WSTSCN                         ST02-TRANS SET
     C                   KFLD                    WSTYPC                         N101-NAME TYPE
      * Check for duplicate primary key
     C     KLCRSV        SETLL     @CQCPKZ                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5272'     W0RTN
      * Send message 'EDI Exp Shpmnt Inf NME EX'
     C                   MOVEL     'USR5272'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SVEXIT
     C                   ENDIF
      *
     C                   WRITE     @CQCPKZ                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SVEXIT        ENDSR
      /EJECT
     CSR   SWRVGN        BEGSR
      *================================================================
      * Rtv Consignee Info    RT - Export Doc Order Hdr  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0042 = ' '                                 ED Consignee Na
     C                   EVAL      WL0043 = ' '                                 ED Consignee Ad
     C                   EVAL      WL0044 = ' '                                 ED Consignee Ad
     C                   EVAL      WL0045 = ' '                                 ED Consignee Ad
     C                   EVAL      WL0046 = ' '                                 ED Consignee Ad
     C                   EVAL      WL0047 = ' '                                 ED Consignee St
     C                   EVAL      WL0048 = ' '                                 ED Consignee Po
     C                   EVAL      WL0049 = ' '                                 ED Consignee Co
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSW         KLIST
     C                   KFLD                    WQSW01                         Company Number
     C                   KFLD                    WQSW02                         Order Number
     C                   KFLD                    WQSW03                         ED Export Docum
      * Setup key
     C                   Z-ADD     WL0039        WQSW01                         Company Number
     C                   Z-ADD     WL0040        WQSW02                         Order Number
     C                   MOVEL     WL0041        WQSW03                         ED Export Docum
      * Establish starting position
     C     KRSSW         SETLL     @MRREWT                                      *
     C     KRSSW         READE     @MRREWT                                90    *
      * Data record not found
     C   90              MOVEL     'USR2743'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WTRHTX        WL0042                         ED Consignee Na
     C                   MOVEL     WTRITX        WL0043                         ED Consignee Ad
     C                   MOVEL     WTRJTX        WL0044                         ED Consignee Ad
     C                   MOVEL     WTSCTX        WL0045                         ED Consignee Ad
     C                   MOVEL     WTSDTX        WL0046                         ED Consignee Ad
     C                   MOVEL     WTAAAB        WL0047                         ED Consignee St
     C                   MOVEL     WTPHU1        WL0048                         ED Consignee Po
     C                   MOVEL     WTABAB        WL0049                         ED Consignee Co
     C     KRSSW         READE     @MRREWT                                90    *
     C                   ENDDO
      *================================================================
     CSR   SWEXIT        ENDSR
      /EJECT
     CSR   SXINFN        BEGSR
      *================================================================
      * Val addr flds spl char IF - Order Header TRG  * 
      *================================================================
      * Val addr flds spl char IF
      * Read system values table for characters to exclude
      * CASE: WRK.Spcl chars for addr flds is Equal to Blank
      * RTV System Value Alpha RT - System Values  * Spcl chars to scan
      * Move input parameters to subroutine local variables.
     C                   IF        WUYFU1 = ' '
     C                   MOVEL(P)  @CN(009)      WL0021                         System Value Co
     C                   EXSR      SURVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0022        WUYFU1                         System Value Al
      * RTV System Value Alpha RT - System Values  * Accent chars to scan
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  @CN(010)      WL0021                         System Value Co
     C                   EXSR      SURVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0022        WUYGU1                         System Value Al
      * RTV System Value Alpha RT - System Values  * Replacement chars
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  @CN(011)      WL0021                         System Value Co
     C                   EXSR      SURVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0022        WUYHU1                         System Value Al
     C                   END                                                    *FI
     C                   EVAL      YL0083 = ' '                                 Characters to R
      * Translate Address line 1
      * CASE: PAR.Address Line 1(EDI) is Not Blank
      * EUS ScnRpl Char 601 Rq US - /UT User Source  * 
     C                   IF        YL0078 <> ' '
      * Scan and Replace Special and Accent Characters
      *
      /free

       //Replace the scan characters in source data with replacement charcaters
       YL0078 = %xlate(WUYFU1 : YL0083 : YL0078) ;

      /end-free
      *
      * EUS ScnRpl Char 601 Rq US - /UT User Source  * 
      /free

       //Replace the scan characters in source data with replacement charcaters
       YL0078 = %xlate(WUYGU1 : WUYHU1 : YL0078) ;

      /end-free
     C                   END                                                    *FI
      * Translate Address line 2
      * CASE: PAR.Address Line 2(EDI) is Not Blank
      * EUS ScnRpl Char 601 Rq US - /UT User Source  * 
     C                   IF        YL0079 <> ' '
      /free

       //Replace the scan characters in source data with replacement charcaters
       YL0079 = %xlate(WUYFU1 : YL0083 : YL0079) ;

      /end-free
      * EUS ScnRpl Char 601 Rq US - /UT User Source  * 
      /free

       //Replace the scan characters in source data with replacement charcaters
       YL0079 = %xlate(WUYGU1 : WUYHU1 : YL0079) ;

      /end-free
     C                   END                                                    *FI
      * Translate Address line 3
      * CASE: PAR.Address Line 3(EDI) is Not Blank
      * EUS ScnRpl Char 601 Rq US - /UT User Source  * 
     C                   IF        YL0080 <> ' '
      /free

       //Replace the scan characters in source data with replacement charcaters
       YL0080 = %xlate(WUYFU1 : YL0083 : YL0080) ;

      /end-free
      * EUS ScnRpl Char 601 Rq US - /UT User Source  * 
      /free

       //Replace the scan characters in source data with replacement charcaters
       YL0080 = %xlate(WUYGU1 : WUYHU1 : YL0080) ;

      /end-free
     C                   END                                                    *FI
      * Translate Address line 4
      * CASE: PAR.Address Line 4(EDI) is Not Blank
      * EUS ScnRpl Char 601 Rq US - /UT User Source  * 
     C                   IF        YL0031 <> ' '
      /free

       //Replace the scan characters in source data with replacement charcaters
       YL0031 = %xlate(WUYFU1 : YL0083 : YL0031) ;

      /end-free
      * EUS ScnRpl Char 601 Rq US - /UT User Source  * 
      /free

       //Replace the scan characters in source data with replacement charcaters
       YL0031 = %xlate(WUYGU1 : WUYHU1 : YL0031) ;

      /end-free
     C                   END                                                    *FI
      *================================================================
     CSR   SXEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WAANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WAA0DT                         Order Date
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WAACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WAJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WAA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WAEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WAAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WATBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WARNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WAATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WARSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WAT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WACONB                         Invoice Number
     C                   Z-ADD     *ZERO         WAAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WAVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WAB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WANODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WANPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WANQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WANRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WANSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WABPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WABQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WABRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WABSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WABTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WAH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WAH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WAH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WAH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WAH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WAC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBRMNB                         Load ID
     C                   Z-ADD     *ZERO         WBRUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         WBQWDT                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WBQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WBQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WBGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WBHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WBHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WBQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WBQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WBQ1DT                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WBQ2DT                         OHE Actual Ship
     C                   Z-ADD     *ZERO         WBITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WBQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WBQKNY                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WBQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WBP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WBP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WBQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WBQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WBQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WBQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WBQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WBQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WBQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WBQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WBQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WBW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WBW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCB1AB                         CBP Export Port
     C                   Z-ADD     *ZERO         WCHLNZ                         SLPE Unused Nbr
     C                   Z-ADD     *ZERO         WCB9DX                         SLPE Unused Dte
     C                   Z-ADD     *ZERO         WCMJDT                         Create Date
     C                   Z-ADD     *ZERO         WCBETM                         Create Time
     C                   Z-ADD     *ZERO         WCMKDT                         Change Date
     C                   Z-ADD     *ZERO         WCBFTM                         Change Time
      * Define work field Spcl chars for addr flds
     C                   EVAL      WUYFU1 = ' '
      * Define work field Accent chars to scan
     C                   EVAL      WUYGU1 = ' '
      * Define work field Replacement chars
     C                   EVAL      WUYHU1 = ' '
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDTSCN                         ST02-TRANS SET
     C                   Z-ADD     *ZERO         WDHDNZ                         BA105-Shipment
     C                   Z-ADD     *ZERO         WDB7DX                         DTM02-Sail Date
     C                   Z-ADD     *ZERO         WDCADX                         Create Date D8#
     C                   Z-ADD     *ZERO         WDBETM                         Create Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WGMJDT                         Create Date
     C                   Z-ADD     *ZERO         WGBETM                         Create Time
     C                   Z-ADD     *ZERO         WGMKDT                         Change Date
     C                   Z-ADD     *ZERO         WGBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WHAIC3                         Company Number
     C                   Z-ADD     *ZERO         WHC4NB                         Order Number
     C                   Z-ADD     *ZERO         WHDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WHUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WHHGCD                         Item Code
     C                   Z-ADD     *ZERO         WHBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WHCFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WHMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WHKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WHL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WHL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WHAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WHEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WHBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WHL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WHGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WHR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WHAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WHD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WHCCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WHAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WHCBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WHATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WHAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WHAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WHAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WHALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WHAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WHAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WHA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WHA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WHAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WHGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WHRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WHRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WHRINB                         Item Structure
     C                   Z-ADD     *ZERO         WHCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WHDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WHB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WHA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WHNTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WHNUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WHNVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WHNWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WHNXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         WHBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WHBVTM                         Price Code
     C                   Z-ADD     *ZERO         WHBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WHBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WHBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WHH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WHH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WHH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WHH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WHH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WHDVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WHDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WHDXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WHDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WHDZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         WHGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         WHGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WHGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WHPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WHRINY                         Item Age Days
     C                   Z-ADD     *ZERO         WHTIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WHTJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WHTKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WHTLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WHTMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WHAATM                         Job Time
     C                   Z-ADD     *ZERO         WHAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WIDBNB                         Warehouse Chill
     C                   Z-ADD     *ZERO         WIBWC3                         Shipping Compan
     C                   Z-ADD     *ZERO         WIBTC3                         Accounting Comp
     C                   Z-ADD     *ZERO         WIBUC3                         WHS Sched Prod
     C                   Z-ADD     *ZERO         WIBVC3                         WHS Inventory C
     C                   Z-ADD     *ZERO         WIAATM                         Job Time
     C                   Z-ADD     *ZERO         WIAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WJAIC3                         Company Number
     C                   Z-ADD     *ZERO         WJAATM                         Job Time
     C                   Z-ADD     *ZERO         WJAXDT                         Job Date
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WMTSCN                         ST02-TRANS SET
     C                   Z-ADD     *ZERO         WMQ8WG                         L1304-Net Wgt S
     C                   Z-ADD     *ZERO         WMN3VL                         L1306-Order Val
     C                   Z-ADD     *ZERO         WMHENZ                         L1307-Assigned
     C                   Z-ADD     *ZERO         WMTIQT                         L1309-Quantity
     C                   Z-ADD     *ZERO         WMQ2WG                         L1311-Gross Wgt
     C                   Z-ADD     *ZERO         WMBPAB                         X110-Lading Qua
     C                   Z-ADD     *ZERO         WMH1PR                         X114-Unit Price
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WRM8NB                         System Value Nu
     C                   Z-ADD     *ZERO         WRAATM                         Job Time
     C                   Z-ADD     *ZERO         WRAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WSTSCN                         ST02-TRANS SET
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WTAIC3                         Company Number
     C                   Z-ADD     *ZERO         WTC4NB                         Order Number
     C                   Z-ADD     *ZERO         WTABNX                         ED Can_Import C
     C                   Z-ADD     *ZERO         WTACNX                         ED Can_Import C
     C                   Z-ADD     *ZERO         WTADNX                         ED Seaboard Pla
     C                   Z-ADD     *ZERO         WTAHNX                         ED Plant Contac
     C                   Z-ADD     *ZERO         WTAINX                         ED Nbr of prods
     C                   Z-ADD     *ZERO         WTA7VL                         ED Total Unit P
     C                   Z-ADD     *ZERO         WTA8VL                         ED Invoice Tota
     C                   Z-ADD     *ZERO         WTHRWG                         ED Total Net We
     C                   Z-ADD     *ZERO         WTBIVL                         ED Total Net We
     C                   Z-ADD     *ZERO         WTK2QT                         ED Nbr of Packa
     C                   Z-ADD     *ZERO         WTHSWG                         ED Total Gross
     C                   Z-ADD     *ZERO         WTBJVL                         ED Total Gross
     C                   Z-ADD     *ZERO         WTMQDT                         ED Export Certi
     C                   Z-ADD     *ZERO         WTMRDT                         ED Sail Date
     C                   Z-ADD     *ZERO         WTMSDT                         ED Sworn on Dat
     C                   Z-ADD     *ZERO         WTAJNX                         ED Consignee Ad
     C                   Z-ADD     *ZERO         WTPADT                         ED Document Dat
     C                   Z-ADD     *ZERO         WTPBDT                         ED Packing Date
     C                   Z-ADD     *ZERO         WTPCDT                         ED Expiration D
     C                   Z-ADD     *ZERO         WTPDDT                         ED Packing Date
     C                   Z-ADD     *ZERO         WTPEDT                         ED Unused Date
     C                   Z-ADD     *ZERO         WTFFNZ                         EDOH Unused Num
     C                   Z-ADD     *ZERO         WTBUDX                         EDOH Unused Dat
     C                   Z-ADD     *ZERO         WTAATM                         Job Time
     C                   Z-ADD     *ZERO         WTAXDT                         Job Date
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        YRSW00                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        YRSW01                         *Synon (5,0) wo
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SHCHRC.
     C                   Z-ADD     *ZERO         WL0001
     C                   EVAL      WL0002 = ' '
      * Define local variables for subroutine SJRVGN.
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
      * Define local variables for subroutine SKRVGN.
     C                   Z-ADD     *ZERO         WL0005
     C                   Z-ADD     *ZERO         WL0006
     C                   Z-ADD     *ZERO         WL0007
     C                   Z-ADD     *ZERO         WL0008
     C                   EVAL      WL0009 = ' '
      * Define local variables for subroutine SLRVGN.
     C                   EVAL      WL0010 = ' '
     C                   EVAL      WL0011 = ' '
     C                   EVAL      WL0012 = ' '
     C                   EVAL      WL0013 = ' '
     C                   EVAL      WL0014 = ' '
     C                   EVAL      WL0015 = ' '
     C                   EVAL      WL0016 = ' '
      * Define local variables for subroutine SPRVGN.
     C                   Z-ADD     *ZERO         WL0017
     C                   Z-ADD     *ZERO         WL0018
     C                   EVAL      WL0019 = ' '
     C                   Z-ADD     *ZERO         WL0020
      * Define local variables for subroutine SURVGN.
     C                   EVAL      WL0021 = ' '
     C                   EVAL      WL0022 = ' '
      * Define local variables for subroutine SVCRRC.
     C                   Z-ADD     *ZERO         WL0023
     C                   EVAL      WL0024 = ' '
     C                   EVAL      WL0025 = ' '
     C                   EVAL      WL0026 = ' '
     C                   EVAL      WL0027 = ' '
     C                   EVAL      WL0028 = ' '
     C                   EVAL      WL0029 = ' '
     C                   EVAL      WL0030 = ' '
     C                   EVAL      WL0031 = ' '
     C                   EVAL      WL0032 = ' '
     C                   EVAL      WL0033 = ' '
     C                   EVAL      WL0034 = ' '
     C                   EVAL      WL0035 = ' '
     C                   EVAL      WL0036 = ' '
     C                   EVAL      WL0037 = ' '
     C                   EVAL      WL0038 = ' '
      * Define local variables for subroutine SWRVGN.
     C                   Z-ADD     *ZERO         WL0039
     C                   Z-ADD     *ZERO         WL0040
     C                   EVAL      WL0041 = ' '
     C                   EVAL      WL0042 = ' '
     C                   EVAL      WL0043 = ' '
     C                   EVAL      WL0044 = ' '
     C                   EVAL      WL0045 = ' '
     C                   EVAL      WL0046 = ' '
     C                   EVAL      WL0047 = ' '
     C                   EVAL      WL0048 = ' '
     C                   EVAL      WL0049 = ' '
      * Define local work field Create EDI 601 USR
     C                   EVAL      YL0001 = ' '
      * Define local work field OHE Booking Number
     C                   EVAL      YL0002 = ' '
      * Define local work field L1306-Order Value Total
     C                   Z-ADD     *ZERO         YL0003
      * Define local work field First Time Through USR
     C                   EVAL      YL0004 = ' '
      * Define local work field Shipping Line
     C                   EVAL      YL0005 = ' '
      * Define local work field Port Delv Terminal
     C                   EVAL      YL0006 = ' '
      * Define local work field OHE City
     C                   EVAL      YL0007 = ' '
      * Define local work field OHE Vessel_Airline
     C                   EVAL      YL0008 = ' '
      * Define local work field OHE Booking Number
     C                   EVAL      YL0009 = ' '
      * Define local work field OHE Discharge Port_Airprt
     C                   EVAL      YL0010 = ' '
      * Define local work field OHE Sail_Flight Date
     C                   Z-ADD     *ZERO         YL0011
      * Define local work field OHE Override Type Code
     C                   EVAL      YL0012 = ' '
      * Define local work field OHE EDI 824 Action
     C                   EVAL      YL0013 = ' '
      * Define local work field OHE EDI 824 AES ITN #
     C                   EVAL      YL0014 = ' '
      * Define null work field CBP Export Port Code
     C                   Z-ADD     *ZERO         YN0001
      * Define local work field CBP Std Carrier Alpha Cde
     C                   EVAL      YL0015 = ' '
      * Define local work field Create EDI 601 USR
     C                   EVAL      YL0016 = ' '
      * Define local work field Upd OHE EDI 601 Action U
     C                   EVAL      YL0017 = ' '
      * Define local work field OHE EDI 824 Action
     C                   EVAL      YL0018 = ' '
      * Define local work field OHE EDI 601 Action
     C                   EVAL      YL0019 = ' '
      * Define local work field OHE EDI 824 AES ITN #
     C                   EVAL      YL0020 = ' '
      * Define local work field EDI-Record Processed
     C                   EVAL      YL0021 = ' '
      * Define local work field BA102-Action Code
     C                   EVAL      YL0022 = ' '
      * Define local work field First Time Through USR
     C                   EVAL      YL0023 = ' '
      * Define local work field OHE Booking Number
     C                   EVAL      YL0024 = ' '
      * Define local work field ST02-TRANS SET CONTROL NU
     C                   Z-ADD     *ZERO         YL0025
      * Define local work field ISO Alpha2 Code
     C                   EVAL      YL0026 = ' '
      * Define local work field Warehouse Code
     C                   EVAL      YL0027 = ' '
      * Define local work field Ship From Warehouse
     C                   EVAL      YL0028 = ' '
      * Define local work field N301-Address Line 1
     C                   EVAL      YL0029 = ' '
      * Define local work field N302-Address Line 2
     C                   EVAL      YL0030 = ' '
      * Define local work field N401-CITY
     C                   EVAL      YL0031 = ' '
      * Define local work field N403-POSTAL CODE
     C                   EVAL      YL0032 = ' '
      * Define local work field State Code
     C                   EVAL      YL0033 = ' '
      * Define local work field Warehouse Type
     C                   EVAL      YL0034 = ' '
      * Define null work field City
     C                   EVAL      YN0002 = ' '
      * Define local work field Federal Tax Id
     C                   EVAL      YL0035 = ' '
      * Define null work field State Code
     C                   EVAL      YN0003 = ' '
      * Define local work field Numeric 4,0           USR
     C                   Z-ADD     *ZERO         YL0036
      * Define local work field Text USR 4
     C                   EVAL      YL0037 = ' '
      * Define local work field PS03-Port of Export
     C                   EVAL      YL0038 = ' '
      * Define local work field DTM02-Sail Date
     C                   Z-ADD     *ZERO         YL0039
      * Define local work field Text USR 5
     C                   EVAL      YL0040 = ' '
      * Define local work field P503-Port of Unlading
     C                   EVAL      YL0041 = ' '
      * Define local work field Create Date D8#
     C                   Z-ADD     *ZERO         YL0042
      * Define local work field USR Gross Wgt LBS Total
     C                   Z-ADD     *ZERO         YL0043
      * Define local work field USR Quantity Total
     C                   Z-ADD     *ZERO         YL0044
      * Define local work field Company w/Most Qty Wgt U
     C                   Z-ADD     *ZERO         YL0045
      * Define local work field Order Number Saved USR
     C                   Z-ADD     *ZERO         YL0046
      * Define local work field L1304-Net Wgt Ship Total
     C                   Z-ADD     *ZERO         YL0047
      * Define local work field USR Quantity, 9.0
     C                   Z-ADD     *ZERO         YL0048
      * Define local work field USR Weight Accumulated
     C                   Z-ADD     *ZERO         YL0049
      * Define local work field First Time Through USR
     C                   EVAL      YL0050 = ' '
      * Define local work field Company count
     C                   Z-ADD     *ZERO         YL0051
      * Define local work field Total Weight Ship Save U
     C                   Z-ADD     *ZERO         YL0052
      * Define local work field Company Number
     C                   Z-ADD     *ZERO         YL0053
      * Define local work field Order Number Saved USR
     C                   Z-ADD     *ZERO         YL0054
      * Define local work field Total Weight Ship    USR
     C                   Z-ADD     *ZERO         YL0055
      * Define local work field L1304-Qty Shipped Total
     C                   Z-ADD     *ZERO         YL0056
      * Define local work field Net Weight Total 11.1 U
     C                   Z-ADD     *ZERO         YL0057
      * Define local work field USR Net Wgt LBS Tot 11.0
     C                   Z-ADD     *ZERO         YL0058
      * Define local work field Gross Weight Total 11.1 U
     C                   Z-ADD     *ZERO         YL0059
      * Define local work field USR Gross Wgt LBS Tot11.0
     C                   Z-ADD     *ZERO         YL0060
      * Define local work field L1311-Gross Wgt Ship Tot
     C                   Z-ADD     *ZERO         YL0061
      * Define local work field L1302-Commodity Code
     C                   EVAL      YL0062 = ' '
      * Define local work field L1312-Chilled/Frozen Text
     C                   EVAL      YL0063 = ' '
      * Define local work field Name
     C                   EVAL      YL0064 = ' '
      * Define null work field Address Line 1
     C                   EVAL      YN0004 = ' '
      * Define null work field Address Line 2
     C                   EVAL      YN0005 = ' '
      * Define null work field Address Line 3
     C                   EVAL      YN0006 = ' '
      * Define null work field Zip Postal Code
     C                   EVAL      YN0007 = ' '
      * Define null work field Telephone Number FF
     C                   EVAL      YN0008 = ' '
      * Define null work field Fax Number FF
     C                   EVAL      YN0009 = ' '
      * Define null work field Federal Tax Id
     C                   EVAL      YN0010 = ' '
      * Define null work field Alpha Search
     C                   EVAL      YN0011 = ' '
      * Define local work field Country Code
     C                   EVAL      YL0065 = ' '
      * Define null work field EDI Status 1
     C                   EVAL      YN0012 = ' '
      * Define null work field EDI Status 2
     C                   EVAL      YN0013 = ' '
      * Define null work field EDI Status 3
     C                   EVAL      YN0014 = ' '
      * Define null work field Record Status
     C                   EVAL      YN0015 = ' '
      * Define local work field N202-Contact Phone Nbr
     C                   EVAL      YL0066 = ' '
      * Define local work field N201-NAME
     C                   EVAL      YL0067 = ' '
      * Define local work field Starting Position USR
     C                   Z-ADD     *ZERO         YL0068
      * Define local work field First Name End Pos USR
     C                   Z-ADD     *ZERO         YL0069
      * Define local work field N201-FIRSTNAME
     C                   EVAL      YL0070 = ' '
      * Define local work field Last Name Beg Pos USR
     C                   Z-ADD     *ZERO         YL0071
      * Define local work field N201-LASTNAME
     C                   EVAL      YL0072 = ' '
      * Define local work field Zip Code End Pos USR
     C                   Z-ADD     *ZERO         YL0073
      * Define local work field Zip Code 5A USR
     C                   EVAL      YL0074 = ' '
      * Define local work field Zip +4 Code Beg Pos USR
     C                   Z-ADD     *ZERO         YL0075
      * Define local work field Zip +4 Code 4A USR
     C                   EVAL      YL0076 = ' '
      * Define local work field ED Consignee Name
     C                   EVAL      YL0077 = ' '
      * Define local work field ED Consignee Addr 1
     C                   EVAL      YL0078 = ' '
      * Define local work field ED Consignee Addr 2
     C                   EVAL      YL0079 = ' '
      * Define local work field ED Consignee Addr 3
     C                   EVAL      YL0080 = ' '
      * Define local work field ED Consignee Addr 4
     C                   EVAL      YL0081 = ' '
      * Define null work field ED Consignee State
     C                   EVAL      YN0016 = ' '
      * Define null work field ED Consignee Postal
     C                   EVAL      YN0017 = ' '
      * Define null work field ED Consignee Country Code
     C                   EVAL      YN0018 = ' '
      * Define local work field N402-STATE
     C                   EVAL      YL0082 = ' '
      * Define local work field Characters to Replace
     C                   EVAL      YL0083 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 999999999999999
00002 0203194000
00003 Chilled Pork
00004 0203294000
00005 Frozen Pork
00006 EDI601EXSH
00007 EDI601N201
00008 90027928300
00009 ADRVALCHAR
00010 SCNCHARVAL
00011 RPLCHARVAL
