     H/TITLE Chg Order Header&DlvPO XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 07/31/19  Time  : 14:36:27
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFLCPL8IF  E           K        DISK
      * RSQ : Load Detail               Co/Order
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WCAIC3
     I              EOBKC7                          WCBKC7
     I              EOAQCD                          WCAQCD
     I              EOR4CD                          WCR4CD
     I              EOBYNA                          WCBYNA
     I              EOB6NA                          WCB6NA
     I              EOBZNA                          WCBZNA
     I              EOLLST                          WCLLST
     I              EOPPST                          WCPPST
     I              EOR5NB                          WCR5NB
     I              EOR6NB                          WCR6NB
     I              EOQGST                          WCQGST
     I              EOBOCD                          WCBOCD
     I              EOTBNB                          WCTBNB
     I              EOMTCU                          WCMTCU
     I              EOW2NB                          WCW2NB
     I              EORPCD                          WCRPCD
     I              EOAJCD                          WCAJCD
     I              EOX9ST                          WCX9ST
     I              EOT9CD                          WCT9CD
     I              EOUBCD                          WCUBCD
     I              EOISTX                          WCISTX
     I              EOLQCD                          WCLQCD
     I              EONJNA                          WCNJNA
     I              EOI0TX                          WCI0TX
     I              EONKNA                          WCNKNA
     I              EOI1TX                          WCI1TX
     I              EOVLST                          WCVLST
     I              EORLST                          WCRLST
     I              EOMMTX                          WCMMTX
     I              EOOHNA                          WCOHNA
     I              EOQ6ST                          WCQ6ST
     I              EOQ8ST                          WCQ8ST
     I              EORBST                          WCRBST
     I              EOREST                          WCREST
     I              EOUVST                          WCUVST
     I              EOUWST                          WCUWST
     I              EOUXST                          WCUXST
     I              EOVSST                          WCVSST
     I              EOAATM                          WCAATM
     I              EOAYNA                          WCAYNA
     I              EOA0NA                          WCA0NA
     I              EOAXDT                          WCAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WFAIC3
     I              AMC4NB                          WFC4NB
     I              AMRMNB                          WFRMNB
     I              AMRUNB                          WFRUNB
     I              AMXACD                          WFXACD
     I              AMOANA                          WFOANA
     I              AMHBAA                          WFHBAA
     I              AMJ0T1                          WFJ0T1
     I              AMGENY                          WFGENY
     I              AMJ1T1                          WFJ1T1
     I              AMHCAA                          WFHCAA
     I              AMQWDT                          WFQWDT
     I              AMQXDT                          WFQXDT
     I              AMQYDT                          WFQYDT
     I              AMHDAA                          WFHDAA
     I              AMCCTX                          WFCCTX
     I              AMJ2T1                          WFJ2T1
     I              AMRLNA                          WFRLNA
     I              AMRMNA                          WFRMNA
     I              AMGINY                          WFGINY
     I              AMGFNY                          WFGFNY
     I              AMGGNY                          WFGGNY
     I              AMGHNY                          WFGHNY
     I              AMHEVL                          WFHEVL
     I              AMHFVL                          WFHFVL
     I              AMHGVL                          WFHGVL
     I              AMQZDT                          WFQZDT
     I              AMQ0DT                          WFQ0DT
     I              AMQ1DT                          WFQ1DT
     I              AMQ2DT                          WFQ2DT
     I              AMC2TX                          WFC2TX
     I              AMC3TX                          WFC3TX
     I              AMC6TX                          WFC6TX
     I              AMCHTX                          WFCHTX
     I              AMCITX                          WFCITX
     I              AMCLTX                          WFCLTX
     I              AMB4TX                          WFB4TX
     I              AMCUTX                          WFCUTX
     I              AMCVTX                          WFCVTX
     I              AMB9TX                          WFB9TX
     I              AMJWSC                          WFJWSC
     I              AMITNY                          WFITNY
     I              AMLMT1                          WFLMT1
     I              AMLWAA                          WFLWAA
     I              AMFVST                          WFFVST
     I              AMF0ST                          WFF0ST
     I              AMF2ST                          WFF2ST
     I              AMF3ST                          WFF3ST
     I              AMJUSC                          WFJUSC
     I              AMJVSC                          WFJVSC
     I              AMV3T1                          WFV3T1
     I              AMV4T1                          WFV4T1
     I              AMV5T1                          WFV5T1
     I              AMV6T1                          WFV6T1
     I              AMV7T1                          WFV7T1
     I              AMV8T1                          WFV8T1
     I              AMV9T1                          WFV9T1
     I              AMWAT1                          WFWAT1
     I              AMWBT1                          WFWBT1
     I              AMWCT1                          WFWCT1
     I              AMWDT1                          WFWDT1
     I              AMQJNY                          WFQJNY
     I              AMQKNY                          WFQKNY
     I              AMQLNY                          WFQLNY
     I              AMP8NY                          WFP8NY
     I              AMP9NY                          WFP9NY
     I              AMQANY                          WFQANY
     I              AMQCNY                          WFQCNY
     I              AMQDNY                          WFQDNY
     I              AMQENY                          WFQENY
     I              AMQFNY                          WFQFNY
     I              AMQGNY                          WFQGNY
     I              AMQHNY                          WFQHNY
     I              AMQINY                          WFQINY
     I              AMQMNY                          WFQMNY
     I              AMMYU1                          WFMYU1
     I              AMJXSC                          WFJXSC
     I              AMJYSC                          WFJYSC
     I              AMJZSC                          WFJZSC
     I              AMJ0SC                          WFJ0SC
     I              AMMZU1                          WFMZU1
     I              AMM0U1                          WFM0U1
     I              AMM1U1                          WFM1U1
     I              AMM2U1                          WFM2U1
     I              AMM3U1                          WFM3U1
     I              AMW5DT                          WFW5DT
     I              AMW6DT                          WFW6DT
     I              AMUVST                          WFUVST
     I              AMUWST                          WFUWST
     I              AMUXST                          WFUXST
     I              AMVSST                          WFVSST
     I              AMAATM                          WFAATM
     I              AMAYNA                          WFAYNA
     I              AMA0NA                          WFA0NA
     I              AMAXDT                          WFAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WGAIC3
     I              AMC4NB                          WGC4NB
     I              AMRMNB                          WGRMNB
     I              AMRUNB                          WGRUNB
     I              AMXACD                          WGXACD
     I              AMOANA                          WGOANA
     I              AMHBAA                          WGHBAA
     I              AMJ0T1                          WGJ0T1
     I              AMGENY                          WGGENY
     I              AMJ1T1                          WGJ1T1
     I              AMHCAA                          WGHCAA
     I              AMQWDT                          WGQWDT
     I              AMQXDT                          WGQXDT
     I              AMQYDT                          WGQYDT
     I              AMHDAA                          WGHDAA
     I              AMCCTX                          WGCCTX
     I              AMJ2T1                          WGJ2T1
     I              AMRLNA                          WGRLNA
     I              AMRMNA                          WGRMNA
     I              AMGINY                          WGGINY
     I              AMGFNY                          WGGFNY
     I              AMGGNY                          WGGGNY
     I              AMGHNY                          WGGHNY
     I              AMHEVL                          WGHEVL
     I              AMHFVL                          WGHFVL
     I              AMHGVL                          WGHGVL
     I              AMQZDT                          WGQZDT
     I              AMQ0DT                          WGQ0DT
     I              AMQ1DT                          WGQ1DT
     I              AMQ2DT                          WGQ2DT
     I              AMC2TX                          WGC2TX
     I              AMC3TX                          WGC3TX
     I              AMC6TX                          WGC6TX
     I              AMCHTX                          WGCHTX
     I              AMCITX                          WGCITX
     I              AMCLTX                          WGCLTX
     I              AMB4TX                          WGB4TX
     I              AMCUTX                          WGCUTX
     I              AMCVTX                          WGCVTX
     I              AMB9TX                          WGB9TX
     I              AMJWSC                          WGJWSC
     I              AMITNY                          WGITNY
     I              AMLMT1                          WGLMT1
     I              AMLWAA                          WGLWAA
     I              AMFVST                          WGFVST
     I              AMF0ST                          WGF0ST
     I              AMF2ST                          WGF2ST
     I              AMF3ST                          WGF3ST
     I              AMJUSC                          WGJUSC
     I              AMJVSC                          WGJVSC
     I              AMV3T1                          WGV3T1
     I              AMV4T1                          WGV4T1
     I              AMV5T1                          WGV5T1
     I              AMV6T1                          WGV6T1
     I              AMV7T1                          WGV7T1
     I              AMV8T1                          WGV8T1
     I              AMV9T1                          WGV9T1
     I              AMWAT1                          WGWAT1
     I              AMWBT1                          WGWBT1
     I              AMWCT1                          WGWCT1
     I              AMWDT1                          WGWDT1
     I              AMQJNY                          WGQJNY
     I              AMQKNY                          WGQKNY
     I              AMQLNY                          WGQLNY
     I              AMP8NY                          WGP8NY
     I              AMP9NY                          WGP9NY
     I              AMQANY                          WGQANY
     I              AMQCNY                          WGQCNY
     I              AMQDNY                          WGQDNY
     I              AMQENY                          WGQENY
     I              AMQFNY                          WGQFNY
     I              AMQGNY                          WGQGNY
     I              AMQHNY                          WGQHNY
     I              AMQINY                          WGQINY
     I              AMQMNY                          WGQMNY
     I              AMMYU1                          WGMYU1
     I              AMJXSC                          WGJXSC
     I              AMJYSC                          WGJYSC
     I              AMJZSC                          WGJZSC
     I              AMJ0SC                          WGJ0SC
     I              AMMZU1                          WGMZU1
     I              AMM0U1                          WGM0U1
     I              AMM1U1                          WGM1U1
     I              AMM2U1                          WGM2U1
     I              AMM3U1                          WGM3U1
     I              AMW5DT                          WGW5DT
     I              AMW6DT                          WGW6DT
     I              AMUVST                          WGUVST
     I              AMUWST                          WGUWST
     I              AMUXST                          WGUXST
     I              AMVSST                          WGVSST
     I              AMAATM                          WGAATM
     I              AMAYNA                          WGAYNA
     I              AMA0NA                          WGA0NA
     I              AMAXDT                          WGAXDT
      *
     I@FLCPW9
      * Load Detail               Co/Order
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WIRMNB
     I              FLRUNB                          WIRUNB
     I              FLRVNB                          WIRVNB
     I              FLDQTX                          WIDQTX
     I              FLRWNB                          WIRWNB
     I              FLRXNB                          WIRXNB
     I              FLSQNB                          WISQNB
     I              FLT0NB                          WIT0NB
     I              FLT1NB                          WIT1NB
     I              FLR1NB                          WIR1NB
     I              FLAIC3                          WIAIC3
     I              FLC4NB                          WIC4NB
     I              FLVCST                          WIVCST
     I              FLKEDT                          WIKEDT
     I              FLSXNB                          WISXNB
     I              FLKFDT                          WIKFDT
     I              FLACTM                          WIACTM
     I              FLK5TX                          WIK5TX
     I              FLW5CD                          WIW5CD
     I              FLEJDT                          WIEJDT
     I              FLAGTM                          WIAGTM
     I              FLKJDT                          WIKJDT
     I              FLATTM                          WIATTM
     I              FLHDDT                          WIHDDT
     I              FLAUTM                          WIAUTM
     I              FLKKDT                          WIKKDT
     I              FLAVTM                          WIAVTM
     I              FLZ4NB                          WIZ4NB
     I              FLY7ST                          WIY7ST
     I              FLY2ST                          WIY2ST
     I              FLWHTX                          WIWHTX
     I              FLWITX                          WIWITX
     I              FLWJTX                          WIWJTX
     I              FLWKTX                          WIWKTX
     I              FLWLTX                          WIWLTX
     I              FLN7DT                          WIN7DT
     I              FLN8DT                          WIN8DT
     I              FLN9DT                          WIN9DT
     I              FLB3TM                          WIB3TM
     I              FLB4TM                          WIB4TM
     I              FLB5TM                          WIB5TM
     I              FLIASX                          WIIASX
     I              FLIBSX                          WIIBSX
     I              FLICSX                          WIICSX
     I              FLWVTX                          WIWVTX
     I              FLWWTX                          WIWWTX
     I              FLWXTX                          WIWXTX
     I              FLUVST                          WIUVST
     I              FLUWST                          WIUWST
     I              FLUXST                          WIUXST
     I              FLAATM                          WIAATM
     I              FLAYNA                          WIAYNA
     I              FLA0NA                          WIA0NA
     I              FLAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     IYBRDCS      DS                            793
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WGAIC3
     I              AMC4NB                          WGC4NB
     I              AMRMNB                          WGRMNB
     I              AMRUNB                          WGRUNB
     I              AMXACD                          WGXACD
     I              AMOANA                          WGOANA
     I              AMHBAA                          WGHBAA
     I              AMJ0T1                          WGJ0T1
     I              AMGENY                          WGGENY
     I              AMJ1T1                          WGJ1T1
     I              AMHCAA                          WGHCAA
     I              AMQWDT                          WGQWDT
     I              AMQXDT                          WGQXDT
     I              AMQYDT                          WGQYDT
     I              AMHDAA                          WGHDAA
     I              AMCCTX                          WGCCTX
     I              AMJ2T1                          WGJ2T1
     I              AMRLNA                          WGRLNA
     I              AMRMNA                          WGRMNA
     I              AMGINY                          WGGINY
     I              AMGFNY                          WGGFNY
     I              AMGGNY                          WGGGNY
     I              AMGHNY                          WGGHNY
     I              AMHEVL                          WGHEVL
     I              AMHFVL                          WGHFVL
     I              AMHGVL                          WGHGVL
     I              AMQZDT                          WGQZDT
     I              AMQ0DT                          WGQ0DT
     I              AMQ1DT                          WGQ1DT
     I              AMQ2DT                          WGQ2DT
     I              AMC2TX                          WGC2TX
     I              AMC3TX                          WGC3TX
     I              AMC6TX                          WGC6TX
     I              AMCHTX                          WGCHTX
     I              AMCITX                          WGCITX
     I              AMCLTX                          WGCLTX
     I              AMB4TX                          WGB4TX
     I              AMCUTX                          WGCUTX
     I              AMCVTX                          WGCVTX
     I              AMB9TX                          WGB9TX
     I              AMJWSC                          WGJWSC
     I              AMITNY                          WGITNY
     I              AMLMT1                          WGLMT1
     I              AMLWAA                          WGLWAA
     I              AMFVST                          WGFVST
     I              AMF0ST                          WGF0ST
     I              AMF2ST                          WGF2ST
     I              AMF3ST                          WGF3ST
     I              AMJUSC                          WGJUSC
     I              AMJVSC                          WGJVSC
     I              AMV3T1                          WGV3T1
     I              AMV4T1                          WGV4T1
     I              AMV5T1                          WGV5T1
     I              AMV6T1                          WGV6T1
     I              AMV7T1                          WGV7T1
     I              AMV8T1                          WGV8T1
     I              AMV9T1                          WGV9T1
     I              AMWAT1                          WGWAT1
     I              AMWBT1                          WGWBT1
     I              AMWCT1                          WGWCT1
     I              AMWDT1                          WGWDT1
     I              AMQJNY                          WGQJNY
     I              AMQKNY                          WGQKNY
     I              AMQLNY                          WGQLNY
     I              AMP8NY                          WGP8NY
     I              AMP9NY                          WGP9NY
     I              AMQANY                          WGQANY
     I              AMQCNY                          WGQCNY
     I              AMQDNY                          WGQDNY
     I              AMQENY                          WGQENY
     I              AMQFNY                          WGQFNY
     I              AMQGNY                          WGQGNY
     I              AMQHNY                          WGQHNY
     I              AMQINY                          WGQINY
     I              AMQMNY                          WGQMNY
     I              AMMYU1                          WGMYU1
     I              AMJXSC                          WGJXSC
     I              AMJYSC                          WGJYSC
     I              AMJZSC                          WGJZSC
     I              AMJ0SC                          WGJ0SC
     I              AMMZU1                          WGMZU1
     I              AMM0U1                          WGM0U1
     I              AMM1U1                          WGM1U1
     I              AMM2U1                          WGM2U1
     I              AMM3U1                          WGM3U1
     I              AMW5DT                          WGW5DT
     I              AMW6DT                          WGW6DT
     I              AMUVST                          WGUVST
     I              AMUWST                          WGUWST
     I              AMUXST                          WGUXST
     I              AMVSST                          WGVSST
     I              AMAATM                          WGAATM
     I              AMAYNA                          WGAYNA
     I              AMA0NA                          WGA0NA
     I              AMAXDT                          WGAXDT
      *
     IYCRDCS      DS                            894
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WIRMNB
     I              FLRUNB                          WIRUNB
     I              FLRVNB                          WIRVNB
     I              FLDQTX                          WIDQTX
     I              FLRWNB                          WIRWNB
     I              FLRXNB                          WIRXNB
     I              FLSQNB                          WISQNB
     I              FLT0NB                          WIT0NB
     I              FLT1NB                          WIT1NB
     I              FLR1NB                          WIR1NB
     I              FLAIC3                          WIAIC3
     I              FLC4NB                          WIC4NB
     I              FLVCST                          WIVCST
     I              FLKEDT                          WIKEDT
     I              FLSXNB                          WISXNB
     I              FLKFDT                          WIKFDT
     I              FLACTM                          WIACTM
     I              FLK5TX                          WIK5TX
     I              FLW5CD                          WIW5CD
     I              FLEJDT                          WIEJDT
     I              FLAGTM                          WIAGTM
     I              FLKJDT                          WIKJDT
     I              FLATTM                          WIATTM
     I              FLHDDT                          WIHDDT
     I              FLAUTM                          WIAUTM
     I              FLKKDT                          WIKKDT
     I              FLAVTM                          WIAVTM
     I              FLZ4NB                          WIZ4NB
     I              FLY7ST                          WIY7ST
     I              FLY2ST                          WIY2ST
     I              FLWHTX                          WIWHTX
     I              FLWITX                          WIWITX
     I              FLWJTX                          WIWJTX
     I              FLWKTX                          WIWKTX
     I              FLWLTX                          WIWLTX
     I              FLN7DT                          WIN7DT
     I              FLN8DT                          WIN8DT
     I              FLN9DT                          WIN9DT
     I              FLB3TM                          WIB3TM
     I              FLB4TM                          WIB4TM
     I              FLB5TM                          WIB5TM
     I              FLIASX                          WIIASX
     I              FLIBSX                          WIIBSX
     I              FLICSX                          WIICSX
     I              FLWVTX                          WIWVTX
     I              FLWWTX                          WIWWTX
     I              FLWXTX                          WIWXTX
     I              FLUVST                          WIUVST
     I              FLUWST                          WIUWST
     I              FLUXST                          WIUXST
     I              FLAATM                          WIAATM
     I              FLAYNA                          WIAYNA
     I              FLA0NA                          WIA0NA
     I              FLAXDT                          WIAXDT
      *
     IYDRDCS      DS                            367
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Type - Sales
     I                                        7   8 P1JNCD
      * I :  A/R Customer Number
     I                                    P   9  120P1ANC7
      * I :  Ship To Customer
     I                                    P  13  160P1BKC7
      * I :  Parent Customer
     I                                    P  17  200P1BTC7
      * I :  Ship To Name
     I                                       21  50 P1BRTX
      * I :  Ship To Address Line 1
     I                                       51  80 P1HMNA
      * I :  Ship To Address Line 2
     I                                       81 110 P1HONA
      * I :  Ship To Address Line 3
     I                                      111 140 P1HPNA
      * I :  Ship To City
     I                                      141 160 P1HNNA
      * I :  Ship To State Code
     I                                      161 162 P1DBCD
      * I :  Ship To Zip/Postal Code
     I                                      163 173 P1CKTX
      * I :  Bill to Customer
     I                                    P 174 1770P1B0C7
      * I :  Bill to Name
     I                                      178 207 P1AETX
      * I :  Bill to Address Line 1
     I                                      208 237 P1B1NA
      * I :  Bill to Address Line 2
     I                                      238 267 P1B3NA
      * I :  Bill to Address Line 3
     I                                      268 297 P1B4NA
      * I :  Bill to City
     I                                      298 317 P1B2NA
      * I :  Bill to State Code
     I                                      318 319 P1BHCD
      * I :  Bill to Zip/Postal Code
     I                                      320 330 P1C8TX
      * I :  Customer Purchase Order #
     I                                      331 345 P1BCNA
      * I :  Order Date
     I                                    P 346 3490P1A0DT
      * I :  Requested Ship Date
     I                                    P 350 3530P1A5DT
      * I :  Actual Shipped Date
     I                                    P 354 3570P1GNDT
      * I :  Cancel Date
     I                                    P 358 3610P1ACDT
      * I :  Terms Code
     I                                      362 363 P1AQCD
      * I :  Special Instructions
     I                                      364 403 P1B6NA
      * I :  Special Instructions 2
     I                                      404 443 P1BYNA
      * I :  Carrier Code
     I                                      444 446 P1BZNA
      * I :  Comment Print Acknowledge
     I                                      447 447 P1GTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      448 448 P1GVST
      * I :  Comment Print Pick Slip
     I                                      449 449 P1GUST
      * I :  Comment Print Ship Doc
     I                                      450 450 P1QFST
      * I :  Reason Code
     I                                      451 453 P1CQCD
      * I :  Order in Use
     I                                      454 454 P1GJST
      * I :  Header Status
     I                                      455 455 P1GWST
      * I :  Header Status Last
     I                                      456 456 P1GXST
      * I :  Order Type Print Status
     I                                      457 457 P1GYST
      * I :  Scheduled Ship Date
     I                                    P 458 4610P1AODT
      * I :  User Original Entry
     I                                      462 471 P1AIVN
      * I :  Date of Original Entry
     I                                    P 472 4750P1CXDT
      * I :  Order Value Total
     I                                    P 476 4812P1JZVA
      * I :  Order Weight Total
     I                                    P 482 4872P1A1WG
      * I :  Credit Hold
     I                                      488 488 P1XIST
      * I :  Production Hold
     I                                      489 489 P1XJST
      * I :  New Customer Hold
     I                                      490 490 P1XKST
      * I :  Requested Delivery Date
     I                                    P 491 4940P1EIDT
      * I :  Requested Delivery Time
     I                                    P 495 4970P1AFTM
      * I :  Accounts Receiv. Ent 1
     I                                      498 501 P1E8CD
      * I :  Accounts Receiv. Ent 2
     I                                      502 513 P1E9CD
      * I :  Load ID
     I                                    P 514 5170P1RMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 518 5202P1TBNB
      * I :  Rated Freight
     I                                    P 521 5262P1R1NB
      * I :  LTL Flag
     I                                      527 527 P1PJST
      * I :  Price Audit
     I                                      528 528 P1U0ST
      * I :  Price Status
     I                                      529 529 P1U1ST
      * I :  Shipping Method
     I                                      530 531 P1Q2CD
      * I :  Export Status
     I                                      532 532 P1U2ST
      * I :  Palletize
     I                                      533 533 P1VEST
      * I :  Shrink Wrap
     I                                      534 534 P1VFST
      * I :  Slip Sheet
     I                                      535 535 P1VGST
      * I :  Age Code
     I                                      536 536 P1RPCD
      * I :  Reefer Temperature
     I                                    P 537 5392P1RNNB
      * I :  Load Type
     I                                      540 540 P1VDST
      * I :  Attach to Invoice Number
     I                                    P 541 5440P1ATIN
      * I :  Load Plan Order
     I                                      545 545 P1U4ST
      * I :  Print Pick Slip
     I                                      546 546 P1U5ST
      * I :  Resell Reference Number
     I                                    P 547 5500P1RSRN
      * I :  Special Comment 1
     I                                      551 580 P1MHNA
      * I :  Special Comment 2
     I                                      581 610 P1MINA
      * I :  Affect Auto Accruals
     I                                      611 611 P1WBST
      * I :  Sales Route Code
     I                                      612 614 P1R4CD
      * I :  Manager Level Code
     I                                      615 616 P1BFCD
      * I :  VP Level Code
     I                                      617 619 P1Q4CD
      * I :  Attach to Order Number
     I                                    P 620 6230P1T3NB
      * I :  Reason for Price Audit
     I                                      624 626 P1SICD
      * I :  Invoice Number
     I                                    P 627 6300P1CONB
      * I :  Invoice Suffix
     I                                      631 632 P1CEST
      * I :  Invoice Date
     I                                    P 633 6360P1AWDT
      * I :  Event Code
     I                                      637 638 P1JPCD
      * I :  Trans Contol AS400/Plant
     I                                      639 639 P1XUST
      * I :  Modified Flag
     I                                      640 640 P1Z1ST
      * I :  A/R order Value Total
     I                                    P 641 6462P1VRVA
      * I :  Billing Activity Type
     I                                      647 647 P1OBST
      * I :  Block Order Flag
     I                                      648 648 P1BCST
      * I :  Order Certification Flag
     I                                      649 649 P1BDST
      * I :  Invoice Order Value Tot
     I                                    P 650 6552P1B7VL
      * I :  Process Sts for 3C
     I                                      656 656 P1GASX
      * I :  Order Conf Fax Sts
     I                                      657 657 P1GBSX
      * I :  Manifest Fax Sts
     I                                      658 658 P1GCSX
      * I :  Invoice Fax Sts
     I                                      659 659 P1GDSX
      * I :  Transfer in Storage Ind
     I                                      660 660 P1FNSX
      * I :  Email Cust On Order Ship
     I                                      661 661 P1FOSX
      * I :  Order Emailed
     I                                      662 662 P1FPSX
      * I :  Export Docs Go w/Driver
     I                                      663 663 P1FQSX
      * I :  Shipping Temp Code C/F
     I                                      664 664 P1FRSX
      * I :  Broker Order Status
     I                                      665 665 P1FSSX
      * I :  Air Freight Order
     I                                      666 666 P1FTSX
      * I :  Order Requires Review
     I                                      667 668 P1FUSX
      * I :  OH Load Plan Ready
     I                                      669 670 P1FVSX
      * I :  Export USDA Approved
     I                                      671 672 P1FWSX
      * I :  HPB Ship to Warehouse
     I                                      673 675 P1FXSX
      * I :  OH TF Exempt Code
     I                                      676 678 P1FYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 679 6820P1NODT
      * I :  JPN Invoice Issuance Date
     I                                    P 683 6860P1NPDT
      * I :  Load Actual Shipped Date
     I                                    P 687 6900P1NQDT
      * I :  Load BOL Complete Date
     I                                    P 691 6940P1NRDT
      * I :  Load Truck Departure Date
     I                                    P 695 6980P1NSDT
      * I :  Maximum Gross Weight
     I                                    P 699 7020P1BPTM
      * I :  Time of Original Entry
     I                                    P 703 7060P1BQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 707 7100P1BRTM
      * I :  Load BOL Complete Time
     I                                    P 711 7140P1BSTM
      * I :  Load Truck Departure Time
     I                                    P 715 7180P1BTTM
      * I :  Act Frt Reference Amount
     I                                    P 719 7242P1H0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 725 7302P1H1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 731 7362P1H2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 737 7422P1H3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 743 7482P1H4NX
      * I :  Claim Number
     I                                    P 749 7520P1C0C7
      * I :  EDI Status 1
     I                                      753 753 P1UVST
      * I :  EDI Status 2
     I                                      754 754 P1UWST
      * I :  EDI Status 3
     I                                      755 755 P1UXST
      * N :  Job Time
     I                                    P 756 7590P1AATM
      * N :  User Id
     I                                      760 769 P1AYNA
      * N :  Job Name
     I                                      770 779 P1A0NA
      * N :  Job Date
     I                                    P 780 7830P1AXDT
     IP2PARM      DS
      * FLD: Order Header Extension
      * N :  Stop/Drop Sequence Number
     I                                    P   1   30P2RUNB
      * N :  Shipping Line
     I                                        4   6 P2XACD
      * N :  Port Delv Terminal
     I                                        7  26 P2OANA
      * N :  OHE City
     I                                       27  51 P2HBAA
      * N :  OHE Vessel/Airline
     I                                       52  81 P2J0T1
      * N :  OHE Voyage/Flight
     I                                       82  96 P2GENY
      * N :  OHE Booking Number
     I                                       97 111 P2J1T1
      * N :  OHE Discharge Port/Airprt
     I                                      112 131 P2HCAA
      * N :  OHE Sail/Flight Date
     I                                    P 132 1350P2QWDT
      * N :  OHE Port Cut Date
     I                                    P 136 1390P2QXDT
      * N :  OHE Arrival Date
     I                                    P 140 1430P2QYDT
      * N :  OHE Late Delivery Code
     I                                      144 146 P2HDAA
      * N :  OHE Ship Status
     I                                      147 147 P2CCTX
      * N :  OHE Container Number
     I                                      148 159 P2J2T1
      * N :  OHE Comment 1
     I                                      160 194 P2RLNA
      * N :  OHE Comment 2
     I                                      195 269 P2RMNA
      * N :  OHE Unused Number 1-11.0
     I                                    P 270 2750P2GINY
      * N :  OHE Unused Number 2-11.0
     I                                    P 276 2810P2GFNY
      * N :  OHE Unused Number 3-11.0
     I                                    P 282 2870P2GGNY
      * N :  OHE Unused Number 4-11.0
     I                                    P 288 2930P2GHNY
      * I :  OHE HPB RIN Equiv Value
     I                                    P 294 2992P2HEVL
      * I :  OHE HPB RIN Price
     I                                    P 300 3052P2HFVL
      * N :  Transload Terminal Fees
     I                                    P 306 3112P2HGVL
      * N :  OHE Est Arrv at Dest Date
     I                                    P 312 3150P2QZDT
      * N :  OHE Backhaul ETA RtrnDate
     I                                    P 316 3190P2Q0DT
      * N :  OHE Port/Pier Paid Date
     I                                    P 320 3230P2Q1DT
      * N :  OHE Actual Ship Date
     I                                    P 324 3270P2Q2DT
      * N :  OHE Carrier SCAC Code
     I                                      328 331 P2C2TX
      * I :  OHE Spot Buy
     I                                      332 335 P2C3TX
      * N :  OHE PO ACK Flag
     I                                      336 339 P2C6TX
      * I :  OHE Override Type Code
     I                                      340 341 P2CHTX
      * N :  OHE Backhaul Status
     I                                      342 343 P2CITX
      * N :  OHE Backhaul ETA AM/PM
     I                                      344 345 P2CLTX
      * N :  OHE Load Haul Type
     I                                      346 348 P2B4TX
      * N :  OHE Backhaul Carrier Code
     I                                      349 351 P2CUTX
      * N :  OHE Bookings Confirmed
     I                                      352 354 P2CVTX
      * N :  OHE EDI Error Reasons
     I                                      355 359 P2B9TX
      * N :  HPB COA Batch Number
     I                                    P 360 3620P2ITNY
      * I :  Delivery P.O. Number
     I                                      363 400 P2LMT1
      * I :  OHE Intended for ExportCC
     I                                      401 406 P2LWAA
      * I :  OHE Appt Confirmation #
     I                                      407 416 P2V5T1
      * I :  OHE Appt Confirmation Nm
     I                                      417 446 P2WBT1
      * I :  Letter of Credit Number
     I                                      447 496 P2WDT1
      * N :  Record Status
     I                                      497 497 P2VSST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1JNCD    PARM           WP0003  2        Order Type - Sa
     C           P1ANC7    PARM           WP0004  70       A/R Customer Nu
     C           P1BKC7    PARM           WP0005  70       Ship To Custome
     C           P1BTC7    PARM           WP0006  70       Parent Customer
     C           P1BRTX    PARM           WP0007 30        Ship To Name
     C           P1HMNA    PARM           WP0008 30        Ship To Address
     C           P1HONA    PARM           WP0009 30        Ship To Address
     C           P1HPNA    PARM           WP0010 30        Ship To Address
     C           P1HNNA    PARM           WP0011 20        Ship To City
     C           P1DBCD    PARM           WP0012  2        Ship To State C
     C           P1CKTX    PARM           WP0013 11        Ship To Zip/Pos
     C           P1B0C7    PARM           WP0014  70       Bill to Custome
     C           P1AETX    PARM           WP0015 30        Bill to Name
     C           P1B1NA    PARM           WP0016 30        Bill to Address
     C           P1B3NA    PARM           WP0017 30        Bill to Address
     C           P1B4NA    PARM           WP0018 30        Bill to Address
     C           P1B2NA    PARM           WP0019 20        Bill to City
     C           P1BHCD    PARM           WP0020  2        Bill to State C
     C           P1C8TX    PARM           WP0021 11        Bill to Zip/Pos
     C           P1BCNA    PARM           WP0022 15        Customer Purcha
     C           P1A0DT    PARM           WP0023  70       Order Date
     C           P1A5DT    PARM           WP0024  70       Requested Ship
     C           P1GNDT    PARM           WP0025  70       Actual Shipped
     C           P1ACDT    PARM           WP0026  70       Cancel Date
     C           P1AQCD    PARM           WP0027  2        Terms Code
     C           P1B6NA    PARM           WP0028 40        Special Instruc
     C           P1BYNA    PARM           WP0029 40        Special Instruc
     C           P1BZNA    PARM           WP0030  3        Carrier Code
     C           P1GTST    PARM           WP0031  1        Comment Print A
     C           P1GVST    PARM           WP0032  1        Comment Print I
     C           P1GUST    PARM           WP0033  1        Comment Print P
     C           P1QFST    PARM           WP0034  1        Comment Print S
     C           P1CQCD    PARM           WP0035  3        Reason Code
     C           P1GJST    PARM           WP0036  1        Order in Use
     C           P1GWST    PARM           WP0037  1        Header Status
     C           P1GXST    PARM           WP0038  1        Header Status L
     C           P1GYST    PARM           WP0039  1        Order Type Prin
     C           P1AODT    PARM           WP0040  70       Scheduled Ship
     C           P1AIVN    PARM           WP0041 10        User Original E
     C           P1CXDT    PARM           WP0042  70       Date of Origina
     C           P1JZVA    PARM           WP0043 112       Order Value Tot
     C           P1A1WG    PARM           WP0044 112       Order Weight To
     C           P1XIST    PARM           WP0045  1        Credit Hold
     C           P1XJST    PARM           WP0046  1        Production Hold
     C           P1XKST    PARM           WP0047  1        New Customer Ho
     C           P1EIDT    PARM           WP0048  70       Requested Deliv
     C           P1AFTM    PARM           WP0049  40       Requested Deliv
     C           P1E8CD    PARM           WP0050  4        Accounts Receiv
     C           P1E9CD    PARM           WP0051 12        Accounts Receiv
     C           P1RMNB    PARM           WP0052  70       Load ID
     C           P1TBNB    PARM           WP0053  52       Absorbed Freigh
     C           P1R1NB    PARM           WP0054 112       Rated Freight
     C           P1PJST    PARM           WP0055  1        LTL Flag
     C           P1U0ST    PARM           WP0056  1        Price Audit
     C           P1U1ST    PARM           WP0057  1        Price Status
     C           P1Q2CD    PARM           WP0058  2        Shipping Method
     C           P1U2ST    PARM           WP0059  1        Export Status
     C           P1VEST    PARM           WP0060  1        Palletize
     C           P1VFST    PARM           WP0061  1        Shrink Wrap
     C           P1VGST    PARM           WP0062  1        Slip Sheet
     C           P1RPCD    PARM           WP0063  1        Age Code
     C           P1RNNB    PARM           WP0064  52       Reefer Temperat
     C           P1VDST    PARM           WP0065  1        Load Type
     C           P1ATIN    PARM           WP0066  70       Attach to Invoi
     C           P1U4ST    PARM           WP0067  1        Load Plan Order
     C           P1U5ST    PARM           WP0068  1        Print Pick Slip
     C           P1RSRN    PARM           WP0069  70       Resell Referenc
     C           P1MHNA    PARM           WP0070 30        Special Comment
     C           P1MINA    PARM           WP0071 30        Special Comment
     C           P1WBST    PARM           WP0072  1        Affect Auto Acc
     C           P1R4CD    PARM           WP0073  3        Sales Route Cod
     C           P1BFCD    PARM           WP0074  2        Manager Level C
     C           P1Q4CD    PARM           WP0075  3        VP Level Code
     C           P1T3NB    PARM           WP0076  70       Attach to Order
     C           P1SICD    PARM           WP0077  3        Reason for Pric
     C           P1CONB    PARM           WP0078  70       Invoice Number
     C           P1CEST    PARM           WP0079  2        Invoice Suffix
     C           P1AWDT    PARM           WP0080  70       Invoice Date
     C           P1JPCD    PARM           WP0081  2        Event Code
     C           P1XUST    PARM           WP0082  1        Trans Contol AS
     C           P1Z1ST    PARM           WP0083  1        Modified Flag
     C           P1VRVA    PARM           WP0084 112       A/R order Value
     C           P1OBST    PARM           WP0085  1        Billing Activit
     C           P1BCST    PARM           WP0086  1        Block Order Fla
     C           P1BDST    PARM           WP0087  1        Order Certifica
     C           P1B7VL    PARM           WP0088 112       Invoice Order V
     C           P1GASX    PARM           WP0089  1        Process Sts for
     C           P1GBSX    PARM           WP0090  1        Order Conf Fax
     C           P1GCSX    PARM           WP0091  1        Manifest Fax St
     C           P1GDSX    PARM           WP0092  1        Invoice Fax Sts
     C           P1FNSX    PARM           WP0093  1        Transfer in Sto
     C           P1FOSX    PARM           WP0094  1        Email Cust On O
     C           P1FPSX    PARM           WP0095  1        Order Emailed
     C           P1FQSX    PARM           WP0096  1        Export Docs Go
     C           P1FRSX    PARM           WP0097  1        Shipping Temp C
     C           P1FSSX    PARM           WP0098  1        Broker Order St
     C           P1FTSX    PARM           WP0099  1        Air Freight Ord
     C           P1FUSX    PARM           WP0100  2        Order Requires
     C           P1FVSX    PARM           WP0101  2        OH Load Plan Re
     C           P1FWSX    PARM           WP0102  2        Export USDA App
     C           P1FXSX    PARM           WP0103  3        HPB Ship to War
     C           P1FYSX    PARM           WP0104  3        OH TF Exempt Co
     C           P1NODT    PARM           WP0105  70       OH Appt Confirm
     C           P1NPDT    PARM           WP0106  70       JPN Invoice Iss
     C           P1NQDT    PARM           WP0107  70       Load Actual Shi
     C           P1NRDT    PARM           WP0108  70       Load BOL Comple
     C           P1NSDT    PARM           WP0109  70       Load Truck Depa
     C           P1BPTM    PARM           WP0110  60       Maximum Gross W
     C           P1BQTM    PARM           WP0111  60       Time of Origina
     C           P1BRTM    PARM           WP0112  60       OH Appt Confirm
     C           P1BSTM    PARM           WP0113  60       Load BOL Comple
     C           P1BTTM    PARM           WP0114  60       Load Truck Depa
     C           P1H0NX    PARM           WP0115 112       Act Frt Referen
     C           P1H1NX    PARM           WP0116 112       Act Non-Ref Frt
     C           P1H2NX    PARM           WP0117 112       OH Fuel Surchar
     C           P1H3NX    PARM           WP0118 112       OH Total Non-Re
     C           P1H4NX    PARM           WP0119 112       OH Total Ref Fr
     C           P1C0C7    PARM           WP0120  70       Claim Number
     C           P1UVST    PARM           WP0121  1        EDI Status 1
     C           P1UWST    PARM           WP0122  1        EDI Status 2
     C           P1UXST    PARM           WP0123  1        EDI Status 3
     C           P2HEVL    PARM           WP0124 112       OHE HPB RIN Equ
     C           P2HFVL    PARM           WP0125 112       OHE HPB RIN Pri
     C           P2C3TX    PARM           WP0126  4        OHE Spot Buy
     C           P2CHTX    PARM           WP0127  2        OHE Override Ty
     C           P2LMT1    PARM           WP0128 38        Delivery P.O. N
     C           P2LWAA    PARM           WP0129  6        OHE Intended fo
     C           P2V5T1    PARM           WP0130 10        OHE Appt Confir
     C           P2WBT1    PARM           WP0131 30        OHE Appt Confir
     C           P2WDT1    PARM           WP0132 50        Letter of Credi
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Chg Order Header&DlvPO XF
      * RMC 5/19/16 E4119 dont chk live with tpm
     C                     MOVELP1BZNA    YL0001           Carrier Code
      * CASE: PAR.Load ID is GT Zero
     C           P1RMNB    IFGT *ZERO                      *IF
      * RTV Carrier Code       RT - Load Header  * 
     C                     EXSR SARVGN
     C                     END                             *FI
     C                     MOVELP1U5ST    YL0002           Print Pick Slip
      * CASE: PAR.Company Number is Missoula
     C           P1AIC3    IFEQ 363                        *IF
     C                     MOVEL'N'       YL0002           Print Pick Slip
     C                     END                             *FI
      * 11/29/16 Use latest value in OH -- ORDER COULD HAVE BEEN SWEPT AL
      * RTV Load Plan Ready   RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * RTV OH Info before Upd RT - Order Header TRG  * 
     C                     EXSR SCRVGN
      * 06/22/18 DN R12926-Get Co Cust AFR if Block Order Change from B t
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : LCL.Block Order Flag is Block Order
      *   |- c2    : PAR.Block Order Flag is Firm Order
      *   |- c3    : LCL.Shipping Method EQ PAR.Shipping Method
      *   |- c4    : PAR.Shipping Method is Prepaid
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFEQ 'B'                        *IF
     C           P1BCST    IFEQ 'F'                        *IF
     C           YL0004    IFEQ P1Q2CD                     *IF
     C           P1Q2CD    IFEQ 'PR'                       *IF
     C           P1Q2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If Shipping Method did NOT change & must be either PT or PR then
      * get Co Cust AFR to update Order's AFR.
      * If Shipping Method did change to (PT/PR), then we
      * will already have the Co Cust AFR in PAR.Absorbed Freight Rate CW
     C                     MOVEL'Y'       YL0006           Block Order Chg
      * RTV Abs Freight Rate   RT - Company Customer  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0006           Block Order Chg
     C                     Z-ADDP1TBNB    YL0007           Absorbed Freigh
     C                     END                             *FI
      * 06/22/18 DN R12926-Use LCL.Absorbed Freight Rate CWT to Order's A
      * Chg Order Header       CH - Order Header TRG  * 
     C                     EXSR SECHRC
      * ** If OHE record exists, update, else, add    FP1303
      * 06/13/18 DN R12926-Get OHE Abs Freight Info.
      * RTV OHE for Ord Entry2 RT - Order Header Extension  * 
     C                     EXSR SGRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * 07/31/19 DN R15161-Replaced OHE CRTOBJ to Not Call CHGOBJ.
      * CRT Order Header Extsn CR - Order Header Extension  * 
     C                     EXSR SHCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chk Ship Method or Block Order Chgs then set OHE Orig AFR to Orde
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Shipping Method NE LCL.Shipping Method
      *   |- c2    : LCL.Block Order Chg B to F is Yes
      *   '-
     C           P1Q2CD    IFNE YL0004                     *IF
     C           YL0006    OREQ 'Y'                        *OR
     C                     Z-ADDYL0007    YL0010           OHE Orig ABS Fr
     C                     MOVEL*BLANK    YL0009           OHE Abs Rate Ov
     C                     ELSE
      * CASE: *OTHERWISE
      * dont change OHE abs fields
     C                     END                             *FI
      * CHG OE Fields        CH - Order Header Extension  * 
     C                     EXSR SICHRC
     C                     END                             *FI
      * CASE: PAR.Load ID is GT Zero
     C           P1RMNB    IFGT *ZERO                      *IF
      * RTV Chg LD APPT/CNFRM RT - Load Detail  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Carrier Code       RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSA     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABZNA    YL0001           Carrier Code
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Load Plan Ready   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           OH Load Plan Re
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBFVSX    YL0003           OH Load Plan Re
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV OH Info before Upd RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Shipping Method
     C                     MOVEL*BLANK    YL0005           Block Order Fla
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBQ2CD    YL0004           Shipping Method
     C                     MOVELWBBCST    YL0005           Block Order Fla
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Abs Freight Rate   RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1AIC3    WCAIC3           Company Number
     C                     Z-ADDP1BKC7    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0007           Absorbed Freigh
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCTBNB    YL0007           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Order Header       CH - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADDP1C4NB    WDC4NB           Order Number
      *
     C           KLCHSE    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C           KLCHSE    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * USER: Processing after Data read
      * 01/22/09 RMC  move here from "before Data update" spot
      * 06/23/00 PKD Added the update of the Export Status on the Load
      *              if the Export Status on the Order is changed to Y,
      * Change the Export Status.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Export Status NE DB1.Export Status
      *   |- c2    : PAR.Export Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1U2ST    IFNE WDU2ST                     *IF
     C           P1U2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Load ID is NE Blank
      *   |- c2    : DB1.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDRMNB    IFNE 0                          *IF
     C           WDU4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg Export Status     CH - Load Header  * 
     C                     EXSR SFCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       YL0008           Status Flag 1
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE:
      *  - (c1ORc2) AND c3
      *   |- c1    : PAR.Requested Delivery Date NE DB1.Requested Deliver
      *   |- c2    : PAR.Requested Delivery Time NE DB1.Requested Deliver
      *   |- c3    : DB1.OH Appt Confirmation Dt is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           P1EIDT    IFNE WDEIDT                     *IF
     C           P1AFTM    ORNE WDAFTM                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           WDNODT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0008           Status Flag 1
     C                     END                             *FI
      * Move non-key fields to @BECPFJ
     C                     MOVELP1JNCD    WDJNCD    P      Order Type - Sa
     C                     Z-ADDP1ANC7    WDANC7           A/R Customer Nu
     C                     Z-ADDP1BKC7    WDBKC7           Ship To Custome
     C                     MOVELP1BRTX    WDBRTX    P      Ship To Name
     C                     MOVELP1HMNA    WDHMNA    P      Ship To Address
     C                     MOVELP1HONA    WDHONA    P      Ship To Address
     C                     MOVELP1HPNA    WDHPNA    P      Ship To Address
     C                     MOVELP1HNNA    WDHNNA    P      Ship To City
     C                     MOVELP1DBCD    WDDBCD    P      Ship To State C
     C                     MOVELP1CKTX    WDCKTX    P      Ship To Zip/Pos
     C                     Z-ADDP1B0C7    WDB0C7           Bill to Custome
     C                     MOVELP1AETX    WDAETX    P      Bill to Name
     C                     MOVELP1B1NA    WDB1NA    P      Bill to Address
     C                     MOVELP1B3NA    WDB3NA    P      Bill to Address
     C                     MOVELP1B4NA    WDB4NA    P      Bill to Address
     C                     MOVELP1B2NA    WDB2NA    P      Bill to City
     C                     MOVELP1BHCD    WDBHCD    P      Bill to State C
     C                     MOVELP1C8TX    WDC8TX    P      Bill to Zip/Pos
     C                     MOVELP1BCNA    WDBCNA    P      Customer Purcha
     C                     Z-ADDP1A0DT    WDA0DT           Order Date
     C                     Z-ADDP1A5DT    WDA5DT           Requested Ship
     C                     Z-ADDP1GNDT    WDGNDT           Actual Shipped
     C                     Z-ADDP1ACDT    WDACDT           Cancel Date
     C                     MOVELP1AQCD    WDAQCD    P      Terms Code
     C                     MOVELP1B6NA    WDB6NA    P      Special Instruc
     C                     MOVELP1BYNA    WDBYNA    P      Special Instruc
     C                     MOVELYL0001    WDBZNA    P      Carrier Code
     C                     MOVELP1GTST    WDGTST    P      Comment Print A
     C                     MOVELP1GVST    WDGVST    P      Comment Print I
     C                     MOVELP1GUST    WDGUST    P      Comment Print P
     C                     MOVELP1QFST    WDQFST    P      Comment Print S
     C                     MOVELP1CQCD    WDCQCD    P      Reason Code
     C                     MOVELP1GJST    WDGJST    P      Order in Use
     C                     MOVELP1GWST    WDGWST    P      Header Status
     C                     MOVELP1GXST    WDGXST    P      Header Status L
     C                     MOVELP1GYST    WDGYST    P      Order Type Prin
     C                     Z-ADDP1AODT    WDAODT           Scheduled Ship
     C                     MOVELP1AIVN    WDAIVN    P      User Original E
     C                     Z-ADDP1CXDT    WDCXDT           Date of Origina
     C                     Z-ADDP1JZVA    WDJZVA           Order Value Tot
     C                     Z-ADDP1A1WG    WDA1WG           Order Weight To
     C                     MOVELP1XIST    WDXIST    P      Credit Hold
     C                     MOVELP1XJST    WDXJST    P      Production Hold
     C                     MOVELP1XKST    WDXKST    P      New Customer Ho
     C                     Z-ADDP1EIDT    WDEIDT           Requested Deliv
     C                     Z-ADDP1AFTM    WDAFTM           Requested Deliv
     C                     MOVELP1E8CD    WDE8CD    P      Accounts Receiv
     C                     MOVELP1E9CD    WDE9CD    P      Accounts Receiv
     C                     Z-ADDP1RMNB    WDRMNB           Load ID
     C                     Z-ADDYL0007    WDTBNB           Absorbed Freigh
     C                     Z-ADDP1R1NB    WDR1NB           Rated Freight
     C                     MOVELP1PJST    WDPJST    P      LTL Flag
     C                     MOVELP1U0ST    WDU0ST    P      Price Audit
     C                     MOVELP1U1ST    WDU1ST    P      Price Status
     C                     MOVELP1Q2CD    WDQ2CD    P      Shipping Method
     C                     MOVELP1U2ST    WDU2ST    P      Export Status
     C                     MOVELP1VEST    WDVEST    P      Palletize
     C                     MOVELP1VFST    WDVFST    P      Shrink Wrap
     C                     MOVELP1VGST    WDVGST    P      Slip Sheet
     C                     MOVELP1RPCD    WDRPCD    P      Age Code
     C                     Z-ADDP1RNNB    WDRNNB           Reefer Temperat
     C                     MOVELP1VDST    WDVDST    P      Load Type
     C                     Z-ADDP1ATIN    WDATIN           Attach to Invoi
     C                     MOVELP1U4ST    WDU4ST    P      Load Plan Order
     C                     MOVELYL0002    WDU5ST    P      Print Pick Slip
     C                     Z-ADDP1RSRN    WDRSRN           Resell Referenc
     C                     MOVELP1MHNA    WDMHNA    P      Special Comment
     C                     MOVELP1MINA    WDMINA    P      Special Comment
     C                     MOVELP1WBST    WDWBST    P      Affect Auto Acc
     C                     MOVELP1R4CD    WDR4CD    P      Sales Route Cod
     C                     MOVELP1BFCD    WDBFCD    P      Manager Level C
     C                     MOVELP1Q4CD    WDQ4CD    P      VP Level Code
     C                     Z-ADDP1T3NB    WDT3NB           Attach to Order
     C                     MOVELP1SICD    WDSICD    P      Reason for Pric
     C                     Z-ADDP1CONB    WDCONB           Invoice Number
     C                     MOVELP1CEST    WDCEST    P      Invoice Suffix
     C                     Z-ADDP1AWDT    WDAWDT           Invoice Date
     C                     MOVELP1JPCD    WDJPCD    P      Event Code
     C                     MOVELP1XUST    WDXUST    P      Trans Contol AS
     C                     MOVELP1Z1ST    WDZ1ST    P      Modified Flag
     C                     Z-ADDP1VRVA    WDVRVA           A/R order Value
     C                     MOVELP1OBST    WDOBST    P      Billing Activit
     C                     MOVELP1BCST    WDBCST    P      Block Order Fla
     C                     MOVELP1BDST    WDBDST    P      Order Certifica
     C                     Z-ADDP1B7VL    WDB7VL           Invoice Order V
     C                     MOVELP1GASX    WDGASX    P      Process Sts for
     C                     MOVELP1GBSX    WDGBSX    P      Order Conf Fax
     C                     MOVELP1GCSX    WDGCSX    P      Manifest Fax St
     C                     MOVELP1GDSX    WDGDSX    P      Invoice Fax Sts
     C                     MOVELP1FNSX    WDFNSX    P      Transfer in Sto
     C                     MOVELP1FOSX    WDFOSX    P      Email Cust On O
     C                     MOVELP1FPSX    WDFPSX    P      Order Emailed
     C                     MOVELP1FQSX    WDFQSX    P      Export Docs Go
     C                     MOVELP1FRSX    WDFRSX    P      Shipping Temp C
     C                     MOVELP1FSSX    WDFSSX    P      Broker Order St
     C                     MOVELP1FTSX    WDFTSX    P      Air Freight Ord
     C                     MOVELP1FUSX    WDFUSX    P      Order Requires
     C                     MOVELYL0003    WDFVSX    P      OH Load Plan Re
     C                     MOVELP1FWSX    WDFWSX    P      Export USDA App
     C                     MOVELP1FXSX    WDFXSX    P      HPB Ship to War
     C                     MOVELP1FYSX    WDFYSX    P      OH TF Exempt Co
     C                     Z-ADDP1NODT    WDNODT           OH Appt Confirm
     C                     Z-ADDP1NPDT    WDNPDT           JPN Invoice Iss
     C                     Z-ADDP1NQDT    WDNQDT           Load Actual Shi
     C                     Z-ADDP1NRDT    WDNRDT           Load BOL Comple
     C                     Z-ADDP1NSDT    WDNSDT           Load Truck Depa
     C                     Z-ADDP1BPTM    WDBPTM           Maximum Gross W
     C                     Z-ADDP1BQTM    WDBQTM           Time of Origina
     C                     Z-ADDP1BRTM    WDBRTM           OH Appt Confirm
     C                     Z-ADDP1BSTM    WDBSTM           Load BOL Comple
     C                     Z-ADDP1BTTM    WDBTTM           Load Truck Depa
     C                     Z-ADDP1H0NX    WDH0NX           Act Frt Referen
     C                     Z-ADDP1H1NX    WDH1NX           Act Non-Ref Frt
     C                     Z-ADDP1H2NX    WDH2NX           OH Fuel Surchar
     C                     Z-ADDP1H3NX    WDH3NX           OH Total Non-Re
     C                     Z-ADDP1H4NX    WDH4NX           OH Total Ref Fr
     C                     Z-ADDP1C0C7    WDC0C7           Claim Number
     C                     MOVELP1UVST    WDUVST    P      EDI Status 1
     C                     MOVELP1UWST    WDUWST    P      EDI Status 2
     C                     MOVELP1UXST    WDUXST    P      EDI Status 3
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWDAIC3    PAAIC3           Company Number
     C                     Z-ADDWDC4NB    PAC4NB           Order Number
     C                     MOVELWDJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWDANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWDBKC7    PABKC7           Ship To Custome
     C                     MOVELWDBRTX    PABRTX    P      Ship To Name
     C                     MOVELWDHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWDHONA    PAHONA    P      Ship To Address
     C                     MOVELWDHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWDHNNA    PAHNNA    P      Ship To City
     C                     MOVELWDDBCD    PADBCD    P      Ship To State C
     C                     MOVELWDCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWDB0C7    PAB0C7           Bill to Custome
     C                     MOVELWDAETX    PAAETX    P      Bill to Name
     C                     MOVELWDB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWDB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWDB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWDB2NA    PAB2NA    P      Bill to City
     C                     MOVELWDBHCD    PABHCD    P      Bill to State C
     C                     MOVELWDC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWDBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWDA0DT    PAA0DT           Order Date
     C                     Z-ADDWDA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWDGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWDACDT    PAACDT           Cancel Date
     C                     MOVELWDAQCD    PAAQCD    P      Terms Code
     C                     MOVELWDB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWDBYNA    PABYNA    P      Special Instruc
     C                     MOVELWDBZNA    PABZNA    P      Carrier Code
     C                     MOVELWDGTST    PAGTST    P      Comment Print A
     C                     MOVELWDGVST    PAGVST    P      Comment Print I
     C                     MOVELWDGUST    PAGUST    P      Comment Print P
     C                     MOVELWDQFST    PAQFST    P      Comment Print S
     C                     MOVELWDCQCD    PACQCD    P      Reason Code
     C                     MOVELWDGJST    PAGJST    P      Order in Use
     C                     MOVELWDGWST    PAGWST    P      Header Status
     C                     MOVELWDGXST    PAGXST    P      Header Status L
     C                     MOVELWDGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWDAODT    PAAODT           Scheduled Ship
     C                     MOVELWDAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWDCXDT    PACXDT           Date of Origina
     C                     Z-ADDWDJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWDA1WG    PAA1WG           Order Weight To
     C                     MOVELWDXIST    PAXIST    P      Credit Hold
     C                     MOVELWDXJST    PAXJST    P      Production Hold
     C                     MOVELWDXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWDEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWDAFTM    PAAFTM           Requested Deliv
     C                     MOVELWDE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWDE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWDRMNB    PARMNB           Load ID
     C                     Z-ADDWDTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWDR1NB    PAR1NB           Rated Freight
     C                     MOVELWDPJST    PAPJST    P      LTL Flag
     C                     MOVELWDU0ST    PAU0ST    P      Price Audit
     C                     MOVELWDU1ST    PAU1ST    P      Price Status
     C                     MOVELWDQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWDU2ST    PAU2ST    P      Export Status
     C                     MOVELWDVEST    PAVEST    P      Palletize
     C                     MOVELWDVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWDVGST    PAVGST    P      Slip Sheet
     C                     MOVELWDRPCD    PARPCD    P      Age Code
     C                     Z-ADDWDRNNB    PARNNB           Reefer Temperat
     C                     MOVELWDVDST    PAVDST    P      Load Type
     C                     Z-ADDWDATIN    PAATIN           Attach to Invoi
     C                     MOVELWDU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWDU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWDRSRN    PARSRN           Resell Referenc
     C                     MOVELWDMHNA    PAMHNA    P      Special Comment
     C                     MOVELWDMINA    PAMINA    P      Special Comment
     C                     MOVELWDWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWDR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWDBFCD    PABFCD    P      Manager Level C
     C                     MOVELWDQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWDT3NB    PAT3NB           Attach to Order
     C                     MOVELWDSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWDCONB    PACONB           Invoice Number
     C                     MOVELWDCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWDAWDT    PAAWDT           Invoice Date
     C                     MOVELWDJPCD    PAJPCD    P      Event Code
     C                     MOVELWDXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWDZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWDVRVA    PAVRVA           A/R order Value
     C                     MOVELWDOBST    PAOBST    P      Billing Activit
     C                     MOVELWDBCST    PABCST    P      Block Order Fla
     C                     MOVELWDBDST    PABDST    P      Order Certifica
     C                     Z-ADDWDB7VL    PAB7VL           Invoice Order V
     C                     MOVELWDGASX    PAGASX    P      Process Sts for
     C                     MOVELWDGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWDGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWDGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWDFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWDFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWDFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWDFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWDFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWDFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWDFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWDFUSX    PAFUSX    P      Order Requires
     C                     MOVELWDFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWDFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWDFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWDFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWDNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWDNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWDNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWDNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWDNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWDBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWDBQTM    PABQTM           Time of Origina
     C                     Z-ADDWDBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWDBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWDBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWDH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWDH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWDH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWDH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWDH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWDC0C7    PAC0C7           Claim Number
     C                     MOVELWDUVST    PAUVST    P      EDI Status 1
     C                     MOVELWDUWST    PAUWST    P      EDI Status 2
     C                     MOVELWDUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWDAATM    PAAATM           Job Time
     C                     MOVELWDAYNA    PAAYNA    P      User Id
     C                     MOVELWDA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWDAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * -----------------------------------------------------------------
      * -----------------------------------------------------------------
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Email Requested Delv Change msg is changed and Appt exists.
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0008    IFEQ 'Y'                        *IF
      * Exc Email Ord RqDtChg XF - Order Header TRG  * 
     C                     CALL 'PBEPXFR'              90  Exc Email Ord R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0001  30       Company Number
     C                     PARM WDC4NB    WQ0002  70       Order Number
     C                     PARM WDR4CD    WQ0003  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBEPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg Export Status     CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  30       Company Number
     C                     Z-ADD*ZERO     WN0006  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0007  1        LTL Flag
     C                     MOVEL*BLANK    WN0008  1        Load Status
     C                     Z-ADD*ZERO     WN0009  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0010 15        Seal 1
     C                     MOVEL*BLANK    WN0011 15        Seal 2
     C                     MOVEL*BLANK    WN0012 15        Seal 3
     C                     MOVEL*BLANK    WN0013 15        Seal 4
     C                     MOVEL*BLANK    WN0014 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0015  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0016 112       Flat Amount
     C                     MOVEL*BLANK    WN0017  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0018  50       Total Stops
     C                     MOVEL*BLANK    WN0019 20        Trailer Id
     C                     MOVEL*BLANK    WN0020  3        Transloader Car
     C                     Z-ADD*ZERO     WN0021  40       BOL Time
     C                     MOVEL*BLANK    WN0022  3        Carrier Code
     C                     MOVEL*BLANK    WN0023  7        Truck Size
     C                     Z-ADD*ZERO     WN0024  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0025 112       Rated Freight
     C                     MOVEL*BLANK    WN0026  1        Ship Status
     C                     MOVEL*BLANK    WN0027  1        Load Type
     C                     Z-ADD*ZERO     WN0028  50       Number Pallets
     C                     Z-ADD*ZERO     WN0029  50       Number Pallets
     C                     Z-ADD*ZERO     WN0030 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0031  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0032  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0033  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0034 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0035 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0036  70       Actual Departur
     C                     Z-ADD*ZERO     WN0037  40       Departure Time
     C                     Z-ADD*ZERO     WN0038  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0039  52       Product Tempera
     C                     Z-ADD*ZERO     WN0040  50       Number Spacers
     C                     MOVEL*BLANK    WN0041 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0042  70       Total Load Mile
     C                     MOVEL*BLANK    WN0043 12        Recorder ID
     C                     MOVEL*BLANK    WN0044  2        Shipping Method
     C                     MOVEL*BLANK    WN0045  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0046  2        Ship To State C
     C                     Z-ADD*ZERO     WN0047  70       Gross Weight
     C                     MOVEL*BLANK    WN0048  3        Carrier Broker
     C                     Z-ADD*ZERO     WN0049  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0050  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0051  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0052  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0053  70       Spotted Date
     C                     Z-ADD*ZERO     WN0054  60       Spotted Time
     C                     Z-ADD*ZERO     WN0055  70       Load Finished D
     C                     Z-ADD*ZERO     WN0056  60       Load Finished T
     C                     Z-ADD*ZERO     WN0057  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0058  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0059  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0060  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0061  70       Truck Departure
     C                     Z-ADD*ZERO     WN0062  60       Truck Departure
     C                     Z-ADD*ZERO     WN0063  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0064  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0065  3        Shipping Line
     C                     MOVEL*BLANK    WN0066 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0067 30        Vessel Name
     C                     Z-ADD*ZERO     WN0068  50       Voyage
     C                     Z-ADD*ZERO     WN0069  70       Sail Date
     C                     MOVEL*BLANK    WN0070 12        Booking Number
     C                     MOVEL*BLANK    WN0071 20        Discharge Port
     C                     Z-ADD*ZERO     WN0072  70       Arrival Date
     C                     MOVEL*BLANK    WN0073 12        Container Numbe
     C                     Z-ADD*ZERO     WN0074  70       Date In
     C                     Z-ADD*ZERO     WN0075  60       Time In
     C                     Z-ADD*ZERO     WN0076  70       Date Out
     C                     Z-ADD*ZERO     WN0077  60       Time Out
     C                     Z-ADD*ZERO     WN0078 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0079  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0080  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0081  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0082  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0083  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0084  70       Requested Deliv
     C                     MOVEL*BLANK    WN0085  1        Load Acceptance
     C                     MOVEL*BLANK    WN0086  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0087  70       On Yard Date
     C                     Z-ADD*ZERO     WN0088  60       On Yard Time
     C                     Z-ADD*ZERO     WN0089  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0090  60       Deadline Depart
     C                     MOVEL*BLANK    WN0091  1        Load Held Over
     C                     MOVEL*BLANK    WN0092  1        Load Held Over
     C                     MOVEL*BLANK    WN0093 15        Load Held Over
     C                     MOVEL*BLANK    WN0094 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0095 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0096  70       Express Mail Da
     C                     MOVEL*BLANK    WN0097  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0098  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0099  70       Product Complet
     C                     Z-ADD*ZERO     WN0100  60       Product Complet
     C                     Z-ADD*ZERO     WN0101  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0102  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0103  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0104  1        Load Confirmed
     C                     MOVEL*BLANK    WN0105 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0106  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0107  60       Load Door 1
     C                     Z-ADD*ZERO     WN0108  70       Override Total
     C                     Z-ADD*ZERO     WN0109  60       Load Door 2
     C                     MOVEL*BLANK    WN0110  1        Partial Load
     C                     MOVEL*BLANK    WN0111  1        Load Confirmati
     C                     MOVEL*BLANK    WN0112  1        Export Load USD
     C                     MOVEL*BLANK    WN0113  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0114 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0115 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0116 15        Late Billing Em
     C                     MOVEL*BLANK    WN0117 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0118 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0119  1        Multi Company L
     C                     MOVEL*BLANK    WN0120  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0121  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0122  1        LH Power Only L
     C                     MOVEL*BLANK    WN0123  1        MG Created Load
     C                     MOVEL*BLANK    WN0124  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0125  2        Load U/M
     C                     MOVEL*BLANK    WN0126  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0127  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0128  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0129  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0130  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0131  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0132  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0133  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0134  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0135  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0136  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0137  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0138  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0139  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0140  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0141  60       LH Unused Time
     C                     MOVEL*BLANK    WN0142  1        EDI Status 1
     C                     MOVEL*BLANK    WN0143  1        EDI Status 2
     C                     MOVEL*BLANK    WN0144  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0145  60       Job Time
     C                     MOVEL*BLANK    WN0146 10        User Id
     C                     MOVEL*BLANK    WN0147 10        Job Name
     C                     Z-ADD*ZERO     WN0148  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWDRMNB    WERMNB           Load ID
      *
     C           KLCHSF    KLIST
     C                     KFLD           WERMNB           Load ID
     C           KLCHSF    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVELP1U2ST    WEU2ST    P      Export Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV OHE for Ord Entry2 RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WFAIC3           Company Number
     C                     Z-ADDP1C4NB    WFC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WULMT1           Delivery P.O. N
     C                     MOVEL*BLANK    YL0009           OHE Abs Rate Ov
     C                     Z-ADD*ZERO     YL0010           OHE Orig ABS Fr
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFLMT1    WULMT1           Delivery P.O. N
     C                     MOVELWFV4T1    YL0009           OHE Abs Rate Ov
     C                     Z-ADDWFQMNY    YL0010           OHE Orig ABS Fr
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT Order Header Extsn CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDP1AIC3    WGAIC3           Company Number
     C                     Z-ADDP1C4NB    WGC4NB           Order Number
     C                     Z-ADDP1RMNB    WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGRUNB           Stop/Drop Seque
     C                     MOVEL*BLANK    WGXACD           Shipping Line
     C                     MOVEL*BLANK    WGOANA           Port Delv Termi
     C                     MOVEL*BLANK    WGHBAA           OHE City
     C                     MOVEL*BLANK    WGJ0T1           OHE Vessel/Airl
     C                     MOVEL*BLANK    WGGENY           OHE Voyage/Flig
     C                     MOVEL*BLANK    WGJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    WGHCAA           OHE Discharge P
     C                     Z-ADD*ZERO     WGQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WGQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WGQYDT           OHE Arrival Dat
     C                     MOVEL*BLANK    WGHDAA           OHE Late Delive
     C                     MOVELYL0011    WGCCTX           OHE Ship Status
     C                     MOVEL*BLANK    WGJ2T1           OHE Container N
     C                     MOVEL*BLANK    WGRLNA           OHE Comment 1
     C                     MOVEL*BLANK    WGRMNA           OHE Comment 2
     C                     Z-ADD*ZERO     WGGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGGHNY           OHE Unused Numb
     C                     Z-ADDP2HEVL    WGHEVL           OHE HPB RIN Equ
     C                     Z-ADDP2HFVL    WGHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WGHGVL           Transload Termi
     C                     Z-ADD*ZERO     WGQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WGQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WGQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WGQ2DT           OHE Actual Ship
     C                     MOVELYL0012    WGC2TX           OHE Carrier SCA
     C                     MOVELP2C3TX    WGC3TX           OHE Spot Buy
     C                     MOVELYL0013    WGC6TX           OHE PO ACK Flag
     C                     MOVELP2CHTX    WGCHTX           OHE Override Ty
     C                     MOVELYL0014    WGCITX           OHE Backhaul St
     C                     MOVELYL0015    WGCLTX           OHE Backhaul ET
     C                     MOVELYL0016    WGB4TX           OHE Load Haul T
     C                     MOVELYL0017    WGCUTX           OHE Backhaul Ca
     C                     MOVELYL0018    WGCVTX           OHE Bookings Co
     C                     MOVELYL0019    WGB9TX           OHE EDI Error R
     C                     MOVELYL0020    WGJWSC           OHE EDI Error R
     C                     Z-ADD*ZERO     WGITNY           HPB COA Batch N
     C                     MOVELP2LMT1    WGLMT1           Delivery P.O. N
     C                     MOVELP2LWAA    WGLWAA           OHE Intended fo
     C                     MOVELYL0021    WGFVST           OHE EDI 943 Act
     C                     MOVELYL0022    WGF0ST           OHE EDI 944 Act
     C                     MOVELYL0023    WGF2ST           OHE EDI 940 Act
     C                     MOVELYL0024    WGF3ST           OHE EDI 945 Act
     C                     MOVELYL0020    WGJUSC           OHE EDI 856 Act
     C                     MOVELYL0020    WGJVSC           OHE EDI 824 Act
     C                     MOVEL*BLANK    WGV3T1           OHE Transload S
     C                     MOVEL*BLANK    WGV4T1           OHE Abs Rate Ov
     C                     MOVELP2V5T1    WGV5T1           OHE Appt Confir
     C                     MOVEL*BLANK    WGV6T1           OHE Backhaul Co
     C                     MOVEL*BLANK    WGV7T1           OHE Backhaul Ch
     C                     MOVEL*BLANK    WGV8T1           OHE Transload C
     C                     MOVEL*BLANK    WGV9T1           OHE Pier Pass I
     C                     MOVEL*BLANK    WGWAT1           OHE Carrier Nm
     C                     MOVELP2WBT1    WGWBT1           OHE Appt Confir
     C                     MOVEL*BLANK    WGWCT1           OHE Backhaul Co
     C                     MOVELP2WDT1    WGWDT1           Letter of Credi
     C                     Z-ADD*ZERO     WGQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WGQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WGQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WGP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WGQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WGQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WGQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WGQENY           Original Appoin
     C                     Z-ADD*ZERO     WGQFNY           Original Appoin
     C                     Z-ADD*ZERO     WGQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WGQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WGQINY           OHE Unused Nume
     C                     Z-ADDYL0007    WGQMNY           OHE Orig ABS Fr
     C                     MOVELYL0020    WGMYU1           OHE Genset Numb
     C                     MOVELYL0020    WGJXSC           OHE Unused Stat
     C                     MOVELYL0020    WGJYSC           OHE Unused Stat
     C                     MOVELYL0020    WGJZSC           OHE Unused Stat
     C                     MOVELYL0020    WGJ0SC           OHE Unused Stat
     C                     MOVELYL0020    WGMZU1           OHE Unused Text
     C                     MOVELYL0020    WGM0U1           OHE Unused Text
     C                     MOVELYL0020    WGM1U1           OHE Unused Text
     C                     MOVELYL0020    WGM2U1           OHE Unused Text
     C                     MOVELYL0020    WGM3U1           OHE Unused Text
     C                     Z-ADD*ZERO     WGW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WGW6DT           OHE Unused Date
     C                     MOVELYL0025    WGUVST           EDI Status 1
     C                     MOVELYL0026    WGUWST           EDI Status 2
     C                     MOVELYL0027    WGUXST           EDI Status 3
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp 2 IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C           KLCRSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSH    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
      * USER: Processing if Data update error
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG OE Fields        CH - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0149  70       Load ID
     C                     Z-ADD*ZERO     WN0150  50       Stop/Drop Seque
     C                     MOVEL*BLANK    WN0151  3        Shipping Line
     C                     MOVEL*BLANK    WN0152 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0153 25        OHE City
     C                     MOVEL*BLANK    WN0154 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0155 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0156 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0157 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0158  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0159  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0160  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0161  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0162  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0163 12        OHE Container N
     C                     MOVEL*BLANK    WN0164 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0165 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0166 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0167 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0168 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0169 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0170 112       Transload Termi
     C                     Z-ADD*ZERO     WN0171  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0172  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0173  70       OHE Port/Pier P
     C                     Z-ADD*ZERO     WN0174  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0175  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0176  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0177  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0178  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0179  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0180  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0181  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0182  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0183  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0184  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0185  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0186  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0187  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0188  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0189  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0190  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0191 10        OHE Transload S
     C                     MOVEL*BLANK    WN0192 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0193 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0194 15        OHE Transload C
     C                     MOVEL*BLANK    WN0195 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0196 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0197 50        OHE Backhaul Co
     C                     Z-ADD*ZERO     WN0198  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0199  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0200  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0201  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0202  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0203  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0204  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0205  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0206  60       Original Appoin
     C                     Z-ADD*ZERO     WN0207  60       Original Appoin
     C                     Z-ADD*ZERO     WN0208  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0209  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0210  90       OHE Unused Nume
     C                     MOVEL*BLANK    WN0211 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0212  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0213  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0214  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0215  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0216  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0217  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0218 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0219 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0220 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0221  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0222  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0223  1        EDI Status 1
     C                     MOVEL*BLANK    WN0224  1        EDI Status 2
     C                     MOVEL*BLANK    WN0225  1        EDI Status 3
     C                     MOVEL*BLANK    WN0226  1        Record Status
     C                     Z-ADD*ZERO     WN0227  60       Job Time
     C                     MOVEL*BLANK    WN0228 10        User Id
     C                     MOVEL*BLANK    WN0229 10        Job Name
     C                     Z-ADD*ZERO     WN0230  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDP1AIC3    WGAIC3           Company Number
     C                     Z-ADDP1C4NB    WGC4NB           Order Number
      *
     C           KLCHSI    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C           KLCHSI    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YCRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDP2HEVL    WGHEVL           OHE HPB RIN Equ
     C                     Z-ADDP2HFVL    WGHFVL           OHE HPB RIN Pri
     C                     MOVELP2C3TX    WGC3TX    P      OHE Spot Buy
     C                     MOVELP2CHTX    WGCHTX    P      OHE Override Ty
     C                     MOVELP2LMT1    WGLMT1    P      Delivery P.O. N
     C                     MOVELP2LWAA    WGLWAA    P      OHE Intended fo
     C                     MOVELYL0009    WGV4T1    P      OHE Abs Rate Ov
     C                     MOVELP2V5T1    WGV5T1    P      OHE Appt Confir
     C                     MOVELP2WBT1    WGWBT1    P      OHE Appt Confir
     C                     MOVELP2WDT1    WGWDT1    P      Letter of Credi
     C                     Z-ADDYL0010    WGQMNY           OHE Orig ABS Fr
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     MOVEL##USR     WGAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Chg LD APPT/CNFRM RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSJ02           Order Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSJ01           Company Number
     C                     Z-ADDP1C4NB    WQSJ02           Order Number
      * Establish starting position
     C           KRSSJ     SETLL@FLCPW9                    *
     C           KRSSJ     READE@FLCPW9                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWHN7DT    YL0028           LD Carrier Appt
     C                     Z-ADDWHB3TM    YL0029           LD Carrier Appt
      * Upd Ld Carr Appt if Sls Appt is entered
      * CASE: PAR.LD Sls Appt Confirm Dt is Entered
     C           P1NODT    IFGT 0                          *IF
     C                     Z-ADDP1EIDT    YL0028           LD Carrier Appt
     C           P1AFTM    MULT 100       YL0029           LD Carrier Appt
     C                     END                             *FI
      * Blank out Ld Carr Appt if Sls Appt is now blank AND WAS entered b
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.LD Sls Appt Confirm Dt is Zero
      *   |- c2    : DB1.LD Sls Appt Confirm Dt is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1NODT    IFEQ 0                          *IF
     C           WHN8DT    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD0         YL0028           LD Carrier Appt
     C                     Z-ADD0         YL0029           LD Carrier Appt
     C                     END                             *FI
      * Chg LD APPT/CNFRM    CH - Load Detail  * 
     C                     EXSR SKCHRC
     C           KRSSJ     READE@FLCPW9                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg LD APPT/CNFRM    CH - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0231 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0232  50       Miles to next s
     C                     Z-ADD*ZERO     WN0233  72       Freight Charge
     C                     Z-ADD*ZERO     WN0234  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0235 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0236  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0237 112       Rated Freight
     C                     Z-ADD*ZERO     WN0238  30       Company Number
     C                     Z-ADD*ZERO     WN0239  70       Order Number
     C                     MOVEL*BLANK    WN0240  1        Ship Status
     C                     Z-ADD*ZERO     WN0241  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0242  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0243  70       Appointment Con
     C                     Z-ADD*ZERO     WN0244  60       Appointment Con
     C                     Z-ADD*ZERO     WN0245  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0246  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0247  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0248  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0249  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0250  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0251  70       On Yard Date
     C                     Z-ADD*ZERO     WN0252  60       On Yard Time
     C                     Z-ADD*ZERO     WN0253  70       MPC Number
     C                     MOVEL*BLANK    WN0254  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0255  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0256 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0257 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0258 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0259 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0260 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0261  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0262  60       LD Unused Time
     C                     MOVEL*BLANK    WN0263  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0264  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0265  2        HPB Transload S
     C                     MOVEL*BLANK    WN0266 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0267 25        LD Unused Txt 2
     C                     MOVEL*BLANK    WN0268 25        LD Unused Txt 3
     C                     MOVEL*BLANK    WN0269  1        EDI Status 1
     C                     MOVEL*BLANK    WN0270  1        EDI Status 2
     C                     MOVEL*BLANK    WN0271  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0272  60       Job Time
     C                     MOVEL*BLANK    WN0273 10        User Id
     C                     MOVEL*BLANK    WN0274 10        Job Name
     C                     Z-ADD*ZERO     WN0275  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWHRMNB    WIRMNB           Load ID
     C                     Z-ADDWHRUNB    WIRUNB           Stop/Drop Seque
      *
     C           KLCHSK    KLIST
     C                     KFLD           WIRMNB           Load ID
     C                     KFLD           WIRUNB           Stop/Drop Seque
     C           KLCHSK    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YDRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWHRVNB    WIRVNB           Stop/Drop
     C                     MOVELP2WBT1    WIK5TX    P      Confirmation Ma
     C                     MOVELP2V5T1    WIW5CD    P      Confirmation Nu
     C                     Z-ADDYL0028    WIN7DT           LD Carrier Appt
     C                     Z-ADDP1NODT    WIN8DT           LD Unused Date
     C                     Z-ADDYL0029    WIB3TM           LD Carrier Appt
     C                     Z-ADDP1BRTM    WIB4TM           LD Unused Time
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AATM           Job Time
     C                     MOVEL*BLANK    P1AYNA           User Id
     C                     MOVEL*BLANK    P1A0NA           Job Name
     C                     Z-ADD*ZERO     P1AXDT           Job Date
     C                     Z-ADD*ZERO     P2RUNB           Stop/Drop Seque
     C                     MOVEL*BLANK    P2XACD           Shipping Line
     C                     MOVEL*BLANK    P2OANA           Port Delv Termi
     C                     MOVEL*BLANK    P2HBAA           OHE City
     C                     MOVEL*BLANK    P2J0T1           OHE Vessel/Airl
     C                     MOVEL*BLANK    P2GENY           OHE Voyage/Flig
     C                     MOVEL*BLANK    P2J1T1           OHE Booking Num
     C                     MOVEL*BLANK    P2HCAA           OHE Discharge P
     C                     Z-ADD*ZERO     P2QWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     P2QXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     P2QYDT           OHE Arrival Dat
     C                     MOVEL*BLANK    P2HDAA           OHE Late Delive
     C                     MOVEL*BLANK    P2CCTX           OHE Ship Status
     C                     MOVEL*BLANK    P2J2T1           OHE Container N
     C                     MOVEL*BLANK    P2RLNA           OHE Comment 1
     C                     MOVEL*BLANK    P2RMNA           OHE Comment 2
     C                     Z-ADD*ZERO     P2GINY           OHE Unused Numb
     C                     Z-ADD*ZERO     P2GFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     P2GGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     P2GHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     P2HGVL           Transload Termi
     C                     Z-ADD*ZERO     P2QZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     P2Q0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     P2Q1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     P2Q2DT           OHE Actual Ship
     C                     MOVEL*BLANK    P2C2TX           OHE Carrier SCA
     C                     MOVEL*BLANK    P2C6TX           OHE PO ACK Flag
     C                     MOVEL*BLANK    P2CITX           OHE Backhaul St
     C                     MOVEL*BLANK    P2CLTX           OHE Backhaul ET
     C                     MOVEL*BLANK    P2B4TX           OHE Load Haul T
     C                     MOVEL*BLANK    P2CUTX           OHE Backhaul Ca
     C                     MOVEL*BLANK    P2CVTX           OHE Bookings Co
     C                     MOVEL*BLANK    P2B9TX           OHE EDI Error R
     C                     Z-ADD*ZERO     P2ITNY           HPB COA Batch N
     C                     MOVEL*BLANK    P2VSST           Record Status
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Spacers
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCR5NB           Deliver after t
     C                     Z-ADD*ZERO     WCR6NB           Deliver before
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WCW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Delivery P.O. Number
     C                     MOVEL*BLANK    WULMT1 38
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WFQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WFQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WFQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WFGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WFHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WFHGVL           Transload Termi
     C                     Z-ADD*ZERO     WFQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WFQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WFQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WFQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WFITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WFQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WFQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WFQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WFP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WFP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WFQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WFQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WFQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WFQENY           Original Appoin
     C                     Z-ADD*ZERO     WFQFNY           Original Appoin
     C                     Z-ADD*ZERO     WFQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WFQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WFQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WFQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WFW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WFW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRMNB           Load ID
     C                     Z-ADD*ZERO     WHRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WHRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WHRWNB           Miles to next s
     C                     Z-ADD*ZERO     WHRXNB           Freight Charge
     C                     Z-ADD*ZERO     WHSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WHT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WHT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WHSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WHKFDT           Appointment Con
     C                     Z-ADD*ZERO     WHACTM           Appointment Con
     C                     Z-ADD*ZERO     WHEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WHAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WHKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WHATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WHHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WHAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WHKKDT           On Yard Date
     C                     Z-ADD*ZERO     WHAVTM           On Yard Time
     C                     Z-ADD*ZERO     WHZ4NB           MPC Number
     C                     Z-ADD*ZERO     WHN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WHN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WHN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WHB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WHB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WHB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Print Pick Slip
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0001  70
      * Define local work field OH Load Plan Ready
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Block Order Chg B to F
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field OHE Abs Rate Override Rsn
     C                     MOVEL*BLANK    YL0009 10
      * Define local work field OHE Orig ABS Freight Rate
     C                     Z-ADD*ZERO     YL0010  96
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field OHE Carrier SCAC Code
     C                     MOVEL*BLANK    YL0012  4
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0013  4
      * Define local work field OHE Backhaul Status
     C                     MOVEL*BLANK    YL0014  2
      * Define local work field OHE Backhaul ETA AM/PM
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field OHE Load Haul Type
     C                     MOVEL*BLANK    YL0016  3
      * Define local work field OHE Backhaul Carrier Code
     C                     MOVEL*BLANK    YL0017  3
      * Define local work field OHE Bookings Confirmed
     C                     MOVEL*BLANK    YL0018  3
      * Define local work field OHE EDI Error Reasons
     C                     MOVEL*BLANK    YL0019  5
      * Define local work field Blank 1 USR
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field OHE EDI 943 Action
     C                     MOVEL*BLANK    YL0021  6
      * Define local work field OHE EDI 944 Action
     C                     MOVEL*BLANK    YL0022  6
      * Define local work field OHE EDI 940 Action
     C                     MOVEL*BLANK    YL0023  6
      * Define local work field OHE EDI 945 Action
     C                     MOVEL*BLANK    YL0024  6
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0028  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0029  60
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
