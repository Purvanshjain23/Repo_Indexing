     H/TITLE PFS Ship Order Detail XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 10/16/19  Time  : 09:00:09
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPBMCPL3IF  E           K        DISK
      * RSQ : PFS Ship Order Detail     Co/Ord/TDt/TTm/Seq PSts=
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FOMFNCPL3IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FCABZRELDIF  E           K        DISK
      * RTV : Company Item              Active Items Only
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFNCPL0IF  E           K        DISK                      A
      * UPD : Manifest Detail           Update index
      *
     FPPBMCPL0UF  E           K        DISK
      * UPD : PFS Ship Order Detail     Update index
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BMCPDE
      * PFS Ship Order Detail     Co/Ord/TDt/TTm/Seq PSts=
      * Renamed input format fields
     I              BMY1NX                          WAY1NX
     I              BMAID8                          WAAID8
     I              BMAFTS                          WAAFTS
     I              BMBCNY                          WABCNY
     I              BMZPNX                          WAZPNX
     I              BMZXNX                          WAZXNX
     I              BMZYNX                          WAZYNX
     I              BMY2NX                          WAY2NX
     I              BMAFD8                          WAAFD8
     I              BMAUNY                          WAAUNY
     I              BMAVNY                          WAAVNY
     I              BMVVSX                          WAVVSX
     I              BMUWSX                          WAUWSX
     I              BMUXSX                          WAUXSX
     I              BMV3SX                          WAV3SX
     I              BMAHNY                          WAAHNY
     I              BMAINY                          WAAINY
     I              BMAJNY                          WAAJNY
     I              BMAKNY                          WAAKNY
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                          WDAIC3
     I              FNC4NB                          WDC4NB
     I              FNDPNB                          WDDPNB
     I              FNUENB                          WDUENB
     I              FNRZNB                          WDRZNB
     I              FNFOQT                          WDFOQT
     I              FNR0NB                          WDR0NB
     I              FNPMST                          WDPMST
     I              FNK7DT                          WDK7DT
     I              FNPFNX                          WDPFNX
     I              FNHGCD                          WDHGCD
     I              FNAJCD                          WDAJCD
     I              FNELDT                          WDELDT
     I              FNN5WG                          WDN5WG
     I              FNRZNA                          WDRZNA
     I              FNH5NY                          WDH5NY
     I              FNH6NY                          WDH6NY
     I              FNH7NY                          WDH7NY
     I              FNGBTX                          WDGBTX
     I              FNN6WG                          WDN6WG
     I              FNN7WG                          WDN7WG
     I              FNGCTX                          WDGCTX
     I              FNGDTX                          WDGDTX
     I              FNRBDT                          WDRBDT
     I              FNITNY                          WDITNY
     I              FNIVNY                          WDIVNY
     I              FNIUNY                          WDIUNY
     I              FNIWNY                          WDIWNY
     I              FNIXNY                          WDIXNY
     I              FNIYNY                          WDIYNY
     I              FNUVST                          WDUVST
     I              FNUWST                          WDUWST
     I              FNUXST                          WDUXST
     I              FNVSST                          WDVSST
     I              FNAATM                          WDAATM
     I              FNAYNA                          WDAYNA
     I              FNA0NA                          WDA0NA
     I              FNAXDT                          WDAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@FNCPUW
      * Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      * Renamed input format fields
     I              FNAIC3                          WFAIC3
     I              FNC4NB                          WFC4NB
     I              FNDPNB                          WFDPNB
     I              FNUENB                          WFUENB
     I              FNRZNB                          WFRZNB
     I              FNFOQT                          WFFOQT
     I              FNR0NB                          WFR0NB
     I              FNPMST                          WFPMST
     I              FNK7DT                          WFK7DT
     I              FNPFNX                          WFPFNX
     I              FNHGCD                          WFHGCD
     I              FNAJCD                          WFAJCD
     I              FNELDT                          WFELDT
     I              FNN5WG                          WFN5WG
     I              FNRZNA                          WFRZNA
     I              FNH5NY                          WFH5NY
     I              FNH6NY                          WFH6NY
     I              FNH7NY                          WFH7NY
     I              FNGBTX                          WFGBTX
     I              FNN6WG                          WFN6WG
     I              FNN7WG                          WFN7WG
     I              FNGCTX                          WFGCTX
     I              FNGDTX                          WFGDTX
     I              FNRBDT                          WFRBDT
     I              FNITNY                          WFITNY
     I              FNIVNY                          WFIVNY
     I              FNIUNY                          WFIUNY
     I              FNIWNY                          WFIWNY
     I              FNIXNY                          WFIXNY
     I              FNIYNY                          WFIYNY
     I              FNUVST                          WFUVST
     I              FNUWST                          WFUWST
     I              FNUXST                          WFUXST
     I              FNVSST                          WFVSST
     I              FNAATM                          WFAATM
     I              FNAYNA                          WFAYNA
     I              FNA0NA                          WFA0NA
     I              FNAXDT                          WFAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WHAIC3
     I              JYZ9ST                          WHZ9ST
     I              JYCSST                          WHCSST
     I              JYZ8ST                          WHZ8ST
     I              JYCXST                          WHCXST
     I              JYSWST                          WHSWST
     I              JYXXTM                          WHXXTM
     I              JYUECD                          WHUECD
     I              JYHSST                          WHHSST
     I              JYAMEO                          WHAMEO
     I              JYSSDF                          WHSSDF
     I              JYPDFT                          WHPDFT
     I              JYYISX                          WHYISX
     I              JYYJSX                          WHYJSX
     I              JYYKSX                          WHYKSX
     I              JYYLSX                          WHYLSX
     I              JYYMSX                          WHYMSX
     I              JYYNSX                          WHYNSX
     I              JYUVST                          WHUVST
     I              JYUWST                          WHUWST
     I              JYUXST                          WHUXST
     I              JYVSST                          WHVSST
     I              JYAATM                          WHAATM
     I              JYAYNA                          WHAYNA
     I              JYA0NA                          WHA0NA
     I              JYAXDT                          WHAXDT
      *
     I@FNCPCS
      * Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WIAIC3
     I              FNC4NB                          WIC4NB
     I              FNDPNB                          WIDPNB
     I              FNUENB                          WIUENB
     I              FNRZNB                          WIRZNB
     I              FNFOQT                          WIFOQT
     I              FNR0NB                          WIR0NB
     I              FNPMST                          WIPMST
     I              FNK7DT                          WIK7DT
     I              FNPFNX                          WIPFNX
     I              FNHGCD                          WIHGCD
     I              FNAJCD                          WIAJCD
     I              FNELDT                          WIELDT
     I              FNN5WG                          WIN5WG
     I              FNRZNA                          WIRZNA
     I              FNH5NY                          WIH5NY
     I              FNH6NY                          WIH6NY
     I              FNH7NY                          WIH7NY
     I              FNGBTX                          WIGBTX
     I              FNN6WG                          WIN6WG
     I              FNN7WG                          WIN7WG
     I              FNGCTX                          WIGCTX
     I              FNGDTX                          WIGDTX
     I              FNRBDT                          WIRBDT
     I              FNITNY                          WIITNY
     I              FNIVNY                          WIIVNY
     I              FNIUNY                          WIIUNY
     I              FNIWNY                          WIIWNY
     I              FNIXNY                          WIIXNY
     I              FNIYNY                          WIIYNY
     I              FNUVST                          WIUVST
     I              FNUWST                          WIUWST
     I              FNUXST                          WIUXST
     I              FNVSST                          WIVSST
     I              FNAATM                          WIAATM
     I              FNAYNA                          WIAYNA
     I              FNA0NA                          WIA0NA
     I              FNAXDT                          WIAXDT
      *
     I@BZREZG
      * Company Item              Active Items Only
      * Renamed input format fields
     I              BZAIC3                          WJAIC3
     I              BZHGCD                          WJHGCD
     I              BZAVNA                          WJAVNA
     I              BZAWNA                          WJAWNA
     I              BZL7NA                          WJL7NA
     I              BZL8NA                          WJL8NA
     I              BZL6NA                          WJL6NA
     I              BZMFNA                          WJMFNA
     I              BZADCD                          WJADCD
     I              BZAWPC                          WJAWPC
     I              BZLXST                          WJLXST
     I              BZAECD                          WJAECD
     I              BZAXPC                          WJAXPC
     I              BZLYST                          WJLYST
     I              BZAFCD                          WJAFCD
     I              BZAICD                          WJAICD
     I              BZAIWG                          WJAIWG
     I              BZHICD                          WJHICD
     I              BZRBCD                          WJRBCD
     I              BZFZST                          WJFZST
     I              BZAVST                          WJAVST
     I              BZCZWG                          WJCZWG
     I              BZC0WG                          WJC0WG
     I              BZURTN                          WJURTN
     I              BZAJC8                          WJAJC8
     I              BZRINB                          WJRINB
     I              BZRHNB                          WJRHNB
     I              BZRGNB                          WJRGNB
     I              BZLNCD                          WJLNCD
     I              BZTFNB                          WJTFNB
     I              BZN0CD                          WJN0CD
     I              BZX4ST                          WJX4ST
     I              BZTMVA                          WJTMVA
     I              BZTNVA                          WJTNVA
     I              BZBLPR                          WJBLPR
     I              BZBMPR                          WJBMPR
     I              BZLRCD                          WJLRCD
     I              BZU9ST                          WJU9ST
     I              BZCMCO                          WJCMCO
     I              BZQ1CD                          WJQ1CD
     I              BZQ8CD                          WJQ8CD
     I              BZCHTM                          WJCHTM
     I              BZQZCD                          WJQZCD
     I              BZXWST                          WJXWST
     I              BZXXST                          WJXXST
     I              BZVMST                          WJVMST
     I              BZSWGH                          WJSWGH
     I              BZPPHE                          WJPPHE
     I              BZR3CD                          WJR3CD
     I              BZSDCD                          WJSDCD
     I              BZICN1                          WJICN1
     I              BZSVCD                          WJSVCD
     I              BZICN2                          WJICN2
     I              BZSWCD                          WJSWCD
     I              BZV2NB                          WJV2NB
     I              BZSXCD                          WJSXCD
     I              BZITCN                          WJITCN
     I              BZSYCD                          WJSYCD
     I              BZITC5                          WJITC5
     I              BZSZCD                          WJSZCD
     I              BZICN6                          WJICN6
     I              BZS0CD                          WJS0CD
     I              BZICN7                          WJICN7
     I              BZS1CD                          WJS1CD
     I              BZICN8                          WJICN8
     I              BZS2CD                          WJS2CD
     I              BZICN9                          WJICN9
     I              BZS3CD                          WJS3CD
     I              BZICN0                          WJICN0
     I              BZS4CD                          WJS4CD
     I              BZSFNB                          WJSFNB
     I              BZA3WG                          WJA3WG
     I              BZSJNB                          WJSJNB
     I              BZLLCD                          WJLLCD
     I              BZLMCD                          WJLMCD
     I              BZP3ST                          WJP3ST
     I              BZSKNB                          WJSKNB
     I              BZSLNB                          WJSLNB
     I              BZSMNB                          WJSMNB
     I              BZP4ST                          WJP4ST
     I              BZCFNB                          WJCFNB
     I              BZCGNB                          WJCGNB
     I              BZILNB                          WJILNB
     I              BZCHNB                          WJCHNB
     I              BZCINB                          WJCINB
     I              BZCJNB                          WJCJNB
     I              BZCMNB                          WJCMNB
     I              BZCNNB                          WJCNNB
     I              BZCRNB                          WJCRNB
     I              BZCSNB                          WJCSNB
     I              BZCVNB                          WJCVNB
     I              BZCWNB                          WJCWNB
     I              BZCXNB                          WJCXNB
     I              BZCZNB                          WJCZNB
     I              BZC0NB                          WJC0NB
     I              BZN1CD                          WJN1CD
     I              BZB4NB                          WJB4NB
     I              BZB5NB                          WJB5NB
     I              BZX5ST                          WJX5ST
     I              BZX6ST                          WJX6ST
     I              BZX7ST                          WJX7ST
     I              BZPCCT                          WJPCCT
     I              BZBDNB                          WJBDNB
     I              BZBJNB                          WJBJNB
     I              BZSUST                          WJSUST
     I              BZSVST                          WJSVST
     I              BZSYST                          WJSYST
     I              BZSZST                          WJSZST
     I              BZS1ST                          WJS1ST
     I              BZXRCD                          WJXRCD
     I              BZXTCD                          WJXTCD
     I              BZXUCD                          WJXUCD
     I              BZF5WG                          WJF5WG
     I              BZF6WG                          WJF6WG
     I              BZF7WG                          WJF7WG
     I              BZBLNB                          WJBLNB
     I              BZBNNB                          WJBNNB
     I              BZS2ST                          WJS2ST
     I              BZS4ST                          WJS4ST
     I              BZS5ST                          WJS5ST
     I              BZS6ST                          WJS6ST
     I              BZS8ST                          WJS8ST
     I              BZS9ST                          WJS9ST
     I              BZTCST                          WJTCST
     I              BZTDST                          WJTDST
     I              BZUVST                          WJUVST
     I              BZUWST                          WJUWST
     I              BZUXST                          WJUXST
     I              BZVSST                          WJVSST
     I              BZAATM                          WJAATM
     I              BZAYNA                          WJAYNA
     I              BZA0NA                          WJA0NA
     I              BZAXDT                          WJAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WKAIC3
     I              KMV8CD                          WKV8CD
     I              KMAUNA                          WKAUNA
     I              KMI5ST                          WKI5ST
     I              KMBXTX                          WKBXTX
     I              KMM8NB                          WKM8NB
     I              KMUVST                          WKUVST
     I              KMUWST                          WKUWST
     I              KMUXST                          WKUXST
     I              KMVSST                          WKVSST
     I              KMAATM                          WKAATM
     I              KMAYNA                          WKAYNA
     I              KMA0NA                          WKA0NA
     I              KMAXDT                          WKAXDT
      *
     I@BMCPYU
      * PFS Ship Order Detail     Update index
      * Renamed input format fields
     I              BMY1NX                          WLY1NX
     I              BMAID8                          WLAID8
     I              BMAFTS                          WLAFTS
     I              BMBCNY                          WLBCNY
     I              BMZPNX                          WLZPNX
     I              BMZXNX                          WLZXNX
     I              BMZYNX                          WLZYNX
     I              BMY2NX                          WLY2NX
     I              BMAFD8                          WLAFD8
     I              BMAUNY                          WLAUNY
     I              BMAVNY                          WLAVNY
     I              BMVVSX                          WLVVSX
     I              BMUWSX                          WLUWSX
     I              BMUXSX                          WLUXSX
     I              BMV3SX                          WLV3SX
     I              BMAHNY                          WLAHNY
     I              BMAINY                          WLAINY
     I              BMAJNY                          WLAJNY
     I              BMAKNY                          WLAKNY
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WMAIC3
     I              EYC4NB                          WMC4NB
     I              EYQ2NB                          WMQ2NB
     I              EYJPCD                          WMJPCD
     I              EYAUC3                          WMAUC3
     I              EYQ7NB                          WMQ7NB
     I              EYOMST                          WMOMST
     I              EYD2DT                          WMD2DT
     I              EYONST                          WMONST
     I              EYOOST                          WMOOST
     I              EYOPST                          WMOPST
     I              EYAWC3                          WMAWC3
     I              EYQ8NB                          WMQ8NB
     I              EYQ9NB                          WMQ9NB
     I              EYBKC7                          WMBKC7
     I              EYUVST                          WMUVST
     I              EYUWST                          WMUWST
     I              EYUXST                          WMUXST
     I              EYAATM                          WMAATM
     I              EYAYNA                          WMAYNA
     I              EYA0NA                          WMA0NA
     I              EYAXDT                          WMAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WOAIC3
     I              EYC4NB                          WOC4NB
     I              EYQ2NB                          WOQ2NB
     I              EYJPCD                          WOJPCD
     I              EYAUC3                          WOAUC3
     I              EYQ7NB                          WOQ7NB
     I              EYOMST                          WOOMST
     I              EYD2DT                          WOD2DT
     I              EYONST                          WOONST
     I              EYOOST                          WOOOST
     I              EYOPST                          WOOPST
     I              EYAWC3                          WOAWC3
     I              EYQ8NB                          WOQ8NB
     I              EYQ9NB                          WOQ9NB
     I              EYBKC7                          WOBKC7
     I              EYUVST                          WOUVST
     I              EYUWST                          WOUWST
     I              EYUXST                          WOUXST
     I              EYAATM                          WOAATM
     I              EYAYNA                          WOAYNA
     I              EYA0NA                          WOA0NA
     I              EYAXDT                          WOAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WRAIC3
     I              BEC4NB                          WRC4NB
     I              BEJNCD                          WRJNCD
     I              BEANC7                          WRANC7
     I              BEBKC7                          WRBKC7
     I              BEBRTX                          WRBRTX
     I              BEHMNA                          WRHMNA
     I              BEHONA                          WRHONA
     I              BEHPNA                          WRHPNA
     I              BEHNNA                          WRHNNA
     I              BEDBCD                          WRDBCD
     I              BECKTX                          WRCKTX
     I              BEB0C7                          WRB0C7
     I              BEAETX                          WRAETX
     I              BEB1NA                          WRB1NA
     I              BEB3NA                          WRB3NA
     I              BEB4NA                          WRB4NA
     I              BEB2NA                          WRB2NA
     I              BEBHCD                          WRBHCD
     I              BEC8TX                          WRC8TX
     I              BEBCNA                          WRBCNA
     I              BEA0DT                          WRA0DT
     I              BEA5DT                          WRA5DT
     I              BEGNDT                          WRGNDT
     I              BEACDT                          WRACDT
     I              BEAQCD                          WRAQCD
     I              BEB6NA                          WRB6NA
     I              BEBYNA                          WRBYNA
     I              BEBZNA                          WRBZNA
     I              BEGTST                          WRGTST
     I              BEGVST                          WRGVST
     I              BEGUST                          WRGUST
     I              BEQFST                          WRQFST
     I              BECQCD                          WRCQCD
     I              BEGJST                          WRGJST
     I              BEGWST                          WRGWST
     I              BEGXST                          WRGXST
     I              BEGYST                          WRGYST
     I              BEAODT                          WRAODT
     I              BEAIVN                          WRAIVN
     I              BECXDT                          WRCXDT
     I              BEJZVA                          WRJZVA
     I              BEA1WG                          WRA1WG
     I              BEXIST                          WRXIST
     I              BEXJST                          WRXJST
     I              BEXKST                          WRXKST
     I              BEEIDT                          WREIDT
     I              BEAFTM                          WRAFTM
     I              BEE8CD                          WRE8CD
     I              BEE9CD                          WRE9CD
     I              BERMNB                          WRRMNB
     I              BETBNB                          WRTBNB
     I              BER1NB                          WRR1NB
     I              BEPJST                          WRPJST
     I              BEU0ST                          WRU0ST
     I              BEU1ST                          WRU1ST
     I              BEQ2CD                          WRQ2CD
     I              BEU2ST                          WRU2ST
     I              BEVEST                          WRVEST
     I              BEVFST                          WRVFST
     I              BEVGST                          WRVGST
     I              BERPCD                          WRRPCD
     I              BERNNB                          WRRNNB
     I              BEVDST                          WRVDST
     I              BEATIN                          WRATIN
     I              BEU4ST                          WRU4ST
     I              BEU5ST                          WRU5ST
     I              BERSRN                          WRRSRN
     I              BEMHNA                          WRMHNA
     I              BEMINA                          WRMINA
     I              BEWBST                          WRWBST
     I              BER4CD                          WRR4CD
     I              BEBFCD                          WRBFCD
     I              BEQ4CD                          WRQ4CD
     I              BET3NB                          WRT3NB
     I              BESICD                          WRSICD
     I              BECONB                          WRCONB
     I              BECEST                          WRCEST
     I              BEAWDT                          WRAWDT
     I              BEJPCD                          WRJPCD
     I              BEXUST                          WRXUST
     I              BEZ1ST                          WRZ1ST
     I              BEVRVA                          WRVRVA
     I              BEOBST                          WROBST
     I              BEBCST                          WRBCST
     I              BEBDST                          WRBDST
     I              BEB7VL                          WRB7VL
     I              BEGASX                          WRGASX
     I              BEGBSX                          WRGBSX
     I              BEGCSX                          WRGCSX
     I              BEGDSX                          WRGDSX
     I              BEFNSX                          WRFNSX
     I              BEFOSX                          WRFOSX
     I              BEFPSX                          WRFPSX
     I              BEFQSX                          WRFQSX
     I              BEFRSX                          WRFRSX
     I              BEFSSX                          WRFSSX
     I              BEFTSX                          WRFTSX
     I              BEFUSX                          WRFUSX
     I              BEFVSX                          WRFVSX
     I              BEFWSX                          WRFWSX
     I              BEFXSX                          WRFXSX
     I              BEFYSX                          WRFYSX
     I              BENODT                          WRNODT
     I              BENPDT                          WRNPDT
     I              BENQDT                          WRNQDT
     I              BENRDT                          WRNRDT
     I              BENSDT                          WRNSDT
     I              BEBPTM                          WRBPTM
     I              BEBQTM                          WRBQTM
     I              BEBRTM                          WRBRTM
     I              BEBSTM                          WRBSTM
     I              BEBTTM                          WRBTTM
     I              BEH0NX                          WRH0NX
     I              BEH1NX                          WRH1NX
     I              BEH2NX                          WRH2NX
     I              BEH3NX                          WRH3NX
     I              BEH4NX                          WRH4NX
     I              BEC0C7                          WRC0C7
     I              BEUVST                          WRUVST
     I              BEUWST                          WRUWST
     I              BEUXST                          WRUXST
     I              BEAATM                          WRAATM
     I              BEAYNA                          WRAYNA
     I              BEA0NA                          WRA0NA
     I              BEAXDT                          WRAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFN1    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WIAIC3
     I              FNC4NB                          WIC4NB
     I              FNDPNB                          WIDPNB
     I              FNUENB                          WIUENB
     I              FNRZNB                          WIRZNB
     I              FNFOQT                          WIFOQT
     I              FNR0NB                          WIR0NB
     I              FNPMST                          WIPMST
     I              FNK7DT                          WIK7DT
     I              FNPFNX                          WIPFNX
     I              FNHGCD                          WIHGCD
     I              FNAJCD                          WIAJCD
     I              FNELDT                          WIELDT
     I              FNN5WG                          WIN5WG
     I              FNRZNA                          WIRZNA
     I              FNH5NY                          WIH5NY
     I              FNH6NY                          WIH6NY
     I              FNH7NY                          WIH7NY
     I              FNGBTX                          WIGBTX
     I              FNN6WG                          WIN6WG
     I              FNN7WG                          WIN7WG
     I              FNGCTX                          WIGCTX
     I              FNGDTX                          WIGDTX
     I              FNRBDT                          WIRBDT
     I              FNITNY                          WIITNY
     I              FNIVNY                          WIIVNY
     I              FNIUNY                          WIIUNY
     I              FNIWNY                          WIIWNY
     I              FNIXNY                          WIIXNY
     I              FNIYNY                          WIIYNY
     I              FNUVST                          WIUVST
     I              FNUWST                          WIUWST
     I              FNUXST                          WIUXST
     I              FNVSST                          WIVSST
     I              FNAATM                          WIAATM
     I              FNAYNA                          WIAYNA
     I              FNA0NA                          WIA0NA
     I              FNAXDT                          WIAXDT
      *
     IQPPBM1    E DSPPBMCPL0
      * UPD : PFS Ship Order Detail     Update index
      * Renamed input format fields
     I              BMY1NX                          WLY1NX
     I              BMAID8                          WLAID8
     I              BMAFTS                          WLAFTS
     I              BMBCNY                          WLBCNY
     I              BMZPNX                          WLZPNX
     I              BMZXNX                          WLZXNX
     I              BMZYNX                          WLZYNX
     I              BMY2NX                          WLY2NX
     I              BMAFD8                          WLAFD8
     I              BMAUNY                          WLAUNY
     I              BMAVNY                          WLAVNY
     I              BMVVSX                          WLVVSX
     I              BMUWSX                          WLUWSX
     I              BMUXSX                          WLUXSX
     I              BMV3SX                          WLV3SX
     I              BMAHNY                          WLAHNY
     I              BMAINY                          WLAINY
     I              BMAJNY                          WLAJNY
     I              BMAKNY                          WLAKNY
      *
     IYBRDCS      DS                            101
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WOAIC3
     I              EYC4NB                          WOC4NB
     I              EYQ2NB                          WOQ2NB
     I              EYJPCD                          WOJPCD
     I              EYAUC3                          WOAUC3
     I              EYQ7NB                          WOQ7NB
     I              EYOMST                          WOOMST
     I              EYD2DT                          WOD2DT
     I              EYONST                          WOONST
     I              EYOOST                          WOOOST
     I              EYOPST                          WOOPST
     I              EYAWC3                          WOAWC3
     I              EYQ8NB                          WOQ8NB
     I              EYQ9NB                          WOQ9NB
     I              EYBKC7                          WOBKC7
     I              EYUVST                          WOUVST
     I              EYUWST                          WOUWST
     I              EYUXST                          WOUXST
     I              EYAATM                          WOAATM
     I              EYAYNA                          WOAYNA
     I              EYA0NA                          WOA0NA
     I              EYAXDT                          WOAXDT
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WRAIC3
     I              BEC4NB                          WRC4NB
     I              BEJNCD                          WRJNCD
     I              BEANC7                          WRANC7
     I              BEBKC7                          WRBKC7
     I              BEBRTX                          WRBRTX
     I              BEHMNA                          WRHMNA
     I              BEHONA                          WRHONA
     I              BEHPNA                          WRHPNA
     I              BEHNNA                          WRHNNA
     I              BEDBCD                          WRDBCD
     I              BECKTX                          WRCKTX
     I              BEB0C7                          WRB0C7
     I              BEAETX                          WRAETX
     I              BEB1NA                          WRB1NA
     I              BEB3NA                          WRB3NA
     I              BEB4NA                          WRB4NA
     I              BEB2NA                          WRB2NA
     I              BEBHCD                          WRBHCD
     I              BEC8TX                          WRC8TX
     I              BEBCNA                          WRBCNA
     I              BEA0DT                          WRA0DT
     I              BEA5DT                          WRA5DT
     I              BEGNDT                          WRGNDT
     I              BEACDT                          WRACDT
     I              BEAQCD                          WRAQCD
     I              BEB6NA                          WRB6NA
     I              BEBYNA                          WRBYNA
     I              BEBZNA                          WRBZNA
     I              BEGTST                          WRGTST
     I              BEGVST                          WRGVST
     I              BEGUST                          WRGUST
     I              BEQFST                          WRQFST
     I              BECQCD                          WRCQCD
     I              BEGJST                          WRGJST
     I              BEGWST                          WRGWST
     I              BEGXST                          WRGXST
     I              BEGYST                          WRGYST
     I              BEAODT                          WRAODT
     I              BEAIVN                          WRAIVN
     I              BECXDT                          WRCXDT
     I              BEJZVA                          WRJZVA
     I              BEA1WG                          WRA1WG
     I              BEXIST                          WRXIST
     I              BEXJST                          WRXJST
     I              BEXKST                          WRXKST
     I              BEEIDT                          WREIDT
     I              BEAFTM                          WRAFTM
     I              BEE8CD                          WRE8CD
     I              BEE9CD                          WRE9CD
     I              BERMNB                          WRRMNB
     I              BETBNB                          WRTBNB
     I              BER1NB                          WRR1NB
     I              BEPJST                          WRPJST
     I              BEU0ST                          WRU0ST
     I              BEU1ST                          WRU1ST
     I              BEQ2CD                          WRQ2CD
     I              BEU2ST                          WRU2ST
     I              BEVEST                          WRVEST
     I              BEVFST                          WRVFST
     I              BEVGST                          WRVGST
     I              BERPCD                          WRRPCD
     I              BERNNB                          WRRNNB
     I              BEVDST                          WRVDST
     I              BEATIN                          WRATIN
     I              BEU4ST                          WRU4ST
     I              BEU5ST                          WRU5ST
     I              BERSRN                          WRRSRN
     I              BEMHNA                          WRMHNA
     I              BEMINA                          WRMINA
     I              BEWBST                          WRWBST
     I              BER4CD                          WRR4CD
     I              BEBFCD                          WRBFCD
     I              BEQ4CD                          WRQ4CD
     I              BET3NB                          WRT3NB
     I              BESICD                          WRSICD
     I              BECONB                          WRCONB
     I              BECEST                          WRCEST
     I              BEAWDT                          WRAWDT
     I              BEJPCD                          WRJPCD
     I              BEXUST                          WRXUST
     I              BEZ1ST                          WRZ1ST
     I              BEVRVA                          WRVRVA
     I              BEOBST                          WROBST
     I              BEBCST                          WRBCST
     I              BEBDST                          WRBDST
     I              BEB7VL                          WRB7VL
     I              BEGASX                          WRGASX
     I              BEGBSX                          WRGBSX
     I              BEGCSX                          WRGCSX
     I              BEGDSX                          WRGDSX
     I              BEFNSX                          WRFNSX
     I              BEFOSX                          WRFOSX
     I              BEFPSX                          WRFPSX
     I              BEFQSX                          WRFQSX
     I              BEFRSX                          WRFRSX
     I              BEFSSX                          WRFSSX
     I              BEFTSX                          WRFTSX
     I              BEFUSX                          WRFUSX
     I              BEFVSX                          WRFVSX
     I              BEFWSX                          WRFWSX
     I              BEFXSX                          WRFXSX
     I              BEFYSX                          WRFYSX
     I              BENODT                          WRNODT
     I              BENPDT                          WRNPDT
     I              BENQDT                          WRNQDT
     I              BENRDT                          WRNRDT
     I              BENSDT                          WRNSDT
     I              BEBPTM                          WRBPTM
     I              BEBQTM                          WRBQTM
     I              BEBRTM                          WRBRTM
     I              BEBSTM                          WRBSTM
     I              BEBTTM                          WRBTTM
     I              BEH0NX                          WRH0NX
     I              BEH1NX                          WRH1NX
     I              BEH2NX                          WRH2NX
     I              BEH3NX                          WRH3NX
     I              BEH4NX                          WRH4NX
     I              BEC0C7                          WRC0C7
     I              BEUVST                          WRUVST
     I              BEUWST                          WRUWST
     I              BEUXST                          WRUXST
     I              BEAATM                          WRAATM
     I              BEAYNA                          WRAYNA
     I              BEA0NA                          WRA0NA
     I              BEAXDT                          WRAXDT
      *
     IYCRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PFS Ship Order Detail
      * I :  PFS Company Number
     I                                        1   30P1Y1NX
      * I :  PFS Order Number
     I                                        4  100P1ZPNX
     IP2PARM      DS
      * B :  Error Status
     I                                        1   1 P2ECST
     IP3PARM      DS
      * I :  Close Order PrePass STS
     I                                        1   2 P3X9SX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Min Max Weight Error Noti'
      * Load ID
     I                                    P   1   40ZA0001
      * Order Number
     I                                        5  11 ZA0002
      * Item Code
     I                                       12  18 ZA0003
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1Y1NX    PARM           WP0001  30       PFS Company Num
     C           P1ZPNX    PARM           WP0002  70       PFS Order Numbe
     C           P2ECST    PARM P2ECST    WP0003  1        Error Status
     C           P3X9SX    PARM           WP0004  2        Close Order Pre
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Ship Order Detail XF
      * PFS Ship Order Detail RT - PFS Ship Order Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PFS Ship Order Detail RT - PFS Ship Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0002  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0003  30       Company Number
     C                     Z-ADD*ZERO     WN0004  70       Order Number
     C                     Z-ADD*ZERO     WN0005  30       Order Sequence
     C                     Z-ADD*ZERO     WN0006  30       Order Secondary
     C                     Z-ADD*ZERO     WN0007  70       Item Code
     C                     Z-ADD*ZERO     WN0008  70       Ship To Custome
     C                     MOVEL*BLANK    WN0009  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0010 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0011 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0012 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0013 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0014  70       Actual Shipped
     C                     MOVEL*BLANK    WN0015  3        Reason Code
     C                     MOVEL*BLANK    WN0016  2        Order Type - Sa
     C                     MOVEL*BLANK    WN0017  3        Carrier Code
     C                     MOVEL*BLANK    WN0018  1        Header Status
     C                     Z-ADD*ZERO     WN0019  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0020 112       Order Weight To
     C                     Z-ADD*ZERO     WN0021  70       Load ID
     C                     MOVEL*BLANK    WN0022  2        Event Code
     C                     MOVEL*BLANK    WN0023  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0024  1        Billing Activit
     C                     Z-ADD*ZERO     WN0025 112       Weight Display
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
     C                     Z-ADD*ZERO     WN0003           Company Number
     C                     Z-ADD*ZERO     WN0004           Order Number
     C                     Z-ADD*ZERO     WN0005           Order Sequence
     C                     Z-ADD*ZERO     WN0006           Order Secondary
     C                     Z-ADD*ZERO     WN0007           Item Code
     C                     Z-ADD*ZERO     WN0008           Ship To Custome
     C                     MOVEL*BLANK    WN0009           Detail Line Sta
     C                     Z-ADD*ZERO     WN0010           Quantity Schedu
     C                     Z-ADD*ZERO     WN0011           Weight Schedule
     C                     Z-ADD*ZERO     WN0012           Quantity Shippe
     C                     Z-ADD*ZERO     WN0013           Weight Shipped
     C                     Z-ADD*ZERO     WN0014           Actual Shipped
     C                     MOVEL*BLANK    WN0015           Reason Code
     C                     MOVEL*BLANK    WN0016           Order Type - Sa
     C                     MOVEL*BLANK    WN0017           Carrier Code
     C                     MOVEL*BLANK    WN0018           Header Status
     C                     Z-ADD*ZERO     WN0019           Scheduled Ship
     C                     Z-ADD*ZERO     WN0020           Order Weight To
     C                     Z-ADD*ZERO     WN0021           Load ID
     C                     MOVEL*BLANK    WN0022           Event Code
     C                     MOVEL*BLANK    WN0023           Trans Contol AS
     C                     MOVEL*BLANK    WN0024           Billing Activit
     C                     MOVEL*BLANK    P2ECST           Error Status
     C                     Z-ADD*ZERO     WN0025           Weight Display
     C                     Z-ADDP1Y1NX    WN0003           Company Number
     C                     Z-ADDP1ZPNX    WN0004           Order Number
     C                     MOVEL'N'       P2ECST           Error Status
      * RTV Order Info PFS    RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAY1NX    WQSA01           PFS Company Num
     C           *LIKE     DEFN WAZPNX    WQSA02           PFS Order Numbe
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           PFS Company Num
     C                     KFLD           WQSA02           PFS Order Numbe
      * Setup key
     C                     Z-ADDP1Y1NX    WQSA01           PFS Company Num
     C                     Z-ADDP1ZPNX    WQSA02           PFS Order Numbe
      * Establish starting position
     C           KRSSA     SETLL@BMCPDE                    *
     C           KRSSA     READE@BMCPDE                  90*
      * Data record not found
     C   90                MOVEL'USR3508' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADDWAUXSX    WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
      * VALIDATE
     C                     EXSR UASUBR                     VALIDATE
      * PROCESS:  Selected Record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : PAR.Close Order PrePass STS is Post
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           P3X9SX    IFEQ 'PS'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'R'       WN0009           Detail Line Sta
      * PFS Upd Order Detail  RT - Order Detail  * 
     C                     EXSR SERVGN
      * VAL:  Average Shipped Weight
      * CASE: PAR.Quantity Shipped Total is not equal zero
     C           WN0012    IFNE 0                          *IF
     C           WN0013    DIV  WN0012    WN0025           Weight Display
      * RTV Qty Min/Max        RT - Company Item  * 
     C                     EXSR SKRVGN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Weight Display 1 LT LCL.Minimum Weight Per Case
      *   |- c2    : PAR.Weight Display 1 GT LCL.Maximum Weight Per Case
      *   '-
     C           WN0025    IFLT YL0005                     *IF
     C           WN0025    ORGT YL0006                     *OR
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVELYL0007    WUCLAA           DL List ID
      * Setup message data for message
     C                     Z-ADDWN0021    ZA0001           Load ID
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WN0004    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWN0004    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0002           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0002           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WN0007    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWN0007    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
      * Retrieve message Min Max Weight Error Noti
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3287' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0008    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM WUCLAA    WQ0001 10        DL List ID
     C                     PARM YL0008    WQ0002132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
      * CASE: PAR.Close Order PrePass STS is Pre-Pass
     C           P3X9SX    IFEQ 'PP'                       *IF
     C                     Z-ADD0         WN0001           PFS Process Sta
     C                     END                             *FI
      * Chg PrcSts/ErrRsn     CH - PFS Ship Order Detail  * 
     C                     EXSR SMCHRC
     C           KRSSA     READE@BMCPDE                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Error Status is no
      *   |- c2    : PAR.Close Order PrePass STS is Post
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2ECST    IFEQ 'N'                        *IF
     C           P3X9SX    IFEQ 'PS'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD0         WUQ2NB           Event Number
      * RTV Next Event Number  RT - Order Events  * 
     C                     EXSR SNRVGN
     C                     ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - Order Events  * 
     C                     EXSR SOCRRC
      * CHG Ord Event & Stat.  CH - Order Header TRG  * 
     C                     EXSR SPCHRC
      * ADD Ready to Confirm   XF - Order Detail  * 
     C                     CALL 'PDN2XFR'              90  ADD Ready to Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0003  30       Company Number
     C                     PARM WN0004    WQ0004  70       Order Number
     C                     PARM WN0014    WQ0005  70       Actual Shipped
     C           YL0010    PARM YL0010    WQ0006  1        Access Denied (
     C                     PARM WN0019    WQ0007  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Order Info PFS    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0003    WBAIC3           Company Number
     C                     Z-ADDWN0004    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJNCD    WN0016           Order Type - Sa
     C                     Z-ADDWBBKC7    WN0008           Ship To Custome
     C                     MOVELWBBZNA    WN0017           Carrier Code
     C                     MOVELWBGWST    WN0018           Header Status
     C                     Z-ADDWBAODT    WN0019           Scheduled Ship
     C                     Z-ADDWBRMNB    WN0021           Load ID
     C                     MOVELWBJPCD    WN0022           Event Code
     C                     MOVELWBXUST    WN0023           Trans Contol AS
     C                     MOVELWBOBST    WN0024           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Qty/Wgt Ord/Sched RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Setup key
     C                     Z-ADDWN0003    WCAIC3           Company Number
     C                     Z-ADDWN0004    WCC4NB           Order Number
     C                     Z-ADDWN0005    WCDPNB           Order Sequence
     C                     Z-ADDWN0006    WCUENB           Order Secondary
      * Establish starting position
     C           KRSSC     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0009           Detail Line Sta
     C                     Z-ADD*ZERO     WN0010           Quantity Schedu
     C                     Z-ADD*ZERO     WN0011           Weight Schedule
     C                     MOVEL*BLANK    YL0001           Record Found US
     C                     MOVEL'N'       YL0001           Record Found US
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCGMST    WN0009           Detail Line Sta
     C                     Z-ADDWCCCQT    WN0010           Quantity Schedu
     C                     Z-ADDWCAUWG    WN0011           Weight Schedule
     C                     MOVEL'Y'       YL0001           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * PFS Rtv Total Shipped RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Quantity Shippe
     C                     Z-ADD*ZERO     WL0006           Weight Shipped
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSD02           Order Number
     C           *LIKE     DEFN WDDPNB    WQSD03           Order Sequence
     C           *LIKE     DEFN WDUENB    WQSD04           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Order Sequence
     C                     KFLD           WQSD04           Order Secondary
      * Setup key
     C                     Z-ADDWL0001    WQSD01           Company Number
     C                     Z-ADDWL0002    WQSD02           Order Number
     C                     Z-ADDWL0003    WQSD03           Order Sequence
     C                     Z-ADDWL0004    WQSD04           Order Secondary
      * Establish starting position
     C           KRSSD     SETLL@FNCPCT                    *
     C           KRSSD     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WDFOQT    WL0005           Quantity Shippe
     C                     ADD  WDR0NB    WL0006           Weight Shipped
     C           KRSSD     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * PFS Upd Order Detail  RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0035  1        Work Confirm St
     C                     MOVEL*BLANK    WN0036  1        Work Over/Short
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Setup key
     C                     Z-ADDWN0003    WCAIC3           Company Number
     C                     Z-ADDWN0004    WCC4NB           Order Number
     C                     Z-ADDWN0005    WCDPNB           Order Sequence
     C                     Z-ADDWN0006    WCUENB           Order Secondary
      * Establish starting position
     C           KRSSE     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'C'
     C           WCGMST    OREQ 'R'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCGMST    OREQ 'I'
     C                     Z-ADDWCBKC7    WN0008           Ship To Custome
     C                     MOVEL*BLANK    WN0036           Work Over/Short
      * INIT:  Work Over/Short Reason
      * CASE: DB1.Quantity Scheduled LT PAR.Quantity Shipped Total
     C           WCCCQT    IFLT WN0012                     *IF
     C                     MOVEL'O'       WN0036           Work Over/Short
     C                     ELSE
      * CASE: DB1.Quantity Scheduled GT PAR.Quantity Shipped Total
     C           WCCCQT    IFGT WN0012                     *IF
     C                     MOVEL'S'       WN0036           Work Over/Short
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'P'       WN0035           Work Confirm St
      * PFS Chg Order Detail  CH - Order Detail  * 
     C                     EXSR SFCHRC
      * CASE: PAR.Quantity Shipped Total is Equal to zero
     C           WN0012    IFEQ 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0156  50       Case Sequence N
     C                     MOVEL*BLANK    WN0157  1        Inventory Updat
     C                     Z-ADD*ZERO     WN0158  70       Label Date
     C                     Z-ADD*ZERO     WN0159  80       PT Serial Numbe
     C                     Z-ADD*ZERO     WN0160 112       Manifest Net We
     C                     MOVEL*BLANK    WN0161  1        EDI Status 1
     C                     MOVEL*BLANK    WN0162  1        EDI Status 2
     C                     MOVEL*BLANK    WN0163  1        EDI Status 3
     C                     MOVEL*BLANK    WN0164  1        Record Status
     C                     Z-ADD*ZERO     WN0165  60       Job Time
     C                     MOVEL*BLANK    WN0166 10        User Id
     C                     MOVEL*BLANK    WN0167 10        Job Name
     C                     Z-ADD*ZERO     WN0168  70       Job Date
      *
      * Crt Manifest Detail   IF
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0007           Company Number
     C                     Z-ADDWCC4NB    WL0008           Order Number
     C                     Z-ADDWCDPNB    WL0009           Order Sequence
     C                     Z-ADDWCUENB    WL0010           Order Secondary
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0011    WN0156           Case Sequence N
      * CASE: PAR.Production Date is entered
     C           0         IFNE 0                          *IF
      * RTV Label Date         RT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0012           Company Number
     C                     Z-ADDWCHGCD    WL0013           Item Code
     C                     MOVELWCAJCD    WL0014    P      Warehouse Code
     C                     Z-ADD0         WL0015           Production Date
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    WN0158           Label Date
     C                     END                             *FI
      * R11974 DN 10/31/17-Calc/Update Net Weight in Kg for Seaboard Orga
      * CASE: *OTHERWISE
      * NOTE: Incoming Case Weight can be zero.
     C                     Z-ADD0         WN0160           Manifest Net We
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0017           Company Number
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0018    YN0008    P      Plant Company S
     C                     MOVELWL0019    YL0002    P      Company Organiz
      * CASE: LCL.Company Organization is Seaboard
     C           YL0002    IFEQ 'S'                        *IF
      * CASE: PAR.Case Weight is NE *ZERO
     C           0         IFNE 0                          *IF
      * Clc Weight to Kilogram IF
      * Round Case Weight to 1 Decimal Place.
      * RMC 10/14/19 increase precision - DO NOT DO THIS  10/16/19 PER AA
     C           0         MULT .45359    YL0003           Net Weight Kg U
     C           YL0003    MULT 1         YL0004    H      Net Weight Kilo
     C                     Z-ADDYL0004    WN0160           Manifest Net We
     C                     END                             *FI
     C                     END                             *FI
      * R11974 DN 10/31/17-Set Manifest Net Weight - Kg.
      * Crt Manifest Detail   CR - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0020           Company Number
     C                     Z-ADDWCC4NB    WL0021           Order Number
     C                     Z-ADDWCDPNB    WL0022           Order Sequence
     C                     Z-ADDWCUENB    WL0023           Order Secondary
     C                     Z-ADDWN0156    WL0024           Case Sequence N
     C                     Z-ADD0         WL0025           Case Quantity
     C                     Z-ADD0         WL0026           Case Weight
     C                     MOVELWN0157    WL0027    P      Inventory Updat
     C                     Z-ADDWN0158    WL0028           Label Date
     C                     Z-ADDWN0159    WL0029           PT Serial Numbe
     C                     Z-ADDWCHGCD    WL0030           Item Code
     C                     MOVELWCAJCD    WL0031    P      Warehouse Code
     C                     Z-ADD0         WL0032           Production Date
     C                     Z-ADD0         WL0033           Manifest Gross
     C                     MOVEL*BLANK    WL0034           Manifest Lot ID
     C                     Z-ADD0         WL0035           Manifest Total
     C                     Z-ADD0         WL0036           Manifest Co-Par
     C                     Z-ADD0         WL0037           Manifest Pallet
     C                     MOVELWUGBTX    WL0038    P      Manifest Shift
     C                     Z-ADD0         WL0039           HPB Meter Net G
     C                     Z-ADDWN0160    WL0040           Manifest Net We
     C                     MOVELWUGCTX    WL0041    P      Manifest Unused
     C                     MOVELWUGDTX    WL0042    P      Manifest Unused
     C                     Z-ADD0         WL0043           Manifest Unused
     C                     Z-ADD0         WL0044           HPB COA Batch N
     C                     Z-ADD0         WL0045           HPB Meter Start
     C                     Z-ADD0         WL0046           HPB Meter Endin
     C                     Z-ADD0         WL0047           HPB Meter Total
     C                     Z-ADD0         WL0048           HPB Meter Net W
     C                     Z-ADD0         WL0049           HPB Density Ref
     C                     MOVELWN0161    WL0050    P      EDI Status 1
     C                     MOVELWN0162    WL0051    P      EDI Status 2
     C                     MOVELWN0163    WL0052    P      EDI Status 3
     C                     MOVELWN0164    WL0053    P      Record Status
     C                     Z-ADDWN0165    WL0054           Job Time
     C                     MOVELWN0166    WL0055    P      User Id
     C                     MOVELWN0167    WL0056    P      Job Name
     C                     Z-ADDWN0168    WL0057           Job Date
     C                     EXSR SJCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * PFS Chg Order Detail  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0037  70       Item Code
     C                     MOVEL*BLANK    WN0038  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0039  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0040  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0041 112       Billing Detail
     C                     Z-ADD*ZERO     WN0042 112       Billing Detail
     C                     Z-ADD*ZERO     WN0043 112       Billing Detail
     C                     Z-ADD*ZERO     WN0044 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0045  1        Comment Print A
     C                     MOVEL*BLANK    WN0046  1        Comment Print I
     C                     MOVEL*BLANK    WN0047  1        Comment Print P
     C                     MOVEL*BLANK    WN0048  1        Comment Print S
     C                     Z-ADD*ZERO     WN0049 112       Extended Amount
     C                     Z-ADD*ZERO     WN0050  70       Market Pricing
     C                     MOVEL*BLANK    WN0051  3        Commodity Marke
     C                     MOVEL*BLANK    WN0052  3        Date Method Cod
     C                     MOVEL*BLANK    WN0053  3        Price Method Co
     C                     Z-ADD*ZERO     WN0054 114       Price Overage O
     C                     Z-ADD*ZERO     WN0055  70       Contract Number
     C                     MOVEL*BLANK    WN0056  1        Price Status
     C                     Z-ADD*ZERO     WN0057  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0058  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0059  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0060  1        OD Production P
     C                     MOVEL*BLANK    WN0061 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0062 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0063  1        Age Code
     C                     MOVEL*BLANK    WN0064  1        Palletize
     C                     MOVEL*BLANK    WN0065  1        Slip Sheet
     C                     MOVEL*BLANK    WN0066  1        Catch Weight St
     C                     MOVEL*BLANK    WN0067  1        Price Audit
     C                     MOVEL*BLANK    WN0068  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0069  1        Production Date
     C                     Z-ADD*ZERO     WN0070 112       Rated Freight
     C                     Z-ADD*ZERO     WN0071 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0072 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0073 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0074 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0075 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0076 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0077 114       Unit Price
     C                     Z-ADD*ZERO     WN0078 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0079 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0080 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0081 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0082  70       Requested Ship
     C                     Z-ADD*ZERO     WN0083  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0084  1        Affect Inventor
     C                     MOVEL*BLANK    WN0085  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0086  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0087  30       Item Structure
     C                     Z-ADD*ZERO     WN0088  30       Item Structure
     C                     Z-ADD*ZERO     WN0089  30       Item Structure
     C                     MOVEL*BLANK    WN0090  2        Item Level
     C                     MOVEL*BLANK    WN0091  2        Quality Level
     C                     MOVEL*BLANK    WN0092  2        Pricing Product
     C                     MOVEL*BLANK    WN0093  2        Season Product
     C                     Z-ADD*ZERO     WN0094  70       Date of Origina
     C                     MOVEL*BLANK    WN0095 10        User Profile Na
     C                     MOVEL*BLANK    WN0096  6        Country Code
     C                     MOVEL*BLANK    WN0097  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0098  1        Modified Flag
     C                     MOVEL*BLANK    WN0099  1        Substituted Fla
     C                     MOVEL*BLANK    WN0100  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0101 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0102 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0103  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0104  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0105  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0106  1        Affect Commissi
     C                     MOVEL*BLANK    WN0107  1        Affect Pricing
     C                     MOVEL*BLANK    WN0108  1        Released by Use
     C                     MOVEL*BLANK    WN0109  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0110  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0111  3        Production Ware
     C                     MOVEL*BLANK    WN0112  3        OD Price Type
     C                     Z-ADD*ZERO     WN0113  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0114  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0115  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0116  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0117  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0118  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0119  60       Price Code
     C                     Z-ADD*ZERO     WN0120  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0121  60       Substitution Li
     C                     Z-ADD*ZERO     WN0122  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0123 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0124 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0125 112       OD Item Target
     C                     Z-ADD*ZERO     WN0126 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0127 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0128 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0129 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0130 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0131 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0132 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0133 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0134 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0135 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0136  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0137  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0138  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0139 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0140  40       Item Age Days
     C                     Z-ADD*ZERO     WN0141  70       Production Ovr
     C                     Z-ADD*ZERO     WN0142  70       Production Ovr
     C                     MOVEL*BLANK    WN0143  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0144  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0145  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0146  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0147  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0148  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0149  1        EDI Status 1
     C                     MOVEL*BLANK    WN0150  1        EDI Status 2
     C                     MOVEL*BLANK    WN0151  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0152  60       Job Time
     C                     MOVEL*BLANK    WN0153 10        User Id
     C                     MOVEL*BLANK    WN0154 10        Job Name
     C                     Z-ADD*ZERO     WN0155  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     Z-ADDWCC4NB    WEC4NB           Order Number
     C                     Z-ADDWCDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWCUENB    WEUENB           Order Secondary
      *
     C           KLCHSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHSF    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWN0009    WEGMST    P      Detail Line Sta
     C                     MOVELWCGNST    WEGNST    P      Detail Line Sta
     C                     MOVELWN0035    WERZST    P      Work Confirm St
     C                     MOVELWN0036    WER0ST    P      Work Over/Short
     C                     Z-ADDWN0012    WECBQT           Quantity Shippe
     C                     Z-ADDWN0013    WEATWG           Weight Shipped
     C                     Z-ADDWN0014    WEGNDT           Actual Shipped
     C                     MOVEL'04'      WEJPCD    P      Event Code
     C                     MOVELWN0015    WECQCD    P      Reason Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSG02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSG03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSG04           Order Secondary
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WQSG03           Order Sequence
     C                     KFLD           WQSG04           Order Secondary
      * Setup key
     C                     Z-ADDWL0007    WQSG01           Company Number
     C                     Z-ADDWL0008    WQSG02           Order Number
     C                     Z-ADDWL0009    WQSG03           Order Sequence
     C                     Z-ADDWL0010    WQSG04           Order Secondary
      * Establish starting position
     C           KRSSG     SETLL@FNCPUW                    *
     C           KRSSG     READE@FNCPUW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0011           Case Sequence N
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WFRZNB    ADD  1         WL0011           Case Sequence N
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@FNCPUW                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
      * Setup key
     C                     Z-ADDWL0012    WGAIC3           Company Number
     C                     Z-ADDWL0013    WGHGCD           Item Code
     C                     MOVELWL0014    WGAJCD           Warehouse Code
     C                     Z-ADDWL0015    WGELDT           Production Date
      * Establish starting position
     C           KRSSH     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGK7DT    WL0016           Label Date
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0017    WHAIC3           Company Number
      * Establish starting position
     C           KRSSI     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0018           Plant Company S
     C                     MOVEL*BLANK    WL0019           Company Organiz
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHYISX    WL0018           Plant Company S
     C                     MOVELWHYJSX    WL0019           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Manifest Detail   CR - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FNCPCS
     C                     Z-ADDWL0020    WIAIC3           Company Number
     C                     Z-ADDWL0021    WIC4NB           Order Number
     C                     Z-ADDWL0022    WIDPNB           Order Sequence
     C                     Z-ADDWL0023    WIUENB           Order Secondary
     C                     Z-ADDWL0024    WIRZNB           Case Sequence N
     C                     Z-ADDWL0025    WIFOQT           Case Quantity
     C                     Z-ADDWL0026    WIR0NB           Case Weight
     C                     MOVELWL0027    WIPMST           Inventory Updat
     C                     Z-ADDWL0028    WIK7DT           Label Date
     C                     Z-ADDWL0029    WIPFNX           PT Serial Numbe
     C                     Z-ADDWL0030    WIHGCD           Item Code
     C                     MOVELWL0031    WIAJCD           Warehouse Code
     C                     Z-ADDWL0032    WIELDT           Production Date
     C                     Z-ADDWL0033    WIN5WG           Manifest Gross
     C                     MOVELWL0034    WIRZNA           Manifest Lot ID
     C                     Z-ADDWL0035    WIH5NY           Manifest Total
     C                     Z-ADDWL0036    WIH6NY           Manifest Co-Par
     C                     Z-ADDWL0037    WIH7NY           Manifest Pallet
     C                     MOVELWL0038    WIGBTX           Manifest Shift
     C                     Z-ADDWL0039    WIN6WG           HPB Meter Net G
     C                     Z-ADDWL0040    WIN7WG           Manifest Net We
     C                     MOVELWL0041    WIGCTX           Manifest Unused
     C                     MOVELWL0042    WIGDTX           Manifest Unused
     C                     Z-ADDWL0043    WIRBDT           Manifest Unused
     C                     Z-ADDWL0044    WIITNY           HPB COA Batch N
     C                     Z-ADDWL0045    WIIVNY           HPB Meter Start
     C                     Z-ADDWL0046    WIIUNY           HPB Meter Endin
     C                     Z-ADDWL0047    WIIWNY           HPB Meter Total
     C                     Z-ADDWL0048    WIIXNY           HPB Meter Net W
     C                     Z-ADDWL0049    WIIYNY           HPB Density Ref
     C                     MOVELWL0050    WIUVST           EDI Status 1
     C                     MOVELWL0051    WIUWST           EDI Status 2
     C                     MOVELWL0052    WIUXST           EDI Status 3
     C                     MOVELWL0053    WIVSST           Record Status
     C                     Z-ADDWL0054    WIAATM           Job Time
     C                     MOVELWL0055    WIAYNA           User Id
     C                     MOVELWL0056    WIA0NA           Job Name
     C                     Z-ADDWL0057    WIAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WIVSST           Record Status
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRSJ    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIRZNB           Case Sequence N
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@FNCPCS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1197' W0RTN   7
      * Send message 'Manifest Detail        EX'
     C                     MOVEL'USR1197' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@FNCPCS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Qty Min/Max        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADDWN0003    WJAIC3           Company Number
     C                     Z-ADDWN0007    WJHGCD           Item Code
      * Establish starting position
     C           KRSSK     CHAIN@BZREZG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJCZWG    YL0005           Minimum Weight
     C                     Z-ADDWJC0WG    YL0006           Maximum Weight
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKV8CD           Company Value C
      * Setup key
     C                     Z-ADDWN0003    WKAIC3           Company Number
     C                     MOVEL@CN,001   WKV8CD           Company Value C
      * Establish starting position
     C           KRSSL     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKBXTX    YL0007           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Ship Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0169  70       PFS Item Code
     C                     Z-ADD*ZERO     WN0170  80       PFS Actual Ship
     C                     Z-ADD*ZERO     WN0171  50       PFS Shipped Qua
     C                     Z-ADD*ZERO     WN0172  82       PFS Shipped Wei
     C                     MOVEL*BLANK    WN0173  2        PFS Short/Over
     C                     MOVEL*BLANK    WN0174  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0175  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0176  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0177  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0178  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BMCPYU
     C                     Z-ADDWAY1NX    WLY1NX           PFS Company Num
     C                     Z-ADDWAAID8    WLAID8           PFS Transaction
     C                     Z-ADDWAAFTS    WLAFTS           PFS Transaction
     C                     Z-ADDWABCNY    WLBCNY           PFS Transaction
      *
     C           KLCHSM    KLIST
     C                     KFLD           WLY1NX           PFS Company Num
     C                     KFLD           WLAID8           PFS Transaction
     C                     KFLD           WLAFTS           PFS Transaction
     C                     KFLD           WLBCNY           PFS Transaction
     C           KLCHSM    CHAIN@BMCPYU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBMCPL0'MDACP
     C                     MOVEL'@BMCPYU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBM1    YBRDCS
      * Move non-key fields to @BMCPYU
     C                     Z-ADDWAZPNX    WLZPNX           PFS Order Numbe
     C                     Z-ADDWAZXNX    WLZXNX           PFS Order Line
     C                     Z-ADDWAZYNX    WLZYNX           PFS Substitutio
     C                     Z-ADDWN0001    WLUXSX           PFS Process Sta
     C                     MOVELWN0002    WLV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BMCPYU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBMCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Next Event Number  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WMC4NB    WQSN02           Order Number
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WMQ2NB           Event Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQSN01           Company Number
     C                     Z-ADDWN0004    WQSN02           Order Number
     C                     Z-ADDWUQ2NB    WMQ2NB           Event Number
      * Establish starting position
     C           KPSSN     SETLL@EYCPY2                    *
     C           KRSSN     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQ2NB           Event Number
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWMQ2NB    WUQ2NB           Event Number
     C           KRSSN     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0179  1        EDI Status 1
     C                     MOVEL*BLANK    WN0180  1        EDI Status 2
     C                     MOVEL*BLANK    WN0181  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0182  60       Job Time
     C                     MOVEL*BLANK    WN0183 10        User Id
     C                     MOVEL*BLANK    WN0184 10        Job Name
     C                     Z-ADD*ZERO     WN0185  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWN0003    WOAIC3           Company Number
     C                     Z-ADDWN0004    WOC4NB           Order Number
     C                     Z-ADDWUQ2NB    WOQ2NB           Event Number
     C                     MOVEL'04'      WOJPCD           Event Code
     C                     Z-ADD0         WOAUC3           Invoice/Memo Co
     C                     Z-ADD0         WOQ7NB           Invoice/Memo Nu
     C                     MOVEL'IN'      WOOMST           Invoice/Memo Su
     C                     Z-ADD##JDT     WOD2DT           Event Date
     C                     MOVEL'N'       WOONST           Activity Comple
     C                     MOVEL'N'       WOOOST           Activity Hold
     C                     MOVEL'N'       WOOPST           Post Cash Compl
     C                     Z-ADD0         WOAWC3           Cross Event Ref
     C                     Z-ADD0         WOQ8NB           Cross Event Ref
     C                     Z-ADD0         WOQ9NB           Cross Event Ref
     C                     Z-ADDWN0008    WOBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WOAATM           Job Time
     C                     MOVEL##USR     WOAYNA           User Id
     C                     MOVEL##JOB     WOA0NA           Job Name
     C                     Z-ADD##JDT     WOAXDT           Job Date
     C           KLCRSO    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOC4NB           Order Number
     C                     KFLD           WOQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSO    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG Ord Event & Stat.  CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0186  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0187  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0188  70       Ship To Custome
     C                     MOVEL*BLANK    WN0189 30        Ship To Name
     C                     MOVEL*BLANK    WN0190 30        Ship To Address
     C                     MOVEL*BLANK    WN0191 30        Ship To Address
     C                     MOVEL*BLANK    WN0192 30        Ship To Address
     C                     MOVEL*BLANK    WN0193 20        Ship To City
     C                     MOVEL*BLANK    WN0194  2        Ship To State C
     C                     MOVEL*BLANK    WN0195 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0196  70       Bill to Custome
     C                     MOVEL*BLANK    WN0197 30        Bill to Name
     C                     MOVEL*BLANK    WN0198 30        Bill to Address
     C                     MOVEL*BLANK    WN0199 30        Bill to Address
     C                     MOVEL*BLANK    WN0200 30        Bill to Address
     C                     MOVEL*BLANK    WN0201 20        Bill to City
     C                     MOVEL*BLANK    WN0202  2        Bill to State C
     C                     MOVEL*BLANK    WN0203 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0204 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0205  70       Order Date
     C                     Z-ADD*ZERO     WN0206  70       Requested Ship
     C                     Z-ADD*ZERO     WN0207  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0208  70       Cancel Date
     C                     MOVEL*BLANK    WN0209  2        Terms Code
     C                     MOVEL*BLANK    WN0210 40        Special Instruc
     C                     MOVEL*BLANK    WN0211 40        Special Instruc
     C                     MOVEL*BLANK    WN0212  3        Carrier Code
     C                     MOVEL*BLANK    WN0213  1        Comment Print A
     C                     MOVEL*BLANK    WN0214  1        Comment Print I
     C                     MOVEL*BLANK    WN0215  1        Comment Print P
     C                     MOVEL*BLANK    WN0216  1        Comment Print S
     C                     MOVEL*BLANK    WN0217  3        Reason Code
     C                     MOVEL*BLANK    WN0218  1        Order in Use
     C                     MOVEL*BLANK    WN0219  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0220  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0221 10        User Original E
     C                     Z-ADD*ZERO     WN0222  70       Date of Origina
     C                     Z-ADD*ZERO     WN0223 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0224 112       Order Weight To
     C                     MOVEL*BLANK    WN0225  1        Credit Hold
     C                     MOVEL*BLANK    WN0226  1        Production Hold
     C                     MOVEL*BLANK    WN0227  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0228  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0229  40       Requested Deliv
     C                     MOVEL*BLANK    WN0230  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0231 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0232  70       Load ID
     C                     Z-ADD*ZERO     WN0233  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0234 112       Rated Freight
     C                     MOVEL*BLANK    WN0235  1        LTL Flag
     C                     MOVEL*BLANK    WN0236  1        Price Audit
     C                     MOVEL*BLANK    WN0237  1        Price Status
     C                     MOVEL*BLANK    WN0238  2        Shipping Method
     C                     MOVEL*BLANK    WN0239  1        Export Status
     C                     MOVEL*BLANK    WN0240  1        Palletize
     C                     MOVEL*BLANK    WN0241  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0242  1        Slip Sheet
     C                     MOVEL*BLANK    WN0243  1        Age Code
     C                     Z-ADD*ZERO     WN0244  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0245  1        Load Type
     C                     Z-ADD*ZERO     WN0246  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0247  1        Load Plan Order
     C                     MOVEL*BLANK    WN0248  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0249  70       Resell Referenc
     C                     MOVEL*BLANK    WN0250 30        Special Comment
     C                     MOVEL*BLANK    WN0251 30        Special Comment
     C                     MOVEL*BLANK    WN0252  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0253  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0254  2        Manager Level C
     C                     MOVEL*BLANK    WN0255  3        VP Level Code
     C                     Z-ADD*ZERO     WN0256  70       Attach to Order
     C                     MOVEL*BLANK    WN0257  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0258  70       Invoice Number
     C                     MOVEL*BLANK    WN0259  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0260  70       Invoice Date
     C                     MOVEL*BLANK    WN0261  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0262  1        Modified Flag
     C                     Z-ADD*ZERO     WN0263 112       A/R order Value
     C                     MOVEL*BLANK    WN0264  1        Billing Activit
     C                     MOVEL*BLANK    WN0265  1        Block Order Fla
     C                     MOVEL*BLANK    WN0266  1        Order Certifica
     C                     Z-ADD*ZERO     WN0267 112       Invoice Order V
     C                     MOVEL*BLANK    WN0268  1        Process Sts for
     C                     MOVEL*BLANK    WN0269  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0270  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0271  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0272  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0273  1        Email Cust On O
     C                     MOVEL*BLANK    WN0274  1        Order Emailed
     C                     MOVEL*BLANK    WN0275  1        Export Docs Go
     C                     MOVEL*BLANK    WN0276  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0277  1        Broker Order St
     C                     MOVEL*BLANK    WN0278  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0279  2        Order Requires
     C                     MOVEL*BLANK    WN0280  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0281  2        Export USDA App
     C                     MOVEL*BLANK    WN0282  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0283  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0284  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0285  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0286  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0287  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0288  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0289  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0290  60       Time of Origina
     C                     Z-ADD*ZERO     WN0291  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0292  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0293  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0294 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0295 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0296 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0297 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0298 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0299  70       Claim Number
     C                     MOVEL*BLANK    WN0300  1        EDI Status 1
     C                     MOVEL*BLANK    WN0301  1        EDI Status 2
     C                     MOVEL*BLANK    WN0302  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0303  60       Job Time
     C                     MOVEL*BLANK    WN0304 10        User Id
     C                     MOVEL*BLANK    WN0305 10        Job Name
     C                     Z-ADD*ZERO     WN0306  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWN0003    WRAIC3           Company Number
     C                     Z-ADDWN0004    WRC4NB           Order Number
      *
     C           KLCHSP    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C           KLCHSP    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'R'       WRGWST    P      Header Status
     C                     MOVELYL0009    WRGXST    P      Header Status L
     C                     MOVEL'04'      WRJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##PGM     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWRAIC3    PAAIC3           Company Number
     C                     Z-ADDWRC4NB    PAC4NB           Order Number
     C                     MOVELWRJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWRANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWRBKC7    PABKC7           Ship To Custome
     C                     MOVELWRBRTX    PABRTX    P      Ship To Name
     C                     MOVELWRHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWRHONA    PAHONA    P      Ship To Address
     C                     MOVELWRHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWRHNNA    PAHNNA    P      Ship To City
     C                     MOVELWRDBCD    PADBCD    P      Ship To State C
     C                     MOVELWRCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWRB0C7    PAB0C7           Bill to Custome
     C                     MOVELWRAETX    PAAETX    P      Bill to Name
     C                     MOVELWRB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWRB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWRB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWRB2NA    PAB2NA    P      Bill to City
     C                     MOVELWRBHCD    PABHCD    P      Bill to State C
     C                     MOVELWRC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWRBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWRA0DT    PAA0DT           Order Date
     C                     Z-ADDWRA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWRGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWRACDT    PAACDT           Cancel Date
     C                     MOVELWRAQCD    PAAQCD    P      Terms Code
     C                     MOVELWRB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWRBYNA    PABYNA    P      Special Instruc
     C                     MOVELWRBZNA    PABZNA    P      Carrier Code
     C                     MOVELWRGTST    PAGTST    P      Comment Print A
     C                     MOVELWRGVST    PAGVST    P      Comment Print I
     C                     MOVELWRGUST    PAGUST    P      Comment Print P
     C                     MOVELWRQFST    PAQFST    P      Comment Print S
     C                     MOVELWRCQCD    PACQCD    P      Reason Code
     C                     MOVELWRGJST    PAGJST    P      Order in Use
     C                     MOVELWRGWST    PAGWST    P      Header Status
     C                     MOVELWRGXST    PAGXST    P      Header Status L
     C                     MOVELWRGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWRAODT    PAAODT           Scheduled Ship
     C                     MOVELWRAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWRCXDT    PACXDT           Date of Origina
     C                     Z-ADDWRJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWRA1WG    PAA1WG           Order Weight To
     C                     MOVELWRXIST    PAXIST    P      Credit Hold
     C                     MOVELWRXJST    PAXJST    P      Production Hold
     C                     MOVELWRXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWREIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWRAFTM    PAAFTM           Requested Deliv
     C                     MOVELWRE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWRE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWRRMNB    PARMNB           Load ID
     C                     Z-ADDWRTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWRR1NB    PAR1NB           Rated Freight
     C                     MOVELWRPJST    PAPJST    P      LTL Flag
     C                     MOVELWRU0ST    PAU0ST    P      Price Audit
     C                     MOVELWRU1ST    PAU1ST    P      Price Status
     C                     MOVELWRQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWRU2ST    PAU2ST    P      Export Status
     C                     MOVELWRVEST    PAVEST    P      Palletize
     C                     MOVELWRVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWRVGST    PAVGST    P      Slip Sheet
     C                     MOVELWRRPCD    PARPCD    P      Age Code
     C                     Z-ADDWRRNNB    PARNNB           Reefer Temperat
     C                     MOVELWRVDST    PAVDST    P      Load Type
     C                     Z-ADDWRATIN    PAATIN           Attach to Invoi
     C                     MOVELWRU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWRU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWRRSRN    PARSRN           Resell Referenc
     C                     MOVELWRMHNA    PAMHNA    P      Special Comment
     C                     MOVELWRMINA    PAMINA    P      Special Comment
     C                     MOVELWRWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWRR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWRBFCD    PABFCD    P      Manager Level C
     C                     MOVELWRQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWRT3NB    PAT3NB           Attach to Order
     C                     MOVELWRSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWRCONB    PACONB           Invoice Number
     C                     MOVELWRCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWRAWDT    PAAWDT           Invoice Date
     C                     MOVELWRJPCD    PAJPCD    P      Event Code
     C                     MOVELWRXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWRZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWRVRVA    PAVRVA           A/R order Value
     C                     MOVELWROBST    PAOBST    P      Billing Activit
     C                     MOVELWRBCST    PABCST    P      Block Order Fla
     C                     MOVELWRBDST    PABDST    P      Order Certifica
     C                     Z-ADDWRB7VL    PAB7VL           Invoice Order V
     C                     MOVELWRGASX    PAGASX    P      Process Sts for
     C                     MOVELWRGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWRGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWRGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWRFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWRFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWRFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWRFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWRFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWRFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWRFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWRFUSX    PAFUSX    P      Order Requires
     C                     MOVELWRFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWRFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWRFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWRFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWRNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWRNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWRNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWRNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWRNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWRBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWRBQTM    PABQTM           Time of Origina
     C                     Z-ADDWRBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWRBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWRBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWRH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWRH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWRH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWRH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWRH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWRC0C7    PAC0C7           Claim Number
     C                     MOVELWRUVST    PAUVST    P      EDI Status 1
     C                     MOVELWRUWST    PAUWST    P      EDI Status 2
     C                     MOVELWRUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWRAATM    PAAATM           Job Time
     C                     MOVELWRAYNA    PAAYNA    P      User Id
     C                     MOVELWRA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWRAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * VALIDATE
      *================================================================
     C                     Z-ADDWAZXNX    WN0005           Order Sequence
     C                     Z-ADD1         WN0006           Order Secondary
     C                     Z-ADDWAY2NX    WN0007           Item Code
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0026  40       Year Code
     C                     Z-ADD*ZERO     WN0027  20       Month
     C                     Z-ADD*ZERO     WN0028  20       Day of Month US
     C                     MOVEL*BLANK    WN0029  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0030  2        Month (Char) US
     C                     MOVEL*BLANK    WN0031  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0032  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0033  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0034  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAAFD8    DIV  10000     WN0026           Year Code
     C                     Z-ADDWN0026    WN0032           Year  NBR USR
     C                     MOVELWN0032    WN0033           Year  (Char) US
      * ** MONTH **
     C           WAAFD8    DIV  100       WN0027           Month
     C                     MOVELWN0027    WN0030           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAAFD8    WN0028           Day of Month US
     C                     MOVELWN0028    WN0031           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0026    IFLE 1999                       *IF
     C                     Z-ADD0         ZQ      50
     C           '0'       CAT  WN0033:ZQ WN0034    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         ZQ      50
     C           '1'       CAT  WN0033:ZQ WN0034    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD0         ZQ      50
     C           WN0034    CAT  WN0030:ZQ WN0034    P      Date (Alpha) US
     C                     Z-ADD0         ZQ      50
     C           WN0034    CAT  WN0031:ZQ WN0034    P      Date (Alpha) US
     C                     MOVE WN0034    WN0014           Date
      * RTV Qty/Wgt Ord/Sched RT - Order Detail  * 
     C                     EXSR SCRVGN
      * VAL:  Order Detail Exists
      * CASE:
      *  - (c1 AND c2)
      *   |- c1    : LCL.Record Found USR is Record Not Found
      *   |- c2    : DB1.PFS Shipped Quantity is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'N'                        *IF
     C           WAAUNY    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDTNF'  WN0002           PFS Error Reaso
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Detail Line Status is Cancelled
      *   |- c2    : DB1.PFS Shipped Quantity is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0009    IFEQ 'X'                        *IF
     C           WAAUNY    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'DTLCAN'  WN0002           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * 11/03/08 PKD Commenting out to avoid confusion.  Not and error.
      *              Informational only.
      * PFS Rtv Total Shipped RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0003    WL0001           Company Number
     C                     Z-ADDWN0004    WL0002           Order Number
     C                     Z-ADDWN0005    WL0003           Order Sequence
     C                     Z-ADDWN0006    WL0004           Order Secondary
     C                     Z-ADDWN0012    WL0005           Quantity Shippe
     C                     Z-ADDWN0013    WL0006           Weight Shipped
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WN0012           Quantity Shippe
     C                     Z-ADDWL0006    WN0013           Weight Shipped
      * VAL:  Shipped Quantity
      * CASE: DB1.PFS Shipped Quantity NE PAR.Quantity Shipped Total
     C           WAAUNY    IFNE WN0012                     *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'SHPQTY'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Shipped Weight
      * CASE: DB1.PFS Shipped Weight NE PAR.Weight Shipped Total
     C           WAAVNY    IFNE WN0013                     *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'SHPWGT'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * ERR:  Do not select Record
      * CASE: PAR.PFS Process Status is Error
     C           WN0001    IFEQ 2                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     MOVEL'Y'       P2ECST           Error Status
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAAID8           PFS Transaction
     C                     Z-ADD*ZERO     WAAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WABCNY           PFS Transaction
     C                     Z-ADD*ZERO     WAZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WAZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WAZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WAY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WAAFD8           PFS Actual Ship
     C                     Z-ADD*ZERO     WAAUNY           PFS Shipped Qua
     C                     Z-ADD*ZERO     WAAVNY           PFS Shipped Wei
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WDFOQT           Case Quantity
     C                     Z-ADD*ZERO     WDR0NB           Case Weight
     C                     Z-ADD*ZERO     WDK7DT           Label Date
     C                     Z-ADD*ZERO     WDPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDELDT           Production Date
     C                     Z-ADD*ZERO     WDN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WDH5NY           Manifest Total
     C                     Z-ADD*ZERO     WDH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WDH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WDN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WDN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WDRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WDITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WDIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WDIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WDIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WDIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WDIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGARQT           Quantity on Han
     C                     Z-ADD*ZERO     WGASQT           Quantity on Han
     C                     Z-ADD*ZERO     WGATQT           Quantity on Han
     C                     Z-ADD*ZERO     WGHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WGHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAECS           Last Cost
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     Z-ADD*ZERO     WGK7DT           Label Date
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHXXTM           Departure Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Manifest Shift
     C                     MOVEL*BLANK    WUGBTX  1
      * Define work field Manifest Unused Status 1A
     C                     MOVEL*BLANK    WUGCTX  1
      * Define work field Manifest Unused Status 2A
     C                     MOVEL*BLANK    WUGDTX  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAIWG           Unit Weight
     C                     Z-ADD*ZERO     WJCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WJC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WJURTN           Number Cases On
     C                     Z-ADD*ZERO     WJAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJTFNB           Transportation
     C                     Z-ADD*ZERO     WJTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WJTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WJBLPR           Market Overage
     C                     Z-ADD*ZERO     WJBMPR           Standard Overag
     C                     Z-ADD*ZERO     WJCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WJCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WJSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WJPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WJICN1           Item Category N
     C                     Z-ADD*ZERO     WJICN2           Item Category N
     C                     Z-ADD*ZERO     WJV2NB           Item Category N
     C                     Z-ADD*ZERO     WJITCN           Item Category N
     C                     Z-ADD*ZERO     WJITC5           Item Category N
     C                     Z-ADD*ZERO     WJICN6           Item Category N
     C                     Z-ADD*ZERO     WJICN7           Item Category N
     C                     Z-ADD*ZERO     WJICN8           Item Category N
     C                     Z-ADD*ZERO     WJICN9           Item Category N
     C                     Z-ADD*ZERO     WJICN0           Item Category N
     C                     Z-ADD*ZERO     WJSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WJA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WJSJNB           Production Lead
     C                     Z-ADD*ZERO     WJSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WJSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WJSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WJCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WJCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WJILNB           Packages per ca
     C                     Z-ADD*ZERO     WJCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WJCINB           PM Batch Size
     C                     Z-ADD*ZERO     WJCJNB           Package Level s
     C                     Z-ADD*ZERO     WJCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WJCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WJCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WJCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WJCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WJCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WJCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WJCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WJC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WJB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WJB5NB           PM Line Number
     C                     Z-ADD*ZERO     WJBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WJBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WJF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WJF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WJF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WJBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WJBNNB           Production Qty
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKM8NB           System Value Nu
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field DL List ID
     C                     MOVEL*BLANK    WUCLAA 10
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMQ2NB           Event Number
     C                     Z-ADD*ZERO     WMAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WMQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WMD2DT           Event Date
     C                     Z-ADD*ZERO     WMAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WMQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WMQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Clear all neither parameters
      * CRT OP Order Events    CR - Order Events  * 
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  50
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  3
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  70
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
      * Define local variables for subroutine SJCRRC.
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  30
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  50
     C                     Z-ADD*ZERO     WL0025  50
     C                     Z-ADD*ZERO     WL0026 112
     C                     MOVEL*BLANK    WL0027  1
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  80
     C                     Z-ADD*ZERO     WL0030  70
     C                     MOVEL*BLANK    WL0031  3
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033 112
     C                     MOVEL*BLANK    WL0034 10
     C                     Z-ADD*ZERO     WL0035  82
     C                     Z-ADD*ZERO     WL0036  50
     C                     Z-ADD*ZERO     WL0037  90
     C                     MOVEL*BLANK    WL0038  1
     C                     Z-ADD*ZERO     WL0039 112
     C                     Z-ADD*ZERO     WL0040 112
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  50
     C                     Z-ADD*ZERO     WL0045  80
     C                     Z-ADD*ZERO     WL0046  80
     C                     Z-ADD*ZERO     WL0047  80
     C                     Z-ADD*ZERO     WL0048  80
     C                     Z-ADD*ZERO     WL0049  74
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     MOVEL*BLANK    WL0053  1
     C                     Z-ADD*ZERO     WL0054  60
     C                     MOVEL*BLANK    WL0055 10
     C                     MOVEL*BLANK    WL0056 10
     C                     Z-ADD*ZERO     WL0057  70
      * Define null work field Quantity Ordered
     C                     Z-ADD*ZERO     YN0001 112
      * Define null work field Weight Ordered
     C                     Z-ADD*ZERO     YN0002 112
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field Consumed Item Code
     C                     Z-ADD*ZERO     YN0004  70
      * Define null work field Item Age Days
     C                     Z-ADD*ZERO     YN0005  40
      * Define null work field Production Ovr AgeDte Fr
     C                     Z-ADD*ZERO     YN0006  70
      * Define null work field Production Ovr AgeDte To
     C                     Z-ADD*ZERO     YN0007  70
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0008  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Net Weight Kg USR 11.4
     C                     Z-ADD*ZERO     YL0003 114
      * Define local work field Net Weight Kilograms
     C                     Z-ADD*ZERO     YL0004  71
      * Define local work field Minimum Weight Per Case
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field Maximum Weight Per Case
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0007 40
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0008132
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Access Denied (Y/N)
     C                     MOVEL*BLANK    YL0010  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MINMAXWGT
