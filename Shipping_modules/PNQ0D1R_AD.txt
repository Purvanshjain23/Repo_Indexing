// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PNQ0D1R
// ?Date: 14.08.2025 Time: 03:46:13
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?S15557 RMC 10/2/19 Dsp whs inv chilling time if Whs chill is YEs
//?R8086 JJH 12/12/16 - Changes were added and then removed.
//?E2073 RMC 8/1/12 Dsp whs inv chilling time, prod sched max days
//?USER: Load detail screen from DBF record

EXECUTE FUNCTION(Company Name DRV) TYPE(DRVFLD)                                 AC1532476;
PARAMETER(DTL.Company_Name_DRV);
PARAMETER(DTL.Company_Number);
{
 //?Calculate derived field

 EXECUTE FUNCTION(RTV Company Name       RT) TYPE(RTVOBJ) FILE(CAABREP)          AC1255767;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Company_Name_DRV);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

}


EXECUTE FUNCTION(Rtv Base Values PA    RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1416510;
PARAMETER(DB1.Company_Number);
PARAMETER(DB1.Item_Code);
PARAMETER(PAR.Description_Line_One);
PARAMETER(PAR.Description_Line_Two);
PARAMETER(PAR.UOM_Primary);
PARAMETER(PAR.Conversion_Factor_1);
PARAMETER(PAR.Operation_Factor_1);
PARAMETER(PAR.UOM_Second);
PARAMETER(PAR.Conversion_Factor_2);
PARAMETER(PAR.Operation_Factor_2);
PARAMETER(PAR.UOM_Third);
PARAMETER(PAR.UOM_Pricing);
PARAMETER(PAR.Unit_Weight);
PARAMETER(DTL.Production_Date_Control);
PARAMETER(DTL.Catch_Weight_Status);
PARAMETER(DTL.Fresh_Chilling_Time);
PARAMETER(LCL.Base_Conv_Loss_Item);
PARAMETER(LCL.Piece_Count_Item);
PARAMETER(LCL.Pieces_Per_Bag);
PARAMETER(LCL.Bags_Per_Unit);
PARAMETER(LCL.Record_Status);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// DTL.Item Description DRV = PAR.Description Line One
DTL.Item_Description_DRV = PAR.Description_Line_One;

// Call program RTV Customer Name     XF.
CALL PROGRAM(RTV Customer Name     XF) ('PPH6XFR');
PARAMETER(DB1.Ship_To_Customer);
PARAMETER(DTL.Customer_Name_DRV);

EXECUTE FUNCTION(RTV SSD/Tm/SpecIns/RDlvRT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1977694;
PARAMETER(DB1.Company_Number);
PARAMETER(DB1.Order_Number);
PARAMETER(LCL.Special_Instructions);
PARAMETER(LCL.Special_Instructions_2);
PARAMETER(LCL.Scheduled_Ship_Date);
PARAMETER(DTL.Requested_Delivery_Date);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// Call program RTV Actv Descr, Ctrl   XF.
CALL PROGRAM(RTV Actv Descr, Ctrl   XF) ('PNH4XFR');
PARAMETER(DB1.Warehouse_Code);
PARAMETER(WRK.Warehouse_Description);
PARAMETER(WRK.Trans_Contol_AS400_Plant);

EXECUTE FUNCTION(RTV Type/Std Chil/Chil RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1501268;
PARAMETER(DB1.Warehouse_Code);
PARAMETER(DTL.Warehouse_Type);
PARAMETER(DTL.Warehouse_Std_Chill_Time);
PARAMETER(DTL.Warehouse_Chill_Time);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?get into LCL.WHS Inventory Chill Time- if whs chill is yes useThis instead
EXECUTE FUNCTION(RTV Warehouse Inv/Max RT) TYPE(RTVOBJ) FILE(CAADREP)           AC2049533;
PARAMETER(DB1.Warehouse_Code);
PARAMETER(DTL.WHS_Sched_Prod_Max_Days);
PARAMETER(LCL.WHS_Inventory_Chill_Time);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// Call program Rtv Age Information   XF.
CALL PROGRAM(Rtv Age Information   XF) ('PNQCXFR');
PARAMETER(DB1.Company_Number);
PARAMETER(DB1.Ship_To_Customer);
PARAMETER(DTL.Item_Age_Days_Fresh);
PARAMETER(DTL.Item_Age_Days_Frozen);

// DTL.Chill Time USR = CON.*ZERO
DTL.Chill_Time_USR = *ZERO;

CASE;

// IF DTL.Warehouse Std Chill Time is yes
IF DTL.Warehouse_Std_Chill_Time = 'Y';

// DTL.Chill Time USR = LCL.WHS Inventory Chill Time
DTL.Chill_Time_USR = LCL.WHS_Inventory_Chill_Time;

// IF *OTHERWISE
IF *OTHERWISE;

// DTL.Chill Time USR = DTL.Fresh Chilling Time
DTL.Chill_Time_USR = DTL.Fresh_Chilling_Time;

ENDIF;

//?Get the Order header
// Call program CLC PA Age FrmToDates XF.
CALL PROGRAM(CLC PA Age FrmToDates XF) ('PNO7XFR');
PARAMETER(DTL.Company_Number);
PARAMETER(DTL.Chill_Time_USR);
PARAMETER(DTL.Scheduled_Ship_Date);
PARAMETER(DTL.Requested_Delivery_Date);
PARAMETER(DB1.Item_Age_Days);
PARAMETER(DB1.Production_Ovr_AgeDte_Fr);
PARAMETER(DB1.Production_Ovr_AgeDte_To);
PARAMETER(DTL.Production_AgeDte_Fr);
PARAMETER(DTL.Production_AgeDte_To);

// LCL.First Time Flag = CND.Yes
LCL.First_Time_Flag = 'Y';

//?CALC: Detail screen function fields

//?Get the Order header     **** already done up above
//?USER: Validate detail screen

EXECUTE FUNCTION(Company Name DRV) TYPE(DRVFLD)                                 AC1532476;
PARAMETER(DTL.Company_Name_DRV);
PARAMETER(DTL.Company_Number);
{
 //?Calculate derived field

 EXECUTE FUNCTION(RTV Company Name       RT) TYPE(RTVOBJ) FILE(CAABREP)          AC1255767;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Company_Name_DRV);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

}


// DTL.Item Description DRV = PAR.Description Line One
DTL.Item_Description_DRV = PAR.Description_Line_One;

// Call program RTV Customer Name     XF.
CALL PROGRAM(RTV Customer Name     XF) ('PPH6XFR');
PARAMETER(DTL.Ship_To_Customer);
PARAMETER(DTL.Customer_Name_DRV);

//?As of this time 4/1/2010 we are not going to insert this
//?this will come later on next release
