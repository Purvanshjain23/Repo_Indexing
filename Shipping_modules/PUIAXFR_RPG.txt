     H/TITLE CRT Load/OrderChg n/ld2XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/25/18  Time  : 10:02:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDLHCPLJIF  E           K        DISK
      * RSQ : Load Order Change Log     Create Date(D)/Time/Seq
      *
     FPDLHCPL9IF  E           K        DISK
      * RSQ : Load Order Change Log     Load ID/Seg Num-1
      *
     FPDLHCPL0IF  E           K        DISK                      A
      * UPD : Load Order Change Log     Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@LHCPBN
      * Load Order Change Log     Create Date(D)/Time/Seq
      * Renamed input format fields
     I              LHK4DT                          WBK4DT
     I              LHA1TM                          WBA1TM
     I              LHDXNB                          WBDXNB
     I              LHRMNB                          WBRMNB
     I              LHRVNB                          WBRVNB
     I              LHRVST                          WBRVST
     I              LHUJST                          WBUJST
     I              LHMNTX                          WBMNTX
     I              LHMOTX                          WBMOTX
     I              LHAYNA                          WBAYNA
     I              LHA0NA                          WBA0NA
     I              LHBZNA                          WBBZNA
     I              LHXMCD                          WBXMCD
     I              LHAIC3                          WBAIC3
     I              LHC4NB                          WBC4NB
      *
     I@LHCPQR
      * Load Order Change Log     Load ID/Seg Num-1
      * Renamed input format fields
     I              LHK4DT                          WCK4DT
     I              LHA1TM                          WCA1TM
     I              LHDXNB                          WCDXNB
     I              LHRMNB                          WCRMNB
     I              LHRVNB                          WCRVNB
     I              LHRVST                          WCRVST
     I              LHUJST                          WCUJST
     I              LHMNTX                          WCMNTX
     I              LHMOTX                          WCMOTX
     I              LHAYNA                          WCAYNA
     I              LHA0NA                          WCA0NA
     I              LHBZNA                          WCBZNA
     I              LHXMCD                          WCXMCD
     I              LHAIC3                          WCAIC3
     I              LHC4NB                          WCC4NB
      *
     I@LHCPN6
      * Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WDK4DT
     I              LHA1TM                          WDA1TM
     I              LHDXNB                          WDDXNB
     I              LHRMNB                          WDRMNB
     I              LHRVNB                          WDRVNB
     I              LHRVST                          WDRVST
     I              LHUJST                          WDUJST
     I              LHMNTX                          WDMNTX
     I              LHMOTX                          WDMOTX
     I              LHAYNA                          WDAYNA
     I              LHA0NA                          WDA0NA
     I              LHBZNA                          WDBZNA
     I              LHXMCD                          WDXMCD
     I              LHAIC3                          WDAIC3
     I              LHC4NB                          WDC4NB
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDLH1    E DSPDLHCPL0
      * UPD : Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WDK4DT
     I              LHA1TM                          WDA1TM
     I              LHDXNB                          WDDXNB
     I              LHRMNB                          WDRMNB
     I              LHRVNB                          WDRVNB
     I              LHRVST                          WDRVST
     I              LHUJST                          WDUJST
     I              LHMNTX                          WDMNTX
     I              LHMOTX                          WDMOTX
     I              LHAYNA                          WDAYNA
     I              LHA0NA                          WDA0NA
     I              LHBZNA                          WDBZNA
     I              LHXMCD                          WDXMCD
     I              LHAIC3                          WDAIC3
     I              LHC4NB                          WDC4NB
      *
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Order Change Log
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * I :  Load Change Type
     I                                        5  10 P1RVST
      * I :  Department Control Code
     I                                       11  13 P1UJST
      * I :  Change Log Prior Value
     I                                       14  25 P1MNTX
      * I :  Change Log New Value
     I                                       26  37 P1MOTX
      * I :  User Id
     I                                       38  47 P1AYNA
      * I :  Job Name
     I                                       48  57 P1A0NA
      * I :  Company Number
     I                                    P  58  590P1AIC3
      * I :  Order Number
     I                                    P  60  630P1C4NB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1RVST    PARM           WP0002  6        Load Change Typ
     C           P1UJST    PARM           WP0003  3        Department Cont
     C           P1MNTX    PARM           WP0004 12        Change Log Prio
     C           P1MOTX    PARM           WP0005 12        Change Log New
     C           P1AYNA    PARM           WP0006 10        User Id
     C           P1A0NA    PARM           WP0007 10        Job Name
     C           P1AIC3    PARM           WP0008  30       Company Number
     C           P1C4NB    PARM           WP0009  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CRT Load/OrderChg n/ld2XF
      * RTV Load ID            RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * CRT Load/Order Chg Log2IF
      * CASE: PAR.Load ID is Blank
     C           YL0001    IFEQ 0                          *IF
      * RTV Next Key f/crt dt RT - Load Order Change Log  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Next Key           RT - Load Order Change Log  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      * Use system date/time to minimize dup record creation
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0003    PARM *ZERO     WQ0001 155       Current System
     C           YL0004    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0003    WL0001           Created Date
     C                     Z-ADDYL0004    WL0002           Created Time
     C                     Z-ADDYL0002    WL0003           Sequence Number
     C                     Z-ADDYL0001    WL0004           Load ID
     C                     Z-ADD0         WL0005           Stop/Drop
     C                     MOVELP1RVST    WL0006    P      Load Change Typ
     C                     MOVELP1UJST    WL0007    P      Department Cont
     C                     MOVELP1MNTX    WL0008    P      Change Log Prio
     C                     MOVELP1MOTX    WL0009    P      Change Log New
     C                     MOVELP1AYNA    WL0010    P      User Id
     C                     MOVELP1A0NA    WL0011    P      Job Name
     C                     MOVEL*BLANK    WL0012           Carrier Code
     C                     MOVEL*BLANK    WL0013           Carrier Broker
     C                     Z-ADDP1AIC3    WL0014           Company Number
     C                     Z-ADDP1C4NB    WL0015           Order Number
     C                     EXSR SDCRRC
      * Add seconds until it can be added successfully
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
      * LCL.Created Time = LCL.Current System Time
     C                     Z-ADDYL0004    YL0005           Created Time
      * DO WHILE: PGM.*Return code is *Record already exists
     C           W0RTN     DOWEQ@CN,001                    *DOW
      * LCL.Created Time = LCL.Created Time + CON.1 *SECONDS
     C                     Z-ADDYL0005    XTTIM
     C                     Z-ADD*ZERO     XASC    80
     C                     EXSR XTAD1
     C                     ADD  1         XASC    80
     C                     EXSR XTCT1
     C                     Z-ADDXTTIM     YL0005
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0003    WL0001           Created Date
     C                     Z-ADDYL0005    WL0002           Created Time
     C                     Z-ADDYL0002    WL0003           Sequence Number
     C                     Z-ADDYL0001    WL0004           Load ID
     C                     Z-ADD0         WL0005           Stop/Drop
     C                     MOVELP1RVST    WL0006    P      Load Change Typ
     C                     MOVELP1UJST    WL0007    P      Department Cont
     C                     MOVELP1MNTX    WL0008    P      Change Log Prio
     C                     MOVELP1MOTX    WL0009    P      Change Log New
     C                     MOVELP1AYNA    WL0010    P      User Id
     C                     MOVELP1A0NA    WL0011    P      Job Name
     C                     MOVEL*BLANK    WL0012           Carrier Code
     C                     MOVEL*BLANK    WL0013           Carrier Broker
     C                     Z-ADDP1AIC3    WL0014           Company Number
     C                     Z-ADDP1C4NB    WL0015           Order Number
     C                     EXSR SDCRRC
     C                     END                             *ITR
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           Load ID
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARMNB    YL0001           Load ID
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Next Key f/crt dt RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0002           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBK4DT    WQSB01           Created Date
     C           *LIKE     DEFN WBA1TM    WQSB02           Created Time
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Created Date
     C                     KFLD           WQSB02           Created Time
      * Setup key
     C                     Z-ADD##JDT     WQSB01           Created Date
     C                     Z-ADD##JTM     WQSB02           Created Time
      * Establish starting position
     C           KRSSB     SETLL@LHCPBN                    *
     C           KRSSB     READE@LHCPBN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0002           Sequence Number
     C                     GOTO SBEXIT                     *QUIT
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sequence Number is EQ 999
     C           WBDXNB    IFEQ 999                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WBDXNB    ADD  1         YL0002           Sequence Number
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSB     READE@LHCPBN                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Next Key           RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0002           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADDYL0001    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@LHCPQR                    *
     C           KRSSC     READE@LHCPQR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0002           Sequence Number
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Sequence Number is EQ 999
     C           WCDXNB    IFEQ 999                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WCDXNB    ADD  1         YL0002           Sequence Number
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@LHCPQR                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * CRT Load/Order Chg Log CR - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @LHCPN6
     C                     Z-ADDWL0001    WDK4DT           Created Date
     C                     Z-ADDWL0002    WDA1TM           Created Time
     C                     Z-ADDWL0003    WDDXNB           Sequence Number
     C                     Z-ADDWL0004    WDRMNB           Load ID
     C                     Z-ADDWL0005    WDRVNB           Stop/Drop
     C                     MOVELWL0006    WDRVST           Load Change Typ
     C                     MOVELWL0007    WDUJST           Department Cont
     C                     MOVELWL0008    WDMNTX           Change Log Prio
     C                     MOVELWL0009    WDMOTX           Change Log New
     C                     MOVELWL0010    WDAYNA           User Id
     C                     MOVELWL0011    WDA0NA           Job Name
     C                     MOVELWL0012    WDBZNA           Carrier Code
     C                     MOVELWL0013    WDXMCD           Carrier Broker
     C                     Z-ADDWL0014    WDAIC3           Company Number
     C                     Z-ADDWL0015    WDC4NB           Order Number
      *
     C           KLCRSD    KLIST
     C                     KFLD           WDK4DT           Created Date
     C                     KFLD           WDA1TM           Created Time
     C                     KFLD           WDDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSD    SETLL@LHCPN6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2472' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@LHCPN6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         XTAD1     BEGSR
      *================================================================
      * Add TME to absolute time (seconds)
      *================================================================
     C           XTHH      MULT 3600      XDWK1   80
     C                     ADD  XDWK1     XASC
     C           XTNN      MULT 60        XDWK1
     C                     ADD  XDWK1     XASC
     C                     ADD  XTSS      XASC
      *================================================================
     CSR         XTAD1E    ENDSR
      /EJECT
     CSR         XTCT1     BEGSR
      *================================================================
      * Convert absolute time (seconds) to TME
      *================================================================
     C                     EXSR XTFCT
     C           XASC      DIV  60        XASC
     C                     MVR            XTSS
     C           XASC      DIV  60        XASC
     C                     MVR            XTNN
     C                     Z-ADDXASC      XTHH
      *================================================================
     CSR         XTCT1E    ENDSR
      /EJECT
     CSR         XTFCT     BEGSR
      *================================================================
      * Factorize absolute date (seconds) by 24 hours
      *================================================================
     C           XASC      IFGE 86400
     C                     DIV  86400     XASC    80
     C                     MVR            XASC
     C                     ELSE
     C           XASC      IFLE *ZERO
     C                     DIV  86400     XASC
     C                     MVR            XASC
     C           XASC      IFNE *ZERO
     C                     ADD  86400     XASC
     C                     END
     C                     END
     C                     END
      *================================================================
     CSR         XTFCTE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBK4DT           Created Date
     C                     Z-ADD*ZERO     WBA1TM           Created Time
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDCRRC.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  60
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  50
     C                     MOVEL*BLANK    WL0006  6
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008 12
     C                     MOVEL*BLANK    WL0009 12
     C                     MOVEL*BLANK    WL0010 10
     C                     MOVEL*BLANK    WL0011 10
     C                     MOVEL*BLANK    WL0012  3
     C                     MOVEL*BLANK    WL0013  3
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Sequence Number
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0003 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0004 155
      * Define local work field Created Time
     C                     Z-ADD*ZERO     YL0005  60
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0003
