     H/TITLE Upd Balances Issue/Adj XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 09/27/24  Time  : 12:54:25
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPUC6REL1IF  E           K        DISK
      * RTV : OMS Transformation Ctl    Retrieval index
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FCAB0REL0UF  E           K        DISK
      * UPD : Item Balance              Update index
      *
      * Long constants
     E                    @CN#    1  12  6   @CN    25
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WBAIC3
     I              B0HGCD                          WBHGCD
     I              B0AJCD                          WBAJCD
     I              B0AGCS                          WBAGCS
     I              B0AECS                          WBAECS
     I              B0BACS                          WBBACS
     I              B0BBCS                          WBBBCS
     I              B0CBPR                          WBCBPR
     I              B0GUDT                          WBGUDT
     I              B0XYST                          WBXYST
     I              B0CTPR                          WBCTPR
     I              B0G4DT                          WBG4DT
     I              B0BOWG                          WBBOWG
     I              B0DDQT                          WBDDQT
     I              B0DEQT                          WBDEQT
     I              B0DFQT                          WBDFQT
     I              B0HDQT                          WBHDQT
     I              B0HEQT                          WBHEQT
     I              B0AJQT                          WBAJQT
     I              B0AQQT                          WBAQQT
     I              B0AUQT                          WBAUQT
     I              B0EMQT                          WBEMQT
     I              B0DOQT                          WBDOQT
     I              B0ATNA                          WBATNA
     I              B0AKDT                          WBAKDT
     I              B0ANDT                          WBANDT
     I              B0IDVA                          WBIDVA
     I              B0JVST                          WBJVST
     I              B0BZPC                          WBBZPC
     I              B0DGQT                          WBDGQT
     I              B0DIDT                          WBDIDT
     I              B0ALCD                          WBALCD
     I              B0BFDY                          WBBFDY
     I              B0DJDT                          WBDJDT
     I              B0BGDY                          WBBGDY
     I              B0DKDT                          WBDKDT
     I              B0J2ST                          WBJ2ST
     I              B0DJQT                          WBDJQT
     I              B0BNWG                          WBBNWG
     I              B0DLDT                          WBDLDT
     I              B0DPQT                          WBDPQT
     I              B0DQQT                          WBDQQT
     I              B0DMDT                          WBDMDT
     I              B0M0ST                          WBM0ST
     I              B0J9ST                          WBJ9ST
     I              B0KBST                          WBKBST
     I              B0AKC8                          WBAKC8
     I              B0RINB                          WBRINB
     I              B0RHNB                          WBRHNB
     I              B0RGNB                          WBRGNB
     I              B0UVST                          WBUVST
     I              B0UWST                          WBUWST
     I              B0UXST                          WBUXST
     I              B0VSST                          WBVSST
     I              B0AATM                          WBAATM
     I              B0AYNA                          WBAYNA
     I              B0A0NA                          WBA0NA
     I              B0AXDT                          WBAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@C6REMK
      * OMS Transformation Ctl    Retrieval index
      * Renamed input format fields
     I              C6B3AB                          WDB3AB
     I              C6HUNZ                          WDHUNZ
     I              C6OCSC                          WDOCSC
     I              C6UNU1                          WDUNU1
     I              C6VSST                          WDVSST
     I              C6BGTS                          WDBGTS
     I              C6RUU1                          WDRUU1
     I              C6RVU1                          WDRVU1
     I              C6BHTS                          WDBHTS
     I              C6RWU1                          WDRWU1
     I              C6RXU1                          WDRXU1
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WEAIC3
     I              B7HGCD                          WEHGCD
     I              B7AJCD                          WEAJCD
     I              B7W9ST                          WEW9ST
     I              B7BSST                          WEBSST
     I              B7B4DT                          WEB4DT
     I              B7C4NY                          WEC4NY
     I              B7DXNB                          WEDXNB
     I              B7ELDT                          WEELDT
     I              B7HVCD                          WEHVCD
     I              B7F1ST                          WEF1ST
     I              B7AUNA                          WEAUNA
     I              B7A5QT                          WEA5QT
     I              B7AHWG                          WEAHWG
     I              B7AKCS                          WEAKCS
     I              B7CGCD                          WECGCD
     I              B7AYVA                          WEAYVA
     I              B7BJNA                          WEBJNA
     I              B7CKNB                          WECKNB
     I              B7BMST                          WEBMST
     I              B7CQCD                          WECQCD
     I              B7DTCD                          WEDTCD
     I              B7MGNA                          WEMGNA
     I              B7TRBN                          WETRBN
     I              B7TRBS                          WETRBS
     I              B7C4NB                          WEC4NB
     I              B7RINB                          WERINB
     I              B7RHNB                          WERHNB
     I              B7RGNB                          WERGNB
     I              B7M3NA                          WEM3NA
     I              B7AWTM                          WEAWTM
     I              B7XLCD                          WEXLCD
     I              B7K7DT                          WEK7DT
     I              B7UVST                          WEUVST
     I              B7UWST                          WEUWST
     I              B7UXST                          WEUXST
     I              B7VSST                          WEVSST
     I              B7AATM                          WEAATM
     I              B7AYNA                          WEAYNA
     I              B7A0NA                          WEA0NA
     I              B7AXDT                          WEAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WHAJCD
     I              ADF8NA                          WHF8NA
     I              ADACNA                          WHACNA
     I              ADADNA                          WHADNA
     I              ADAENA                          WHAENA
     I              ADAJNA                          WHAJNA
     I              ADBTTX                          WHBTTX
     I              ADAOCD                          WHAOCD
     I              ADBGCD                          WHBGCD
     I              ADVHST                          WHVHST
     I              ADMPNA                          WHMPNA
     I              ADWPST                          WHWPST
     I              ADXUST                          WHXUST
     I              ADT0ST                          WHT0ST
     I              ADT1ST                          WHT1ST
     I              ADDBNB                          WHDBNB
     I              ADT2ST                          WHT2ST
     I              ADT3ST                          WHT3ST
     I              ADT4ST                          WHT4ST
     I              ADT6ST                          WHT6ST
     I              ADBWC3                          WHBWC3
     I              ADBTC3                          WHBTC3
     I              ADBUC3                          WHBUC3
     I              ADBVC3                          WHBVC3
     I              ADFCAA                          WHFCAA
     I              ADRQSX                          WHRQSX
     I              ADRRSX                          WHRRSX
     I              ADRSSX                          WHRSSX
     I              ADRTSX                          WHRTSX
     I              ADT7ST                          WHT7ST
     I              ADT8ST                          WHT8ST
     I              ADRNSX                          WHRNSX
     I              ADROSX                          WHROSX
     I              ADRPSX                          WHRPSX
     I              ADUVST                          WHUVST
     I              ADUWST                          WHUWST
     I              ADUXST                          WHUXST
     I              ADVSST                          WHVSST
     I              ADAATM                          WHAATM
     I              ADAYNA                          WHAYNA
     I              ADA0NA                          WHA0NA
     I              ADAXDT                          WHAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WIAIC3
     I              B1HGCD                          WIHGCD
     I              B1AJCD                          WIAJCD
     I              B1ELDT                          WIELDT
     I              B1ABWG                          WIABWG
     I              B1AGQT                          WIAGQT
     I              B1AHQT                          WIAHQT
     I              B1AIQT                          WIAIQT
     I              B1CTST                          WICTST
     I              B1ACWG                          WIACWG
     I              B1ARQT                          WIARQT
     I              B1ASQT                          WIASQT
     I              B1ATQT                          WIATQT
     I              B1HDQT                          WIHDQT
     I              B1HEQT                          WIHEQT
     I              B1F6ST                          WIF6ST
     I              B1BMWG                          WIBMWG
     I              B1DSQT                          WIDSQT
     I              B1DTQT                          WIDTQT
     I              B1DUQT                          WIDUQT
     I              B1DHDT                          WIDHDT
     I              B1AGCS                          WIAGCS
     I              B1AECS                          WIAECS
     I              B1IDVA                          WIIDVA
     I              B1K7DT                          WIK7DT
     I              B1RINB                          WIRINB
     I              B1RHNB                          WIRHNB
     I              B1RGNB                          WIRGNB
     I              B1UVST                          WIUVST
     I              B1UWST                          WIUWST
     I              B1UXST                          WIUXST
     I              B1VSST                          WIVSST
     I              B1AATM                          WIAATM
     I              B1AYNA                          WIAYNA
     I              B1A0NA                          WIA0NA
     I              B1AXDT                          WIAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WJAIC3
     I              B0HGCD                          WJHGCD
     I              B0AJCD                          WJAJCD
     I              B0AGCS                          WJAGCS
     I              B0AECS                          WJAECS
     I              B0BACS                          WJBACS
     I              B0BBCS                          WJBBCS
     I              B0CBPR                          WJCBPR
     I              B0GUDT                          WJGUDT
     I              B0XYST                          WJXYST
     I              B0CTPR                          WJCTPR
     I              B0G4DT                          WJG4DT
     I              B0BOWG                          WJBOWG
     I              B0DDQT                          WJDDQT
     I              B0DEQT                          WJDEQT
     I              B0DFQT                          WJDFQT
     I              B0HDQT                          WJHDQT
     I              B0HEQT                          WJHEQT
     I              B0AJQT                          WJAJQT
     I              B0AQQT                          WJAQQT
     I              B0AUQT                          WJAUQT
     I              B0EMQT                          WJEMQT
     I              B0DOQT                          WJDOQT
     I              B0ATNA                          WJATNA
     I              B0AKDT                          WJAKDT
     I              B0ANDT                          WJANDT
     I              B0IDVA                          WJIDVA
     I              B0JVST                          WJJVST
     I              B0BZPC                          WJBZPC
     I              B0DGQT                          WJDGQT
     I              B0DIDT                          WJDIDT
     I              B0ALCD                          WJALCD
     I              B0BFDY                          WJBFDY
     I              B0DJDT                          WJDJDT
     I              B0BGDY                          WJBGDY
     I              B0DKDT                          WJDKDT
     I              B0J2ST                          WJJ2ST
     I              B0DJQT                          WJDJQT
     I              B0BNWG                          WJBNWG
     I              B0DLDT                          WJDLDT
     I              B0DPQT                          WJDPQT
     I              B0DQQT                          WJDQQT
     I              B0DMDT                          WJDMDT
     I              B0M0ST                          WJM0ST
     I              B0J9ST                          WJJ9ST
     I              B0KBST                          WJKBST
     I              B0AKC8                          WJAKC8
     I              B0RINB                          WJRINB
     I              B0RHNB                          WJRHNB
     I              B0RGNB                          WJRGNB
     I              B0UVST                          WJUVST
     I              B0UWST                          WJUWST
     I              B0UXST                          WJUXST
     I              B0VSST                          WJVSST
     I              B0AATM                          WJAATM
     I              B0AYNA                          WJAYNA
     I              B0A0NA                          WJA0NA
     I              B0AXDT                          WJAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WKAJCD
     I              L2YMCD                          WKYMCD
     I              L2YPCD                          WKYPCD
     I              L2LCBY                          WKLCBY
     I              L2LCCT                          WKLCCT
     I              L2WLUS                          WKWLUS
     I              L2WUSD                          WKWUSD
     I              L2WLUN                          WKWLUN
     I              L2AGSX                          WKAGSX
     I              L2UVST                          WKUVST
     I              L2UWST                          WKUWST
     I              L2UXST                          WKUXST
     I              L2VSST                          WKVSST
     I              L2AATM                          WKAATM
     I              L2AYNA                          WKAYNA
     I              L2A0NA                          WKA0NA
     I              L2AXDT                          WKAXDT
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          WLDOCD
     I              DPAUNA                          WLAUNA
     I              DPI5ST                          WLI5ST
     I              DPBXTX                          WLBXTX
     I              DPM8NB                          WLM8NB
     I              DPUVST                          WLUVST
     I              DPUWST                          WLUWST
     I              DPUXST                          WLUXST
     I              DPVSST                          WLVSST
     I              DPAATM                          WLAATM
     I              DPAYNA                          WLAYNA
     I              DPA0NA                          WLA0NA
     I              DPAXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     IYARDCS      DS                            163
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WJAIC3
     I              B0HGCD                          WJHGCD
     I              B0AJCD                          WJAJCD
     I              B0AGCS                          WJAGCS
     I              B0AECS                          WJAECS
     I              B0BACS                          WJBACS
     I              B0BBCS                          WJBBCS
     I              B0CBPR                          WJCBPR
     I              B0GUDT                          WJGUDT
     I              B0XYST                          WJXYST
     I              B0CTPR                          WJCTPR
     I              B0G4DT                          WJG4DT
     I              B0BOWG                          WJBOWG
     I              B0DDQT                          WJDDQT
     I              B0DEQT                          WJDEQT
     I              B0DFQT                          WJDFQT
     I              B0HDQT                          WJHDQT
     I              B0HEQT                          WJHEQT
     I              B0AJQT                          WJAJQT
     I              B0AQQT                          WJAQQT
     I              B0AUQT                          WJAUQT
     I              B0EMQT                          WJEMQT
     I              B0DOQT                          WJDOQT
     I              B0ATNA                          WJATNA
     I              B0AKDT                          WJAKDT
     I              B0ANDT                          WJANDT
     I              B0IDVA                          WJIDVA
     I              B0JVST                          WJJVST
     I              B0BZPC                          WJBZPC
     I              B0DGQT                          WJDGQT
     I              B0DIDT                          WJDIDT
     I              B0ALCD                          WJALCD
     I              B0BFDY                          WJBFDY
     I              B0DJDT                          WJDJDT
     I              B0BGDY                          WJBGDY
     I              B0DKDT                          WJDKDT
     I              B0J2ST                          WJJ2ST
     I              B0DJQT                          WJDJQT
     I              B0BNWG                          WJBNWG
     I              B0DLDT                          WJDLDT
     I              B0DPQT                          WJDPQT
     I              B0DQQT                          WJDQQT
     I              B0DMDT                          WJDMDT
     I              B0M0ST                          WJM0ST
     I              B0J9ST                          WJJ9ST
     I              B0KBST                          WJKBST
     I              B0AKC8                          WJAKC8
     I              B0RINB                          WJRINB
     I              B0RHNB                          WJRHNB
     I              B0RGNB                          WJRGNB
     I              B0UVST                          WJUVST
     I              B0UWST                          WJUWST
     I              B0UXST                          WJUXST
     I              B0VSST                          WJVSST
     I              B0AATM                          WJAATM
     I              B0AYNA                          WJAYNA
     I              B0A0NA                          WJA0NA
     I              B0AXDT                          WJAXDT
      *
     IYBRDCS      DS                            245
      * Outward parameters
     IPARC        DS                            157
      * RCD : PAR API WIM Inv Shipping2
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Ship From Warehouse
     I                                        7   9 PAVPCD
      * I :  WIM Inventory Trans ID
     I                                       10  12 PANOSC
      * I :  WIM Inventory Trans Type
     I                                       13  15 PANPSC
      * I :  Transaction Date
     I                                    P  16  190PAA9DT
      * I :  Production Date
     I                                    P  20  230PAELDT
      * I :  Item Transaction Source
     I                                       24  25 PAF1ST
      * I :  Transaction Description
     I                                       26  55 PAVQNA
      * I :  Transaction Reason Code
     I                                       56  58 PAA1AB
      * I :  Order Number
     I                                    P  59  620PAC4NB
      * I :  Shift Number
     I                                       63  63 PAXLCD
      * I :  Ship To Warehouse
     I                                       64  66 PAL9AA
      * I :  Transaction Weight
     I                                    P  67  722PAAHWG
      * I :  Transaction Quantity
     I                                    P  73  782PAA5QT
      * I :  USR Unship Flag
     I                                       79  79 PAUSST
      * I :  Inter-Plant Transfer USR
     I                                       80  80 PAA5TX
      * O :  API EccResult-MsgId U
     I                                       81  87 PACLAB
      * O :  API EccResult-MsgDesc U
     I                                       88 137 PAVGU1
      * B :  API Request Key U
     I                                      138 147 PACKAB
      * I :  API Mode U
     I                                      148 157 PACJAB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Transaction Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
      * I :  Warehouse Code
     I                                        7   9 P1AJCD
      * I :  Inventory Trans ID
     I                                       10  10 P1W9ST
      * I :  Inventory Trans Type
     I                                       11  12 P1BSST
      * I :  Transaction Date Code
     I                                    P  13  160P1B4DT
      * I :  Production Date
     I                                    P  17  200P1ELDT
      * I :  Item Transaction Source
     I                                       21  22 P1F1ST
      * I :  Description
     I                                       23  52 P1AUNA
      * N :  Transaction Quantity
     I                                    P  53  582P1A5QT
      * N :  Transaction Weight
     I                                    P  59  642P1AHWG
      * I :  Reason Code
     I                                       65  67 P1CQCD
      * I :  Lot ID
     I                                       68  77 P1MGNA
      * I :  Order Number
     I                                    P  78  810P1C4NB
      * I :  Shift Number
     I                                       82  82 P1XLCD
      * I :  Label Date
     I                                    P  83  860P1K7DT
     IP2PARM      DS
      * FLD: Company Item
      * N :  UOM Primary
     I                                        1   2 P2ADCD
      * N :  Conversion Factor 1
     I                                    P   3   74P2AWPC
      * N :  Operation Factor 1
     I                                        8   8 P2LXST
      * N :  UOM Second
     I                                        9  10 P2AECD
      * N :  Conversion Factor 2
     I                                    P  11  154P2AXPC
      * N :  Operation Factor 2
     I                                       16  16 P2LYST
      * N :  UOM Third
     I                                       17  18 P2AFCD
      * N :  UOM Pricing
     I                                       19  20 P2AICD
      * N :  Unit Weight
     I                                    P  21  262P2AIWG
      * N :  Production Date Control
     I                                       27  27 P2FZST
      * N :  Catch Weight Status
     I                                       28  28 P2AVST
     IP3PARM      DS
      * I :  USR Weight Accumulated
     I                                    P   1   62P3CDWG
     IP4PARM      DS
      * I :  Transaction Qty. Total
     I                                    P   1   62P4CZQT
     IP5PARM      DS
      * FLD: Item Balance
      * N :  Unit Cost Per Pound
     I                                    P   1   64P5AGCS
     IP6PARM      DS
      * I :  USR Unship Flag
     I                                        1   1 P6USST
     IP7PARM      DS
      * I :  Upd Both Legacy & WIM USR
     I                                        1   1 P7CIAB
     IP8PARM      DS
      * FLD: *Arrays
      * O :  Inventory Updated USR
     I                                        1   1 P8ORSC
      * O :  API was Called? U
     I                                        2   2 P8OQSC
      * I :  Called From Program
     I                                        3  12 P8COAB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1AJCD    PARM           WP0003  3        Warehouse Code
     C           P1W9ST    PARM           WP0004  1        Inventory Trans
     C           P1BSST    PARM           WP0005  2        Inventory Trans
     C           P1B4DT    PARM           WP0006  70       Transaction Dat
     C           P1ELDT    PARM           WP0007  70       Production Date
     C           P1F1ST    PARM           WP0008  2        Item Transactio
     C           P1AUNA    PARM           WP0009 30        Description
     C           P1CQCD    PARM           WP0010  3        Reason Code
     C           P1MGNA    PARM           WP0011 10        Lot ID
     C           P1C4NB    PARM           WP0012  70       Order Number
     C           P1XLCD    PARM           WP0013  1        Shift Number
     C           P1K7DT    PARM           WP0014  70       Label Date
     C           P3CDWG    PARM           WP0015 112       USR Weight Accu
     C           P4CZQT    PARM           WP0016 112       Transaction Qty
     C           P6USST    PARM           WP0017  1        USR Unship Flag
     C           P7CIAB    PARM           WP0018  1        Upd Both Legacy
     C                     PARM P8ORSC    WP0019  1        Inventory Updat
     C                     PARM P8OQSC    WP0020  1        API was Called?
     C           P8COAB    PARM           WP0021 10        Called From Pro
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Balances Issue/Adj XF
     C                     Z-ADDP4CZQT    P1A5QT           Transaction Qua
     C                     Z-ADDP3CDWG    P1AHWG           Transaction Wei
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR SARVGN
      * RTV Unit Cost          RT - IC Item Balance  * 
     C                     EXSR SBRVGN
      * ** Rtv the load id from the order and update the lot number
      * RTV Load ID            RT - Order Header TRG  * 
     C                     EXSR SCRVGN
     C                     Z-ADDWURMNB    WULXNM           Lot Number
      * 07/05/23 DN WI517-Commented Out Original Code & Moved Below.
      * 07/05/23 DN WI517-Update Both Legacy & WIM Tables?
      * CASE: PAR.Upd Both Legacy & WIM USR is No
     C           P7CIAB    IFEQ 'N'                        *IF
      *
     C                     Z-ADD*ZERO     WN0001  30       Item Structure
     C                     Z-ADD*ZERO     WN0002  30       Item Structure
     C                     Z-ADD*ZERO     WN0003  30       Item Structure
     C                     Z-ADD*ZERO     WN0004  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0005  30       Sequence Number
     C                     Z-ADD*ZERO     WN0006 114       USR Transaction
     C                     Z-ADD*ZERO     WN0007 112       Extended Amount
     C                     Z-ADD*ZERO     WN0008 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0009 112       On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0010 112       Value of On Han
     C                     Z-ADD*ZERO     WN0011 112       Quantity based
     C                     Z-ADD*ZERO     WN0012 112       Quantity based
     C                     Z-ADD*ZERO     WN0013 112       Quantity based
     C                     Z-ADD*ZERO     WN0014 114       Cost based on U
     C                     Z-ADD*ZERO     WN0015 114       Cost based on U
     C                     Z-ADD*ZERO     WN0016 114       Cost based on U
     C                     Z-ADD*ZERO     WN0017 112       Quantity Total
     C                     Z-ADD*ZERO     WN0018 112       USR Transaction
     C                     MOVEL*BLANK    WN0019  3        USR Reason Code
      *
      * UPD Balances Issue/Adj2IF
      * NOTE: Cloned from 'UPD Balances Issue/Adj IF' but this one will
      *       update the Legacy tables only. Any changes here should
      *       consider changing 'UPD Balances Issue/Adj IF'.
      * WI517 DN 07/05/23-Get WIM Module Release Status.
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'WIM'     WL0001    P      Module ID
     C                     Z-ADD1         WL0002           Release Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0001    P      Module Release
      * 07/05/23 DN WI517-Call Legacy Process if Not Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0001    IFEQ 'N'                        *IF
     C           YL0001    OREQ 'P'                        *OR
     C                     Z-ADDP1A5QT    WN0017           Quantity Total
     C                     Z-ADDP1AHWG    WN0018           USR Transaction
      * Adjust quantity, weight for trans type (make negative if issue)
      * CASE: PAR.Inventory Trans. Type is Issue types
     C           P1BSST    IFEQ 'I'                        *IF
     C           P1BSST    OREQ 'IO'
     C           P1BSST    OREQ 'RW'
      * CASE: PAR.USR Unship Flag is yes
     C           P6USST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Qty
      * CASE: PAR.Transaction Quantity GT WRK.ZERO
     C           P1A5QT    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  P1A5QT    WN0017           Quantity Total
     C                     END                             *FI
      * Wgt
      * CASE: PAR.Transaction Weight GT WRK.ZERO
     C           P1AHWG    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  P1AHWG    WN0018           USR Transaction
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      *
     C                     Z-ADD*ZERO     WN0020 112       Quantity based
     C                     Z-ADD*ZERO     WN0021 112       Quantity based
     C                     Z-ADD*ZERO     WN0022 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0011           USR Qty based o
     C                     Z-ADD*ZERO     WN0012           USR Qty based o
     C                     Z-ADD*ZERO     WN0013           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           P2ADCD    IFEQ P2ADCD                     *IF
     C                     Z-ADDWN0017    WN0011           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           WN0017    MULT P2AWPC    WN0021    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0017    DIV  P2AWPC    WN0021    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0021    WN0012           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           WN0021    MULT P2AXPC    WN0022    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0021    DIV  P2AXPC    WN0022    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0022    WN0013           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           P2AECD    IFEQ P2ADCD                     *IF
     C                     Z-ADDWN0017    WN0012           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0017    DIV  P2AWPC    WN0011    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           WN0017    MULT P2AWPC    WN0011    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           WN0017    MULT P2AXPC    WN0022    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0017    DIV  P2AXPC    WN0022    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0022    WN0013           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           P2AFCD    IFEQ P2ADCD                     *IF
     C                     Z-ADDWN0017    WN0013           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0017    DIV  P2AXPC    WN0021    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           WN0017    MULT P2AXPC    WN0021    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0021    WN0012           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0021    DIV  P2AWPC    WN0011    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           WN0021    MULT P2AWPC    WN0011    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0023 114       Cost based on U
     C                     Z-ADD*ZERO     WN0024 114       Cost based on U
     C                     Z-ADD*ZERO     WN0025 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0014           Cost based on U
     C                     Z-ADD*ZERO     WN0015           Cost based on U
     C                     Z-ADD*ZERO     WN0016           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           P2ADCD    IFEQ 'LB'                       *IF
     C                     Z-ADDP5AGCS    WN0014           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P5AGCS    DIV  P2AWPC    WN0024    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           P5AGCS    MULT P2AWPC    WN0024    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0024    WN0015           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0024    DIV  P2AXPC    WN0016    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           WN0024    MULT P2AXPC    WN0016    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           P2AECD    IFEQ 'LB'                       *IF
     C                     Z-ADDP5AGCS    WN0015           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           P5AGCS    MULT P2AWPC    WN0014    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P5AGCS    DIV  P2AWPC    WN0014    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P5AGCS    DIV  P2AXPC    WN0016    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           P5AGCS    MULT P2AXPC    WN0016    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           P2AFCD    IFEQ 'LB'                       *IF
     C                     Z-ADDP5AGCS    WN0016           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           P5AGCS    MULT P2AXPC    WN0024    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P5AGCS    DIV  P2AXPC    WN0024    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0024    WN0015           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           WN0024    MULT P2AWPC    WN0014    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0024    DIV  P2AWPC    WN0014    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P5AGCS    MULT WN0018    WN0007           Extended Amount
     C                     MOVELP1CQCD    WN0019           USR Reason Code
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0004           Company Number
     C                     Z-ADDP1HGCD    WL0005           Item Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0001           Item Structure
     C                     Z-ADDWL0007    WN0002           Item Structure
     C                     Z-ADDWL0008    WN0003           Item Structure
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP1HGCD    WL0010           Item Code
     C                     MOVELP1AJCD    WL0011    P      Warehouse Code
     C                     MOVELP1W9ST    WL0012    P      Inventory Trans
     C                     MOVELP1BSST    WL0013    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0014           Transaction Dat
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    WN0004           ITD Sequence Nu
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           P5AGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0019           USR Reason Code
     C                     END                             *FI
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0016           Company Number
     C                     Z-ADDP1HGCD    WL0017           Item Code
     C                     MOVELP1AJCD    WL0018    P      Warehouse Code
     C                     MOVELP1W9ST    WL0019    P      Inventory Trans
     C                     MOVELP1BSST    WL0020    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0021           Transaction Dat
     C                     Z-ADDWN0004    WL0022           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0023           Sequence Number
     C                     Z-ADDP1ELDT    WL0024           Production Date
     C                     MOVELP2ADCD    WL0025    P      UOM Transaction
     C                     MOVELP1F1ST    WL0026    P      Item Transactio
     C                     MOVELP1AUNA    WL0027    P      Description
     C                     Z-ADDWN0017    WL0028           Transaction Qua
     C                     Z-ADDWN0018    WL0029           Transaction Wei
     C                     Z-ADD*ZERO     WL0030           USR Transaction
     C                     MOVEL'LB'      WL0031    P      UOM Cost
     C                     Z-ADDWN0007    WL0032           Extended Amount
     C                     MOVEL*BLANK    WL0033           Ticket Number
     C                     Z-ADD*ZERO     WL0034           GL Document Num
     C                     MOVEL*BLANK    WL0035           GL Update Statu
     C                     MOVELWN0019    WL0036    P      Reason Code
     C                     MOVEL*BLANK    WL0037           Reference Numbe
     C                     MOVELP1MGNA    WL0038    P      Lot ID
     C                     Z-ADD*ZERO     WL0039           Transfer Batch
     C                     Z-ADD*ZERO     WL0040           Transfer Batch
     C                     Z-ADDP1C4NB    WL0041           Order Number
     C                     Z-ADDWN0001    WL0042           Item Structure
     C                     Z-ADDWN0002    WL0043           Item Structure
     C                     Z-ADDWN0003    WL0044           Item Structure
     C                     MOVEL*BLANK    WL0045           Employee Badge
     C                     Z-ADD*ZERO     WL0046           Production Time
     C                     MOVELP1XLCD    WL0047    P      Shift Number
     C                     Z-ADDP1K7DT    WL0048           Label Date
     C                     MOVEL*BLANK    WL0049           EDI Status 1
     C                     MOVEL*BLANK    WL0050           EDI Status 2
     C                     MOVEL*BLANK    WL0051           EDI Status 3
     C                     MOVEL'A'       WL0052    P      Record Status
     C                     EXSR SGCRRC
      * ** This creates or updates Item Balance Detail
      * CHG Value/Qty/Wgt      CH - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0053           Company Number
     C                     Z-ADDP1HGCD    WL0054           Item Code
     C                     MOVELP1AJCD    WL0055    P      Warehouse Code
     C                     Z-ADDP1ELDT    WL0056           Production Date
     C                     Z-ADDWN0001    WL0057           Item Structure
     C                     Z-ADDWN0002    WL0058           Item Structure
     C                     Z-ADDWN0003    WL0059           Item Structure
     C                     MOVELP2ADCD    WL0060    P      UOM Primary
     C                     Z-ADDP2AWPC    WL0061           Conversion Fact
     C                     MOVELP2LXST    WL0062    P      Operation Facto
     C                     MOVELP2AECD    WL0063    P      UOM Second
     C                     Z-ADDP2AXPC    WL0064           Conversion Fact
     C                     MOVELP2LYST    WL0065    P      Operation Facto
     C                     MOVELP2AFCD    WL0066    P      UOM Third
     C                     MOVELP2FZST    WL0067    P      Production Date
     C                     MOVELP2AVST    WL0068    P      Catch Weight St
     C                     MOVELP1W9ST    WL0069    P      Inventory Trans
     C                     MOVELP1BSST    WL0070    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0071           Transaction Dat
     C                     MOVELP2ADCD    WL0072    P      UOM Transaction
     C                     Z-ADDWN0011    WL0073           Transaction Qua
     C                     Z-ADDWN0018    WL0074           Transaction Wei
     C                     Z-ADDP5AGCS    WL0075           USR Transaction
     C                     MOVEL'LB'      WL0076    P      UOM Cost
     C                     Z-ADDWN0007    WL0077           Extended Amount
     C                     Z-ADDP1K7DT    WL0078           Label Date  USR
     C                     EXSR SHCHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0079           Company Number
     C                     Z-ADDP1HGCD    WL0080           Item Code
     C                     MOVELP1AJCD    WL0081    P      Warehouse Code
     C                     Z-ADDWN0008    WL0082           Quantity on Han
     C                     Z-ADDWN0009    WL0083           Quantity on Han
     C                     Z-ADDWUNFNN    WL0084           Quantity on Han
     C                     Z-ADDWUNFNN    WL0085           Quantity on Han
     C                     Z-ADDWN0010    WL0086           Value of On Han
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WN0008           Quantity on Han
     C                     Z-ADDWL0083    WN0009           Quantity on Han
     C                     Z-ADDWL0084    WUNFNN           Quantity on Han
     C                     Z-ADDWL0085    WUNFNN           Quantity on Han
     C                     Z-ADDWL0086    WN0010           Value of On Han
      * Chg Val/Qty/Wgt        Ch - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0087           Company Number
     C                     Z-ADDP1HGCD    WL0088           Item Code
     C                     MOVELP1AJCD    WL0089    P      Warehouse Code
     C                     Z-ADDWN0008    WL0090           On Hand Weight
     C                     Z-ADDWN0009    WL0091           On Hand UOM1 Su
     C                     Z-ADDWN0010    WL0092           Value of On Han
     C                     EXSR SMCHRC
      * ** Process Auto-Locate Whse inventory             FP1127
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0093    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0094    YN0001    P      Warehouse Descr
     C                     MOVELWL0095    YN0002    P      Address Line 1
     C                     MOVELWL0096    YN0003    P      Address Line 2
     C                     MOVELWL0097    YN0004    P      Address Line 3
     C                     MOVELWL0098    YN0005    P      City
     C                     MOVELWL0099    YN0006    P      Zip Postal Code
     C                     MOVELWL0100    YN0007    P      Production Ware
     C                     MOVELWL0101    YN0008    P      State Code
     C                     MOVELWL0102    YL0002    P      Lot Tracking Fl
     C                     MOVELWL0103    YN0009    P      Default Printer
     C                     MOVELWL0104    YN0010    P      Warehouse Type
     C                     MOVELWL0105    YN0011    P      Trans Contol AS
     C                     MOVELWL0106    YL0003    P      Warehouse Locat
     C                     MOVELWL0107    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0108    YN0013           Warehouse Chill
     C                     MOVELWL0109    YN0014    P      Include in Auto
     C                     MOVELWL0110    YN0015    P      Default Manifes
     C                     MOVELWL0111    YN0016    P      Default Load Se
     C                     MOVELWL0112    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0113    YN0018           Shipping Compan
     C                     Z-ADDWL0114    YN0019           Accounting Comp
     C                     Z-ADDWL0115    YN0020           WHS Sched Prod
     C                     Z-ADDWL0116    YN0021           WHS Inventory C
     C                     MOVELWL0117    YN0022    P      Parent Warehous
     C                     MOVELWL0118    YN0023    P      Default Shippin
     C                     MOVELWL0119    YL0004    P      WHS Live with C
     C                     MOVELWL0120    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0121    YN0025    P      WHS Req Meter R
     C                     MOVELWL0122    YN0026    P      WHS Default Loa
     C                     MOVELWL0123    YN0027    P      WHS TMS Plannin
     C                     MOVELWL0124    YN0028    P      Default Carrier
     C                     MOVELWL0125    YN0029    P      Inventory Logic
     C                     MOVELWL0126    YN0030    P      WHS Auto Inv Re
     C                     MOVELWL0127    YN0031    P      EDI Status 1
     C                     MOVELWL0128    YN0032    P      EDI Status 2
     C                     MOVELWL0129    YN0033    P      EDI Status 3
     C                     MOVELWL0130    YN0034    P      Record Status
     C                     Z-ADDWL0131    YN0035           Job Time
     C                     MOVELWL0132    YN0036    P      User Id
     C                     MOVELWL0133    YN0037    P      Job Name
     C                     Z-ADDWL0134    YN0038           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'E'                        *IF
     C           YL0004    IFEQ *BLANK                     *IF
     C           YL0004    OREQ 'N'
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** For External whses: level=0, lot=last 5 digits of Load ID (opt
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0135    P      Warehouse Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0136    WUYMCD    P      Location Code
     C                     MOVELWL0137    YL0005    P      Location Aisle
     C                     Z-ADDWL0138    YL0006           Location Bay
     C                     Z-ADDWL0139    YL0007           Loc Unused Chil
     C                     MOVEL*BLANK    YL0008           Order Type_Sale
      * RTV Order Type         RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0140           Company Number
     C                     Z-ADDP1C4NB    WL0141           Order Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0008    P      Order Type_Sale
      * ** Upd/add lot info if Transfer, or Issue, but not for shipped or
      * CASE:
      *  - c1 OR c3
      *   |- c1    : LCL.Order Type - Sales is Not Regular Order
      *   |- c3    : PAR.Order Number is Equal to zeros
      *   '-
     C           YL0008    IFNE 'OR'                       *IF
     C           P1C4NB    OREQ 0                          *OR
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0056  30       Company Number
     C                     PARM P1HGCD    WQ0057  70       Item Code
     C                     PARM P1AJCD    WQ0058  3        Warehouse Code
     C                     PARM P1ELDT    WQ0059  70       Production Date
     C                     PARM WULXNM    WQ0060  50       Lot Number
     C                     PARM WUYMCD    WQ0061  4        Location Code
     C                     PARM WUYNCD    WQ0062  20       Location Level
     C                     PARM WN0017    WQ0063  70       Quantity Loc Tr
     C                     PARM P1C4NB    WQ0064  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Update Both Legacy & WIM Tables.
      *
     C                     Z-ADD*ZERO     WN0122  30       Item Structure
     C                     Z-ADD*ZERO     WN0123  30       Item Structure
     C                     Z-ADD*ZERO     WN0124  30       Item Structure
     C                     Z-ADD*ZERO     WN0125  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0126  30       Sequence Number
     C                     Z-ADD*ZERO     WN0127 114       USR Transaction
     C                     Z-ADD*ZERO     WN0128 112       Extended Amount
     C                     Z-ADD*ZERO     WN0129 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0130 112       On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0131 112       Value of On Han
     C                     Z-ADD*ZERO     WN0132 112       Quantity based
     C                     Z-ADD*ZERO     WN0133 112       Quantity based
     C                     Z-ADD*ZERO     WN0134 112       Quantity based
     C                     Z-ADD*ZERO     WN0135 114       Cost based on U
     C                     Z-ADD*ZERO     WN0136 114       Cost based on U
     C                     Z-ADD*ZERO     WN0137 114       Cost based on U
     C                     Z-ADD*ZERO     WN0138 112       Quantity Total
     C                     Z-ADD*ZERO     WN0139 112       USR Transaction
     C                     MOVEL*BLANK    WN0140  3        USR Reason Code
      *
      * UPD Balances Issue/Adj IF
      * NOTES: WI517 DN 10/09/23-Per Business (Ace C./Ryan H.), we will N
      *        pass in the 'negative' Qty/Wgt when processing the WIM API
      *        WIM API logic will handle this scenario.
      * WI517 DN 07/05/23-Get WIM Module Release Status.
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'WIM'     WL0001    P      Module ID
     C                     Z-ADD1         WL0002           Release Number
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0009    P      Module Release
     C                     MOVEL'N'       P8ORSC           Inventory Updat
     C                     MOVEL'N'       P8OQSC           API was Called?
      * 08/10/23 DN WI517-Call Existing Legacy Process.
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5QT    WN0138           Quantity Total
     C                     Z-ADDP1AHWG    WN0139           USR Transaction
      * Adjust quantity, weight for trans type (make negative if issue)
      * CASE: PAR.Inventory Trans. Type is Issue types
     C           P1BSST    IFEQ 'I'                        *IF
     C           P1BSST    OREQ 'IO'
     C           P1BSST    OREQ 'RW'
      * CASE: PAR.USR Unship Flag is yes
     C           P6USST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Qty
      * CASE: PAR.Transaction Quantity GT WRK.ZERO
     C           P1A5QT    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  P1A5QT    WN0138           Quantity Total
     C                     END                             *FI
      * Wgt
      * CASE: PAR.Transaction Weight GT WRK.ZERO
     C           P1AHWG    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  P1AHWG    WN0139           USR Transaction
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      *
     C                     Z-ADD*ZERO     WN0141 112       Quantity based
     C                     Z-ADD*ZERO     WN0142 112       Quantity based
     C                     Z-ADD*ZERO     WN0143 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0132           USR Qty based o
     C                     Z-ADD*ZERO     WN0133           USR Qty based o
     C                     Z-ADD*ZERO     WN0134           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           P2ADCD    IFEQ P2ADCD                     *IF
     C                     Z-ADDWN0138    WN0132           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           WN0138    MULT P2AWPC    WN0142    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0138    DIV  P2AWPC    WN0142    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0142    WN0133           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           WN0142    MULT P2AXPC    WN0143    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0142    DIV  P2AXPC    WN0143    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0143    WN0134           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           P2AECD    IFEQ P2ADCD                     *IF
     C                     Z-ADDWN0138    WN0133           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0138    DIV  P2AWPC    WN0132    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           WN0138    MULT P2AWPC    WN0132    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           WN0138    MULT P2AXPC    WN0143    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0138    DIV  P2AXPC    WN0143    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0143    WN0134           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           P2AFCD    IFEQ P2ADCD                     *IF
     C                     Z-ADDWN0138    WN0134           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0138    DIV  P2AXPC    WN0142    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           WN0138    MULT P2AXPC    WN0142    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0142    WN0133           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0142    DIV  P2AWPC    WN0132    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           WN0142    MULT P2AWPC    WN0132    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0144 114       Cost based on U
     C                     Z-ADD*ZERO     WN0145 114       Cost based on U
     C                     Z-ADD*ZERO     WN0146 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0135           Cost based on U
     C                     Z-ADD*ZERO     WN0136           Cost based on U
     C                     Z-ADD*ZERO     WN0137           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           P2ADCD    IFEQ 'LB'                       *IF
     C                     Z-ADDP5AGCS    WN0135           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P5AGCS    DIV  P2AWPC    WN0145    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           P5AGCS    MULT P2AWPC    WN0145    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0145    WN0136           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0145    DIV  P2AXPC    WN0137    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           WN0145    MULT P2AXPC    WN0137    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           P2AECD    IFEQ 'LB'                       *IF
     C                     Z-ADDP5AGCS    WN0136           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           P5AGCS    MULT P2AWPC    WN0135    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P5AGCS    DIV  P2AWPC    WN0135    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P5AGCS    DIV  P2AXPC    WN0137    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           P5AGCS    MULT P2AXPC    WN0137    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           P2AFCD    IFEQ 'LB'                       *IF
     C                     Z-ADDP5AGCS    WN0137           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           P5AGCS    MULT P2AXPC    WN0145    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P5AGCS    DIV  P2AXPC    WN0145    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0145    WN0136           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           WN0145    MULT P2AWPC    WN0135    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0145    DIV  P2AWPC    WN0135    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P5AGCS    MULT WN0139    WN0128           Extended Amount
     C                     MOVELP1CQCD    WN0140           USR Reason Code
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           P5AGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0140           USR Reason Code
     C                     END                             *FI
      * 08/10/23 DN WI517-Call Legacy Process if Not Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0009    IFEQ 'N'                        *IF
     C           YL0009    OREQ 'P'                        *OR
      * 09/22/23 DN WI517-Set 'Inventory Updated USR' Flag.
     C                     MOVEL'Y'       P8ORSC           Inventory Updat
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0004           Company Number
     C                     Z-ADDP1HGCD    WL0005           Item Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    WN0122           Item Structure
     C                     Z-ADDWL0007    WN0123           Item Structure
     C                     Z-ADDWL0008    WN0124           Item Structure
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP1HGCD    WL0010           Item Code
     C                     MOVELP1AJCD    WL0011    P      Warehouse Code
     C                     MOVELP1W9ST    WL0012    P      Inventory Trans
     C                     MOVELP1BSST    WL0013    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0014           Transaction Dat
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    WN0125           ITD Sequence Nu
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0016           Company Number
     C                     Z-ADDP1HGCD    WL0017           Item Code
     C                     MOVELP1AJCD    WL0018    P      Warehouse Code
     C                     MOVELP1W9ST    WL0019    P      Inventory Trans
     C                     MOVELP1BSST    WL0020    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0021           Transaction Dat
     C                     Z-ADDWN0125    WL0022           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0023           Sequence Number
     C                     Z-ADDP1ELDT    WL0024           Production Date
     C                     MOVELP2ADCD    WL0025    P      UOM Transaction
     C                     MOVELP1F1ST    WL0026    P      Item Transactio
     C                     MOVELP1AUNA    WL0027    P      Description
     C                     Z-ADDWN0138    WL0028           Transaction Qua
     C                     Z-ADDWN0139    WL0029           Transaction Wei
     C                     Z-ADD*ZERO     WL0030           USR Transaction
     C                     MOVEL'LB'      WL0031    P      UOM Cost
     C                     Z-ADDWN0128    WL0032           Extended Amount
     C                     MOVEL*BLANK    WL0033           Ticket Number
     C                     Z-ADD*ZERO     WL0034           GL Document Num
     C                     MOVEL*BLANK    WL0035           GL Update Statu
     C                     MOVELWN0140    WL0036    P      Reason Code
     C                     MOVEL*BLANK    WL0037           Reference Numbe
     C                     MOVELP1MGNA    WL0038    P      Lot ID
     C                     Z-ADD*ZERO     WL0039           Transfer Batch
     C                     Z-ADD*ZERO     WL0040           Transfer Batch
     C                     Z-ADDP1C4NB    WL0041           Order Number
     C                     Z-ADDWN0122    WL0042           Item Structure
     C                     Z-ADDWN0123    WL0043           Item Structure
     C                     Z-ADDWN0124    WL0044           Item Structure
     C                     MOVEL*BLANK    WL0045           Employee Badge
     C                     Z-ADD*ZERO     WL0046           Production Time
     C                     MOVELP1XLCD    WL0047    P      Shift Number
     C                     Z-ADDP1K7DT    WL0048           Label Date
     C                     MOVEL*BLANK    WL0049           EDI Status 1
     C                     MOVEL*BLANK    WL0050           EDI Status 2
     C                     MOVEL*BLANK    WL0051           EDI Status 3
     C                     MOVEL'A'       WL0052    P      Record Status
     C                     EXSR SGCRRC
      * ** This creates or updates Item Balance Detail
      * CHG Value/Qty/Wgt      CH - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0053           Company Number
     C                     Z-ADDP1HGCD    WL0054           Item Code
     C                     MOVELP1AJCD    WL0055    P      Warehouse Code
     C                     Z-ADDP1ELDT    WL0056           Production Date
     C                     Z-ADDWN0122    WL0057           Item Structure
     C                     Z-ADDWN0123    WL0058           Item Structure
     C                     Z-ADDWN0124    WL0059           Item Structure
     C                     MOVELP2ADCD    WL0060    P      UOM Primary
     C                     Z-ADDP2AWPC    WL0061           Conversion Fact
     C                     MOVELP2LXST    WL0062    P      Operation Facto
     C                     MOVELP2AECD    WL0063    P      UOM Second
     C                     Z-ADDP2AXPC    WL0064           Conversion Fact
     C                     MOVELP2LYST    WL0065    P      Operation Facto
     C                     MOVELP2AFCD    WL0066    P      UOM Third
     C                     MOVELP2FZST    WL0067    P      Production Date
     C                     MOVELP2AVST    WL0068    P      Catch Weight St
     C                     MOVELP1W9ST    WL0069    P      Inventory Trans
     C                     MOVELP1BSST    WL0070    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0071           Transaction Dat
     C                     MOVELP2ADCD    WL0072    P      UOM Transaction
     C                     Z-ADDWN0132    WL0073           Transaction Qua
     C                     Z-ADDWN0139    WL0074           Transaction Wei
     C                     Z-ADDP5AGCS    WL0075           USR Transaction
     C                     MOVEL'LB'      WL0076    P      UOM Cost
     C                     Z-ADDWN0128    WL0077           Extended Amount
     C                     Z-ADDP1K7DT    WL0078           Label Date  USR
     C                     EXSR SHCHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0079           Company Number
     C                     Z-ADDP1HGCD    WL0080           Item Code
     C                     MOVELP1AJCD    WL0081    P      Warehouse Code
     C                     Z-ADDWN0129    WL0082           Quantity on Han
     C                     Z-ADDWN0130    WL0083           Quantity on Han
     C                     Z-ADDWUNFNN    WL0084           Quantity on Han
     C                     Z-ADDWUNFNN    WL0085           Quantity on Han
     C                     Z-ADDWN0131    WL0086           Value of On Han
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WN0129           Quantity on Han
     C                     Z-ADDWL0083    WN0130           Quantity on Han
     C                     Z-ADDWL0084    WUNFNN           Quantity on Han
     C                     Z-ADDWL0085    WUNFNN           Quantity on Han
     C                     Z-ADDWL0086    WN0131           Value of On Han
      * Chg Val/Qty/Wgt        Ch - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0087           Company Number
     C                     Z-ADDP1HGCD    WL0088           Item Code
     C                     MOVELP1AJCD    WL0089    P      Warehouse Code
     C                     Z-ADDWN0129    WL0090           On Hand Weight
     C                     Z-ADDWN0130    WL0091           On Hand UOM1 Su
     C                     Z-ADDWN0131    WL0092           Value of On Han
     C                     EXSR SMCHRC
      * ** Process Auto-Locate Whse inventory             FP1127
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0093    P      Warehouse Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0094    YN0039    P      Warehouse Descr
     C                     MOVELWL0095    YN0040    P      Address Line 1
     C                     MOVELWL0096    YN0041    P      Address Line 2
     C                     MOVELWL0097    YN0042    P      Address Line 3
     C                     MOVELWL0098    YN0043    P      City
     C                     MOVELWL0099    YN0044    P      Zip Postal Code
     C                     MOVELWL0100    YN0045    P      Production Ware
     C                     MOVELWL0101    YN0046    P      State Code
     C                     MOVELWL0102    YL0010    P      Lot Tracking Fl
     C                     MOVELWL0103    YN0047    P      Default Printer
     C                     MOVELWL0104    YN0048    P      Warehouse Type
     C                     MOVELWL0105    YN0049    P      Trans Contol AS
     C                     MOVELWL0106    YL0011    P      Warehouse Locat
     C                     MOVELWL0107    YN0050    P      Warehouse Std C
     C                     Z-ADDWL0108    YN0051           Warehouse Chill
     C                     MOVELWL0109    YN0052    P      Include in Auto
     C                     MOVELWL0110    YN0053    P      Default Manifes
     C                     MOVELWL0111    YN0054    P      Default Load Se
     C                     MOVELWL0112    YN0055    P      WHS Slotting Li
     C                     Z-ADDWL0113    YN0056           Shipping Compan
     C                     Z-ADDWL0114    YN0057           Accounting Comp
     C                     Z-ADDWL0115    YN0058           WHS Sched Prod
     C                     Z-ADDWL0116    YN0059           WHS Inventory C
     C                     MOVELWL0117    YN0060    P      Parent Warehous
     C                     MOVELWL0118    YN0061    P      Default Shippin
     C                     MOVELWL0119    YL0012    P      WHS Live with C
     C                     MOVELWL0120    YN0062    P      WHS PFS Interfa
     C                     MOVELWL0121    YN0063    P      WHS Req Meter R
     C                     MOVELWL0122    YN0064    P      WHS Default Loa
     C                     MOVELWL0123    YN0065    P      WHS TMS Plannin
     C                     MOVELWL0124    YN0066    P      Default Carrier
     C                     MOVELWL0125    YN0067    P      Inventory Logic
     C                     MOVELWL0126    YN0068    P      WHS Auto Inv Re
     C                     MOVELWL0127    YN0069    P      EDI Status 1
     C                     MOVELWL0128    YN0070    P      EDI Status 2
     C                     MOVELWL0129    YN0071    P      EDI Status 3
     C                     MOVELWL0130    YN0072    P      Record Status
     C                     Z-ADDWL0131    YN0073           Job Time
     C                     MOVELWL0132    YN0074    P      User Id
     C                     MOVELWL0133    YN0075    P      Job Name
     C                     Z-ADDWL0134    YN0076           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'E'                        *IF
     C           YL0012    IFEQ *BLANK                     *IF
     C           YL0012    OREQ 'N'
     C           YL0010    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** For External whses: level=0, lot=last 5 digits of Load ID (opt
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0135    P      Warehouse Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0136    WUYMCD    P      Location Code
     C                     MOVELWL0137    YL0013    P      Location Aisle
     C                     Z-ADDWL0138    YL0014           Location Bay
     C                     Z-ADDWL0139    YL0015           Loc Unused Chil
     C                     MOVEL*BLANK    YL0016           Order Type_Sale
      * RTV Order Type         RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0140           Company Number
     C                     Z-ADDP1C4NB    WL0141           Order Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0142    YL0016    P      Order Type_Sale
      * ** Upd/add lot info if Transfer, or Issue, but not for shipped or
      * CASE:
      *  - c1 OR c3
      *   |- c1    : LCL.Order Type - Sales is Not Regular Order
      *   |- c3    : PAR.Order Number is Equal to zeros
      *   '-
     C           YL0016    IFNE 'OR'                       *IF
     C           P1C4NB    OREQ 0                          *OR
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0065  30       Company Number
     C                     PARM P1HGCD    WQ0066  70       Item Code
     C                     PARM P1AJCD    WQ0067  3        Warehouse Code
     C                     PARM P1ELDT    WQ0068  70       Production Date
     C                     PARM WULXNM    WQ0069  50       Lot Number
     C                     PARM WUYMCD    WQ0070  4        Location Code
     C                     PARM WUYNCD    WQ0071  20       Location Level
     C                     PARM WN0138    WQ0072  70       Quantity Loc Tr
     C                     PARM P1C4NB    WQ0073  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * 09/27/24 DN SR20410-Commented Out & Moved Below.
      * 09/27/24 DN SR20410-Commented Out & Moved Below.
      * 09/27/24 DN SR20410-Only Call if NOT from PDLYXFR Program.
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.Called From Program is UPD Backin Spec'l Adj  XF
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P8COAB    IFEQ @CN,002                    *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 08/10/23 DN WI517-Call WIM API if Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Is Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0009    IFEQ 'Y'                        *IF
     C           YL0009    OREQ 'P'                        *OR
     C                     MOVEL'Y'       P8OQSC           API was Called?
     C                     MOVEL*BLANK    YL0017           API EccResult-M
     C                     MOVEL*BLANK    YL0018           API EccResult-M
     C                     MOVEL*BLANK    YL0019           API Request Key
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,003   CAT  'ry':ZQ   YL0020    P      API Name
      * RTV Numeric Value      RT - System Values  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL@CN,004   WL0143    P      System Value Co
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0144    YL0021           System Value Nu
      * Call API Wrapper Program for wim.ordershipping.inventory API.
      * 1/6/24 DN SR08283-Added 'API Request Key U' & 'API Mode U' Parms.
      * API WIM Inv Shipping   UP - WIM Item Trans Detail  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
     C                     Z-ADDP1HGCD    PAHGCD           Item Code
     C                     MOVELP1AJCD    PAVPCD    P      Ship From Wareh
     C                     MOVELP1W9ST    PANOSC    P      WIM Inventory T
     C                     MOVELP1BSST    PANPSC    P      WIM Inventory T
     C                     Z-ADDP1B4DT    PAA9DT           Transaction Dat
     C                     Z-ADDP1ELDT    PAELDT           Production Date
     C                     MOVELP1F1ST    PAF1ST    P      Item Transactio
     C                     MOVELP1AUNA    PAVQNA    P      Transaction Des
     C                     MOVEL*BLANK    PAA1AB    P      Transaction Rea
     C                     Z-ADDP1C4NB    PAC4NB           Order Number
     C                     MOVELP1XLCD    PAXLCD    P      Shift Number
     C                     MOVEL*BLANK    PAL9AA    P      Ship To Warehou
     C                     Z-ADDP1AHWG    PAAHWG           Transaction Wei
     C                     Z-ADDP1A5QT    PAA5QT           Transaction Qua
     C                     MOVELP6USST    PAUSST    P      USR Unship Flag
     C                     MOVEL'N'       PAA5TX    P      Inter-Plant Tra
     C                     MOVELYL0019    PACKAB    P      API Request Key
     C                     MOVEL'*SNDRCV' PACJAB    P      API Mode U
      *
     C                     CALL 'PVAYUPR'              90  API WIM Inv Shi
     C                     PARM YL0021    WQ0074  50       API Wait Time U
     C                     PARM           PARC             RCD: *Arrays
      *
     C                     MOVELPACLAB    YL0017           API EccResult-M
     C                     MOVELPAVGU1    YL0018           API EccResult-M
     C                     MOVELPACKAB    YL0019           API Request Key
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVAYUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * API Call Successful? If Not, Create Log & Send Email.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.API EccResult-MsgId U is Success
      *   |- c2    : LCL.API EccResult-MsgId U is Timeout
      *   '-
     C           YL0017    IFEQ @CN,005                    *IF
     C           YL0017    OREQ @CN,006                    *OR
     C                     MOVEL'Y'       P8ORSC           Inventory Updat
      * 01/06/24 DN SR08283-Create Log Record for Timeout Transaction.
      * CASE: LCL.API EccResult-MsgId U is Timeout
     C           YL0017    IFEQ @CN,006                    *IF
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Timeout Failur
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0020    WQ0075 45        API Name
     C                     PARM YL0017    WQ0076  7        API EccResult M
     C                     PARM YL0018    WQ0077 50        API EccResult-M
     C                     PARM YL0019    WQ0078 10        API Request Key
     C                     PARM P8COAB    WQ0079 10        Called From Pro
     C                     PARM P1AIC3    WQ0080  30       Company Number
     C                     PARM P1HGCD    WQ0081  70       Item Code
     C                     PARM P1AJCD    WQ0082  3        Ship From Wareh
     C                     PARM P1W9ST    WQ0083  3        WIM Inventory T
     C                     PARM P1BSST    WQ0084  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0085  70       Transaction Dat
     C                     PARM P1ELDT    WQ0086  70       Production Date
     C                     PARM P1F1ST    WQ0087  2        Item Transactio
     C                     PARM P1AUNA    WQ0088 30        Transaction Des
     C                     PARM *BLANK    WQ0089  3        Transaction Rea
     C                     PARM P1C4NB    WQ0090  70       Order Number
     C                     PARM P1XLCD    WQ0091  1        Shift Number
     C                     PARM *BLANK    WQ0092  3        Ship To Warehou
     C                     PARM P1AHWG    WQ0093 112       Transaction Wei
     C                     PARM P1A5QT    WQ0094 112       Transaction Qua
     C                     PARM 'N'       WQ0095  1        Unship Flag
     C                     PARM 'N'       WQ0096  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 12/21/23 DN SR07943-Added 'API EccResult-MsgId U is Entered' Cond
      * CASE: LCL.API EccResult-MsgId U is Entered
     C           YL0017    IFNE *BLANK                     *IF
     C                     MOVEL'N'       P8ORSC           Inventory Updat
      * 1/6/24 DN SR08283-Added 'API Request Key' as Input Parm.
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Hardstop Failu
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0020    WQ0097 45        API Name
     C                     PARM YL0017    WQ0098  7        API EccResult M
     C                     PARM YL0018    WQ0099 50        API EccResult-M
     C                     PARM YL0019    WQ0100 10        API Request Key
     C                     PARM P8COAB    WQ0101 10        Called From Pro
     C                     PARM P1AIC3    WQ0102  30       Company Number
     C                     PARM P1HGCD    WQ0103  70       Item Code
     C                     PARM P1AJCD    WQ0104  3        Ship From Wareh
     C                     PARM P1W9ST    WQ0105  3        WIM Inventory T
     C                     PARM P1BSST    WQ0106  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0107  70       Transaction Dat
     C                     PARM P1ELDT    WQ0108  70       Production Date
     C                     PARM P1F1ST    WQ0109  2        Item Transactio
     C                     PARM P1AUNA    WQ0110 30        Transaction Des
     C                     PARM *BLANK    WQ0111  3        Transaction Rea
     C                     PARM P1C4NB    WQ0112  70       Order Number
     C                     PARM P1XLCD    WQ0113  1        Shift Number
     C                     PARM *BLANK    WQ0114  3        Ship To Warehou
     C                     PARM P1AHWG    WQ0115 112       Transaction Wei
     C                     PARM P1A5QT    WQ0116 112       Transaction Qua
     C                     PARM 'N'       WQ0117  1        Unship Flag
     C                     PARM 'N'       WQ0118  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Keep Track of Batch Processing Functions so Email will NOT be Sen
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7
      *   |- c1    : PAR.Called From Program is Exc Proc 947 Whs InvAdjXF
      *   |- c2    : PAR.Called From Program is EDT Confirm Ship Detl  DF
      *   |- c3    : PAR.Called From Program is ADD Ready to Confirm  XL
      *   |- c4    : PAR.Called From Program is Exc Upd EDI 945 Trsn   XF
      *   |- c5    : PAR.Called From Program is PFS Reopen Order      XL
      *   |- c6    : PAR.Called From Program is WW Unship Orders       DF
      *   |- c7    : PAR.Called From Program is UPD Backin Spec'l Adj  XF
      *   '-
     C           P8COAB    IFEQ @CN,007                    *IF
     C           P8COAB    OREQ @CN,008                    *OR
     C           P8COAB    OREQ @CN,009                    *OR
     C           P8COAB    OREQ @CN,010                    *OR
     C           P8COAB    OREQ @CN,011                    *OR
     C           P8COAB    OREQ @CN,012                    *OR
     C           P8COAB    OREQ @CN,002                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Send Email to Business & IT.
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                     CALL 'PVA9XFR'              90  Prc Eml Shippin
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P8COAB    WQ0119 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     MOVEL*BLANK    P2ADCD           UOM Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           UOM Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           UOM Third
     C                     MOVEL*BLANK    P2AICD           UOM Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    WUAVNA           Description Lin
     C                     MOVELWAAWNA    WUAWNA           Description Lin
     C                     MOVELWAADCD    P2ADCD           UOM Primary
     C                     Z-ADDWAAWPC    P2AWPC           Conversion Fact
     C                     MOVELWALXST    P2LXST           Operation Facto
     C                     MOVELWAAECD    P2AECD           UOM Second
     C                     Z-ADDWAAXPC    P2AXPC           Conversion Fact
     C                     MOVELWALYST    P2LYST           Operation Facto
     C                     MOVELWAAFCD    P2AFCD           UOM Third
     C                     MOVELWAAICD    P2AICD           UOM Pricing
     C                     Z-ADDWAAIWG    P2AIWG           Unit Weight
     C                     MOVELWAFZST    P2FZST           Production Date
     C                     MOVELWAAVST    P2AVST           Catch Weight St
     C                     Z-ADDWACHTM    WUCHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Unit Cost          RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1HGCD    WBHGCD           Item Code
     C                     MOVELP1AJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@B0REJX              90    *
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAGCS    P5AGCS           Unit Cost Per P
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WCAIC3           Company Number
     C                     Z-ADDP1C4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURMNB           Load ID
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCRMNB    WURMNB           Load ID
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Module Release
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDB3AB           Module ID
     C                     KFLD           WDHUNZ           Release Number
      * Setup key
     C                     MOVELWL0001    WDB3AB           Module ID
     C                     Z-ADDWL0002    WDHUNZ           Release Number
      * Establish starting position
     C           KRSSD     CHAIN@C6REMK              90    *
      * Data record not found
     C   90                MOVEL'USR5307' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WDVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWDOCSC    WL0003           Module Release
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0004    WAAIC3           Company Number
     C                     Z-ADDWL0005    WAHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARINB    WL0006           Item Structure
     C                     Z-ADDWARHNB    WL0007           Item Structure
     C                     Z-ADDWARGNB    WL0008           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WEHGCD    WQSF02           Item Code
     C           *LIKE     DEFN WEAJCD    WQSF03           Warehouse Code
     C           *LIKE     DEFN WEW9ST    WQSF04           Inventory Trans
     C           *LIKE     DEFN WEBSST    WQSF05           Inventory Trans
     C           *LIKE     DEFN WEB4DT    WQSF06           Transaction Dat
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Item Code
     C                     KFLD           WQSF03           Warehouse Code
     C                     KFLD           WQSF04           Inventory Trans
     C                     KFLD           WQSF05           Inventory Trans
     C                     KFLD           WQSF06           Transaction Dat
      * Setup key
     C                     Z-ADDWL0009    WQSF01           Company Number
     C                     Z-ADDWL0010    WQSF02           Item Code
     C                     MOVELWL0011    WQSF03           Warehouse Code
     C                     MOVELWL0012    WQSF04           Inventory Trans
     C                     MOVELWL0013    WQSF05           Inventory Trans
     C                     Z-ADDWL0014    WQSF06           Transaction Dat
      * Establish starting position
     C           KRSSF     SETLL@B7CPZA                    *
     C           KRSSF     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0015           ITD Sequence Nu
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WEC4NY    ADD  1         WL0015           ITD Sequence Nu
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0026  60       Job Time
     C                     MOVEL*BLANK    WN0027 10        User Id
     C                     MOVEL*BLANK    WN0028 10        Job Name
     C                     Z-ADD*ZERO     WN0029  70       Job Date
     C                     Z-ADD*ZERO     WN0030  20       Production Hour
     C                     Z-ADD*ZERO     WN0031 112       Production Weig
     C                     Z-ADD*ZERO     WN0032  50       Production Quan
     C                     Z-ADD*ZERO     WN0033  70       Production Piec
     C                     MOVEL*BLANK    WN0034  1        Export_Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWL0016    WFAIC3           Company Number
     C                     Z-ADDWL0017    WFHGCD           Item Code
     C                     MOVELWL0018    WFAJCD           Warehouse Code
     C                     MOVELWL0019    WFW9ST           Inventory Trans
     C                     MOVELWL0020    WFBSST           Inventory Trans
     C                     Z-ADDWL0021    WFB4DT           Transaction Dat
     C                     Z-ADDWL0022    WFC4NY           ITD Sequence Nu
     C                     Z-ADDWL0023    WFDXNB           Sequence Number
     C                     Z-ADDWL0024    WFELDT           Production Date
     C                     MOVELWL0025    WFHVCD           UOM Transaction
     C                     MOVELWL0026    WFF1ST           Item Transactio
     C                     MOVELWL0027    WFAUNA           Description
     C                     Z-ADDWL0028    WFA5QT           Transaction Qua
     C                     Z-ADDWL0029    WFAHWG           Transaction Wei
     C                     Z-ADDWL0030    WFAKCS           USR Transaction
     C                     MOVELWL0031    WFCGCD           UOM Cost
     C                     Z-ADDWL0032    WFAYVA           Extended Amount
     C                     MOVELWL0033    WFBJNA           Ticket Number
     C                     Z-ADDWL0034    WFCKNB           GL Document Num
     C                     MOVELWL0035    WFBMST           GL Update Statu
     C                     MOVELWL0036    WFCQCD           Reason Code
     C                     MOVELWL0037    WFDTCD           Reference Numbe
     C                     MOVELWL0038    WFMGNA           Lot ID
     C                     Z-ADDWL0039    WFTRBN           Transfer Batch
     C                     Z-ADDWL0040    WFTRBS           Transfer Batch
     C                     Z-ADDWL0041    WFC4NB           Order Number
     C                     Z-ADDWL0042    WFRINB           Item Structure
     C                     Z-ADDWL0043    WFRHNB           Item Structure
     C                     Z-ADDWL0044    WFRGNB           Item Structure
     C                     MOVELWL0045    WFM3NA           Employee Badge
     C                     Z-ADDWL0046    WFAWTM           Production Time
     C                     MOVELWL0047    WFXLCD           Shift Number
     C                     Z-ADDWL0048    WFK7DT           Label Date
     C                     MOVELWL0049    WFUVST           EDI Status 1
     C                     MOVELWL0050    WFUWST           EDI Status 2
     C                     MOVELWL0051    WFUXST           EDI Status 3
     C                     MOVELWL0052    WFVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WFAXDT    PARM *ZERO     WQ0001 155       Current System
     C           WFAATM    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSG    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFW9ST           Inventory Trans
     C                     KFLD           WFBSST           Inventory Trans
     C                     KFLD           WFB4DT           Transaction Dat
     C                     KFLD           WFC4NY           ITD Sequence Nu
     C                     KFLD           WFDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSG    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0003  30       Company Number
     C                     PARM WFHGCD    WQ0004  70       Item Code
     C                     PARM WFAJCD    WQ0005  3        Warehouse Code
     C                     PARM WFW9ST    WQ0006  1        Inventory Trans
     C                     PARM WFBSST    WQ0007  2        Inventory Trans
     C                     PARM WFB4DT    WQ0008  70       Transaction Dat
     C                     PARM WFDXNB    WQ0009  30       Sequence Number
     C                     PARM WFELDT    WQ0010  70       Production Date
     C                     PARM WFHVCD    WQ0011  2        UOM Transaction
     C                     PARM WFF1ST    WQ0012  2        Item Transactio
     C                     PARM WFAUNA    WQ0013 30        Description
     C                     PARM WFA5QT    WQ0014 112       Transaction Qua
     C                     PARM WFAHWG    WQ0015 112       Transaction Wei
     C                     PARM WFAKCS    WQ0016 114       USR Transaction
     C                     PARM WFCGCD    WQ0017  2        UOM Cost
     C                     PARM WFAYVA    WQ0018 112       Extended Amount
     C                     PARM WFBJNA    WQ0019  6        Ticket Number
     C                     PARM WFCKNB    WQ0020  80       GL Document Num
     C                     PARM WFBMST    WQ0021  1        GL Update Statu
     C                     PARM WFCQCD    WQ0022  3        Reason Code
     C                     PARM WFDTCD    WQ0023 15        Reference Numbe
     C                     PARM WFMGNA    WQ0024 10        Lot ID
     C                     PARM WFTRBN    WQ0025  70       Transfer Batch
     C                     PARM WFTRBS    WQ0026  30       Transfer Batch
     C                     PARM WFC4NB    WQ0027  70       Order Number
     C                     PARM WFRINB    WQ0028  30       Item Structure
     C                     PARM WFRHNB    WQ0029  30       Item Structure
     C                     PARM WFRGNB    WQ0030  30       Item Structure
     C                     PARM WFM3NA    WQ0031 10        Employee Badge
     C                     PARM WFAWTM    WQ0032  60       Production Time
     C                     PARM WFXLCD    WQ0033  1        Shift Number
     C                     PARM WFK7DT    WQ0034  70       Label Date
     C                     PARM WFVSST    WQ0035  1        Record Status
     C                     PARM WFAATM    WQ0036  60       Job Time
     C                     PARM WFAXDT    WQ0037  70       Job Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0035 112       Physical Count
     C                     Z-ADD*ZERO     WN0036 112       Physical Count
     C                     Z-ADD*ZERO     WN0037 112       Physical Count
     C                     Z-ADD*ZERO     WN0038 112       Physical Count
     C                     MOVEL*BLANK    WN0039  1        Physical Count
     C                     Z-ADD*ZERO     WN0040 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0041 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0042 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0043 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0044 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0045 112       Weight In Chill
     C                     MOVEL*BLANK    WN0046  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0047 112       Physical Start
     C                     Z-ADD*ZERO     WN0048 112       Physical Start
     C                     Z-ADD*ZERO     WN0049 112       Physical Start
     C                     Z-ADD*ZERO     WN0050 112       Physical Start
     C                     Z-ADD*ZERO     WN0051  70       Physical Start
     C                     Z-ADD*ZERO     WN0052 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0053 114       Last Cost
     C                     Z-ADD*ZERO     WN0054 112       Value of On Han
     C                     Z-ADD*ZERO     WN0055  70       Label Date
     C                     MOVEL*BLANK    WN0056  1        EDI Status 1
     C                     MOVEL*BLANK    WN0057  1        EDI Status 2
     C                     MOVEL*BLANK    WN0058  1        EDI Status 3
     C                     MOVEL*BLANK    WN0059  1        Record Status
     C                     Z-ADD*ZERO     WN0060  60       Job Time
     C                     MOVEL*BLANK    WN0061 10        User Id
     C                     MOVEL*BLANK    WN0062 10        Job Name
     C                     Z-ADD*ZERO     WN0063  70       Job Date
     C                     MOVEL*BLANK    WN0064  1        Shift Number
     C                     MOVEL*BLANK    WN0065  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0064           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0053    WGAIC3           Company Number
     C                     Z-ADDWL0054    WGHGCD           Item Code
     C                     MOVELWL0055    WGAJCD    P      Warehouse Code
     C                     Z-ADDWL0056    WGELDT           Production Date
      *
     C           KLCHSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLCHSH    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     EXSR SICRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YARDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWL0057    WGRINB           Item Structure
     C                     Z-ADDWL0058    WGRHNB           Item Structure
     C                     Z-ADDWL0059    WGRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YARDC            *Record Data Ch
     C                     ADD  WL0073    WGARQT           Quantity on Han
     C                     ADD  WL0074    WGACWG           Quantity on Han
     C                     ADD  WL0077    WGIDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WGARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - Item Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0040  30       Company Number
     C                     PARM WGHGCD    WQ0041  70       Item Code
     C                     PARM WGAJCD    WQ0042  3        Warehouse Code
     C                     PARM WL0071    WQ0043  70       Transaction Dat
     C                     PARM WGELDT    WQ0044  70       Production Date
     C                     PARM WL0072    WQ0045  2        UOM Transaction
     C                     PARM WGACWG    WQ0046 112       Transaction Wei
     C                     PARM WL0075    WQ0047 114       USR Transaction
     C                     PARM WL0076    WQ0048  2        UOM Cost
     C                     PARM WGRINB    WQ0049  30       Item Structure
     C                     PARM WGRHNB    WQ0050  30       Item Structure
     C                     PARM WGRGNB    WQ0051  30       Item Structure
     C                     PARM WN0064    WQ0052  1        Shift Number
     C                     PARM WGK7DT    WQ0053  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0054 155       Current System
     C           WGAATM    PARM *ZERO     WQ0055 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WGARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SJRVGN
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0065    IFEQ *BLANK                     *IF
     C           WN0065    OREQ 'N'
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
     C                     EXSR SKDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0066  60       Job Time
     C                     MOVEL*BLANK    WN0067 10        User Id
     C                     MOVEL*BLANK    WN0068 10        Job Name
     C                     Z-ADD*ZERO     WN0069  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0053    WGAIC3           Company Number
     C                     Z-ADDWL0054    WGHGCD           Item Code
     C                     MOVELWL0055    WGAJCD           Warehouse Code
     C                     Z-ADDWL0056    WGELDT           Production Date
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     MOVEL*BLANK    WGCTST           Physical Count
     C                     Z-ADDWL0074    WGACWG           Quantity on Han
     C                     Z-ADDWL0073    WGARQT           Quantity on Han
     C                     Z-ADD*ZERO     WGASQT           Quantity on Han
     C                     Z-ADD*ZERO     WGATQT           Quantity on Han
     C                     Z-ADD*ZERO     WGHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WGHEQT           Weight In Chill
     C                     MOVEL'N'       WGF6ST           Update Exceptio
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAECS           Last Cost
     C                     Z-ADDWL0077    WGIDVA           Value of On Han
     C                     Z-ADDWL0078    WGK7DT           Label Date
     C                     Z-ADDWL0057    WGRINB           Item Structure
     C                     Z-ADDWL0058    WGRHNB           Item Structure
     C                     Z-ADDWL0059    WGRGNB           Item Structure
     C                     MOVEL*BLANK    WGUVST           EDI Status 1
     C                     MOVEL*BLANK    WGUWST           EDI Status 2
     C                     MOVEL*BLANK    WGUXST           EDI Status 3
     C                     MOVEL'A'       WGVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0038 155       Current System
     C           WGAATM    PARM *ZERO     WQ0039 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSI    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSI    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELWGAJCD    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0065           Lot Tracking Fl
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHVHST    WN0065           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
      *
     C           KLDLSK    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLDLSK    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0082           Quantity on Han
     C                     Z-ADD*ZERO     WL0083           Quantity on Han
     C                     Z-ADD*ZERO     WL0084           Quantity on Han
     C                     Z-ADD*ZERO     WL0085           Quantity on Han
     C                     Z-ADD*ZERO     WL0086           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WIHGCD    WQSL02           Item Code
     C           *LIKE     DEFN WIAJCD    WQSL03           Warehouse Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Item Code
     C                     KFLD           WQSL03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0079    WQSL01           Company Number
     C                     Z-ADDWL0080    WQSL02           Item Code
     C                     MOVELWL0081    WQSL03           Warehouse Code
      * Establish starting position
     C           KRSSL     SETLLCAB1RL4                    *
     C           KRSSL     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WIACWG    WL0082           Quantity on Han
     C                     ADD  WIARQT    WL0083           Quantity on Han
     C                     ADD  WIASQT    WL0084           Quantity on Han
     C                     ADD  WIATQT    WL0085           Quantity on Han
     C                     ADD  WIIDVA    WL0086           Value of On Han
     C           KRSSL     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - Item Balance  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0070 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0071 114       Last Cost
     C                     Z-ADD*ZERO     WN0072 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0073 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0074 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0075  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0076  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0077 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0078  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0079 112       On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0080 112       On Hand UOM3 Su
     C                     Z-ADD*ZERO     WN0081 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0082 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0083 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0084 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0085 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0086 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0087 112       Quantity Avail
     C                     MOVEL*BLANK    WN0088  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0089  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0090  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0091  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0092  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0093 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0094  70       Stock Out Date
     C                     MOVEL*BLANK    WN0095  3        Buyer Code
     C                     Z-ADD*ZERO     WN0096  30       Lead Time Last
     C                     Z-ADD*ZERO     WN0097  70       Lead Time Date
     C                     Z-ADD*ZERO     WN0098  30       Lead Time Next
     C                     Z-ADD*ZERO     WN0099  70       Lead Time Date
     C                     MOVEL*BLANK    WN0100  1        Lead Time Excep
     C                     Z-ADD*ZERO     WN0101 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0102 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0103  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0104 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0105 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0106  70       Last Physical C
     C                     MOVEL*BLANK    WN0107  1        Requisition Mod
     C                     MOVEL*BLANK    WN0108  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0109  1        Post GL Status
     C                     Z-ADD*ZERO     WN0110  80       Vendor Item_Whs
     C                     Z-ADD*ZERO     WN0111  30       Item Structure
     C                     Z-ADD*ZERO     WN0112  30       Item Structure
     C                     Z-ADD*ZERO     WN0113  30       Item Structure
     C                     MOVEL*BLANK    WN0114  1        EDI Status 1
     C                     MOVEL*BLANK    WN0115  1        EDI Status 2
     C                     MOVEL*BLANK    WN0116  1        EDI Status 3
     C                     MOVEL*BLANK    WN0117  1        Record Status
     C                     Z-ADD*ZERO     WN0118  60       Job Time
     C                     MOVEL*BLANK    WN0119 10        User Id
     C                     MOVEL*BLANK    WN0120 10        Job Name
     C                     Z-ADD*ZERO     WN0121  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWL0087    WJAIC3           Company Number
     C                     Z-ADDWL0088    WJHGCD           Item Code
     C                     MOVELWL0089    WJAJCD    P      Warehouse Code
      *
     C           KLCHSM    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C           KLCHSM    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YBRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWL0090    WJBOWG           On Hand Weight
     C                     Z-ADDWL0091    WJDDQT           On Hand UOM1 Su
     C                     Z-ADDWL0092    WJIDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDWJDDQT    WJDOQT           Quantity Avail
     C                     SUB  WJAQQT    WJDOQT           Quantity Avail
     C                     SUB  WJAUQT    WJDOQT           Quantity Avail
     C                     SUB  WJEMQT    WJDOQT           Quantity Avail
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Warehouse Info     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0093    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0094           Warehouse Descr
     C                     MOVEL*BLANK    WL0095           Address Line 1
     C                     MOVEL*BLANK    WL0096           Address Line 2
     C                     MOVEL*BLANK    WL0097           Address Line 3
     C                     MOVEL*BLANK    WL0098           City
     C                     MOVEL*BLANK    WL0099           Zip Postal Code
     C                     MOVEL*BLANK    WL0100           Production Ware
     C                     MOVEL*BLANK    WL0101           State Code
     C                     MOVEL*BLANK    WL0102           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0103           Default Printer
     C                     MOVEL*BLANK    WL0104           Warehouse Type
     C                     MOVEL*BLANK    WL0105           Trans Contol AS
     C                     MOVEL*BLANK    WL0106           Warehouse Locat
     C                     MOVEL*BLANK    WL0107           Warehouse Std C
     C                     Z-ADD*ZERO     WL0108           Warehouse Chill
     C                     MOVEL*BLANK    WL0109           Include in Auto
     C                     MOVEL*BLANK    WL0110           Default Manifes
     C                     MOVEL*BLANK    WL0111           Default Load Se
     C                     MOVEL*BLANK    WL0112           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0113           Shipping Compan
     C                     Z-ADD*ZERO     WL0114           Accounting Comp
     C                     Z-ADD*ZERO     WL0115           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0116           WHS Inventory C
     C                     MOVEL*BLANK    WL0117           Parent Warehous
     C                     MOVEL*BLANK    WL0118           Default Shippin
     C                     MOVEL*BLANK    WL0119           WHS Live with C
     C                     MOVEL*BLANK    WL0120           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0121           WHS Req Meter R
     C                     MOVEL*BLANK    WL0122           WHS Default Loa
     C                     MOVEL*BLANK    WL0123           WHS TMS Plannin
     C                     MOVEL*BLANK    WL0124           Default Carrier
     C                     MOVEL*BLANK    WL0125           Inventory Logic
     C                     MOVEL*BLANK    WL0126           WHS Auto Inv Re
     C                     MOVEL*BLANK    WL0127           EDI Status 1
     C                     MOVEL*BLANK    WL0128           EDI Status 2
     C                     MOVEL*BLANK    WL0129           EDI Status 3
     C                     MOVEL*BLANK    WL0130           Record Status
     C                     Z-ADD*ZERO     WL0131           Job Time
     C                     MOVEL*BLANK    WL0132           User Id
     C                     MOVEL*BLANK    WL0133           Job Name
     C                     Z-ADD*ZERO     WL0134           Job Date
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHF8NA    WL0094           Warehouse Descr
     C                     MOVELWHACNA    WL0095           Address Line 1
     C                     MOVELWHADNA    WL0096           Address Line 2
     C                     MOVELWHAENA    WL0097           Address Line 3
     C                     MOVELWHAJNA    WL0098           City
     C                     MOVELWHBTTX    WL0099           Zip Postal Code
     C                     MOVELWHAOCD    WL0100           Production Ware
     C                     MOVELWHBGCD    WL0101           State Code
     C                     MOVELWHVHST    WL0102           Lot Tracking Fl
     C                     MOVELWHMPNA    WL0103           Default Printer
     C                     MOVELWHWPST    WL0104           Warehouse Type
     C                     MOVELWHXUST    WL0105           Trans Contol AS
     C                     MOVELWHT0ST    WL0106           Warehouse Locat
     C                     MOVELWHT1ST    WL0107           Warehouse Std C
     C                     Z-ADDWHDBNB    WL0108           Warehouse Chill
     C                     MOVELWHT2ST    WL0109           Include in Auto
     C                     MOVELWHT3ST    WL0110           Default Manifes
     C                     MOVELWHT4ST    WL0111           Default Load Se
     C                     MOVELWHT6ST    WL0112           WHS Slotting Li
     C                     Z-ADDWHBWC3    WL0113           Shipping Compan
     C                     Z-ADDWHBTC3    WL0114           Accounting Comp
     C                     Z-ADDWHBUC3    WL0115           WHS Sched Prod
     C                     Z-ADDWHBVC3    WL0116           WHS Inventory C
     C                     MOVELWHFCAA    WL0117           Parent Warehous
     C                     MOVELWHRQSX    WL0118           Default Shippin
     C                     MOVELWHRRSX    WL0119           WHS Live with C
     C                     MOVELWHRSSX    WL0120           WHS PFS Interfa
     C                     MOVELWHRTSX    WL0121           WHS Req Meter R
     C                     MOVELWHT7ST    WL0122           WHS Default Loa
     C                     MOVELWHT8ST    WL0123           WHS TMS Plannin
     C                     MOVELWHRNSX    WL0124           Default Carrier
     C                     MOVELWHROSX    WL0125           Inventory Logic
     C                     MOVELWHRPSX    WL0126           WHS Auto Inv Re
     C                     MOVELWHUVST    WL0127           EDI Status 1
     C                     MOVELWHUWST    WL0128           EDI Status 2
     C                     MOVELWHUXST    WL0129           EDI Status 3
     C                     MOVELWHVSST    WL0130           Record Status
     C                     Z-ADDWHAATM    WL0131           Job Time
     C                     MOVELWHAYNA    WL0132           User Id
     C                     MOVELWHA0NA    WL0133           Job Name
     C                     Z-ADDWHAXDT    WL0134           Job Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Whse Location Info RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAJCD    WQSO01           Warehouse Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Warehouse Code
      * Setup key
     C                     MOVELWL0135    WQSO01           Warehouse Code
      * Establish starting position
     C           KRSSO     SETLL@L2RESM                    *
     C           KRSSO     READE@L2RESM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0136           Location Code
     C                     MOVEL*BLANK    WL0137           Location Aisle
     C                     Z-ADD*ZERO     WL0138           Location Bay
     C                     Z-ADD*ZERO     WL0139           Loc Unused Chil
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKYMCD    WL0136           Location Code
     C                     MOVELWKYPCD    WL0137           Location Aisle
     C                     Z-ADDWKLCBY    WL0138           Location Bay
     C                     Z-ADDWKLCCT    WL0139           Loc Unused Chil
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@L2RESM                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Order Type         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0140    WCAIC3           Company Number
     C                     Z-ADDWL0141    WCC4NB           Order Number
      * Establish starting position
     C           KRSSP     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWCJNCD    WL0142           Order Type_Sale
     C                     GOTO SPEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WLDOCD           System Value Co
      * Setup key
     C                     MOVELWL0143    WLDOCD           System Value Co
      * Establish starting position
     C           KRSSQ     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWLM8NB    WL0144           System Value Nu
     C                     GOTO SQEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1A5QT           Transaction Qua
     C                     Z-ADD*ZERO     P1AHWG           Transaction Wei
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2ADCD           UOM Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           UOM Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           UOM Third
     C                     MOVEL*BLANK    P2AICD           UOM Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P5AGCS           Unit Cost Per P
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBBACS           Cost per Primar
     C                     Z-ADD*ZERO     WBBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WBCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WBGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WBCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WBG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WBBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WBDDQT           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WBDEQT           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WBDFQT           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WBAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WBEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WBDOQT           Quantity Avail
     C                     Z-ADD*ZERO     WBAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WBANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WBDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WBDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WBBFDY           Lead Time Last
     C                     Z-ADD*ZERO     WBDJDT           Lead Time Date
     C                     Z-ADD*ZERO     WBBGDY           Lead Time Next
     C                     Z-ADD*ZERO     WBDKDT           Lead Time Date
     C                     Z-ADD*ZERO     WBDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WBBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WBDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WBDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WBDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WBDMDT           Last Physical C
     C                     Z-ADD*ZERO     WBAKC8           Vendor Item_Whs
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           AR Customer Num
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A_R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Lot Number
     C                     Z-ADD*ZERO     WULXNM  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHUNZ           Release Number
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,001   XDTSDL
     C                     MOVELXDTSDL    WDBGTS           Create Date Tim
     C                     MOVELXDTSDL    WDBHTS           Update Date Tim
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WEC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WEDXNB           Sequence Number
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WEAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WEAKCS           USR Transaction
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WECKNB           GL Document Num
     C                     Z-ADD*ZERO     WETRBN           Transfer Batch
     C                     Z-ADD*ZERO     WETRBS           Transfer Batch
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WEAWTM           Production Time
     C                     Z-ADD*ZERO     WEK7DT           Label Date
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGARQT           Quantity on Han
     C                     Z-ADD*ZERO     WGASQT           Quantity on Han
     C                     Z-ADD*ZERO     WGATQT           Quantity on Han
     C                     Z-ADD*ZERO     WGHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WGHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAECS           Last Cost
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     Z-ADD*ZERO     WGK7DT           Label Date
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WHBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WHBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WHBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WHBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Location Code
     C                     MOVEL*BLANK    WUYMCD  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKLCBY           Location Bay
     C                     Z-ADD*ZERO     WKLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Location Level
     C                     Z-ADD*ZERO     WUYNCD  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLM8NB           System Value Nu
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     Z-ADD*ZERO     WL0002  30
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011  3
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  2
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  50
      * Define local variables for subroutine SGCRRC.
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018  3
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  2
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  50
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  70
     C                     MOVEL*BLANK    WL0025  2
     C                     MOVEL*BLANK    WL0026  2
     C                     MOVEL*BLANK    WL0027 30
     C                     Z-ADD*ZERO     WL0028 112
     C                     Z-ADD*ZERO     WL0029 112
     C                     Z-ADD*ZERO     WL0030 114
     C                     MOVEL*BLANK    WL0031  2
     C                     Z-ADD*ZERO     WL0032 112
     C                     MOVEL*BLANK    WL0033  6
     C                     Z-ADD*ZERO     WL0034  80
     C                     MOVEL*BLANK    WL0035  1
     C                     MOVEL*BLANK    WL0036  3
     C                     MOVEL*BLANK    WL0037 15
     C                     MOVEL*BLANK    WL0038 10
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  30
     C                     Z-ADD*ZERO     WL0043  30
     C                     Z-ADD*ZERO     WL0044  30
     C                     MOVEL*BLANK    WL0045 10
     C                     Z-ADD*ZERO     WL0046  60
     C                     MOVEL*BLANK    WL0047  1
     C                     Z-ADD*ZERO     WL0048  70
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
      * Define local variables for subroutine SHCHRC.
     C                     Z-ADD*ZERO     WL0053  30
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055  3
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  30
     C                     Z-ADD*ZERO     WL0058  30
     C                     Z-ADD*ZERO     WL0059  30
     C                     MOVEL*BLANK    WL0060  2
     C                     Z-ADD*ZERO     WL0061  94
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  2
     C                     Z-ADD*ZERO     WL0064  94
     C                     MOVEL*BLANK    WL0065  1
     C                     MOVEL*BLANK    WL0066  2
     C                     MOVEL*BLANK    WL0067  1
     C                     MOVEL*BLANK    WL0068  1
     C                     MOVEL*BLANK    WL0069  1
     C                     MOVEL*BLANK    WL0070  2
     C                     Z-ADD*ZERO     WL0071  70
     C                     MOVEL*BLANK    WL0072  2
     C                     Z-ADD*ZERO     WL0073 112
     C                     Z-ADD*ZERO     WL0074 112
     C                     Z-ADD*ZERO     WL0075 114
     C                     MOVEL*BLANK    WL0076  2
     C                     Z-ADD*ZERO     WL0077 112
     C                     Z-ADD*ZERO     WL0078  70
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0079  30
     C                     Z-ADD*ZERO     WL0080  70
     C                     MOVEL*BLANK    WL0081  3
     C                     Z-ADD*ZERO     WL0082 112
     C                     Z-ADD*ZERO     WL0083 112
     C                     Z-ADD*ZERO     WL0084 112
     C                     Z-ADD*ZERO     WL0085 112
     C                     Z-ADD*ZERO     WL0086 112
      * Define local variables for subroutine SMCHRC.
     C                     Z-ADD*ZERO     WL0087  30
     C                     Z-ADD*ZERO     WL0088  70
     C                     MOVEL*BLANK    WL0089  3
     C                     Z-ADD*ZERO     WL0090 112
     C                     Z-ADD*ZERO     WL0091 112
     C                     Z-ADD*ZERO     WL0092 112
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0093  3
     C                     MOVEL*BLANK    WL0094 30
     C                     MOVEL*BLANK    WL0095 30
     C                     MOVEL*BLANK    WL0096 30
     C                     MOVEL*BLANK    WL0097 30
     C                     MOVEL*BLANK    WL0098 20
     C                     MOVEL*BLANK    WL0099 11
     C                     MOVEL*BLANK    WL0100  3
     C                     MOVEL*BLANK    WL0101  2
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103 10
     C                     MOVEL*BLANK    WL0104  2
     C                     MOVEL*BLANK    WL0105  1
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  1
     C                     Z-ADD*ZERO     WL0108  52
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  1
     C                     MOVEL*BLANK    WL0111  1
     C                     MOVEL*BLANK    WL0112  1
     C                     Z-ADD*ZERO     WL0113  30
     C                     Z-ADD*ZERO     WL0114  30
     C                     Z-ADD*ZERO     WL0115  30
     C                     Z-ADD*ZERO     WL0116  30
     C                     MOVEL*BLANK    WL0117  3
     C                     MOVEL*BLANK    WL0118  1
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  2
     C                     MOVEL*BLANK    WL0123  2
     C                     MOVEL*BLANK    WL0124  3
     C                     MOVEL*BLANK    WL0125  3
     C                     MOVEL*BLANK    WL0126  3
     C                     MOVEL*BLANK    WL0127  1
     C                     MOVEL*BLANK    WL0128  1
     C                     MOVEL*BLANK    WL0129  1
     C                     MOVEL*BLANK    WL0130  1
     C                     Z-ADD*ZERO     WL0131  60
     C                     MOVEL*BLANK    WL0132 10
     C                     MOVEL*BLANK    WL0133 10
     C                     Z-ADD*ZERO     WL0134  70
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0135  3
     C                     MOVEL*BLANK    WL0136  4
     C                     MOVEL*BLANK    WL0137  2
     C                     Z-ADD*ZERO     WL0138  20
     C                     Z-ADD*ZERO     WL0139  52
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0140  30
     C                     Z-ADD*ZERO     WL0141  70
     C                     MOVEL*BLANK    WL0142  2
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0143 10
     C                     Z-ADD*ZERO     WL0144 155
      * Define local work field Module Release Status
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0005 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0006 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0011  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0003  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0013  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0018  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0019  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0020  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0021  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0023  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0004  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0026  2
      * Define null work field WHS TMS Planning Region
     C                     MOVEL*BLANK    YN0027  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0028  3
      * Define null work field Inventory Logic Version
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field WHS Auto Inv Restoration
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0035  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0036 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0037 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0038  70
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0006  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field Order Type_Sales
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Module Release Status
     C                     MOVEL*BLANK    YL0009  1
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0039 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0040 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0041 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0042 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0043 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0044 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0045  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0046  2
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0010  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0047 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0048  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0049  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0011  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0051  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0052  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0053  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0054  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0055  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0056  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0057  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0058  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0059  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0060  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0061  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0012  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0062  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0064  2
      * Define null work field WHS TMS Planning Region
     C                     MOVEL*BLANK    YN0065  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0066  3
      * Define null work field Inventory Logic Version
     C                     MOVEL*BLANK    YN0067  3
      * Define null work field WHS Auto Inv Restoration
     C                     MOVEL*BLANK    YN0068  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0069  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0072  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0073  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0074 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0075 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0076  70
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0014  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0015  52
      * Define local work field Order Type_Sales
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field API EccResult-MsgId U
     C                     MOVEL*BLANK    YL0017  7
      * Define local work field API EccResult-MsgDesc U
     C                     MOVEL*BLANK    YL0018 50
      * Define local work field API Request Key U
     C                     MOVEL*BLANK    YL0019 10
      * Define local work field API Name
     C                     MOVEL*BLANK    YL0020 45
      * Define local work field API Wait Time U
     C                     Z-ADD*ZERO     YL0021  50
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
00002 PDLYXFR
00003 wim.ordershipping.invento
00004 APIWAITTME
00005 ECC0000
00006 TIMEOUT
00007 PUGDXFR
00008 PDL8DFR
00009 PNTKXFR
00010 PUEJXFR
00011 PNTWXFR
00012 PDMLDFR
