// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for E1I3XFR
// ?Date: 14.08.2025 Time: 02:43:44
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modification history
DO;

//?===================================================================
//?Function Logic:
//?If Company Number passed in, convert it to a 3.0 number.  If the
//?Account ID is passed in, retrieve the alpha Company Number from
//?the Account Master file and convert it to a 3.0 number.
//?===================================================================
//? 5/06/2020 JBB SDN465 - JDE World to JDE Enterprise 1
//?                        Function created.  Determine the Company#
//?                        based upon the values passed into this
//?                        function.
ENDDO;

//?===================================================================
//?Function Logic:
//?If Company Number passed in, convert it to a 3.0 number.  If the
//?Account ID is passed in, retrieve the alpha Company Number from
//?the Account Master file and convert it to a 3.0 number.
//?===================================================================
//?If OMS Company Number <> 0, use that value; ELSE Determine Co#
CASE;

// IF PAR.OMS Company Number is Entered
IF PAR.OMS_Company_Number <> *ZERO;

//?Use OMS Company Number passed into this program
//?If OMS Company Number <> 0, use that value; ELSE Determine Co#
// IF *OTHERWISE
IF *OTHERWISE;

//?Determine OMS Co# based on Company 3A, Company 5A, or Acct ID
CASE;

// IF PAR.OMS Company Number Alpha is Entered
IF PAR.OMS_Company_Number_Alpha <> *BLANK;

// PAR.OMS Company Number = CVTVAR(PAR.OMS Company Number Alpha)
PAR.OMS_Company_Number = CVTVAR(PAR.OMS_Company_Number_Alpha);

//?Determine OMS Co# based on Company 3A, Company 5A, or Acct ID
// IF PAR.Company is Entered
IF PAR.Company <> *BLANK;

// LCL.Company Number 5.0 = CVTVAR(PAR.Company)
LCL.Company_Number_5_0 = CVTVAR(PAR.Company);

// PAR.OMS Company Number = LCL.Company Number 5.0
PAR.OMS_Company_Number = LCL.Company_Number_5_0;

//?Determine OMS Co# based on Company 3A, Company 5A, or Acct ID
// IF PAR.Account ID is Entered
IF PAR.Account_ID <> *BLANK;

//?RMC 8/5/21 cant do this.. cannot use f0901!
ENDIF;

ENDIF;

//?If OMS Company Number still zero, retrieve it from the User ID
CASE;

// IF PAR.OMS Company Number is Not Entered
IF PAR.OMS_Company_Number = *ZERO;

// Call program Val Application/User  XF4.
CALL PROGRAM(Val Application/User  XF4) ('PUQ4XFR');
PARAMETER(NLL.OMS_Warehouse_Code);
PARAMETER(PAR.OMS_Company_Number);
PARAMETER('OMS');
PARAMETER(NLL.OMS_Salesperson_Code);
PARAMETER(NLL.OMS_Allow_Multi_Company);
PARAMETER(NLL.OMS_Default_Printer);
PARAMETER(NLL.OMS_NAME);
PARAMETER(NLL.OMS_System_Value_Alpha);
PARAMETER(NLL.OMS_Access_Denied_Y_N);

ENDIF;

