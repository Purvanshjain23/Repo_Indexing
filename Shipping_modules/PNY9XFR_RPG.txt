     H/TITLE Rtv/Dlt EDI PO Ack RcdXF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 10/18/18  Time  : 11:24:46
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FECP032L1IF  E           K        DISK
      * RTV : EDI PO Ack Hdr            Retrieval index
      *
     FECP033L1IF  E           K        DISK
      * RTV : EDI PO Ack Dtl            Retrieval index
      *
     FECP034L1IF  E           K        DISK
      * RTV : EDI PO Ack Nme            Retrieval index
      *
     FECP032D1IF  E           K        DISK
      * RTV : EDI PO Ack SAC AL/CHG HDR Retrieval index
      *
     FECP033D1IF  E           K        DISK
      * RTV : EDI PO Ack SAC AL/CHG DTL Retrieval index
      *
     FECP032L0UF  E           K        DISK
      * UPD : EDI PO Ack Hdr            Update index
      *
     FECP033L0UF  E           K        DISK
      * UPD : EDI PO Ack Dtl            Update index
      *
     FECP034L0UF  E           K        DISK
      * UPD : EDI PO Ack Nme            Update index
      *
     FECP032D0UF  E           K        DISK
      * UPD : EDI PO Ack SAC AL/CHG HDR Update index
      *
     FECP033D0UF  E           K        DISK
      * UPD : EDI PO Ack SAC AL/CHG DTL Update index
      *
     I@D7REUU
      * EDI PO Ack Hdr            Retrieval index
      * Renamed input format fields
     I              D7H9NY                          WAH9NY
     I              D7FLGX                          WAFLGX
     I              D7JWAA                          WAJWAA
     I              D7J1AA                          WAJ1AA
     I              D7O6T1                          WAO6T1
     I              D7SIDT                          WASIDT
     I              D7J2AA                          WAJ2AA
     I              D7SJDT                          WASJDT
     I              D7J3AA                          WAJ3AA
     I              D7SKDT                          WASKDT
     I              D7J4AA                          WAJ4AA
     I              D7L3AA                          WAL3AA
     I              D7X7T1                          WAX7T1
     I              D7UADT                          WAUADT
     I              D7N8AA                          WAN8AA
     I              D7NFST                          WANFST
     I              D7SZAA                          WASZAA
     I              D7B0U1                          WAB0U1
     I              D7S0AA                          WAS0AA
     I              D7B1U1                          WAB1U1
     I              D7S1AA                          WAS1AA
     I              D7B2U1                          WAB2U1
     I              D7S2AA                          WAS2AA
     I              D7B3U1                          WAB3U1
     I              D7S3AA                          WAS3AA
     I              D7B4U1                          WAB4U1
     I              D7S4AA                          WAS4AA
     I              D7B5U1                          WAB5U1
     I              D7S5AA                          WAS5AA
     I              D7B6U1                          WAB6U1
      *
     I@D7REUT
      * EDI PO Ack Hdr            Update index
      * Renamed input format fields
     I              D7H9NY                          WBH9NY
     I              D7FLGX                          WBFLGX
     I              D7JWAA                          WBJWAA
     I              D7J1AA                          WBJ1AA
     I              D7O6T1                          WBO6T1
     I              D7SIDT                          WBSIDT
     I              D7J2AA                          WBJ2AA
     I              D7SJDT                          WBSJDT
     I              D7J3AA                          WBJ3AA
     I              D7SKDT                          WBSKDT
     I              D7J4AA                          WBJ4AA
     I              D7L3AA                          WBL3AA
     I              D7X7T1                          WBX7T1
     I              D7UADT                          WBUADT
     I              D7N8AA                          WBN8AA
     I              D7NFST                          WBNFST
     I              D7SZAA                          WBSZAA
     I              D7B0U1                          WBB0U1
     I              D7S0AA                          WBS0AA
     I              D7B1U1                          WBB1U1
     I              D7S1AA                          WBS1AA
     I              D7B2U1                          WBB2U1
     I              D7S2AA                          WBS2AA
     I              D7B3U1                          WBB3U1
     I              D7S3AA                          WBS3AA
     I              D7B4U1                          WBB4U1
     I              D7S4AA                          WBS4AA
     I              D7B5U1                          WBB5U1
     I              D7S5AA                          WBS5AA
     I              D7B6U1                          WBB6U1
      *
     I@D6REUR
      * EDI PO Ack Dtl            Retrieval index
      * Renamed input format fields
     I              D6H9NY                          WCH9NY
     I              D6IJNY                          WCIJNY
     I              D6M1NY                          WCM1NY
     I              D6PHQT                          WCPHQT
     I              D6J5AA                          WCJ5AA
     I              D6GKPR                          WCGKPR
     I              D6N6AA                          WCN6AA
     I              D6J6AA                          WCJ6AA
     I              D6O8T1                          WCO8T1
     I              D6OVAA                          WCOVAA
     I              D6YNT1                          WCYNT1
     I              D6GQTX                          WCGQTX
     I              D6LET1                          WCLET1
     I              D6NCST                          WCNCST
     I              D6NDST                          WCNDST
     I              D6T9DT                          WCT9DT
     I              D6QLQT                          WCQLQT
     I              D6X6T1                          WCX6T1
     I              D6N7AA                          WCN7AA
     I              D6TQAA                          WCTQAA
     I              D6DUU1                          WCDUU1
     I              D6TRAA                          WCTRAA
     I              D6DVU1                          WCDVU1
     I              D6TSAA                          WCTSAA
     I              D6DWU1                          WCDWU1
     I              D6TTAA                          WCTTAA
     I              D6DXU1                          WCDXU1
     I              D6TUAA                          WCTUAA
     I              D6DYU1                          WCDYU1
     I              D6BGSC                          WCBGSC
     I              D6Q7QT                          WCQ7QT
     I              D6BHSC                          WCBHSC
     I              D6DZU1                          WCDZU1
     I              D6BISC                          WCBISC
     I              D6RRQT                          WCRRQT
     I              D6BTSC                          WCBTSC
     I              D6BJSC                          WCBJSC
     I              D6BKSC                          WCBKSC
     I              D6BLSC                          WCBLSC
     I              D6BMSC                          WCBMSC
     I              D6BNSC                          WCBNSC
     I              D6BOSC                          WCBOSC
     I              D6BPSC                          WCBPSC
     I              D6BQSC                          WCBQSC
     I              D6BRSC                          WCBRSC
     I              D6BSSC                          WCBSSC
     I              D6D0U1                          WCD0U1
     I              D6D1U1                          WCD1U1
     I              D6D2U1                          WCD2U1
     I              D6D3U1                          WCD3U1
     I              D6D4U1                          WCD4U1
     I              D6D5U1                          WCD5U1
     I              D6RDQT                          WCRDQT
     I              D6REQT                          WCREQT
     I              D6RFQT                          WCRFQT
     I              D6RGQT                          WCRGQT
     I              D6RHQT                          WCRHQT
     I              D6Q8QT                          WCQ8QT
     I              D6Q9QT                          WCQ9QT
     I              D6RAQT                          WCRAQT
     I              D6RBQT                          WCRBQT
     I              D6RCQT                          WCRCQT
     I              D6BONA                          WCBONA
     I              D6BONC                          WCBONC
     I              D6BOND                          WCBOND
     I              D6BONB                          WCBONB
     I              D6BONE                          WCBONE
     I              D6BONF                          WCBONF
     I              D6AYNB                          WCAYNB
     I              D6AZNB                          WCAZNB
     I              D6A2NB                          WCA2NB
     I              D6A6NB                          WCA6NB
      *
     I@D6REUQ
      * EDI PO Ack Dtl            Update index
      * Renamed input format fields
     I              D6H9NY                          WDH9NY
     I              D6IJNY                          WDIJNY
     I              D6M1NY                          WDM1NY
     I              D6PHQT                          WDPHQT
     I              D6J5AA                          WDJ5AA
     I              D6GKPR                          WDGKPR
     I              D6N6AA                          WDN6AA
     I              D6J6AA                          WDJ6AA
     I              D6O8T1                          WDO8T1
     I              D6OVAA                          WDOVAA
     I              D6YNT1                          WDYNT1
     I              D6GQTX                          WDGQTX
     I              D6LET1                          WDLET1
     I              D6NCST                          WDNCST
     I              D6NDST                          WDNDST
     I              D6T9DT                          WDT9DT
     I              D6QLQT                          WDQLQT
     I              D6X6T1                          WDX6T1
     I              D6N7AA                          WDN7AA
     I              D6TQAA                          WDTQAA
     I              D6DUU1                          WDDUU1
     I              D6TRAA                          WDTRAA
     I              D6DVU1                          WDDVU1
     I              D6TSAA                          WDTSAA
     I              D6DWU1                          WDDWU1
     I              D6TTAA                          WDTTAA
     I              D6DXU1                          WDDXU1
     I              D6TUAA                          WDTUAA
     I              D6DYU1                          WDDYU1
     I              D6BGSC                          WDBGSC
     I              D6Q7QT                          WDQ7QT
     I              D6BHSC                          WDBHSC
     I              D6DZU1                          WDDZU1
     I              D6BISC                          WDBISC
     I              D6RRQT                          WDRRQT
     I              D6BTSC                          WDBTSC
     I              D6BJSC                          WDBJSC
     I              D6BKSC                          WDBKSC
     I              D6BLSC                          WDBLSC
     I              D6BMSC                          WDBMSC
     I              D6BNSC                          WDBNSC
     I              D6BOSC                          WDBOSC
     I              D6BPSC                          WDBPSC
     I              D6BQSC                          WDBQSC
     I              D6BRSC                          WDBRSC
     I              D6BSSC                          WDBSSC
     I              D6D0U1                          WDD0U1
     I              D6D1U1                          WDD1U1
     I              D6D2U1                          WDD2U1
     I              D6D3U1                          WDD3U1
     I              D6D4U1                          WDD4U1
     I              D6D5U1                          WDD5U1
     I              D6RDQT                          WDRDQT
     I              D6REQT                          WDREQT
     I              D6RFQT                          WDRFQT
     I              D6RGQT                          WDRGQT
     I              D6RHQT                          WDRHQT
     I              D6Q8QT                          WDQ8QT
     I              D6Q9QT                          WDQ9QT
     I              D6RAQT                          WDRAQT
     I              D6RBQT                          WDRBQT
     I              D6RCQT                          WDRCQT
     I              D6BONA                          WDBONA
     I              D6BONC                          WDBONC
     I              D6BOND                          WDBOND
     I              D6BONB                          WDBONB
     I              D6BONE                          WDBONE
     I              D6BONF                          WDBONF
     I              D6AYNB                          WDAYNB
     I              D6AZNB                          WDAZNB
     I              D6A2NB                          WDA2NB
     I              D6A6NB                          WDA6NB
      *
     I@G5CPKG
      * EDI PO Ack Nme            Retrieval index
      * Renamed input format fields
     I              G5H9NY                          WEH9NY
     I              G5TYPC                          WETYPC
     I              G5AMEX                          WEAMEX
     I              G5DCDQ                          WEDCDQ
     I              G5DCDE                          WEDCDE
     I              G5DD1X                          WEDD1X
     I              G5DD2X                          WEDD2X
     I              G5ITYX                          WEITYX
     I              G5TATE                          WETATE
     I              G5IPXX                          WEIPXX
      *
     I@G5CPKF
      * EDI PO Ack Nme            Update index
      * Renamed input format fields
     I              G5H9NY                          WFH9NY
     I              G5TYPC                          WFTYPC
     I              G5AMEX                          WFAMEX
     I              G5DCDQ                          WFDCDQ
     I              G5DCDE                          WFDCDE
     I              G5DD1X                          WFDD1X
     I              G5DD2X                          WFDD2X
     I              G5ITYX                          WFITYX
     I              G5TATE                          WFTATE
     I              G5IPXX                          WFIPXX
      *
     I@CKCPWU
      * EDI PO Ack SAC AL/CHG HDR Retrieval index
      * Renamed input format fields
     I              CKH9NY                          WGH9NY
     I              CKUONY                          WGUONY
     I              CKQHAA                          WGQHAA
     I              CKQEAA                          WGQEAA
     I              CKQVST                          WGQVST
     I              CKQIAA                          WGQIAA
     I              CKZ8T1                          WGZ8T1
     I              CKMQVL                          WGMQVL
     I              CKQKAA                          WGQKAA
     I              CKG6PC                          WGG6PC
     I              CKMTVL                          WGMTVL
     I              CKC2C3                          WGC2C3
     I              CKMSVL                          WGMSVL
     I              CKQXQT                          WGQXQT
     I              CKUHNA                          WGUHNA
     I              CKZ9T1                          WGZ9T1
     I              CKZ9T2                          WGZ9T2
     I              CKUINA                          WGUINA
     I              CKXHNY                          WGXHNY
     I              CKXINY                          WGXINY
     I              CKMUVL                          WGMUVL
      *
     I@CKCPWT
      * EDI PO Ack SAC AL/CHG HDR Update index
      * Renamed input format fields
     I              CKH9NY                          WHH9NY
     I              CKUONY                          WHUONY
     I              CKQHAA                          WHQHAA
     I              CKQEAA                          WHQEAA
     I              CKQVST                          WHQVST
     I              CKQIAA                          WHQIAA
     I              CKZ8T1                          WHZ8T1
     I              CKMQVL                          WHMQVL
     I              CKQKAA                          WHQKAA
     I              CKG6PC                          WHG6PC
     I              CKMTVL                          WHMTVL
     I              CKC2C3                          WHC2C3
     I              CKMSVL                          WHMSVL
     I              CKQXQT                          WHQXQT
     I              CKUHNA                          WHUHNA
     I              CKZ9T1                          WHZ9T1
     I              CKZ9T2                          WHZ9T2
     I              CKUINA                          WHUINA
     I              CKXHNY                          WHXHNY
     I              CKXINY                          WHXINY
     I              CKMUVL                          WHMUVL
      *
     I@CLCPWR
      * EDI PO Ack SAC AL/CHG DTL Retrieval index
      * Renamed input format fields
     I              CLH9NY                          WIH9NY
     I              CLSEQX                          WISEQX
     I              CLYFNY                          WIYFNY
     I              CLQVST                          WIQVST
     I              CLQHAA                          WIQHAA
     I              CLQIAA                          WIQIAA
     I              CLZ8T1                          WIZ8T1
     I              CLMQVL                          WIMQVL
     I              CLQKAA                          WIQKAA
     I              CLG6PC                          WIG6PC
     I              CLMTVL                          WIMTVL
     I              CLC2C3                          WIC2C3
     I              CLMSVL                          WIMSVL
     I              CLQXQT                          WIQXQT
     I              CLQEAA                          WIQEAA
     I              CLZ9T1                          WIZ9T1
     I              CLZ9T2                          WIZ9T2
     I              CLUHNA                          WIUHNA
     I              CLUINA                          WIUINA
     I              CLXHNY                          WIXHNY
     I              CLXINY                          WIXINY
     I              CLMUVL                          WIMUVL
      *
     I@CLCPWQ
      * EDI PO Ack SAC AL/CHG DTL Update index
      * Renamed input format fields
     I              CLH9NY                          WJH9NY
     I              CLSEQX                          WJSEQX
     I              CLYFNY                          WJYFNY
     I              CLQVST                          WJQVST
     I              CLQHAA                          WJQHAA
     I              CLQIAA                          WJQIAA
     I              CLZ8T1                          WJZ8T1
     I              CLMQVL                          WJMQVL
     I              CLQKAA                          WJQKAA
     I              CLG6PC                          WJG6PC
     I              CLMTVL                          WJMTVL
     I              CLC2C3                          WJC2C3
     I              CLMSVL                          WJMSVL
     I              CLQXQT                          WJQXQT
     I              CLQEAA                          WJQEAA
     I              CLZ9T1                          WJZ9T1
     I              CLZ9T2                          WJZ9T2
     I              CLUHNA                          WJUHNA
     I              CLUINA                          WJUINA
     I              CLXHNY                          WJXHNY
     I              CLXINY                          WJXINY
     I              CLMUVL                          WJMUVL
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQECP01    E DSECP032L0
      * UPD : EDI PO Ack Hdr            Update index
      * Renamed input format fields
     I              D7H9NY                          WBH9NY
     I              D7FLGX                          WBFLGX
     I              D7JWAA                          WBJWAA
     I              D7J1AA                          WBJ1AA
     I              D7O6T1                          WBO6T1
     I              D7SIDT                          WBSIDT
     I              D7J2AA                          WBJ2AA
     I              D7SJDT                          WBSJDT
     I              D7J3AA                          WBJ3AA
     I              D7SKDT                          WBSKDT
     I              D7J4AA                          WBJ4AA
     I              D7L3AA                          WBL3AA
     I              D7X7T1                          WBX7T1
     I              D7UADT                          WBUADT
     I              D7N8AA                          WBN8AA
     I              D7NFST                          WBNFST
     I              D7SZAA                          WBSZAA
     I              D7B0U1                          WBB0U1
     I              D7S0AA                          WBS0AA
     I              D7B1U1                          WBB1U1
     I              D7S1AA                          WBS1AA
     I              D7B2U1                          WBB2U1
     I              D7S2AA                          WBS2AA
     I              D7B3U1                          WBB3U1
     I              D7S3AA                          WBS3AA
     I              D7B4U1                          WBB4U1
     I              D7S4AA                          WBS4AA
     I              D7B5U1                          WBB5U1
     I              D7S5AA                          WBS5AA
     I              D7B6U1                          WBB6U1
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQECP02    E DSECP033L0
      * UPD : EDI PO Ack Dtl            Update index
      * Renamed input format fields
     I              D6H9NY                          WDH9NY
     I              D6IJNY                          WDIJNY
     I              D6M1NY                          WDM1NY
     I              D6PHQT                          WDPHQT
     I              D6J5AA                          WDJ5AA
     I              D6GKPR                          WDGKPR
     I              D6N6AA                          WDN6AA
     I              D6J6AA                          WDJ6AA
     I              D6O8T1                          WDO8T1
     I              D6OVAA                          WDOVAA
     I              D6YNT1                          WDYNT1
     I              D6GQTX                          WDGQTX
     I              D6LET1                          WDLET1
     I              D6NCST                          WDNCST
     I              D6NDST                          WDNDST
     I              D6T9DT                          WDT9DT
     I              D6QLQT                          WDQLQT
     I              D6X6T1                          WDX6T1
     I              D6N7AA                          WDN7AA
     I              D6TQAA                          WDTQAA
     I              D6DUU1                          WDDUU1
     I              D6TRAA                          WDTRAA
     I              D6DVU1                          WDDVU1
     I              D6TSAA                          WDTSAA
     I              D6DWU1                          WDDWU1
     I              D6TTAA                          WDTTAA
     I              D6DXU1                          WDDXU1
     I              D6TUAA                          WDTUAA
     I              D6DYU1                          WDDYU1
     I              D6BGSC                          WDBGSC
     I              D6Q7QT                          WDQ7QT
     I              D6BHSC                          WDBHSC
     I              D6DZU1                          WDDZU1
     I              D6BISC                          WDBISC
     I              D6RRQT                          WDRRQT
     I              D6BTSC                          WDBTSC
     I              D6BJSC                          WDBJSC
     I              D6BKSC                          WDBKSC
     I              D6BLSC                          WDBLSC
     I              D6BMSC                          WDBMSC
     I              D6BNSC                          WDBNSC
     I              D6BOSC                          WDBOSC
     I              D6BPSC                          WDBPSC
     I              D6BQSC                          WDBQSC
     I              D6BRSC                          WDBRSC
     I              D6BSSC                          WDBSSC
     I              D6D0U1                          WDD0U1
     I              D6D1U1                          WDD1U1
     I              D6D2U1                          WDD2U1
     I              D6D3U1                          WDD3U1
     I              D6D4U1                          WDD4U1
     I              D6D5U1                          WDD5U1
     I              D6RDQT                          WDRDQT
     I              D6REQT                          WDREQT
     I              D6RFQT                          WDRFQT
     I              D6RGQT                          WDRGQT
     I              D6RHQT                          WDRHQT
     I              D6Q8QT                          WDQ8QT
     I              D6Q9QT                          WDQ9QT
     I              D6RAQT                          WDRAQT
     I              D6RBQT                          WDRBQT
     I              D6RCQT                          WDRCQT
     I              D6BONA                          WDBONA
     I              D6BONC                          WDBONC
     I              D6BOND                          WDBOND
     I              D6BONB                          WDBONB
     I              D6BONE                          WDBONE
     I              D6BONF                          WDBONF
     I              D6AYNB                          WDAYNB
     I              D6AZNB                          WDAZNB
     I              D6A2NB                          WDA2NB
     I              D6A6NB                          WDA6NB
      *
     IQECP03    E DSECP034L0
      * UPD : EDI PO Ack Nme            Update index
      * Renamed input format fields
     I              G5H9NY                          WFH9NY
     I              G5TYPC                          WFTYPC
     I              G5AMEX                          WFAMEX
     I              G5DCDQ                          WFDCDQ
     I              G5DCDE                          WFDCDE
     I              G5DD1X                          WFDD1X
     I              G5DD2X                          WFDD2X
     I              G5ITYX                          WFITYX
     I              G5TATE                          WFTATE
     I              G5IPXX                          WFIPXX
      *
     IQECP04    E DSECP032D0
      * UPD : EDI PO Ack SAC AL/CHG HDR Update index
      * Renamed input format fields
     I              CKH9NY                          WHH9NY
     I              CKUONY                          WHUONY
     I              CKQHAA                          WHQHAA
     I              CKQEAA                          WHQEAA
     I              CKQVST                          WHQVST
     I              CKQIAA                          WHQIAA
     I              CKZ8T1                          WHZ8T1
     I              CKMQVL                          WHMQVL
     I              CKQKAA                          WHQKAA
     I              CKG6PC                          WHG6PC
     I              CKMTVL                          WHMTVL
     I              CKC2C3                          WHC2C3
     I              CKMSVL                          WHMSVL
     I              CKQXQT                          WHQXQT
     I              CKUHNA                          WHUHNA
     I              CKZ9T1                          WHZ9T1
     I              CKZ9T2                          WHZ9T2
     I              CKUINA                          WHUINA
     I              CKXHNY                          WHXHNY
     I              CKXINY                          WHXINY
     I              CKMUVL                          WHMUVL
      *
     IQECP05    E DSECP033D0
      * UPD : EDI PO Ack SAC AL/CHG DTL Update index
      * Renamed input format fields
     I              CLH9NY                          WJH9NY
     I              CLSEQX                          WJSEQX
     I              CLYFNY                          WJYFNY
     I              CLQVST                          WJQVST
     I              CLQHAA                          WJQHAA
     I              CLQIAA                          WJQIAA
     I              CLZ8T1                          WJZ8T1
     I              CLMQVL                          WJMQVL
     I              CLQKAA                          WJQKAA
     I              CLG6PC                          WJG6PC
     I              CLMTVL                          WJMTVL
     I              CLC2C3                          WJC2C3
     I              CLMSVL                          WJMSVL
     I              CLQXQT                          WJQXQT
     I              CLQEAA                          WJQEAA
     I              CLZ9T1                          WJZ9T1
     I              CLZ9T2                          WJZ9T2
     I              CLUHNA                          WJUHNA
     I              CLUINA                          WJUINA
     I              CLXHNY                          WJXHNY
     I              CLXINY                          WJXINY
     I              CLMUVL                          WJMUVL
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  EDI SURROGATE NUMBER
     I                                    P   1   50P1H9NY
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1H9NY    PARM           WP0001  90       EDI SURROGATE N
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv/Dlt EDI PO Ack RcdXF
      * Rtv/Dlt EDI PO Ack    RT - EDI PO Ack Hdr  * 
     C                     EXSR SARVGN
      * Rtv/Dlt EDI PO Dtl    RT - EDI PO Ack Dtl  * 
     C                     EXSR SCRVGN
      * Rtv/Dlt EDI PO Ack    RT - EDI PO Ack Nme  * 
     C                     EXSR SERVGN
      * Rtv/Dlt EDI PO Ack SAC RT - EDI PO Ack SAC AL/CHG HDR  * 
     C                     EXSR SGRVGN
      * Rtv/Dlt EDI PO Ack SAC RT - EDI PO Ack SAC AL/CHG DTL  * 
     C                     EXSR SIRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv/Dlt EDI PO Ack    RT - EDI PO Ack Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAH9NY           EDI SURROGATE N
      * Setup key
     C                     Z-ADDP1H9NY    WAH9NY           EDI SURROGATE N
      * Establish starting position
     C           KRSSA     CHAIN@D7REUU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3990' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Dlt EDI PO Ack        DL - EDI PO Ack Hdr  * 
     C                     EXSR SBDLRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Dlt EDI PO Ack        DL - EDI PO Ack Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @D7REUT
     C                     Z-ADDWAH9NY    WBH9NY           EDI SURROGATE N
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBH9NY           EDI SURROGATE N
     C           KLDLSB    CHAIN@D7REUT              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP032L0'MDACP
     C                     MOVEL'@D7REUT' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@D7REUT                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv/Dlt EDI PO Dtl    RT - EDI PO Ack Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCH9NY    WQSC01           EDI SURROGATE N
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           EDI SURROGATE N
      * Setup key
     C                     Z-ADDP1H9NY    WQSC01           EDI SURROGATE N
      * Establish starting position
     C           KRSSC     SETLL@D6REUR                    *
     C           KRSSC     READE@D6REUR                  90*
      * Data record not found
     C   90                MOVEL'USR3988' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
      * Del EDI Purchase Ord  DL - EDI PO Ack Dtl  * 
     C                     EXSR SDDLRC
     C           KRSSC     READE@D6REUR                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Del EDI Purchase Ord  DL - EDI PO Ack Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @D6REUQ
     C                     Z-ADDWCH9NY    WDH9NY           EDI SURROGATE N
     C                     Z-ADDWCIJNY    WDIJNY           IT101-PO LINE I
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDH9NY           EDI SURROGATE N
     C                     KFLD           WDIJNY           IT101-PO LINE I
     C           KLDLSD    CHAIN@D6REUQ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP033L0'MDACP
     C                     MOVEL'@D6REUQ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@D6REUQ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv/Dlt EDI PO Ack    RT - EDI PO Ack Nme  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEH9NY    WQSE01           EDI SURROGATE N
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           EDI SURROGATE N
      * Setup key
     C                     Z-ADDP1H9NY    WQSE01           EDI SURROGATE N
      * Establish starting position
     C           KRSSE     SETLL@G5CPKG                    *
     C           KRSSE     READE@G5CPKG                  90*
      * Data record not found
     C   90                MOVEL'USR4419' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt EDI Purch Ord Ack DL - EDI PO Ack Nme  * 
     C                     EXSR SFDLRC
     C           KRSSE     READE@G5CPKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Dlt EDI Purch Ord Ack DL - EDI PO Ack Nme  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @G5CPKF
     C                     Z-ADDP1H9NY    WFH9NY           EDI SURROGATE N
     C                     MOVELWETYPC    WFTYPC           N101-NAME TYPE
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFH9NY           EDI SURROGATE N
     C                     KFLD           WFTYPC           N101-NAME TYPE
     C           KLDLSF    CHAIN@G5CPKF              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP034L0'MDACP
     C                     MOVEL'@G5CPKF' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@G5CPKF                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv/Dlt EDI PO Ack SAC RT - EDI PO Ack SAC AL/CHG HDR  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGH9NY    WQSG01           EDI SURROGATE N
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           EDI SURROGATE N
      * Setup key
     C                     Z-ADDP1H9NY    WQSG01           EDI SURROGATE N
      * Establish starting position
     C           KRSSG     SETLL@CKCPWU                    *
     C           KRSSG     READE@CKCPWU                  90*
      * Data record not found
     C   90                MOVEL'USR4899' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt EDI PO Ack SAC AL/ DL - EDI PO Ack SAC AL/CHG HDR  * 
     C                     EXSR SHDLRC
     C           KRSSG     READE@CKCPWU                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Dlt EDI PO Ack SAC AL/ DL - EDI PO Ack SAC AL/CHG HDR  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CKCPWT
     C                     Z-ADDP1H9NY    WHH9NY           EDI SURROGATE N
     C                     Z-ADDWGUONY    WHUONY           ENT01-SEQUENCE
      *
     C           KLDLSH    KLIST
     C                     KFLD           WHH9NY           EDI SURROGATE N
     C                     KFLD           WHUONY           ENT01-SEQUENCE
     C           KLDLSH    CHAIN@CKCPWT              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP032D0'MDACP
     C                     MOVEL'@CKCPWT' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CKCPWT                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv/Dlt EDI PO Ack SAC RT - EDI PO Ack SAC AL/CHG DTL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIH9NY    WQSI01           EDI SURROGATE N
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           EDI SURROGATE N
      * Setup key
     C                     Z-ADDP1H9NY    WQSI01           EDI SURROGATE N
      * Establish starting position
     C           KRSSI     SETLL@CLCPWR                    *
     C           KRSSI     READE@CLCPWR                  90*
      * Data record not found
     C   90                MOVEL'USR4901' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt EDI PO Ack SAC AL/ DL - EDI PO Ack SAC AL/CHG DTL  * 
     C                     EXSR SJDLRC
     C           KRSSI     READE@CLCPWR                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * Dlt EDI PO Ack SAC AL/ DL - EDI PO Ack SAC AL/CHG DTL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CLCPWQ
     C                     Z-ADDWIH9NY    WJH9NY           EDI SURROGATE N
     C                     Z-ADDWISEQX    WJSEQX           ITEM SEQUENCE N
     C                     Z-ADDWIYFNY    WJYFNY           Item Secondary
      *
     C           KLDLSJ    KLIST
     C                     KFLD           WJH9NY           EDI SURROGATE N
     C                     KFLD           WJSEQX           ITEM SEQUENCE N
     C                     KFLD           WJYFNY           Item Secondary
     C           KLDLSJ    CHAIN@CLCPWQ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ECP033D0'MDACP
     C                     MOVEL'@CLCPWQ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CLCPWQ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WASIDT           BAK04-PO Date
     C                     Z-ADD*ZERO     WASJDT           DTM02-Schedule
     C                     Z-ADD*ZERO     WASKDT           DTM02-Schedule
     C                     Z-ADD*ZERO     WAUADT           POAH Load ID
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WCIJNY           IT101-PO LINE I
     C                     Z-ADD*ZERO     WCPHQT           PO102-Qty to be
     C                     Z-ADD*ZERO     WCGKPR           PO104-Unit Pric
     C                     Z-ADD*ZERO     WCT9DT           POA unused Date
     C                     Z-ADD*ZERO     WCQLQT           POA Unit Weight
     C                     Z-ADD*ZERO     WCQ7QT           PO306-Quantity
     C                     Z-ADD*ZERO     WCRRQT           POA Units Shipp
     C                     Z-ADD*ZERO     WCRDQT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCREQT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCRFQT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCRGQT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCRHQT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCQ8QT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCQ9QT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCRAQT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCRBQT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCRCQT           POA Unused Qty_
     C                     Z-ADD*ZERO     WCBONA           POA Unused Amou
     C                     Z-ADD*ZERO     WCBONC           POA Unused Amou
     C                     Z-ADD*ZERO     WCBOND           POA Unused Amou
     C                     Z-ADD*ZERO     WCBONB           POA Unused Amou
     C                     Z-ADD*ZERO     WCBONE           POA Unused Amou
     C                     Z-ADD*ZERO     WCBONF           POA Unused Amou
     C                     Z-ADD*ZERO     WCAYNB           POA Unused Amou
     C                     Z-ADD*ZERO     WCAZNB           POA Unused Amou
     C                     Z-ADD*ZERO     WCA2NB           POA Unused Amou
     C                     Z-ADD*ZERO     WCA6NB           POA Unused Amou
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEH9NY           EDI SURROGATE N
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WGUONY           ENT01-SEQUENCE
     C                     Z-ADD*ZERO     WGMQVL           S5/G8 Amount
     C                     Z-ADD*ZERO     WGG6PC           S7/G9 Percent
     C                     Z-ADD*ZERO     WGMTVL           S8/G5 Rate
     C                     Z-ADD*ZERO     WGC2C3           S9/G7 Unit or B
     C                     Z-ADD*ZERO     WGMSVL           S10/G6 Quantity
     C                     Z-ADD*ZERO     WGQXQT           S11 Quantity
     C                     Z-ADD*ZERO     WGXINY           G4 Exception Nb
     C                     Z-ADD*ZERO     WGMUVL           G10 Dollar Basi
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIH9NY           EDI SURROGATE N
     C                     Z-ADD*ZERO     WISEQX           ITEM SEQUENCE N
     C                     Z-ADD*ZERO     WIYFNY           Item Secondary
     C                     Z-ADD*ZERO     WIMQVL           S5/G8 Amount
     C                     Z-ADD*ZERO     WIG6PC           S7/G9 Percent
     C                     Z-ADD*ZERO     WIMTVL           S8/G5 Rate
     C                     Z-ADD*ZERO     WIC2C3           S9/G7 Unit or B
     C                     Z-ADD*ZERO     WIMSVL           S10/G6 Quantity
     C                     Z-ADD*ZERO     WIQXQT           S11 Quantity
     C                     Z-ADD*ZERO     WIXINY           G4 Exception Nb
     C                     Z-ADD*ZERO     WIMUVL           G10 Dollar Basi
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
