     H/TITLE WW Load Plans for ShppgDF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 07/28/17  Time  : 14:46:52
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDMGDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Load Plans for ShppgDF Display file
      *
     FOMFJCPLAIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Load Header               SchShp(d)/Seq SEL ECU
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FPDL1REL1IF  E           K        DISK
      * RTV : User Warehouse Access     Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDKECPL1IF  E           K        DISK
      * RTV : Traffic Comments          Retrieval index
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FOPC0REL1IF  E           K        DISK
      * RTV : User Entry Control        Retrieval index       NV
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : Order Header TRG          Load(Desc) not bl
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 032  5 0A
     E                    W0END   7 032  5 0A
     E                    W0NAM   7 032 10
      * Long constants
     E                    @CN#    1  08  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WBRMNB
     I              FLRUNB                          WBRUNB
     I              FLRVNB                          WBRVNB
     I              FLDQTX                          WBDQTX
     I              FLRWNB                          WBRWNB
     I              FLRXNB                          WBRXNB
     I              FLSQNB                          WBSQNB
     I              FLT0NB                          WBT0NB
     I              FLT1NB                          WBT1NB
     I              FLR1NB                          WBR1NB
     I              FLAIC3                          WBAIC3
     I              FLC4NB                          WBC4NB
     I              FLVCST                          WBVCST
     I              FLKEDT                          WBKEDT
     I              FLSXNB                          WBSXNB
     I              FLKFDT                          WBKFDT
     I              FLACTM                          WBACTM
     I              FLK5TX                          WBK5TX
     I              FLW5CD                          WBW5CD
     I              FLEJDT                          WBEJDT
     I              FLAGTM                          WBAGTM
     I              FLKJDT                          WBKJDT
     I              FLATTM                          WBATTM
     I              FLHDDT                          WBHDDT
     I              FLAUTM                          WBAUTM
     I              FLKKDT                          WBKKDT
     I              FLAVTM                          WBAVTM
     I              FLZ4NB                          WBZ4NB
     I              FLY7ST                          WBY7ST
     I              FLY2ST                          WBY2ST
     I              FLWHTX                          WBWHTX
     I              FLWITX                          WBWITX
     I              FLWJTX                          WBWJTX
     I              FLWKTX                          WBWKTX
     I              FLWLTX                          WBWLTX
     I              FLN7DT                          WBN7DT
     I              FLN8DT                          WBN8DT
     I              FLN9DT                          WBN9DT
     I              FLB3TM                          WBB3TM
     I              FLB4TM                          WBB4TM
     I              FLB5TM                          WBB5TM
     I              FLIASX                          WBIASX
     I              FLIBSX                          WBIBSX
     I              FLICSX                          WBICSX
     I              FLWVTX                          WBWVTX
     I              FLWWTX                          WBWWTX
     I              FLWXTX                          WBWXTX
     I              FLUVST                          WBUVST
     I              FLUWST                          WBUWST
     I              FLUXST                          WBUXST
     I              FLAATM                          WBAATM
     I              FLAYNA                          WBAYNA
     I              FLA0NA                          WBA0NA
     I              FLAXDT                          WBAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     I@BFCPNQ
      * Order Header TRG          Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMGSPR                          WKGSPR
     I              OMGTPR                          WKGTPR
     I              OMGUPR                          WKGUPR
     I              OMHOST                          WKHOST
     I              OMHPST                          WKHPST
     I              OMIOST                          WKIOST
     I              OMPEWG                          WKPEWG
     I              OMRINY                          WKRINY
     I              OMTIDT                          WKTIDT
     I              OMTJDT                          WKTJDT
     I              OMH2ST                          WKH2ST
     I              OMH0ST                          WKH0ST
     I              OMH1ST                          WKH1ST
     I              OMTKDT                          WKTKDT
     I              OMTLDT                          WKTLDT
     I              OMTMDT                          WKTMDT
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WLAIC3
     I              OMC4NB                          WLC4NB
     I              OMDPNB                          WLDPNB
     I              OMUENB                          WLUENB
     I              OMHGCD                          WLHGCD
     I              OMAJCD                          WLAJCD
     I              OMBKC7                          WLBKC7
     I              OMCFC7                          WLCFC7
     I              OMGMST                          WLGMST
     I              OMGNST                          WLGNST
     I              OMMAVA                          WLMAVA
     I              OMKDVA                          WLKDVA
     I              OML8VA                          WLL8VA
     I              OML9VA                          WLL9VA
     I              OMGTST                          WLGTST
     I              OMGVST                          WLGVST
     I              OMGUST                          WLGUST
     I              OMQFST                          WLQFST
     I              OMAYVA                          WLAYVA
     I              OMEXDT                          WLEXDT
     I              OMLQCD                          WLLQCD
     I              OMRDCD                          WLRDCD
     I              OMQ7CD                          WLQ7CD
     I              OMBZPR                          WLBZPR
     I              OML6NB                          WLL6NB
     I              OMU1ST                          WLU1ST
     I              OMGIDT                          WLGIDT
     I              OMCRCD                          WLCRCD
     I              OMAGCD                          WLAGCD
     I              OMRZST                          WLRZST
     I              OMR0ST                          WLR0ST
     I              OMR1ST                          WLR1ST
     I              OMG7NA                          WLG7NA
     I              OMG8NA                          WLG8NA
     I              OMRPCD                          WLRPCD
     I              OMVEST                          WLVEST
     I              OMVGST                          WLVGST
     I              OMAVST                          WLAVST
     I              OMU0ST                          WLU0ST
     I              OMRFCD                          WLRFCD
     I              OMFZST                          WLFZST
     I              OMR1NB                          WLR1NB
     I              OMAVQT                          WLAVQT
     I              OMD0WG                          WLD0WG
     I              OMCCQT                          WLCCQT
     I              OMAUWG                          WLAUWG
     I              OMCBQT                          WLCBQT
     I              OMATWG                          WLATWG
     I              OMAQCS                          WLAQCS
     I              OMAGCS                          WLAGCS
     I              OMAKPR                          WLAKPR
     I              OMALPR                          WLALPR
     I              OMAUPR                          WLAUPR
     I              OMAVWG                          WLAVWG
     I              OMA4WG                          WLA4WG
     I              OMA5DT                          WLA5DT
     I              OMAODT                          WLAODT
     I              OMGNDT                          WLGNDT
     I              OMAMST                          WLAMST
     I              OMANST                          WLANST
     I              OMVAST                          WLVAST
     I              OMRGNB                          WLRGNB
     I              OMRHNB                          WLRHNB
     I              OMRINB                          WLRINB
     I              OMRBCD                          WLRBCD
     I              OMHICD                          WLHICD
     I              OMRNCD                          WLRNCD
     I              OMROCD                          WLROCD
     I              OMCXDT                          WLCXDT
     I              OMAJVN                          WLAJVN
     I              OMKXCD                          WLKXCD
     I              OMJPCD                          WLJPCD
     I              OMCQCD                          WLCQCD
     I              OMR4CD                          WLR4CD
     I              OMZ1ST                          WLZ1ST
     I              OMZ3ST                          WLZ3ST
     I              OMZ4ST                          WLZ4ST
     I              OMDUPR                          WLDUPR
     I              OMB6VL                          WLB6VL
     I              OMA1AA                          WLA1AA
     I              OMFZSX                          WLFZSX
     I              OMF0SX                          WLF0SX
     I              OMF1SX                          WLF1SX
     I              OMF2SX                          WLF2SX
     I              OMF3SX                          WLF3SX
     I              OMF4SX                          WLF4SX
     I              OMF5SX                          WLF5SX
     I              OMF6SX                          WLF6SX
     I              OMF7SX                          WLF7SX
     I              OMNTDT                          WLNTDT
     I              OMNUDT                          WLNUDT
     I              OMNVDT                          WLNVDT
     I              OMNWDT                          WLNWDT
     I              OMNXDT                          WLNXDT
     I              OMBUTM                          WLBUTM
     I              OMBVTM                          WLBVTM
     I              OMBWTM                          WLBWTM
     I              OMBXTM                          WLBXTM
     I              OMBYTM                          WLBYTM
     I              OMH5NX                          WLH5NX
     I              OMH6NX                          WLH6NX
     I              OMH7NX                          WLH7NX
     I              OMH8NX                          WLH8NX
     I              OMH9NX                          WLH9NX
     I              OMDVPR                          WLDVPR
     I              OMDWPR                          WLDWPR
     I              OMDXPR                          WLDXPR
     I              OMDYPR                          WLDYPR
     I              OMDZPR                          WLDZPR
     I              OMGSPR                          WLGSPR
     I              OMGTPR                          WLGTPR
     I              OMGUPR                          WLGUPR
     I              OMHOST                          WLHOST
     I              OMHPST                          WLHPST
     I              OMIOST                          WLIOST
     I              OMPEWG                          WLPEWG
     I              OMRINY                          WLRINY
     I              OMTIDT                          WLTIDT
     I              OMTJDT                          WLTJDT
     I              OMH2ST                          WLH2ST
     I              OMH0ST                          WLH0ST
     I              OMH1ST                          WLH1ST
     I              OMTKDT                          WLTKDT
     I              OMTLDT                          WLTLDT
     I              OMTMDT                          WLTMDT
     I              OMUVST                          WLUVST
     I              OMUWST                          WLUWST
     I              OMUXST                          WLUXST
     I              OMAATM                          WLAATM
     I              OMAYNA                          WLAYNA
     I              OMA0NA                          WLA0NA
     I              OMAXDT                          WLAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WHRMNB
     I              FLRUNB                          WHRUNB
     I              FLRVNB                          WHRVNB
     I              FLDQTX                          WHDQTX
     I              FLRWNB                          WHRWNB
     I              FLRXNB                          WHRXNB
     I              FLSQNB                          WHSQNB
     I              FLT0NB                          WHT0NB
     I              FLT1NB                          WHT1NB
     I              FLR1NB                          WHR1NB
     I              FLAIC3                          WHAIC3
     I              FLC4NB                          WHC4NB
     I              FLVCST                          WHVCST
     I              FLKEDT                          WHKEDT
     I              FLSXNB                          WHSXNB
     I              FLKFDT                          WHKFDT
     I              FLACTM                          WHACTM
     I              FLK5TX                          WHK5TX
     I              FLW5CD                          WHW5CD
     I              FLEJDT                          WHEJDT
     I              FLAGTM                          WHAGTM
     I              FLKJDT                          WHKJDT
     I              FLATTM                          WHATTM
     I              FLHDDT                          WHHDDT
     I              FLAUTM                          WHAUTM
     I              FLKKDT                          WHKKDT
     I              FLAVTM                          WHAVTM
     I              FLZ4NB                          WHZ4NB
     I              FLY7ST                          WHY7ST
     I              FLY2ST                          WHY2ST
     I              FLWHTX                          WHWHTX
     I              FLWITX                          WHWITX
     I              FLWJTX                          WHWJTX
     I              FLWKTX                          WHWKTX
     I              FLWLTX                          WHWLTX
     I              FLN7DT                          WHN7DT
     I              FLN8DT                          WHN8DT
     I              FLN9DT                          WHN9DT
     I              FLB3TM                          WHB3TM
     I              FLB4TM                          WHB4TM
     I              FLB5TM                          WHB5TM
     I              FLIASX                          WHIASX
     I              FLIBSX                          WHIBSX
     I              FLICSX                          WHICSX
     I              FLWVTX                          WHWVTX
     I              FLWWTX                          WHWWTX
     I              FLWXTX                          WHWXTX
     I              FLUVST                          WHUVST
     I              FLUWST                          WHUWST
     I              FLUXST                          WHUXST
     I              FLAATM                          WHAATM
     I              FLAYNA                          WHAYNA
     I              FLA0NA                          WHA0NA
     I              FLAXDT                          WHAXDT
      *
     IYBRDCS      DS                            367
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     IYCRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMGSPR                          WKGSPR
     I              OMGTPR                          WKGTPR
     I              OMGUPR                          WKGUPR
     I              OMHOST                          WKHOST
     I              OMHPST                          WKHPST
     I              OMIOST                          WKIOST
     I              OMPEWG                          WKPEWG
     I              OMRINY                          WKRINY
     I              OMTIDT                          WKTIDT
     I              OMTJDT                          WKTJDT
     I              OMH2ST                          WKH2ST
     I              OMH0ST                          WKH0ST
     I              OMH1ST                          WKH1ST
     I              OMTKDT                          WKTKDT
     I              OMTLDT                          WKTLDT
     I              OMTMDT                          WKTMDT
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     IYDRDCS      DS                            525
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop/Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
      * Outward parameters
     IPCRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PCRMNB
      *
     IYERDCS      DS                            793
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYFRDCS      DS                            793
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Enterprise Code 1
     I                                        6   9 P1DQCD
      * N :  Enterprise Code 2
     I                                       10  21 P1DRCD
      * N :  Salesperson Code
     I                                       22  24 P1BCCD
      * N :  System Date Format
     I                                       25  27 P1B8NA
      * N :  User Profile Name
     I                                       28  37 P1AJVN
      * N :  Allow Multi-Company
     I                                       38  38 P1I6ST
      * N :  Allow Multi Warehouse
     I                                       39  39 P1I8ST
      * N :  Default Printer
     I                                       40  49 P1MPNA
      * N :  First Time Flag
     I                                       50  50 P1TAST
      * N :  Requested Delivery Date
     I                                    P  51  540P1EIDT
     IP2PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P2G3TX
      * N :  PRT Printer Device
     I                                       26  35 P2WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * N :  PRT Number of Copies
     I                                       44  450P2DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P2WUST
      * N :  PRT Night Queue
     I                                       47  56 P2BVVN
      * N :  Company Number Pass   USR
     I                                    P  57  645P2AJAA
      * N :  Date 1          PASS  USR
     I                                    P  65  725P2AJAB
      * N :  Order Number 1  PASS  USR
     I                                    P  73  805P2AJAE
      * N :  System Value Numeric
     I                                    P  81  885P2M8NB
      * N :  Status - Y or N
     I                                       89  89 P2B8ST
      * N :  Change Flag USR
     I                                       90  90 P2HWSX
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Display Prt Opt Pmt USR
     I                                        1   4 P3XFST
      * N :  USR Output Only Status
     I                                        5   5 P3E5ST
      * N :  USR Print Detail
     I                                        6   6 P3E7ST
      * N :  Seq No 1  PASS        USR
     I                                    P   7  145P3SEQ1
      * N :  USR Update Flag
     I                                       15  15 P3R4ST
      * N :  Error Status
     I                                       16  16 P3ECST
      * N :  USR Weight Accumulated
     I                                    P  17  222P3CDWG
     IP4PARM      DS
      * N :  USR Flag 1
     I                                        1   1 P4D4ST
     IP5PARM      DS
      * N :  Job Name CDE
     I                                        1  10 P5B2VN
     IP6PARM      DS
      * FLD: Load Header
      * N :  Load ID
     I                                    P   1   40P6RMNB
      * N :  Carrier Code
     I                                        5   7 P6BZNA
     IP7PARM      DS
      * N :  Job Name
     I                                        1  10 P7A0NA
     IP8PARM      DS
      * N : MAP Stop/Drop
     I                                    P   1   30P8RVNB
     IP9PARM      DS
      * N :  Numeric 4,0           USR
     I                                    P   1   30P9G0NX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0001
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0002
      * Warehouse Code
     I                                       11  13 ZA0003
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0004
      * Condition Name USR
     I                                       11  35 ZA0005
      * Warehouse Code
     I                                       36  38 ZA0006
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0007
      * Condition Name USR
     I                                       11  35 ZA0008
      * Warehouse Code
     I                                       36  38 ZA0009
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0010
      * Condition Name USR
     I                                       11  35 ZA0011
      * Warehouse Code
     I                                       36  38 ZA0012
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0013
      * Condition Name USR
     I                                       11  35 ZA0014
      * Warehouse Code
     I                                       36  38 ZA0015
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0016
      * Condition Name USR
     I                                       11  35 ZA0017
      * Warehouse Code
     I                                       36  38 ZA0018
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0019
      * Condition Name USR
     I                                       11  35 ZA0020
      * Warehouse Code
     I                                       36  38 ZA0021
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0022
      * Condition Name USR
     I                                       11  35 ZA0023
      * Warehouse Code
     I                                       36  38 ZA0024
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0025
      * Condition Name USR
     I                                       11  35 ZA0026
      * Warehouse Code
     I                                       36  38 ZA0027
      * Message data for 'CD3 Non numeric data'
      * Message data for 'OM Load Header not found'
      * Load ID
     I                                    P   1   40ZA0028
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0029
      * Load ID
     I                                    P   2   50ZA0030
      * Message data for 'Load Shipped Can't Unlock'
      * Load Status
     I                                        1   1 ZA0031
      * Message data for 'Load Picked, Unlock Inval'
      * Load Status
     I                                        1   1 ZA0032
      * Message data for 'Unlock Inval, close exist'
      * *SFLSEL
     I                                        1   1 ZA0033
      * Message data for 'No Orders Assigned'
      * Load ID
     I                                    P   1   40ZA0034
      * *SFLSEL
     I                                        5   5 ZA0035
      * Message data for 'Block Orders on Ld-no UPD'
      * *SFLSEL
     I                                        1   1 ZA0036
      * Load ID
     I                                    P   2   50ZA0037
      * Message data for 'Load Cant be Locked'
      * *SFLSEL
     I                                        1   1 ZA0038
      * Load ID
     I                                    P   2   50ZA0039
      * Message data for 'Carrier must be entered'
      * Carrier Code
     I                                        1   3 ZA0040
      * Load ID
     I                                    P   4   70ZA0041
      * Message data for 'Truck size must be enter'
      * Truck Size
     I                                        1   7 ZA0042
      * Load ID
     I                                    P   8  110ZA0043
      * Message data for 'Shipping Method required'
      * Shipping Method
     I                                        1   2 ZA0044
      * Message data for 'Load has orders w/o stop'
      * Load ID
     I                                    P   1   40ZA0045
      * Message data for 'Load is not accepted'
      * Load ID
     I                                    P   1   40ZA0046
      * Message data for 'Load has Orders on Hold'
      * Load ID
     I                                    P   1   40ZA0047
      * *SFLSEL
     I                                        5   5 ZA0048
      * Message data for 'Load has Cancelled Orders'
      * Load ID
     I                                    P   1   40ZA0049
      * *SFLSEL
     I                                        5   5 ZA0050
      * Message data for 'Load has Orders in Use'
      * *SFLSEL
     I                                        1   1 ZA0051
      * Load ID
     I                                    P   2   50ZA0052
      * Message data for 'Order detail needs review'
      * *SFLSEL
     I                                        1   1 ZA0053
      * Load ID
     I                                    P   2   50ZA0054
      * Message data for 'Load Weight LT Minimum'
      * Load ID
     I                                    P   1   40ZA0055
      * Message data for 'Load is not accepted'
      * Load ID
     I                                    P   1   40ZA0056
      * Message data for 'Preliminary Pick Printing'
      * USR Warehouse Code
     I                                        1   3 ZA0057
      * USR CDE Parm 1
     I                                        4   6 ZA0058
      * USR CDE Parm 2
     I                                        7   9 ZA0059
      * USR CDE Parm 3
     I                                       10  12 ZA0060
      * USR CDE Parm 4
     I                                       13  15 ZA0061
      * USR CDE Parm 5
     I                                       16  18 ZA0062
      * USR CDE Parm 6
     I                                       19  21 ZA0063
      * USR CDE Parm 7
     I                                       22  24 ZA0064
      * USR CDE Parm 8
     I                                       25  27 ZA0065
      * USR CDE Parm 9
     I                                       28  30 ZA0066
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0067
      * Application Code
     I                                       11  16 ZA0068
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0069
      * Application Code
     I                                       11  16 ZA0070
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: PAR.First Time Flag is Yes
     C           P1TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
     C                     MOVELP1AJCD    #CCPCD           USR Warehouse C
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     MOVEL'N'       P1TAST           First Time Flag
     C                     Z-ADD#CG0NX    P9G0NX           Numeric 4,0
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CADTX    P      Name
     C                     MOVEL#2BZNA    #CR6CD           USR Carrier Cod
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SBRVGN
      * Val:  Warehouse Code
      * CASE: CTL.USR Warehouse Code is Warehouse Code Blank
     C           #CCPCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CCPCD    ZA0001           USR Warehouse C
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0001  1        UWA Inventory T
     C                     MOVEL*BLANK    WN0002  1        UWA Lot Loc Tra
     C                     MOVEL*BLANK    WN0003  1        UWA Shipping Tr
     C                     MOVEL*BLANK    WN0004  1        UWA Cross Appli
     C                     MOVEL*BLANK    WN0005  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0006  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0007  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0008  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0009  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0010  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0011  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0012  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0013  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0014  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0015  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0016  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0017  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0018  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0019  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0020 10        User Code Model
     C                     MOVEL*BLANK    WN0021  1        Record Found US
      *
      * Val User Whs Access   IF
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR SCRVGN
      * Retrieve User Warehouse Access Type
      * CASE: PAR.User Code Model is equal to blank
     C           WN0020    IFEQ *BLANK                     *IF
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0003    P      User Profile Na
     C                     MOVEL#CCPCD    WL0004    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0001    P      UWA Inventory T
     C                     MOVELWL0006    WN0002    P      UWA Lot Loc Tra
     C                     MOVELWL0007    WN0003    P      UWA Shipping Tr
     C                     MOVELWL0008    WN0004    P      UWA Cross Appli
     C                     MOVELWL0009    WN0005    P      UWA Unused Stat
     C                     MOVELWL0010    WN0006    P      UWA Unused Stat
     C                     MOVELWL0011    WN0007    P      UWA Unused Sts
     C                     MOVELWL0012    WN0008    P      UWA Unused Sts
     C                     MOVELWL0013    WN0009    P      UWA Unused Sts
     C                     MOVELWL0014    WN0010    P      UWA Unused Sts
     C                     MOVELWL0015    WN0011    P      UWA Unused Sts
     C                     MOVELWL0016    WN0012    P      UWA Unused Sts
     C                     MOVELWL0017    WN0013    P      UWA Unused Sts
     C                     MOVELWL0018    WN0014    P      UWA Unused Sts
     C                     MOVELWL0019    WN0015    P      UWA Unused Sts
     C                     MOVELWL0020    WN0016    P      UWA Unused Sts
     C                     MOVELWL0021    WN0017    P      UWA Unused Sts
     C                     MOVELWL0022    WN0018    P      UWA Unused Sts
     C                     MOVELWL0023    WN0019    P      UWA Unused Sts
     C                     MOVELWL0024    WN0021    P      Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0020    WL0003    P      User Profile Na
     C                     MOVEL#CCPCD    WL0004    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0001    P      UWA Inventory T
     C                     MOVELWL0006    WN0002    P      UWA Lot Loc Tra
     C                     MOVELWL0007    WN0003    P      UWA Shipping Tr
     C                     MOVELWL0008    WN0004    P      UWA Cross Appli
     C                     MOVELWL0009    WN0005    P      UWA Unused Stat
     C                     MOVELWL0010    WN0006    P      UWA Unused Stat
     C                     MOVELWL0011    WN0007    P      UWA Unused Sts
     C                     MOVELWL0012    WN0008    P      UWA Unused Sts
     C                     MOVELWL0013    WN0009    P      UWA Unused Sts
     C                     MOVELWL0014    WN0010    P      UWA Unused Sts
     C                     MOVELWL0015    WN0011    P      UWA Unused Sts
     C                     MOVELWL0016    WN0012    P      UWA Unused Sts
     C                     MOVELWL0017    WN0013    P      UWA Unused Sts
     C                     MOVELWL0018    WN0014    P      UWA Unused Sts
     C                     MOVELWL0019    WN0015    P      UWA Unused Sts
     C                     MOVELWL0020    WN0016    P      UWA Unused Sts
     C                     MOVELWL0021    WN0017    P      UWA Unused Sts
     C                     MOVELWL0022    WN0018    P      UWA Unused Sts
     C                     MOVELWL0023    WN0019    P      UWA Unused Sts
     C                     MOVELWL0024    WN0021    P      Record Found US
     C                     END                             *FI
      * Validate Access
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0021    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0002           User Profile Na
     C                     MOVEL#CCPCD    ZA0003           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Inventory Transactions
      * CASE: PAR.Access Area Needed USR is Inventory Transactions
     C           'S'       IFEQ 'I'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Inventory Trans is *Not Update
     C           WN0001    IFEQ 'N'                        *IF
     C           WN0001    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0022 10        Condition Name
     C                     MOVEL*BLANK    WN0023 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0022    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0023    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0022    ZA0004           Condition Name
     C                     MOVELWN0023    ZA0005           Condition Name
     C                     MOVEL#CCPCD    ZA0006           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Inventory Trans is None
     C           WN0001    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0024 10        Condition Name
     C                     MOVEL*BLANK    WN0025 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0024    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0025    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0024    ZA0007           Condition Name
     C                     MOVELWN0025    ZA0008           Condition Name
     C                     MOVEL#CCPCD    ZA0009           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Lot Loc Transactions
      * CASE: PAR.Access Area Needed USR is Lot Loc Transactions
     C           'S'       IFEQ 'L'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is *Not Update
     C           WN0002    IFEQ 'N'                        *IF
     C           WN0002    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0026 10        Condition Name
     C                     MOVEL*BLANK    WN0027 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0026    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0027    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0026    ZA0010           Condition Name
     C                     MOVELWN0027    ZA0011           Condition Name
     C                     MOVEL#CCPCD    ZA0012           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is None
     C           WN0002    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0028 10        Condition Name
     C                     MOVEL*BLANK    WN0029 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0028    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0029    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0028    ZA0013           Condition Name
     C                     MOVELWN0029    ZA0014           Condition Name
     C                     MOVEL#CCPCD    ZA0015           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shipping Transactions
      * CASE: PAR.Access Area Needed USR is Shipping Transactions
     C           'S'       IFEQ 'S'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Shipping Trans is *Not Update
     C           WN0003    IFEQ 'N'                        *IF
     C           WN0003    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0030 10        Condition Name
     C                     MOVEL*BLANK    WN0031 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0030    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0031    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0030    ZA0016           Condition Name
     C                     MOVELWN0031    ZA0017           Condition Name
     C                     MOVEL#CCPCD    ZA0018           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Shipping Trans is None
     C           WN0003    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0032 10        Condition Name
     C                     MOVEL*BLANK    WN0033 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0032    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0033    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0032    ZA0019           Condition Name
     C                     MOVELWN0033    ZA0020           Condition Name
     C                     MOVEL#CCPCD    ZA0021           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Cross Applications
      * CASE: PAR.Access Area Needed USR is Cross Applications
     C           'S'       IFEQ 'C'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Unused Sts is *Not Update
     C           WN0004    IFEQ 'N'                        *IF
     C           WN0004    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0034 10        Condition Name
     C                     MOVEL*BLANK    WN0035 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0034    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0035    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0034    ZA0022           Condition Name
     C                     MOVELWN0035    ZA0023           Condition Name
     C                     MOVEL#CCPCD    ZA0024           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Unused Sts is None
     C           WN0004    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0036 10        Condition Name
     C                     MOVEL*BLANK    WN0037 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0036    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0037    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0036    ZA0025           Condition Name
     C                     MOVELWN0037    ZA0026           Condition Name
     C                     MOVEL#CCPCD    ZA0027           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           FJAODT           Scheduled Ship
     C                     KFLD           FJT4NB           Schedule Sequen
      * Setup key
     C           #2AODT    IFEQ *ZERO
     C                     MOVEL*HIVAL    FJAODT           Scheduled Ship
     C                     ELSE
     C                     Z-ADD#2AODT    FJAODT
     C                     ENDIF
     C                     Z-ADD#2T4NB    FJT4NB
     C           KPOS      SETLL@FJCPJ1
     C                     READ @FJCPJ1                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2T4NB    WZT4NB
     C                     MOVEL#2T4NB    WZT4NB           Schedule Sequen
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2TLMI    WZTLMI
     C                     MOVEL#2TLMI    WZTLMI           Total Load Mile
     C           *LIKE     DEFN #2RPNB    WZRPNB
     C                     MOVEL#2RPNB    WZRPNB           Total Load Orde
     C           *LIKE     DEFN #2DXTX    WZDXTX
     C                     MOVEL#2DXTX    WZDXTX           Trailer Id
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #CO6NA    WZO6NA
     C                     MOVEL#CO6NA    WZO6NA           Warehouse Desc
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2PKST    WZPKST
     C                     MOVEL#2PKST    WZPKST           Load Status
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@FJCPJ1                  90*
     C  N82                READ @FJCPJ1                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,41
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2T4NB    IFNE *ZERO                      Schedule Sequen
     C           FJT4NB    CABLT#2T4NB    BB020            Schedule Sequen
     C                     END
     C                     END
     C           #2VDST    IFNE *BLANK                     Load Type
     C           FJVDST    CABNE#2VDST    BB020            Load Type
     C                     END
     C           #2RPNB    IFNE *ZERO                      Total Load Orde
     C           FJRPNB    CABGT#2RPNB    BB020            Total Load Orde
     C                     END
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           FJRMNB    CABLT#2RMNB    BB020            Load ID
     C                     END
     C           #2EIDT    IFNE *ZERO                      Requested Deliv
     C           FJEIDT    CABLT#2EIDT    BB020            Requested Deliv
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * If company selection is made, then select only that company
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Company Number is not equal to zero
      *   |- c2    : DB1.Company Number NE CTL.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFNE *ZERO                      *IF
     C           FJAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Multi Company Load is no
     C           FJRVSX    IFEQ 'N'                        *IF
      * RMC 7/27/06 ADDED THIS CASE FOR MULTI-PICKUP LOADS TO BE SEEN BY
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Sel Load by Whs       IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Sel Order by Whs      RT - Order Header TRG  * 
     C                     EXSR SERVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * If carrier selection is made, then select only that carrier
      * CASE: CTL.Carrier Code is entered
     C           #2BZNA    IFNE *BLANK                     *IF
      * CASE: CTL.Carrier Code is Select Blank Carriers
     C           #2BZNA    IFEQ '*'                        *IF
      * CASE: DB1.Carrier Code is entered
     C           FJBZNA    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Carrier Code NE DB1.Carrier Code
     C           #2BZNA    IFNE FJBZNA                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process INC/EXC option
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: CTL.Load Status EQ WRK.BLANK
     C           #2PKST    IFEQ WUGSTX                     *IF
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
      * Select only records which match CTL load status
      * CASE: DB1.Load Status NE CTL.Load Status
     C           FJPKST    IFNE #2PKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
      * Select only records which do NOT match CTL load status
      * CASE: DB1.Load Status EQ CTL.Load Status
     C           FJPKST    IFEQ #2PKST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELFJDXTX    #RS2TX           Trailer ID USR
     C                     END                             *FI
      * Get Last Stop on Order
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0025           Load ID
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    WUBKC7           Ship To Custome
     C                     MOVELWL0027    WUBRTX    P      Ship To Name
     C                     MOVELWL0028    WUHMNA    P      Ship To Address
     C                     MOVELWL0029    WUHONA    P      Ship To Address
     C                     MOVELWL0030    WUHPNA    P      Ship To Address
     C                     MOVELWL0031    #RLINA    P      Ship To City
     C                     MOVELWL0032    #RV9CD    P      Ship To State C
     C                     MOVELWL0033    WUCKTX    P      Ship To Zip/Pos
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Ship To State Code is State code not Blanks
      *   |- c2    : RCD.USR State Code NE CTL.Ship To State Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2DBCD    IFNE *BLANK                     *IF
     C           #RV9CD    IFNE #2DBCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * RST: Scheduled Ship Date
      * CASE: CTL.Scheduled Ship Date is entered
     C           #2AODT    IFNE *ZERO                      *IF
      * CASE: DB1.Scheduled Ship Date NE CTL.Scheduled Ship Date
     C           FJAODT    IFNE #2AODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Setup Delivery Checked field, according to On Time Y/N
      * CASE: DB1.On Time - (Y/N) is Y/N Values
     C           FJONTM    IFEQ 'N'                        *IF
     C           FJONTM    OREQ 'Y'
     C                     MOVEL'Y'       #RB8ST           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RB8ST           Status - Y or N
     C                     END                             *FI
      * Restrict on Delivery Checked field
      * CASE: CTL.Status - Y or N is Y/N Values
     C           #CB8ST    IFEQ 'N'                        *IF
     C           #CB8ST    OREQ 'Y'
      * CASE: RCD.Status - Y or N NE CTL.Status - Y or N
     C           #RB8ST    IFNE #CB8ST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * * 05/15/00 PKD OMS336 Replaced with routine that will include
      * *              the Pallet Tare Weight.
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
     C                     EXSR SIRVGN
      * *----------------------------------------------------------------
     C                     Z-ADDP3CDWG    #RG2NX           Weight Adjust 6
      * Highlight load number if traffic comments exist
      * RTV Verify Trffc Cmnts RT - PD Traffic Comments  * 
     C                     EXSR SKRVGN
      * Set Highlight Flag
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'Y'       #RKOST           Include Todays
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RKOST           Include Todays
     C                     END                             *FI
      * OMS203:  no updates will be allowed if load contains block orders
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0038           Load ID
     C                     MOVEL#RBCST    WL0040    P      Block Order Fla
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    WUG0TX    P      USR Check Y/N S
     C                     MOVELWL0040    #RBCST    P      Block Order Fla
      * ** Highlight miles if Override miles is used        E00207
      * CASE: DB1.Override Total Load Miles is Entered
     C           FJK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDFJK2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFJTLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     END                             *FI
     C                     Z-ADDFJT4NB    #RG0NX           Numeric 4,0
     C                     MOVEL'N'       P4D4ST           USR Flag 1
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @FJCPJ1                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDV2EIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDXDINDT    #2EIDT
      * Validate Load Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2PKST'  IFEQ YPMTFD
      * Load Status
     C                     MOVEL#2PKST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFPKST
     C                     SELEC
     C           W0INVL    WHEQ 'U'                        U
     C                     Z-ADD1         ZFPKST
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD2         ZFPKST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZFPKST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD4         ZFPKST
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD5         ZFPKST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD6         ZFPKST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD7         ZFPKST
     C                     ENDSL
     C                     EXFMTZEPKST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFPKST    WHEQ 1
     C                     MOVEL'U'       W0INVL           U
     C           ZFPKST    WHEQ 2
     C                     MOVEL'L'       W0INVL           L
     C           ZFPKST    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZFPKST    WHEQ 4
     C                     MOVEL'E'       W0INVL           E
     C           ZFPKST    WHEQ 5
     C                     MOVEL'C'       W0INVL           C
     C           ZFPKST    WHEQ 6
     C                     MOVEL'I'       W0INVL           I
     C           ZFPKST    WHEQ 7
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2PKST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Status - Y or N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CB8ST'  IFEQ YPMTFD
      * Status - Y or N
     C                     MOVEL#CB8ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFB8ST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZFB8ST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZFB8ST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZFB8ST
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD4         ZFB8ST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD5         ZFB8ST
     C           W0INVL    WHEQ 'X'                        X
     C                     Z-ADD6         ZFB8ST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD7         ZFB8ST
     C           W0INVL    WHEQ 'Z'                        Z
     C                     Z-ADD8         ZFB8ST
     C           W0INVL    WHEQ 'G'                        G
     C                     Z-ADD9         ZFB8ST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD10        ZFB8ST
     C                     ENDSL
     C                     EXFMTZEB8ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFB8ST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFB8ST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZFB8ST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFB8ST    WHEQ 4
     C                     MOVEL'F'       W0INVL           F
     C           ZFB8ST    WHEQ 5
     C                     MOVEL'P'       W0INVL           P
     C           ZFB8ST    WHEQ 6
     C                     MOVEL'X'       W0INVL           X
     C           ZFB8ST    WHEQ 7
     C                     MOVEL'E'       W0INVL           E
     C           ZFB8ST    WHEQ 8
     C                     MOVEL'Z'       W0INVL           Z
     C           ZFB8ST    WHEQ 9
     C                     MOVEL'G'       W0INVL           G
     C           ZFB8ST    WHEQ 10
     C                     MOVEL'S'       W0INVL           S
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CB8ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * f5=refresh
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CASE: CTL.Numeric 4,0           USR is *Zero
     C           #CG0NX    IFEQ *ZERO                      *IF
      * CASE: CTL.Numeric 4,0           USR NE PAR.Numeric 4,0
     C           #CG0NX    IFNE P9G0NX                     *IF
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     P9G0NX           Numeric 4,0
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#CG0NX    #2T4NB           Schedule Sequen
     C                     Z-ADD#CG0NX    P9G0NX           Numeric 4,0
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZEIDT    CASNE#2EIDT    FBRQRL
     C           WZPKST    CASNE#2PKST    FBRQRL
     C           WZDBCD    CASNE#2DBCD    FBRQRL
     C           WZBZNA    CASNE#2BZNA    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * Select
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Company Number
     C           W0CFL     IFEQ 'V2AIC3'                   *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0008  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> CTL.USR Warehouse Code
     C           W0CFL     IFEQ '#CCPCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #CCPCD    PARM #CCPCD    WQ0009  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reload Subfile if Warehouse Code changed.
      * CASE: PAR.Warehouse Code NE CTL.USR Warehouse Code
     C           P1AJCD    IFNE #CCPCD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#CCPCD    P1AJCD           Warehouse Code
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL'N'       P3E7ST           USR Print Detai
      * Toggle Include/Exclude
      * CASE: CTL.*CMD key is *Option Toggle
     C           *IN08     IFEQ '1'                        *IF
      * CASE: CTL.Include/Exclude Option is Include
     C           #CVQCD    IFEQ 'INC'                      *IF
     C                     MOVEL'EXC'     #CVQCD           Include/Exclude
     C                     ELSE
      * CASE: CTL.Include/Exclude Option is Exclude
     C           #CVQCD    IFEQ 'EXC'                      *IF
     C                     MOVEL'INC'     #CVQCD           Include/Exclude
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Reload subfile if DC control field, carrier changes.
      * CASE: PAR.Status - Y or N NE CTL.Status - Y or N
     C           P2B8ST    IFNE #CB8ST                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#CB8ST    P2B8ST           Status - Y or N
     C                     ELSE
      * CASE: CTL.Carrier Code NE CTL.USR Carrier Code
     C           #2BZNA    IFNE #CR6CD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#2BZNA    #CR6CD           USR Carrier Cod
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * CASE: PAR.USR Update Flag is No
     C           P3R4ST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,41
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * OMS203: 1/97  no updates allowed if load contains block orders
      * * Ensure have current data  (put miles into wrk context E00207)
      * RTV WW Screen Fields   RT - Load Header  * 
     C                     EXSR SMRVGN
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0041           Load ID
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    YN0001    P      Load Status
     C                     Z-ADDWL0043    YN0002           Total Load Mile
     C                     Z-ADDWL0044    #1K2DT           Override Total
      * Error if Load Header Not Found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0028           Load ID
      * Send message 'OM Load Header not found'
     C                     MOVEL'USR2313' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * RTV Any Ord/Blk  on Ld RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0038           Load ID
     C                     MOVEL#RBCST    WL0040    P      Block Order Fla
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    WUG0TX    P      USR Check Y/N S
     C                     MOVELWL0040    #RBCST    P      Block Order Fla
      * ** Put Override miles, if entered, on the screen        E00207
      * CASE: RCD.Override Total Load Miles is Entered
     C           #1K2DT    IFNE *ZERO                      *IF
     C                     Z-ADD#1K2DT    #RG1NX           Total Miles 4,0
     C                     MOVEL'Y'       #RHWSX           Change Flag USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUTLMI    #RG1NX           Total Miles 4,0
     C                     MOVEL'N'       #RHWSX           Change Flag USR
     C                     END                             *FI
     C                     MOVEL#1DXTX    #RS2TX           Trailer ID USR
      * ** FP1101 LJB 04/10/2007
      * ** Edit Export is now being done at the Order level, prevent
      * ** the code from being activated here.
      * ** Actually, the keys on this screen are hidden.
      * 7=Unlock-If process unlock request, check for errors
      * CASE: RCD.*SFLSEL is *Unlock Load
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * RMC PFS017 new par.allow unlock if picked feature is yes
      *
     C                     MOVEL*BLANK    WN0041  1        Access Denied (
      *
      * EDT Unlock Load Edits  IF
      * assume will have error
     C                     MOVEL'Y'       P3ECST           Error Status
      *
     C                     MOVEL*BLANK    WN0042 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0042           User Profile Na
      *
     C                     MOVEL*BLANK    WN0043 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0042    WL0045    P      User Profile Na
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUG0TX    P      Allow Multi-Com
     C                     MOVELWL0047    WUG0TX    P      Default Printer
     C                     MOVELWL0048    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0049    YL0005           Company Number
     C                     MOVELWL0050    WN0043    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0043    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0042    WL0051    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0052    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WUAIC3           Company Number
     C                     MOVELWL0054    YL0006    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0043    WL0051    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0052    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WUAIC3           Company Number
     C                     MOVELWL0054    YL0006    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0006    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0005    IFGT 0                          *IF
     C                     Z-ADDYL0005    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0006    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0007    WL0056           Shipping Compan
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0041           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUG0TX    P      Name
     C                     END                             *FI
      * check the entry control field too.  4/28/05 so christa can do.
      * Rtv Unlock Load Authr RT - Entry Control  * 
     C                     EXSR SRRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Access Denied (Y/N) is yes
      *   |- c2    : WRK.Unlock Load Authority is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0041    IFEQ 'Y'                        *IF
     C           WUHTST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * If load has been shipped, can't unlock. RMC Chg for picked 5/31/0
      * CASE: PAR.Block Order Flag is Block Order
     C           #RBCST    IFEQ 'B'                        *IF
      *   (load contains a block order)
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0029           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0030           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0031           Load Status
      * Send message 'Load Shipped Can't Unlock'
     C                     MOVEL'USR1272' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * **** Determine if Load has been picked, if yes do not allow unloc
      * **** This function checks OP Order Events & AS Picked Acknowledgm
      * CASE: PAR.Allow Unlock if Picked St is No
     C           WUZUSX    IFEQ 'N'                        *IF
      * Do this one if par is NO. We dont want an UNLOCK if there are XOx
      *   and it isnt shipping doing it.
      * RTV Load Order Picked  XF - AS Order Header  * 
     C                     CALL 'PDQVXFR'              90  RTV Load Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0010  70       Load ID
     C                     PARM #1AIC3    WQ0011  30       Company Number
     C           WUZMST    PARM WUZMST    WQ0012  1        Pick Status USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
      * Allow if picked but not Close Order or Close Truck  5/31/06
      * CASE: WRK.Pick Status USR is Picked
     C           WUZMST    IFEQ 'Y'                        *IF
      * CASE: PAR.Allow Unlock if Picked St is No
     C           WUZUSX    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL#1PKST    ZA0032           Load Status
      * Send message 'Load Picked, Unlock Inval'
     C                     MOVEL'USR1999' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Val Close Ord/Trk XF - PFS Ship Load/Order Sts  * 
     C                     CALL 'PPYIXFR'              90  PFS Val Close O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0013  70       Load ID
     C           WUB8ST    PARM *BLANK    WQ0014  1        Status - Y or N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0033           *SFLSEL
      * Send message 'Unlock Inval, close exist'
     C                     MOVEL'USR3629' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Unlock Load Pending'
     C                     MOVEL'USR1274' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set confirm if error
      * CASE: PAR.Error Status is yes
     C           P3ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
      * 8=Lock Load-If process lock request, check for errors
      * CASE: RCD.*SFLSEL is *Lock Load
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * ** Don't allow lock if errors pending in Order Detail  P0012581
      *
     C                     Z-ADD*ZERO     WN0044  70       Maximum pounds
     C                     Z-ADD*ZERO     WN0045  70       Minimum pounds
     C                     MOVEL*BLANK    WN0046  1        USR Orders on L
     C                     MOVEL*BLANK    WN0047  1        Order in Use
     C                     MOVEL*BLANK    WN0048  1        Header Status
     C                     MOVEL*BLANK    WN0049  1        Access Denied (
      *
      * EDT Lock Load Edits    IF
      * assume will have error
     C                     MOVEL'Y'       P3ECST           Error Status
      *
     C                     MOVEL*BLANK    WN0050 10        User Profile Na
      *
      * VAL Set Int.Acc No Hdg IF
     C                     MOVEL##USR     WN0050           User Profile Na
      *
     C                     MOVEL*BLANK    WN0051 10        User Code Model
      *
      * VAL User/Appl No Exit  IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0050    WL0045    P      User Profile Na
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    WUG0TX    P      Allow Multi-Com
     C                     MOVELWL0047    WUG0TX    P      Default Printer
     C                     MOVELWL0048    WUG0TX    P      Salesperson Cod
     C                     Z-ADDWL0049    YL0005           Company Number
     C                     MOVELWL0050    WN0051    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0051    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0050    WL0051    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0052    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WUAIC3           Company Number
     C                     MOVELWL0054    YL0006    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0051    WL0051    P      User Profile Na
     C                     MOVEL'LOCKLD'  WL0052    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    WUAIC3           Company Number
     C                     MOVELWL0054    YL0006    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0006    WUG0TX           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: LCL.Company Number is greater than zero
     C           YL0005    IFGT 0                          *IF
     C                     Z-ADDYL0005    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0006    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0007    WL0056           Shipping Compan
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0055    WUG0TX    P      Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    WUNFNN           Company Number
     C                     MOVELWUWVST    WN0049           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUG0TX    P      Name
     C                     END                             *FI
      * CASE: PAR.Access Denied (Y/N) is yes
     C           WN0049    IFEQ 'Y'                        *IF
      * Send message 'User Cant Lock/Unlock Ld'
     C                     MOVEL'USR2468' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL no Stop Entered    RT - Load Detail  * 
     C                     EXSR STRVGN
      * Validate lock request
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0034           Load ID
     C                     MOVEL#1SEL     ZA0035           *SFLSEL
      * Send message 'No Orders Assigned'
     C                     MOVEL'USR1276' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           #RBCST    IFEQ 'B'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0036           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0037           Load ID
      * Send message 'Block Orders on Ld-no UPD'
     C                     MOVEL'USR2441' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'L'
     C           #1PKST    OREQ 'S'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0038           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0039           Load ID
      * Send message 'Load Cant be Locked'
     C                     MOVEL'USR2189' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: PAR.Carrier Code EQ WRK.BLANK
     C           #1BZNA    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1BZNA    ZA0040           Carrier Code
     C                     Z-ADD#1RMNB    ZA0041           Load ID
      * Send message 'Carrier must be entered'
     C                     MOVEL'USR1253' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Truck Size EQ WRK.BLANK
     C           #1RONB    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1RONB    ZA0042           Truck Size
     C                     Z-ADD#1RMNB    ZA0043           Load ID
      * Send message 'Truck size must be enter'
     C                     MOVEL'USR1255' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Shipping Method EQ WRK.BLANK
     C           #1Q2CD    IFEQ WUGSTX                     *IF
      * Setup message data for message
     C                     MOVEL#1Q2CD    ZA0044           Shipping Method
      * Send message 'Shipping Method required'
     C                     MOVEL'USR2197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.USR Orders on Load is yes
     C           WN0046    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0045           Load ID
      * Send message 'Load has orders w/o stop'
     C                     MOVEL'USR2196' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: PAR.Load Acceptance Flag is Load not Accepted
     C           #1RMST    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0046           Load ID
      * Send message 'Load is not accepted'
     C                     MOVEL'USR2514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Hold, Use-by load  RT - OP Order Header  * 
     C                     EXSR SURVGN
      * Error if held/cancelled/in use order(s) on load
      * CASE: PAR.Header Status is Hold
     C           WN0048    IFEQ 'H'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0047           Load ID
     C                     MOVEL#1SEL     ZA0048           *SFLSEL
      * Send message 'Load has Orders on Hold'
     C                     MOVEL'USR1921' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: PAR.Header Status is Cancelled
     C           WN0048    IFEQ 'X'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0049           Load ID
     C                     MOVEL#1SEL     ZA0050           *SFLSEL
      * Send message 'Load has Cancelled Orders'
     C                     MOVEL'USR2236' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: PAR.Order in Use is yes
     C           WN0047    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0051           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0052           Load ID
      * Send message 'Load has Orders in Use'
     C                     MOVEL'USR2280' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Check if Export Order Automation Upload had errors  P001251
      * RTV Ord Requires Revw RT - Order Header TRG  * 
     C                     EXSR SVRVGN
      * ** Cannot lock if Upload had errors                  P001251
      * CASE: LCL.Order Requires Review is Yes
     C           YL0008    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0053           *SFLSEL
     C                     Z-ADD#1RMNB    ZA0054           Load ID
      * Send message 'Order detail needs review'
     C                     MOVEL'USR4464' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9841  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
     C                     EXSR SWRVGN
      * Check minimum and maximum pounds
      * CASE: PAR.Total Weight LT PAR.Minimum pounds
     C           #1RPNB    IFLT WN0045                     *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0055           Load ID
      * Send message 'Load Weight LT Minimum'
     C                     MOVEL'USR1262' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Total Weight GT PAR.Maximum pounds
     C           #1RPNB    IFGT WN0044                     *IF
      * Send message 'Load weight exceeds Truck'
     C                     MOVEL'USR2231' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Locking load pending'
     C                     MOVEL'USR1273' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'N'       P3ECST           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
      * Set confirm if error
      * CASE: PAR.Error Status is yes
     C           P3ECST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     END                             *FI
     C                     END                             *FI
      * screen displays state of last stop on load, so get that field aga
      * do this @end of validate, so that processing will use REAL ship t
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0025           Load ID
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    WUBKC7           Ship To Custome
     C                     MOVELWL0027    WUBRTX    P      Ship To Name
     C                     MOVELWL0028    WUHMNA    P      Ship To Address
     C                     MOVELWL0029    WUHONA    P      Ship To Address
     C                     MOVELWL0030    WUHPNA    P      Ship To Address
     C                     MOVELWL0031    #RLINA    P      Ship To City
     C                     MOVELWL0032    #RV9CD    P      Ship To State C
     C                     MOVELWL0033    WUCKTX    P      Ship To Zip/Pos
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,41
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Process unlock load
      * CASE: RCD.*SFLSEL is *Unlock Load
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      *
     C                     MOVEL*BLANK    WN0052  3        Shipping Line
     C                     MOVEL*BLANK    WN0053 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0054  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0055  1        USR Status (Y/N
      *
      * UPD Unlock Load Update IF
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
     C                     EXSR SXCHRC
      *
     C                     MOVEL*BLANK    WN0199  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0200  1        USR Status (Y/N
     C                     Z-ADD*ZERO     WN0201  90       GAF Customer Nu
     C                     MOVEL*BLANK    WN0202  3        GAF Function
      *
      * EDT Unlock Load        IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0057           Load ID
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0058    WN0199    P      Trans Contol AS
      * RTV System Value Alpha RT - System Values  * 
     C                     EXSR TCRVGN
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0059           PFS Company Num
     C                     MOVEL'LDORDD'  WL0060    P      PFS Interface C
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0061    YL0010    P      PFS AccuSort Ac
     C                     MOVELWL0062    YL0011    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * Notify Accusort if locked load
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0199    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0015  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * DEL AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQ0XFR'              90  DEL AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0016  70       Load ID
     C                     PARM #1AIC3    WQ0017  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0018  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * PFS Unlock Load/Order XF - PFS Load Header  * 
     C                     CALL 'PPNQXFR'              90  PFS Unlock Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0019  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0020  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 09/23/2011 RMC E1607  if load had a whs with edi wso interchan
      *    delete it if Unproc, else change it to "D"elete/and reprocess
      * Exc ChgDel EDI f/UnlckXF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PBAEXFR'              90  Exc ChgDel EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0021  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBAEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CHG Clear Rated Frt    RT - Load Detail  * 
     C                     EXSR TERVGN
      * Clr Program Message Q  US - /UT User Source  * 
      * CLEAR MESSAGES FROM PROGRAM MESSAGE QUEUE.
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
      * RESET FIRST MESSAGE ONLY FLAG.
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
     C                     MOVEL'UNLOCK'  WURVST           Load Change Typ
     C                     MOVEL'SHP'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD#PRVNB    PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVEL#1PKST    PBMNTX    P      Change Log Prio
     C                     MOVEL'U'       PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#RC4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ZZSFM     IFEQ '1'
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ELSE
     C           ##SFPG    DIV  002       ##RRN   50
     C           ##RR      DIV  ##RRN     ##RRC   50
     C                     MVR            ##RRC
     C           ##RRC     IFEQ 0
     C                     Z-ADD##RRN     ##RRC
     C                     ENDIF
     C           ##RRC     DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ENDIF
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C           ZZSFM     IFEQ '0'
     C                     MULT 002       W0ROW0
     C                     ENDIF
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
      * Process lock load
      * CASE: RCD.*SFLSEL is *Lock Load
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * CASE: RCD.Load Acceptance Flag is Load not Accepted
     C           #1RMST    IFEQ 'U'                        *IF
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0056           Load ID
      * Send message 'Load is not accepted'
     C                     MOVEL'USR2514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Recalcs DDD/T based on carrier appt dt/tm          E00495
      *
     C                     Z-ADD*ZERO     WN0506  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0507 112       Flat Amount
     C                     Z-ADD*ZERO     WN0508  50       Total Stops
     C                     Z-ADD*ZERO     WN0509  70       Total Load Mile
     C                     MOVEL*BLANK    WN0510  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0511  2        Ship To State C
     C                     MOVEL*BLANK    WN0512  3        Carrier Broker
     C                     MOVEL*BLANK    WN0513  1        Export Status
     C                     MOVEL*BLANK    WN0514  3        Shipping Line
     C                     MOVEL*BLANK    WN0515 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0516  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0517  60       Deadline Depart
     C                     MOVEL*BLANK    WN0518  1        MG Created Load
     C                     MOVEL*BLANK    WN0519  2        Load U/M
     C                     MOVEL*BLANK    WN0520  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0521 20        Destination Cit
     C                     MOVEL*BLANK    WN0522  2        State Code
     C                     MOVEL*BLANK    WN0523  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0524  3        USR CDE Parm 1
     C                     MOVEL*BLANK    WN0525  3        USR CDE Parm 2
     C                     MOVEL*BLANK    WN0526  3        USR CDE Parm 3
     C                     MOVEL*BLANK    WN0527  3        USR CDE Parm 4
     C                     MOVEL*BLANK    WN0528  3        USR CDE Parm 5
     C                     MOVEL*BLANK    WN0529  3        USR CDE Parm 6
     C                     MOVEL*BLANK    WN0530  3        USR CDE Parm 7
     C                     MOVEL*BLANK    WN0531  3        USR CDE Parm 8
     C                     MOVEL*BLANK    WN0532  3        USR CDE Parm 9
     C                     Z-ADD*ZERO     WN0533 155       Company Number
     C                     Z-ADD*ZERO     WN0534 155       Date 1
     C                     Z-ADD*ZERO     WN0535 155       Order Number 1
     C                     Z-ADD*ZERO     WN0536  40       Requested Deliv
     C                     MOVEL*BLANK    WN0537  7        Return Code Usr
      *
      * UPD Lock Load Update   IF
      * RTV Load Header All,Mg RT - Load Header  * 
     C                     EXSR TKRVGN
      * .** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * Fill in ship from whse deadline depart, if locking load and none
      * CASE: PAR.Ship From Warehouse EQ WRK.BLANK
     C           WN0510    IFEQ WUGSTX                     *IF
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
     C                     EXSR TLRVGN
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           WN0518    IFEQ *BLANK                     *IF
      * ** RTV carrier appt date/time                         E00495
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
     C                     EXSR TQRVGN
      * ** Use carr appt dt/tm, if entered, for DDD/T calcs   E00495
      * CASE: WRK.LD Carrier Appt Date is Entered
     C           WUN7DT    IFGT 0                          *IF
     C                     Z-ADDWUN7DT    WN0516           Deadline Depart
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
     C                     EXSR TRRVGN
     C           WN0536    MULT 100       WN0517           Deadline Depart
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0683  51       Hours Required
     C                     Z-ADD*ZERO     WN0684  50       Miles to next s
     C                     Z-ADD*ZERO     WN0685  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0686  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0687  50       @Days 5
     C                     Z-ADD*ZERO     WN0688  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0689  20       USR Period
     C                     Z-ADD*ZERO     WN0690  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0691  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
     C                     EXSR TTRVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0012    IFEQ 'CT'                       *IF
     C           YL0012    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0068           Load ID
     C                     Z-ADD0         WL0069           Stop/Drop
     C                     Z-ADD0         WL0070           Order Number
     C                     EXSR TURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0071    WN0684           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0684    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0024  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0025  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0068           Load ID
     C                     Z-ADD0         WL0069           Stop/Drop
     C                     Z-ADD0         WL0070           Order Number
     C                     EXSR TURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0071    WN0684           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0684    IFEQ 0                          *IF
     C                     Z-ADD0         WN0516           Scheduled Deliv
     C                     Z-ADD0         WN0517           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WN0683           Hours Required
     C                     Z-ADD0         YL0013           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
     C                     EXSR TVRVGN
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0026  70       Load ID
     C           YL0014    PARM YL0014    WQ0027  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0013    ADD  YL0014    WN0683           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0683    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0683    DIV  24        WN0687           @Days 5
     C           WN0687    MULT 24        WU               USR Hours 5.0
     C           WN0683    SUB  WU        WN0685           USR Hours 5.0
     C           WN0685    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0687    IFGT 0                          *IF
     C                     MULT -1        WN0687           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0516    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0687    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0516
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0516
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0517                     *IF
     C                     SUB  WN0517    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0687           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0516    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0687    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0516
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0516
     C                     END
     C           240000    SUB  WUPINB    WN0517           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0517           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0041           Load ID
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    WUG0TX    P      Load Status
     C                     Z-ADDWL0043    WUTLMI           Total Load Mile
     C                     Z-ADDWL0044    WUK2DT           Override Total
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ---------------------------------------------------------------
      * RTV Last Stop Consign  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0025           Load ID
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    WUBKC7           Ship To Custome
     C                     MOVELWL0027    WUBRTX    P      Ship To Name
     C                     MOVELWL0028    WUHMNA    P      Ship To Address
     C                     MOVELWL0029    WUHONA    P      Ship To Address
     C                     MOVELWL0030    WUHPNA    P      Ship To Address
     C                     MOVELWL0031    WUHNNA    P      Ship To City
     C                     MOVELWL0032    WN0511    P      Ship To State C
     C                     MOVELWL0033    WUCKTX    P      Ship To Zip/Pos
      * ---------------------------------------------------------------
      * OMS132:  Fill in Flat Amount as required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Total Stops is One Stop
      *   |- c2    : PAR.Flat Amount EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0508    IFEQ 1                          *IF
     C           WN0507    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get flat amount for destination city
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
     C                     EXSR TWRVGN
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAWN0521    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       WUXECD           LOAD OUTPUT
     C                     MOVELWUXECD    WN0521           Destination Cit
      * RTV Destination Amount RT - Carrier Destination Rate  * 
     C                     EXSR TXRVGN
     C                     END                             *FI
      * Calc Load U/M           -- RMC 6/16/06
     C                     EXSR UDSUBR                     Calc Load U/M
      * CHG Lock Load Update   CH - Load Header  * 
     C                     EXSR TYCHRC
      * OMS261:  if sched to ship today, print prelim pick at all whses
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0506    IFEQ ##JDT                      *IF
      * RTV All Whses on Load  RT - Load Detail  * 
     C                     EXSR TZRVGN
     C                     Z-ADD#1AIC3    WN0533           Company Number
     C                     Z-ADD#1RMNB    WN0535           Order Number 1
      * PAR.Date 1          PASS  USR = PAR.Scheduled Ship Date
     C                     Z-ADDWN0506    WN0534           Date 1
     C                     MOVEL'S'       WUCYST           USR Select/Omit
     C                     MOVEL'D'       WUSTST           USR Detail or S
     C                     MOVEL'Y'       WUCLST           AUTO PRINT PREL
      * letting all the other parms default in the CL
      * If warehouse exists for load then print.
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0523    IFNE *BLANK                     *IF
      * Pass Pre Pick @LoadLockUP - /UT User Programs  * 
     C                     CALL 'PDBDUPC'              90  Pass Pre Pick @
     C           WN0537    PARM *BLANK    WQ0030  7        Return Code Usr
     C                     PARM 'OMS'     WQ0031  6        Application Cod
     C                     PARM @CN,005   WQ0032 10        Program name US
     C           WUSTST    PARM WUSTST    WQ0033  1        USR Detail or S
     C                     PARM @CN,006   WQ0034 25        PRT Description
     C           WUWRST    PARM WUWRST    WQ0035 10        PRT Printer Dev
     C           WUWSST    PARM WUWSST    WQ0036  4        PRT Hold Output
     C           WUWTST    PARM WUWTST    WQ0037  4        PRT Save Output
     C           WUWUST    PARM WUWUST    WQ0038  1        PRT Night Queue
     C           WUBVVN    PARM WUBVVN    WQ0039 10        PRT Night Queue
     C           WN0533    PARM WN0533    WQ0040 155       Company Number
     C           WN0534    PARM WN0534    WQ0041 155       Date 1
     C           WN0535    PARM WN0535    WQ0042 155       Order Number 1
     C           WUM8NB    PARM WUM8NB    WQ0043 155       System Value Nu
     C           WN0523    PARM WN0523    WQ0044  3        USR Warehouse C
     C           WN0524    PARM WN0524    WQ0045  3        USR CDE Parm 1
     C           WN0525    PARM WN0525    WQ0046  3        USR CDE Parm 2
     C           WN0526    PARM WN0526    WQ0047  3        USR CDE Parm 3
     C           WN0527    PARM WN0527    WQ0048  3        USR CDE Parm 4
     C           WN0528    PARM WN0528    WQ0049  3        USR CDE Parm 5
     C           WN0529    PARM WN0529    WQ0050  3        USR CDE Parm 6
     C           WN0530    PARM WN0530    WQ0051  3        USR CDE Parm 7
     C           WN0531    PARM WN0531    WQ0052  3        USR CDE Parm 8
     C           WN0532    PARM WN0532    WQ0053  3        USR CDE Parm 9
     C           WUCYST    PARM WUCYST    WQ0054  1        USR Select/Omit
     C           WUCLST    PARM WUCLST    WQ0055  1        AUTO PRINT PREL
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     MOVEL*BLANK    WN0829  1        Trans Contol AS
      *
      * EDT Lock Load          IF
      * *** Return Plant Code from first Order Header
      * zzV for Accusort Load  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0057           Load ID
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0058    WN0829    P      Trans Contol AS
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0059           PFS Company Num
     C                     MOVEL'LDORDD'  WL0060    P      PFS Interface C
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0061    YL0015    P      PFS AccuSort Ac
     C                     MOVELWL0062    YL0016    P      PFS Carlisle Ac
      * UPD:  AccuSort
      * CASE: LCL.PFS AccuSort Active is Yes
     C           YL0015    IFEQ 'Y'                        *IF
      * AccuSort:  Create Order Header and Order Detail
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0829    IFEQ 'P'                        *IF
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'L'       WQ0056  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CRT AS Order Hdr/Dtl   XF - AS Order Header  * 
     C                     CALL 'PDQPXFR'              90  CRT AS Order Hd
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0057  70       Load ID
     C                     PARM #1AIC3    WQ0058  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * UPD Lock/Unlock Box ID XF - AS Order Header  * 
     C                     CALL 'PDXFXFR'              90  UPD Lock/Unlock
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'U'       WQ0059  1        Lock/Unlock
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * UPD:  Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0016    IFEQ 'Y'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0060  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** 07/28/2017 RMC R131331 if load had a whs with edi wso intercha
      * Exc Create EDI f/Lock XF - EDI WHS Shipping Ord HDR  * 
     C                     CALL 'PUDNXFR'              90  Exc Create EDI
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0061  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUDNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: JOB.*PROGRAM is PRT Audit Report
     C           ##PGM     IFEQ @CN,007                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clr Program Message Q  US - /UT User Source  * 
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ           ALREADY DEFINED
     C                     PARM '*SAME'   ZAPGRL           ALREADY DEFINED
     C                     MOVEL'Y'       ZAFSMS  1        ALREADY DEFINED
      * Sched to ship today
      * CASE: PAR.Scheduled Ship Date EQ JOB.*Job date
     C           WN0506    IFEQ ##JDT                      *IF
      * CASE: PAR.USR Warehouse Code is Warehouse Code not Blank
     C           WN0523    IFNE *BLANK                     *IF
      * RTV Warehouse Dflt PrtrXF - Warehouse  * 
     C                     CALL 'PDCHXFR'              90  RTV Warehouse D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0523    WQ0062  3        Warehouse Code
     C                     PARM *BLANK    WQ0063 10        Default Printer
     C           YL0017    PARM *BLANK    WQ0064  1        Include in Auto
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RMC DLY029 10/30/07 - sndmsg only if Warehouse is set up for auto
      * CASE: LCL.Include in Auto Pre Pick is Incl in Auto Prelim Pick
     C           YL0017    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVELWN0523    ZA0057           USR Warehouse C
     C                     MOVELWN0524    ZA0058           USR CDE Parm 1
     C                     MOVELWN0525    ZA0059           USR CDE Parm 2
     C                     MOVELWN0526    ZA0060           USR CDE Parm 3
     C                     MOVELWN0527    ZA0061           USR CDE Parm 4
     C                     MOVELWN0528    ZA0062           USR CDE Parm 5
     C                     MOVELWN0529    ZA0063           USR CDE Parm 6
     C                     MOVELWN0530    ZA0064           USR CDE Parm 7
     C                     MOVELWN0531    ZA0065           USR CDE Parm 8
     C                     MOVELWN0532    ZA0066           USR CDE Parm 9
      * Send message 'Preliminary Pick Printing'
     C                     MOVEL'USR2565' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prelim Pick Not Printed'
     C                     MOVEL'USR2715' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and comments
     C                     EXSR UESUBR                     ***** Change Lo
     C                     MOVEL*BLANK    WURVST           Load Change Typ
     C                     MOVEL'LOCK'    WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD#PRVNB    PBRVNB           Stop/Drop
     C                     MOVELWURVST    PBRVST    P      Load Change Typ
     C                     MOVELWUUJST    PBUJST    P      Department Cont
     C                     MOVEL#1PKST    PBMNTX    P      Change Log Prio
     C                     MOVEL'L'       PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#RC4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
      * *Set Cursor: RCD.*SFLSEL  (*Override=*NO)
     C                     Z-ADD##RR      W0RR0
     C           ZZSFM     IFEQ '1'
     C           ##RR      DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ELSE
     C           ##SFPG    DIV  002       ##RRN   50
     C           ##RR      DIV  ##RRN     ##RRC   50
     C                     MVR            ##RRC
     C           ##RRC     IFEQ 0
     C                     Z-ADD##RRN     ##RRC
     C                     ENDIF
     C           ##RRC     DIV  ##SFPG    W0ROW0
     C                     MVR            W0ROW0
     C                     ENDIF
     C           W0ROW0    IFEQ 0
     C           ##SFPG    SUB  1         W0ROW0
     C                     ELSE
     C                     SUB  1         W0ROW0
     C                     END
     C           ZZSFM     IFEQ '0'
     C                     MULT 002       W0ROW0
     C                     ENDIF
     C                     ADD  012       W0ROW0
     C                     Z-ADD002       W0COL0
     C                     MOVEL'0'       W0OVR0           *NO
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN77
     C           #RKOST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           #RHWSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P1I8ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPJ1 fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Pallets
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 1 Unused
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJONTM    #1ONTM           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR0SX    #1R0SX           Load U/M
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJJ8TX    #1J8TX           Car/Veh. Initia
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
      * Clear external version also
     C                     Z-ADD*ZERO     V1P1DT
     C                     MOVEL*BLANK    #RHPNA           Ship To Address
     C                     MOVEL*BLANK    #RHONA           Ship To Address
     C                     MOVEL*BLANK    #RHMNA           Ship To Address
     C                     Z-ADD*ZERO     #RBKC7           Ship To Custome
     C                     Z-ADD*ZERO     #RC4NB           Order Number
     C                     MOVEL*BLANK    #RKOST           Include Todays
     C                     MOVEL*BLANK    #RBCST           Block Order Fla
     C                     MOVEL*BLANK    #RXBCD           Sail Port State
     C                     MOVEL*BLANK    #RHWSX           Change Flag USR
     C                     MOVEL*BLANK    #RHNNA           Ship To City
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RG0NX           Numeric 4,0
     C                     Z-ADD*ZERO     #RG1NX           Total Miles 4,0
     C                     Z-ADD*ZERO     #RG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #RLINA           USR Load/Stop 1
     C                     MOVEL*BLANK    #RV9CD           USR State Code
     C                     MOVEL*BLANK    #RS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #RB8ST           Status - Y or N
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP8RVNB    #PRVNB           Stop/Drop
     C                     MOVEL*BLANK    #CR6CD           USR Carrier Cod
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     Z-ADD*ZERO     #2TLMI           Total Load Mile
     C                     Z-ADD*ZERO     #2RPNB           Total Load Orde
     C                     MOVEL*BLANK    #CHNNA           Ship To City
     C                     MOVEL*BLANK    #2DXTX           Trailer Id
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CADTX           Name
     C                     MOVEL*BLANK    #CCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
     C                     MOVEL*BLANK    #CVQCD           Include/Exclude
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V2EIDT
     C                     Z-ADD*ZERO     #CG0NX           Numeric 4,0
     C                     MOVEL*BLANK    #2PKST           Load Status
     C                     Z-ADD*ZERO     #CG1NX           Total Miles 4,0
     C                     Z-ADD*ZERO     #CG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #CLINA           USR Load/Stop 1
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     MOVEL*BLANK    #CS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     MOVEL*BLANK    #CB8ST           Status - Y or N
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert TPM Planned Ship Date to display format
      * Convert date
     C           1000000   ADD  #1P1DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1P1DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2EIDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * RTV All Whses on Order RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQNA01           Company Number
     C           *LIKE     DEFN WLC4NB    WQNA02           Order Number
      * Define keylist
     C           KPSNA     KLIST
     C                     KFLD           WQNA01           Company Number
     C                     KFLD           WQNA02           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WQNA01           Company Number
     C                     KFLD           WQNA02           Order Number
      * Setup key
     C                     Z-ADDWMAIC3    WQNA01           Company Number
     C                     Z-ADDWMC4NB    WQNA02           Order Number
     C                     Z-ADD0         WLDPNB           Order Sequence
     C                     Z-ADD0         WLUENB           Order Secondary
      * Establish starting position
     C           KPSNA     SETLL@BGWKAE                    *
     C           KRSNA     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Warehouse Code EQ PAR.USR Warehouse Code
     C           WLAJCD    IFEQ WN0523                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 1
     C           WLAJCD    IFEQ WN0524                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 2
     C           WLAJCD    IFEQ WN0525                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 3
     C           WLAJCD    IFEQ WN0526                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 4
     C           WLAJCD    IFEQ WN0527                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 5
     C           WLAJCD    IFEQ WN0528                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 6
     C           WLAJCD    IFEQ WN0529                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 7
     C           WLAJCD    IFEQ WN0530                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 8
     C           WLAJCD    IFEQ WN0531                     *IF
     C                     ELSE
      * CASE: DB1.Warehouse Code EQ PAR.USR CDE Parm 9
     C           WLAJCD    IFEQ WN0532                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * current warehouse not already being used
      * Fill in first blank warehouse
      * CASE: PAR.USR Warehouse Code EQ WRK.BLANK
     C           WN0523    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0523           USR Warehouse C
     C                     ELSE
      * CASE: PAR.USR CDE Parm 1 EQ WRK.BLANK
     C           WN0524    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0524           USR CDE Parm 1
     C                     ELSE
      * CASE: PAR.USR CDE Parm 2 EQ WRK.BLANK
     C           WN0525    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0525           USR CDE Parm 2
     C                     ELSE
      * CASE: PAR.USR CDE Parm 3 EQ WRK.BLANK
     C           WN0526    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0526           USR CDE Parm 3
     C                     ELSE
      * CASE: PAR.USR CDE Parm 4 EQ WRK.BLANK
     C           WN0527    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0527           USR CDE Parm 4
     C                     ELSE
      * CASE: PAR.USR CDE Parm 5 EQ WRK.BLANK
     C           WN0528    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0528           USR CDE Parm 5
     C                     ELSE
      * CASE: PAR.USR CDE Parm 6 EQ WRK.BLANK
     C           WN0529    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0529           USR CDE Parm 6
     C                     ELSE
      * CASE: PAR.USR CDE Parm 7 EQ WRK.BLANK
     C           WN0530    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0530           USR CDE Parm 7
     C                     ELSE
      * CASE: PAR.USR CDE Parm 8 EQ WRK.BLANK
     C           WN0531    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0531           USR CDE Parm 8
     C                     ELSE
      * CASE: PAR.USR CDE Parm 9 EQ WRK.BLANK
     C           WN0532    IFEQ WUGSTX                     *IF
     C                     MOVELWLAJCD    WN0532           USR CDE Parm 9
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNA     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNB01           Application Cod
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQNB01           Application Cod
     C                     MOVEL'OMS'     WQNB01           Application Cod
      * Establish starting position
     C           KRSNB     SETLL@DNRESF                    *
     C           KRSNB     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR NCRVGN
     C                     END                             *FI
     C           KRSNB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQNC01           Application Cod
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQNC01           Application Cod
      * Establish starting position
     C           KRSNC     SETLL@DNRESF                    *
     C           KRSNC     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSNC     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSND     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI8ST    P1I8ST           Allow Multi War
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CCPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #CO6NA           Warehouse Descr
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    #CO6NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSC     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0020           User Code Model
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    WN0020           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           L1AJVN           User Profile Na
     C                     KFLD           L1AJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0003    L1AJVN           User Profile Na
     C                     MOVELWL0004    L1AJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@L1RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2626' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           UWA Inventory T
     C                     MOVEL*BLANK    WL0006           UWA Lot Loc Tra
     C                     MOVEL*BLANK    WL0007           UWA Shipping Tr
     C                     MOVEL*BLANK    WL0008           UWA Cross Appli
     C                     MOVEL*BLANK    WL0009           UWA Unused Stat
     C                     MOVEL*BLANK    WL0010           UWA Unused Stat
     C                     MOVEL*BLANK    WL0011           UWA Unused Sts
     C                     MOVEL*BLANK    WL0012           UWA Unused Sts
     C                     MOVEL*BLANK    WL0013           UWA Unused Sts
     C                     MOVEL*BLANK    WL0014           UWA Unused Sts
     C                     MOVEL*BLANK    WL0015           UWA Unused Sts
     C                     MOVEL*BLANK    WL0016           UWA Unused Sts
     C                     MOVEL*BLANK    WL0017           UWA Unused Sts
     C                     MOVEL*BLANK    WL0018           UWA Unused Sts
     C                     MOVEL*BLANK    WL0019           UWA Unused Sts
     C                     MOVEL*BLANK    WL0020           UWA Unused Sts
     C                     MOVEL*BLANK    WL0021           UWA Unused Sts
     C                     MOVEL*BLANK    WL0022           UWA Unused Sts
     C                     MOVEL*BLANK    WL0023           UWA Unused Sts
     C                     MOVEL*BLANK    WL0024           Record Found US
     C                     MOVEL'N'       WL0024           Record Found US
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELL1UWAS    WL0005           UWA Inventory T
     C                     MOVELL1EPSX    WL0006           UWA Lot Loc Tra
     C                     MOVELL1EQSX    WL0007           UWA Shipping Tr
     C                     MOVELL1ERSX    WL0008           UWA Cross Appli
     C                     MOVELL1UWAT    WL0009           UWA Unused Stat
     C                     MOVELL1EKSX    WL0010           UWA Unused Stat
     C                     MOVELL1ECSX    WL0011           UWA Unused Sts
     C                     MOVELL1EDSX    WL0012           UWA Unused Sts
     C                     MOVELL1EESX    WL0013           UWA Unused Sts
     C                     MOVELL1EFSX    WL0014           UWA Unused Sts
     C                     MOVELL1EGSX    WL0015           UWA Unused Sts
     C                     MOVELL1EHSX    WL0016           UWA Unused Sts
     C                     MOVELL1EISX    WL0017           UWA Unused Sts
     C                     MOVELL1EJSX    WL0018           UWA Unused Sts
     C                     MOVELL1UWAU    WL0019           UWA Unused Sts
     C                     MOVELL1ELSX    WL0020           UWA Unused Sts
     C                     MOVELL1EMSX    WL0021           UWA Unused Sts
     C                     MOVELL1ENSX    WL0022           UWA Unused Sts
     C                     MOVELL1EOSX    WL0023           UWA Unused Sts
     C                     MOVEL'Y'       WL0024           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Sel Order by Whs      RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0038  1        Whs Ord Found S
     C                     Z-ADD*ZERO     WN0039  50       Count USR
     C                     Z-ADD*ZERO     WN0040  50       Count 2 USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WUD9SX           Whs Ord Ship St
     C                     Z-ADD0         WN0039           Count USR
     C                     Z-ADD0         WN0040           Count 2 USR
     C                     MOVEL'N'       WUFBSX           Plant Controlle
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSE02           Load ID
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSE02           Load ID
      * Establish starting position
     C           KRSSE     SETLL@BFCPD9                    *
     C           KRSSE     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Sel Order by Whs      RT - Order Detail  * 
     C                     EXSR SFRVGN
      * CASE: DB1.Trans Contol AS400/Plant is Plant
     C           BEXUST    IFEQ 'P'                        *IF
     C                     MOVEL'Y'       WUFBSX           Plant Controlle
     C                     END                             *FI
      * CASE: PAR.Whs Ord Found STS is yes
     C           WN0038    IFEQ 'Y'                        *IF
      * CASE: DB1.Header Status is Confirmed & Complete
     C           BEGWST    IFEQ 'C'                        *IF
     C           BEGWST    OREQ 'R'
     C                     ADD  1         WN0039           Count USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WN0040           Count 2 USR
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@BFCPD9                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Count USR is GT 0
     C           WN0039    IFGT 0                          *IF
      * CASE: PAR.Count 2 USR is Greater than zero
     C           WN0040    IFGT 0                          *IF
     C                     MOVEL'P'       WUD9SX           Whs Ord Ship St
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'A'       WUD9SX           Whs Ord Ship St
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Sel Order by Whs      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0038           Whs Ord Found S
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSF01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSF02           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSF01           Company Number
     C                     Z-ADDBEC4NB    WQSF02           Order Number
      * Establish starting position
     C           KRSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * CASE: PAR.Warehouse Code EQ DB1.Warehouse Code
     C           #CCPCD    IFEQ OMAJCD                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     MOVEL'Y'       WN0038           Whs Ord Found S
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Last Stop Consign  RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSG02           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Load ID
      * Setup key
     C                     Z-ADDWL0025    WQSG02           Load ID
      * Establish starting position
     C           KRSSG     SETLL@FLCPE8                    *
     C           KRSSG     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV for B.O.L. Print   RT - PD Order Header  * 
     C                     EXSR SHRVGN
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV for B.O.L. Print   RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WAAIC3           Company Number
     C                     Z-ADDFLC4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWABKC7    WL0026           Ship To Custome
     C                     MOVELWABRTX    WL0027           Ship To Name
     C                     MOVELWAHMNA    WL0028           Ship To Address
     C                     MOVELWAHONA    WL0029           Ship To Address
     C                     MOVELWAHPNA    WL0030           Ship To Address
     C                     MOVELWAHNNA    WL0031           Ship To City
     C                     MOVELWADBCD    WL0032           Ship To State C
     C                     MOVELWACKTX    WL0033           Ship To Zip/Pos
     C                     MOVELWABCNA    WUG0TX           Customer Purcha
     C                     MOVELWAB6NA    WUG0TX           Special Instruc
     C                     MOVELWABYNA    WUG0TX           Special Instruc
     C                     Z-ADDWAEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWAAFTM    WUNFNN           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV GrsWgt w/PltTr Ld RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         P3CDWG           USR Weight Accu
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0034           Load ID
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0035    YL0001           Pallets Loaded
     C                     Z-ADDWL0036    YL0002           Avg Pallet Tare
     C                     Z-ADDWL0037    YL0003           Tot Pallet Tare
     C                     END                             *FI
      * ***** Change log and comments
     C                     EXSR UASUBR                     ***** Change lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSI01           Load ID
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Load ID
     C                     KFLD           WBRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSI01           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSI     SETLL@FLCPBW                    *
     C           KRSSI     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 01/18/10 PKD E000261 SEND in LCL.Avg Pallet Tare
      * RTV Gross Wgt/Qty     XF - Order Detail  * 
     C                     CALL 'PQPQXFR'              90  RTV Gross Wgt/Q
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0001  30       Company Number
     C                     PARM WBC4NB    WQ0002  70       Order Number
     C                     PARM 0         WQ0003  30       Order Sequence
     C                     PARM 0         WQ0004  30       Order Secondary
     C           P3CDWG    PARM P3CDWG    WQ0005 112       USR Weight Accu
     C           YL0004    PARM YL0004    WQ0006 112       Order Quantity
     C                     PARM YL0002    WQ0007  92       Avg Pallet Tare
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PQPQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           KRSSI     READE@FLCPBW                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Load Status is Shipped or Invoiced
     C           #1PKST    IFEQ 'I'                        *IF
     C           #1PKST    OREQ 'S'
      * RTV Pallet/Tare        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBRMNB    WL0034           Load ID
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0035    YL0001           Pallets Loaded
     C                     Z-ADDWL0036    YL0002           Avg Pallet Tare
     C                     Z-ADDWL0037    YL0003           Tot Pallet Tare
     C                     ADD  YL0003    P3CDWG           USR Weight Accu
     C                     END                             *FI
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Pallet/Tare        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0034    WCRMNB           Load ID
      * Establish starting position
     C           KRSSJ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCKNNX    WL0035           Pallets Loaded
     C                     Z-ADDWCICWG    WL0036           Avg Pallet Tare
     C                     Z-ADDWCIDWG    WL0037           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Verify Trffc Cmnts RT - PD Traffic Comments  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN KERMNB    WQSK01           Load ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSK01           Load ID
      * Establish starting position
     C           KRSSK     SETLL@KECPGI                    *
     C           KRSSK     READE@KECPGI                  90*
      * Data record not found
     C   90                MOVEL'USR2199' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@KECPGI                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0039           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WL0040           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSL02           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
      * Setup key
     C                     Z-ADDWL0038    WQSL02           Load ID
      * Establish starting position
     C           KRSSL     SETLL@BFCPD9                    *
     C           KRSSL     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0039           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           BEBCST    IFEQ 'B'                        *IF
     C                     MOVELBEBCST    WL0040           Block Order Fla
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSL     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV WW Screen Fields   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSM     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    #1AODT           Scheduled Ship
     C                     MOVELWCPKST    #1PKST           Load Status
     C                     Z-ADDWCRPNB    #1RPNB           Total Load Orde
     C                     Z-ADDWCFLAM    #1FLAM           Flat Amount
     C                     MOVELWCXQST    #1XQST           Allocate Pounds
     C                     MOVELWCDXTX    #1DXTX           Trailer Id
     C                     MOVELWCBZNA    #1BZNA           Carrier Code
     C                     MOVELWCRONB    #1RONB           Truck Size
     C                     MOVELWCVDST    #1VDST           Load Type
     C                     Z-ADDWCT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDWCTLMI    WUTLMI           Total Load Mile
     C                     MOVELWCQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWCVPCD    #1VPCD           Ship From Wareh
     C                     MOVELWCDBCD    #1DBCD           Ship To State C
     C                     MOVELWCRMST    #1RMST           Load Acceptance
     C                     Z-ADDWCIDWG    #1IDWG           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0041    WCRMNB           Load ID
      * Establish starting position
     C           KRSSN     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCPKST    WL0042           Load Status
     C                     Z-ADDWCTLMI    WL0043           Total Load Mile
     C                     Z-ADDWCK2DT    WL0044           Override Total
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0045    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSO     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0046           Allow Multi-Com
     C                     MOVELDRMPNA    WL0047           Default Printer
     C                     MOVELDRBCCD    WL0048           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0049           Company Number
     C                     MOVELDRBUVN    WL0050           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0051    DTAJVN           User Profile Na
     C                     MOVELWL0052    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSP     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0053           Company Number
     C                     MOVELDTAJCD    WL0054           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDBWC3    WQSQ01           Shipping Compan
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Shipping Compan
      * Setup key
     C                     Z-ADDWL0056    WQSQ01           Shipping Compan
      * Establish starting position
     C           KRSSQ     SETLL@ADREWA                    *
     C           KRSSQ     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0055           Warehouse Code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WDVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WDAOCD    IFNE *BLANK                     *IF
     C                     MOVELWDAOCD    WL0055           Warehouse Code
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Unlock Load Authr RT - Entry Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           C0AJVN           User Profile Na
     C                     KFLD           C0DNCD           Application Cod
     C                     KFLD           C0AIC3           Company Number
      * Setup key
     C                     MOVEL##USR     C0AJVN           User Profile Na
     C                     MOVE *BLANK    C0DNCD           Application Cod
     C                     MOVEL'O/P'     C0DNCD           Application Cod
     C                     Z-ADD#1AIC3    C0AIC3           Company Number
      * Establish starting position
     C           KRSSR     CHAIN@C0REO4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0527' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUHTST           Unlock Load Aut
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELC0HTST    WUHTST           Unlock Load Aut
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * PFS Val Order Picked  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKZGNX    WQSS01           PFS Load ID
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           PFS Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSS01           PFS Load ID
      * Establish starting position
     C           KRSSS     SETLL@BKCPEK                    *
     C           KRSSS     READE@BKCPEK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3504' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUZMST           Pick Status USR
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUZMST           Pick Status USR
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * VAL no Stop Entered    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0046           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQST02           Load ID
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQST02           Load ID
      * Establish starting position
     C           KRSST     SETLL@FLCPEB                    *
     C           KRSST     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop is EQ Zero
     C           WERVNB    IFEQ 0                          *IF
     C                     MOVEL'Y'       WN0046           Status - Y or N
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C           KRSST     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Hold, Use-by load  RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0047           Order in Use
     C                     MOVEL*BLANK    WN0048           Header Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSU02           Load ID
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSU02           Load ID
      * Establish starting position
     C           KRSSU     SETLL@BFCPD9                    *
     C           KRSSU     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If find 1 order on load which is held/cancelled, set par flag and
      * CASE: DB1.Header Status is Hold
     C           BEGWST    IFEQ 'H'                        *IF
     C                     MOVELBEGWST    WN0048           Header Status
     C                     GOTO SUEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Header Status is Cancelled
     C           BEGWST    IFEQ 'X'                        *IF
     C                     MOVELBEGWST    WN0048           Header Status
     C                     GOTO SUEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.Order in Use is yes
     C           BEGJST    IFEQ 'Y'                        *IF
     C                     MOVELBEGJST    WN0047           Order in Use
     C                     GOTO SUEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSU     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Ord Requires Revw RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSV02           Load ID
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSV02           Load ID
      * Establish starting position
     C           KRSSV     SETLL@BFCPD9                    *
     C           KRSSV     READE@BFCPD9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           Order Requires
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEFUSX    YL0008           Order Requires
     C           KRSSV     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Min & Max Pounds  RT - OM Truck Size  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           FKRONB           Truck Size
      * Setup key
     C                     MOVEL#1RONB    FKRONB           Truck Size
      * Establish starting position
     C           KRSSW     CHAIN@FKREBT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0044           Maximum pounds
     C                     Z-ADD*ZERO     WN0045           Minimum pounds
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFKRSNB    WN0044           Maximum pounds
     C                     Z-ADDFKTANB    WN0045           Minimum pounds
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * CHG Ld Sts,Rated Frts  CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0056  30       Company Number
     C                     Z-ADD*ZERO     WN0057  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0058  1        LTL Flag
     C                     Z-ADD*ZERO     WN0059  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0060 15        Seal 1
     C                     MOVEL*BLANK    WN0061 15        Seal 2
     C                     MOVEL*BLANK    WN0062 15        Seal 3
     C                     MOVEL*BLANK    WN0063 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0064 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0065  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0066 112       Flat Amount
     C                     MOVEL*BLANK    WN0067  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0068  50       Total Stops
     C                     MOVEL*BLANK    WN0069 20        Trailer Id
     C                     MOVEL*BLANK    WN0070  3        Transloader Car
     C                     Z-ADD*ZERO     WN0071  40       BOL Time
     C                     MOVEL*BLANK    WN0072  3        Carrier Code
     C                     MOVEL*BLANK    WN0073  7        Truck Size
     C                     Z-ADD*ZERO     WN0074  70       Ld Hdr/Ld Dtl U
     C                     MOVEL*BLANK    WN0075  1        Ship Status
     C                     MOVEL*BLANK    WN0076  1        Load Type
     C                     Z-ADD*ZERO     WN0077  50       Number Pallets
     C                     Z-ADD*ZERO     WN0078  50       Number Pallets
     C                     Z-ADD*ZERO     WN0079 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0080  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0081  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0082  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0083 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0084 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0085  70       Actual Departur
     C                     Z-ADD*ZERO     WN0086  40       Departure Time
     C                     Z-ADD*ZERO     WN0087  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0088  52       Product Tempera
     C                     Z-ADD*ZERO     WN0089  50       Number Pallets
     C                     MOVEL*BLANK    WN0090 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0091  70       Total Load Mile
     C                     MOVEL*BLANK    WN0092 12        Recorder ID
     C                     MOVEL*BLANK    WN0093  2        Shipping Method
     C                     MOVEL*BLANK    WN0094  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0095  2        Ship To State C
     C                     Z-ADD*ZERO     WN0096  70       Gross Weight
     C                     MOVEL*BLANK    WN0097  3        Carrier Broker
     C                     MOVEL*BLANK    WN0098  1        Export Status
     C                     Z-ADD*ZERO     WN0099  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0100  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0101  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0102  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0103  70       Spotted Date
     C                     Z-ADD*ZERO     WN0104  60       Spotted Time
     C                     Z-ADD*ZERO     WN0105  70       Load Finished D
     C                     Z-ADD*ZERO     WN0106  60       Load Finished T
     C                     Z-ADD*ZERO     WN0107  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0108  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0109  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0110  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0111  70       Truck Departure
     C                     Z-ADD*ZERO     WN0112  60       Truck Departure
     C                     Z-ADD*ZERO     WN0113  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0114  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0115  3        Shipping Line
     C                     MOVEL*BLANK    WN0116 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0117 30        Vessel Name
     C                     Z-ADD*ZERO     WN0118  50       Voyage
     C                     Z-ADD*ZERO     WN0119  70       Sail Date
     C                     MOVEL*BLANK    WN0120 12        Booking Number
     C                     MOVEL*BLANK    WN0121 20        Discharge Port
     C                     Z-ADD*ZERO     WN0122  70       Arrival Date
     C                     MOVEL*BLANK    WN0123 12        Container Numbe
     C                     Z-ADD*ZERO     WN0124  70       Date In
     C                     Z-ADD*ZERO     WN0125  60       Time In
     C                     Z-ADD*ZERO     WN0126  70       Date Out
     C                     Z-ADD*ZERO     WN0127  60       Time Out
     C                     Z-ADD*ZERO     WN0128 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0129  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0130  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0131  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0132  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0133  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0134  70       Requested Deliv
     C                     MOVEL*BLANK    WN0135  1        Load Acceptance
     C                     MOVEL*BLANK    WN0136  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0137  70       On Yard Date
     C                     Z-ADD*ZERO     WN0138  60       On Yard Time
     C                     Z-ADD*ZERO     WN0139  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0140  60       Deadline Depart
     C                     MOVEL*BLANK    WN0141  1        Load Held Over
     C                     MOVEL*BLANK    WN0142  1        Load Held Over
     C                     MOVEL*BLANK    WN0143 15        Load Held Over
     C                     MOVEL*BLANK    WN0144 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0145 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0146  70       Express Mail Da
     C                     MOVEL*BLANK    WN0147  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0148  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0149  70       Product Complet
     C                     Z-ADD*ZERO     WN0150  60       Product Complet
     C                     Z-ADD*ZERO     WN0151  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0152  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0153  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0154  1        Load Confirmed
     C                     MOVEL*BLANK    WN0155 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0156  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0157  60       Load Door 1
     C                     Z-ADD*ZERO     WN0158  70       Override Total
     C                     Z-ADD*ZERO     WN0159  60       Load Door 2
     C                     MOVEL*BLANK    WN0160  1        Partial Load
     C                     MOVEL*BLANK    WN0161  1        Load Confirmati
     C                     MOVEL*BLANK    WN0162  1        Export Load USD
     C                     MOVEL*BLANK    WN0163  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0164 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0165 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0166 15        Late Billing Em
     C                     MOVEL*BLANK    WN0167 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0168 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0169  1        Multi Company L
     C                     MOVEL*BLANK    WN0170  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0171  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0172  1        LH Power Only L
     C                     MOVEL*BLANK    WN0173  1        MG Created Load
     C                     MOVEL*BLANK    WN0174  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0175  2        Load U/M
     C                     MOVEL*BLANK    WN0176  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0177  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0178  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0179  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0180  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0181  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0182  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0183  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0184  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0185  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0186  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0187  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0188  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0189  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0190  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0191  60       LH Unused Time
     C                     MOVEL*BLANK    WN0192  1        EDI Status 1
     C                     MOVEL*BLANK    WN0193  1        EDI Status 2
     C                     MOVEL*BLANK    WN0194  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0195  60       Job Time
     C                     MOVEL*BLANK    WN0196 10        User Id
     C                     MOVEL*BLANK    WN0197 10        Job Name
     C                     Z-ADD*ZERO     WN0198  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WFRMNB           Load ID
      *
     C           KLCHSX    KLIST
     C                     KFLD           WFRMNB           Load ID
     C           KLCHSX    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WFPKST    P      Load Status
     C                     Z-ADD0         WFR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * zzV for Accusort Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSY01           Load ID
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Load ID
      * Setup key
     C                     Z-ADDWL0057    WQSY01           Load ID
      * Establish starting position
     C           KRSSY     SETLL@FLCPBW                    *
     C           KRSSY     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Header      TRG  * 
     C                     EXSR SZRVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WL0058           Trans Contol AS
     C                     GOTO SYEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSY     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WAAIC3           Company Number
     C                     Z-ADDWBC4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSZ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Trans Control      RT - PD Order Detail  * 
     C                     EXSR TARVGN
      * CASE: WRK.Trans Contol AS400/Plant is Plant
     C           WUXUST    IFEQ 'P'                        *IF
     C                     MOVELWUXUST    WUXUST           Trans Contol AS
     C                     GOTO SZEXIT                     *QUIT
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Trans Control      RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTA01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTA02           Order Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WQTA02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQTA01           Company Number
     C                     Z-ADDWAC4NB    WQTA02           Order Number
      * Establish starting position
     C           KRSTA     SETLL@BGWKL1                    *
     C           KRSTA     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * Rtv Desc/Trans Control RT - Warehouse  * 
     C                     EXSR TBRVGN
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTA     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Desc/Trans Control RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSTB     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUF8NA           Warehouse Descr
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGF8NA    WUF8NA           Warehouse Descr
     C                     MOVELWGXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV System Value Alpha RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,004   DPDOCD           System Value Co
      * Establish starting position
     C           KRSTC     CHAIN@DPRETD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0759' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0009           System Value Al
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDPBXTX    YL0009           System Value Al
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           BUY1NX           PFS Company Num
     C                     KFLD           BUGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0059    BUY1NX           PFS Company Num
     C                     MOVELWL0060    BUGYAA           PFS Interface C
      * Establish starting position
     C           KRSTD     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0061           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0062           PFS Carlisle Ac
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBUWSSX    WL0061           PFS AccuSort Ac
     C                     MOVELBUWUSX    WL0062           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQTE02           Load ID
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTE02           Load ID
      * Establish starting position
     C           KRSTE     SETLL@FLCPEB                    *
     C           KRSTE     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Recovery Freight   CH - Load Detail  * 
     C                     EXSR TFCHRC
      * CHG Clear Rated Frt    RT - PD Order Header  * 
     C                     EXSR TGRVGN
     C           KRSTE     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0203  50       Stop/Drop
     C                     MOVEL*BLANK    WN0204 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0205  72       Freight Charge
     C                     Z-ADD*ZERO     WN0206  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0207  30       Company Number
     C                     Z-ADD*ZERO     WN0208  70       Order Number
     C                     MOVEL*BLANK    WN0209  1        Ship Status
     C                     Z-ADD*ZERO     WN0210  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0211  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0212  70       Appointment Con
     C                     Z-ADD*ZERO     WN0213  60       Appointment Con
     C                     MOVEL*BLANK    WN0214 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0215 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0216  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0217  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0218  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0219  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0220  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0221  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0222  70       On Yard Date
     C                     Z-ADD*ZERO     WN0223  60       On Yard Time
     C                     Z-ADD*ZERO     WN0224  70       MPC Number
     C                     MOVEL*BLANK    WN0225  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0226  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0227 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0228 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0229 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0230 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0231 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0232  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0233  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0234  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0235  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0236  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0237  60       LD Unused Time
     C                     MOVEL*BLANK    WN0238  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0239  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0240  2        HPB Transload S
     C                     MOVEL*BLANK    WN0241 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0242 25        LD Unused Txt 2
     C                     MOVEL*BLANK    WN0243 25        LD Unused Txt 3
     C                     MOVEL*BLANK    WN0244  1        EDI Status 1
     C                     MOVEL*BLANK    WN0245  1        EDI Status 2
     C                     MOVEL*BLANK    WN0246  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0247  60       Job Time
     C                     MOVEL*BLANK    WN0248 10        User Id
     C                     MOVEL*BLANK    WN0249 10        Job Name
     C                     Z-ADD*ZERO     WN0250  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWERMNB    WHRMNB           Load ID
     C                     Z-ADDWERUNB    WHRUNB           Stop/Drop Seque
      *
     C           KLCHTF    KLIST
     C                     KFLD           WHRMNB           Load ID
     C                     KFLD           WHRUNB           Stop/Drop Seque
     C           KLCHTF    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YBRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWERWNB    WHRWNB           Miles to next s
     C                     Z-ADD0         WHT0NB           Freight Misc. C
     C                     Z-ADD0         WHT1NB           Freight Stop Ch
     C                     Z-ADD0         WHR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WHAATM' defaulted for 'Job Time'.
      * Field '(DB1) WHAYNA' defaulted for 'User Id'.
      * Field '(DB1) WHA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WHAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * CHG Clear Rated Frt    RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQTG02           Load ID
     C           *LIKE     DEFN WIC4NB    WQTG03           Order Number
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG02           Load ID
     C                     KFLD           WQTG03           Order Number
      * Setup key
     C                     Z-ADDWERMNB    WQTG02           Load ID
     C                     Z-ADDWEC4NB    WQTG03           Order Number
      * Establish starting position
     C           KRSTG     SETLL@BFCPNQ                    *
     C           KRSTG     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Rated Freight      CH - PD Order Header  * 
     C                     EXSR THCHRC
      * 05/13/04 slm Multi-Company - Order Header lv remove co must use d
      *                               was using the par replace with db1
      * UPD Rated Freight      RT - Order Detail  * 
     C                     EXSR TIRVGN
     C           KRSTG     READE@BFCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0251  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0252  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0253  70       Ship To Custome
     C                     MOVEL*BLANK    WN0254 30        Ship To Name
     C                     MOVEL*BLANK    WN0255 30        Ship To Address
     C                     MOVEL*BLANK    WN0256 30        Ship To Address
     C                     MOVEL*BLANK    WN0257 30        Ship To Address
     C                     MOVEL*BLANK    WN0258 20        Ship To City
     C                     MOVEL*BLANK    WN0259  2        Ship To State C
     C                     MOVEL*BLANK    WN0260 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0261  70       Bill to Custome
     C                     MOVEL*BLANK    WN0262 30        Bill to Name
     C                     MOVEL*BLANK    WN0263 30        Bill to Address
     C                     MOVEL*BLANK    WN0264 30        Bill to Address
     C                     MOVEL*BLANK    WN0265 30        Bill to Address
     C                     MOVEL*BLANK    WN0266 20        Bill to City
     C                     MOVEL*BLANK    WN0267  2        Bill to State C
     C                     MOVEL*BLANK    WN0268 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0269 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0270  70       Order Date
     C                     Z-ADD*ZERO     WN0271  70       Requested Ship
     C                     Z-ADD*ZERO     WN0272  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0273  70       Cancel Date
     C                     MOVEL*BLANK    WN0274  2        Terms Code
     C                     MOVEL*BLANK    WN0275 40        Special Instruc
     C                     MOVEL*BLANK    WN0276 40        Special Instruc
     C                     MOVEL*BLANK    WN0277  3        Carrier Code
     C                     MOVEL*BLANK    WN0278  1        Comment Print A
     C                     MOVEL*BLANK    WN0279  1        Comment Print I
     C                     MOVEL*BLANK    WN0280  1        Comment Print P
     C                     MOVEL*BLANK    WN0281  1        Comment Print S
     C                     MOVEL*BLANK    WN0282  3        Reason Code
     C                     MOVEL*BLANK    WN0283  1        Order in Use
     C                     MOVEL*BLANK    WN0284  1        Header Status
     C                     MOVEL*BLANK    WN0285  1        Header Status L
     C                     MOVEL*BLANK    WN0286  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0287  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0288 10        User Original E
     C                     Z-ADD*ZERO     WN0289  70       Date of Origina
     C                     Z-ADD*ZERO     WN0290 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0291 112       Order Weight To
     C                     MOVEL*BLANK    WN0292  1        Credit Hold
     C                     MOVEL*BLANK    WN0293  1        Production Hold
     C                     MOVEL*BLANK    WN0294  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0295  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0296  40       Requested Deliv
     C                     MOVEL*BLANK    WN0297  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0298 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0299  70       Load ID
     C                     Z-ADD*ZERO     WN0300  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0301  1        LTL Flag
     C                     MOVEL*BLANK    WN0302  1        Price Audit
     C                     MOVEL*BLANK    WN0303  1        Price Status
     C                     MOVEL*BLANK    WN0304  2        Shipping Method
     C                     MOVEL*BLANK    WN0305  1        Export Status
     C                     MOVEL*BLANK    WN0306  1        Palletize
     C                     MOVEL*BLANK    WN0307  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0308  1        Slip Sheet
     C                     MOVEL*BLANK    WN0309  1        Age Code
     C                     Z-ADD*ZERO     WN0310  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0311  1        Load Type
     C                     Z-ADD*ZERO     WN0312  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0313  1        Load Plan Order
     C                     MOVEL*BLANK    WN0314  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0315  70       Resell Referenc
     C                     MOVEL*BLANK    WN0316 30        Special Comment
     C                     MOVEL*BLANK    WN0317 30        Special Comment
     C                     MOVEL*BLANK    WN0318  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0319  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0320  2        Manager Level C
     C                     MOVEL*BLANK    WN0321  3        VP Level Code
     C                     Z-ADD*ZERO     WN0322  70       Attach to Order
     C                     MOVEL*BLANK    WN0323  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0324  70       Invoice Number
     C                     MOVEL*BLANK    WN0325  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0326  70       Invoice Date
     C                     MOVEL*BLANK    WN0327  2        Event Code
     C                     MOVEL*BLANK    WN0328  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0329  1        Modified Flag
     C                     Z-ADD*ZERO     WN0330 112       A/R order Value
     C                     MOVEL*BLANK    WN0331  1        Billing Activit
     C                     MOVEL*BLANK    WN0332  1        Block Order Fla
     C                     MOVEL*BLANK    WN0333  1        Order Certifica
     C                     Z-ADD*ZERO     WN0334 112       Invoice Order V
     C                     MOVEL*BLANK    WN0335  1        Process Sts for
     C                     MOVEL*BLANK    WN0336  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0337  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0338  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0339  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0340  1        Email Cust On O
     C                     MOVEL*BLANK    WN0341  1        Order Emailed
     C                     MOVEL*BLANK    WN0342  1        Export Docs Go
     C                     MOVEL*BLANK    WN0343  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0344  1        Broker Order St
     C                     MOVEL*BLANK    WN0345  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0346  2        Order Requires
     C                     MOVEL*BLANK    WN0347  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0348  2        Export USDA App
     C                     MOVEL*BLANK    WN0349  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0350  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0351  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0352  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0353  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0354  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0355  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0356  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0357  60       Time of Origina
     C                     Z-ADD*ZERO     WN0358  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0359  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0360  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0361 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0362 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0363 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0364 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0365 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0366  70       Claim Number
     C                     MOVEL*BLANK    WN0367  1        EDI Status 1
     C                     MOVEL*BLANK    WN0368  1        EDI Status 2
     C                     MOVEL*BLANK    WN0369  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0370  60       Job Time
     C                     MOVEL*BLANK    WN0371 10        User Id
     C                     MOVEL*BLANK    WN0372 10        Job Name
     C                     Z-ADD*ZERO     WN0373  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     Z-ADDWIC4NB    WJC4NB           Order Number
      *
     C           KLCHTH    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHTH    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD0         WJR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWJAIC3    PAAIC3           Company Number
     C                     Z-ADDWJC4NB    PAC4NB           Order Number
     C                     MOVELWJJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWJANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWJBKC7    PABKC7           Ship To Custome
     C                     MOVELWJBRTX    PABRTX    P      Ship To Name
     C                     MOVELWJHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWJHONA    PAHONA    P      Ship To Address
     C                     MOVELWJHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWJHNNA    PAHNNA    P      Ship To City
     C                     MOVELWJDBCD    PADBCD    P      Ship To State C
     C                     MOVELWJCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWJB0C7    PAB0C7           Bill to Custome
     C                     MOVELWJAETX    PAAETX    P      Bill to Name
     C                     MOVELWJB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWJB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWJB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWJB2NA    PAB2NA    P      Bill to City
     C                     MOVELWJBHCD    PABHCD    P      Bill to State C
     C                     MOVELWJC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWJBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWJA0DT    PAA0DT           Order Date
     C                     Z-ADDWJA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWJGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWJACDT    PAACDT           Cancel Date
     C                     MOVELWJAQCD    PAAQCD    P      Terms Code
     C                     MOVELWJB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWJBYNA    PABYNA    P      Special Instruc
     C                     MOVELWJBZNA    PABZNA    P      Carrier Code
     C                     MOVELWJGTST    PAGTST    P      Comment Print A
     C                     MOVELWJGVST    PAGVST    P      Comment Print I
     C                     MOVELWJGUST    PAGUST    P      Comment Print P
     C                     MOVELWJQFST    PAQFST    P      Comment Print S
     C                     MOVELWJCQCD    PACQCD    P      Reason Code
     C                     MOVELWJGJST    PAGJST    P      Order in Use
     C                     MOVELWJGWST    PAGWST    P      Header Status
     C                     MOVELWJGXST    PAGXST    P      Header Status L
     C                     MOVELWJGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWJAODT    PAAODT           Scheduled Ship
     C                     MOVELWJAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWJCXDT    PACXDT           Date of Origina
     C                     Z-ADDWJJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWJA1WG    PAA1WG           Order Weight To
     C                     MOVELWJXIST    PAXIST    P      Credit Hold
     C                     MOVELWJXJST    PAXJST    P      Production Hold
     C                     MOVELWJXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWJEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWJAFTM    PAAFTM           Requested Deliv
     C                     MOVELWJE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWJE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWJRMNB    PARMNB           Load ID
     C                     Z-ADDWJTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWJR1NB    PAR1NB           Rated Freight
     C                     MOVELWJPJST    PAPJST    P      LTL Flag
     C                     MOVELWJU0ST    PAU0ST    P      Price Audit
     C                     MOVELWJU1ST    PAU1ST    P      Price Status
     C                     MOVELWJQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWJU2ST    PAU2ST    P      Export Status
     C                     MOVELWJVEST    PAVEST    P      Palletize
     C                     MOVELWJVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWJVGST    PAVGST    P      Slip Sheet
     C                     MOVELWJRPCD    PARPCD    P      Age Code
     C                     Z-ADDWJRNNB    PARNNB           Reefer Temperat
     C                     MOVELWJVDST    PAVDST    P      Load Type
     C                     Z-ADDWJATIN    PAATIN           Attach to Invoi
     C                     MOVELWJU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWJU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWJRSRN    PARSRN           Resell Referenc
     C                     MOVELWJMHNA    PAMHNA    P      Special Comment
     C                     MOVELWJMINA    PAMINA    P      Special Comment
     C                     MOVELWJWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWJR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWJBFCD    PABFCD    P      Manager Level C
     C                     MOVELWJQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWJT3NB    PAT3NB           Attach to Order
     C                     MOVELWJSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWJCONB    PACONB           Invoice Number
     C                     MOVELWJCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWJAWDT    PAAWDT           Invoice Date
     C                     MOVELWJJPCD    PAJPCD    P      Event Code
     C                     MOVELWJXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWJZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWJVRVA    PAVRVA           A/R order Value
     C                     MOVELWJOBST    PAOBST    P      Billing Activit
     C                     MOVELWJBCST    PABCST    P      Block Order Fla
     C                     MOVELWJBDST    PABDST    P      Order Certifica
     C                     Z-ADDWJB7VL    PAB7VL           Invoice Order V
     C                     MOVELWJGASX    PAGASX    P      Process Sts for
     C                     MOVELWJGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWJGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWJGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWJFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWJFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWJFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWJFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWJFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWJFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWJFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWJFUSX    PAFUSX    P      Order Requires
     C                     MOVELWJFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWJFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWJFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWJFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWJNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWJNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWJNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWJNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWJNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWJBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWJBQTM    PABQTM           Time of Origina
     C                     Z-ADDWJBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWJBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWJBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWJH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWJH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWJH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWJH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWJH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWJC0C7    PAC0C7           Claim Number
     C                     MOVELWJUVST    PAUVST    P      EDI Status 1
     C                     MOVELWJUWST    PAUWST    P      EDI Status 2
     C                     MOVELWJUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWJAATM    PAAATM           Job Time
     C                     MOVELWJAYNA    PAAYNA    P      User Id
     C                     MOVELWJA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWJAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0374  30       Order Sequence
     C                     Z-ADD*ZERO     WN0375  30       Order Secondary
     C                     Z-ADD*ZERO     WN0376 112       Rated Freight
     C                     Z-ADD*ZERO     WN0377 112       @Rated Freight
     C                     MOVEL*BLANK    WN0378  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD0         WN0377           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN0378           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTI01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTI02           Order Number
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
      * Setup key
     C                     Z-ADDWIAIC3    WQTI01           Company Number
     C                     Z-ADDWIC4NB    WQTI02           Order Number
      * Establish starting position
     C           KRSTI     SETLL@BGWKL1                    *
     C           KRSTI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0063           Company Number
     C                     Z-ADDOMC4NB    WL0064           Order Number
     C                     Z-ADDOMDPNB    WL0065           Order Sequence
     C                     Z-ADDOMUENB    WL0066           Order Secondary
     C                     Z-ADD0         WL0067           Rated Freight
     C                     EXSR TJCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0378           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           WIA1WG    IFEQ 0                          *IF
     C           0         OREQ 0                          *OR
     C                     Z-ADD0         WN0376           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           OMGMST    IFEQ 'C'                        *IF
     C           OMGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           OMATWG    DIV  WIA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 0         W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U/M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           OMAVQT    MULT OMAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  WIA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 0         W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN0376    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0063           Company Number
     C                     Z-ADDOMC4NB    WL0064           Order Number
     C                     Z-ADDOMDPNB    WL0065           Order Sequence
     C                     Z-ADDOMUENB    WL0066           Order Secondary
     C                     Z-ADDWN0376    WL0067           Rated Freight
     C                     EXSR TJCHRC
     C                     ADD  WN0376    WN0377           @Rated Freight
     C                     Z-ADDOMDPNB    WN0374           Order Sequence
     C                     Z-ADDOMUENB    WN0375           Order Secondary
     C                     END                             *FI
     C           KRSTI     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0377    IFNE 0                          *IF
     C           WN0378    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WN0377    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN0376           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0063           Company Number
     C                     Z-ADDWIC4NB    WL0064           Order Number
     C                     Z-ADDWN0374    WL0065           Order Sequence
     C                     Z-ADDWN0375    WL0066           Order Secondary
     C                     Z-ADDWN0376    WL0067           Rated Freight
     C                     EXSR TJCHRC
     C                     END                             *FI
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0379  70       Item Code
     C                     MOVEL*BLANK    WN0380  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0381  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0382  70       Order Group Cod
     C                     MOVEL*BLANK    WN0383  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0384  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0385 112       Billing Detail
     C                     Z-ADD*ZERO     WN0386 112       Billing Detail
     C                     Z-ADD*ZERO     WN0387 112       Billing Detail
     C                     Z-ADD*ZERO     WN0388 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0389  1        Comment Print A
     C                     MOVEL*BLANK    WN0390  1        Comment Print I
     C                     MOVEL*BLANK    WN0391  1        Comment Print P
     C                     MOVEL*BLANK    WN0392  1        Comment Print S
     C                     Z-ADD*ZERO     WN0393 112       Extended Amount
     C                     Z-ADD*ZERO     WN0394  70       Market Pricing
     C                     MOVEL*BLANK    WN0395  3        Commodity Marke
     C                     MOVEL*BLANK    WN0396  3        Date Method Cod
     C                     MOVEL*BLANK    WN0397  3        Price Method Co
     C                     Z-ADD*ZERO     WN0398 114       Price Overage O
     C                     Z-ADD*ZERO     WN0399  70       Contract Number
     C                     MOVEL*BLANK    WN0400  1        Price Status
     C                     Z-ADD*ZERO     WN0401  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0402  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0403  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0404  1        Work Confirm St
     C                     MOVEL*BLANK    WN0405  1        Work Over/Short
     C                     MOVEL*BLANK    WN0406  1        OD Production P
     C                     MOVEL*BLANK    WN0407 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0408 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0409  1        Age Code
     C                     MOVEL*BLANK    WN0410  1        Palletize
     C                     MOVEL*BLANK    WN0411  1        Slip Sheet
     C                     MOVEL*BLANK    WN0412  1        Catch Weight St
     C                     MOVEL*BLANK    WN0413  1        Price Audit
     C                     MOVEL*BLANK    WN0414  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0415  1        Production Date
     C                     Z-ADD*ZERO     WN0416 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0417 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0418 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0419 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0420 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0421 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0422 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0423 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0424 114       Unit Price
     C                     Z-ADD*ZERO     WN0425 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0426 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0427 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0428 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0429  70       Requested Ship
     C                     Z-ADD*ZERO     WN0430  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0431  70       Actual Shipped
     C                     MOVEL*BLANK    WN0432  1        Affect Inventor
     C                     MOVEL*BLANK    WN0433  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0434  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0435  30       Item Structure
     C                     Z-ADD*ZERO     WN0436  30       Item Structure
     C                     Z-ADD*ZERO     WN0437  30       Item Structure
     C                     MOVEL*BLANK    WN0438  2        Item Level
     C                     MOVEL*BLANK    WN0439  2        Quality Level
     C                     MOVEL*BLANK    WN0440  2        Pricing Product
     C                     MOVEL*BLANK    WN0441  2        Season Product
     C                     Z-ADD*ZERO     WN0442  70       Date of Origina
     C                     MOVEL*BLANK    WN0443 10        User Profile Na
     C                     MOVEL*BLANK    WN0444  6        Country Code
     C                     MOVEL*BLANK    WN0445  2        Event Code
     C                     MOVEL*BLANK    WN0446  3        Reason Code
     C                     MOVEL*BLANK    WN0447  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0448  1        Modified Flag
     C                     MOVEL*BLANK    WN0449  1        Substituted Fla
     C                     MOVEL*BLANK    WN0450  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0451 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0452 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0453  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0454  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0455  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0456  1        Affect Commissi
     C                     MOVEL*BLANK    WN0457  1        Affect Pricing
     C                     MOVEL*BLANK    WN0458  1        Released by Use
     C                     MOVEL*BLANK    WN0459  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0460  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0461  3        Production Ware
     C                     MOVEL*BLANK    WN0462  3        OD Price Type
     C                     Z-ADD*ZERO     WN0463  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0464  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0465  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0466  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0467  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0468  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0469  60       Price Code
     C                     Z-ADD*ZERO     WN0470  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0471  60       Substitution Li
     C                     Z-ADD*ZERO     WN0472  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0473 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0474 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0475 112       OD Item Target
     C                     Z-ADD*ZERO     WN0476 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0477 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0478 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0479 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0480 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0481 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0482 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0483 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0484 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0485 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0486  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0487  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0488  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0489 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0490  40       Item Age Days
     C                     Z-ADD*ZERO     WN0491  70       Production Ovr
     C                     Z-ADD*ZERO     WN0492  70       Production Ovr
     C                     MOVEL*BLANK    WN0493  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0494  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0495  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0496  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0497  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0498  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0499  1        EDI Status 1
     C                     MOVEL*BLANK    WN0500  1        EDI Status 2
     C                     MOVEL*BLANK    WN0501  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0502  60       Job Time
     C                     MOVEL*BLANK    WN0503 10        User Id
     C                     MOVEL*BLANK    WN0504 10        Job Name
     C                     Z-ADD*ZERO     WN0505  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0063    WKAIC3           Company Number
     C                     Z-ADDWL0064    WKC4NB           Order Number
     C                     Z-ADDWL0065    WKDPNB           Order Sequence
     C                     Z-ADDWL0066    WKUENB           Order Secondary
      *
     C           KLCHTJ    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C           KLCHTJ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YDRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0067    WKR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * RTV Load Header All,Mg RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSTK     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    WN0506           Scheduled Ship
     C                     MOVELWCPJST    WUG0TX           LTL Flag
     C                     MOVELWCPKST    WUG0TX           Load Status
     C                     Z-ADDWCRNNB    WUNFNN           Reefer Temperat
     C                     MOVELWCDMTX    WUG0TX           Seal 1
     C                     MOVELWCDNTX    WUG0TX           Seal 2
     C                     MOVELWCDOTX    WUG0TX           Seal 3
     C                     Z-ADDWCRPNB    WUNFNN           Total Load Orde
     C                     Z-ADDWCFLAM    WN0507           Flat Amount
     C                     MOVELWCXQST    WUG0TX           Allocate Pounds
     C                     Z-ADDWCRRNB    WN0508           Total Stops
     C                     MOVELWCDXTX    WUG0TX           Trailer Id
     C                     MOVELWCDYTX    WUG0TX           Transloader Car
     C                     Z-ADDWCSBNB    WUNFNN           BOL Time
     C                     MOVELWCBZNA    WUG0TX           Carrier Code
     C                     MOVELWCRONB    WUG0TX           Truck Size
     C                     Z-ADDWCSQNB    WUNFNN           Ld Hdr/Ld Dtl U
     C                     Z-ADDWCR1NB    WUNFNN           Rated Freight
     C                     MOVELWCVCST    WUG0TX           Ship Status
     C                     MOVELWCVDST    WUG0TX           Load Type
     C                     Z-ADDWCSDNB    WUNFNN           Number Pallets
     C                     Z-ADDWCPAOU    WUNFNN           Number Pallets
     C                     Z-ADDWCDGWG    WUNFNN           Load Carrier Pa
     C                     Z-ADDWCSXNB    WUNFNN           Estimated Arriv
     C                     Z-ADDWCHADT    WUNFNN           Actual Arrival
     C                     Z-ADDWCAART    WUNFNN           Actual Arrival
     C                     Z-ADDWCDHWG    WUNFNN           Trailer IN Weig
     C                     Z-ADDWCDIWG    WUNFNN           Trailer OUT Wei
     C                     Z-ADDWCAQDT    WUNFNN           Actual Departur
     C                     Z-ADDWCS6NB    WUNFNN           Departure Time
     C                     Z-ADDWCT4NB    WUNFNN           Schedule Sequen
     C                     Z-ADDWCPRTM    WUNFNN           Product Tempera
     C                     Z-ADDWCNPSV    WUNFNN           Number Pallets
     C                     MOVELWCJ8TX    WUG0TX           Car/Veh. Initia
     C                     Z-ADDWCTLMI    WN0509           Total Load Mile
     C                     MOVELWCJ9TX    WUG0TX           Recorder ID
     C                     MOVELWCQ2CD    WUG0TX           Shipping Method
     C                     MOVELWCVPCD    WN0510           Ship From Wareh
     C                     MOVELWCDBCD    WN0511           Ship To State C
     C                     Z-ADDWCGRWE    WUNFNN           Gross Weight
     C                     MOVELWCXCCD    WN0512           Carrier Broker
     C                     MOVELWCU2ST    WN0513           Export Status
     C                     Z-ADDWCF9DT    WUNFNN           Actual Ship Dat
     C                     MOVELWCONTM    WUG0TX           On Time - (Y/N)
     C                     Z-ADDWCJ4DT    WUNFNN           Truck Ready Dat
     C                     Z-ADDWCTRTM    WUNFNN           Truck Ready Tim
     C                     Z-ADDWCJ5DT    WUNFNN           Spotted Date
     C                     Z-ADDWCSPTM    WUNFNN           Spotted Time
     C                     Z-ADDWCJ6DT    WUNFNN           Load Finished D
     C                     Z-ADDWCLFTM    WUNFNN           Load Finished T
     C                     Z-ADDWCJ7DT    WUNFNN           BOL Complete Da
     C                     Z-ADDWCBOTM    WUNFNN           BOL Complete Ti
     C                     Z-ADDWCJ8DT    WUNFNN           BOL Received Da
     C                     Z-ADDWCBLTM    WUNFNN           BOL Received Ti
     C                     Z-ADDWCKIDT    WUNFNN           Truck Departure
     C                     Z-ADDWCASTM    WUNFNN           Truck Departure
     C                     Z-ADDWCKADT    WUNFNN           Adjusted Depart
     C                     Z-ADDWCAJCM    WUNFNN           Adjusted Depart
     C                     MOVELWCXACD    WUG0TX           Shipping Line
     C                     MOVELWCOANA    WUG0TX           Port Delv Termi
     C                     MOVELWCK4TX    WUG0TX           Vessel Name
     C                     Z-ADDWCVOAG    WUNFNN           Voyage
     C                     Z-ADDWCKBDT    WUNFNN           Sail Date
     C                     MOVELWCNBBO    WUG0TX           Booking Number
     C                     MOVELWCW4CD    WUG0TX           Discharge Port
     C                     Z-ADDWCEFDT    WUNFNN           Arrival Date
     C                     MOVELWCCNTN    WUG0TX           Container Numbe
     C                     Z-ADDWCKCDT    WUNFNN           Date In
     C                     Z-ADDWCTMIN    WUNFNN           Time In
     C                     Z-ADDWCKDDT    WUNFNN           Date Out
     C                     Z-ADDWCVMNB    WUNFNN           Time Out
     C                     Z-ADDWCOCFR    WUNFNN           Load Total Frei
     C                     Z-ADDWCKJDT    WUNFNN           Scheduled Deliv
     C                     Z-ADDWCATTM    WUNFNN           Scheduled Deliv
     C                     MOVELWCOTRS    WUG0TX           LH Unused Sts
     C                     Z-ADDWCKKDT    WUNFNN           On Yard Date
     C                     Z-ADDWCAVTM    WUNFNN           On Yard Time
     C                     Z-ADDWCKZDT    WN0516           Deadline Depart
     C                     Z-ADDWCAXTM    WN0517           Deadline Depart
     C                     MOVELWCRYSX    WN0518           MG Created Load
     C                     GOTO TKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0538  70       Total Load Mile
     C                     MOVEL*BLANK    WN0539  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0540  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0541  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSTL     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
     C                     EXSR TMRVGN
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           WCAJCD    IFEQ WN0539                     *IF
     C                     MOVEL*BLANK    WN0540           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWCAJCD    WN0540           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           WCRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDWCTLMI    WN0538           Total Load Mile
     C                     Z-ADDWCK2DT    WN0541           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADDWCRMNB    PCRMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
     C           WN0538    PARM WN0538    WQ0022  70       Total Load Mile
     C           WN0541    PARM WN0541    WQ0023  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR TPCHRC
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQTM02           Load ID
      * Define keylist
     C           KPSTM     KLIST
     C                     KFLD           WQTM02           Load ID
     C                     KFLD           WERVNB           Stop/Drop
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM02           Load ID
      * Setup key
     C                     Z-ADDWCRMNB    WQTM02           Load ID
     C                     Z-ADD1         WERVNB           Stop/Drop
      * Establish starting position
     C           KPSTM     SETLL@FLCPEB                    *
     C           KRSTM     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR TNRVGN
     C                     GOTO TMEXIT                     *QUIT
     C           KRSTM     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQTN01           Company Number
     C           *LIKE     DEFN WLC4NB    WQTN02           Order Number
      * Define keylist
     C           KPSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           WQTN02           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           WQTN02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTN01           Company Number
     C                     Z-ADDWEC4NB    WQTN02           Order Number
     C                     Z-ADD0         WLDPNB           Order Sequence
     C                     Z-ADD0         WLUENB           Order Secondary
      * Establish starting position
     C           KPSTN     SETLL@BGWKAE                    *
     C           KRSTN     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0539           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR TORVGN
      * PAR = DB1 By name
     C                     MOVELWLAJCD    WN0539           Warehouse Code
     C                     GOTO TNEXIT                     *QUIT
     C           KRSTN     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     MOVELWLAJCD    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSTO     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0542  30       Company Number
     C                     Z-ADD*ZERO     WN0543  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0544  1        LTL Flag
     C                     MOVEL*BLANK    WN0545  1        Load Status
     C                     Z-ADD*ZERO     WN0546  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0547 15        Seal 1
     C                     MOVEL*BLANK    WN0548 15        Seal 2
     C                     MOVEL*BLANK    WN0549 15        Seal 3
     C                     MOVEL*BLANK    WN0550 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0551 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0552  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0553 112       Flat Amount
     C                     MOVEL*BLANK    WN0554  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0555  50       Total Stops
     C                     MOVEL*BLANK    WN0556 20        Trailer Id
     C                     MOVEL*BLANK    WN0557  3        Transloader Car
     C                     Z-ADD*ZERO     WN0558  40       BOL Time
     C                     MOVEL*BLANK    WN0559  3        Carrier Code
     C                     MOVEL*BLANK    WN0560  7        Truck Size
     C                     Z-ADD*ZERO     WN0561  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0562 112       Rated Freight
     C                     MOVEL*BLANK    WN0563  1        Ship Status
     C                     MOVEL*BLANK    WN0564  1        Load Type
     C                     Z-ADD*ZERO     WN0565  50       Number Pallets
     C                     Z-ADD*ZERO     WN0566  50       Number Pallets
     C                     Z-ADD*ZERO     WN0567 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0568  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0569  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0570  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0571 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0572 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0573  70       Actual Departur
     C                     Z-ADD*ZERO     WN0574  40       Departure Time
     C                     Z-ADD*ZERO     WN0575  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0576  52       Product Tempera
     C                     Z-ADD*ZERO     WN0577  50       Number Pallets
     C                     MOVEL*BLANK    WN0578 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0579 12        Recorder ID
     C                     MOVEL*BLANK    WN0580  2        Shipping Method
     C                     MOVEL*BLANK    WN0581  2        Ship To State C
     C                     Z-ADD*ZERO     WN0582  70       Gross Weight
     C                     MOVEL*BLANK    WN0583  3        Carrier Broker
     C                     MOVEL*BLANK    WN0584  1        Export Status
     C                     Z-ADD*ZERO     WN0585  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0586  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0587  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0588  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0589  70       Spotted Date
     C                     Z-ADD*ZERO     WN0590  60       Spotted Time
     C                     Z-ADD*ZERO     WN0591  70       Load Finished D
     C                     Z-ADD*ZERO     WN0592  60       Load Finished T
     C                     Z-ADD*ZERO     WN0593  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0594  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0595  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0596  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0597  70       Truck Departure
     C                     Z-ADD*ZERO     WN0598  60       Truck Departure
     C                     Z-ADD*ZERO     WN0599  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0600  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0601  3        Shipping Line
     C                     MOVEL*BLANK    WN0602 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0603 30        Vessel Name
     C                     Z-ADD*ZERO     WN0604  50       Voyage
     C                     Z-ADD*ZERO     WN0605  70       Sail Date
     C                     MOVEL*BLANK    WN0606 12        Booking Number
     C                     MOVEL*BLANK    WN0607 20        Discharge Port
     C                     Z-ADD*ZERO     WN0608  70       Arrival Date
     C                     MOVEL*BLANK    WN0609 12        Container Numbe
     C                     Z-ADD*ZERO     WN0610  70       Date In
     C                     Z-ADD*ZERO     WN0611  60       Time In
     C                     Z-ADD*ZERO     WN0612  70       Date Out
     C                     Z-ADD*ZERO     WN0613  60       Time Out
     C                     Z-ADD*ZERO     WN0614 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0615  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0616  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0617  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0618  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0619  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0620  70       Requested Deliv
     C                     MOVEL*BLANK    WN0621  1        Load Acceptance
     C                     Z-ADD*ZERO     WN0622  70       On Yard Date
     C                     Z-ADD*ZERO     WN0623  60       On Yard Time
     C                     Z-ADD*ZERO     WN0624  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0625  60       Deadline Depart
     C                     MOVEL*BLANK    WN0626  1        Load Held Over
     C                     MOVEL*BLANK    WN0627  1        Load Held Over
     C                     MOVEL*BLANK    WN0628 15        Load Held Over
     C                     MOVEL*BLANK    WN0629 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0630 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0631  70       Express Mail Da
     C                     MOVEL*BLANK    WN0632  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0633  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0634  70       Product Complet
     C                     Z-ADD*ZERO     WN0635  60       Product Complet
     C                     Z-ADD*ZERO     WN0636  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0637  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0638  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0639  1        Load Confirmed
     C                     MOVEL*BLANK    WN0640 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0641  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0642  60       Load Door 1
     C                     Z-ADD*ZERO     WN0643  60       Load Door 2
     C                     MOVEL*BLANK    WN0644  1        Partial Load
     C                     MOVEL*BLANK    WN0645  1        Load Confirmati
     C                     MOVEL*BLANK    WN0646  1        Export Load USD
     C                     MOVEL*BLANK    WN0647  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0648 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0649 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0650 15        Late Billing Em
     C                     MOVEL*BLANK    WN0651 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0652 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0653  1        Multi Company L
     C                     MOVEL*BLANK    WN0654  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0655  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0656  1        LH Power Only L
     C                     MOVEL*BLANK    WN0657  1        MG Created Load
     C                     MOVEL*BLANK    WN0658  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0659  2        Load U/M
     C                     MOVEL*BLANK    WN0660  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0661  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0662  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0663  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0664  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0665  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0666  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0667  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0668  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0669  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0670  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0671  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0672  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0673  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0674  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0675  60       LH Unused Time
     C                     MOVEL*BLANK    WN0676  1        EDI Status 1
     C                     MOVEL*BLANK    WN0677  1        EDI Status 2
     C                     MOVEL*BLANK    WN0678  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0679  60       Job Time
     C                     MOVEL*BLANK    WN0680 10        User Id
     C                     MOVEL*BLANK    WN0681 10        Job Name
     C                     Z-ADD*ZERO     WN0682  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWCRMNB    WFRMNB           Load ID
      *
     C           KLCHTP    KLIST
     C                     KFLD           WFRMNB           Load ID
     C           KLCHTP    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YERDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0538    WFTLMI           Total Load Mile
     C                     MOVELWN0539    WFVPCD    P      Ship From Wareh
     C                     MOVELWN0540    WFAJCD    P      Warehouse Code
     C                     Z-ADDWN0541    WFK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * RTV 1st Carr Apt Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQTQ02           Load ID
      * Define keylist
     C           KPSTQ     KLIST
     C                     KFLD           WQTQ02           Load ID
     C                     KFLD           WERVNB           Stop/Drop
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTQ02           Load ID
     C                     Z-ADD0         WERVNB           Stop/Drop
      * Establish starting position
     C           KPSTQ     SETLL@FLCPEB                    *
     C           KRSTQ     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWEN7DT    WUN7DT           LD Carrier Appt
     C                     Z-ADDWEB3TM    WN0517           LD Carrier Appt
     C                     GOTO TQEXIT                     *QUIT
     C           KRSTQ     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQTR02           Load ID
      * Define keylist
     C           KPSTR     KLIST
     C                     KFLD           WQTR02           Load ID
     C                     KFLD           WERVNB           Stop/Drop
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTR02           Load ID
     C                     Z-ADD0         WERVNB           Stop/Drop
      * Establish starting position
     C           KPSTR     SETLL@FLCPEB                    *
     C           KRSTR     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR TSRVGN
     C                     GOTO TREXIT                     *QUIT
     C           KRSTR     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WAAIC3           Company Number
     C                     Z-ADDWEC4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSTS     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WN0516           Requested Deliv
     C                     Z-ADD*ZERO     WN0536           Requested Deliv
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABRTX    WUBRTX           Ship To Name
     C                     MOVELWAHNNA    WUHNNA           Ship To City
     C                     Z-ADDWAEIDT    WN0516           Requested Deliv
     C                     Z-ADDWAAFTM    WN0536           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSTT     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCQ2CD    YL0012           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQTU02           Load ID
      * Define keylist
     C           KPSTU     KLIST
     C                     KFLD           WQTU02           Load ID
     C                     KFLD           WERVNB           Stop/Drop
     C                     KFLD           WEC4NB           Order Number
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WQTU02           Load ID
      * Setup key
     C                     Z-ADDWL0068    WQTU02           Load ID
     C                     Z-ADDWL0069    WERVNB           Stop/Drop
     C                     Z-ADDWL0070    WEC4NB           Order Number
      * Establish starting position
     C           KPSTU     SETLL@FLCPEB                    *
     C           KRSTU     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWERWNB    WL0071           Miles to next s
     C                     GOTO TUEXIT                     *QUIT
     C           KRSTU     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSTV     KLIST
     C                     KFLD           LGMILE           Miles to First
      * Setup key
     C                     Z-ADDWN0684    LGMILE           Miles to First
      * Establish starting position
     C           KPSTV     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLGHRRQ    YL0013           Hours Required
     C                     GOTO TVEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * RTV Ship To City/St-Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQTW02           Load ID
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WQTW02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTW02           Load ID
      * Establish starting position
     C           KRSTW     SETLL@BFCPD9                    *
     C           KRSTW     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEHNNA    WN0521           Ship To City
     C                     MOVELBEDBCD    WN0522           Ship To State C
     C                     GOTO TWEXIT                     *QUIT
     C           KRSTW     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * RTV Destination Amount RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           LEBZNA           Carrier Code
     C                     KFLD           LEAJCD           Warehouse Code
     C                     KFLD           LEXECD           Destination Cit
     C                     KFLD           LEBGCD           State Code
      * Setup key
     C                     MOVELWN0512    LEBZNA           Carrier Code
     C                     MOVELWN0510    LEAJCD           Warehouse Code
     C                     MOVELWN0521    LEXECD           Destination Cit
     C                     MOVELWN0522    LEBGCD           State Code
      * Establish starting position
     C           KRSTX     CHAIN@LECPM7              90    *
      * Data record not found
     C   90                MOVEL'USR2455' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * only pass out FLAT amt.  (it could now be a ML rate too)  01/03/0
      * CASE: DB1.CDR Unit of Measure is Flat
     C           LEAVTX    IFEQ 'FL'                       *IF
      * PAR = DB1 By name
     C                     Z-ADDLENMVA    WN0507           Flat Rate
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCHRC    BEGSR
      *================================================================
      * CHG Lock Load Update   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0692  30       Company Number
     C                     MOVEL*BLANK    WN0693  1        LTL Flag
     C                     Z-ADD*ZERO     WN0694  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0695 15        Seal 1
     C                     MOVEL*BLANK    WN0696 15        Seal 2
     C                     MOVEL*BLANK    WN0697 15        Seal 3
     C                     MOVEL*BLANK    WN0698 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0699 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0700  70       Total Load Orde
     C                     MOVEL*BLANK    WN0701  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0702  50       Total Stops
     C                     MOVEL*BLANK    WN0703 20        Trailer Id
     C                     MOVEL*BLANK    WN0704  3        Transloader Car
     C                     Z-ADD*ZERO     WN0705  40       BOL Time
     C                     MOVEL*BLANK    WN0706  3        Carrier Code
     C                     MOVEL*BLANK    WN0707  7        Truck Size
     C                     Z-ADD*ZERO     WN0708  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0709 112       Rated Freight
     C                     MOVEL*BLANK    WN0710  1        Ship Status
     C                     MOVEL*BLANK    WN0711  1        Load Type
     C                     Z-ADD*ZERO     WN0712  50       Number Pallets
     C                     Z-ADD*ZERO     WN0713  50       Number Pallets
     C                     Z-ADD*ZERO     WN0714 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0715  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0716  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0717  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0718 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0719 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0720  70       Actual Departur
     C                     Z-ADD*ZERO     WN0721  40       Departure Time
     C                     Z-ADD*ZERO     WN0722  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0723  52       Product Tempera
     C                     Z-ADD*ZERO     WN0724  50       Number Pallets
     C                     MOVEL*BLANK    WN0725 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0726  70       Total Load Mile
     C                     MOVEL*BLANK    WN0727 12        Recorder ID
     C                     MOVEL*BLANK    WN0728  2        Shipping Method
     C                     Z-ADD*ZERO     WN0729  70       Gross Weight
     C                     MOVEL*BLANK    WN0730  3        Carrier Broker
     C                     MOVEL*BLANK    WN0731  1        Export Status
     C                     Z-ADD*ZERO     WN0732  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0733  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0734  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0735  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0736  70       Spotted Date
     C                     Z-ADD*ZERO     WN0737  60       Spotted Time
     C                     Z-ADD*ZERO     WN0738  70       Load Finished D
     C                     Z-ADD*ZERO     WN0739  60       Load Finished T
     C                     Z-ADD*ZERO     WN0740  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0741  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0742  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0743  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0744  70       Truck Departure
     C                     Z-ADD*ZERO     WN0745  60       Truck Departure
     C                     Z-ADD*ZERO     WN0746  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0747  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0748  3        Shipping Line
     C                     MOVEL*BLANK    WN0749 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0750 30        Vessel Name
     C                     Z-ADD*ZERO     WN0751  50       Voyage
     C                     Z-ADD*ZERO     WN0752  70       Sail Date
     C                     MOVEL*BLANK    WN0753 12        Booking Number
     C                     MOVEL*BLANK    WN0754 20        Discharge Port
     C                     Z-ADD*ZERO     WN0755  70       Arrival Date
     C                     MOVEL*BLANK    WN0756 12        Container Numbe
     C                     Z-ADD*ZERO     WN0757  70       Date In
     C                     Z-ADD*ZERO     WN0758  60       Time In
     C                     Z-ADD*ZERO     WN0759  70       Date Out
     C                     Z-ADD*ZERO     WN0760  60       Time Out
     C                     Z-ADD*ZERO     WN0761 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0762  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0763  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0764  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0765  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0766  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0767  70       Requested Deliv
     C                     MOVEL*BLANK    WN0768  1        Load Acceptance
     C                     MOVEL*BLANK    WN0769  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0770  70       On Yard Date
     C                     Z-ADD*ZERO     WN0771  60       On Yard Time
     C                     MOVEL*BLANK    WN0772  1        Load Held Over
     C                     MOVEL*BLANK    WN0773  1        Load Held Over
     C                     MOVEL*BLANK    WN0774 15        Load Held Over
     C                     MOVEL*BLANK    WN0775 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0776 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0777  70       Express Mail Da
     C                     MOVEL*BLANK    WN0778  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0779  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0780  70       Product Complet
     C                     Z-ADD*ZERO     WN0781  60       Product Complet
     C                     Z-ADD*ZERO     WN0782  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0783  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0784  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0785  1        Load Confirmed
     C                     MOVEL*BLANK    WN0786 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0787  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0788  60       Load Door 1
     C                     Z-ADD*ZERO     WN0789  70       Override Total
     C                     Z-ADD*ZERO     WN0790  60       Load Door 2
     C                     MOVEL*BLANK    WN0791  1        Partial Load
     C                     MOVEL*BLANK    WN0792  1        Load Confirmati
     C                     MOVEL*BLANK    WN0793  1        Export Load USD
     C                     MOVEL*BLANK    WN0794  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0795 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0796 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0797 15        Late Billing Em
     C                     MOVEL*BLANK    WN0798 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0799 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0800  1        Multi Company L
     C                     MOVEL*BLANK    WN0801  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0802  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0803  1        LH Power Only L
     C                     MOVEL*BLANK    WN0804  1        MG Created Load
     C                     MOVEL*BLANK    WN0805  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0806  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0807  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0808  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0809  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0810  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0811  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0812  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0813  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0814  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0815  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0816  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0817  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0818  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0819  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0820  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0821  60       LH Unused Time
     C                     MOVEL*BLANK    WN0822  1        EDI Status 1
     C                     MOVEL*BLANK    WN0823  1        EDI Status 2
     C                     MOVEL*BLANK    WN0824  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0825  60       Job Time
     C                     MOVEL*BLANK    WN0826 10        User Id
     C                     MOVEL*BLANK    WN0827 10        Job Name
     C                     Z-ADD*ZERO     WN0828  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WFRMNB           Load ID
      *
     C           KLCHTY    KLIST
     C                     KFLD           WFRMNB           Load ID
     C           KLCHTY    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YFRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0506    WFAODT           Scheduled Ship
     C                     MOVEL'L'       WFPKST    P      Load Status
     C                     Z-ADDWN0507    WFFLAM           Flat Amount
     C                     MOVELWN0510    WFVPCD    P      Ship From Wareh
     C                     MOVELWN0511    WFDBCD    P      Ship To State C
     C                     Z-ADDWN0516    WFKZDT           Deadline Depart
     C                     Z-ADDWN0517    WFAXTM           Deadline Depart
     C                     MOVELWN0519    WFR0SX    P      Load U/M
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZRVGN    BEGSR
      *================================================================
      * RTV All Whses on Load  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0523           USR Warehouse C
     C                     MOVEL*BLANK    WN0524           USR CDE Parm 1
     C                     MOVEL*BLANK    WN0525           USR CDE Parm 2
     C                     MOVEL*BLANK    WN0526           USR CDE Parm 3
     C                     MOVEL*BLANK    WN0527           USR CDE Parm 4
     C                     MOVEL*BLANK    WN0528           USR CDE Parm 5
     C                     MOVEL*BLANK    WN0529           USR CDE Parm 6
     C                     MOVEL*BLANK    WN0530           USR CDE Parm 7
     C                     MOVEL*BLANK    WN0531           USR CDE Parm 8
     C                     MOVEL*BLANK    WN0532           USR CDE Parm 9
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMRMNB    WQTZ02           Load ID
      * Define keylist
     C           KRSTZ     KLIST
     C                     KFLD           WQTZ02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQTZ02           Load ID
      * Establish starting position
     C           KRSTZ     SETLL@FLCPKF                    *
     C           KRSTZ     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV All Whses on Order RT - Order Detail  * 
     C                     EXSR NARVGN
     C           KRSTZ     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change log and comments
      *================================================================
      * ** 01/18/2010 PKD E000261 Pass the Average Pallet Tare
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 09/20/2011 LJB P001251 Export Order Automation
      * ** Cannot lock if Export Order Automation Upload had errors
      * ** that have not been cleared up
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Calc Load U/M           -- RMC 6/16/06
      *================================================================
      * ** All boxes=BX, All combos=CB, Any mix of the two=MX   E00239 11
      * RTV UM/Whs Code,BX Qty XF - Order Header TRG  * 
     C                     CALL 'PPYXXFR'              90  RTV UM/Whs Code
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0028  70       Load ID
     C           WN0519    PARM *BLANK    WQ0029  2        Load U/M
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 07/15/16  RMC E4119 Dont recalc deadl depart,miles if MG Creat
      * ** 09/30/2009 LJB E00495
      * **   Use carrier date/time, if entered, to calc DDD/T
      * ** 11/16/2007 LJB FP1251 Deadline Depart Date and Time will be
      * ** zeros if there is no Miles Between Cities record
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Change Log
      *================================================================
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * **  E2625 08/07/13 RMC - TPM Changes
      * ** P001251 LJB 09/20/2011 Export Order Automation Upload
      * ** Don't allow lock if errors still pending in Order Detail
      * ** E00495 LJB 10/01/2009
      * ** Recompile - change to "upd lock load update if" to recalc
      * ** DDD/T based on carrier appt dt/tm, if entered.
      * ** Commented out all functions that are not used here
      * ** E00207 LJB 08/13/2008
      * ** Override Total Load Miles, if entered, is to be used instead
      * ** of Total Load Miles. If used, highlight on the screen.
      * ** Also highlight if 12 to recalc and Override miles is entered.
      * ** FP1101 LJB 04/10/2007
      * ** Commented out the code to edit export instructions. It has
      * ** nothing to do with this program - it is just left over from
      * ** the program that was used to generate it. The command keys don
      * ** work but I commented the code anyway to prevent it from being
      * ** activated later.
      * 05/12/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *                                     from Logical View
      * 5/17/04 RMC PKTR01 - Co is Load Start Co
      * 5/31/06 RMC PFS017 - Allow UnLock when Picked if CO and CT dont e
      *     Only Shipping should be allowed to do this, so
      *      Allow unlock if picked is yes from this pgm only.
      *      Check company value to see if the above feature is ON/OFF.
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03072
     C           ZINPOS    ANDLE05120
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  12        W0CSRR  50
     C           ZZSFM     IFEQ '0'
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ELSE
     C                     Z-ADD0         ZINPOS
     C                     ENDIF
     C                     ADD  12        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD12        ZHSTRW  40
     C                     Z-ADD19        ZHNDRW  40
     C           ZZSFM     IFEQ '0'
     C                     Z-ADD2         ZHRLEN  40
     C                     ELSE
     C                     Z-ADD1         ZHRLEN
     C                     ENDIF
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ036
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2PKST'  YPMTFD           Load Status
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ079
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CB8ST'  YPMTFD           Status - Y or N
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DQCD           Enterprise Code
     C                     MOVEL*BLANK    P1DRCD           Enterprise Code
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     MOVEL*BLANK    P2G3TX           PRT Description
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     Z-ADD*ZERO     P2DYNB           PRT Number of C
     C                     MOVEL*BLANK    P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P2AJAA           Company Number
     C                     Z-ADD*ZERO     P2AJAB           Date 1
     C                     Z-ADD*ZERO     P2AJAE           Order Number 1
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     MOVEL*BLANK    P2B8ST           Status - Y or N
     C                     MOVEL*BLANK    P2HWSX           Change Flag USR
     C                     MOVEL*BLANK    P3XFST           Display Prt Opt
     C                     MOVEL*BLANK    P3E5ST           USR Output Only
     C                     MOVEL*BLANK    P3E7ST           USR Print Detai
     C                     Z-ADD*ZERO     P3SEQ1           Seq No 1  PASS
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL*BLANK    P3ECST           Error Status
     C                     Z-ADD*ZERO     P3CDWG           USR Weight Accu
     C                     MOVEL*BLANK    P4D4ST           USR Flag 1
     C                     MOVEL*BLANK    P5B2VN           Job Name CDE
     C                     Z-ADD*ZERO     P6RMNB           Load ID
     C                     MOVEL*BLANK    P6BZNA           Carrier Code
     C                     MOVEL*BLANK    P7A0NA           Job Name
     C                     Z-ADD*ZERO     P8RVNB           Stop/Drop
     C                     Z-ADD*ZERO     P9G0NX           Numeric 4,0
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Whs Ord Ship Sts USR
     C                     MOVEL*BLANK    WUD9SX  1
      * Define work field Plant Controlled Sts
     C                     MOVEL*BLANK    WUFBSX  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WBRWNB           Miles to next s
     C                     Z-ADD*ZERO     WBRXNB           Freight Charge
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WBT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WBT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBKFDT           Appointment Con
     C                     Z-ADD*ZERO     WBACTM           Appointment Con
     C                     Z-ADD*ZERO     WBEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WBAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBZ4NB           MPC Number
     C                     Z-ADD*ZERO     WBN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WBN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WBN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WBB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WBB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WBB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Pallets
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Override Total
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WCCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WCPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WCCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WCP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WCCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WCP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WCCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Allow Unlock if Picked St
     C                     MOVEL*BLANK    WUZUSX  1
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Unlock Load Authority
     C                     MOVEL*BLANK    WUHTST  1
      * Define work field Pick Status USR
     C                     MOVEL*BLANK    WUZMST  1
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Description
     C                     MOVEL*BLANK    WUF8NA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WKMAVA           Billing Detail
     C                     Z-ADD*ZERO     WKKDVA           Billing Detail
     C                     Z-ADD*ZERO     WKL8VA           Billing Detail
     C                     Z-ADD*ZERO     WKL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WKAYVA           Extended Amount
     C                     Z-ADD*ZERO     WKEXDT           Market Pricing
     C                     Z-ADD*ZERO     WKBZPR           Price Overage O
     C                     Z-ADD*ZERO     WKL6NB           Contract Number
     C                     Z-ADD*ZERO     WKGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WKD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WKCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WKAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WKCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WKATWG           Weight Shipped
     C                     Z-ADD*ZERO     WKAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WKAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WKAKPR           Unit Price
     C                     Z-ADD*ZERO     WKALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WKAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WKAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WKA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WKA5DT           Requested Ship
     C                     Z-ADD*ZERO     WKAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WKGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WKRGNB           Item Structure
     C                     Z-ADD*ZERO     WKRHNB           Item Structure
     C                     Z-ADD*ZERO     WKRINB           Item Structure
     C                     Z-ADD*ZERO     WKCXDT           Date of Origina
     C                     Z-ADD*ZERO     WKDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WKB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WKA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WKNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WKNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WKNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WKNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WKNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WKBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WKBVTM           Price Code
     C                     Z-ADD*ZERO     WKBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WKBXTM           Substitution Li
     C                     Z-ADD*ZERO     WKBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WKH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WKH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WKH7NX           OD Item Target
     C                     Z-ADD*ZERO     WKH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WKH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WKDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WKDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WKDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WKDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WKDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WKGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WKGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WKGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WKPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WKRINY           Item Age Days
     C                     Z-ADD*ZERO     WKTIDT           Production Ovr
     C                     Z-ADD*ZERO     WKTJDT           Production Ovr
     C                     Z-ADD*ZERO     WKTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WKTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WKTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Destination City
     C                     MOVEL*BLANK    WUXECD 20
      * Define work field USR Select/Omit Flag
     C                     MOVEL*BLANK    WUCYST  1
      * Define work field USR Detail or Summary
     C                     MOVEL*BLANK    WUSTST  1
      * Define work field AUTO PRINT PRELIM PICK
     C                     MOVEL*BLANK    WUCLST  1
      * Define work field PRT Printer Device
     C                     MOVEL*BLANK    WUWRST 10
      * Define work field PRT Hold Output Sts
     C                     MOVEL*BLANK    WUWSST  4
      * Define work field PRT Save Output Sts
     C                     MOVEL*BLANK    WUWTST  4
      * Define work field PRT Night Queue Run Sts
     C                     MOVEL*BLANK    WUWUST  1
      * Define work field PRT Night Queue
     C                     MOVEL*BLANK    WUBVVN 10
      * Define work field System Value Numeric
     C                     Z-ADD*ZERO     WUM8NB 155
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0003 10
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  2
     C                     MOVEL*BLANK    WL0020  2
     C                     MOVEL*BLANK    WL0021  2
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027 30
     C                     MOVEL*BLANK    WL0028 30
     C                     MOVEL*BLANK    WL0029 30
     C                     MOVEL*BLANK    WL0030 30
     C                     MOVEL*BLANK    WL0031 20
     C                     MOVEL*BLANK    WL0032  2
     C                     MOVEL*BLANK    WL0033 11
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035  50
     C                     Z-ADD*ZERO     WL0036  92
     C                     Z-ADD*ZERO     WL0037  92
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0038  70
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  1
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  70
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0045 10
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047 10
     C                     MOVEL*BLANK    WL0048  3
     C                     Z-ADD*ZERO     WL0049  30
     C                     MOVEL*BLANK    WL0050 10
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0051 10
     C                     MOVEL*BLANK    WL0052  6
     C                     Z-ADD*ZERO     WL0053  30
     C                     MOVEL*BLANK    WL0054  3
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0055  3
     C                     Z-ADD*ZERO     WL0056  30
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058  1
      * Define local variables for subroutine TDRVGN.
     C                     Z-ADD*ZERO     WL0059  30
     C                     MOVEL*BLANK    WL0060  6
     C                     MOVEL*BLANK    WL0061  1
     C                     MOVEL*BLANK    WL0062  1
      * Define local variables for subroutine TJCHRC.
     C                     Z-ADD*ZERO     WL0063  30
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065  30
     C                     Z-ADD*ZERO     WL0066  30
     C                     Z-ADD*ZERO     WL0067 112
      * Define local variables for subroutine TURVGN.
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  50
     C                     Z-ADD*ZERO     WL0070  70
     C                     Z-ADD*ZERO     WL0071  50
      * Define local work field Pallets Loaded
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YL0002  92
      * Define local work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YL0003  92
      * Define local work field Order Quantity
     C                     Z-ADD*ZERO     YL0004 112
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Total Load Miles
     C                     Z-ADD*ZERO     YN0002  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Plant Floor System USR
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0011  1
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0003  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0013  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0016  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0004 10
      * Define local work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0018  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0019  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD08        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Change Log
     C                     EXSR UFSUBR                     Change Log
     C                     Z-ADD999999    W0SLM            *Scan limit
      *
     C                     MOVEL*BLANK    WN0830 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0830           User Profile Na
      *
     C                     MOVEL*BLANK    WN0831 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0830    WL0045    P      User Profile Na
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0046    P1I6ST    P      Allow Multi-Com
     C                     MOVELWL0047    P1MPNA    P      Default Printer
     C                     MOVELWL0048    P1BCCD    P      Salesperson Cod
     C                     Z-ADDWL0049    YL0018           Company Number
     C                     MOVELWL0050    WN0831    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0830    ZA0067           User Profile Na
     C                     MOVEL'OMS'     ZA0068           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0831    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0830    WL0051    P      User Profile Na
     C                     MOVEL'OMS'     WL0052    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    P1AIC3           Company Number
     C                     MOVELWL0054    YL0019    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0831    WL0051    P      User Profile Na
     C                     MOVEL'OMS'     WL0052    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0053    P1AIC3           Company Number
     C                     MOVELWL0054    YL0019    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0019    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0830    ZA0069           User Profile Na
     C                     MOVEL'OMS'     ZA0070           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0018    IFNE 0                          *IF
     C                     Z-ADDYL0018    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0019    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0065  3        Warehouse Code
     C                     PARM YL0018    WQ0066  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR NBRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
     C                     EXSR NDRVGN
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     MOVEL'*YES'    P3XFST           Display Prt Opt
     C                     MOVEL'Y'       P3E7ST           USR Print Detai
     C                     MOVEL'Y'       P1TAST           First Time Flag
     C                     MOVEL##JOB     P5B2VN           Job Name CDE
     C                     Z-ADD9         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST##JOB:ZQ  P7A0NA    P  90  Job Name
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           P7A0NA    CAT  'P':ZQ    P7A0NA    P      Job Name
     C                     MOVEL'N'       P2HWSX           Change Flag USR
     C                     MOVEL'1'       ZZSFM            *Subfile mode
      * RMC PFS017  Check company value to see if the Unlock when picked
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0067  30       Company Number
     C                     PARM @CN,008   WQ0068 10        Company Value C
     C           WUZUSX    PARM *BLANK    WQ0069 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01050010570130601313017940208402821
02829028380284702852028540285902866
02875028780289102895030740307703085
03094031030310803110031150312203131
03134031470315103359
** W0END
01052010860130801342018710208602827
02836028450285002852028570286402873
02876028890289302895030750308303092
03101031060310803113031200312903132
03145031490315103366
** W0NAM
V2AIC3    #CADTX    #CCPCD    #CO6NA    #2ST1     #CVQCD    #2RMNB
V2AODT    V2EIDT    #CG0NX    #2PKST    #CG1NX    #CG2NX    #CLINA
#2DBCD    #CS2TX    #2BZNA    #CB8ST    #1SEL     #1RMNB    V1AODT
V1EIDT    #RG0NX    #1PKST    #RG1NX    #RG2NX    #RLINA    #RV9CD
#RS2TX    #1BZNA    #RB8ST    V1P1DT
** @CN
00001 Y2U0003
00002 USR0752
00003 Y2U0005
00004 PLTFLRSYS
00005 PDIZPCLP
00006 Auto Print Prelim. Pick
00007 PDSNPFR
00008 ALLOWUNLCK
