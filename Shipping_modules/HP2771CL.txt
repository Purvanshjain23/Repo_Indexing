/***************************************************************** */
/*                                                                 */
/*  Program Number:  HP2771CL  - DRIVER CL TO SUBMIT HP277CL       */
/*  Program Name:    Driver CL for writing scheduled movements     */
/*                   into HPS from the LoadSchedule app on the     */
/*                   Izone.                                        */
/*  Programmer:      Barb Gutierrez                                */
/*  Create Date:     08/19/21                                      */
/*                                                                 */
/*  Function:        This CL is called from sequel server. It      */
/*                   will set the library list based on the user   */
/*                   profile running the process and then execute  */
/*                   HP277CL.                                      */
/*                                                                 */
/*******************************************************************/
/*  MODIFIED BY     BARB GUTIERREZ   12/14/21                      */
/*                   CHANGED INCOMING PARM TO CHARACTER TO FIX     */
/*                   ISSUE COMING FROM A LINKED SERVER IN THE      */
/*                   INTERFACE AND PASS THE CHARACTER VALUE INTO  */
/*                   THE SUBMITTED CL HP277CL.                     */
/*                   PROJECT SDN616.                               */
/*  MODIFIED BY     BARB GUTIERREZ   02/10/22                      */
/*                   ADDED QGPL QUALIFIER TO JOBD.                 */
/*                                                                 */
/*******************************************************************/

             PGM        PARM(&CYYMMDDC)

             DCL        VAR(&CYYMMDDC) TYPE(*CHAR) LEN(7)
             DCL        VAR(&CYYMMDD) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&GRPPRF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&JOBD) TYPE(*CHAR) LEN(10)

             CHGJOB     LOG(4 99 *SECLVL) LOGCLPGM(*YES)

/*-------------------------------------------------------------------*/
/*  Set Jobd and library list based on user's group profile                   */
/*-------------------------------------------------------------------*/
             RTVUSRPRF  GRPPRF(&GRPPRF)

/* Set library list                                                 */
             IF         COND(&GRPPRF *EQ 'SBDPGMR') THEN(DO)
             CHGVAR VAR(&JOBD) VALUE('TPMTESTJD')
             ENDDO

             IF         COND(&GRPPRF *NE 'SBDPGMR') THEN(DO)
             CHGVAR VAR(&JOBD) VALUE('PRKPRDGUY')
             ENDDO

/*           SBMJOB     CMD(CALL PGM(HP277CL) PARM(&CYYMMDD)) +
                          JOB(HP277CL) JOBD(&JOBD) INLLIBL(*JOBD) +
                          HOLD(*YES)            */

             SBMJOB     CMD(CALL PGM(HP277CL) PARM(&CYYMMDDC)) +
                          JOB(HP277CL) JOBD(QGPL/&JOBD) INLLIBL(*JOBD)
             ENDPGM

