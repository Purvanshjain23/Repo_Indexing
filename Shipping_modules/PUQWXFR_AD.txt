// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PUQWXFR
// ?Date: 14.08.2025 Time: 03:51:07
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?RMC 4/17/20 R16455
//?Run from job sched to set up orders for EMAIL in case any new ship tos
//? customers have been set up with SH-BOL
EXECUTE FUNCTION(RTV CNV Ords SH-BOL  RT) TYPE(RTVOBJ) FILE(PNF7REP)            AC2183979;
PARAMETER('SH-BOL');
{
 //?USER: Process Data record

 CASE;

 // IF DB1.Distribution Code is Shipping Bill of Lading
 IF DB1.Distribution_Code = 'SH-BOL';

 // AND DB1.Record Status is Active
 AND DB1.Record_Status = 'A';

 EXECUTE FUNCTION(RTV Cust OO -SH-BOL cnvRT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC2183980;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER('Y');
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Header Status is Not closed or cancelled
  IF DB1.Header_Status = 'L'/'A'/'R'/'E'/'H';

  EXECUTE FUNCTION(RTV Chg for Email BOL RT) TYPE(RTVOBJ) FILE(PMAMREP)           AC2183954;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(PAR.OHE_Email_BOL_Sent);
  {
   //?USER: Process Data record

   CASE;

   // IF PAR.OHE Email BOL/Sent is Do not need to Send
   IF PAR.OHE_Email_BOL_Sent = *BLANK;

   //?blank it out if it was to be sent for cust, but now changed to No
   CASE;

   // IF DB1.OHE Email BOL/Sent is Need to Send
   IF DB1.OHE_Email_BOL_Sent = 'Y';

   EXECUTE FUNCTION(CHG OHE Email BOL      CH) TYPE(CHGOBJ) FILE(PMAMREP)          AC2183955;
   PARAMETER(PAR.Company_Number);
   PARAMETER(PAR.Order_Number);
   PARAMETER(PAR.OHE_Email_BOL_Sent);
   {
    //?USER: Processing before Data update

    // DB1.Job Time = JOB.*Job time
    DB1.Job_Time = JOB.*Job_time;

    // DB1.Job Date = JOB.*Job date
    DB1.Job_Date = JOB.*Job_date;

    // DB1.Job Name = JOB.*PROGRAM
    DB1.Job_Name = JOB.*PROGRAM;

    // DB1.User Id = JOB.*USER
    DB1.User_Id = JOB.*USER;

   }

   ENDIF;

   ENDIF;

   CASE;

   // IF PAR.OHE Email BOL/Sent is Need to Send
   IF PAR.OHE_Email_BOL_Sent = 'Y';

   //?upd to Y if it now needs to be sent
   CASE;

   // IF DB1.OHE Email BOL/Sent is Do not need to Send
   IF DB1.OHE_Email_BOL_Sent = *BLANK;

   EXECUTE FUNCTION(CHG OHE Email BOL      CH) TYPE(CHGOBJ) FILE(PMAMREP)          AC2183955;
   PARAMETER(PAR.Company_Number);
   PARAMETER(PAR.Order_Number);
   PARAMETER(PAR.OHE_Email_BOL_Sent);
   {
    //?USER: Processing before Data update

    // DB1.Job Time = JOB.*Job time
    DB1.Job_Time = JOB.*Job_time;

    // DB1.Job Date = JOB.*Job date
    DB1.Job_Date = JOB.*Job_date;

    // DB1.Job Name = JOB.*PROGRAM
    DB1.Job_Name = JOB.*PROGRAM;

    // DB1.User Id = JOB.*USER
    DB1.User_Id = JOB.*USER;

   }

   ENDIF;

   ENDIF;

   CASE;

   // IF PAR.OHE Email BOL/Sent is Sent
   IF PAR.OHE_Email_BOL_Sent = 'S';

   //?upd to S if it Needed to be sent
   CASE;

   // IF DB1.OHE Email BOL/Sent is Need to Send
   IF DB1.OHE_Email_BOL_Sent = 'Y';

   // OR DB1.OHE Email BOL/Sent is Do not need to Send
   OR DB1.OHE_Email_BOL_Sent = *BLANK;

   EXECUTE FUNCTION(CHG OHE Email BOL      CH) TYPE(CHGOBJ) FILE(PMAMREP)          AC2183955;
   PARAMETER(PAR.Company_Number);
   PARAMETER(PAR.Order_Number);
   PARAMETER(PAR.OHE_Email_BOL_Sent);
   {
    //?USER: Processing before Data update

    // DB1.Job Time = JOB.*Job time
    DB1.Job_Time = JOB.*Job_time;

    // DB1.Job Date = JOB.*Job date
    DB1.Job_Date = JOB.*Job_date;

    // DB1.Job Name = JOB.*PROGRAM
    DB1.Job_Name = JOB.*PROGRAM;

    // DB1.User Id = JOB.*USER
    DB1.User_Id = JOB.*USER;

   }

   ENDIF;

   ENDIF;

   CASE;

   // IF PAR.OHE Email BOL/Sent is Processing
   IF PAR.OHE_Email_BOL_Sent = 'P';

   //?upd to S if it Needed to be sent
   CASE;

   // IF DB1.OHE Email BOL/Sent is Need to Send
   IF DB1.OHE_Email_BOL_Sent = 'Y';

   // OR DB1.OHE Email BOL/Sent is Do not need to Send
   OR DB1.OHE_Email_BOL_Sent = *BLANK;

   EXECUTE FUNCTION(CHG OHE Email BOL      CH) TYPE(CHGOBJ) FILE(PMAMREP)          AC2183955;
   PARAMETER(PAR.Company_Number);
   PARAMETER(PAR.Order_Number);
   PARAMETER(PAR.OHE_Email_BOL_Sent);
   {
    //?USER: Processing before Data update

    // DB1.Job Time = JOB.*Job time
    DB1.Job_Time = JOB.*Job_time;

    // DB1.Job Date = JOB.*Job date
    DB1.Job_Date = JOB.*Job_date;

    // DB1.Job Name = JOB.*PROGRAM
    DB1.Job_Name = JOB.*PROGRAM;

    // DB1.User Id = JOB.*USER
    DB1.User_Id = JOB.*USER;

   }

   ENDIF;

   ENDIF;

  }

  ENDIF;

 }

 ENDIF;

}


