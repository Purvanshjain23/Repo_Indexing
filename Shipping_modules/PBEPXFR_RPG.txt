     H/TITLE Exc Email Ord RqDtChg XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 08/03/12  Time  : 10:14:35
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WAAIC3
     I              KMV8CD                          WAV8CD
     I              KMAUNA                          WAAUNA
     I              KMI5ST                          WAI5ST
     I              KMBXTX                          WABXTX
     I              KMM8NB                          WAM8NB
     I              KMUVST                          WAUVST
     I              KMUWST                          WAUWST
     I              KMUXST                          WAUXST
     I              KMVSST                          WAVSST
     I              KMAATM                          WAAATM
     I              KMAYNA                          WAAYNA
     I              KMA0NA                          WAA0NA
     I              KMAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  Order Number
     I                                    P   1   40P2C4NB
     IP3PARM      DS
      * I :  Sales Route Code
     I                                        1   3 P3R4CD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2C4NB    PARM           WP0002  70       Order Number
     C           P3R4CD    PARM           WP0003  3        Sales Route Cod
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Email Ord RqDtChg XF
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Sales Route Code is EQ 470
      *   |- c2    : PAR.Sales Route Code is EQ 510
      *   '-
     C           P3R4CD    IFEQ '470'                      *IF
     C           P3R4CD    OREQ '510'                      *OR
     C                     MOVEL@CN,001   YL0001           Company Value C
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SARVGN
      * CASE: LCL.System Value Alpha is Not equal to Blank
     C           YL0002    IFNE *BLANK                     *IF
      * RTV All Fields         RT - Order Header TRG  * 
     C                     EXSR SBRVGN
     C           WUAFTM    MULT 100       WUBCTM           Requested Deliv
      * SND Sales Admin OrdChgUP - Order Header TRG  * 
     C                     CALL 'PBEQUPC'              90  SND Sales Admin
     C                     PARM YL0003    WQ0001  7        Return Code Usr
     C                     PARM P2C4NB    WQ0002  70       Order Number
     C                     PARM WUEIDT    WQ0003  70       Requested Deliv
     C                     PARM WURMNB    WQ0004  70       Load ID
     C                     PARM WUBCTM    WQ0005  60       Requested Deliv
     C                     PARM YL0002    WQ0006 40        Distr List Usr
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBEQUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     MOVELYL0001    WAV8CD           Company Value C
      * Establish starting position
     C           KRSSA     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,002   W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABXTX    YL0002           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV All Fields         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP2C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUJNCD           Order Type - Sa
     C                     Z-ADD*ZERO     WUANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WUBKC7           Ship To Custome
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHMNA           Ship To Address
     C                     MOVEL*BLANK    WUHONA           Ship To Address
     C                     MOVEL*BLANK    WUHPNA           Ship To Address
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     MOVEL*BLANK    WUDBCD           Ship To State C
     C                     MOVEL*BLANK    WUCKTX           Ship To Zip/Pos
     C                     Z-ADD*ZERO     WUB0C7           Bill to Custome
     C                     MOVEL*BLANK    WUAETX           Bill to Name
     C                     MOVEL*BLANK    WUB1NA           Bill to Address
     C                     MOVEL*BLANK    WUB3NA           Bill to Address
     C                     MOVEL*BLANK    WUB4NA           Bill to Address
     C                     MOVEL*BLANK    WUB2NA           Bill to City
     C                     MOVEL*BLANK    WUBHCD           Bill to State C
     C                     MOVEL*BLANK    WUC8TX           Bill to Zip/Pos
     C                     MOVEL*BLANK    WUBCNA           Customer Purcha
     C                     Z-ADD*ZERO     WUA0DT           Order Date
     C                     Z-ADD*ZERO     WUA5DT           Requested Ship
     C                     Z-ADD*ZERO     WUGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WUACDT           Cancel Date
     C                     MOVEL*BLANK    WUAQCD           Terms Code
     C                     MOVEL*BLANK    WUB6NA           Special Instruc
     C                     MOVEL*BLANK    WUBYNA           Special Instruc
     C                     MOVEL*BLANK    WUBZNA           Carrier Code
     C                     MOVEL*BLANK    WUGTST           Comment Print A
     C                     MOVEL*BLANK    WUGVST           Comment Print I
     C                     MOVEL*BLANK    WUGUST           Comment Print P
     C                     MOVEL*BLANK    WUQFST           Comment Print S
     C                     MOVEL*BLANK    WUCQCD           Reason Code
     C                     MOVEL*BLANK    WUGJST           Order in Use
     C                     MOVEL*BLANK    WUGWST           Header Status
     C                     MOVEL*BLANK    WUGXST           Header Status L
     C                     MOVEL*BLANK    WUGYST           Order Type Prin
     C                     Z-ADD*ZERO     WUAODT           Scheduled Ship
     C                     MOVEL*BLANK    WUAIVN           User Original E
     C                     Z-ADD*ZERO     WUCXDT           Date of Origina
     C                     Z-ADD*ZERO     WUJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WUA1WG           Order Weight To
     C                     MOVEL*BLANK    WUXIST           Credit Hold
     C                     MOVEL*BLANK    WUXJST           Production Hold
     C                     MOVEL*BLANK    WUXKST           New Customer Ho
     C                     Z-ADD*ZERO     WUEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WUAFTM           Requested Deliv
     C                     MOVEL*BLANK    WUE8CD           Accounts Receiv
     C                     MOVEL*BLANK    WUE9CD           Accounts Receiv
     C                     Z-ADD*ZERO     WURMNB           Load ID
     C                     Z-ADD*ZERO     WUTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WUR1NB           Rated Freight
     C                     MOVEL*BLANK    WUPJST           LTL Flag
     C                     MOVEL*BLANK    WUU0ST           Price Audit
     C                     MOVEL*BLANK    WUU1ST           Price Status
     C                     MOVEL*BLANK    WUQ2CD           Shipping Method
     C                     MOVEL*BLANK    WUU2ST           Export Status
     C                     MOVEL*BLANK    WUVEST           Palletize
     C                     MOVEL*BLANK    WUVFST           Shrink Wrap
     C                     MOVEL*BLANK    WUVGST           Slip Sheet
     C                     MOVEL*BLANK    WURPCD           Age Code
     C                     Z-ADD*ZERO     WURNNB           Reefer Temperat
     C                     MOVEL*BLANK    WUVDST           Load Type
     C                     Z-ADD*ZERO     WUATIN           Attach to Invoi
     C                     MOVEL*BLANK    WUU4ST           Load Plan Order
     C                     MOVEL*BLANK    WUU5ST           Print Pick Slip
     C                     Z-ADD*ZERO     WURSRN           Resell Referenc
     C                     MOVEL*BLANK    WUMHNA           Special Comment
     C                     MOVEL*BLANK    WUMINA           Special Comment
     C                     MOVEL*BLANK    WUWBST           Affect Auto Acc
     C                     MOVEL*BLANK    WUR4CD           Sales Route Cod
     C                     MOVEL*BLANK    WUBFCD           Manager Level C
     C                     MOVEL*BLANK    WUQ4CD           VP Level Code
     C                     Z-ADD*ZERO     WUT3NB           Attach to Order
     C                     MOVEL*BLANK    WUSICD           Reason for Pric
     C                     Z-ADD*ZERO     WUCONB           Invoice Number
     C                     MOVEL*BLANK    WUCEST           Invoice Suffix
     C                     Z-ADD*ZERO     WUAWDT           Invoice Date
     C                     MOVEL*BLANK    WUJPCD           Event Code
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL*BLANK    WUZ1ST           Modified Flag
     C                     Z-ADD*ZERO     WUVRVA           A/R order Value
     C                     MOVEL*BLANK    WUOBST           Billing Activit
     C                     MOVEL*BLANK    WUBCST           Block Order Fla
     C                     MOVEL*BLANK    WUBDST           Order Certifica
     C                     Z-ADD*ZERO     WUB7VL           Invoice Order V
     C                     MOVEL*BLANK    WUGASX           Process Sts for
     C                     MOVEL*BLANK    WUGBSX           Order Conf Fax
     C                     MOVEL*BLANK    WUGCSX           Manifest Fax St
     C                     MOVEL*BLANK    WUGDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    WUFNSX           Transfer in Sto
     C                     MOVEL*BLANK    WUFOSX           Email Cust On O
     C                     MOVEL*BLANK    WUFPSX           Order Emailed
     C                     MOVEL*BLANK    WUFQSX           Export Docs Go
     C                     MOVEL*BLANK    WUFRSX           Shipping Temp C
     C                     MOVEL*BLANK    WUFSSX           Broker Order St
     C                     MOVEL*BLANK    WUFTSX           Air Freight Ord
     C                     MOVEL*BLANK    WUFUSX           Order Requires
     C                     MOVEL*BLANK    WUFVSX           EDI Nistevo Sel
     C                     MOVEL*BLANK    WUFWSX           Export USDA App
     C                     MOVEL*BLANK    WUFXSX           HPB Ship to War
     C                     MOVEL*BLANK    WUFYSX           OH TF Exempt Co
     C                     Z-ADD*ZERO     WUNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WUNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WUNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WUNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WUNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WUBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WUBQTM           Time of Origina
     C                     Z-ADD*ZERO     WUBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WUBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WUBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WUH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WUH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WUH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WUH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WUH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WUC0C7           Claim Number
     C                     MOVEL*BLANK    WUUVST           EDI Status 1
     C                     MOVEL*BLANK    WUUWST           EDI Status 2
     C                     MOVEL*BLANK    WUUXST           EDI Status 3
     C                     Z-ADD*ZERO     WUAATM           Job Time
     C                     MOVEL*BLANK    WUAYNA           User Id
     C                     MOVEL*BLANK    WUA0NA           Job Name
     C                     Z-ADD*ZERO     WUAXDT           Job Date
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJNCD    WUJNCD           Order Type - Sa
     C                     Z-ADDWBANC7    WUANC7           A/R Customer Nu
     C                     Z-ADDWBBKC7    WUBKC7           Ship To Custome
     C                     MOVELWBBRTX    WUBRTX           Ship To Name
     C                     MOVELWBHMNA    WUHMNA           Ship To Address
     C                     MOVELWBHONA    WUHONA           Ship To Address
     C                     MOVELWBHPNA    WUHPNA           Ship To Address
     C                     MOVELWBHNNA    WUHNNA           Ship To City
     C                     MOVELWBDBCD    WUDBCD           Ship To State C
     C                     MOVELWBCKTX    WUCKTX           Ship To Zip/Pos
     C                     Z-ADDWBB0C7    WUB0C7           Bill to Custome
     C                     MOVELWBAETX    WUAETX           Bill to Name
     C                     MOVELWBB1NA    WUB1NA           Bill to Address
     C                     MOVELWBB3NA    WUB3NA           Bill to Address
     C                     MOVELWBB4NA    WUB4NA           Bill to Address
     C                     MOVELWBB2NA    WUB2NA           Bill to City
     C                     MOVELWBBHCD    WUBHCD           Bill to State C
     C                     MOVELWBC8TX    WUC8TX           Bill to Zip/Pos
     C                     MOVELWBBCNA    WUBCNA           Customer Purcha
     C                     Z-ADDWBA0DT    WUA0DT           Order Date
     C                     Z-ADDWBA5DT    WUA5DT           Requested Ship
     C                     Z-ADDWBGNDT    WUGNDT           Actual Shipped
     C                     Z-ADDWBACDT    WUACDT           Cancel Date
     C                     MOVELWBAQCD    WUAQCD           Terms Code
     C                     MOVELWBB6NA    WUB6NA           Special Instruc
     C                     MOVELWBBYNA    WUBYNA           Special Instruc
     C                     MOVELWBBZNA    WUBZNA           Carrier Code
     C                     MOVELWBGTST    WUGTST           Comment Print A
     C                     MOVELWBGVST    WUGVST           Comment Print I
     C                     MOVELWBGUST    WUGUST           Comment Print P
     C                     MOVELWBQFST    WUQFST           Comment Print S
     C                     MOVELWBCQCD    WUCQCD           Reason Code
     C                     MOVELWBGJST    WUGJST           Order in Use
     C                     MOVELWBGWST    WUGWST           Header Status
     C                     MOVELWBGXST    WUGXST           Header Status L
     C                     MOVELWBGYST    WUGYST           Order Type Prin
     C                     Z-ADDWBAODT    WUAODT           Scheduled Ship
     C                     MOVELWBAIVN    WUAIVN           User Original E
     C                     Z-ADDWBCXDT    WUCXDT           Date of Origina
     C                     Z-ADDWBJZVA    WUJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    WUA1WG           Order Weight To
     C                     MOVELWBXIST    WUXIST           Credit Hold
     C                     MOVELWBXJST    WUXJST           Production Hold
     C                     MOVELWBXKST    WUXKST           New Customer Ho
     C                     Z-ADDWBEIDT    WUEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    WUAFTM           Requested Deliv
     C                     MOVELWBE8CD    WUE8CD           Accounts Receiv
     C                     MOVELWBE9CD    WUE9CD           Accounts Receiv
     C                     Z-ADDWBRMNB    WURMNB           Load ID
     C                     Z-ADDWBTBNB    WUTBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    WUR1NB           Rated Freight
     C                     MOVELWBPJST    WUPJST           LTL Flag
     C                     MOVELWBU0ST    WUU0ST           Price Audit
     C                     MOVELWBU1ST    WUU1ST           Price Status
     C                     MOVELWBQ2CD    WUQ2CD           Shipping Method
     C                     MOVELWBU2ST    WUU2ST           Export Status
     C                     MOVELWBVEST    WUVEST           Palletize
     C                     MOVELWBVFST    WUVFST           Shrink Wrap
     C                     MOVELWBVGST    WUVGST           Slip Sheet
     C                     MOVELWBRPCD    WURPCD           Age Code
     C                     Z-ADDWBRNNB    WURNNB           Reefer Temperat
     C                     MOVELWBVDST    WUVDST           Load Type
     C                     Z-ADDWBATIN    WUATIN           Attach to Invoi
     C                     MOVELWBU4ST    WUU4ST           Load Plan Order
     C                     MOVELWBU5ST    WUU5ST           Print Pick Slip
     C                     Z-ADDWBRSRN    WURSRN           Resell Referenc
     C                     MOVELWBMHNA    WUMHNA           Special Comment
     C                     MOVELWBMINA    WUMINA           Special Comment
     C                     MOVELWBWBST    WUWBST           Affect Auto Acc
     C                     MOVELWBR4CD    WUR4CD           Sales Route Cod
     C                     MOVELWBBFCD    WUBFCD           Manager Level C
     C                     MOVELWBQ4CD    WUQ4CD           VP Level Code
     C                     Z-ADDWBT3NB    WUT3NB           Attach to Order
     C                     MOVELWBSICD    WUSICD           Reason for Pric
     C                     Z-ADDWBCONB    WUCONB           Invoice Number
     C                     MOVELWBCEST    WUCEST           Invoice Suffix
     C                     Z-ADDWBAWDT    WUAWDT           Invoice Date
     C                     MOVELWBJPCD    WUJPCD           Event Code
     C                     MOVELWBXUST    WUXUST           Trans Contol AS
     C                     MOVELWBZ1ST    WUZ1ST           Modified Flag
     C                     Z-ADDWBVRVA    WUVRVA           A/R order Value
     C                     MOVELWBOBST    WUOBST           Billing Activit
     C                     MOVELWBBCST    WUBCST           Block Order Fla
     C                     MOVELWBBDST    WUBDST           Order Certifica
     C                     Z-ADDWBB7VL    WUB7VL           Invoice Order V
     C                     MOVELWBGASX    WUGASX           Process Sts for
     C                     MOVELWBGBSX    WUGBSX           Order Conf Fax
     C                     MOVELWBGCSX    WUGCSX           Manifest Fax St
     C                     MOVELWBGDSX    WUGDSX           Invoice Fax Sts
     C                     MOVELWBFNSX    WUFNSX           Transfer in Sto
     C                     MOVELWBFOSX    WUFOSX           Email Cust On O
     C                     MOVELWBFPSX    WUFPSX           Order Emailed
     C                     MOVELWBFQSX    WUFQSX           Export Docs Go
     C                     MOVELWBFRSX    WUFRSX           Shipping Temp C
     C                     MOVELWBFSSX    WUFSSX           Broker Order St
     C                     MOVELWBFTSX    WUFTSX           Air Freight Ord
     C                     MOVELWBFUSX    WUFUSX           Order Requires
     C                     MOVELWBFVSX    WUFVSX           EDI Nistevo Sel
     C                     MOVELWBFWSX    WUFWSX           Export USDA App
     C                     MOVELWBFXSX    WUFXSX           HPB Ship to War
     C                     MOVELWBFYSX    WUFYSX           OH TF Exempt Co
     C                     Z-ADDWBNODT    WUNODT           OH Appt Confirm
     C                     Z-ADDWBNPDT    WUNPDT           JPN Invoice Iss
     C                     Z-ADDWBNQDT    WUNQDT           OH Unused Date
     C                     Z-ADDWBNRDT    WUNRDT           OH Unused Date
     C                     Z-ADDWBNSDT    WUNSDT           OH Unused Date
     C                     Z-ADDWBBPTM    WUBPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    WUBQTM           Time of Origina
     C                     Z-ADDWBBRTM    WUBRTM           OH Appt Confirm
     C                     Z-ADDWBBSTM    WUBSTM           OH Unused Time
     C                     Z-ADDWBBTTM    WUBTTM           OH Unused Time
     C                     Z-ADDWBH0NX    WUH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    WUH1NX           Act Non-Ref Frt
     C                     Z-ADDWBH2NX    WUH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    WUH3NX           OH Total Non-Re
     C                     Z-ADDWBH4NX    WUH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    WUC0C7           Claim Number
     C                     MOVELWBUVST    WUUVST           EDI Status 1
     C                     MOVELWBUWST    WUUWST           EDI Status 2
     C                     MOVELWBUXST    WUUXST           EDI Status 3
     C                     Z-ADDWBAATM    WUAATM           Job Time
     C                     MOVELWBAYNA    WUAYNA           User Id
     C                     MOVELWBA0NA    WUA0NA           Job Name
     C                     Z-ADDWBAXDT    WUAXDT           Job Date
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAM8NB           System Value Nu
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Order Type - Sales
     C                     MOVEL*BLANK    WUJNCD  2
      * Define work field A/R Customer Number
     C                     Z-ADD*ZERO     WUANC7  70
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To Address Line 1
     C                     MOVEL*BLANK    WUHMNA 30
      * Define work field Ship To Address Line 2
     C                     MOVEL*BLANK    WUHONA 30
      * Define work field Ship To Address Line 3
     C                     MOVEL*BLANK    WUHPNA 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Ship To State Code
     C                     MOVEL*BLANK    WUDBCD  2
      * Define work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    WUCKTX 11
      * Define work field Bill to Customer
     C                     Z-ADD*ZERO     WUB0C7  70
      * Define work field Bill to Name
     C                     MOVEL*BLANK    WUAETX 30
      * Define work field Bill to Address Line 1
     C                     MOVEL*BLANK    WUB1NA 30
      * Define work field Bill to Address Line 2
     C                     MOVEL*BLANK    WUB3NA 30
      * Define work field Bill to Address Line 3
     C                     MOVEL*BLANK    WUB4NA 30
      * Define work field Bill to City
     C                     MOVEL*BLANK    WUB2NA 20
      * Define work field Bill to State Code
     C                     MOVEL*BLANK    WUBHCD  2
      * Define work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    WUC8TX 11
      * Define work field Customer Purchase Order #
     C                     MOVEL*BLANK    WUBCNA 15
      * Define work field Order Date
     C                     Z-ADD*ZERO     WUA0DT  70
      * Define work field Requested Ship Date
     C                     Z-ADD*ZERO     WUA5DT  70
      * Define work field Actual Shipped Date
     C                     Z-ADD*ZERO     WUGNDT  70
      * Define work field Cancel Date
     C                     Z-ADD*ZERO     WUACDT  70
      * Define work field Terms Code
     C                     MOVEL*BLANK    WUAQCD  2
      * Define work field Special Instructions
     C                     MOVEL*BLANK    WUB6NA 40
      * Define work field Special Instructions 2
     C                     MOVEL*BLANK    WUBYNA 40
      * Define work field Carrier Code
     C                     MOVEL*BLANK    WUBZNA  3
      * Define work field Comment Print Acknowledge
     C                     MOVEL*BLANK    WUGTST  1
      * Define work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    WUGVST  1
      * Define work field Comment Print Pick Slip
     C                     MOVEL*BLANK    WUGUST  1
      * Define work field Comment Print Ship Doc
     C                     MOVEL*BLANK    WUQFST  1
      * Define work field Reason Code
     C                     MOVEL*BLANK    WUCQCD  3
      * Define work field Order in Use
     C                     MOVEL*BLANK    WUGJST  1
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Header Status Last
     C                     MOVEL*BLANK    WUGXST  1
      * Define work field Order Type Print Status
     C                     MOVEL*BLANK    WUGYST  1
      * Define work field Scheduled Ship Date
     C                     Z-ADD*ZERO     WUAODT  70
      * Define work field User Original Entry
     C                     MOVEL*BLANK    WUAIVN 10
      * Define work field Date of Original Entry
     C                     Z-ADD*ZERO     WUCXDT  70
      * Define work field Order Value Total
     C                     Z-ADD*ZERO     WUJZVA 112
      * Define work field Order Weight Total
     C                     Z-ADD*ZERO     WUA1WG 112
      * Define work field Credit Hold
     C                     MOVEL*BLANK    WUXIST  1
      * Define work field Production Hold
     C                     MOVEL*BLANK    WUXJST  1
      * Define work field New Customer Hold
     C                     MOVEL*BLANK    WUXKST  1
      * Define work field Requested Delivery Date
     C                     Z-ADD*ZERO     WUEIDT  70
      * Define work field Requested Delivery Time
     C                     Z-ADD*ZERO     WUAFTM  40
      * Define work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    WUE8CD  4
      * Define work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    WUE9CD 12
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Define work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     WUTBNB  52
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field LTL Flag
     C                     MOVEL*BLANK    WUPJST  1
      * Define work field Price Audit
     C                     MOVEL*BLANK    WUU0ST  1
      * Define work field Price Status
     C                     MOVEL*BLANK    WUU1ST  1
      * Define work field Shipping Method
     C                     MOVEL*BLANK    WUQ2CD  2
      * Define work field Export Status
     C                     MOVEL*BLANK    WUU2ST  1
      * Define work field Palletize
     C                     MOVEL*BLANK    WUVEST  1
      * Define work field Shrink Wrap
     C                     MOVEL*BLANK    WUVFST  1
      * Define work field Slip Sheet
     C                     MOVEL*BLANK    WUVGST  1
      * Define work field Age Code
     C                     MOVEL*BLANK    WURPCD  1
      * Define work field Reefer Temperature
     C                     Z-ADD*ZERO     WURNNB  52
      * Define work field Load Type
     C                     MOVEL*BLANK    WUVDST  1
      * Define work field Attach to Invoice Number
     C                     Z-ADD*ZERO     WUATIN  70
      * Define work field Load Plan Order
     C                     MOVEL*BLANK    WUU4ST  1
      * Define work field Print Pick Slip
     C                     MOVEL*BLANK    WUU5ST  1
      * Define work field Resell Reference Number
     C                     Z-ADD*ZERO     WURSRN  70
      * Define work field Special Comment 1
     C                     MOVEL*BLANK    WUMHNA 30
      * Define work field Special Comment 2
     C                     MOVEL*BLANK    WUMINA 30
      * Define work field Affect Auto Accruals
     C                     MOVEL*BLANK    WUWBST  1
      * Define work field Sales Route Code
     C                     MOVEL*BLANK    WUR4CD  3
      * Define work field Manager Level Code
     C                     MOVEL*BLANK    WUBFCD  2
      * Define work field VP Level Code
     C                     MOVEL*BLANK    WUQ4CD  3
      * Define work field Attach to Order Number
     C                     Z-ADD*ZERO     WUT3NB  70
      * Define work field Reason for Price Audit
     C                     MOVEL*BLANK    WUSICD  3
      * Define work field Invoice Number
     C                     Z-ADD*ZERO     WUCONB  70
      * Define work field Invoice Suffix
     C                     MOVEL*BLANK    WUCEST  2
      * Define work field Invoice Date
     C                     Z-ADD*ZERO     WUAWDT  70
      * Define work field Event Code
     C                     MOVEL*BLANK    WUJPCD  2
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Modified Flag
     C                     MOVEL*BLANK    WUZ1ST  1
      * Define work field A/R order Value Total
     C                     Z-ADD*ZERO     WUVRVA 112
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field Block Order Flag
     C                     MOVEL*BLANK    WUBCST  1
      * Define work field Order Certification Flag
     C                     MOVEL*BLANK    WUBDST  1
      * Define work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     WUB7VL 112
      * Define work field Process Sts for 3C
     C                     MOVEL*BLANK    WUGASX  1
      * Define work field Order Conf Fax Sts
     C                     MOVEL*BLANK    WUGBSX  1
      * Define work field Manifest Fax Sts
     C                     MOVEL*BLANK    WUGCSX  1
      * Define work field Invoice Fax Sts
     C                     MOVEL*BLANK    WUGDSX  1
      * Define work field Transfer in Storage Ind
     C                     MOVEL*BLANK    WUFNSX  1
      * Define work field Email Cust On Order Ship
     C                     MOVEL*BLANK    WUFOSX  1
      * Define work field Order Emailed
     C                     MOVEL*BLANK    WUFPSX  1
      * Define work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    WUFQSX  1
      * Define work field Shipping Temp Code C/F
     C                     MOVEL*BLANK    WUFRSX  1
      * Define work field Broker Order Status
     C                     MOVEL*BLANK    WUFSSX  1
      * Define work field Air Freight Order
     C                     MOVEL*BLANK    WUFTSX  1
      * Define work field Order Requires Review
     C                     MOVEL*BLANK    WUFUSX  2
      * Define work field EDI Nistevo Select Sts
     C                     MOVEL*BLANK    WUFVSX  2
      * Define work field Export USDA Approved
     C                     MOVEL*BLANK    WUFWSX  2
      * Define work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    WUFXSX  3
      * Define work field OH TF Exempt Code
     C                     MOVEL*BLANK    WUFYSX  3
      * Define work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     WUNODT  70
      * Define work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     WUNPDT  70
      * Define work field OH Unused Date 3
     C                     Z-ADD*ZERO     WUNQDT  70
      * Define work field OH Unused Date 4
     C                     Z-ADD*ZERO     WUNRDT  70
      * Define work field OH Unused Date 5
     C                     Z-ADD*ZERO     WUNSDT  70
      * Define work field Maximum Gross Weight
     C                     Z-ADD*ZERO     WUBPTM  60
      * Define work field Time of Original Entry
     C                     Z-ADD*ZERO     WUBQTM  60
      * Define work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     WUBRTM  60
      * Define work field OH Unused Time 4
     C                     Z-ADD*ZERO     WUBSTM  60
      * Define work field OH Unused Time 5
     C                     Z-ADD*ZERO     WUBTTM  60
      * Define work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     WUH0NX 112
      * Define work field Act Non-Ref Frt Amount
     C                     Z-ADD*ZERO     WUH1NX 112
      * Define work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     WUH2NX 112
      * Define work field OH Total Non-Ref Frt Amt
     C                     Z-ADD*ZERO     WUH3NX 112
      * Define work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     WUH4NX 112
      * Define work field Claim Number
     C                     Z-ADD*ZERO     WUC0C7  70
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Define work field Job Time
     C                     Z-ADD*ZERO     WUAATM  60
      * Define work field User Id
     C                     MOVEL*BLANK    WUAYNA 10
      * Define work field Job Name
     C                     MOVEL*BLANK    WUA0NA 10
      * Define work field Job Date
     C                     Z-ADD*ZERO     WUAXDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Requested Deliv Time 6.0
     C                     Z-ADD*ZERO     WUBCTM  60
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Company Value Code
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0002 40
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0003  7
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 REQDELVDT
00002 Y2U0005
