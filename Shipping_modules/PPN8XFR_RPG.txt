     H/TITLE PFS Ship Status       XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 11/05/18  Time  : 13:25:40
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPBKCPL2IF  E           K        DISK
      * RTV : PFS Ship Load/Order Sts   Not Processed
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FPPBMCPL3IF  E           K        DISK
      * RSQ : PFS Ship Order Detail     Co/Ord/TDt/TTm/Seq PSts=
      *
     FPDL8CPL1IF  E           K        DISK
      * RTV : Order Inv Allocation      Retrieval index
      *
     FPPBLCPL4IF  E           K        DISK
      * RSQ : PFS Ship Load Header      Co/Ld/TDt(d)/TTm(d) PS=0
      *
     FPPBKCPL7IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Co/Ld/TD-d/TT-d PS=0
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOMFNCPL5IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord#/Seq/Seq2/PrdDte
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDL8CPL5IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FPDMSREL2IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FCAB7CPLNIF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/Order/Trans Sel ERR
      *
     FPPBMCPL4IF  E           K        DISK
      * RSQ : PFS Ship Order Detail     Co/Ord/TDt(d)/TTm(D) PS=
      *
     FOPEYCPL0UF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPPBKCPL0UF  E           K        DISK
      * UPD : PFS Ship Load/Order Sts   Update index
      *
     FPDL8CPL0UF  E           K        DISK
      * UPD : Order Inv Allocation      Update index
      *
     FPPBLCPL0UF  E           K        DISK
      * UPD : PFS Ship Load Header      Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FCAB1REL1UF  E           K        DISK
      * UPD : Item Balance Detail       Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPDMSREL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     FCAB7CPL0UF  E           K        DISK
      * UPD : Item Transaction Detail   Update index
      *
     FPPBMCPL0UF  E           K        DISK
      * UPD : PFS Ship Order Detail     Update index
      *
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BKCPA1
      * PFS Ship Load/Order Sts   Not Processed
      * Renamed input format fields
     I              BKY1NX                          WAY1NX
     I              BKAID8                          WAAID8
     I              BKAFTS                          WAAFTS
     I              BKBCNY                          WABCNY
     I              BKVRSX                          WAVRSX
     I              BKZGNX                          WAZGNX
     I              BKZPNX                          WAZPNX
     I              BKW0SX                          WAW0SX
     I              BKUWSX                          WAUWSX
     I              BKUXSX                          WAUXSX
     I              BKV3SX                          WAV3SX
     I              BKAHNY                          WAAHNY
     I              BKAINY                          WAAINY
     I              BKAJNY                          WAAJNY
     I              BKAKNY                          WAAKNY
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WFRMNB
     I              FLRUNB                          WFRUNB
     I              FLRVNB                          WFRVNB
     I              FLDQTX                          WFDQTX
     I              FLRWNB                          WFRWNB
     I              FLRXNB                          WFRXNB
     I              FLSQNB                          WFSQNB
     I              FLT0NB                          WFT0NB
     I              FLT1NB                          WFT1NB
     I              FLR1NB                          WFR1NB
     I              FLAIC3                          WFAIC3
     I              FLC4NB                          WFC4NB
     I              FLVCST                          WFVCST
     I              FLKEDT                          WFKEDT
     I              FLSXNB                          WFSXNB
     I              FLKFDT                          WFKFDT
     I              FLACTM                          WFACTM
     I              FLK5TX                          WFK5TX
     I              FLW5CD                          WFW5CD
     I              FLEJDT                          WFEJDT
     I              FLAGTM                          WFAGTM
     I              FLKJDT                          WFKJDT
     I              FLATTM                          WFATTM
     I              FLHDDT                          WFHDDT
     I              FLAUTM                          WFAUTM
     I              FLKKDT                          WFKKDT
     I              FLAVTM                          WFAVTM
     I              FLZ4NB                          WFZ4NB
     I              FLY7ST                          WFY7ST
     I              FLY2ST                          WFY2ST
     I              FLWHTX                          WFWHTX
     I              FLWITX                          WFWITX
     I              FLWJTX                          WFWJTX
     I              FLWKTX                          WFWKTX
     I              FLWLTX                          WFWLTX
     I              FLN7DT                          WFN7DT
     I              FLN8DT                          WFN8DT
     I              FLN9DT                          WFN9DT
     I              FLB3TM                          WFB3TM
     I              FLB4TM                          WFB4TM
     I              FLB5TM                          WFB5TM
     I              FLIASX                          WFIASX
     I              FLIBSX                          WFIBSX
     I              FLICSX                          WFICSX
     I              FLWVTX                          WFWVTX
     I              FLWWTX                          WFWWTX
     I              FLWXTX                          WFWXTX
     I              FLUVST                          WFUVST
     I              FLUWST                          WFUWST
     I              FLUXST                          WFUXST
     I              FLAATM                          WFAATM
     I              FLAYNA                          WFAYNA
     I              FLA0NA                          WFA0NA
     I              FLAXDT                          WFAXDT
      *
     I@EYCPZE
      * Order Events              Co/Order/Event Code
      * Renamed input format fields
     I              EYAIC3                          WGAIC3
     I              EYC4NB                          WGC4NB
     I              EYQ2NB                          WGQ2NB
     I              EYJPCD                          WGJPCD
     I              EYAUC3                          WGAUC3
     I              EYQ7NB                          WGQ7NB
     I              EYOMST                          WGOMST
     I              EYD2DT                          WGD2DT
     I              EYONST                          WGONST
     I              EYOOST                          WGOOST
     I              EYOPST                          WGOPST
     I              EYAWC3                          WGAWC3
     I              EYQ8NB                          WGQ8NB
     I              EYQ9NB                          WGQ9NB
     I              EYBKC7                          WGBKC7
     I              EYUVST                          WGUVST
     I              EYUWST                          WGUWST
     I              EYUXST                          WGUXST
     I              EYAATM                          WGAATM
     I              EYAYNA                          WGAYNA
     I              EYA0NA                          WGA0NA
     I              EYAXDT                          WGAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WHAIC3
     I              EYC4NB                          WHC4NB
     I              EYQ2NB                          WHQ2NB
     I              EYJPCD                          WHJPCD
     I              EYAUC3                          WHAUC3
     I              EYQ7NB                          WHQ7NB
     I              EYOMST                          WHOMST
     I              EYD2DT                          WHD2DT
     I              EYONST                          WHONST
     I              EYOOST                          WHOOST
     I              EYOPST                          WHOPST
     I              EYAWC3                          WHAWC3
     I              EYQ8NB                          WHQ8NB
     I              EYQ9NB                          WHQ9NB
     I              EYBKC7                          WHBKC7
     I              EYUVST                          WHUVST
     I              EYUWST                          WHUWST
     I              EYUXST                          WHUXST
     I              EYAATM                          WHAATM
     I              EYAYNA                          WHAYNA
     I              EYA0NA                          WHA0NA
     I              EYAXDT                          WHAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WIAIC3
     I              EYC4NB                          WIC4NB
     I              EYQ2NB                          WIQ2NB
     I              EYJPCD                          WIJPCD
     I              EYAUC3                          WIAUC3
     I              EYQ7NB                          WIQ7NB
     I              EYOMST                          WIOMST
     I              EYD2DT                          WID2DT
     I              EYONST                          WIONST
     I              EYOOST                          WIOOST
     I              EYOPST                          WIOPST
     I              EYAWC3                          WIAWC3
     I              EYQ8NB                          WIQ8NB
     I              EYQ9NB                          WIQ9NB
     I              EYBKC7                          WIBKC7
     I              EYUVST                          WIUVST
     I              EYUWST                          WIUWST
     I              EYUXST                          WIUXST
     I              EYAATM                          WIAATM
     I              EYAYNA                          WIAYNA
     I              EYA0NA                          WIA0NA
     I              EYAXDT                          WIAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WKAIC3
     I              KMV8CD                          WKV8CD
     I              KMAUNA                          WKAUNA
     I              KMI5ST                          WKI5ST
     I              KMBXTX                          WKBXTX
     I              KMM8NB                          WKM8NB
     I              KMUVST                          WKUVST
     I              KMUWST                          WKUWST
     I              KMUXST                          WKUXST
     I              KMVSST                          WKVSST
     I              KMAATM                          WKAATM
     I              KMAYNA                          WKAYNA
     I              KMA0NA                          WKA0NA
     I              KMAXDT                          WKAXDT
      *
     I@BKCPEK
      * PFS Ship Load/Order Sts   Load/Order Picked
      * Renamed input format fields
     I              BKY1NX                          WLY1NX
     I              BKAID8                          WLAID8
     I              BKAFTS                          WLAFTS
     I              BKBCNY                          WLBCNY
     I              BKVRSX                          WLVRSX
     I              BKZGNX                          WLZGNX
     I              BKZPNX                          WLZPNX
     I              BKW0SX                          WLW0SX
     I              BKUWSX                          WLUWSX
     I              BKUXSX                          WLUXSX
     I              BKV3SX                          WLV3SX
     I              BKAHNY                          WLAHNY
     I              BKAINY                          WLAINY
     I              BKAJNY                          WLAJNY
     I              BKAKNY                          WLAKNY
      *
     I@BKCPZU
      * PFS Ship Load/Order Sts   Update index
      * Renamed input format fields
     I              BKY1NX                          WMY1NX
     I              BKAID8                          WMAID8
     I              BKAFTS                          WMAFTS
     I              BKBCNY                          WMBCNY
     I              BKVRSX                          WMVRSX
     I              BKZGNX                          WMZGNX
     I              BKZPNX                          WMZPNX
     I              BKW0SX                          WMW0SX
     I              BKUWSX                          WMUWSX
     I              BKUXSX                          WMUXSX
     I              BKV3SX                          WMV3SX
     I              BKAHNY                          WMAHNY
     I              BKAINY                          WMAINY
     I              BKAJNY                          WMAJNY
     I              BKAKNY                          WMAKNY
      *
     I@BMCPDE
      * PFS Ship Order Detail     Co/Ord/TDt/TTm/Seq PSts=
      * Renamed input format fields
     I              BMY1NX                          WOY1NX
     I              BMAID8                          WOAID8
     I              BMAFTS                          WOAFTS
     I              BMBCNY                          WOBCNY
     I              BMZPNX                          WOZPNX
     I              BMZXNX                          WOZXNX
     I              BMZYNX                          WOZYNX
     I              BMY2NX                          WOY2NX
     I              BMAFD8                          WOAFD8
     I              BMAUNY                          WOAUNY
     I              BMAVNY                          WOAVNY
     I              BMVVSX                          WOVVSX
     I              BMUWSX                          WOUWSX
     I              BMUXSX                          WOUXSX
     I              BMV3SX                          WOV3SX
     I              BMAHNY                          WOAHNY
     I              BMAINY                          WOAINY
     I              BMAJNY                          WOAJNY
     I              BMAKNY                          WOAKNY
      *
     I@L8CPSY
      * Order Inv Allocation      Retrieval index
      * Renamed input format fields
     I              L8AIC3                          WRAIC3
     I              L8C4NB                          WRC4NB
     I              L8DPNB                          WRDPNB
     I              L8UENB                          WRUENB
     I              L8ALSW                          WRALSW
     I              L8J6QT                          WRJ6QT
     I              L8G9WG                          WRG9WG
     I              L8J9QT                          WRJ9QT
     I              L8HAWG                          WRHAWG
     I              L8IOSE                          WRIOSE
     I              L8OIMN                          WROIMN
     I              L8SOAS                          WRSOAS
     I              L8ARSX                          WRARSX
     I              L8OTUS                          WROTUS
     I              L8OTMP                          WROTMP
     I              L8HGCD                          WRHGCD
     I              L8AJCD                          WRAJCD
     I              L8ELDT                          WRELDT
     I              L8LXNM                          WRLXNM
     I              L8YMCD                          WRYMCD
     I              L8YNCD                          WRYNCD
     I              L8UVST                          WRUVST
     I              L8UWST                          WRUWST
     I              L8UXST                          WRUXST
     I              L8VSST                          WRVSST
     I              L8AATM                          WRAATM
     I              L8AYNA                          WRAYNA
     I              L8A0NA                          WRA0NA
     I              L8AXDT                          WRAXDT
      *
     I@L8CPSX
      * Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WSAIC3
     I              L8C4NB                          WSC4NB
     I              L8DPNB                          WSDPNB
     I              L8UENB                          WSUENB
     I              L8ALSW                          WSALSW
     I              L8J6QT                          WSJ6QT
     I              L8G9WG                          WSG9WG
     I              L8J9QT                          WSJ9QT
     I              L8HAWG                          WSHAWG
     I              L8IOSE                          WSIOSE
     I              L8OIMN                          WSOIMN
     I              L8SOAS                          WSSOAS
     I              L8ARSX                          WSARSX
     I              L8OTUS                          WSOTUS
     I              L8OTMP                          WSOTMP
     I              L8HGCD                          WSHGCD
     I              L8AJCD                          WSAJCD
     I              L8ELDT                          WSELDT
     I              L8LXNM                          WSLXNM
     I              L8YMCD                          WSYMCD
     I              L8YNCD                          WSYNCD
     I              L8UVST                          WSUVST
     I              L8UWST                          WSUWST
     I              L8UXST                          WSUXST
     I              L8VSST                          WSVSST
     I              L8AATM                          WSAATM
     I              L8AYNA                          WSAYNA
     I              L8A0NA                          WSA0NA
     I              L8AXDT                          WSAXDT
      *
     I@BLCPFB
      * PFS Ship Load Header      Co/Ld/TDt(d)/TTm(d) PS=0
      * Renamed input format fields
     I              BLY1NX                          WTY1NX
     I              BLAID8                          WTAID8
     I              BLAFTS                          WTAFTS
     I              BLBCNY                          WTBCNY
     I              BLZGNX                          WTZGNX
     I              BLAQNY                          WTAQNY
     I              BLVSSX                          WTVSSX
     I              BLBGNY                          WTBGNY
     I              BLV1SX                          WTV1SX
     I              BLGLT1                          WTGLT1
     I              BLGMT1                          WTGMT1
     I              BLGNT1                          WTGNT1
     I              BLG9T1                          WTG9T1
     I              BLGOT1                          WTGOT1
     I              BLVTSX                          WTVTSX
     I              BLARNY                          WTARNY
     I              BLBFNY                          WTBFNY
     I              BLVUSX                          WTVUSX
     I              BLGXT1                          WTGXT1
     I              BLAJD8                          WTAJD8
     I              BLAGTS                          WTAGTS
     I              BLAKD8                          WTAKD8
     I              BLAHTS                          WTAHTS
     I              BLASNY                          WTASNY
     I              BLBHNY                          WTBHNY
     I              BLUWSX                          WTUWSX
     I              BLUXSX                          WTUXSX
     I              BLV3SX                          WTV3SX
     I              BLAHNY                          WTAHNY
     I              BLAINY                          WTAINY
     I              BLAJNY                          WTAJNY
     I              BLAKNY                          WTAKNY
      *
     I@BLCPZ7
      * PFS Ship Load Header      Update index
      * Renamed input format fields
     I              BLY1NX                          WVY1NX
     I              BLAID8                          WVAID8
     I              BLAFTS                          WVAFTS
     I              BLBCNY                          WVBCNY
     I              BLZGNX                          WVZGNX
     I              BLAQNY                          WVAQNY
     I              BLVSSX                          WVVSSX
     I              BLBGNY                          WVBGNY
     I              BLV1SX                          WVV1SX
     I              BLGLT1                          WVGLT1
     I              BLGMT1                          WVGMT1
     I              BLGNT1                          WVGNT1
     I              BLG9T1                          WVG9T1
     I              BLGOT1                          WVGOT1
     I              BLVTSX                          WVVTSX
     I              BLARNY                          WVARNY
     I              BLBFNY                          WVBFNY
     I              BLVUSX                          WVVUSX
     I              BLGXT1                          WVGXT1
     I              BLAJD8                          WVAJD8
     I              BLAGTS                          WVAGTS
     I              BLAKD8                          WVAKD8
     I              BLAHTS                          WVAHTS
     I              BLASNY                          WVASNY
     I              BLBHNY                          WVBHNY
     I              BLUWSX                          WVUWSX
     I              BLUXSX                          WVUXSX
     I              BLV3SX                          WVV3SX
     I              BLAHNY                          WVAHNY
     I              BLAINY                          WVAINY
     I              BLAJNY                          WVAJNY
     I              BLAKNY                          WVAKNY
      *
     I@BKCPFD
      * PFS Ship Load/Order Sts   Co/Ld/TD-d/TT-d PS=0
      * Renamed input format fields
     I              BKY1NX                          WWY1NX
     I              BKAID8                          WWAID8
     I              BKAFTS                          WWAFTS
     I              BKBCNY                          WWBCNY
     I              BKVRSX                          WWVRSX
     I              BKZGNX                          WWZGNX
     I              BKZPNX                          WWZPNX
     I              BKW0SX                          WWW0SX
     I              BKUWSX                          WWUWSX
     I              BKUXSX                          WWUXSX
     I              BKV3SX                          WWV3SX
     I              BKAHNY                          WWAHNY
     I              BKAINY                          WWAINY
     I              BKAJNY                          WWAJNY
     I              BKAKNY                          WWAKNY
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WXAIC3
     I              OMC4NB                          WXC4NB
     I              OMDPNB                          WXDPNB
     I              OMUENB                          WXUENB
     I              OMHGCD                          WXHGCD
     I              OMAJCD                          WXAJCD
     I              OMBKC7                          WXBKC7
     I              OMCFC7                          WXCFC7
     I              OMGMST                          WXGMST
     I              OMGNST                          WXGNST
     I              OMMAVA                          WXMAVA
     I              OMKDVA                          WXKDVA
     I              OML8VA                          WXL8VA
     I              OML9VA                          WXL9VA
     I              OMGTST                          WXGTST
     I              OMGVST                          WXGVST
     I              OMGUST                          WXGUST
     I              OMQFST                          WXQFST
     I              OMAYVA                          WXAYVA
     I              OMEXDT                          WXEXDT
     I              OMLQCD                          WXLQCD
     I              OMRDCD                          WXRDCD
     I              OMQ7CD                          WXQ7CD
     I              OMBZPR                          WXBZPR
     I              OML6NB                          WXL6NB
     I              OMU1ST                          WXU1ST
     I              OMGIDT                          WXGIDT
     I              OMCRCD                          WXCRCD
     I              OMAGCD                          WXAGCD
     I              OMRZST                          WXRZST
     I              OMR0ST                          WXR0ST
     I              OMR1ST                          WXR1ST
     I              OMG7NA                          WXG7NA
     I              OMG8NA                          WXG8NA
     I              OMRPCD                          WXRPCD
     I              OMVEST                          WXVEST
     I              OMVGST                          WXVGST
     I              OMAVST                          WXAVST
     I              OMU0ST                          WXU0ST
     I              OMRFCD                          WXRFCD
     I              OMFZST                          WXFZST
     I              OMR1NB                          WXR1NB
     I              OMAVQT                          WXAVQT
     I              OMD0WG                          WXD0WG
     I              OMCCQT                          WXCCQT
     I              OMAUWG                          WXAUWG
     I              OMCBQT                          WXCBQT
     I              OMATWG                          WXATWG
     I              OMAQCS                          WXAQCS
     I              OMAGCS                          WXAGCS
     I              OMAKPR                          WXAKPR
     I              OMALPR                          WXALPR
     I              OMAUPR                          WXAUPR
     I              OMAVWG                          WXAVWG
     I              OMA4WG                          WXA4WG
     I              OMA5DT                          WXA5DT
     I              OMAODT                          WXAODT
     I              OMGNDT                          WXGNDT
     I              OMAMST                          WXAMST
     I              OMANST                          WXANST
     I              OMVAST                          WXVAST
     I              OMRGNB                          WXRGNB
     I              OMRHNB                          WXRHNB
     I              OMRINB                          WXRINB
     I              OMRBCD                          WXRBCD
     I              OMHICD                          WXHICD
     I              OMRNCD                          WXRNCD
     I              OMROCD                          WXROCD
     I              OMCXDT                          WXCXDT
     I              OMAJVN                          WXAJVN
     I              OMKXCD                          WXKXCD
     I              OMJPCD                          WXJPCD
     I              OMCQCD                          WXCQCD
     I              OMR4CD                          WXR4CD
     I              OMZ1ST                          WXZ1ST
     I              OMZ3ST                          WXZ3ST
     I              OMZ4ST                          WXZ4ST
     I              OMDUPR                          WXDUPR
     I              OMB6VL                          WXB6VL
     I              OMA1AA                          WXA1AA
     I              OMFZSX                          WXFZSX
     I              OMF0SX                          WXF0SX
     I              OMF1SX                          WXF1SX
     I              OMF2SX                          WXF2SX
     I              OMF3SX                          WXF3SX
     I              OMF4SX                          WXF4SX
     I              OMF5SX                          WXF5SX
     I              OMF6SX                          WXF6SX
     I              OMF7SX                          WXF7SX
     I              OMNTDT                          WXNTDT
     I              OMNUDT                          WXNUDT
     I              OMNVDT                          WXNVDT
     I              OMNWDT                          WXNWDT
     I              OMNXDT                          WXNXDT
     I              OMBUTM                          WXBUTM
     I              OMBVTM                          WXBVTM
     I              OMBWTM                          WXBWTM
     I              OMBXTM                          WXBXTM
     I              OMBYTM                          WXBYTM
     I              OMH5NX                          WXH5NX
     I              OMH6NX                          WXH6NX
     I              OMH7NX                          WXH7NX
     I              OMH8NX                          WXH8NX
     I              OMH9NX                          WXH9NX
     I              OMDVPR                          WXDVPR
     I              OMDWPR                          WXDWPR
     I              OMDXPR                          WXDXPR
     I              OMDYPR                          WXDYPR
     I              OMDZPR                          WXDZPR
     I              OMGSPR                          WXGSPR
     I              OMGTPR                          WXGTPR
     I              OMGUPR                          WXGUPR
     I              OMHOST                          WXHOST
     I              OMHPST                          WXHPST
     I              OMIOST                          WXIOST
     I              OMPEWG                          WXPEWG
     I              OMRINY                          WXRINY
     I              OMTIDT                          WXTIDT
     I              OMTJDT                          WXTJDT
     I              OMH2ST                          WXH2ST
     I              OMH0ST                          WXH0ST
     I              OMH1ST                          WXH1ST
     I              OMTKDT                          WXTKDT
     I              OMTLDT                          WXTLDT
     I              OMTMDT                          WXTMDT
     I              OMUVST                          WXUVST
     I              OMUWST                          WXUWST
     I              OMUXST                          WXUXST
     I              OMAATM                          WXAATM
     I              OMAYNA                          WXAYNA
     I              OMA0NA                          WXA0NA
     I              OMAXDT                          WXAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WYAIC3
     I              EOBKC7                          WYBKC7
     I              EOAQCD                          WYAQCD
     I              EOR4CD                          WYR4CD
     I              EOBYNA                          WYBYNA
     I              EOB6NA                          WYB6NA
     I              EOBZNA                          WYBZNA
     I              EOLLST                          WYLLST
     I              EOPPST                          WYPPST
     I              EOR5NB                          WYR5NB
     I              EOR6NB                          WYR6NB
     I              EOQGST                          WYQGST
     I              EOBOCD                          WYBOCD
     I              EOTBNB                          WYTBNB
     I              EOMTCU                          WYMTCU
     I              EOW2NB                          WYW2NB
     I              EORPCD                          WYRPCD
     I              EOAJCD                          WYAJCD
     I              EOX9ST                          WYX9ST
     I              EOT9CD                          WYT9CD
     I              EOUBCD                          WYUBCD
     I              EOISTX                          WYISTX
     I              EOLQCD                          WYLQCD
     I              EONJNA                          WYNJNA
     I              EOI0TX                          WYI0TX
     I              EONKNA                          WYNKNA
     I              EOI1TX                          WYI1TX
     I              EOVLST                          WYVLST
     I              EORLST                          WYRLST
     I              EOMMTX                          WYMMTX
     I              EOOHNA                          WYOHNA
     I              EOQ6ST                          WYQ6ST
     I              EOQ8ST                          WYQ8ST
     I              EORBST                          WYRBST
     I              EOREST                          WYREST
     I              EOUVST                          WYUVST
     I              EOUWST                          WYUWST
     I              EOUXST                          WYUXST
     I              EOVSST                          WYVSST
     I              EOAATM                          WYAATM
     I              EOAYNA                          WYAYNA
     I              EOA0NA                          WYA0NA
     I              EOAXDT                          WYAXDT
      *
     I@FNCPEZ
      * Manifest Detail           Co/Ord#/Seq/Seq2/PrdDte
      * Renamed input format fields
     I              FNAIC3                          TAAIC3
     I              FNC4NB                          TAC4NB
     I              FNDPNB                          TADPNB
     I              FNUENB                          TAUENB
     I              FNRZNB                          TARZNB
     I              FNFOQT                          TAFOQT
     I              FNR0NB                          TAR0NB
     I              FNPMST                          TAPMST
     I              FNK7DT                          TAK7DT
     I              FNPFNX                          TAPFNX
     I              FNHGCD                          TAHGCD
     I              FNAJCD                          TAAJCD
     I              FNELDT                          TAELDT
     I              FNN5WG                          TAN5WG
     I              FNRZNA                          TARZNA
     I              FNH5NY                          TAH5NY
     I              FNH6NY                          TAH6NY
     I              FNH7NY                          TAH7NY
     I              FNGBTX                          TAGBTX
     I              FNN6WG                          TAN6WG
     I              FNN7WG                          TAN7WG
     I              FNGCTX                          TAGCTX
     I              FNGDTX                          TAGDTX
     I              FNRBDT                          TARBDT
     I              FNITNY                          TAITNY
     I              FNIVNY                          TAIVNY
     I              FNIUNY                          TAIUNY
     I              FNIWNY                          TAIWNY
     I              FNIXNY                          TAIXNY
     I              FNIYNY                          TAIYNY
     I              FNUVST                          TAUVST
     I              FNUWST                          TAUWST
     I              FNUXST                          TAUXST
     I              FNVSST                          TAVSST
     I              FNAATM                          TAAATM
     I              FNAYNA                          TAAYNA
     I              FNA0NA                          TAA0NA
     I              FNAXDT                          TAAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          TBAIC3
     I              BZHGCD                          TBHGCD
     I              BZAVNA                          TBAVNA
     I              BZAWNA                          TBAWNA
     I              BZL7NA                          TBL7NA
     I              BZL8NA                          TBL8NA
     I              BZL6NA                          TBL6NA
     I              BZMFNA                          TBMFNA
     I              BZADCD                          TBADCD
     I              BZAWPC                          TBAWPC
     I              BZLXST                          TBLXST
     I              BZAECD                          TBAECD
     I              BZAXPC                          TBAXPC
     I              BZLYST                          TBLYST
     I              BZAFCD                          TBAFCD
     I              BZAICD                          TBAICD
     I              BZAIWG                          TBAIWG
     I              BZHICD                          TBHICD
     I              BZRBCD                          TBRBCD
     I              BZFZST                          TBFZST
     I              BZAVST                          TBAVST
     I              BZCZWG                          TBCZWG
     I              BZC0WG                          TBC0WG
     I              BZURTN                          TBURTN
     I              BZAJC8                          TBAJC8
     I              BZRINB                          TBRINB
     I              BZRHNB                          TBRHNB
     I              BZRGNB                          TBRGNB
     I              BZLNCD                          TBLNCD
     I              BZTFNB                          TBTFNB
     I              BZN0CD                          TBN0CD
     I              BZX4ST                          TBX4ST
     I              BZTMVA                          TBTMVA
     I              BZTNVA                          TBTNVA
     I              BZBLPR                          TBBLPR
     I              BZBMPR                          TBBMPR
     I              BZLRCD                          TBLRCD
     I              BZU9ST                          TBU9ST
     I              BZCMCO                          TBCMCO
     I              BZQ1CD                          TBQ1CD
     I              BZQ8CD                          TBQ8CD
     I              BZCHTM                          TBCHTM
     I              BZQZCD                          TBQZCD
     I              BZXWST                          TBXWST
     I              BZXXST                          TBXXST
     I              BZVMST                          TBVMST
     I              BZSWGH                          TBSWGH
     I              BZPPHE                          TBPPHE
     I              BZR3CD                          TBR3CD
     I              BZSDCD                          TBSDCD
     I              BZICN1                          TBICN1
     I              BZSVCD                          TBSVCD
     I              BZICN2                          TBICN2
     I              BZSWCD                          TBSWCD
     I              BZV2NB                          TBV2NB
     I              BZSXCD                          TBSXCD
     I              BZITCN                          TBITCN
     I              BZSYCD                          TBSYCD
     I              BZITC5                          TBITC5
     I              BZSZCD                          TBSZCD
     I              BZICN6                          TBICN6
     I              BZS0CD                          TBS0CD
     I              BZICN7                          TBICN7
     I              BZS1CD                          TBS1CD
     I              BZICN8                          TBICN8
     I              BZS2CD                          TBS2CD
     I              BZICN9                          TBICN9
     I              BZS3CD                          TBS3CD
     I              BZICN0                          TBICN0
     I              BZS4CD                          TBS4CD
     I              BZSFNB                          TBSFNB
     I              BZA3WG                          TBA3WG
     I              BZSJNB                          TBSJNB
     I              BZLLCD                          TBLLCD
     I              BZLMCD                          TBLMCD
     I              BZP3ST                          TBP3ST
     I              BZSKNB                          TBSKNB
     I              BZSLNB                          TBSLNB
     I              BZSMNB                          TBSMNB
     I              BZP4ST                          TBP4ST
     I              BZCFNB                          TBCFNB
     I              BZCGNB                          TBCGNB
     I              BZILNB                          TBILNB
     I              BZCHNB                          TBCHNB
     I              BZCINB                          TBCINB
     I              BZCJNB                          TBCJNB
     I              BZCMNB                          TBCMNB
     I              BZCNNB                          TBCNNB
     I              BZCRNB                          TBCRNB
     I              BZCSNB                          TBCSNB
     I              BZCVNB                          TBCVNB
     I              BZCWNB                          TBCWNB
     I              BZCXNB                          TBCXNB
     I              BZCZNB                          TBCZNB
     I              BZC0NB                          TBC0NB
     I              BZN1CD                          TBN1CD
     I              BZB4NB                          TBB4NB
     I              BZB5NB                          TBB5NB
     I              BZX5ST                          TBX5ST
     I              BZX6ST                          TBX6ST
     I              BZX7ST                          TBX7ST
     I              BZPCCT                          TBPCCT
     I              BZBDNB                          TBBDNB
     I              BZBJNB                          TBBJNB
     I              BZSUST                          TBSUST
     I              BZSVST                          TBSVST
     I              BZSYST                          TBSYST
     I              BZSZST                          TBSZST
     I              BZS1ST                          TBS1ST
     I              BZXRCD                          TBXRCD
     I              BZXTCD                          TBXTCD
     I              BZXUCD                          TBXUCD
     I              BZF5WG                          TBF5WG
     I              BZF6WG                          TBF6WG
     I              BZF7WG                          TBF7WG
     I              BZBLNB                          TBBLNB
     I              BZBNNB                          TBBNNB
     I              BZS2ST                          TBS2ST
     I              BZS4ST                          TBS4ST
     I              BZS5ST                          TBS5ST
     I              BZS6ST                          TBS6ST
     I              BZS8ST                          TBS8ST
     I              BZS9ST                          TBS9ST
     I              BZTCST                          TBTCST
     I              BZTDST                          TBTDST
     I              BZUVST                          TBUVST
     I              BZUWST                          TBUWST
     I              BZUXST                          TBUXST
     I              BZVSST                          TBVSST
     I              BZAATM                          TBAATM
     I              BZAYNA                          TBAYNA
     I              BZA0NA                          TBA0NA
     I              BZAXDT                          TBAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          TCAIC3
     I              B1HGCD                          TCHGCD
     I              B1AJCD                          TCAJCD
     I              B1ELDT                          TCELDT
     I              B1ABWG                          TCABWG
     I              B1AGQT                          TCAGQT
     I              B1AHQT                          TCAHQT
     I              B1AIQT                          TCAIQT
     I              B1CTST                          TCCTST
     I              B1ACWG                          TCACWG
     I              B1ARQT                          TCARQT
     I              B1ASQT                          TCASQT
     I              B1ATQT                          TCATQT
     I              B1HDQT                          TCHDQT
     I              B1HEQT                          TCHEQT
     I              B1F6ST                          TCF6ST
     I              B1BMWG                          TCBMWG
     I              B1DSQT                          TCDSQT
     I              B1DTQT                          TCDTQT
     I              B1DUQT                          TCDUQT
     I              B1DHDT                          TCDHDT
     I              B1AGCS                          TCAGCS
     I              B1AECS                          TCAECS
     I              B1IDVA                          TCIDVA
     I              B1K7DT                          TCK7DT
     I              B1RINB                          TCRINB
     I              B1RHNB                          TCRHNB
     I              B1RGNB                          TCRGNB
     I              B1UVST                          TCUVST
     I              B1UWST                          TCUWST
     I              B1UXST                          TCUXST
     I              B1VSST                          TCVSST
     I              B1AATM                          TCAATM
     I              B1AYNA                          TCAYNA
     I              B1A0NA                          TCA0NA
     I              B1AXDT                          TCAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          TDAIC3
     I              OMC4NB                          TDC4NB
     I              OMDPNB                          TDDPNB
     I              OMUENB                          TDUENB
     I              OMHGCD                          TDHGCD
     I              OMAJCD                          TDAJCD
     I              OMBKC7                          TDBKC7
     I              OMCFC7                          TDCFC7
     I              OMGMST                          TDGMST
     I              OMGNST                          TDGNST
     I              OMMAVA                          TDMAVA
     I              OMKDVA                          TDKDVA
     I              OML8VA                          TDL8VA
     I              OML9VA                          TDL9VA
     I              OMGTST                          TDGTST
     I              OMGVST                          TDGVST
     I              OMGUST                          TDGUST
     I              OMQFST                          TDQFST
     I              OMAYVA                          TDAYVA
     I              OMEXDT                          TDEXDT
     I              OMLQCD                          TDLQCD
     I              OMRDCD                          TDRDCD
     I              OMQ7CD                          TDQ7CD
     I              OMBZPR                          TDBZPR
     I              OML6NB                          TDL6NB
     I              OMU1ST                          TDU1ST
     I              OMGIDT                          TDGIDT
     I              OMCRCD                          TDCRCD
     I              OMAGCD                          TDAGCD
     I              OMRZST                          TDRZST
     I              OMR0ST                          TDR0ST
     I              OMR1ST                          TDR1ST
     I              OMG7NA                          TDG7NA
     I              OMG8NA                          TDG8NA
     I              OMRPCD                          TDRPCD
     I              OMVEST                          TDVEST
     I              OMVGST                          TDVGST
     I              OMAVST                          TDAVST
     I              OMU0ST                          TDU0ST
     I              OMRFCD                          TDRFCD
     I              OMFZST                          TDFZST
     I              OMR1NB                          TDR1NB
     I              OMAVQT                          TDAVQT
     I              OMD0WG                          TDD0WG
     I              OMCCQT                          TDCCQT
     I              OMAUWG                          TDAUWG
     I              OMCBQT                          TDCBQT
     I              OMATWG                          TDATWG
     I              OMAQCS                          TDAQCS
     I              OMAGCS                          TDAGCS
     I              OMAKPR                          TDAKPR
     I              OMALPR                          TDALPR
     I              OMAUPR                          TDAUPR
     I              OMAVWG                          TDAVWG
     I              OMA4WG                          TDA4WG
     I              OMA5DT                          TDA5DT
     I              OMAODT                          TDAODT
     I              OMGNDT                          TDGNDT
     I              OMAMST                          TDAMST
     I              OMANST                          TDANST
     I              OMVAST                          TDVAST
     I              OMRGNB                          TDRGNB
     I              OMRHNB                          TDRHNB
     I              OMRINB                          TDRINB
     I              OMRBCD                          TDRBCD
     I              OMHICD                          TDHICD
     I              OMRNCD                          TDRNCD
     I              OMROCD                          TDROCD
     I              OMCXDT                          TDCXDT
     I              OMAJVN                          TDAJVN
     I              OMKXCD                          TDKXCD
     I              OMJPCD                          TDJPCD
     I              OMCQCD                          TDCQCD
     I              OMR4CD                          TDR4CD
     I              OMZ1ST                          TDZ1ST
     I              OMZ3ST                          TDZ3ST
     I              OMZ4ST                          TDZ4ST
     I              OMDUPR                          TDDUPR
     I              OMB6VL                          TDB6VL
     I              OMA1AA                          TDA1AA
     I              OMFZSX                          TDFZSX
     I              OMF0SX                          TDF0SX
     I              OMF1SX                          TDF1SX
     I              OMF2SX                          TDF2SX
     I              OMF3SX                          TDF3SX
     I              OMF4SX                          TDF4SX
     I              OMF5SX                          TDF5SX
     I              OMF6SX                          TDF6SX
     I              OMF7SX                          TDF7SX
     I              OMNTDT                          TDNTDT
     I              OMNUDT                          TDNUDT
     I              OMNVDT                          TDNVDT
     I              OMNWDT                          TDNWDT
     I              OMNXDT                          TDNXDT
     I              OMBUTM                          TDBUTM
     I              OMBVTM                          TDBVTM
     I              OMBWTM                          TDBWTM
     I              OMBXTM                          TDBXTM
     I              OMBYTM                          TDBYTM
     I              OMH5NX                          TDH5NX
     I              OMH6NX                          TDH6NX
     I              OMH7NX                          TDH7NX
     I              OMH8NX                          TDH8NX
     I              OMH9NX                          TDH9NX
     I              OMDVPR                          TDDVPR
     I              OMDWPR                          TDDWPR
     I              OMDXPR                          TDDXPR
     I              OMDYPR                          TDDYPR
     I              OMDZPR                          TDDZPR
     I              OMGSPR                          TDGSPR
     I              OMGTPR                          TDGTPR
     I              OMGUPR                          TDGUPR
     I              OMHOST                          TDHOST
     I              OMHPST                          TDHPST
     I              OMIOST                          TDIOST
     I              OMPEWG                          TDPEWG
     I              OMRINY                          TDRINY
     I              OMTIDT                          TDTIDT
     I              OMTJDT                          TDTJDT
     I              OMH2ST                          TDH2ST
     I              OMH0ST                          TDH0ST
     I              OMH1ST                          TDH1ST
     I              OMTKDT                          TDTKDT
     I              OMTLDT                          TDTLDT
     I              OMTMDT                          TDTMDT
     I              OMUVST                          TDUVST
     I              OMUWST                          TDUWST
     I              OMUXST                          TDUXST
     I              OMAATM                          TDAATM
     I              OMAYNA                          TDAYNA
     I              OMA0NA                          TDA0NA
     I              OMAXDT                          TDAXDT
      *
     I@L8CPZO
      * Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      * Renamed input format fields
     I              L8AIC3                          TEAIC3
     I              L8C4NB                          TEC4NB
     I              L8DPNB                          TEDPNB
     I              L8UENB                          TEUENB
     I              L8ALSW                          TEALSW
     I              L8J6QT                          TEJ6QT
     I              L8G9WG                          TEG9WG
     I              L8J9QT                          TEJ9QT
     I              L8HAWG                          TEHAWG
     I              L8IOSE                          TEIOSE
     I              L8OIMN                          TEOIMN
     I              L8SOAS                          TESOAS
     I              L8ARSX                          TEARSX
     I              L8OTUS                          TEOTUS
     I              L8OTMP                          TEOTMP
     I              L8HGCD                          TEHGCD
     I              L8AJCD                          TEAJCD
     I              L8ELDT                          TEELDT
     I              L8LXNM                          TELXNM
     I              L8YMCD                          TEYMCD
     I              L8YNCD                          TEYNCD
     I              L8UVST                          TEUVST
     I              L8UWST                          TEUWST
     I              L8UXST                          TEUXST
     I              L8VSST                          TEVSST
     I              L8AATM                          TEAATM
     I              L8AYNA                          TEAYNA
     I              L8A0NA                          TEA0NA
     I              L8AXDT                          TEAXDT
      *
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          TFAIC3
     I              L7HGCD                          TFHGCD
     I              L7AJCD                          TFAJCD
     I              L7LTRT                          TFLTRT
     I              L7LRDT                          TFLRDT
     I              L7LLTS                          TFLLTS
     I              L7LSDT                          TFLSDT
     I              L7J5QT                          TFJ5QT
     I              L7G8WG                          TFG8WG
     I              L7LLTN                          TFLLTN
     I              L7YMCD                          TFYMCD
     I              L7LLCL                          TFLLCL
     I              L7BNAA                          TFBNAA
     I              L7LLTR                          TFLLTR
     I              L7Y2CD                          TFY2CD
     I              L7LLTL                          TFLLTL
     I              L7C4NB                          TFC4NB
     I              L7LOST                          TFLOST
     I              L7LLTU                          TFLLTU
     I              L7LLYT                          TFLLYT
     I              L7UVST                          TFUVST
     I              L7UWST                          TFUWST
     I              L7UXST                          TFUXST
     I              L7VSST                          TFVSST
     I              L7AATM                          TFAATM
     I              L7AYNA                          TFAYNA
     I              L7A0NA                          TFA0NA
     I              L7AXDT                          TFAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          TGAIC3
     I              L7HGCD                          TGHGCD
     I              L7AJCD                          TGAJCD
     I              L7LTRT                          TGLTRT
     I              L7LRDT                          TGLRDT
     I              L7LLTS                          TGLLTS
     I              L7LSDT                          TGLSDT
     I              L7J5QT                          TGJ5QT
     I              L7G8WG                          TGG8WG
     I              L7LLTN                          TGLLTN
     I              L7YMCD                          TGYMCD
     I              L7LLCL                          TGLLCL
     I              L7BNAA                          TGBNAA
     I              L7LLTR                          TGLLTR
     I              L7Y2CD                          TGY2CD
     I              L7LLTL                          TGLLTL
     I              L7C4NB                          TGC4NB
     I              L7LOST                          TGLOST
     I              L7LLTU                          TGLLTU
     I              L7LLYT                          TGLLYT
     I              L7UVST                          TGUVST
     I              L7UWST                          TGUWST
     I              L7UXST                          TGUXST
     I              L7VSST                          TGVSST
     I              L7AATM                          TGAATM
     I              L7AYNA                          TGAYNA
     I              L7A0NA                          TGA0NA
     I              L7AXDT                          TGAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          THAIC3
     I              L5HGCD                          THHGCD
     I              L5AJCD                          THAJCD
     I              L5ELDT                          THELDT
     I              L5LXNM                          THLXNM
     I              L5YMCD                          THYMCD
     I              L5YNCD                          THYNCD
     I              L5J2QT                          THJ2QT
     I              L5G5WG                          THG5WG
     I              L5J3QT                          THJ3QT
     I              L5G6WG                          THG6WG
     I              L5J4QT                          THJ4QT
     I              L5G7WG                          THG7WG
     I              L5LODT                          THLODT
     I              L5LPDT                          THLPDT
     I              L5LQDT                          THLQDT
     I              L5NBR                           THNBR
     I              L5YTCD                          THYTCD
     I              L5AMSX                          THAMSX
     I              L5ASSX                          THASSX
     I              L5ATSX                          THATSX
     I              L5AUSX                          THAUSX
     I              L5YSCD                          THYSCD
     I              L5UVST                          THUVST
     I              L5UWST                          THUWST
     I              L5UXST                          THUXST
     I              L5VSST                          THVSST
     I              L5AATM                          THAATM
     I              L5AYNA                          THAYNA
     I              L5A0NA                          THA0NA
     I              L5AXDT                          THAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          TIAJCD
     I              L2YMCD                          TIYMCD
     I              L2YPCD                          TIYPCD
     I              L2LCBY                          TILCBY
     I              L2LCCT                          TILCCT
     I              L2WLUS                          TIWLUS
     I              L2WUSD                          TIWUSD
     I              L2WLUN                          TIWLUN
     I              L2AGSX                          TIAGSX
     I              L2UVST                          TIUVST
     I              L2UWST                          TIUWST
     I              L2UXST                          TIUXST
     I              L2VSST                          TIVSST
     I              L2AATM                          TIAATM
     I              L2AYNA                          TIAYNA
     I              L2A0NA                          TIA0NA
     I              L2AXDT                          TIAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          TJAGSX
     I              MEOPNA                          TJOPNA
     I              MESLTY                          TJSLTY
     I              MEAHSX                          TJAHSX
     I              MEAISX                          TJAISX
     I              MEUVST                          TJUVST
     I              MEUWST                          TJUWST
     I              MEUXST                          TJUXST
     I              MEVSST                          TJVSST
     I              MEAATM                          TJAATM
     I              MEAYNA                          TJAYNA
     I              MEA0NA                          TJA0NA
     I              MEAXDT                          TJAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          TKAIC3
     I              L5HGCD                          TKHGCD
     I              L5AJCD                          TKAJCD
     I              L5ELDT                          TKELDT
     I              L5LXNM                          TKLXNM
     I              L5YMCD                          TKYMCD
     I              L5YNCD                          TKYNCD
     I              L5J2QT                          TKJ2QT
     I              L5G5WG                          TKG5WG
     I              L5J3QT                          TKJ3QT
     I              L5G6WG                          TKG6WG
     I              L5J4QT                          TKJ4QT
     I              L5G7WG                          TKG7WG
     I              L5LODT                          TKLODT
     I              L5LPDT                          TKLPDT
     I              L5LQDT                          TKLQDT
     I              L5NBR                           TKNBR
     I              L5YTCD                          TKYTCD
     I              L5AMSX                          TKAMSX
     I              L5ASSX                          TKASSX
     I              L5ATSX                          TKATSX
     I              L5AUSX                          TKAUSX
     I              L5YSCD                          TKYSCD
     I              L5UVST                          TKUVST
     I              L5UWST                          TKUWST
     I              L5UXST                          TKUXST
     I              L5VSST                          TKVSST
     I              L5AATM                          TKAATM
     I              L5AYNA                          TKAYNA
     I              L5A0NA                          TKA0NA
     I              L5AXDT                          TKAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TLAIC3
     I              B1HGCD                          TLHGCD
     I              B1AJCD                          TLAJCD
     I              B1ELDT                          TLELDT
     I              B1ABWG                          TLABWG
     I              B1AGQT                          TLAGQT
     I              B1AHQT                          TLAHQT
     I              B1AIQT                          TLAIQT
     I              B1CTST                          TLCTST
     I              B1ACWG                          TLACWG
     I              B1ARQT                          TLARQT
     I              B1ASQT                          TLASQT
     I              B1ATQT                          TLATQT
     I              B1HDQT                          TLHDQT
     I              B1HEQT                          TLHEQT
     I              B1F6ST                          TLF6ST
     I              B1BMWG                          TLBMWG
     I              B1DSQT                          TLDSQT
     I              B1DTQT                          TLDTQT
     I              B1DUQT                          TLDUQT
     I              B1DHDT                          TLDHDT
     I              B1AGCS                          TLAGCS
     I              B1AECS                          TLAECS
     I              B1IDVA                          TLIDVA
     I              B1K7DT                          TLK7DT
     I              B1RINB                          TLRINB
     I              B1RHNB                          TLRHNB
     I              B1RGNB                          TLRGNB
     I              B1UVST                          TLUVST
     I              B1UWST                          TLUWST
     I              B1UXST                          TLUXST
     I              B1VSST                          TLVSST
     I              B1AATM                          TLAATM
     I              B1AYNA                          TLAYNA
     I              B1A0NA                          TLA0NA
     I              B1AXDT                          TLAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          TMRMNB
     I              FJAIC3                          TMAIC3
     I              FJAODT                          TMAODT
     I              FJPJST                          TMPJST
     I              FJPKST                          TMPKST
     I              FJRNNB                          TMRNNB
     I              FJDMTX                          TMDMTX
     I              FJDNTX                          TMDNTX
     I              FJDOTX                          TMDOTX
     I              FJWTTX                          TMWTTX
     I              FJWUTX                          TMWUTX
     I              FJRPNB                          TMRPNB
     I              FJFLAM                          TMFLAM
     I              FJXQST                          TMXQST
     I              FJRRNB                          TMRRNB
     I              FJDXTX                          TMDXTX
     I              FJDYTX                          TMDYTX
     I              FJSBNB                          TMSBNB
     I              FJBZNA                          TMBZNA
     I              FJRONB                          TMRONB
     I              FJSQNB                          TMSQNB
     I              FJR1NB                          TMR1NB
     I              FJVCST                          TMVCST
     I              FJVDST                          TMVDST
     I              FJSDNB                          TMSDNB
     I              FJPAOU                          TMPAOU
     I              FJDGWG                          TMDGWG
     I              FJSXNB                          TMSXNB
     I              FJHADT                          TMHADT
     I              FJAART                          TMAART
     I              FJDHWG                          TMDHWG
     I              FJDIWG                          TMDIWG
     I              FJAQDT                          TMAQDT
     I              FJS6NB                          TMS6NB
     I              FJT4NB                          TMT4NB
     I              FJPRTM                          TMPRTM
     I              FJNPSV                          TMNPSV
     I              FJJ8TX                          TMJ8TX
     I              FJTLMI                          TMTLMI
     I              FJJ9TX                          TMJ9TX
     I              FJQ2CD                          TMQ2CD
     I              FJVPCD                          TMVPCD
     I              FJDBCD                          TMDBCD
     I              FJGRWE                          TMGRWE
     I              FJXCCD                          TMXCCD
     I              FJU2ST                          TMU2ST
     I              FJF9DT                          TMF9DT
     I              FJONTM                          TMONTM
     I              FJJ4DT                          TMJ4DT
     I              FJTRTM                          TMTRTM
     I              FJJ5DT                          TMJ5DT
     I              FJSPTM                          TMSPTM
     I              FJJ6DT                          TMJ6DT
     I              FJLFTM                          TMLFTM
     I              FJJ7DT                          TMJ7DT
     I              FJBOTM                          TMBOTM
     I              FJJ8DT                          TMJ8DT
     I              FJBLTM                          TMBLTM
     I              FJKIDT                          TMKIDT
     I              FJASTM                          TMASTM
     I              FJKADT                          TMKADT
     I              FJAJCM                          TMAJCM
     I              FJXACD                          TMXACD
     I              FJOANA                          TMOANA
     I              FJK4TX                          TMK4TX
     I              FJVOAG                          TMVOAG
     I              FJKBDT                          TMKBDT
     I              FJNBBO                          TMNBBO
     I              FJW4CD                          TMW4CD
     I              FJEFDT                          TMEFDT
     I              FJCNTN                          TMCNTN
     I              FJKCDT                          TMKCDT
     I              FJTMIN                          TMTMIN
     I              FJKDDT                          TMKDDT
     I              FJVMNB                          TMVMNB
     I              FJOCFR                          TMOCFR
     I              FJKJDT                          TMKJDT
     I              FJATTM                          TMATTM
     I              FJOTRS                          TMOTRS
     I              FJRNST                          TMRNST
     I              FJBRBK                          TMBRBK
     I              FJEIDT                          TMEIDT
     I              FJRMST                          TMRMST
     I              FJAJCD                          TMAJCD
     I              FJKKDT                          TMKKDT
     I              FJAVTM                          TMAVTM
     I              FJKZDT                          TMKZDT
     I              FJAXTM                          TMAXTM
     I              FJLHOS                          TMLHOS
     I              FJLHOR                          TMLHOR
     I              FJWNTX                          TMWNTX
     I              FJOITX                          TMOITX
     I              FJOJTX                          TMOJTX
     I              FJLLDT                          TMLLDT
     I              FJLSHG                          TMLSHG
     I              FJYPST                          TMYPST
     I              FJK0DT                          TMK0DT
     I              FJAYTM                          TMAYTM
     I              FJKNNX                          TMKNNX
     I              FJICWG                          TMICWG
     I              FJIDWG                          TMIDWG
     I              FJH9SX                          TMH9SX
     I              FJWOTX                          TMWOTX
     I              FJK1DT                          TMK1DT
     I              FJAZTM                          TMAZTM
     I              FJK2DT                          TMK2DT
     I              FJA0TM                          TMA0TM
     I              FJROST                          TMROST
     I              FJRPST                          TMRPST
     I              FJRQST                          TMRQST
     I              FJRRST                          TMRRST
     I              FJZBVA                          TMZBVA
     I              FJWPTX                          TMWPTX
     I              FJWQTX                          TMWQTX
     I              FJWRTX                          TMWRTX
     I              FJWSTX                          TMWSTX
     I              FJRVSX                          TMRVSX
     I              FJRUSX                          TMRUSX
     I              FJRWSX                          TMRWSX
     I              FJRXSX                          TMRXSX
     I              FJRYSX                          TMRYSX
     I              FJRZSX                          TMRZSX
     I              FJR0SX                          TMR0SX
     I              FJR1SX                          TMR1SX
     I              FJR2SX                          TMR2SX
     I              FJR3SX                          TMR3SX
     I              FJR4SX                          TMR4SX
     I              FJPYDT                          TMPYDT
     I              FJCKTM                          TMCKTM
     I              FJPZDT                          TMPZDT
     I              FJCLTM                          TMCLTM
     I              FJP0DT                          TMP0DT
     I              FJCMTM                          TMCMTM
     I              FJP1DT                          TMP1DT
     I              FJCNTM                          TMCNTM
     I              FJP2DT                          TMP2DT
     I              FJCOTM                          TMCOTM
     I              FJP3DT                          TMP3DT
     I              FJCQTM                          TMCQTM
     I              FJUVST                          TMUVST
     I              FJUWST                          TMUWST
     I              FJUXST                          TMUXST
     I              FJAATM                          TMAATM
     I              FJAYNA                          TMAYNA
     I              FJA0NA                          TMA0NA
     I              FJAXDT                          TMAXDT
      *
     I@MSREX2
      * Export Doc Order Dtl      Co/Order/Seq
      * Renamed input format fields
     I              MSAIC3                          TOAIC3
     I              MSC4NB                          TOC4NB
     I              MSDGSX                          TODGSX
     I              MSKXCD                          TOKXCD
     I              MSDPNB                          TODPNB
     I              MSUENB                          TOUENB
     I              MSDIC7                          TODIC7
     I              MSO3NA                          TOO3NA
     I              MSO4NA                          TOO4NA
     I              MSRMTX                          TORMTX
     I              MSPTTX                          TOPTTX
     I              MSHJWG                          TOHJWG
     I              MSHKWG                          TOHKWG
     I              MSRNTX                          TORNTX
     I              MSAONX                          TOAONX
     I              MSROTX                          TOROTX
     I              MSORNA                          TOORNA
     I              MSAMNX                          TOAMNX
     I              MSANNX                          TOANNX
     I              MSAPNX                          TOAPNX
     I              MSDKPR                          TODKPR
     I              MSA9VL                          TOA9VL
     I              MSC8SX                          TOC8SX
     I              MSRATX                          TORATX
     I              MSRBTX                          TORBTX
     I              MSAJNX                          TOAJNX
     I              MSZWTX                          TOZWTX
     I              MSZXTX                          TOZXTX
     I              MSZYTX                          TOZYTX
     I              MSZZTX                          TOZZTX
     I              MSK0U1                          TOK0U1
     I              MSK1U1                          TOK1U1
     I              MSIJSC                          TOIJSC
     I              MSIKSC                          TOIKSC
     I              MSK2U1                          TOK2U1
     I              MSW0DT                          TOW0DT
     I              MSUVST                          TOUVST
     I              MSUWST                          TOUWST
     I              MSUXST                          TOUXST
     I              MSVSST                          TOVSST
     I              MSAATM                          TOAATM
     I              MSAYNA                          TOAYNA
     I              MSA0NA                          TOA0NA
     I              MSAXDT                          TOAXDT
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          TRAIC3
     I              MSC4NB                          TRC4NB
     I              MSDGSX                          TRDGSX
     I              MSKXCD                          TRKXCD
     I              MSDPNB                          TRDPNB
     I              MSUENB                          TRUENB
     I              MSDIC7                          TRDIC7
     I              MSO3NA                          TRO3NA
     I              MSO4NA                          TRO4NA
     I              MSRMTX                          TRRMTX
     I              MSPTTX                          TRPTTX
     I              MSHJWG                          TRHJWG
     I              MSHKWG                          TRHKWG
     I              MSRNTX                          TRRNTX
     I              MSAONX                          TRAONX
     I              MSROTX                          TRROTX
     I              MSORNA                          TRORNA
     I              MSAMNX                          TRAMNX
     I              MSANNX                          TRANNX
     I              MSAPNX                          TRAPNX
     I              MSDKPR                          TRDKPR
     I              MSA9VL                          TRA9VL
     I              MSC8SX                          TRC8SX
     I              MSRATX                          TRRATX
     I              MSRBTX                          TRRBTX
     I              MSAJNX                          TRAJNX
     I              MSZWTX                          TRZWTX
     I              MSZXTX                          TRZXTX
     I              MSZYTX                          TRZYTX
     I              MSZZTX                          TRZZTX
     I              MSK0U1                          TRK0U1
     I              MSK1U1                          TRK1U1
     I              MSIJSC                          TRIJSC
     I              MSIKSC                          TRIKSC
     I              MSK2U1                          TRK2U1
     I              MSW0DT                          TRW0DT
     I              MSUVST                          TRUVST
     I              MSUWST                          TRUWST
     I              MSUXST                          TRUXST
     I              MSVSST                          TRVSST
     I              MSAATM                          TRAATM
     I              MSAYNA                          TRAYNA
     I              MSA0NA                          TRA0NA
     I              MSAXDT                          TRAXDT
      *
     I@B7CPJD
      * Item Transaction Detail   Co/Order/Trans Sel ERR
      * Renamed input format fields
     I              B7AIC3                          TSAIC3
     I              B7HGCD                          TSHGCD
     I              B7AJCD                          TSAJCD
     I              B7W9ST                          TSW9ST
     I              B7BSST                          TSBSST
     I              B7B4DT                          TSB4DT
     I              B7C4NY                          TSC4NY
     I              B7DXNB                          TSDXNB
     I              B7ELDT                          TSELDT
     I              B7HVCD                          TSHVCD
     I              B7F1ST                          TSF1ST
     I              B7AUNA                          TSAUNA
     I              B7A5QT                          TSA5QT
     I              B7AHWG                          TSAHWG
     I              B7AKCS                          TSAKCS
     I              B7CGCD                          TSCGCD
     I              B7AYVA                          TSAYVA
     I              B7BJNA                          TSBJNA
     I              B7CKNB                          TSCKNB
     I              B7BMST                          TSBMST
     I              B7CQCD                          TSCQCD
     I              B7DTCD                          TSDTCD
     I              B7MGNA                          TSMGNA
     I              B7TRBN                          TSTRBN
     I              B7TRBS                          TSTRBS
     I              B7C4NB                          TSC4NB
     I              B7RINB                          TSRINB
     I              B7RHNB                          TSRHNB
     I              B7RGNB                          TSRGNB
     I              B7M3NA                          TSM3NA
     I              B7AWTM                          TSAWTM
     I              B7XLCD                          TSXLCD
     I              B7K7DT                          TSK7DT
     I              B7UVST                          TSUVST
     I              B7UWST                          TSUWST
     I              B7UXST                          TSUXST
     I              B7VSST                          TSVSST
     I              B7AATM                          TSAATM
     I              B7AYNA                          TSAYNA
     I              B7A0NA                          TSA0NA
     I              B7AXDT                          TSAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          TTAIC3
     I              B7HGCD                          TTHGCD
     I              B7AJCD                          TTAJCD
     I              B7W9ST                          TTW9ST
     I              B7BSST                          TTBSST
     I              B7B4DT                          TTB4DT
     I              B7C4NY                          TTC4NY
     I              B7DXNB                          TTDXNB
     I              B7ELDT                          TTELDT
     I              B7HVCD                          TTHVCD
     I              B7F1ST                          TTF1ST
     I              B7AUNA                          TTAUNA
     I              B7A5QT                          TTA5QT
     I              B7AHWG                          TTAHWG
     I              B7AKCS                          TTAKCS
     I              B7CGCD                          TTCGCD
     I              B7AYVA                          TTAYVA
     I              B7BJNA                          TTBJNA
     I              B7CKNB                          TTCKNB
     I              B7BMST                          TTBMST
     I              B7CQCD                          TTCQCD
     I              B7DTCD                          TTDTCD
     I              B7MGNA                          TTMGNA
     I              B7TRBN                          TTTRBN
     I              B7TRBS                          TTTRBS
     I              B7C4NB                          TTC4NB
     I              B7RINB                          TTRINB
     I              B7RHNB                          TTRHNB
     I              B7RGNB                          TTRGNB
     I              B7M3NA                          TTM3NA
     I              B7AWTM                          TTAWTM
     I              B7XLCD                          TTXLCD
     I              B7K7DT                          TTK7DT
     I              B7UVST                          TTUVST
     I              B7UWST                          TTUWST
     I              B7UXST                          TTUXST
     I              B7VSST                          TTVSST
     I              B7AATM                          TTAATM
     I              B7AYNA                          TTAYNA
     I              B7A0NA                          TTA0NA
     I              B7AXDT                          TTAXDT
      *
     I@BMCPE9
      * PFS Ship Order Detail     Co/Ord/TDt(d)/TTm(D) PS=
      * Renamed input format fields
     I              BMY1NX                          TVY1NX
     I              BMAID8                          TVAID8
     I              BMAFTS                          TVAFTS
     I              BMBCNY                          TVBCNY
     I              BMZPNX                          TVZPNX
     I              BMZXNX                          TVZXNX
     I              BMZYNX                          TVZYNX
     I              BMY2NX                          TVY2NX
     I              BMAFD8                          TVAFD8
     I              BMAUNY                          TVAUNY
     I              BMAVNY                          TVAVNY
     I              BMVVSX                          TVVVSX
     I              BMUWSX                          TVUWSX
     I              BMUXSX                          TVUXSX
     I              BMV3SX                          TVV3SX
     I              BMAHNY                          TVAHNY
     I              BMAINY                          TVAINY
     I              BMAJNY                          TVAJNY
     I              BMAKNY                          TVAKNY
      *
     I@BMCPYU
      * PFS Ship Order Detail     Update index
      * Renamed input format fields
     I              BMY1NX                          TWY1NX
     I              BMAID8                          TWAID8
     I              BMAFTS                          TWAFTS
     I              BMBCNY                          TWBCNY
     I              BMZPNX                          TWZPNX
     I              BMZXNX                          TWZXNX
     I              BMZYNX                          TWZYNX
     I              BMY2NX                          TWY2NX
     I              BMAFD8                          TWAFD8
     I              BMAUNY                          TWAUNY
     I              BMAVNY                          TWAVNY
     I              BMVVSX                          TWVVSX
     I              BMUWSX                          TWUWSX
     I              BMUXSX                          TWUXSX
     I              BMV3SX                          TWV3SX
     I              BMAHNY                          TWAHNY
     I              BMAINY                          TWAINY
     I              BMAJNY                          TWAJNY
     I              BMAKNY                          TWAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WIAIC3
     I              EYC4NB                          WIC4NB
     I              EYQ2NB                          WIQ2NB
     I              EYJPCD                          WIJPCD
     I              EYAUC3                          WIAUC3
     I              EYQ7NB                          WIQ7NB
     I              EYOMST                          WIOMST
     I              EYD2DT                          WID2DT
     I              EYONST                          WIONST
     I              EYOOST                          WIOOST
     I              EYOPST                          WIOPST
     I              EYAWC3                          WIAWC3
     I              EYQ8NB                          WIQ8NB
     I              EYQ9NB                          WIQ9NB
     I              EYBKC7                          WIBKC7
     I              EYUVST                          WIUVST
     I              EYUWST                          WIUWST
     I              EYUXST                          WIUXST
     I              EYAATM                          WIAATM
     I              EYAYNA                          WIAYNA
     I              EYA0NA                          WIA0NA
     I              EYAXDT                          WIAXDT
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop/Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
     IQPPBK1    E DSPPBKCPL0
      * UPD : PFS Ship Load/Order Sts   Update index
      * Renamed input format fields
     I              BKY1NX                          WMY1NX
     I              BKAID8                          WMAID8
     I              BKAFTS                          WMAFTS
     I              BKBCNY                          WMBCNY
     I              BKVRSX                          WMVRSX
     I              BKZGNX                          WMZGNX
     I              BKZPNX                          WMZPNX
     I              BKW0SX                          WMW0SX
     I              BKUWSX                          WMUWSX
     I              BKUXSX                          WMUXSX
     I              BKV3SX                          WMV3SX
     I              BKAHNY                          WMAHNY
     I              BKAINY                          WMAINY
     I              BKAJNY                          WMAJNY
     I              BKAKNY                          WMAKNY
      *
     IYBRDCS      DS                             75
     IQPDL81    E DSPDL8CPL0
      * UPD : Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WSAIC3
     I              L8C4NB                          WSC4NB
     I              L8DPNB                          WSDPNB
     I              L8UENB                          WSUENB
     I              L8ALSW                          WSALSW
     I              L8J6QT                          WSJ6QT
     I              L8G9WG                          WSG9WG
     I              L8J9QT                          WSJ9QT
     I              L8HAWG                          WSHAWG
     I              L8IOSE                          WSIOSE
     I              L8OIMN                          WSOIMN
     I              L8SOAS                          WSSOAS
     I              L8ARSX                          WSARSX
     I              L8OTUS                          WSOTUS
     I              L8OTMP                          WSOTMP
     I              L8HGCD                          WSHGCD
     I              L8AJCD                          WSAJCD
     I              L8ELDT                          WSELDT
     I              L8LXNM                          WSLXNM
     I              L8YMCD                          WSYMCD
     I              L8YNCD                          WSYNCD
     I              L8UVST                          WSUVST
     I              L8UWST                          WSUWST
     I              L8UXST                          WSUXST
     I              L8VSST                          WSVSST
     I              L8AATM                          WSAATM
     I              L8AYNA                          WSAYNA
     I              L8A0NA                          WSA0NA
     I              L8AXDT                          WSAXDT
      *
     IQPPBL1    E DSPPBLCPL0
      * UPD : PFS Ship Load Header      Update index
      * Renamed input format fields
     I              BLY1NX                          WVY1NX
     I              BLAID8                          WVAID8
     I              BLAFTS                          WVAFTS
     I              BLBCNY                          WVBCNY
     I              BLZGNX                          WVZGNX
     I              BLAQNY                          WVAQNY
     I              BLVSSX                          WVVSSX
     I              BLBGNY                          WVBGNY
     I              BLV1SX                          WVV1SX
     I              BLGLT1                          WVGLT1
     I              BLGMT1                          WVGMT1
     I              BLGNT1                          WVGNT1
     I              BLG9T1                          WVG9T1
     I              BLGOT1                          WVGOT1
     I              BLVTSX                          WVVTSX
     I              BLARNY                          WVARNY
     I              BLBFNY                          WVBFNY
     I              BLVUSX                          WVVUSX
     I              BLGXT1                          WVGXT1
     I              BLAJD8                          WVAJD8
     I              BLAGTS                          WVAGTS
     I              BLAKD8                          WVAKD8
     I              BLAHTS                          WVAHTS
     I              BLASNY                          WVASNY
     I              BLBHNY                          WVBHNY
     I              BLUWSX                          WVUWSX
     I              BLUXSX                          WVUXSX
     I              BLV3SX                          WVV3SX
     I              BLAHNY                          WVAHNY
     I              BLAINY                          WVAINY
     I              BLAJNY                          WVAJNY
     I              BLAKNY                          WVAKNY
      *
     IYCRDCS      DS                            222
     IYDRDCS      DS                             75
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          TDAIC3
     I              OMC4NB                          TDC4NB
     I              OMDPNB                          TDDPNB
     I              OMUENB                          TDUENB
     I              OMHGCD                          TDHGCD
     I              OMAJCD                          TDAJCD
     I              OMBKC7                          TDBKC7
     I              OMCFC7                          TDCFC7
     I              OMGMST                          TDGMST
     I              OMGNST                          TDGNST
     I              OMMAVA                          TDMAVA
     I              OMKDVA                          TDKDVA
     I              OML8VA                          TDL8VA
     I              OML9VA                          TDL9VA
     I              OMGTST                          TDGTST
     I              OMGVST                          TDGVST
     I              OMGUST                          TDGUST
     I              OMQFST                          TDQFST
     I              OMAYVA                          TDAYVA
     I              OMEXDT                          TDEXDT
     I              OMLQCD                          TDLQCD
     I              OMRDCD                          TDRDCD
     I              OMQ7CD                          TDQ7CD
     I              OMBZPR                          TDBZPR
     I              OML6NB                          TDL6NB
     I              OMU1ST                          TDU1ST
     I              OMGIDT                          TDGIDT
     I              OMCRCD                          TDCRCD
     I              OMAGCD                          TDAGCD
     I              OMRZST                          TDRZST
     I              OMR0ST                          TDR0ST
     I              OMR1ST                          TDR1ST
     I              OMG7NA                          TDG7NA
     I              OMG8NA                          TDG8NA
     I              OMRPCD                          TDRPCD
     I              OMVEST                          TDVEST
     I              OMVGST                          TDVGST
     I              OMAVST                          TDAVST
     I              OMU0ST                          TDU0ST
     I              OMRFCD                          TDRFCD
     I              OMFZST                          TDFZST
     I              OMR1NB                          TDR1NB
     I              OMAVQT                          TDAVQT
     I              OMD0WG                          TDD0WG
     I              OMCCQT                          TDCCQT
     I              OMAUWG                          TDAUWG
     I              OMCBQT                          TDCBQT
     I              OMATWG                          TDATWG
     I              OMAQCS                          TDAQCS
     I              OMAGCS                          TDAGCS
     I              OMAKPR                          TDAKPR
     I              OMALPR                          TDALPR
     I              OMAUPR                          TDAUPR
     I              OMAVWG                          TDAVWG
     I              OMA4WG                          TDA4WG
     I              OMA5DT                          TDA5DT
     I              OMAODT                          TDAODT
     I              OMGNDT                          TDGNDT
     I              OMAMST                          TDAMST
     I              OMANST                          TDANST
     I              OMVAST                          TDVAST
     I              OMRGNB                          TDRGNB
     I              OMRHNB                          TDRHNB
     I              OMRINB                          TDRINB
     I              OMRBCD                          TDRBCD
     I              OMHICD                          TDHICD
     I              OMRNCD                          TDRNCD
     I              OMROCD                          TDROCD
     I              OMCXDT                          TDCXDT
     I              OMAJVN                          TDAJVN
     I              OMKXCD                          TDKXCD
     I              OMJPCD                          TDJPCD
     I              OMCQCD                          TDCQCD
     I              OMR4CD                          TDR4CD
     I              OMZ1ST                          TDZ1ST
     I              OMZ3ST                          TDZ3ST
     I              OMZ4ST                          TDZ4ST
     I              OMDUPR                          TDDUPR
     I              OMB6VL                          TDB6VL
     I              OMA1AA                          TDA1AA
     I              OMFZSX                          TDFZSX
     I              OMF0SX                          TDF0SX
     I              OMF1SX                          TDF1SX
     I              OMF2SX                          TDF2SX
     I              OMF3SX                          TDF3SX
     I              OMF4SX                          TDF4SX
     I              OMF5SX                          TDF5SX
     I              OMF6SX                          TDF6SX
     I              OMF7SX                          TDF7SX
     I              OMNTDT                          TDNTDT
     I              OMNUDT                          TDNUDT
     I              OMNVDT                          TDNVDT
     I              OMNWDT                          TDNWDT
     I              OMNXDT                          TDNXDT
     I              OMBUTM                          TDBUTM
     I              OMBVTM                          TDBVTM
     I              OMBWTM                          TDBWTM
     I              OMBXTM                          TDBXTM
     I              OMBYTM                          TDBYTM
     I              OMH5NX                          TDH5NX
     I              OMH6NX                          TDH6NX
     I              OMH7NX                          TDH7NX
     I              OMH8NX                          TDH8NX
     I              OMH9NX                          TDH9NX
     I              OMDVPR                          TDDVPR
     I              OMDWPR                          TDDWPR
     I              OMDXPR                          TDDXPR
     I              OMDYPR                          TDDYPR
     I              OMDZPR                          TDDZPR
     I              OMGSPR                          TDGSPR
     I              OMGTPR                          TDGTPR
     I              OMGUPR                          TDGUPR
     I              OMHOST                          TDHOST
     I              OMHPST                          TDHPST
     I              OMIOST                          TDIOST
     I              OMPEWG                          TDPEWG
     I              OMRINY                          TDRINY
     I              OMTIDT                          TDTIDT
     I              OMTJDT                          TDTJDT
     I              OMH2ST                          TDH2ST
     I              OMH0ST                          TDH0ST
     I              OMH1ST                          TDH1ST
     I              OMTKDT                          TDTKDT
     I              OMTLDT                          TDTLDT
     I              OMTMDT                          TDTMDT
     I              OMUVST                          TDUVST
     I              OMUWST                          TDUWST
     I              OMUXST                          TDUXST
     I              OMAATM                          TDAATM
     I              OMAYNA                          TDAYNA
     I              OMA0NA                          TDA0NA
     I              OMAXDT                          TDAXDT
      *
     IYERDCS      DS                            525
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          TGAIC3
     I              L7HGCD                          TGHGCD
     I              L7AJCD                          TGAJCD
     I              L7LTRT                          TGLTRT
     I              L7LRDT                          TGLRDT
     I              L7LLTS                          TGLLTS
     I              L7LSDT                          TGLSDT
     I              L7J5QT                          TGJ5QT
     I              L7G8WG                          TGG8WG
     I              L7LLTN                          TGLLTN
     I              L7YMCD                          TGYMCD
     I              L7LLCL                          TGLLCL
     I              L7BNAA                          TGBNAA
     I              L7LLTR                          TGLLTR
     I              L7Y2CD                          TGY2CD
     I              L7LLTL                          TGLLTL
     I              L7C4NB                          TGC4NB
     I              L7LOST                          TGLOST
     I              L7LLTU                          TGLLTU
     I              L7LLYT                          TGLLYT
     I              L7UVST                          TGUVST
     I              L7UWST                          TGUWST
     I              L7UXST                          TGUXST
     I              L7VSST                          TGVSST
     I              L7AATM                          TGAATM
     I              L7AYNA                          TGAYNA
     I              L7A0NA                          TGA0NA
     I              L7AXDT                          TGAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          TKAIC3
     I              L5HGCD                          TKHGCD
     I              L5AJCD                          TKAJCD
     I              L5ELDT                          TKELDT
     I              L5LXNM                          TKLXNM
     I              L5YMCD                          TKYMCD
     I              L5YNCD                          TKYNCD
     I              L5J2QT                          TKJ2QT
     I              L5G5WG                          TKG5WG
     I              L5J3QT                          TKJ3QT
     I              L5G6WG                          TKG6WG
     I              L5J4QT                          TKJ4QT
     I              L5G7WG                          TKG7WG
     I              L5LODT                          TKLODT
     I              L5LPDT                          TKLPDT
     I              L5LQDT                          TKLQDT
     I              L5NBR                           TKNBR
     I              L5YTCD                          TKYTCD
     I              L5AMSX                          TKAMSX
     I              L5ASSX                          TKASSX
     I              L5ATSX                          TKATSX
     I              L5AUSX                          TKAUSX
     I              L5YSCD                          TKYSCD
     I              L5UVST                          TKUVST
     I              L5UWST                          TKUWST
     I              L5UXST                          TKUXST
     I              L5VSST                          TKVSST
     I              L5AATM                          TKAATM
     I              L5AYNA                          TKAYNA
     I              L5A0NA                          TKA0NA
     I              L5AXDT                          TKAXDT
      *
     IYFRDCS      DS                            111
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TLAIC3
     I              B1HGCD                          TLHGCD
     I              B1AJCD                          TLAJCD
     I              B1ELDT                          TLELDT
     I              B1ABWG                          TLABWG
     I              B1AGQT                          TLAGQT
     I              B1AHQT                          TLAHQT
     I              B1AIQT                          TLAIQT
     I              B1CTST                          TLCTST
     I              B1ACWG                          TLACWG
     I              B1ARQT                          TLARQT
     I              B1ASQT                          TLASQT
     I              B1ATQT                          TLATQT
     I              B1HDQT                          TLHDQT
     I              B1HEQT                          TLHEQT
     I              B1F6ST                          TLF6ST
     I              B1BMWG                          TLBMWG
     I              B1DSQT                          TLDSQT
     I              B1DTQT                          TLDTQT
     I              B1DUQT                          TLDUQT
     I              B1DHDT                          TLDHDT
     I              B1AGCS                          TLAGCS
     I              B1AECS                          TLAECS
     I              B1IDVA                          TLIDVA
     I              B1K7DT                          TLK7DT
     I              B1RINB                          TLRINB
     I              B1RHNB                          TLRHNB
     I              B1RGNB                          TLRGNB
     I              B1UVST                          TLUVST
     I              B1UWST                          TLUWST
     I              B1UXST                          TLUXST
     I              B1VSST                          TLVSST
     I              B1AATM                          TLAATM
     I              B1AYNA                          TLAYNA
     I              B1A0NA                          TLA0NA
     I              B1AXDT                          TLAXDT
      *
     IYGRDCS      DS                             91
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          TMRMNB
     I              FJAIC3                          TMAIC3
     I              FJAODT                          TMAODT
     I              FJPJST                          TMPJST
     I              FJPKST                          TMPKST
     I              FJRNNB                          TMRNNB
     I              FJDMTX                          TMDMTX
     I              FJDNTX                          TMDNTX
     I              FJDOTX                          TMDOTX
     I              FJWTTX                          TMWTTX
     I              FJWUTX                          TMWUTX
     I              FJRPNB                          TMRPNB
     I              FJFLAM                          TMFLAM
     I              FJXQST                          TMXQST
     I              FJRRNB                          TMRRNB
     I              FJDXTX                          TMDXTX
     I              FJDYTX                          TMDYTX
     I              FJSBNB                          TMSBNB
     I              FJBZNA                          TMBZNA
     I              FJRONB                          TMRONB
     I              FJSQNB                          TMSQNB
     I              FJR1NB                          TMR1NB
     I              FJVCST                          TMVCST
     I              FJVDST                          TMVDST
     I              FJSDNB                          TMSDNB
     I              FJPAOU                          TMPAOU
     I              FJDGWG                          TMDGWG
     I              FJSXNB                          TMSXNB
     I              FJHADT                          TMHADT
     I              FJAART                          TMAART
     I              FJDHWG                          TMDHWG
     I              FJDIWG                          TMDIWG
     I              FJAQDT                          TMAQDT
     I              FJS6NB                          TMS6NB
     I              FJT4NB                          TMT4NB
     I              FJPRTM                          TMPRTM
     I              FJNPSV                          TMNPSV
     I              FJJ8TX                          TMJ8TX
     I              FJTLMI                          TMTLMI
     I              FJJ9TX                          TMJ9TX
     I              FJQ2CD                          TMQ2CD
     I              FJVPCD                          TMVPCD
     I              FJDBCD                          TMDBCD
     I              FJGRWE                          TMGRWE
     I              FJXCCD                          TMXCCD
     I              FJU2ST                          TMU2ST
     I              FJF9DT                          TMF9DT
     I              FJONTM                          TMONTM
     I              FJJ4DT                          TMJ4DT
     I              FJTRTM                          TMTRTM
     I              FJJ5DT                          TMJ5DT
     I              FJSPTM                          TMSPTM
     I              FJJ6DT                          TMJ6DT
     I              FJLFTM                          TMLFTM
     I              FJJ7DT                          TMJ7DT
     I              FJBOTM                          TMBOTM
     I              FJJ8DT                          TMJ8DT
     I              FJBLTM                          TMBLTM
     I              FJKIDT                          TMKIDT
     I              FJASTM                          TMASTM
     I              FJKADT                          TMKADT
     I              FJAJCM                          TMAJCM
     I              FJXACD                          TMXACD
     I              FJOANA                          TMOANA
     I              FJK4TX                          TMK4TX
     I              FJVOAG                          TMVOAG
     I              FJKBDT                          TMKBDT
     I              FJNBBO                          TMNBBO
     I              FJW4CD                          TMW4CD
     I              FJEFDT                          TMEFDT
     I              FJCNTN                          TMCNTN
     I              FJKCDT                          TMKCDT
     I              FJTMIN                          TMTMIN
     I              FJKDDT                          TMKDDT
     I              FJVMNB                          TMVMNB
     I              FJOCFR                          TMOCFR
     I              FJKJDT                          TMKJDT
     I              FJATTM                          TMATTM
     I              FJOTRS                          TMOTRS
     I              FJRNST                          TMRNST
     I              FJBRBK                          TMBRBK
     I              FJEIDT                          TMEIDT
     I              FJRMST                          TMRMST
     I              FJAJCD                          TMAJCD
     I              FJKKDT                          TMKKDT
     I              FJAVTM                          TMAVTM
     I              FJKZDT                          TMKZDT
     I              FJAXTM                          TMAXTM
     I              FJLHOS                          TMLHOS
     I              FJLHOR                          TMLHOR
     I              FJWNTX                          TMWNTX
     I              FJOITX                          TMOITX
     I              FJOJTX                          TMOJTX
     I              FJLLDT                          TMLLDT
     I              FJLSHG                          TMLSHG
     I              FJYPST                          TMYPST
     I              FJK0DT                          TMK0DT
     I              FJAYTM                          TMAYTM
     I              FJKNNX                          TMKNNX
     I              FJICWG                          TMICWG
     I              FJIDWG                          TMIDWG
     I              FJH9SX                          TMH9SX
     I              FJWOTX                          TMWOTX
     I              FJK1DT                          TMK1DT
     I              FJAZTM                          TMAZTM
     I              FJK2DT                          TMK2DT
     I              FJA0TM                          TMA0TM
     I              FJROST                          TMROST
     I              FJRPST                          TMRPST
     I              FJRQST                          TMRQST
     I              FJRRST                          TMRRST
     I              FJZBVA                          TMZBVA
     I              FJWPTX                          TMWPTX
     I              FJWQTX                          TMWQTX
     I              FJWRTX                          TMWRTX
     I              FJWSTX                          TMWSTX
     I              FJRVSX                          TMRVSX
     I              FJRUSX                          TMRUSX
     I              FJRWSX                          TMRWSX
     I              FJRXSX                          TMRXSX
     I              FJRYSX                          TMRYSX
     I              FJRZSX                          TMRZSX
     I              FJR0SX                          TMR0SX
     I              FJR1SX                          TMR1SX
     I              FJR2SX                          TMR2SX
     I              FJR3SX                          TMR3SX
     I              FJR4SX                          TMR4SX
     I              FJPYDT                          TMPYDT
     I              FJCKTM                          TMCKTM
     I              FJPZDT                          TMPZDT
     I              FJCLTM                          TMCLTM
     I              FJP0DT                          TMP0DT
     I              FJCMTM                          TMCMTM
     I              FJP1DT                          TMP1DT
     I              FJCNTM                          TMCNTM
     I              FJP2DT                          TMP2DT
     I              FJCOTM                          TMCOTM
     I              FJP3DT                          TMP3DT
     I              FJCQTM                          TMCQTM
     I              FJUVST                          TMUVST
     I              FJUWST                          TMUWST
     I              FJUXST                          TMUXST
     I              FJAATM                          TMAATM
     I              FJAYNA                          TMAYNA
     I              FJA0NA                          TMA0NA
     I              FJAXDT                          TMAXDT
      *
     IYHRDCS      DS                            793
     IYIRDCS      DS                            779
     IYJRDCS      DS                            793
     IQPDMS1    E DSPDMSREL0
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          TRAIC3
     I              MSC4NB                          TRC4NB
     I              MSDGSX                          TRDGSX
     I              MSKXCD                          TRKXCD
     I              MSDPNB                          TRDPNB
     I              MSUENB                          TRUENB
     I              MSDIC7                          TRDIC7
     I              MSO3NA                          TRO3NA
     I              MSO4NA                          TRO4NA
     I              MSRMTX                          TRRMTX
     I              MSPTTX                          TRPTTX
     I              MSHJWG                          TRHJWG
     I              MSHKWG                          TRHKWG
     I              MSRNTX                          TRRNTX
     I              MSAONX                          TRAONX
     I              MSROTX                          TRROTX
     I              MSORNA                          TRORNA
     I              MSAMNX                          TRAMNX
     I              MSANNX                          TRANNX
     I              MSAPNX                          TRAPNX
     I              MSDKPR                          TRDKPR
     I              MSA9VL                          TRA9VL
     I              MSC8SX                          TRC8SX
     I              MSRATX                          TRRATX
     I              MSRBTX                          TRRBTX
     I              MSAJNX                          TRAJNX
     I              MSZWTX                          TRZWTX
     I              MSZXTX                          TRZXTX
     I              MSZYTX                          TRZYTX
     I              MSZZTX                          TRZZTX
     I              MSK0U1                          TRK0U1
     I              MSK1U1                          TRK1U1
     I              MSIJSC                          TRIJSC
     I              MSIKSC                          TRIKSC
     I              MSK2U1                          TRK2U1
     I              MSW0DT                          TRW0DT
     I              MSUVST                          TRUVST
     I              MSUWST                          TRUWST
     I              MSUXST                          TRUXST
     I              MSVSST                          TRVSST
     I              MSAATM                          TRAATM
     I              MSAYNA                          TRAYNA
     I              MSA0NA                          TRA0NA
     I              MSAXDT                          TRAXDT
      *
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          TTAIC3
     I              B7HGCD                          TTHGCD
     I              B7AJCD                          TTAJCD
     I              B7W9ST                          TTW9ST
     I              B7BSST                          TTBSST
     I              B7B4DT                          TTB4DT
     I              B7C4NY                          TTC4NY
     I              B7DXNB                          TTDXNB
     I              B7ELDT                          TTELDT
     I              B7HVCD                          TTHVCD
     I              B7F1ST                          TTF1ST
     I              B7AUNA                          TTAUNA
     I              B7A5QT                          TTA5QT
     I              B7AHWG                          TTAHWG
     I              B7AKCS                          TTAKCS
     I              B7CGCD                          TTCGCD
     I              B7AYVA                          TTAYVA
     I              B7BJNA                          TTBJNA
     I              B7CKNB                          TTCKNB
     I              B7BMST                          TTBMST
     I              B7CQCD                          TTCQCD
     I              B7DTCD                          TTDTCD
     I              B7MGNA                          TTMGNA
     I              B7TRBN                          TTTRBN
     I              B7TRBS                          TTTRBS
     I              B7C4NB                          TTC4NB
     I              B7RINB                          TTRINB
     I              B7RHNB                          TTRHNB
     I              B7RGNB                          TTRGNB
     I              B7M3NA                          TTM3NA
     I              B7AWTM                          TTAWTM
     I              B7XLCD                          TTXLCD
     I              B7K7DT                          TTK7DT
     I              B7UVST                          TTUVST
     I              B7UWST                          TTUWST
     I              B7UXST                          TTUXST
     I              B7VSST                          TTVSST
     I              B7AATM                          TTAATM
     I              B7AYNA                          TTAYNA
     I              B7A0NA                          TTA0NA
     I              B7AXDT                          TTAXDT
      *
     IYKRDCS      DS                            192
     IQPPBM1    E DSPPBMCPL0
      * UPD : PFS Ship Order Detail     Update index
      * Renamed input format fields
     I              BMY1NX                          TWY1NX
     I              BMAID8                          TWAID8
     I              BMAFTS                          TWAFTS
     I              BMBCNY                          TWBCNY
     I              BMZPNX                          TWZPNX
     I              BMZXNX                          TWZXNX
     I              BMZYNX                          TWZYNX
     I              BMY2NX                          TWY2NX
     I              BMAFD8                          TWAFD8
     I              BMAUNY                          TWAUNY
     I              BMAVNY                          TWAVNY
     I              BMVVSX                          TWVVSX
     I              BMUWSX                          TWUWSX
     I              BMUXSX                          TWUXSX
     I              BMV3SX                          TWV3SX
     I              BMAHNY                          TWAHNY
     I              BMAINY                          TWAINY
     I              BMAJNY                          TWAJNY
     I              BMAKNY                          TWAKNY
      *
     IYLRDCS      DS                            101
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PFS Billing Notify-Picked'
      * PFS Load ID
     I                                    P   1   40ZA0001
      * PFS Order Number
     I                                    P   5   80ZA0002
      * Condition Name USR
     I                                        9  33 ZA0003
      * Message data for 'PFS Billing Notify-Order'
      * PFS Load ID
     I                                    P   1   40ZA0004
      * PFS Order Number
     I                                    P   5   80ZA0005
      * Condition Name USR
     I                                        9  33 ZA0006
      * Message data for 'PFS Billing Notify-Load'
      * PFS Load ID
     I                                    P   1   40ZA0007
      * PFS Order Number
     I                                    P   5   80ZA0008
      * Condition Name USR
     I                                        9  33 ZA0009
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Ship Status       XF
      * PFS Ship Status       RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * CHG Load Status/ActShp CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0699  30       Company Number
     C                     MOVEL*BLANK    WN0700  1        LTL Flag
     C                     Z-ADD*ZERO     WN0701  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0702 15        Seal 1
     C                     MOVEL*BLANK    WN0703 15        Seal 2
     C                     MOVEL*BLANK    WN0704 15        Seal 3
     C                     MOVEL*BLANK    WN0705 15        Seal 4
     C                     MOVEL*BLANK    WN0706 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0707  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0708 112       Flat Amount
     C                     MOVEL*BLANK    WN0709  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0710  50       Total Stops
     C                     MOVEL*BLANK    WN0711 20        Trailer Id
     C                     MOVEL*BLANK    WN0712  3        Transloader Car
     C                     Z-ADD*ZERO     WN0713  40       BOL Time
     C                     MOVEL*BLANK    WN0714  3        Carrier Code
     C                     MOVEL*BLANK    WN0715  7        Truck Size
     C                     Z-ADD*ZERO     WN0716  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0717 112       Rated Freight
     C                     MOVEL*BLANK    WN0718  1        Ship Status
     C                     MOVEL*BLANK    WN0719  1        Load Type
     C                     Z-ADD*ZERO     WN0720  50       Number Pallets
     C                     Z-ADD*ZERO     WN0721  50       Number Pallets
     C                     Z-ADD*ZERO     WN0722 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0723  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0724  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0725  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0726 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0727 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0728  70       Actual Departur
     C                     Z-ADD*ZERO     WN0729  40       Departure Time
     C                     Z-ADD*ZERO     WN0730  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0731  52       Product Tempera
     C                     Z-ADD*ZERO     WN0732  50       Number Spacers
     C                     MOVEL*BLANK    WN0733 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0734  70       Total Load Mile
     C                     MOVEL*BLANK    WN0735 12        Recorder ID
     C                     MOVEL*BLANK    WN0736  2        Shipping Method
     C                     MOVEL*BLANK    WN0737  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0738  2        Ship To State C
     C                     Z-ADD*ZERO     WN0739  70       Gross Weight
     C                     MOVEL*BLANK    WN0740  3        Carrier Broker
     C                     MOVEL*BLANK    WN0741  1        Export Status
     C                     MOVEL*BLANK    WN0742  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0743  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0744  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0745  70       Spotted Date
     C                     Z-ADD*ZERO     WN0746  60       Spotted Time
     C                     Z-ADD*ZERO     WN0747  70       Load Finished D
     C                     Z-ADD*ZERO     WN0748  60       Load Finished T
     C                     Z-ADD*ZERO     WN0749  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0750  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0751  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0752  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0753  70       Truck Departure
     C                     Z-ADD*ZERO     WN0754  60       Truck Departure
     C                     Z-ADD*ZERO     WN0755  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0756  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0757  3        Shipping Line
     C                     MOVEL*BLANK    WN0758 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0759 30        Vessel Name
     C                     Z-ADD*ZERO     WN0760  50       Voyage
     C                     Z-ADD*ZERO     WN0761  70       Sail Date
     C                     MOVEL*BLANK    WN0762 12        Booking Number
     C                     MOVEL*BLANK    WN0763 20        Discharge Port
     C                     Z-ADD*ZERO     WN0764  70       Arrival Date
     C                     MOVEL*BLANK    WN0765 12        Container Numbe
     C                     Z-ADD*ZERO     WN0766  70       Date In
     C                     Z-ADD*ZERO     WN0767  60       Time In
     C                     Z-ADD*ZERO     WN0768  70       Date Out
     C                     Z-ADD*ZERO     WN0769  60       Time Out
     C                     Z-ADD*ZERO     WN0770 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0771  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0772  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0773  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0774  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0775  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0776  70       Requested Deliv
     C                     MOVEL*BLANK    WN0777  1        Load Acceptance
     C                     MOVEL*BLANK    WN0778  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0779  70       On Yard Date
     C                     Z-ADD*ZERO     WN0780  60       On Yard Time
     C                     Z-ADD*ZERO     WN0781  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0782  60       Deadline Depart
     C                     MOVEL*BLANK    WN0783  1        Load Held Over
     C                     MOVEL*BLANK    WN0784  1        Load Held Over
     C                     MOVEL*BLANK    WN0785 15        Load Held Over
     C                     MOVEL*BLANK    WN0786 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0787 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0788  70       Express Mail Da
     C                     MOVEL*BLANK    WN0789  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0790  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0791  70       Product Complet
     C                     Z-ADD*ZERO     WN0792  60       Product Complet
     C                     Z-ADD*ZERO     WN0793  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0794  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0795  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0796  1        Load Confirmed
     C                     MOVEL*BLANK    WN0797 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0798  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0799  60       Load Door 1
     C                     Z-ADD*ZERO     WN0800  70       Override Total
     C                     Z-ADD*ZERO     WN0801  60       Load Door 2
     C                     MOVEL*BLANK    WN0802  1        Partial Load
     C                     MOVEL*BLANK    WN0803  1        Load Confirmati
     C                     MOVEL*BLANK    WN0804  1        Export Load USD
     C                     MOVEL*BLANK    WN0805  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0806 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0807 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0808 15        Late Billing Em
     C                     MOVEL*BLANK    WN0809 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0810 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0811  1        Multi Company L
     C                     MOVEL*BLANK    WN0812  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0813  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0814  1        LH Power Only L
     C                     MOVEL*BLANK    WN0815  1        MG Created Load
     C                     MOVEL*BLANK    WN0816  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0817  2        Load U/M
     C                     MOVEL*BLANK    WN0818  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0819  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0820  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0821  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0822  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0823  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0824  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0825  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0826  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0827  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0828  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0829  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0830  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0831  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0832  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0833  60       LH Unused Time
     C                     MOVEL*BLANK    WN0834  1        EDI Status 1
     C                     MOVEL*BLANK    WN0835  1        EDI Status 2
     C                     MOVEL*BLANK    WN0836  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0837  60       Job Time
     C                     MOVEL*BLANK    WN0838 10        User Id
     C                     MOVEL*BLANK    WN0839 10        Job Name
     C                     Z-ADD*ZERO     WN0840  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWN0010    TMRMNB           Load ID
      *
     C           KLCHNA    KLIST
     C                     KFLD           TMRMNB           Load ID
     C           KLCHNA    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YJRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0009    TMAODT           Scheduled Ship
     C                     MOVEL'L'       TMPKST    P      Load Status
     C                     Z-ADD0         TMF9DT           Actual Ship Dat
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     TMAATM           Job Time
     C                     MOVEL##USR     TMAYNA           User Id
     C                     MOVEL##JOB     TMA0NA           Job Name
     C                     Z-ADD##JDT     TMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Rtv & Dlt for Cancel  RT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TOAIC3    WQNB01           Company Number
     C           *LIKE     DEFN TOC4NB    WQNB02           Order Number
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WQNB01           Company Number
     C                     KFLD           WQNB02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQNB01           Company Number
     C                     Z-ADDWN0004    WQNB02           Order Number
      * Establish starting position
     C           KRSNB     SETLL@MSREX2                    *
     C           KRSNB     READE@MSREX2                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
     C                     EXSR NCDLRC
     C           KRSNB     READE@MSREX2                  90*
     C                     ENDDO
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCDLRC    BEGSR
      *================================================================
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @MSREW4
     C                     Z-ADDTOAIC3    TRAIC3           Company Number
     C                     Z-ADDTOC4NB    TRC4NB           Order Number
     C                     MOVELTODGSX    TRDGSX           ED Export Docum
     C                     MOVELTOKXCD    TRKXCD           Country Code
     C                     Z-ADDTODPNB    TRDPNB           Order Sequence
     C                     Z-ADDTOUENB    TRUENB           Order Secondary
      *
     C           KLDLNC    KLIST
     C                     KFLD           TRAIC3           Company Number
     C                     KFLD           TRC4NB           Order Number
     C                     KFLD           TRDGSX           ED Export Docum
     C                     KFLD           TRKXCD           Country Code
     C                     KFLD           TRDPNB           Order Sequence
     C                     KFLD           TRUENB           Order Secondary
     C           KLDLNC    CHAIN@MSREW4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMSREL0'MDACP
     C                     MOVEL'@MSREW4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@MSREW4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * UPD Err Transactions   RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TSAIC3    WQND01           Company Number
     C           *LIKE     DEFN TSC4NB    WQND02           Order Number
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND01           Company Number
     C                     KFLD           WQND02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQND01           Company Number
     C                     Z-ADDWN0004    WQND02           Order Number
      * Establish starting position
     C           KRSND     SETLL@B7CPJD                    *
     C           KRSND     READE@B7CPJD                  90*
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Reason Code        CH - Item Transaction Detail  * 
     C                     EXSR NECHRC
     C           KRSND     READE@B7CPJD                  90*
     C                     ENDDO
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NECHRC    BEGSR
      *================================================================
      * CHG Reason Code        CH - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0841  70       Production Date
     C                     MOVEL*BLANK    WN0842  2        U/M - Transacti
     C                     MOVEL*BLANK    WN0843  2        Item Transactio
     C                     MOVEL*BLANK    WN0844 30        Description
     C                     Z-ADD*ZERO     WN0845 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0846 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0847 114       USR Transaction
     C                     MOVEL*BLANK    WN0848  2        U/M - Cost
     C                     Z-ADD*ZERO     WN0849 112       Extended Amount
     C                     MOVEL*BLANK    WN0850  6        Ticket Number
     C                     Z-ADD*ZERO     WN0851  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0852  1        G/L Update Stat
     C                     MOVEL*BLANK    WN0853 15        Reference Numbe
     C                     MOVEL*BLANK    WN0854 10        Lot ID
     C                     Z-ADD*ZERO     WN0855  70       Transfer Batch
     C                     Z-ADD*ZERO     WN0856  30       Transfer Batch
     C                     Z-ADD*ZERO     WN0857  70       Order Number
     C                     Z-ADD*ZERO     WN0858  30       Item Structure
     C                     Z-ADD*ZERO     WN0859  30       Item Structure
     C                     Z-ADD*ZERO     WN0860  30       Item Structure
     C                     MOVEL*BLANK    WN0861 10        Employee Badge
     C                     Z-ADD*ZERO     WN0862  60       Production Time
     C                     MOVEL*BLANK    WN0863  1        Shift Number
     C                     Z-ADD*ZERO     WN0864  70       Label Date
     C                     MOVEL*BLANK    WN0865  1        EDI Status 1
     C                     MOVEL*BLANK    WN0866  1        EDI Status 2
     C                     MOVEL*BLANK    WN0867  1        EDI Status 3
     C                     MOVEL*BLANK    WN0868  1        Record Status
     C                     Z-ADD*ZERO     WN0869  60       Job Time
     C                     MOVEL*BLANK    WN0870 10        User Id
     C                     MOVEL*BLANK    WN0871 10        Job Name
     C                     Z-ADD*ZERO     WN0872  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @B7CPJZ
     C                     Z-ADDTSAIC3    TTAIC3           Company Number
     C                     Z-ADDTSHGCD    TTHGCD           Item Code
     C                     MOVELTSAJCD    TTAJCD    P      Warehouse Code
     C                     MOVELTSW9ST    TTW9ST    P      Inventory Trans
     C                     MOVELTSBSST    TTBSST    P      Inventory Trans
     C                     Z-ADDTSB4DT    TTB4DT           Transaction Dat
     C                     Z-ADDTSC4NY    TTC4NY           ITD Sequence Nu
     C                     Z-ADDTSDXNB    TTDXNB           Sequence Number
      *
     C           KLCHNE    KLIST
     C                     KFLD           TTAIC3           Company Number
     C                     KFLD           TTHGCD           Item Code
     C                     KFLD           TTAJCD           Warehouse Code
     C                     KFLD           TTW9ST           Inventory Trans
     C                     KFLD           TTBSST           Inventory Trans
     C                     KFLD           TTB4DT           Transaction Dat
     C                     KFLD           TTC4NY           ITD Sequence Nu
     C                     KFLD           TTDXNB           Sequence Number
     C           KLCHNE    CHAIN@B7CPJZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB7CPL0'MDACP
     C                     MOVEL'@B7CPJZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB71    YKRDCS
      * Move non-key fields to @B7CPJZ
     C                     MOVEL*BLANK    TTCQCD    P      Reason Code
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * 01/29/02 PKD Do not change the Record Stamp per Tom Dye. This
      *              causes inaccurate reporting on the Item Transaction
      *              Journal.
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@B7CPJZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB7CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Upd Detail -Unshipped RT - PFS Ship Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TVY1NX    WQNF01           PFS Company Num
     C           *LIKE     DEFN TVZPNX    WQNF02           PFS Order Numbe
      * Define keylist
     C           KPSNF     KLIST
     C                     KFLD           WQNF01           PFS Company Num
     C                     KFLD           WQNF02           PFS Order Numbe
     C                     KFLD           TVAID8           PFS Transaction
     C                     KFLD           TVAFTS           PFS Transaction
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           PFS Company Num
     C                     KFLD           WQNF02           PFS Order Numbe
      * Setup key
     C                     Z-ADDWAY1NX    WQNF01           PFS Company Num
     C                     Z-ADDWAZPNX    WQNF02           PFS Order Numbe
     C                     Z-ADDWAAID8    TVAID8           PFS Transaction
     C                     Z-ADDWAAFTS    TVAFTS           PFS Transaction
      * Establish starting position
     C           KPSNF     SETLL@BMCPE9                    *
     C           KRSNF     READE@BMCPE9                  90*
      * Data record not found
     C   90                MOVEL'USR3508' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Transaction Date EQ PAR.PFS Transaction Date
      *   |- c2    : DB1.PFS Transaction Time EQ PAR.PFS Transaction Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TVAID8    IFEQ WAAID8                     *IF
     C           TVAFTS    IFEQ WAAFTS                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PrcSts/ErrRsn     CH - PFS Ship Order Detail  * 
     C                     EXSR NGCHRC
     C                     END                             *FI
     C           KRSNF     READE@BMCPE9                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Ship Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0873  70       PFS Item Code
     C                     Z-ADD*ZERO     WN0874  80       PFS Actual Ship
     C                     Z-ADD*ZERO     WN0875  50       PFS Shipped Qua
     C                     Z-ADD*ZERO     WN0876  82       PFS Shipped Wei
     C                     MOVEL*BLANK    WN0877  2        PFS Short/Over
     C                     MOVEL*BLANK    WN0878  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0879  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0880  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0881  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0882  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @BMCPYU
     C                     Z-ADDTVY1NX    TWY1NX           PFS Company Num
     C                     Z-ADDTVAID8    TWAID8           PFS Transaction
     C                     Z-ADDTVAFTS    TWAFTS           PFS Transaction
     C                     Z-ADDTVBCNY    TWBCNY           PFS Transaction
      *
     C           KLCHNG    KLIST
     C                     KFLD           TWY1NX           PFS Company Num
     C                     KFLD           TWAID8           PFS Transaction
     C                     KFLD           TWAFTS           PFS Transaction
     C                     KFLD           TWBCNY           PFS Transaction
     C           KLCHNG    CHAIN@BMCPYU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBMCPL0'MDACP
     C                     MOVEL'@BMCPYU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBM1    YLRDCS
      * Move non-key fields to @BMCPYU
     C                     Z-ADDTVZPNX    TWZPNX           PFS Order Numbe
     C                     Z-ADDTVZXNX    TWZXNX           PFS Order Line
     C                     Z-ADDTVZYNX    TWZYNX           PFS Substitutio
     C                     Z-ADD3         TWUXSX           PFS Process Sta
     C                     MOVEL'REOPN'   TWV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBM1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@BMCPYU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBMCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PFS Ship Status       RT - PFS Ship Load/Order Sts  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0002  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0003  30       Company Number
     C                     Z-ADD*ZERO     WN0004  70       Order Number
     C                     MOVEL*BLANK    WN0005  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0006  70       Ship To Custome
     C                     MOVEL*BLANK    WN0007  3        Carrier Code
     C                     MOVEL*BLANK    WN0008  1        Header Status
     C                     Z-ADD*ZERO     WN0009  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0010  70       Load ID
     C                     MOVEL*BLANK    WN0011  2        Event Code
     C                     MOVEL*BLANK    WN0012  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0013  1        Billing Activit
     C                     Z-ADD*ZERO     WN0014  50       Event Number
     C                     MOVEL*BLANK    WN0015  1        Error Status
     C                     MOVEL*BLANK    WN0016  1        Load Status
     C                     MOVEL*BLANK    WN0017  3        Warehouse Code
     C                     MOVEL*BLANK    WN0018  1        Record Found US
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@BKCPA1                    *
     C                     READ @BKCPA1                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
     C                     Z-ADD*ZERO     WN0003           Company Number
     C                     Z-ADD*ZERO     WN0004           Order Number
     C                     MOVEL*BLANK    WN0005           Order Type - Sa
     C                     Z-ADD*ZERO     WN0006           Ship To Custome
     C                     MOVEL*BLANK    WN0007           Carrier Code
     C                     MOVEL*BLANK    WN0008           Header Status
     C                     Z-ADD*ZERO     WN0009           Scheduled Ship
     C                     Z-ADD*ZERO     WN0010           Load ID
     C                     MOVEL*BLANK    WN0011           Event Code
     C                     MOVEL*BLANK    WN0012           Trans Contol AS
     C                     MOVEL*BLANK    WN0013           Billing Activit
     C                     Z-ADD*ZERO     WN0014           Event Number
     C                     MOVEL*BLANK    WN0015           Error Status
     C                     MOVEL*BLANK    WN0016           Load Status
     C                     MOVEL*BLANK    WN0017           Warehouse Code
     C                     MOVEL*BLANK    WN0018           Record Found US
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADDWAUXSX    WN0001           PFS Process Sta
      * VALIDATE
     C                     EXSR UASUBR                     VALIDATE
      * PROCESS:  Selected Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: DB1.PFS Ship Status is Pick Order
     C           WAVRSX    IFEQ 'PO'                       *IF
      * UPD:  Order Header * Order Events
      * CASE: WRK.#Sequence Block is NULL
     C           WUZRST    IFEQ *BLANK                     *IF
      * RTV Check Pick Event   RT - Order Events  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
      * RTV Next Event Number  RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0003    WL0003           Company Number
     C                     Z-ADDWN0004    WL0004           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WN0014           Event Number
      * CRT Create Pick Event  RT - Order Events  * 
     C                     EXSR SKRVGN
      * UPD:  Order Header Event Code
      * CASE: PAR.Event Code is Open Orders
     C           WN0011    IFLT '04'                       *IF
      * CHG Event Code    PFS RT - Order Header TRG  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
      * E00181 - 6.25.08 new warning msg in case a PO is proc for an UNLO
      * CASE: PAR.Load Status is Unlock
     C           WN0016    IFEQ 'U'                        *IF
      * LCL.Condition Name USR = Condition name of DB1.PFS Ship Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1731617   Y2LSNO  70       List number
     C                     PARM WAVRSX    W0INVL 25        PFS Ship Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           YL0005    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     Z-ADDWAZGNX    ZA0001           PFS Load ID
     C                     Z-ADDWAZPNX    ZA0002           PFS Order Numbe
     C                     MOVELYL0005    ZA0003           Condition Name
      * Retrieve message PFS Billing Notify-Picked
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3960' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0006    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0003    WL0021           Company Number
     C                     MOVEL@CN,002   WL0022    P      Company Value C
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    YL0007    P      System Value Al
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM YL0007    WQ0001 10        DL List ID
     C                     PARM YL0006    WQ0002132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * S00930 RMC 9/02/09 Crt chg log rcd for pick event
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWN0010    PBRMNB           Load ID
     C                     Z-ADD0         PBRVNB           Stop/Drop
     C                     MOVEL'PCKPRC'  PBRVST    P      Load Change Typ
     C                     MOVEL'SHP'     PBUJST    P      Department Cont
     C                     MOVEL'02'      PBMNTX    P      Change Log Prio
     C                     MOVEL'03'      PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELWN0007    PBBZNA    P      Carrier Code
     C                     Z-ADDWN0003    PBAIC3           Company Number
     C                     Z-ADDWN0004    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * S07362 RMC 10/21/16 Crt TMS Load Trigger when an order is picked
      * Exc Crt TMS Load Trg  XF - TMS Load Trigger  * 
     C                     CALL 'PBXOXFR'              90  Exc Crt TMS Loa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##JDT     WQ0003  70       Job Date
     C                     PARM ##JTM     WQ0004  60       Job Time
     C                     PARM WN0010    WQ0005  70       Load ID
     C                     PARM YL0001    WQ0006  30       TMS LH Load Str
     C                     PARM *BLANK    WQ0007 35        TMS LH Field Ch
     C                     PARM 'A'       WQ0008  1        TMS Record Stat
     C                     PARM 0         WQ0009  30       TMS Process Sta
     C                     PARM *BLANK    WQ0010  6        TMS Error Reaso
     C                     PARM 0         WQ0011  80       TMS Change Date
     C                     PARM 0         WQ0012  60       TMS Change time
     C                     PARM 'PCKCAR'  WQ0013  6        Load Change Typ
     C                     PARM YL0008    WQ0014  6        Load Change Typ
     C                     PARM YL0009    WQ0015  6        Load Change Typ
     C                     PARM YL0010    WQ0016  6        Load Change Typ
     C                     PARM YL0011    WQ0017  6        Load Change Typ
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Ship Status is Unpick Order
     C           WAVRSX    IFEQ 'UP'                       *IF
      * UPD:  Order Header * Order Events
      * CASE: WRK.#Sequence Block is NULL
     C           WUZRST    IFEQ *BLANK                     *IF
      * Upd Unpick Order      XF - Order Header TRG  * 
     C                     CALL 'POBNXFR'              90  Upd Unpick Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0018  30       Company Number
     C                     PARM WN0004    WQ0019  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POBNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg 'PO' to 'XO' so it wont be found later.
      * Upd Status -Pick Ord  RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SPRVGN
      * S00930 RMC 9/02/09 Crt chg log rcd for Unpick event
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWN0010    PBRMNB           Load ID
     C                     Z-ADD0         PBRVNB           Stop/Drop
     C                     MOVEL'UNPCAR'  PBRVST    P      Load Change Typ
     C                     MOVEL'SHP'     PBUJST    P      Department Cont
     C                     MOVEL'03'      PBMNTX    P      Change Log Prio
     C                     MOVEL'02'      PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELWN0007    PBBZNA    P      Carrier Code
     C                     Z-ADDWN0003    PBAIC3           Company Number
     C                     Z-ADDWN0004    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Ship Status is Close Order
     C           WAVRSX    IFEQ 'CO'                       *IF
      * Validate if we have Order Detail records for Order.
      * VAl Ship OrdDtl Exist RT - PFS Ship Order Detail  * 
     C                     EXSR SRRVGN
      * Process Close Order if Order Detail records found.
      * CASE: LCL.Record Found USR is Record Found
     C           YL0012    IFEQ 'Y'                        *IF
      * PFS Del I5 Pick Trans RT - Order Inv Allocation  * 
     C                     EXSR SSRVGN
      * PFS Inventory Adj     XF - PFS Inventory Adjustment  * 
     C                     CALL 'PPN3XFR'              90  PFS Inventory A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'S'       WQ0020  1        PFS Inv Adj Prc
     C                     PARM WAZPNX    WQ0021  70       PFS Order Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPN3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PFS Ship Order Detail XF - PFS Ship Order Detail  * 
     C                     CALL 'PPN9XFR'              90  PFS Ship Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAY1NX    WQ0022  30       PFS Company Num
     C                     PARM WAZPNX    WQ0023  70       PFS Order Numbe
     C           WN0015    PARM WN0015    WQ0024  1        Error Status
     C                     PARM 'PP'      WQ0025  2        Close Order Pre
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPN9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * INIT:  Pre Pass Error
      * CASE: PAR.Error Status is yes
     C           WN0015    IFEQ 'Y'                        *IF
     C                     MOVEL'ORDDTL'  WN0002           PFS Error Reaso
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Ship Order Detail XF - PFS Ship Order Detail  * 
     C                     CALL 'PPN9XFR'              90  PFS Ship Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAY1NX    WQ0026  30       PFS Company Num
     C                     PARM WAZPNX    WQ0027  70       PFS Order Numbe
     C           WN0015    PARM WN0015    WQ0028  1        Error Status
     C                     PARM 'PS'      WQ0029  2        Close Order Pre
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPN9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * INIT:  Process Status & Error Reason
      * CASE: PAR.Error Status is yes
     C           WN0015    IFEQ 'Y'                        *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDDTL'  WN0002           PFS Error Reaso
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Ship Status is Close Truck
     C           WAVRSX    IFEQ 'CT'                       *IF
      * RTV All Ords Shipped?  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAZGNX    WL0001           Load ID
     C                     MOVELYL0002    WL0002    P      Status - Y or N
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0002    P      Status - Y or N
      * CASE: LCL.Status - Y or N is yes
     C           YL0002    IFEQ 'Y'                        *IF
      * ** Only update SSD/SST with job date if it is zeros  LJB 4/16/08
      * RMC If record doesnt exist in ppblcpp, dont flag CT as processed
      * PFS Ship Load Header  XF - PFS Ship Load Header  * 
     C                     CALL 'PPNSXFR'              90  PFS Ship Load H
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAY1NX    WQ0030  30       PFS Company Num
     C                     PARM WAZGNX    WQ0031  70       PFS Load ID
     C           WN0018    PARM WN0018    WQ0032  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Record Found USR is Record Found
     C           WN0018    IFEQ 'Y'                        *IF
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Ship Status is Reopen Truck
     C           WAVRSX    IFEQ 'RT'                       *IF
      * UPD:  Load & Ship Status
      * CASE: PAR.Load Status is Shipped
     C           WN0016    IFEQ 'S'                        *IF
      * PFS Upd Load Status   RT - Load Header  * 
     C                     EXSR SURVGN
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     Z-ADD1         WN0001           PFS Process Sta
      * ** Mark Previous Transactions with Process Status = 3 **
      * Upd Load -Reopen Trk  RT - PFS Ship Load Header  * 
     C                     EXSR SVRVGN
      * Upd Status -ReOpn Trk RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0024           PFS Company Num
     C                     Z-ADDWAZGNX    WL0025           PFS Load ID
     C                     Z-ADDWAAID8    WL0026           PFS Transaction
     C                     Z-ADDWAAFTS    WL0027           PFS Transaction
     C                     EXSR SXRVGN
     C                     ELSE
      * CASE: DB1.PFS Ship Status is ReOpen Order (Unship)
     C           WAVRSX    IFEQ 'UO'                       *IF
      * RTV Delete Ship Event  RT - Order Events  * 
     C                     EXSR SZRVGN
      * RTV Next Event Number  RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0003    WL0003           Company Number
     C                     Z-ADDWN0004    WL0004           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0014           Event Number
      * RTV Event Code         RT - Order Events  * 
     C                     EXSR TBRVGN
      * UPD Unship Ship Detail RT - Order Detail  * 
     C                     EXSR TCRVGN
      * ** FP1127 Use Load ID for Lot# if Ext Whse, not PFS, Lot Trk=Y
      * Cnf Order Ship/Unship IF
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
     C                     EXSR TJRVGN
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0105  30       Company Number
     C                     PARM WN0004    WQ0106  70       Order Number
     C           WUJSVA    PARM WUJSVA    WQ0107 112       USR Order Value
     C           WUAYWG    PARM WUAYWG    WQ0108 112       USR Order Weigh
     C           WUXPST    PARM WUXPST    WQ0109  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0110  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPD Unship Load Status RT - Load Header  * 
     C                     EXSR TWRVGN
      * PFS Unship Order      RT - Order Header TRG  * 
     C                     EXSR TYRVGN
      * CHG Load Status/ActShp CH - Load Header  * 
     C                     EXSR NACHRC
      * S00619 RMC 01/06/09 Del exp doc dtls
      * Rtv & Dlt for Cancel  RT - Export Doc Order Dtl  * 
     C                     EXSR NBRVGN
      * UPD Err Transactions   RT - Item Transaction Detail  * 
     C                     EXSR NDRVGN
     C                     Z-ADD1         WN0001           PFS Process Sta
      * ** Mark Previous Transactions with Process Status = 3 **
      * Upd Detail -Unshipped RT - PFS Ship Order Detail  * 
     C                     EXSR NFRVGN
      * Upd Status -ReOpn Trk RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0024           PFS Company Num
     C                     Z-ADDWAZGNX    WL0025           PFS Load ID
     C                     Z-ADDWAAID8    WL0026           PFS Transaction
     C                     Z-ADDWAAFTS    WL0027           PFS Transaction
     C                     EXSR SXRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Pager Message
      * CASE: PAR.PFS Process Status is Error
     C           WN0001    IFEQ 2                          *IF
      * CASE: PAR.PFS Error Reason is Inactive Transaction
     C           WN0002    IFEQ @CN,005                    *IF
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     ELSE
      * CASE: PAR.PFS Error Reason is All Orders Not Shipped
     C           WN0002    IFEQ @CN,006                    *IF
     C                     Z-ADD0         WN0001           PFS Process Sta
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Condition Name USR = Condition name of DB1.PFS Ship Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1731617   Y2LSNO  70       List number
     C                     PARM WAVRSX    W0INVL 25        PFS Ship Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           YL0005    PARM           W0CNNM 25        Condition Name
      *
      * CASE: DB1.PFS Ship Status is Order Transactions
     C           WAVRSX    IFEQ 'CO'                       *IF
     C           WAVRSX    OREQ 'PO'
     C           WAVRSX    OREQ 'UO'
     C           WAVRSX    OREQ 'UP'
      * Setup message data for message
     C                     Z-ADDWAZGNX    ZA0004           PFS Load ID
     C                     Z-ADDWAZPNX    ZA0005           PFS Order Numbe
     C                     MOVELYL0005    ZA0006           Condition Name
      * Retrieve message PFS Billing Notify-Order
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3590' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0006    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADDWAZGNX    ZA0007           PFS Load ID
     C                     Z-ADDWAZPNX    ZA0008           PFS Order Numbe
     C                     MOVELYL0005    ZA0009           Condition Name
      * Retrieve message PFS Billing Notify-Load
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3591' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0006    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
      * RTV Alpha Value        RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0003    WL0021           Company Number
     C                     MOVEL@CN,002   WL0022    P      Company Value C
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0023    YL0007    P      System Value Al
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM YL0007    WQ0111 10        DL List ID
     C                     PARM YL0006    WQ0112132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg PrcSts/ErrRsn     CH - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0028           PFS Company Num
     C                     Z-ADDWAAID8    WL0029           PFS Transaction
     C                     Z-ADDWAAFTS    WL0030           PFS Transaction
     C                     Z-ADDWABCNY    WL0031           PFS Transaction
     C                     Z-ADDWN0001    WL0032           PFS Process Sta
     C                     MOVELWN0002    WL0033    P      PFS Error Reaso
     C                     EXSR SYCHRC
     C                     READ @BKCPA1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Order Info PFS    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0003    WBAIC3           Company Number
     C                     Z-ADDWN0004    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJNCD    WN0005           Order Type - Sa
     C                     Z-ADDWBBKC7    WN0006           Ship To Custome
     C                     MOVELWBBZNA    WN0007           Carrier Code
     C                     MOVELWBGWST    WN0008           Header Status
     C                     Z-ADDWBAODT    WN0009           Scheduled Ship
     C                     Z-ADDWBRMNB    WN0010           Load ID
     C                     MOVELWBJPCD    WN0011           Event Code
     C                     MOVELWBXUST    WN0012           Trans Contol AS
     C                     MOVELWBOBST    WN0013           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQSC01           Company Number
     C                     Z-ADDWN0004    WQSC02           Order Number
     C                     Z-ADD0         WCDPNB           Order Sequence
     C                     Z-ADD0         WCUENB           Order Secondary
      * Establish starting position
     C           KPSSC     SETLL@BGWKAE                    *
     C           KRSSC     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0017           Warehouse Code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SDRVGN
      * PAR = DB1 By name
     C                     MOVELWCAJCD    WN0017           Warehouse Code
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWCAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Load Status/StrCo  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WERMNB           Load ID
      * Setup key
     C                     Z-ADDWN0010    WERMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0016           Load Status
     C                     Z-ADD*ZERO     YL0001           Load Start Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEPKST    WN0016           Load Status
     C                     Z-ADDWEAIC3    YL0001           Load Start Comp
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV All Ords Shipped?  RT - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0019  1        Header Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WL0002           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQSF01           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Load ID
      * Setup key
     C                     Z-ADDWL0001    WQSF01           Load ID
      * Establish starting position
     C           KRSSF     SETLL@FLCPBW                    *
     C           KRSSF     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Assume all orders are shipped, unless find one that isn't
      * RTV Order Status       RT - Order Header TRG  * 
     C                     EXSR SGRVGN
      * CASE: PAR.Header Status is Conf/Comp/Canc
     C           WN0019    IFEQ 'X'                        *IF
     C           WN0019    OREQ 'C'
     C           WN0019    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WL0002           Status - Y or N
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Order Status       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WBAIC3           Company Number
     C                     Z-ADDWFC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBGWST    WN0019           Header Status
     C                     MOVELWBGXST    WUG0TX           Header Status L
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0017    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           WHS Live w/Carl
     C                     MOVEL*BLANK    YL0004           WHS PFS Interfa
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDRRSX    YL0003           WHS Live w/Carl
     C                     MOVELWDRSSX    YL0004           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Check Pick Event   RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSI02           Order Number
     C           *LIKE     DEFN WGJPCD    WQSI03           Event Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           Event Code
      * Setup key
     C                     Z-ADDWN0003    WQSI01           Company Number
     C                     Z-ADDWN0004    WQSI02           Order Number
     C                     MOVEL'03'      WQSI03           Event Code
      * Establish starting position
     C           KRSSI     SETLL@EYCPZE                    *
     C           KRSSI     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Next Event Number  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSJ02           Order Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WHQ2NB           Event Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDWL0003    WQSJ01           Company Number
     C                     Z-ADDWL0004    WQSJ02           Order Number
     C                     Z-ADDWL0005    WHQ2NB           Event Number
      * Establish starting position
     C           KPSSJ     SETLL@EYCPY2                    *
     C           KRSSJ     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0005           Event Number
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWHQ2NB    WL0005           Event Number
     C           KRSSJ     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * CRT Create Pick Event  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHQ2NB           Event Number
      * Setup key
     C                     Z-ADDWN0003    WHAIC3           Company Number
     C                     Z-ADDWN0004    WHC4NB           Order Number
     C                     Z-ADDWN0014    WHQ2NB           Event Number
      * Establish starting position
     C           KRSSK     SETGT@EYCPY2                91  *
     C                     READP@EYCPY2                9190*
      * Check high order keys
     C  N90      WN0003    IFNE WHAIC3                     Company Number
     C           WN0004    ORNE WHC4NB                     Order Number
     C                     SETON                     90
     C                     END
      *
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHQ2NB    ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0006           Company Number
     C                     Z-ADDWHC4NB    WL0007           Order Number
     C                     Z-ADDWUQ2NB    WL0008           Event Number
     C                     MOVEL'03'      WL0009    P      Event Code
     C                     Z-ADDWHAUC3    WL0010           Invoice/Memo Co
     C                     Z-ADDWHQ7NB    WL0011           Invoice/Memo Nu
     C                     MOVELWHOMST    WL0012    P      Invoice/Memo Su
     C                     Z-ADD##JDT     WL0013           Event Date
     C                     MOVELWHONST    WL0014    P      Activity Comple
     C                     MOVELWHOOST    WL0015    P      Activity Hold
     C                     MOVELWHOPST    WL0016    P      Post Cash Compl
     C                     Z-ADDWHAWC3    WL0017           Cross Event Ref
     C                     Z-ADDWHQ8NB    WL0018           Cross Event Ref
     C                     Z-ADDWHQ9NB    WL0019           Cross Event Ref
     C                     Z-ADDWHBKC7    WL0020           Ship To Custome
     C                     EXSR SLCRRC
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - OP Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0020  1        EDI Status 1
     C                     MOVEL*BLANK    WN0021  1        EDI Status 2
     C                     MOVEL*BLANK    WN0022  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0023  60       Job Time
     C                     MOVEL*BLANK    WN0024 10        User Id
     C                     MOVEL*BLANK    WN0025 10        Job Name
     C                     Z-ADD*ZERO     WN0026  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0006    WIAIC3           Company Number
     C                     Z-ADDWL0007    WIC4NB           Order Number
     C                     Z-ADDWL0008    WIQ2NB           Event Number
     C                     MOVELWL0009    WIJPCD           Event Code
     C                     Z-ADDWL0010    WIAUC3           Invoice/Memo Co
     C                     Z-ADDWL0011    WIQ7NB           Invoice/Memo Nu
     C                     MOVELWL0012    WIOMST           Invoice/Memo Su
     C                     Z-ADDWL0013    WID2DT           Event Date
     C                     MOVELWL0014    WIONST           Activity Comple
     C                     MOVELWL0015    WIOOST           Activity Hold
     C                     MOVELWL0016    WIOPST           Post Cash Compl
     C                     Z-ADDWL0017    WIAWC3           Cross Event Ref
     C                     Z-ADDWL0018    WIQ8NB           Cross Event Ref
     C                     Z-ADDWL0019    WIQ9NB           Cross Event Ref
     C                     Z-ADDWL0020    WIBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRSL    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSL    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * CHG Event Code    PFS RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0003    WBAIC3           Company Number
     C                     Z-ADDWN0004    WBC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Order Event        CH - Order Header TRG  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Order Event        CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0027  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0028  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0029  70       Ship To Custome
     C                     MOVEL*BLANK    WN0030 30        Ship To Name
     C                     MOVEL*BLANK    WN0031 30        Ship To Address
     C                     MOVEL*BLANK    WN0032 30        Ship To Address
     C                     MOVEL*BLANK    WN0033 30        Ship To Address
     C                     MOVEL*BLANK    WN0034 20        Ship To City
     C                     MOVEL*BLANK    WN0035  2        Ship To State C
     C                     MOVEL*BLANK    WN0036 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0037  70       Bill to Custome
     C                     MOVEL*BLANK    WN0038 30        Bill to Name
     C                     MOVEL*BLANK    WN0039 30        Bill to Address
     C                     MOVEL*BLANK    WN0040 30        Bill to Address
     C                     MOVEL*BLANK    WN0041 30        Bill to Address
     C                     MOVEL*BLANK    WN0042 20        Bill to City
     C                     MOVEL*BLANK    WN0043  2        Bill to State C
     C                     MOVEL*BLANK    WN0044 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0045 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0046  70       Order Date
     C                     Z-ADD*ZERO     WN0047  70       Requested Ship
     C                     Z-ADD*ZERO     WN0048  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0049  70       Cancel Date
     C                     MOVEL*BLANK    WN0050  2        Terms Code
     C                     MOVEL*BLANK    WN0051 40        Special Instruc
     C                     MOVEL*BLANK    WN0052 40        Special Instruc
     C                     MOVEL*BLANK    WN0053  3        Carrier Code
     C                     MOVEL*BLANK    WN0054  1        Comment Print A
     C                     MOVEL*BLANK    WN0055  1        Comment Print I
     C                     MOVEL*BLANK    WN0056  1        Comment Print P
     C                     MOVEL*BLANK    WN0057  1        Comment Print S
     C                     MOVEL*BLANK    WN0058  3        Reason Code
     C                     MOVEL*BLANK    WN0059  1        Order in Use
     C                     MOVEL*BLANK    WN0060  1        Header Status
     C                     MOVEL*BLANK    WN0061  1        Header Status L
     C                     MOVEL*BLANK    WN0062  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0063  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0064 10        User Original E
     C                     Z-ADD*ZERO     WN0065  70       Date of Origina
     C                     Z-ADD*ZERO     WN0066 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0067 112       Order Weight To
     C                     MOVEL*BLANK    WN0068  1        Credit Hold
     C                     MOVEL*BLANK    WN0069  1        Production Hold
     C                     MOVEL*BLANK    WN0070  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0071  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0072  40       Requested Deliv
     C                     MOVEL*BLANK    WN0073  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0074 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0075  70       Load ID
     C                     Z-ADD*ZERO     WN0076  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0077 112       Rated Freight
     C                     MOVEL*BLANK    WN0078  1        LTL Flag
     C                     MOVEL*BLANK    WN0079  1        Price Audit
     C                     MOVEL*BLANK    WN0080  1        Price Status
     C                     MOVEL*BLANK    WN0081  2        Shipping Method
     C                     MOVEL*BLANK    WN0082  1        Export Status
     C                     MOVEL*BLANK    WN0083  1        Palletize
     C                     MOVEL*BLANK    WN0084  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0085  1        Slip Sheet
     C                     MOVEL*BLANK    WN0086  1        Age Code
     C                     Z-ADD*ZERO     WN0087  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0088  1        Load Type
     C                     Z-ADD*ZERO     WN0089  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0090  1        Load Plan Order
     C                     MOVEL*BLANK    WN0091  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0092  70       Resell Referenc
     C                     MOVEL*BLANK    WN0093 30        Special Comment
     C                     MOVEL*BLANK    WN0094 30        Special Comment
     C                     MOVEL*BLANK    WN0095  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0096  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0097  2        Manager Level C
     C                     MOVEL*BLANK    WN0098  3        VP Level Code
     C                     Z-ADD*ZERO     WN0099  70       Attach to Order
     C                     MOVEL*BLANK    WN0100  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0101  70       Invoice Number
     C                     MOVEL*BLANK    WN0102  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0103  70       Invoice Date
     C                     MOVEL*BLANK    WN0104  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0105  1        Modified Flag
     C                     Z-ADD*ZERO     WN0106 112       A/R order Value
     C                     MOVEL*BLANK    WN0107  1        Billing Activit
     C                     MOVEL*BLANK    WN0108  1        Block Order Fla
     C                     MOVEL*BLANK    WN0109  1        Order Certifica
     C                     Z-ADD*ZERO     WN0110 112       Invoice Order V
     C                     MOVEL*BLANK    WN0111  1        Process Sts for
     C                     MOVEL*BLANK    WN0112  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0113  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0114  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0115  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0116  1        Email Cust On O
     C                     MOVEL*BLANK    WN0117  1        Order Emailed
     C                     MOVEL*BLANK    WN0118  1        Export Docs Go
     C                     MOVEL*BLANK    WN0119  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0120  1        Broker Order St
     C                     MOVEL*BLANK    WN0121  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0122  2        Order Requires
     C                     MOVEL*BLANK    WN0123  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0124  2        Export USDA App
     C                     MOVEL*BLANK    WN0125  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0126  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0127  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0128  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0129  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0130  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0131  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0132  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0133  60       Time of Origina
     C                     Z-ADD*ZERO     WN0134  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0135  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0136  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0137 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0138 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0139 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0140 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0141 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0142  70       Claim Number
     C                     MOVEL*BLANK    WN0143  1        EDI Status 1
     C                     MOVEL*BLANK    WN0144  1        EDI Status 2
     C                     MOVEL*BLANK    WN0145  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0146  60       Job Time
     C                     MOVEL*BLANK    WN0147 10        User Id
     C                     MOVEL*BLANK    WN0148 10        Job Name
     C                     Z-ADD*ZERO     WN0149  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WJAIC3           Company Number
     C                     Z-ADDWBC4NB    WJC4NB           Order Number
      *
     C           KLCHSN    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHSN    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'03'      WJJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWJAIC3    PAAIC3           Company Number
     C                     Z-ADDWJC4NB    PAC4NB           Order Number
     C                     MOVELWJJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWJANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWJBKC7    PABKC7           Ship To Custome
     C                     MOVELWJBRTX    PABRTX    P      Ship To Name
     C                     MOVELWJHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWJHONA    PAHONA    P      Ship To Address
     C                     MOVELWJHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWJHNNA    PAHNNA    P      Ship To City
     C                     MOVELWJDBCD    PADBCD    P      Ship To State C
     C                     MOVELWJCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWJB0C7    PAB0C7           Bill to Custome
     C                     MOVELWJAETX    PAAETX    P      Bill to Name
     C                     MOVELWJB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWJB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWJB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWJB2NA    PAB2NA    P      Bill to City
     C                     MOVELWJBHCD    PABHCD    P      Bill to State C
     C                     MOVELWJC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWJBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWJA0DT    PAA0DT           Order Date
     C                     Z-ADDWJA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWJGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWJACDT    PAACDT           Cancel Date
     C                     MOVELWJAQCD    PAAQCD    P      Terms Code
     C                     MOVELWJB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWJBYNA    PABYNA    P      Special Instruc
     C                     MOVELWJBZNA    PABZNA    P      Carrier Code
     C                     MOVELWJGTST    PAGTST    P      Comment Print A
     C                     MOVELWJGVST    PAGVST    P      Comment Print I
     C                     MOVELWJGUST    PAGUST    P      Comment Print P
     C                     MOVELWJQFST    PAQFST    P      Comment Print S
     C                     MOVELWJCQCD    PACQCD    P      Reason Code
     C                     MOVELWJGJST    PAGJST    P      Order in Use
     C                     MOVELWJGWST    PAGWST    P      Header Status
     C                     MOVELWJGXST    PAGXST    P      Header Status L
     C                     MOVELWJGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWJAODT    PAAODT           Scheduled Ship
     C                     MOVELWJAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWJCXDT    PACXDT           Date of Origina
     C                     Z-ADDWJJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWJA1WG    PAA1WG           Order Weight To
     C                     MOVELWJXIST    PAXIST    P      Credit Hold
     C                     MOVELWJXJST    PAXJST    P      Production Hold
     C                     MOVELWJXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWJEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWJAFTM    PAAFTM           Requested Deliv
     C                     MOVELWJE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWJE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWJRMNB    PARMNB           Load ID
     C                     Z-ADDWJTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWJR1NB    PAR1NB           Rated Freight
     C                     MOVELWJPJST    PAPJST    P      LTL Flag
     C                     MOVELWJU0ST    PAU0ST    P      Price Audit
     C                     MOVELWJU1ST    PAU1ST    P      Price Status
     C                     MOVELWJQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWJU2ST    PAU2ST    P      Export Status
     C                     MOVELWJVEST    PAVEST    P      Palletize
     C                     MOVELWJVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWJVGST    PAVGST    P      Slip Sheet
     C                     MOVELWJRPCD    PARPCD    P      Age Code
     C                     Z-ADDWJRNNB    PARNNB           Reefer Temperat
     C                     MOVELWJVDST    PAVDST    P      Load Type
     C                     Z-ADDWJATIN    PAATIN           Attach to Invoi
     C                     MOVELWJU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWJU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWJRSRN    PARSRN           Resell Referenc
     C                     MOVELWJMHNA    PAMHNA    P      Special Comment
     C                     MOVELWJMINA    PAMINA    P      Special Comment
     C                     MOVELWJWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWJR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWJBFCD    PABFCD    P      Manager Level C
     C                     MOVELWJQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWJT3NB    PAT3NB           Attach to Order
     C                     MOVELWJSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWJCONB    PACONB           Invoice Number
     C                     MOVELWJCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWJAWDT    PAAWDT           Invoice Date
     C                     MOVELWJJPCD    PAJPCD    P      Event Code
     C                     MOVELWJXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWJZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWJVRVA    PAVRVA           A/R order Value
     C                     MOVELWJOBST    PAOBST    P      Billing Activit
     C                     MOVELWJBCST    PABCST    P      Block Order Fla
     C                     MOVELWJBDST    PABDST    P      Order Certifica
     C                     Z-ADDWJB7VL    PAB7VL           Invoice Order V
     C                     MOVELWJGASX    PAGASX    P      Process Sts for
     C                     MOVELWJGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWJGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWJGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWJFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWJFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWJFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWJFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWJFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWJFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWJFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWJFUSX    PAFUSX    P      Order Requires
     C                     MOVELWJFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWJFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWJFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWJFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWJNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWJNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWJNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWJNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWJNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWJBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWJBQTM    PABQTM           Time of Origina
     C                     Z-ADDWJBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWJBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWJBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWJH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWJH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWJH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWJH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWJH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWJC0C7    PAC0C7           Claim Number
     C                     MOVELWJUVST    PAUVST    P      EDI Status 1
     C                     MOVELWJUWST    PAUWST    P      EDI Status 2
     C                     MOVELWJUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWJAATM    PAAATM           Job Time
     C                     MOVELWJAYNA    PAAYNA    P      User Id
     C                     MOVELWJA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWJAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0021    WKAIC3           Company Number
     C                     MOVELWL0022    WKV8CD           Company Value C
      * Establish starting position
     C           KRSSO     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKBXTX    WL0023           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Upd Status -Pick Ord  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLZGNX    WQSP01           PFS Load ID
     C           *LIKE     DEFN WLZPNX    WQSP02           PFS Order Numbe
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           PFS Load ID
     C                     KFLD           WQSP02           PFS Order Numbe
      * Setup key
     C                     Z-ADDWAZGNX    WQSP01           PFS Load ID
     C                     Z-ADDWAZPNX    WQSP02           PFS Order Numbe
      * Establish starting position
     C           KRSSP     SETLL@BKCPEK                    *
     C           KRSSP     READE@BKCPEK                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'XO'      WUHKT1           Text 2
      * Chg Pick Ord to XO    CH - PFS Ship Load/Order Sts  * 
     C                     EXSR SQCHRC
     C           KRSSP     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Pick Ord to XO    CH - PFS Ship Load/Order Sts  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0150  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0151  70       PFS Order Numbe
     C                     MOVEL*BLANK    WN0152  1        PFS Export USDA
     C                     MOVEL*BLANK    WN0153  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0154  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0155  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0156  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0157  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0158  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0159  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BKCPZU
     C                     Z-ADDWLY1NX    WMY1NX           PFS Company Num
     C                     Z-ADDWLAID8    WMAID8           PFS Transaction
     C                     Z-ADDWLAFTS    WMAFTS           PFS Transaction
     C                     Z-ADDWLBCNY    WMBCNY           PFS Transaction
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WMY1NX           PFS Company Num
     C                     KFLD           WMAID8           PFS Transaction
     C                     KFLD           WMAFTS           PFS Transaction
     C                     KFLD           WMBCNY           PFS Transaction
     C           KLCHSQ    CHAIN@BKCPZU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBKCPL0'MDACP
     C                     MOVEL'@BKCPZU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBK1    YBRDCS
      * Move non-key fields to @BKCPZU
     C                     MOVELWUHKT1    WMVRSX    P      PFS Ship Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBK1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WMAJNY           PFS Change Date
     C                     Z-ADD##JTM     WMAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBK1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BKCPZU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * VAl Ship OrdDtl Exist RT - PFS Ship Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0013           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOY1NX    WQSR01           PFS Company Num
     C           *LIKE     DEFN WOZPNX    WQSR02           PFS Order Numbe
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           PFS Company Num
     C                     KFLD           WQSR02           PFS Order Numbe
      * Setup key
     C                     Z-ADDWAY1NX    WQSR01           PFS Company Num
     C                     Z-ADDWAZPNX    WQSR02           PFS Order Numbe
      * Establish starting position
     C           KRSSR     SETLL@BMCPDE                    *
     C           KRSSR     READE@BMCPDE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3508' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0012           Record Found US
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0012           Record Found US
     C                     ADD  1         YL0013           Count USR
     C           KRSSR     READE@BMCPDE                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * PFS Del I5 Pick Trans RT - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WRC4NB    WQSS02           Order Number
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQSS01           Company Number
     C                     Z-ADDWN0004    WQSS02           Order Number
      * Establish starting position
     C           KRSSS     SETLL@L8CPSY                    *
     C           KRSSS     READE@L8CPSY                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.OIA Alloc/Shipped Qty is GT 1
     C           WRJ6QT    IFGT 1                          *IF
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
     C                     EXSR STDLRC
     C                     END                             *FI
     C           KRSSS     READE@L8CPSY                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STDLRC    BEGSR
      *================================================================
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L8CPSX
     C                     Z-ADDWRAIC3    WSAIC3           Company Number
     C                     Z-ADDWRC4NB    WSC4NB           Order Number
     C                     Z-ADDWRDPNB    WSDPNB           Order Sequence
     C                     Z-ADDWRUENB    WSUENB           Order Secondary
     C                     Z-ADDWRALSW    WSALSW           Allocation Seq
      *
     C           KLDLST    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
     C                     KFLD           WSDPNB           Order Sequence
     C                     KFLD           WSUENB           Order Secondary
     C                     KFLD           WSALSW           Allocation Seq
     C           KLDLST    CHAIN@L8CPSX              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L8CPSX                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * PFS Upd Load Status   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WERMNB           Load ID
      * Setup key
     C                     Z-ADDWN0010    WERMNB           Load ID
      * Establish starting position
     C           KRSSU     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Upd Load -Reopen Trk  RT - PFS Ship Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTY1NX    WQSV01           PFS Company Num
     C           *LIKE     DEFN WTZGNX    WQSV02           PFS Load ID
      * Define keylist
     C           KPSSV     KLIST
     C                     KFLD           WQSV01           PFS Company Num
     C                     KFLD           WQSV02           PFS Load ID
     C                     KFLD           WTAID8           PFS Transaction
     C                     KFLD           WTAFTS           PFS Transaction
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           PFS Company Num
     C                     KFLD           WQSV02           PFS Load ID
      * Setup key
     C                     Z-ADDWAY1NX    WQSV01           PFS Company Num
     C                     Z-ADDWAZGNX    WQSV02           PFS Load ID
     C                     Z-ADDWAAID8    WTAID8           PFS Transaction
     C                     Z-ADDWAAFTS    WTAFTS           PFS Transaction
      * Establish starting position
     C           KPSSV     SETLL@BLCPFB                    *
     C           KRSSV     READE@BLCPFB                  90*
      * Data record not found
     C   90                MOVEL'USR3506' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Transaction Date EQ PAR.PFS Transaction Date
      *   |- c2    : DB1.PFS Transaction Time EQ PAR.PFS Transaction Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WTAID8    IFEQ WAAID8                     *IF
     C           WTAFTS    IFEQ WAAFTS                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PostSts/ErrRsn    CH - PFS Ship Load Header  * 
     C                     EXSR SWCHRC
     C                     END                             *FI
     C           KRSSV     READE@BLCPFB                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * Chg PostSts/ErrRsn    CH - PFS Ship Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0160  52       PFS Actual Reef
     C                     MOVEL*BLANK    WN0161  1        PFS Actual Reef
     C                     Z-ADD*ZERO     WN0162  52       PFS Actual Prod
     C                     MOVEL*BLANK    WN0163  1        PFS Actual Prod
     C                     MOVEL*BLANK    WN0164 15        PFS Seal 1
     C                     MOVEL*BLANK    WN0165 15        PFS Seal 2
     C                     MOVEL*BLANK    WN0166 15        PFS Seal 3
     C                     MOVEL*BLANK    WN0167 20        PFS Trailer Num
     C                     MOVEL*BLANK    WN0168  1        PFS Truck Condi
     C                     Z-ADD*ZERO     WN0169  50       PFS Pallets Rec
     C                     Z-ADD*ZERO     WN0170  50       PFS Spacers Loa
     C                     MOVEL*BLANK    WN0171  1        PFS Export USDA
     C                     MOVEL*BLANK    WN0172 12        PFS Recorder ID
     C                     Z-ADD*ZERO     WN0173  80       PFS BOL Complet
     C                     Z-ADD*ZERO     WN0174  60       PFS BOL Complet
     C                     Z-ADD*ZERO     WN0175  80       PFS Actual Depa
     C                     Z-ADD*ZERO     WN0176  60       PFS Actual Depa
     C                     Z-ADD*ZERO     WN0177  50       PFS Pallets Loa
     C                     Z-ADD*ZERO     WN0178  82       PFS Total Palle
     C                     MOVEL*BLANK    WN0179  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0180  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0181  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0182  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0183  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BLCPZ7
     C                     Z-ADDWTY1NX    WVY1NX           PFS Company Num
     C                     Z-ADDWTAID8    WVAID8           PFS Transaction
     C                     Z-ADDWTAFTS    WVAFTS           PFS Transaction
     C                     Z-ADDWTBCNY    WVBCNY           PFS Transaction
      *
     C           KLCHSW    KLIST
     C                     KFLD           WVY1NX           PFS Company Num
     C                     KFLD           WVAID8           PFS Transaction
     C                     KFLD           WVAFTS           PFS Transaction
     C                     KFLD           WVBCNY           PFS Transaction
     C           KLCHSW    CHAIN@BLCPZ7              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBLCPL0'MDACP
     C                     MOVEL'@BLCPZ7' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBL1    YCRDCS
      * Move non-key fields to @BLCPZ7
     C                     Z-ADDWTZGNX    WVZGNX           PFS Load ID
     C                     MOVELWTG9T1    WVG9T1    P      PFS Seal 4
     C                     Z-ADD3         WVUXSX           PFS Process Sta
     C                     MOVEL'REOPN'   WVV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBL1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WVAJNY           PFS Change Date
     C                     Z-ADD##JTM     WVAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBL1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BLCPZ7                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Upd Status -ReOpn Trk RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWY1NX    WQSX01           PFS Company Num
     C           *LIKE     DEFN WWZGNX    WQSX02           PFS Load ID
      * Define keylist
     C           KPSSX     KLIST
     C                     KFLD           WQSX01           PFS Company Num
     C                     KFLD           WQSX02           PFS Load ID
     C                     KFLD           WWAID8           PFS Transaction
     C                     KFLD           WWAFTS           PFS Transaction
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           PFS Company Num
     C                     KFLD           WQSX02           PFS Load ID
      * Setup key
     C                     Z-ADDWL0024    WQSX01           PFS Company Num
     C                     Z-ADDWL0025    WQSX02           PFS Load ID
     C                     Z-ADDWL0026    WWAID8           PFS Transaction
     C                     Z-ADDWL0027    WWAFTS           PFS Transaction
      * Establish starting position
     C           KPSSX     SETLL@BKCPFD                    *
     C           KRSSX     READE@BKCPFD                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Transaction Date EQ PAR.PFS Transaction Date
      *   |- c2    : DB1.PFS Transaction Time EQ PAR.PFS Transaction Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WWAID8    IFEQ WL0026                     *IF
     C           WWAFTS    IFEQ WL0027                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PrcSts/ErrRsn     CH - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWWY1NX    WL0028           PFS Company Num
     C                     Z-ADDWWAID8    WL0029           PFS Transaction
     C                     Z-ADDWWAFTS    WL0030           PFS Transaction
     C                     Z-ADDWWBCNY    WL0031           PFS Transaction
     C                     Z-ADD3         WL0032           PFS Process Sta
     C                     MOVEL'REOPN'   WL0033    P      PFS Error Reaso
     C                     EXSR SYCHRC
     C                     END                             *FI
     C           KRSSX     READE@BKCPFD                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Ship Load/Order Sts  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0184  2        PFS Ship Status
     C                     Z-ADD*ZERO     WN0185  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0186  70       PFS Order Numbe
     C                     MOVEL*BLANK    WN0187  1        PFS Export USDA
     C                     MOVEL*BLANK    WN0188  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0189  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0190  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0191  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0192  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BKCPZU
     C                     Z-ADDWL0028    WMY1NX           PFS Company Num
     C                     Z-ADDWL0029    WMAID8           PFS Transaction
     C                     Z-ADDWL0030    WMAFTS           PFS Transaction
     C                     Z-ADDWL0031    WMBCNY           PFS Transaction
      *
     C           KLCHSY    KLIST
     C                     KFLD           WMY1NX           PFS Company Num
     C                     KFLD           WMAID8           PFS Transaction
     C                     KFLD           WMAFTS           PFS Transaction
     C                     KFLD           WMBCNY           PFS Transaction
     C           KLCHSY    CHAIN@BKCPZU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBKCPL0'MDACP
     C                     MOVEL'@BKCPZU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBK1    YDRDCS
      * Move non-key fields to @BKCPZU
     C                     Z-ADDWL0032    WMUXSX           PFS Process Sta
     C                     MOVELWL0033    WMV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBK1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BKCPZU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Delete Ship Event  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSZ02           Order Number
     C           *LIKE     DEFN WGJPCD    WQSZ03           Event Code
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Order Number
     C                     KFLD           WQSZ03           Event Code
      * Setup key
     C                     Z-ADDWN0003    WQSZ01           Company Number
     C                     Z-ADDWN0004    WQSZ02           Order Number
     C                     MOVEL'04'      WQSZ03           Event Code
      * Establish starting position
     C           KRSSZ     SETLL@EYCPZE                    *
     C           KRSSZ     READE@EYCPZE                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Ship Event         DC - OP Order Events  * 
     C                     EXSR TADLRC
     C           KRSSZ     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TADLRC    BEGSR
      *================================================================
      * DEL Ship Event         DC - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
     C                     Z-ADDWGAIC3    WIAIC3           Company Number
     C                     Z-ADDWGC4NB    WIC4NB           Order Number
     C                     Z-ADDWGQ2NB    WIQ2NB           Event Number
      *
     C           KLDLTA    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIQ2NB           Event Number
     C           KLDLTA    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPEYCPL0'MDACP
     C                     MOVEL'@EYCPY3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Event Code         RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHQ2NB           Event Number
      * Setup key
     C                     Z-ADDWN0003    WHAIC3           Company Number
     C                     Z-ADDWN0004    WHC4NB           Order Number
     C                     Z-ADDYL0014    WHQ2NB           Event Number
      * Establish starting position
     C           KRSTB     SETGT@EYCPY2                91  *
     C                     READP@EYCPY2                9190*
      * Check high order keys
     C  N90      WN0003    IFNE WHAIC3                     Company Number
     C           WN0004    ORNE WHC4NB                     Order Number
     C                     SETON                     90
     C                     END
      *
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHJPCD    YL0015           Event Code
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * UPD Unship Ship Detail RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0193  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0194  1        Price Audit
     C                     MOVEL*BLANK    WN0195  3        Price Audit Rea
     C                     Z-ADD*ZERO     WN0196 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0197 112       Weight Shipped
     C                     MOVEL*BLANK    WN0198  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0199  1        Inter-Plant Tra
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQTC01           Company Number
     C           *LIKE     DEFN WXC4NB    WQTC02           Order Number
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Company Number
     C                     KFLD           WQTC02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQTC01           Company Number
     C                     Z-ADDWN0004    WQTC02           Order Number
      * Establish starting position
     C           KRSTC     SETLL@BGWKL1                    *
     C           KRSTC     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Detail Line Status is Confirmed
      *   |- c2    : DB1.Item Code is Not Fuel Surcharge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WXGMST    IFEQ 'R'                        *IF
     C           WXHGCD    IFNE 99400                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWXGMST    WN0193           Detail Line Sta
     C                     MOVELWXU0ST    WN0194           Price Audit
     C                     MOVELWXRFCD    WN0195           Price Audit Rea
      * If qty and weight are zero then make price audit "N".
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Quantity Shipped Total is Equal to zero
      *   |- c2    : DB1.Weight Shipped Total is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WXCBQT    IFEQ 0                          *IF
     C           WXATWG    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0194           Price Audit
     C                     MOVEL'SUB'     WN0195           Price Audit Rea
     C                     END                             *FI
      * Set Quantity/Weight shipped to 0 if this is a Plant order
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0012    IFEQ 'P'                        *IF
     C                     Z-ADD0         WN0196           Quantity Shippe
     C                     Z-ADD0         WN0197           Weight Shipped
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWXCBQT    WN0196           Quantity Shippe
     C                     Z-ADDWXATWG    WN0197           Weight Shipped
     C                     END                             *FI
      * Reverse Issue
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Quantity Shipped Total is not equal zero
      *   |- c2    : DB1.Weight Shipped Total is Not equal zero
      *   '-
     C           WXCBQT    IFNE 0                          *IF
     C           WXATWG    ORNE 0                          *OR
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0013    IFEQ '4'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
     C                     EXSR TDRVGN
      * 12/04/06 PKD Added Inter-Plant Transfer Processing.
      * Rtv Warehouse SHP     RT - Warehouse  * 
     C                     EXSR TERVGN
      * Inter-Plant Transfer?
      * CASE:
      *  - c2 AND c3
      *   |- c2    : LCL.Warehouse Location is Internal (Plant)
      *   |- c3    : LCL.WHS Live w/Carlisle is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0017    IFEQ 'I'                        *IF
     C           YL0020    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0199           Inter-Plant Tra
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0199           Inter-Plant Tra
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0199           Inter-Plant Tra
     C                     END                             *FI
      * UPD Inv From Unship    RT - Manifest Detail  * 
     C                     EXSR TFRVGN
     C                     END                             *FI
      * CHG for UnShip         CH - Order Detail  * 
     C                     EXSR TICHRC
     C                     END                             *FI
     C           KRSTC     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWN0003    WYAIC3           Company Number
     C                     Z-ADDWN0006    WYBKC7           Ship To Custome
      * Establish starting position
     C           KRSTD     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0198           Warehouse Code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWYAJCD    WN0198           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Warehouse SHP     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0198    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSTE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0016           Trans Contol AS
     C                     MOVEL*BLANK    YL0017           Warehouse Locat
     C                     Z-ADD*ZERO     YL0018           Shipping Compan
     C                     Z-ADD*ZERO     YL0019           Accounting Comp
     C                     MOVEL*BLANK    YL0020           WHS Live w/Carl
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDXUST    YL0016           Trans Contol AS
     C                     MOVELWDT0ST    YL0017           Warehouse Locat
     C                     Z-ADDWDBWC3    YL0018           Shipping Compan
     C                     Z-ADDWDBTC3    YL0019           Accounting Comp
     C                     MOVELWDRRSX    YL0020           WHS Live w/Carl
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * UPD Inv From Unship    RT - Manifest Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0200  70       Label Date
     C                     Z-ADD*ZERO     WN0201  70       Production Date
     C                     Z-ADD*ZERO     WN0202 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0203 112       Weight Shipped
     C                     MOVEL*BLANK    WN0204  1        First Time Flag
     C                     Z-ADD*ZERO     WN0205 112       Weight Billed
     C                     MOVEL*BLANK    WN0206 30        Description
     C                     MOVEL*BLANK    WN0207  2        U/M - Cost
     C                     MOVEL*BLANK    WN0208  1        Shift Number
     C                     MOVEL*BLANK    WN0209 30        Description Lin
     C                     MOVEL*BLANK    WN0210 30        Description Lin
     C                     MOVEL*BLANK    WN0211  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0212  94       Conversion Fact
     C                     MOVEL*BLANK    WN0213  1        Operation Facto
     C                     MOVEL*BLANK    WN0214  2        U/M - Second
     C                     Z-ADD*ZERO     WN0215  94       Conversion Fact
     C                     MOVEL*BLANK    WN0216  1        Operation Facto
     C                     MOVEL*BLANK    WN0217  2        U/M - Third
     C                     MOVEL*BLANK    WN0218  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0219 112       Unit Weight
     C                     MOVEL*BLANK    WN0220  1        Production Date
     C                     MOVEL*BLANK    WN0221  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0222  52       Fresh Chilling
     C                     Z-ADD*ZERO     WN0223 114       Cost based on U
     C                     Z-ADD*ZERO     WN0224 114       Cost based on U
     C                     Z-ADD*ZERO     WN0225 114       Cost based on U
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Change Log
     C                     EXSR UBSUBR                     Change Log
     C                     MOVEL'Y'       WN0204           First Time Flag
     C                     Z-ADD0         WN0202           Quantity Shippe
     C                     Z-ADD0         WN0203           Weight Shipped
     C                     Z-ADD0         WN0205           Weight Billed
     C                     MOVEL'1'       WN0208           Shift Number
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0021    PARM *ZERO     WQ0033 155       Current System
     C           YL0022    PARM *ZERO     WQ0034 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAAIC3    WQTF01           Company Number
     C           *LIKE     DEFN TAC4NB    WQTF02           Order Number
     C           *LIKE     DEFN TADPNB    WQTF03           Order Sequence
     C           *LIKE     DEFN TAUENB    WQTF04           Order Secondary
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WQTF02           Order Number
     C                     KFLD           WQTF03           Order Sequence
     C                     KFLD           WQTF04           Order Secondary
      * Setup key
     C                     Z-ADDWXAIC3    WQTF01           Company Number
     C                     Z-ADDWXC4NB    WQTF02           Order Number
     C                     Z-ADDWXDPNB    WQTF03           Order Sequence
     C                     Z-ADDWXUENB    WQTF04           Order Secondary
      * Establish starting position
     C           KRSTF     SETLL@FNCPEZ                    *
     C           KRSTF     READE@FNCPEZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0200           Label Date
     C                     Z-ADD*ZERO     WN0201           Production Date
     C                     Z-ADD*ZERO     WN0202           Quantity Shippe
     C                     Z-ADD*ZERO     WN0203           Weight Shipped
     C                     MOVEL*BLANK    WN0204           First Time Flag
     C                     Z-ADD*ZERO     WN0205           Weight Billed
     C                     MOVEL*BLANK    WN0206           Description
     C                     MOVEL*BLANK    WN0207           U/M - Cost
     C                     MOVEL*BLANK    WN0208           Shift Number
     C                     MOVEL*BLANK    WN0209           Description Lin
     C                     MOVEL*BLANK    WN0210           Description Lin
     C                     MOVEL*BLANK    WN0211           U/M - Primary
     C                     Z-ADD*ZERO     WN0212           Conversion Fact
     C                     MOVEL*BLANK    WN0213           Operation Facto
     C                     MOVEL*BLANK    WN0214           U/M - Second
     C                     Z-ADD*ZERO     WN0215           Conversion Fact
     C                     MOVEL*BLANK    WN0216           Operation Facto
     C                     MOVEL*BLANK    WN0217           U/M - Third
     C                     MOVEL*BLANK    WN0218           U/M - Pricing
     C                     Z-ADD*ZERO     WN0219           Unit Weight
     C                     MOVEL*BLANK    WN0220           Production Date
     C                     MOVEL*BLANK    WN0221           Catch Weight St
     C                     Z-ADD*ZERO     WN0222           Fresh Chilling
     C                     Z-ADD*ZERO     WN0223           Cost based on U
     C                     Z-ADD*ZERO     WN0224           Cost based on U
     C                     Z-ADD*ZERO     WN0225           Cost based on U
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Set production date for break usage & rtv item info
      * CASE: PAR.First Time Flag is Yes
     C           WN0204    IFEQ 'Y'                        *IF
     C                     Z-ADDTAELDT    WN0201           Production Date
     C                     Z-ADDTAK7DT    WN0200           Label Date
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR TGRVGN
      * Set unit of measure for cost
      * CASE: PAR.Catch Weight Status is yes
     C           WN0221    IFEQ 'Y'                        *IF
     C                     MOVEL'LB'      WN0207           U/M - Cost
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWN0211    WN0207           U/M - Cost
     C                     END                             *FI
     C                     MOVEL*BLANK    WUE7TX           Order Number Al
     C                     MOVELWXC4NB    WUE7TX           Order Number Al
     C                     MOVEL@CN,003   WUI6TX           Description 14A
     C                     Z-ADD1         ZQ      50
     C           WUI6TX    CAT  WUE7TX:ZQ WN0206    P      Description
     C                     MOVEL'N'       WN0204           First Time Flag
     C                     END                             *FI
      * When production date changes update inventory files
      * CASE: PAR.Production Date NE DB1.Production Date
     C           WN0201    IFNE TAELDT                     *IF
      * CASE: PAR.Billing Activity Type is Invoice
     C           WN0013    IFEQ '1'                        *IF
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0035  30       Company Number
     C                     PARM WXHGCD    WQ0036  70       Item Code
     C                     PARM WXAJCD    WQ0037  3        Warehouse Code
     C                     PARM 'I'       WQ0038  1        Inventory Trans
     C                     PARM 'IO'      WQ0039  2        Inventory Trans
     C                     PARM YL0021    WQ0040  70       Transaction Dat
     C                     PARM WN0201    WQ0041  70       Production Date
     C                     PARM 'OP'      WQ0042  2        Item Transactio
     C                     PARM WN0206    WQ0043 30        Description
     C                     PARM *BLANK    WQ0044  3        Reason Code
     C                     PARM *BLANK    WQ0045 10        Lot ID
     C                     PARM WXC4NB    WQ0046  70       Order Number
     C                     PARM WN0208    WQ0047  1        Shift Number
     C                     PARM WN0200    WQ0048  70       Label Date
     C                     PARM WN0203    WQ0049 112       USR Weight Accu
     C                     PARM WN0202    WQ0050 112       Transaction Qty
     C                     PARM 'Y'       WQ0051  1        USR Unship Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0013    IFEQ '4'                        *IF
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0052  30       Company Number
     C                     PARM WXHGCD    WQ0053  70       Item Code
     C                     PARM WXAJCD    WQ0054  3        Warehouse Code
     C                     PARM 'T'       WQ0055  1        Inventory Trans
     C                     PARM 'TW'      WQ0056  2        Inventory Trans
     C                     PARM YL0021    WQ0057  70       Transaction Dat
     C                     PARM WN0201    WQ0058  70       Production Date
     C                     PARM 'OP'      WQ0059  2        Item Transactio
     C                     PARM WN0206    WQ0060 30        Description
     C                     PARM *BLANK    WQ0061  3        Reason Code
     C                     PARM WXC4NB    WQ0062  70       Order Number
     C                     PARM WN0208    WQ0063  1        Shift Number
     C                     PARM WN0200    WQ0064  70       Label Date
     C                     PARM WN0198    WQ0065  3        USR Warehouse C
     C                     PARM WN0203    WQ0066 112       USR Weight Accu
     C                     PARM WN0202    WQ0067 112       USR Quantity
     C                     PARM 'Y'       WQ0068  1        USR Unship Flag
     C                     PARM WN0199    WQ0069  1        Inter-Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDTAELDT    WN0201           Production Date
      * RTV Label Date         RT - Item Balance Detail  * 
     C                     EXSR THRVGN
      * If item bal detail doesn't exist, use manifest label date
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADDTAK7DT    WN0200           Label Date
     C                     END                             *FI
     C                     Z-ADD0         WN0202           Quantity Shippe
     C                     Z-ADD0         WN0203           Weight Shipped
     C                     END                             *FI
      * Add up quantity and weight for production date
     C                     ADD  TAFOQT    WN0202           Quantity Shippe
     C                     ADD  TAR0NB    WN0203           Weight Shipped
     C                     ADD  TAR0NB    WN0205           Weight Billed
     C           KRSTF     READE@FNCPEZ                  90*
     C                     ENDDO
      * USER: Exit processing
      * Update inventory for last production date read
      * CASE: PAR.Billing Activity Type is Invoice
     C           WN0013    IFEQ '1'                        *IF
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0070  30       Company Number
     C                     PARM WXHGCD    WQ0071  70       Item Code
     C                     PARM WXAJCD    WQ0072  3        Warehouse Code
     C                     PARM 'I'       WQ0073  1        Inventory Trans
     C                     PARM 'IO'      WQ0074  2        Inventory Trans
     C                     PARM YL0021    WQ0075  70       Transaction Dat
     C                     PARM WN0201    WQ0076  70       Production Date
     C                     PARM 'OP'      WQ0077  2        Item Transactio
     C                     PARM WN0206    WQ0078 30        Description
     C                     PARM *BLANK    WQ0079  3        Reason Code
     C                     PARM *BLANK    WQ0080 10        Lot ID
     C                     PARM WXC4NB    WQ0081  70       Order Number
     C                     PARM WN0208    WQ0082  1        Shift Number
     C                     PARM WN0200    WQ0083  70       Label Date
     C                     PARM WN0203    WQ0084 112       USR Weight Accu
     C                     PARM WN0202    WQ0085 112       Transaction Qty
     C                     PARM 'Y'       WQ0086  1        USR Unship Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0013    IFEQ '4'                        *IF
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WXAIC3    WQ0087  30       Company Number
     C                     PARM WXHGCD    WQ0088  70       Item Code
     C                     PARM WXAJCD    WQ0089  3        Warehouse Code
     C                     PARM 'T'       WQ0090  1        Inventory Trans
     C                     PARM 'TW'      WQ0091  2        Inventory Trans
     C                     PARM YL0021    WQ0092  70       Transaction Dat
     C                     PARM WN0201    WQ0093  70       Production Date
     C                     PARM 'OP'      WQ0094  2        Item Transactio
     C                     PARM WN0206    WQ0095 30        Description
     C                     PARM *BLANK    WQ0096  3        Reason Code
     C                     PARM WXC4NB    WQ0097  70       Order Number
     C                     PARM WN0208    WQ0098  1        Shift Number
     C                     PARM WN0200    WQ0099  70       Label Date
     C                     PARM WN0198    WQ0100  3        USR Warehouse C
     C                     PARM WN0203    WQ0101 112       USR Weight Accu
     C                     PARM WN0202    WQ0102 112       USR Quantity
     C                     PARM 'Y'       WQ0103  1        USR Unship Flag
     C                     PARM WN0199    WQ0104  1        Inter-Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBHGCD           Item Code
      * Setup key
     C                     Z-ADDWXAIC3    TBAIC3           Company Number
     C                     Z-ADDWXHGCD    TBHGCD           Item Code
      * Establish starting position
     C           KRSTG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0209           Description Lin
     C                     MOVEL*BLANK    WN0210           Description Lin
     C                     MOVEL*BLANK    WN0211           U/M - Primary
     C                     Z-ADD*ZERO     WN0212           Conversion Fact
     C                     MOVEL*BLANK    WN0213           Operation Facto
     C                     MOVEL*BLANK    WN0214           U/M - Second
     C                     Z-ADD*ZERO     WN0215           Conversion Fact
     C                     MOVEL*BLANK    WN0216           Operation Facto
     C                     MOVEL*BLANK    WN0217           U/M - Third
     C                     MOVEL*BLANK    WN0218           U/M - Pricing
     C                     Z-ADD*ZERO     WN0219           Unit Weight
     C                     MOVEL*BLANK    WN0220           Production Date
     C                     MOVEL*BLANK    WN0221           Catch Weight St
     C                     Z-ADD*ZERO     WN0222           Fresh Chilling
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTBAVNA    WN0209           Description Lin
     C                     MOVELTBAWNA    WN0210           Description Lin
     C                     MOVELTBADCD    WN0211           U/M - Primary
     C                     Z-ADDTBAWPC    WN0212           Conversion Fact
     C                     MOVELTBLXST    WN0213           Operation Facto
     C                     MOVELTBAECD    WN0214           U/M - Second
     C                     Z-ADDTBAXPC    WN0215           Conversion Fact
     C                     MOVELTBLYST    WN0216           Operation Facto
     C                     MOVELTBAFCD    WN0217           U/M - Third
     C                     MOVELTBAICD    WN0218           U/M - Pricing
     C                     Z-ADDTBAIWG    WN0219           Unit Weight
     C                     MOVELTBFZST    WN0220           Production Date
     C                     MOVELTBAVST    WN0221           Catch Weight St
     C                     Z-ADDTBCHTM    WN0222           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           TCAIC3           Company Number
     C                     KFLD           TCHGCD           Item Code
     C                     KFLD           TCAJCD           Warehouse Code
     C                     KFLD           TCELDT           Production Date
      * Setup key
     C                     Z-ADDWXAIC3    TCAIC3           Company Number
     C                     Z-ADDWXHGCD    TCHGCD           Item Code
     C                     MOVELWXAJCD    TCAJCD           Warehouse Code
     C                     Z-ADDWN0201    TCELDT           Production Date
      * Establish starting position
     C           KRSTH     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTCK7DT    WN0200           Label Date
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * CHG for UnShip         CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0226  70       Item Code
     C                     MOVEL*BLANK    WN0227  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0228  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0229  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0230 112       Billing Detail
     C                     Z-ADD*ZERO     WN0231 112       Billing Detail
     C                     Z-ADD*ZERO     WN0232 112       Billing Detail
     C                     Z-ADD*ZERO     WN0233 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0234  1        Comment Print A
     C                     MOVEL*BLANK    WN0235  1        Comment Print I
     C                     MOVEL*BLANK    WN0236  1        Comment Print P
     C                     MOVEL*BLANK    WN0237  1        Comment Print S
     C                     Z-ADD*ZERO     WN0238 112       Extended Amount
     C                     Z-ADD*ZERO     WN0239  70       Market Pricing
     C                     MOVEL*BLANK    WN0240  3        Commodity Marke
     C                     MOVEL*BLANK    WN0241  3        Date Method Cod
     C                     MOVEL*BLANK    WN0242  3        Price Method Co
     C                     Z-ADD*ZERO     WN0243 114       Price Overage O
     C                     Z-ADD*ZERO     WN0244  70       Contract Number
     C                     MOVEL*BLANK    WN0245  1        Price Status
     C                     Z-ADD*ZERO     WN0246  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0247  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0248  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0249  1        Work Confirm St
     C                     MOVEL*BLANK    WN0250  1        Work Over/Short
     C                     MOVEL*BLANK    WN0251  1        OD Production P
     C                     MOVEL*BLANK    WN0252 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0253 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0254  1        Age Code
     C                     MOVEL*BLANK    WN0255  1        Palletize
     C                     MOVEL*BLANK    WN0256  1        Slip Sheet
     C                     MOVEL*BLANK    WN0257  1        Catch Weight St
     C                     MOVEL*BLANK    WN0258  1        Production Date
     C                     Z-ADD*ZERO     WN0259 112       Rated Freight
     C                     Z-ADD*ZERO     WN0260 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0261 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0262 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0263 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0264 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0265 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0266 114       Unit Price
     C                     Z-ADD*ZERO     WN0267 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0268 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0269 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0270 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0271  70       Requested Ship
     C                     Z-ADD*ZERO     WN0272  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0273  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0274  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0275  30       Item Structure
     C                     Z-ADD*ZERO     WN0276  30       Item Structure
     C                     Z-ADD*ZERO     WN0277  30       Item Structure
     C                     MOVEL*BLANK    WN0278  2        Item Level
     C                     MOVEL*BLANK    WN0279  2        Quality Level
     C                     MOVEL*BLANK    WN0280  2        Pricing Product
     C                     MOVEL*BLANK    WN0281  2        Season Product
     C                     Z-ADD*ZERO     WN0282  70       Date of Origina
     C                     MOVEL*BLANK    WN0283 10        User Profile Na
     C                     MOVEL*BLANK    WN0284  6        Country Code
     C                     MOVEL*BLANK    WN0285  3        Reason Code
     C                     MOVEL*BLANK    WN0286  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0287  1        Modified Flag
     C                     MOVEL*BLANK    WN0288  1        Substituted Fla
     C                     MOVEL*BLANK    WN0289  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0290 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0291 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0292  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0293  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0294  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0295  1        Affect Commissi
     C                     MOVEL*BLANK    WN0296  1        Affect Pricing
     C                     MOVEL*BLANK    WN0297  1        Released by Use
     C                     MOVEL*BLANK    WN0298  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0299  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0300  3        Production Ware
     C                     MOVEL*BLANK    WN0301  3        OD Price Type
     C                     Z-ADD*ZERO     WN0302  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0303  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0304  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0305  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0306  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0307  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0308  60       Price Code
     C                     Z-ADD*ZERO     WN0309  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0310  60       Substitution Li
     C                     Z-ADD*ZERO     WN0311  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0312 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0313 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0314 112       OD Item Target
     C                     Z-ADD*ZERO     WN0315 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0316 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0317 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0318 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0319 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0320 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0321 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0322 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0323 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0324 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0325  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0326  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0327  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0328 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0329  40       Item Age Days
     C                     Z-ADD*ZERO     WN0330  70       Production Ovr
     C                     Z-ADD*ZERO     WN0331  70       Production Ovr
     C                     MOVEL*BLANK    WN0332  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0333  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0334  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0335  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0336  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0337  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0338  1        EDI Status 1
     C                     MOVEL*BLANK    WN0339  1        EDI Status 2
     C                     MOVEL*BLANK    WN0340  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0341  60       Job Time
     C                     MOVEL*BLANK    WN0342 10        User Id
     C                     MOVEL*BLANK    WN0343 10        Job Name
     C                     Z-ADD*ZERO     WN0344  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWXAIC3    TDAIC3           Company Number
     C                     Z-ADDWXC4NB    TDC4NB           Order Number
     C                     Z-ADDWXDPNB    TDDPNB           Order Sequence
     C                     Z-ADDWXUENB    TDUENB           Order Secondary
      *
     C           KLCHTI    KLIST
     C                     KFLD           TDAIC3           Company Number
     C                     KFLD           TDC4NB           Order Number
     C                     KFLD           TDDPNB           Order Sequence
     C                     KFLD           TDUENB           Order Secondary
     C           KLCHTI    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YERDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL'A'       TDGMST    P      Detail Line Sta
     C                     MOVELWN0193    TDGNST    P      Detail Line Sta
     C                     MOVELWN0194    TDU0ST    P      Price Audit
     C                     MOVELWN0195    TDRFCD    P      Price Audit Rea
     C                     Z-ADDWN0196    TDCBQT           Quantity Shippe
     C                     Z-ADDWN0197    TDATWG           Weight Shipped
     C                     Z-ADD0         TDGNDT           Actual Shipped
     C                     MOVELWXAMST    TDAMST    P      Affect Inventor
     C                     MOVELYL0015    TDJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TDAATM' defaulted for 'Job Time'.
      * Field '(DB1) TDAYNA' defaulted for 'User Id'.
      * Field '(DB1) TDA0NA' defaulted for 'Job Name'.
      * Field '(DB1) TDAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TDAATM           Job Time
     C                     MOVEL##USR     TDAYNA           User Id
     C                     MOVEL##JOB     TDA0NA           Job Name
     C                     Z-ADD##JDT     TDAXDT           Job Date
     C                     MOVEL@CN,004   TDA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0345  70       Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0346  70       Item Code
     C                     MOVEL*BLANK    WN0347  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0348  70       Production Date
     C                     Z-ADD*ZERO     WN0349  50       Lot Number
     C                     MOVEL*BLANK    WN0350  4        Location Code
     C                     Z-ADD*ZERO     WN0351  20       Location Level
     C                     Z-ADD*ZERO     WN0352  50       LLT Trans Qty
     C                     Z-ADD*ZERO     WN0353 112       LLT Trans Wgt
     C                     Z-ADD*ZERO     WN0354 112       Weight Order 2
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0023           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEAIC3    WQTJ01           Company Number
     C           *LIKE     DEFN TEC4NB    WQTJ02           Order Number
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQTJ01           Company Number
     C                     Z-ADDWN0004    WQTJ02           Order Number
      * Establish starting position
     C           KRSTJ     SETLL@L8CPZO                    *
     C           KRSTJ     READE@L8CPZO                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD0         WN0345           Quantity Loc Tr
     C                     Z-ADD0         WN0354           Weight Order 2
      * 1ST:  First time process
      * CASE: LCL.First Time Flag is Yes
     C           YL0023    IFEQ 'Y'                        *IF
     C                     Z-ADDTEHGCD    WN0346           Item Code
     C                     MOVELTEAJCD    WN0347           Warehouse Code
     C                     Z-ADDTEELDT    WN0348           Production Date
     C                     Z-ADDTELXNM    WN0349           Lot Number
     C                     MOVELTEYMCD    WN0350           Location Code
     C                     Z-ADDTEYNCD    WN0351           Location Level
     C                     MOVEL'N'       YL0023           First Time Flag
     C                     END                             *FI
      * CHG: Item, Whs, PDte, Lot, Loc, Level
      * CASE: CHG: Item, Whs, PDte, Lot, Loc, Level
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : PAR.Item Code NE DB1.Item Code
      *   |- c2    : PAR.Warehouse Code NE DB1.Warehouse Code
      *   |- c3    : PAR.Production Date NE DB1.Production Date
      *   |- c4    : PAR.Lot Number NE DB1.Lot Number
      *   |- c5    : PAR.Location Code NE DB1.Location Code
      *   |- c6    : PAR.Location Level NE DB1.Location Level
      *   '-
     C           WN0346    IFNE TEHGCD                     *IF
     C           WN0347    ORNE TEAJCD                     *OR
     C           WN0348    ORNE TEELDT                     *OR
     C           WN0349    ORNE TELXNM                     *OR
     C           WN0350    ORNE TEYMCD                     *OR
     C           WN0351    ORNE TEYNCD                     *OR
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0352    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0355  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0356  1        EDI Status 1
     C                     MOVEL*BLANK    WN0357  1        EDI Status 2
     C                     MOVEL*BLANK    WN0358  1        EDI Status 3
     C                     MOVEL*BLANK    WN0359  1        Record Status
     C                     Z-ADD*ZERO     WN0360  60       Job Time
     C                     MOVEL*BLANK    WN0361 10        User Id
     C                     MOVEL*BLANK    WN0362 10        Job Name
     C                     Z-ADD*ZERO     WN0363  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTEAIC3    WL0034           Company Number
     C                     Z-ADDWN0346    WL0035           Item Code
     C                     MOVELWN0347    WL0036    P      Warehouse Code
     C                     MOVEL'S'       WL0037    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0038           LLT Trans Date
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    WN0355           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTEAIC3    WL0040           Company Number
     C                     Z-ADDWN0346    WL0041           Item Code
     C                     MOVELWN0347    WL0042    P      Warehouse Code
     C                     MOVEL'S'       WL0043    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0044           LLT Trans Date
     C                     Z-ADDWN0355    WL0045           LLT Sequence #
     C                     Z-ADDWN0348    WL0046           LLT Production
     C                     Z-ADDWN0352    WL0047           LLT Trans Qty
     C                     Z-ADDWN0353    WL0048           LLT Trans Wgt
     C                     Z-ADDWN0349    WL0049           LLT Lot Number
     C                     MOVELWN0350    WL0050    P      Location Code
     C                     Z-ADDWN0351    WL0051           LLT Location Le
     C                     MOVEL*BLANK    WL0052           Transfer Wareho
     C                     Z-ADD0         WL0053           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0054           Transfer Locati
     C                     Z-ADD0         WL0055           LLT Transfer Lo
     C                     Z-ADDTEC4NB    WL0056           Order Number
     C                     MOVEL'P'       WL0057    P      LLT Status
     C                     MOVELWULLTU    WL0058    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0059    P      LTT Unused Sts
     C                     MOVELWN0356    WL0060    P      EDI Status 1
     C                     MOVELWN0357    WL0061    P      EDI Status 2
     C                     MOVELWN0358    WL0062    P      EDI Status 3
     C                     MOVELWN0359    WL0063    P      Record Status
     C                     Z-ADDWN0360    WL0064           Job Time
     C                     MOVELWN0361    WL0065    P      User Id
     C                     MOVELWN0362    WL0066    P      Job Name
     C                     Z-ADDWN0363    WL0067           Job Date
     C                     EXSR TLCRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTEAIC3    WL0068           Company Number
     C                     Z-ADDWN0346    WL0069           Item Code
     C                     MOVELWN0347    WL0070    P      Warehouse Code
     C                     Z-ADDWN0348    WL0071           Production Date
     C                     Z-ADDWN0349    WL0072           Lot Number
     C                     MOVELWN0350    WL0073    P      Location Code
     C                     Z-ADDWN0351    WL0074           Location Level
     C                     Z-ADDWN0352    WL0075           Quantity Loc Tr
     C                     Z-ADDWN0353    WL0076           Weight Order 2
     C                     EXSR TMRVGN
     C                     END                             *FI
     C                     Z-ADDTEHGCD    WN0346           Item Code
     C                     MOVELTEAJCD    WN0347           Warehouse Code
     C                     Z-ADDTEELDT    WN0348           Production Date
     C                     Z-ADDTELXNM    WN0349           Lot Number
     C                     MOVELTEYMCD    WN0350           Location Code
     C                     Z-ADDTEYNCD    WN0351           Location Level
     C                     Z-ADD0         WN0352           LLT Trans Qty
     C                     Z-ADD0         WN0353           LLT Trans Wgt
     C                     END                             *FI
      * PRC:  Accumulate Quantity
      * CASE: PAR.OIA Allocation Sts is Shipped
     C           'U'       IFEQ 'S'                        *IF
     C           TEJ6QT    MULT -1        WN0345           Quantity Loc Tr
     C                     ADD  WN0345    WN0352           LLT Trans Qty
      * RMC 1/9/17 reduce weight too
     C           TEG9WG    MULT -1        WN0354           Weight Order 2
     C                     ADD  WN0354    WN0353           LLT Trans Wgt
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTEAIC3    WL0128           Company Number
     C                     Z-ADDTEC4NB    WL0129           Order Number
     C                     Z-ADDTEDPNB    WL0130           Order Sequence
     C                     Z-ADDTEUENB    WL0131           Order Secondary
     C                     Z-ADDTEALSW    WL0132           Allocation Seq
     C                     MOVEL'U'       WL0133    P      OIA Allocation
     C                     EXSR TVCHRC
     C                     ELSE
      * CASE: PAR.OIA Allocation Sts is Unshipped
     C           'U'       IFEQ 'U'                        *IF
     C                     ADD  TEJ6QT    WN0352           LLT Trans Qty
      * RMC 1/9/17 increase weight too
     C                     ADD  TEG9WG    WN0353           LLT Trans Wgt
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTEAIC3    WL0128           Company Number
     C                     Z-ADDTEC4NB    WL0129           Order Number
     C                     Z-ADDTEDPNB    WL0130           Order Sequence
     C                     Z-ADDTEUENB    WL0131           Order Secondary
     C                     Z-ADDTEALSW    WL0132           Allocation Seq
     C                     MOVEL'U'       WL0133    P      OIA Allocation
     C                     EXSR TVCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTJ     READE@L8CPZO                  90*
     C                     ENDDO
      * USER: Exit processing
      * Do if qty> 0    ----RMC 2/15/06
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0352    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0436  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0437  1        EDI Status 1
     C                     MOVEL*BLANK    WN0438  1        EDI Status 2
     C                     MOVEL*BLANK    WN0439  1        EDI Status 3
     C                     MOVEL*BLANK    WN0440  1        Record Status
     C                     Z-ADD*ZERO     WN0441  60       Job Time
     C                     MOVEL*BLANK    WN0442 10        User Id
     C                     MOVEL*BLANK    WN0443 10        Job Name
     C                     Z-ADD*ZERO     WN0444  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTEAIC3    WL0034           Company Number
     C                     Z-ADDWN0346    WL0035           Item Code
     C                     MOVELWN0347    WL0036    P      Warehouse Code
     C                     MOVEL'S'       WL0037    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0038           LLT Trans Date
     C                     EXSR TKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    WN0436           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTEAIC3    WL0040           Company Number
     C                     Z-ADDWN0346    WL0041           Item Code
     C                     MOVELWN0347    WL0042    P      Warehouse Code
     C                     MOVEL'S'       WL0043    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0044           LLT Trans Date
     C                     Z-ADDWN0436    WL0045           LLT Sequence #
     C                     Z-ADDWN0348    WL0046           LLT Production
     C                     Z-ADDWN0352    WL0047           LLT Trans Qty
     C                     Z-ADDWN0353    WL0048           LLT Trans Wgt
     C                     Z-ADDWN0349    WL0049           LLT Lot Number
     C                     MOVELWN0350    WL0050    P      Location Code
     C                     Z-ADDWN0351    WL0051           LLT Location Le
     C                     MOVEL*BLANK    WL0052           Transfer Wareho
     C                     Z-ADD0         WL0053           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0054           Transfer Locati
     C                     Z-ADD0         WL0055           LLT Transfer Lo
     C                     Z-ADDTEC4NB    WL0056           Order Number
     C                     MOVEL'P'       WL0057    P      LLT Status
     C                     MOVELWULLTU    WL0058    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0059    P      LTT Unused Sts
     C                     MOVELWN0437    WL0060    P      EDI Status 1
     C                     MOVELWN0438    WL0061    P      EDI Status 2
     C                     MOVELWN0439    WL0062    P      EDI Status 3
     C                     MOVELWN0440    WL0063    P      Record Status
     C                     Z-ADDWN0441    WL0064           Job Time
     C                     MOVELWN0442    WL0065    P      User Id
     C                     MOVELWN0443    WL0066    P      Job Name
     C                     Z-ADDWN0444    WL0067           Job Date
     C                     EXSR TLCRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTEAIC3    WL0068           Company Number
     C                     Z-ADDWN0346    WL0069           Item Code
     C                     MOVELWN0347    WL0070    P      Warehouse Code
     C                     Z-ADDWN0348    WL0071           Production Date
     C                     Z-ADDWN0349    WL0072           Lot Number
     C                     MOVELWN0350    WL0073    P      Location Code
     C                     Z-ADDWN0351    WL0074           Location Level
     C                     Z-ADDWN0352    WL0075           Quantity Loc Tr
     C                     Z-ADDWN0353    WL0076           Weight Order 2
     C                     EXSR TMRVGN
     C                     END                             *FI
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TFAIC3    WQTK01           Company Number
     C           *LIKE     DEFN TFHGCD    WQTK02           Item Code
     C           *LIKE     DEFN TFAJCD    WQTK03           Warehouse Code
     C           *LIKE     DEFN TFLTRT    WQTK04           LLT Trans Type
     C           *LIKE     DEFN TFLRDT    WQTK05           LLT Trans Date
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           Company Number
     C                     KFLD           WQTK02           Item Code
     C                     KFLD           WQTK03           Warehouse Code
     C                     KFLD           WQTK04           LLT Trans Type
     C                     KFLD           WQTK05           LLT Trans Date
      * Setup key
     C                     Z-ADDWL0034    WQTK01           Company Number
     C                     Z-ADDWL0035    WQTK02           Item Code
     C                     MOVELWL0036    WQTK03           Warehouse Code
     C                     MOVELWL0037    WQTK04           LLT Trans Type
     C                     Z-ADDWL0038    WQTK05           LLT Trans Date
      * Establish starting position
     C           KRSTK     SETLL@L7CPUK                    *
     C           KRSTK     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0039           LLT Sequence #
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           TFLLTS    ADD  1         WL0039           LLT Sequence #
     C                     GOTO TKEXIT                     *QUIT
     C           KRSTK     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0040    TGAIC3           Company Number
     C                     Z-ADDWL0041    TGHGCD           Item Code
     C                     MOVELWL0042    TGAJCD           Warehouse Code
     C                     MOVELWL0043    TGLTRT           LLT Trans Type
     C                     Z-ADDWL0044    TGLRDT           LLT Trans Date
     C                     Z-ADDWL0045    TGLLTS           LLT Sequence #
     C                     Z-ADDWL0046    TGLSDT           LLT Production
     C                     Z-ADDWL0047    TGJ5QT           LLT Trans Qty
     C                     Z-ADDWL0048    TGG8WG           LLT Trans Wgt
     C                     Z-ADDWL0049    TGLLTN           LLT Lot Number
     C                     MOVELWL0050    TGYMCD           Location Code
     C                     Z-ADDWL0051    TGLLCL           LLT Location Le
     C                     MOVELWL0052    TGBNAA           Transfer Wareho
     C                     Z-ADDWL0053    TGLLTR           LLT Transfer Lo
     C                     MOVELWL0054    TGY2CD           Transfer Locati
     C                     Z-ADDWL0055    TGLLTL           LLT Transfer Lo
     C                     Z-ADDWL0056    TGC4NB           Order Number
     C                     MOVELWL0057    TGLOST           LLT Status
     C                     MOVELWL0058    TGLLTU           LTT Unused Sts
     C                     MOVELWL0059    TGLLYT           LTT Unused Sts
     C                     MOVELWL0060    TGUVST           EDI Status 1
     C                     MOVELWL0061    TGUWST           EDI Status 2
     C                     MOVELWL0062    TGUXST           EDI Status 3
     C                     MOVELWL0063    TGVSST           Record Status
     C                     Z-ADDWL0064    TGAATM           Job Time
     C                     MOVELWL0065    TGAYNA           User Id
     C                     MOVELWL0066    TGA0NA           Job Name
     C                     Z-ADDWL0067    TGAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TGVSST           Record Status
     C                     Z-ADD##JTM     TGAATM           Job Time
     C                     MOVEL##USR     TGAYNA           User Id
     C                     MOVEL##JOB     TGA0NA           Job Name
     C                     Z-ADD##JDT     TGAXDT           Job Date
     C           KLCRTL    KLIST
     C                     KFLD           TGAIC3           Company Number
     C                     KFLD           TGHGCD           Item Code
     C                     KFLD           TGAJCD           Warehouse Code
     C                     KFLD           TGLTRT           LLT Trans Type
     C                     KFLD           TGLRDT           LLT Trans Date
     C                     KFLD           TGLLTS           LLT Sequence #
      * Check for duplicate primary key
     C           KLCRTL    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0364  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0365 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0366  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0367 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0368  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0369 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0370  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0371  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0372  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0373  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0374  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0375  1        ILL Status
     C                     MOVEL*BLANK    WN0376  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0377  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0378  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0379  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0380  1        EDI Status 1
     C                     MOVEL*BLANK    WN0381  1        EDI Status 2
     C                     MOVEL*BLANK    WN0382  1        EDI Status 3
     C                     MOVEL*BLANK    WN0383  1        Record Status
     C                     Z-ADD*ZERO     WN0384  60       Job Time
     C                     MOVEL*BLANK    WN0385 10        User Id
     C                     MOVEL*BLANK    WN0386 10        Job Name
     C                     Z-ADD*ZERO     WN0387  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           THAIC3           Company Number
     C                     KFLD           THHGCD           Item Code
     C                     KFLD           THAJCD           Warehouse Code
     C                     KFLD           THELDT           Production Date
     C                     KFLD           THLXNM           Lot Number
     C                     KFLD           THYMCD           Location Code
     C                     KFLD           THYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0068    THAIC3           Company Number
     C                     Z-ADDWL0069    THHGCD           Item Code
     C                     MOVELWL0070    THAJCD           Warehouse Code
     C                     Z-ADDWL0071    THELDT           Production Date
     C                     Z-ADDWL0072    THLXNM           Lot Number
     C                     MOVELWL0073    THYMCD           Location Code
     C                     Z-ADDWL0074    THYNCD           Location Level
      * Establish starting position
     C           KRSTM     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      *
     C                     MOVEL*BLANK    WN0388  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0389  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0070    WL0077    P      Warehouse Code
     C                     MOVELWL0073    WL0078    P      Location Code
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0079    WN0388    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0388    WL0080    P      WLT Type Code
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0081    WN0389           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WL0071    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0389    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0370
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0370
     C                     END
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0068    WL0082           Company Number
     C                     Z-ADDWL0069    WL0083           Item Code
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0084    WN0365           Unit Weight
     C                     MOVELWL0085    YL0024    P      Quality Level
      * Crt Item Loc          CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0068    WL0086           Company Number
     C                     Z-ADDWL0069    WL0087           Item Code
     C                     MOVELWL0070    WL0088    P      Warehouse Code
     C                     Z-ADDWL0071    WL0089           Production Date
     C                     Z-ADDWL0072    WL0090           Lot Number
     C                     MOVELWL0073    WL0091    P      Location Code
     C                     Z-ADDWL0074    WL0092           Location Level
     C                     Z-ADDWL0075    WL0093           ILL Item Qty On
     C                     Z-ADDWN0365    WL0094           ILL Unit Weight
     C                     Z-ADDWN0366    WL0095           ILL Co-Packer L
     C                     Z-ADDWN0367    WL0096           ILl Item Wgt On
     C                     Z-ADDWN0368    WL0097           ILL Unused Qty
     C                     Z-ADDWN0369    WL0098           ILL Unused Wgt
     C                     Z-ADDWN0370    WL0099           ILL Avail Ship
     C                     Z-ADDWN0371    WL0100           ILL Unused Date
     C                     Z-ADDWN0372    WL0101           ILL Unused Date
     C                     Z-ADDWN0373    WL0102           ILL Unused Nbr
     C                     MOVELWN0374    WL0103    P      ILL Customer Co
     C                     MOVEL'A'       WL0104    P      ILL Status
     C                     MOVELWN0376    WL0105    P      ILL Unused Sts
     C                     MOVELWN0377    WL0106    P      ILL Unused Sts
     C                     MOVELWN0378    WL0107    P      ILL Unused Sts
     C                     MOVELWN0379    WL0108    P      Inv Hold Reason
     C                     MOVELWN0380    WL0109    P      EDI Status 1
     C                     MOVELWN0381    WL0110    P      EDI Status 2
     C                     MOVELWN0382    WL0111    P      EDI Status 3
     C                     MOVELWN0383    WL0112    P      Record Status
     C                     Z-ADDWN0384    WL0113           Job Time
     C                     MOVELWN0385    WL0114    P      User Id
     C                     MOVELWN0386    WL0115    P      Job Name
     C                     Z-ADDWN0387    WL0116           Job Date
     C                     EXSR TQCRRC
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           THJ2QT    ADD  WL0075    WN0364           ILL Item Qty On
     C           THG6WG    ADD  WL0076    WN0367           ILl Item Wgt On
      * CASE: PAR.ILL Item Qty On-Hand is GT Zero
     C           WN0364    IFGT 0                          *IF
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
     C                     EXSR TRCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Item Location     DL - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTHAIC3    WL0117           Company Number
     C                     Z-ADDTHHGCD    WL0118           Item Code
     C                     MOVELTHAJCD    WL0119    P      Warehouse Code
     C                     Z-ADDTHELDT    WL0120           Production Date
     C                     Z-ADDTHLXNM    WL0121           Lot Number
     C                     MOVELTHYMCD    WL0122    P      Location Code
     C                     Z-ADDTHYNCD    WL0123           Location Level
     C                     EXSR TSDLRC
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTHAIC3    WL0124           Company Number
     C                     Z-ADDTHHGCD    WL0125           Item Code
     C                     MOVELTHAJCD    WL0126    P      Warehouse Code
     C                     Z-ADDTHELDT    WL0127           Production Date
     C                     EXSR TTRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           TIAJCD           Warehouse Code
     C                     KFLD           TIYMCD           Location Code
      * Setup key
     C                     MOVELWL0077    TIAJCD           Warehouse Code
     C                     MOVELWL0078    TIYMCD           Location Code
      * Establish starting position
     C           KRSTN     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0079           WLT Type Code
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTIAGSX    WL0079           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           TJAGSX           WLT Type Code
      * Setup key
     C                     MOVELWL0080    TJAGSX           WLT Type Code
      * Establish starting position
     C           KRSTO     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0081           WLT Type Chill
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTJSLTY    WL0081           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0082    TBAIC3           Company Number
     C                     Z-ADDWL0083    TBHGCD           Item Code
      * Establish starting position
     C           KRSTP     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0084           Unit Weight
     C                     MOVEL*BLANK    WL0085           Quality Level
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTBAIWG    WL0084           Unit Weight
     C                     MOVELTBHICD    WL0085           Quality Level
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0086    TKAIC3           Company Number
     C                     Z-ADDWL0087    TKHGCD           Item Code
     C                     MOVELWL0088    TKAJCD           Warehouse Code
     C                     Z-ADDWL0089    TKELDT           Production Date
     C                     Z-ADDWL0090    TKLXNM           Lot Number
     C                     MOVELWL0091    TKYMCD           Location Code
     C                     Z-ADDWL0092    TKYNCD           Location Level
     C                     Z-ADDWL0093    TKJ2QT           ILL Item Qty On
     C                     Z-ADDWL0094    TKG5WG           ILL Unit Weight
     C                     Z-ADDWL0095    TKJ3QT           ILL Co-Packer L
     C                     Z-ADDWL0096    TKG6WG           ILl Item Wgt On
     C                     Z-ADDWL0097    TKJ4QT           ILL Unused Qty
     C                     Z-ADDWL0098    TKG7WG           ILL Unused Wgt
     C                     Z-ADDWL0099    TKLODT           ILL Avail Ship
     C                     Z-ADDWL0100    TKLPDT           ILL Unused Date
     C                     Z-ADDWL0101    TKLQDT           ILL Unused Date
     C                     Z-ADDWL0102    TKNBR            ILL Unused Nbr
     C                     MOVELWL0103    TKYTCD           ILL Customer Co
     C                     MOVELWL0104    TKAMSX           ILL Status
     C                     MOVELWL0105    TKASSX           ILL Unused Sts
     C                     MOVELWL0106    TKATSX           ILL Unused Sts
     C                     MOVELWL0107    TKAUSX           ILL Unused Sts
     C                     MOVELWL0108    TKYSCD           Inv Hold Reason
     C                     MOVELWL0109    TKUVST           EDI Status 1
     C                     MOVELWL0110    TKUWST           EDI Status 2
     C                     MOVELWL0111    TKUXST           EDI Status 3
     C                     MOVELWL0112    TKVSST           Record Status
     C                     Z-ADDWL0113    TKAATM           Job Time
     C                     MOVELWL0114    TKAYNA           User Id
     C                     MOVELWL0115    TKA0NA           Job Name
     C                     Z-ADDWL0116    TKAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TKVSST           Record Status
     C                     Z-ADD##JTM     TKAATM           Job Time
     C                     MOVEL##USR     TKAYNA           User Id
     C                     MOVEL##JOB     TKA0NA           Job Name
     C                     Z-ADD##JDT     TKAXDT           Job Date
     C           KLCRTQ    KLIST
     C                     KFLD           TKAIC3           Company Number
     C                     KFLD           TKHGCD           Item Code
     C                     KFLD           TKAJCD           Warehouse Code
     C                     KFLD           TKELDT           Production Date
     C                     KFLD           TKLXNM           Lot Number
     C                     KFLD           TKYMCD           Location Code
     C                     KFLD           TKYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCHRC    BEGSR
      *================================================================
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0390 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0391  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0392  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0393 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0394  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0395  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0396  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0397  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0398  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0399  1        ILL Status
     C                     MOVEL*BLANK    WN0400  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0401  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0402  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0403  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0404  1        EDI Status 1
     C                     MOVEL*BLANK    WN0405  1        EDI Status 2
     C                     MOVEL*BLANK    WN0406  1        EDI Status 3
     C                     MOVEL*BLANK    WN0407  1        Record Status
     C                     Z-ADD*ZERO     WN0408  60       Job Time
     C                     MOVEL*BLANK    WN0409 10        User Id
     C                     MOVEL*BLANK    WN0410 10        Job Name
     C                     Z-ADD*ZERO     WN0411  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDTHAIC3    TKAIC3           Company Number
     C                     Z-ADDTHHGCD    TKHGCD           Item Code
     C                     MOVELTHAJCD    TKAJCD    P      Warehouse Code
     C                     Z-ADDTHELDT    TKELDT           Production Date
     C                     Z-ADDTHLXNM    TKLXNM           Lot Number
     C                     MOVELTHYMCD    TKYMCD    P      Location Code
     C                     Z-ADDTHYNCD    TKYNCD           Location Level
      *
     C           KLCHTR    KLIST
     C                     KFLD           TKAIC3           Company Number
     C                     KFLD           TKHGCD           Item Code
     C                     KFLD           TKAJCD           Warehouse Code
     C                     KFLD           TKELDT           Production Date
     C                     KFLD           TKLXNM           Lot Number
     C                     KFLD           TKYMCD           Location Code
     C                     KFLD           TKYNCD           Location Level
     C           KLCHTR    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YFRDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWN0364    TKJ2QT           ILL Item Qty On
     C                     Z-ADDWN0367    TKG6WG           ILl Item Wgt On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     TKAATM           Job Time
     C                     MOVEL##USR     TKAYNA           User Id
     C                     MOVEL##JOB     TKA0NA           Job Name
     C                     Z-ADD##JDT     TKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0412  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0117    TKAIC3           Company Number
     C                     Z-ADDWL0118    TKHGCD           Item Code
     C                     MOVELWL0119    TKAJCD           Warehouse Code
     C                     Z-ADDWL0120    TKELDT           Production Date
     C                     Z-ADDWL0121    TKLXNM           Lot Number
     C                     MOVELWL0122    TKYMCD           Location Code
     C                     Z-ADDWL0123    TKYNCD           Location Level
      *
     C           KLDLTS    KLIST
     C                     KFLD           TKAIC3           Company Number
     C                     KFLD           TKHGCD           Item Code
     C                     KFLD           TKAJCD           Warehouse Code
     C                     KFLD           TKELDT           Production Date
     C                     KFLD           TKLXNM           Lot Number
     C                     KFLD           TKYMCD           Location Code
     C                     KFLD           TKYNCD           Location Level
     C           KLDLTS    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           TCAIC3           Company Number
     C                     KFLD           TCHGCD           Item Code
     C                     KFLD           TCAJCD           Warehouse Code
     C                     KFLD           TCELDT           Production Date
      * Setup key
     C                     Z-ADDWL0124    TCAIC3           Company Number
     C                     Z-ADDWL0125    TCHGCD           Item Code
     C                     MOVELWL0126    TCAJCD           Warehouse Code
     C                     Z-ADDWL0127    TCELDT           Production Date
      * Establish starting position
     C           KRSTT     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity on Hand - U/M1 is Equal to zero
     C           TCARQT    IFEQ 0                          *IF
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
     C                     EXSR TUDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUDLRC    BEGSR
      *================================================================
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDTCAIC3    TLAIC3           Company Number
     C                     Z-ADDTCHGCD    TLHGCD           Item Code
     C                     MOVELTCAJCD    TLAJCD           Warehouse Code
     C                     Z-ADDTCELDT    TLELDT           Production Date
      *
     C           KLDLTU    KLIST
     C                     KFLD           TLAIC3           Company Number
     C                     KFLD           TLHGCD           Item Code
     C                     KFLD           TLAJCD           Warehouse Code
     C                     KFLD           TLELDT           Production Date
     C           KLDLTU    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCHRC    BEGSR
      *================================================================
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0413  50       OIA Alloc/Shipp
     C                     Z-ADD*ZERO     WN0414 112       OIA Alloc/Shipp
     C                     Z-ADD*ZERO     WN0415  50       OIA Co-Packer L
     C                     Z-ADD*ZERO     WN0416 112       OIA Serial Numb
     C                     MOVEL*BLANK    WN0417  1        OIA Create Sts
     C                     MOVEL*BLANK    WN0418  1        OIA Modified St
     C                     MOVEL*BLANK    WN0419  2        OIA Loc Pick St
     C                     MOVEL*BLANK    WN0420  1        OIA Unused Sts
     C                     MOVEL*BLANK    WN0421  2        OIA Unused Sts
     C                     Z-ADD*ZERO     WN0422  70       Item Code
     C                     MOVEL*BLANK    WN0423  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0424  70       Production Date
     C                     Z-ADD*ZERO     WN0425  50       Lot Number
     C                     MOVEL*BLANK    WN0426  4        Location Code
     C                     Z-ADD*ZERO     WN0427  20       Location Level
     C                     MOVEL*BLANK    WN0428  1        EDI Status 1
     C                     MOVEL*BLANK    WN0429  1        EDI Status 2
     C                     MOVEL*BLANK    WN0430  1        EDI Status 3
     C                     MOVEL*BLANK    WN0431  1        Record Status
     C                     Z-ADD*ZERO     WN0432  60       Job Time
     C                     MOVEL*BLANK    WN0433 10        User Id
     C                     MOVEL*BLANK    WN0434 10        Job Name
     C                     Z-ADD*ZERO     WN0435  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @L8CPSX
     C                     Z-ADDWL0128    WSAIC3           Company Number
     C                     Z-ADDWL0129    WSC4NB           Order Number
     C                     Z-ADDWL0130    WSDPNB           Order Sequence
     C                     Z-ADDWL0131    WSUENB           Order Secondary
     C                     Z-ADDWL0132    WSALSW           Allocation Seq
      *
     C           KLCHTV    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
     C                     KFLD           WSDPNB           Order Sequence
     C                     KFLD           WSUENB           Order Secondary
     C                     KFLD           WSALSW           Allocation Seq
     C           KLCHTV    CHAIN@L8CPSX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL81    YGRDCS
      * Move non-key fields to @L8CPSX
     C                     MOVELWL0133    WSSOAS    P      OIA Allocation
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@L8CPSX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * UPD Unship Load Status RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WERMNB           Load ID
      * Setup key
     C                     Z-ADDWN0010    WERMNB           Load ID
      * Establish starting position
     C           KRSTW     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * 11/12/02  zero out actual ship date
      * CASE: DB1.Load Status is Shipped
     C           WEPKST    IFEQ 'S'                        *IF
      * CHG Load when UnshippedCH - Load Header  * 
     C                     EXSR TXCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXCHRC    BEGSR
      *================================================================
      * CHG Load when UnshippedCH - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0445  1        LTL Flag
     C                     Z-ADD*ZERO     WN0446  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0447 15        Seal 1
     C                     MOVEL*BLANK    WN0448 15        Seal 2
     C                     MOVEL*BLANK    WN0449 15        Seal 3
     C                     MOVEL*BLANK    WN0450 15        Seal 4
     C                     MOVEL*BLANK    WN0451 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0452  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0453 112       Flat Amount
     C                     MOVEL*BLANK    WN0454  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0455  50       Total Stops
     C                     MOVEL*BLANK    WN0456 20        Trailer Id
     C                     MOVEL*BLANK    WN0457  3        Transloader Car
     C                     Z-ADD*ZERO     WN0458  40       BOL Time
     C                     MOVEL*BLANK    WN0459  3        Carrier Code
     C                     MOVEL*BLANK    WN0460  7        Truck Size
     C                     Z-ADD*ZERO     WN0461  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0462 112       Rated Freight
     C                     MOVEL*BLANK    WN0463  1        Ship Status
     C                     MOVEL*BLANK    WN0464  1        Load Type
     C                     Z-ADD*ZERO     WN0465  50       Number Pallets
     C                     Z-ADD*ZERO     WN0466  50       Number Pallets
     C                     Z-ADD*ZERO     WN0467 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0468  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0469  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0470  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0471 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0472 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0473  70       Actual Departur
     C                     Z-ADD*ZERO     WN0474  40       Departure Time
     C                     Z-ADD*ZERO     WN0475  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0476  52       Product Tempera
     C                     Z-ADD*ZERO     WN0477  50       Number Spacers
     C                     MOVEL*BLANK    WN0478 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0479  70       Total Load Mile
     C                     MOVEL*BLANK    WN0480 12        Recorder ID
     C                     MOVEL*BLANK    WN0481  2        Shipping Method
     C                     MOVEL*BLANK    WN0482  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0483  2        Ship To State C
     C                     Z-ADD*ZERO     WN0484  70       Gross Weight
     C                     MOVEL*BLANK    WN0485  3        Carrier Broker
     C                     MOVEL*BLANK    WN0486  1        Export Status
     C                     MOVEL*BLANK    WN0487  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0488  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0489  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0490  70       Spotted Date
     C                     Z-ADD*ZERO     WN0491  60       Spotted Time
     C                     Z-ADD*ZERO     WN0492  70       Load Finished D
     C                     Z-ADD*ZERO     WN0493  60       Load Finished T
     C                     Z-ADD*ZERO     WN0494  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0495  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0496  70       Truck Departure
     C                     Z-ADD*ZERO     WN0497  60       Truck Departure
     C                     Z-ADD*ZERO     WN0498  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0499  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0500  3        Shipping Line
     C                     MOVEL*BLANK    WN0501 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0502 30        Vessel Name
     C                     Z-ADD*ZERO     WN0503  50       Voyage
     C                     Z-ADD*ZERO     WN0504  70       Sail Date
     C                     MOVEL*BLANK    WN0505 12        Booking Number
     C                     MOVEL*BLANK    WN0506 20        Discharge Port
     C                     Z-ADD*ZERO     WN0507  70       Arrival Date
     C                     MOVEL*BLANK    WN0508 12        Container Numbe
     C                     Z-ADD*ZERO     WN0509  70       Date In
     C                     Z-ADD*ZERO     WN0510  60       Time In
     C                     Z-ADD*ZERO     WN0511  70       Date Out
     C                     Z-ADD*ZERO     WN0512  60       Time Out
     C                     Z-ADD*ZERO     WN0513 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0514  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0515  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0516  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0517  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0518  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0519  70       Requested Deliv
     C                     MOVEL*BLANK    WN0520  1        Load Acceptance
     C                     MOVEL*BLANK    WN0521  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0522  70       On Yard Date
     C                     Z-ADD*ZERO     WN0523  60       On Yard Time
     C                     Z-ADD*ZERO     WN0524  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0525  60       Deadline Depart
     C                     MOVEL*BLANK    WN0526  1        Load Held Over
     C                     MOVEL*BLANK    WN0527  1        Load Held Over
     C                     MOVEL*BLANK    WN0528 15        Load Held Over
     C                     MOVEL*BLANK    WN0529 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0530 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0531  70       Express Mail Da
     C                     MOVEL*BLANK    WN0532  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0533  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0534  70       Product Complet
     C                     Z-ADD*ZERO     WN0535  60       Product Complet
     C                     Z-ADD*ZERO     WN0536  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0537  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0538  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0539  1        Load Confirmed
     C                     MOVEL*BLANK    WN0540 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0541  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0542  60       Load Door 1
     C                     Z-ADD*ZERO     WN0543  70       Override Total
     C                     Z-ADD*ZERO     WN0544  60       Load Door 2
     C                     MOVEL*BLANK    WN0545  1        Partial Load
     C                     MOVEL*BLANK    WN0546  1        Load Confirmati
     C                     MOVEL*BLANK    WN0547  1        Export Load USD
     C                     MOVEL*BLANK    WN0548  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0549 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0550 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0551 15        Late Billing Em
     C                     MOVEL*BLANK    WN0552 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0553 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0554  1        Multi Company L
     C                     MOVEL*BLANK    WN0555  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0556  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0557  1        LH Power Only L
     C                     MOVEL*BLANK    WN0558  1        MG Created Load
     C                     MOVEL*BLANK    WN0559  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0560  2        Load U/M
     C                     MOVEL*BLANK    WN0561  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0562  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0563  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0564  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0565  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0566  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0567  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0568  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0569  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0570  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0571  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0572  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0573  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0574  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0575  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0576  60       LH Unused Time
     C                     MOVEL*BLANK    WN0577  1        EDI Status 1
     C                     MOVEL*BLANK    WN0578  1        EDI Status 2
     C                     MOVEL*BLANK    WN0579  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0580  60       Job Time
     C                     MOVEL*BLANK    WN0581 10        User Id
     C                     MOVEL*BLANK    WN0582 10        Job Name
     C                     Z-ADD*ZERO     WN0583  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWERMNB    TMRMNB           Load ID
      *
     C           KLCHTX    KLIST
     C                     KFLD           TMRMNB           Load ID
     C           KLCHTX    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YHRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWEAIC3    TMAIC3           Company Number
     C                     Z-ADDWEAODT    TMAODT           Scheduled Ship
     C                     MOVEL'L'       TMPKST    P      Load Status
     C                     Z-ADD0         TMF9DT           Actual Ship Dat
     C                     Z-ADD0         TMJ7DT           BOL Complete Da
     C                     Z-ADD0         TMBOTM           BOL Complete Ti
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     TMAATM           Job Time
     C                     MOVEL##USR     TMAYNA           User Id
     C                     MOVEL##JOB     TMA0NA           Job Name
     C                     Z-ADD##JDT     TMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * PFS Unship Order      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0003    WBAIC3           Company Number
     C                     Z-ADDWN0004    WBC4NB           Order Number
      * Establish starting position
     C           KRSTY     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWBGWST    YL0025           Header Status L
     C                     MOVEL'A'       YL0026           Header Status
      * CHG for Unship         CH - Order Header TRG  * 
     C                     EXSR TZCHRC
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCHRC    BEGSR
      *================================================================
      * CHG for Unship         CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0584  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0585  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0586  70       Ship To Custome
     C                     MOVEL*BLANK    WN0587 30        Ship To Name
     C                     MOVEL*BLANK    WN0588 30        Ship To Address
     C                     MOVEL*BLANK    WN0589 30        Ship To Address
     C                     MOVEL*BLANK    WN0590 30        Ship To Address
     C                     MOVEL*BLANK    WN0591 20        Ship To City
     C                     MOVEL*BLANK    WN0592  2        Ship To State C
     C                     MOVEL*BLANK    WN0593 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0594  70       Bill to Custome
     C                     MOVEL*BLANK    WN0595 30        Bill to Name
     C                     MOVEL*BLANK    WN0596 30        Bill to Address
     C                     MOVEL*BLANK    WN0597 30        Bill to Address
     C                     MOVEL*BLANK    WN0598 30        Bill to Address
     C                     MOVEL*BLANK    WN0599 20        Bill to City
     C                     MOVEL*BLANK    WN0600  2        Bill to State C
     C                     MOVEL*BLANK    WN0601 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0602 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0603  70       Order Date
     C                     Z-ADD*ZERO     WN0604  70       Requested Ship
     C                     Z-ADD*ZERO     WN0605  70       Cancel Date
     C                     MOVEL*BLANK    WN0606  2        Terms Code
     C                     MOVEL*BLANK    WN0607 40        Special Instruc
     C                     MOVEL*BLANK    WN0608 40        Special Instruc
     C                     MOVEL*BLANK    WN0609  3        Carrier Code
     C                     MOVEL*BLANK    WN0610  1        Comment Print A
     C                     MOVEL*BLANK    WN0611  1        Comment Print I
     C                     MOVEL*BLANK    WN0612  1        Comment Print P
     C                     MOVEL*BLANK    WN0613  1        Comment Print S
     C                     MOVEL*BLANK    WN0614  3        Reason Code
     C                     MOVEL*BLANK    WN0615  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0616  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0617 10        User Original E
     C                     Z-ADD*ZERO     WN0618  70       Date of Origina
     C                     Z-ADD*ZERO     WN0619 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0620 112       Order Weight To
     C                     MOVEL*BLANK    WN0621  1        Credit Hold
     C                     MOVEL*BLANK    WN0622  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0623  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0624  40       Requested Deliv
     C                     MOVEL*BLANK    WN0625  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0626 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0627  70       Load ID
     C                     Z-ADD*ZERO     WN0628  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0629 112       Rated Freight
     C                     MOVEL*BLANK    WN0630  1        LTL Flag
     C                     MOVEL*BLANK    WN0631  1        Price Audit
     C                     MOVEL*BLANK    WN0632  1        Price Status
     C                     MOVEL*BLANK    WN0633  2        Shipping Method
     C                     MOVEL*BLANK    WN0634  1        Export Status
     C                     MOVEL*BLANK    WN0635  1        Palletize
     C                     MOVEL*BLANK    WN0636  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0637  1        Slip Sheet
     C                     MOVEL*BLANK    WN0638  1        Age Code
     C                     Z-ADD*ZERO     WN0639  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0640  1        Load Type
     C                     Z-ADD*ZERO     WN0641  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0642  1        Load Plan Order
     C                     MOVEL*BLANK    WN0643  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0644  70       Resell Referenc
     C                     MOVEL*BLANK    WN0645 30        Special Comment
     C                     MOVEL*BLANK    WN0646 30        Special Comment
     C                     MOVEL*BLANK    WN0647  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0648  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0649  2        Manager Level C
     C                     MOVEL*BLANK    WN0650  3        VP Level Code
     C                     Z-ADD*ZERO     WN0651  70       Attach to Order
     C                     MOVEL*BLANK    WN0652  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0653  70       Invoice Number
     C                     MOVEL*BLANK    WN0654  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0655  70       Invoice Date
     C                     MOVEL*BLANK    WN0656  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0657  1        Block Order Fla
     C                     MOVEL*BLANK    WN0658  1        Order Certifica
     C                     Z-ADD*ZERO     WN0659 112       Invoice Order V
     C                     MOVEL*BLANK    WN0660  1        Process Sts for
     C                     MOVEL*BLANK    WN0661  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0662  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0663  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0664  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0665  1        Email Cust On O
     C                     MOVEL*BLANK    WN0666  1        Order Emailed
     C                     MOVEL*BLANK    WN0667  1        Export Docs Go
     C                     MOVEL*BLANK    WN0668  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0669  1        Broker Order St
     C                     MOVEL*BLANK    WN0670  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0671  2        Order Requires
     C                     MOVEL*BLANK    WN0672  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0673  2        Export USDA App
     C                     MOVEL*BLANK    WN0674  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0675  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0676  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0677  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0678  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0679  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0680  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0681  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0682  60       Time of Origina
     C                     Z-ADD*ZERO     WN0683  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0684  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0685  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0686 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0687 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0688 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0689 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0690 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0691  70       Claim Number
     C                     MOVEL*BLANK    WN0692  1        EDI Status 1
     C                     MOVEL*BLANK    WN0693  1        EDI Status 2
     C                     MOVEL*BLANK    WN0694  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0695  60       Job Time
     C                     MOVEL*BLANK    WN0696 10        User Id
     C                     MOVEL*BLANK    WN0697 10        Job Name
     C                     Z-ADD*ZERO     WN0698  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WJAIC3           Company Number
     C                     Z-ADDWBC4NB    WJC4NB           Order Number
      *
     C           KLCHTZ    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHTZ    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YIRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD0         WJGNDT           Actual Shipped
     C                     MOVEL'N'       WJGJST    P      Order in Use
     C                     MOVELYL0026    WJGWST    P      Header Status
     C                     MOVELYL0025    WJGXST    P      Header Status L
     C                     MOVELWBXJST    WJXJST    P      Production Hold
     C                     MOVELYL0015    WJJPCD    P      Event Code
     C                     MOVELWBZ1ST    WJZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    WJVRVA           A/R order Value
     C                     MOVELWBOBST    WJOBST    P      Billing Activit
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWJAIC3    PAAIC3           Company Number
     C                     Z-ADDWJC4NB    PAC4NB           Order Number
     C                     MOVELWJJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWJANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWJBKC7    PABKC7           Ship To Custome
     C                     MOVELWJBRTX    PABRTX    P      Ship To Name
     C                     MOVELWJHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWJHONA    PAHONA    P      Ship To Address
     C                     MOVELWJHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWJHNNA    PAHNNA    P      Ship To City
     C                     MOVELWJDBCD    PADBCD    P      Ship To State C
     C                     MOVELWJCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWJB0C7    PAB0C7           Bill to Custome
     C                     MOVELWJAETX    PAAETX    P      Bill to Name
     C                     MOVELWJB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWJB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWJB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWJB2NA    PAB2NA    P      Bill to City
     C                     MOVELWJBHCD    PABHCD    P      Bill to State C
     C                     MOVELWJC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWJBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWJA0DT    PAA0DT           Order Date
     C                     Z-ADDWJA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWJGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWJACDT    PAACDT           Cancel Date
     C                     MOVELWJAQCD    PAAQCD    P      Terms Code
     C                     MOVELWJB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWJBYNA    PABYNA    P      Special Instruc
     C                     MOVELWJBZNA    PABZNA    P      Carrier Code
     C                     MOVELWJGTST    PAGTST    P      Comment Print A
     C                     MOVELWJGVST    PAGVST    P      Comment Print I
     C                     MOVELWJGUST    PAGUST    P      Comment Print P
     C                     MOVELWJQFST    PAQFST    P      Comment Print S
     C                     MOVELWJCQCD    PACQCD    P      Reason Code
     C                     MOVELWJGJST    PAGJST    P      Order in Use
     C                     MOVELWJGWST    PAGWST    P      Header Status
     C                     MOVELWJGXST    PAGXST    P      Header Status L
     C                     MOVELWJGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWJAODT    PAAODT           Scheduled Ship
     C                     MOVELWJAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWJCXDT    PACXDT           Date of Origina
     C                     Z-ADDWJJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWJA1WG    PAA1WG           Order Weight To
     C                     MOVELWJXIST    PAXIST    P      Credit Hold
     C                     MOVELWJXJST    PAXJST    P      Production Hold
     C                     MOVELWJXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWJEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWJAFTM    PAAFTM           Requested Deliv
     C                     MOVELWJE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWJE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWJRMNB    PARMNB           Load ID
     C                     Z-ADDWJTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWJR1NB    PAR1NB           Rated Freight
     C                     MOVELWJPJST    PAPJST    P      LTL Flag
     C                     MOVELWJU0ST    PAU0ST    P      Price Audit
     C                     MOVELWJU1ST    PAU1ST    P      Price Status
     C                     MOVELWJQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWJU2ST    PAU2ST    P      Export Status
     C                     MOVELWJVEST    PAVEST    P      Palletize
     C                     MOVELWJVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWJVGST    PAVGST    P      Slip Sheet
     C                     MOVELWJRPCD    PARPCD    P      Age Code
     C                     Z-ADDWJRNNB    PARNNB           Reefer Temperat
     C                     MOVELWJVDST    PAVDST    P      Load Type
     C                     Z-ADDWJATIN    PAATIN           Attach to Invoi
     C                     MOVELWJU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWJU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWJRSRN    PARSRN           Resell Referenc
     C                     MOVELWJMHNA    PAMHNA    P      Special Comment
     C                     MOVELWJMINA    PAMINA    P      Special Comment
     C                     MOVELWJWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWJR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWJBFCD    PABFCD    P      Manager Level C
     C                     MOVELWJQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWJT3NB    PAT3NB           Attach to Order
     C                     MOVELWJSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWJCONB    PACONB           Invoice Number
     C                     MOVELWJCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWJAWDT    PAAWDT           Invoice Date
     C                     MOVELWJJPCD    PAJPCD    P      Event Code
     C                     MOVELWJXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWJZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWJVRVA    PAVRVA           A/R order Value
     C                     MOVELWJOBST    PAOBST    P      Billing Activit
     C                     MOVELWJBCST    PABCST    P      Block Order Fla
     C                     MOVELWJBDST    PABDST    P      Order Certifica
     C                     Z-ADDWJB7VL    PAB7VL           Invoice Order V
     C                     MOVELWJGASX    PAGASX    P      Process Sts for
     C                     MOVELWJGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWJGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWJGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWJFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWJFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWJFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWJFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWJFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWJFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWJFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWJFUSX    PAFUSX    P      Order Requires
     C                     MOVELWJFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWJFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWJFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWJFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWJNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWJNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWJNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWJNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWJNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWJBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWJBQTM    PABQTM           Time of Origina
     C                     Z-ADDWJBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWJBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWJBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWJH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWJH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWJH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWJH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWJH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWJC0C7    PAC0C7           Claim Number
     C                     MOVELWJUVST    PAUVST    P      EDI Status 1
     C                     MOVELWJUWST    PAUWST    P      EDI Status 2
     C                     MOVELWJUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWJAATM    PAAATM           Job Time
     C                     MOVELWJAYNA    PAAYNA    P      User Id
     C                     MOVELWJA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWJAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * VALIDATE
      *================================================================
     C                     Z-ADDWAY1NX    WN0003           Company Number
     C                     Z-ADDWAZPNX    WN0004           Order Number
     C                     Z-ADDWAZGNX    WN0010           Load ID
      * RTV Order Info PFS    RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Get 1st not cancelled line item's whse    3/30/06 RMC
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SCRVGN
      * VAL:  Order Number
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDNUM'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Order Load ID
      * CASE: DB1.PFS Load ID NE PAR.Load ID
     C           WAZGNX    IFNE WN0010                     *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
     C                     MOVEL'ORDLD'   WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Header Status
      * CASE: PAR.Header Status is Closed or Cancelled
     C           WN0008    IFEQ 'X'                        *IF
     C           WN0008    OREQ 'C'
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDSTS'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * RTV Load Status/StrCo  RT - Load Header  * 
     C                     EXSR SERVGN
      * VAL:  Load ID
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'LOADNF'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Load Status
      * CASE: PAR.Load Status is Invoiced
     C           WN0016    IFEQ 'I'                        *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
     C                     MOVEL'LDINV'   WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Close Truck
      * CASE: DB1.PFS Ship Status is Close Truck
     C           WAVRSX    IFEQ 'CT'                       *IF
      * RTV All Ords Shipped?  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0010    WL0001           Load ID
     C                     MOVELYL0002    WL0002    P      Status - Y or N
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0002    P      Status - Y or N
      * VAL:  All Orders Shipped
      * CASE: LCL.Status - Y or N is no
     C           YL0002    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDSHP'  WN0002           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.PFS Ship Status is Order Transactions
     C           WAVRSX    IFEQ 'CO'                       *IF
     C           WAVRSX    OREQ 'PO'
     C           WAVRSX    OREQ 'UO'
     C           WAVRSX    OREQ 'UP'
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
     C                     EXSR SHRVGN
      * VAL:  ACTIVE WAREHOUSE
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0003    IFEQ 'Y'                        *IF
      * CASE: LCL.WHS PFS Interface is Upload/Both
     C           YL0004    IFEQ 'U'                        *IF
     C           YL0004    OREQ 'B'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'INACTV'  WN0002           PFS Error Reaso
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'INACTV'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Unpick Order  - new transaction 11/17/06
      * CASE: DB1.PFS Ship Status is Unpick Order
     C           WAVRSX    IFEQ 'UP'                       *IF
      * Check Order Event = 03 = picked
      * CASE: PAR.Event Code is 03 Picked
     C           WN0011    IFEQ '03'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDEVT'  WN0002           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ERR:  Do not Select Record
      * CASE: PAR.PFS Process Status is Error
     C           WN0001    IFEQ 2                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Change Log
      *================================================================
      * ** 12/17/2013 RMC C2954
      * ** Use system date/time instead of job date /time
      * 02/20/2009 LJB FP1127
      *          Order Number will be used later to retrieve the load id
      *          which will become the lot number for external, lot
      *          located, non-Carlisle controlled warehouses
      * 1/26/98  PLL C3618 Label Date problem
      *          Added Label Date parm; label date set to 1st label date
      *          on manifest rcds for a production date
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAAID8           PFS Transaction
     C                     Z-ADD*ZERO     WAAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WABCNY           PFS Transaction
     C                     Z-ADD*ZERO     WAZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WAZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WCGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WERPNB           Total Load Orde
     C                     Z-ADD*ZERO     WEFLAM           Flat Amount
     C                     Z-ADD*ZERO     WERRNB           Total Stops
     C                     Z-ADD*ZERO     WESBNB           BOL Time
     C                     Z-ADD*ZERO     WESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WESDNB           Number Pallets
     C                     Z-ADD*ZERO     WEPAOU           Number Pallets
     C                     Z-ADD*ZERO     WEDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WESXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WEHADT           Actual Arrival
     C                     Z-ADD*ZERO     WEAART           Actual Arrival
     C                     Z-ADD*ZERO     WEDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WEDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WEAQDT           Actual Departur
     C                     Z-ADD*ZERO     WES6NB           Departure Time
     C                     Z-ADD*ZERO     WET4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WEPRTM           Product Tempera
     C                     Z-ADD*ZERO     WENPSV           Number Spacers
     C                     Z-ADD*ZERO     WETLMI           Total Load Mile
     C                     Z-ADD*ZERO     WEGRWE           Gross Weight
     C                     Z-ADD*ZERO     WEF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WEJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WETRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WEJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WESPTM           Spotted Time
     C                     Z-ADD*ZERO     WEJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WELFTM           Load Finished T
     C                     Z-ADD*ZERO     WEJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WEBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WEJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WEBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WEKIDT           Truck Departure
     C                     Z-ADD*ZERO     WEASTM           Truck Departure
     C                     Z-ADD*ZERO     WEKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WEAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WEVOAG           Voyage
     C                     Z-ADD*ZERO     WEKBDT           Sail Date
     C                     Z-ADD*ZERO     WEEFDT           Arrival Date
     C                     Z-ADD*ZERO     WEKCDT           Date In
     C                     Z-ADD*ZERO     WETMIN           Time In
     C                     Z-ADD*ZERO     WEKDDT           Date Out
     C                     Z-ADD*ZERO     WEVMNB           Time Out
     C                     Z-ADD*ZERO     WEOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WEKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WEATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WEBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEKKDT           On Yard Date
     C                     Z-ADD*ZERO     WEAVTM           On Yard Time
     C                     Z-ADD*ZERO     WEKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WELLDT           Express Mail Da
     C                     Z-ADD*ZERO     WEK0DT           Product Complet
     C                     Z-ADD*ZERO     WEAYTM           Product Complet
     C                     Z-ADD*ZERO     WEKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WEICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WEIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WEK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WEAZTM           Load Door 1
     C                     Z-ADD*ZERO     WEK2DT           Override Total
     C                     Z-ADD*ZERO     WEA0TM           Load Door 2
     C                     Z-ADD*ZERO     WEZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WEPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WECKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WEPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WECLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WEP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WECMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WEP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WECNTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WECOTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WECQTM           LH Unused Time
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WFRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WFRWNB           Miles to next s
     C                     Z-ADD*ZERO     WFRXNB           Freight Charge
     C                     Z-ADD*ZERO     WFSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WFT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WFT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WFSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WFKFDT           Appointment Con
     C                     Z-ADD*ZERO     WFACTM           Appointment Con
     C                     Z-ADD*ZERO     WFEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WFAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WFKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WFATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WFHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFKKDT           On Yard Date
     C                     Z-ADD*ZERO     WFAVTM           On Yard Time
     C                     Z-ADD*ZERO     WFZ4NB           MPC Number
     C                     Z-ADD*ZERO     WFN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WFN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WFN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WFB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WFB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WFB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUZRST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGQ2NB           Event Number
     C                     Z-ADD*ZERO     WGAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WGQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WGD2DT           Event Date
     C                     Z-ADD*ZERO     WGAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WGQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WGQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Clear all neither parameters
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKM8NB           System Value Nu
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Text 2
     C                     MOVEL*BLANK    WUHKT1  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WOAID8           PFS Transaction
     C                     Z-ADD*ZERO     WOAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WOBCNY           PFS Transaction
     C                     Z-ADD*ZERO     WOZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WOZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WOZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WOY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WOAFD8           PFS Actual Ship
     C                     Z-ADD*ZERO     WOAUNY           PFS Shipped Qua
     C                     Z-ADD*ZERO     WOAVNY           PFS Shipped Wei
     C                     Z-ADD*ZERO     WOUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WOAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WOAINY           PFS Create Time
     C                     Z-ADD*ZERO     WOAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WOAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRC4NB           Order Number
     C                     Z-ADD*ZERO     WRDPNB           Order Sequence
     C                     Z-ADD*ZERO     WRUENB           Order Secondary
     C                     Z-ADD*ZERO     WRALSW           Allocation Seq
     C                     Z-ADD*ZERO     WRJ6QT           OIA Alloc/Shipp
     C                     Z-ADD*ZERO     WRG9WG           OIA Alloc/Shipp
     C                     Z-ADD*ZERO     WRJ9QT           OIA Co-Packer L
     C                     Z-ADD*ZERO     WRHAWG           OIA Serial Numb
     C                     Z-ADD*ZERO     WRHGCD           Item Code
     C                     Z-ADD*ZERO     WRELDT           Production Date
     C                     Z-ADD*ZERO     WRLXNM           Lot Number
     C                     Z-ADD*ZERO     WRYNCD           Location Level
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WTAID8           PFS Transaction
     C                     Z-ADD*ZERO     WTAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WTBCNY           PFS Transaction
     C                     Z-ADD*ZERO     WTZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WTAQNY           PFS Actual Reef
     C                     Z-ADD*ZERO     WTBGNY           PFS Actual Prod
     C                     Z-ADD*ZERO     WTARNY           PFS Pallets Rec
     C                     Z-ADD*ZERO     WTBFNY           PFS Spacers Loa
     C                     Z-ADD*ZERO     WTAJD8           PFS BOL Complet
     C                     Z-ADD*ZERO     WTAGTS           PFS BOL Complet
     C                     Z-ADD*ZERO     WTAKD8           PFS Actual Depa
     C                     Z-ADD*ZERO     WTAHTS           PFS Actual Depa
     C                     Z-ADD*ZERO     WTASNY           PFS Pallets Loa
     C                     Z-ADD*ZERO     WTBHNY           PFS Total Palle
     C                     Z-ADD*ZERO     WTUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WTAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WTAINY           PFS Create Time
     C                     Z-ADD*ZERO     WTAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WTAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WYR5NB           Deliver after t
     C                     Z-ADD*ZERO     WYR6NB           Deliver before
     C                     Z-ADD*ZERO     WYTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WYMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WYW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TAAIC3           Company Number
     C                     Z-ADD*ZERO     TAC4NB           Order Number
     C                     Z-ADD*ZERO     TADPNB           Order Sequence
     C                     Z-ADD*ZERO     TAUENB           Order Secondary
     C                     Z-ADD*ZERO     TARZNB           Case Sequence N
     C                     Z-ADD*ZERO     TAFOQT           Case Quantity
     C                     Z-ADD*ZERO     TAR0NB           Case Weight
     C                     Z-ADD*ZERO     TAK7DT           Label Date
     C                     Z-ADD*ZERO     TAPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     TAHGCD           Item Code
     C                     Z-ADD*ZERO     TAELDT           Production Date
     C                     Z-ADD*ZERO     TAN5WG           Manifest Gross
     C                     Z-ADD*ZERO     TAH5NY           Manifest Total
     C                     Z-ADD*ZERO     TAH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     TAH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     TAN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     TAN7WG           Manifest Net We
     C                     Z-ADD*ZERO     TARBDT           Manifest Unused
     C                     Z-ADD*ZERO     TAITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     TAIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     TAIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     TAIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     TAIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     TAIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBAIC3           Company Number
     C                     Z-ADD*ZERO     TBHGCD           Item Code
     C                     Z-ADD*ZERO     TBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     TBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     TBAIWG           Unit Weight
     C                     Z-ADD*ZERO     TBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     TBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     TBURTN           Number Cases On
     C                     Z-ADD*ZERO     TBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     TBRINB           Item Structure
     C                     Z-ADD*ZERO     TBRHNB           Item Structure
     C                     Z-ADD*ZERO     TBRGNB           Item Structure
     C                     Z-ADD*ZERO     TBTFNB           Transportation
     C                     Z-ADD*ZERO     TBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     TBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     TBBLPR           Market Overage
     C                     Z-ADD*ZERO     TBBMPR           Standard Overag
     C                     Z-ADD*ZERO     TBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     TBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     TBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     TBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     TBICN1           Item Category N
     C                     Z-ADD*ZERO     TBICN2           Item Category N
     C                     Z-ADD*ZERO     TBV2NB           Item Category N
     C                     Z-ADD*ZERO     TBITCN           Item Category N
     C                     Z-ADD*ZERO     TBITC5           Item Category N
     C                     Z-ADD*ZERO     TBICN6           Item Category N
     C                     Z-ADD*ZERO     TBICN7           Item Category N
     C                     Z-ADD*ZERO     TBICN8           Item Category N
     C                     Z-ADD*ZERO     TBICN9           Item Category N
     C                     Z-ADD*ZERO     TBICN0           Item Category N
     C                     Z-ADD*ZERO     TBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     TBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     TBSJNB           Production Lead
     C                     Z-ADD*ZERO     TBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     TBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     TBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     TBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     TBCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     TBILNB           Packages per ca
     C                     Z-ADD*ZERO     TBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     TBCINB           PM Batch Size
     C                     Z-ADD*ZERO     TBCJNB           Package Level s
     C                     Z-ADD*ZERO     TBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     TBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     TBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     TBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     TBCVNB           FP Std Green We
     C                     Z-ADD*ZERO     TBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     TBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     TBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     TBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     TBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     TBB5NB           PM Line Number
     C                     Z-ADD*ZERO     TBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     TBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     TBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     TBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     TBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     TBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     TBBNNB           Production Qty
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Define work field Order Number Alpha
     C                     MOVEL*BLANK    WUE7TX  7
      * Define work field Description 14A      USR
     C                     MOVEL*BLANK    WUI6TX 14
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TCAIC3           Company Number
     C                     Z-ADD*ZERO     TCHGCD           Item Code
     C                     Z-ADD*ZERO     TCELDT           Production Date
     C                     Z-ADD*ZERO     TCABWG           Physical Count
     C                     Z-ADD*ZERO     TCAGQT           Physical Count
     C                     Z-ADD*ZERO     TCAHQT           Physical Count
     C                     Z-ADD*ZERO     TCAIQT           Physical Count
     C                     Z-ADD*ZERO     TCACWG           Quantity on Han
     C                     Z-ADD*ZERO     TCARQT           Quantity on Han
     C                     Z-ADD*ZERO     TCASQT           Quantity on Han
     C                     Z-ADD*ZERO     TCATQT           Quantity on Han
     C                     Z-ADD*ZERO     TCHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     TCHEQT           Weight In Chill
     C                     Z-ADD*ZERO     TCBMWG           Physical Start
     C                     Z-ADD*ZERO     TCDSQT           Physical Start
     C                     Z-ADD*ZERO     TCDTQT           Physical Start
     C                     Z-ADD*ZERO     TCDUQT           Physical Start
     C                     Z-ADD*ZERO     TCDHDT           Physical Start
     C                     Z-ADD*ZERO     TCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     TCAECS           Last Cost
     C                     Z-ADD*ZERO     TCIDVA           Value of On Han
     C                     Z-ADD*ZERO     TCK7DT           Label Date
     C                     Z-ADD*ZERO     TCRINB           Item Structure
     C                     Z-ADD*ZERO     TCRHNB           Item Structure
     C                     Z-ADD*ZERO     TCRGNB           Item Structure
     C                     Z-ADD*ZERO     TCAATM           Job Time
     C                     Z-ADD*ZERO     TCAXDT           Job Date
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TFAIC3           Company Number
     C                     Z-ADD*ZERO     TFHGCD           Item Code
     C                     Z-ADD*ZERO     TFLRDT           LLT Trans Date
     C                     Z-ADD*ZERO     TFLLTS           LLT Sequence #
     C                     Z-ADD*ZERO     TFLSDT           LLT Production
     C                     Z-ADD*ZERO     TFJ5QT           LLT Trans Qty
     C                     Z-ADD*ZERO     TFG8WG           LLT Trans Wgt
     C                     Z-ADD*ZERO     TFLLTN           LLT Lot Number
     C                     Z-ADD*ZERO     TFLLCL           LLT Location Le
     C                     Z-ADD*ZERO     TFLLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     TFLLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     TFC4NB           Order Number
     C                     Z-ADD*ZERO     TFAATM           Job Time
     C                     Z-ADD*ZERO     TFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     THAIC3           Company Number
     C                     Z-ADD*ZERO     THHGCD           Item Code
     C                     Z-ADD*ZERO     THELDT           Production Date
     C                     Z-ADD*ZERO     THLXNM           Lot Number
     C                     Z-ADD*ZERO     THYNCD           Location Level
     C                     Z-ADD*ZERO     THJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     THG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     THJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     THG6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     THJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     THG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     THLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     THLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     THLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     THNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     THAATM           Job Time
     C                     Z-ADD*ZERO     THAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TILCBY           Location Bay
     C                     Z-ADD*ZERO     TILCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     TIAATM           Job Time
     C                     Z-ADD*ZERO     TIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TJSLTY           WLT Type Chill
     C                     Z-ADD*ZERO     TJAATM           Job Time
     C                     Z-ADD*ZERO     TJAXDT           Job Date
      * Define work field USR Order Value
     C                     Z-ADD*ZERO     WUJSVA 112
      * Define work field USR Order Weight
     C                     Z-ADD*ZERO     WUAYWG 112
      * Define work field USR Production
     C                     MOVEL*BLANK    WUXPST  1
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TOAIC3           Company Number
     C                     Z-ADD*ZERO     TOC4NB           Order Number
     C                     Z-ADD*ZERO     TODPNB           Order Sequence
     C                     Z-ADD*ZERO     TOUENB           Order Secondary
     C                     Z-ADD*ZERO     TODIC7           ED Item Code
     C                     Z-ADD*ZERO     TOHJWG           ED Product Net
     C                     Z-ADD*ZERO     TOHKWG           ED Product Net
     C                     Z-ADD*ZERO     TOAONX           ED Product Nbr
     C                     Z-ADD*ZERO     TOAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     TOANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     TOAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     TODKPR           ED Product Unit
     C                     Z-ADD*ZERO     TOA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     TOAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     TOW0DT           ED Unused Date
     C                     Z-ADD*ZERO     TOAATM           Job Time
     C                     Z-ADD*ZERO     TOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TSAIC3           Company Number
     C                     Z-ADD*ZERO     TSHGCD           Item Code
     C                     Z-ADD*ZERO     TSB4DT           Transaction Dat
     C                     Z-ADD*ZERO     TSC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     TSDXNB           Sequence Number
     C                     Z-ADD*ZERO     TSELDT           Production Date
     C                     Z-ADD*ZERO     TSA5QT           Transaction Qua
     C                     Z-ADD*ZERO     TSAHWG           Transaction Wei
     C                     Z-ADD*ZERO     TSAKCS           USR Transaction
     C                     Z-ADD*ZERO     TSAYVA           Extended Amount
     C                     Z-ADD*ZERO     TSCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     TSTRBN           Transfer Batch
     C                     Z-ADD*ZERO     TSTRBS           Transfer Batch
     C                     Z-ADD*ZERO     TSC4NB           Order Number
     C                     Z-ADD*ZERO     TSRINB           Item Structure
     C                     Z-ADD*ZERO     TSRHNB           Item Structure
     C                     Z-ADD*ZERO     TSRGNB           Item Structure
     C                     Z-ADD*ZERO     TSAWTM           Production Time
     C                     Z-ADD*ZERO     TSK7DT           Label Date
     C                     Z-ADD*ZERO     TSAATM           Job Time
     C                     Z-ADD*ZERO     TSAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  50
      * Define local variables for subroutine SLCRRC.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  50
     C                     MOVEL*BLANK    WL0009  2
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  50
     C                     Z-ADD*ZERO     WL0020  70
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     MOVEL*BLANK    WL0022 10
     C                     MOVEL*BLANK    WL0023 40
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  80
     C                     Z-ADD*ZERO     WL0027  60
      * Define local variables for subroutine SYCHRC.
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029  80
     C                     Z-ADD*ZERO     WL0030  60
     C                     Z-ADD*ZERO     WL0031  50
     C                     Z-ADD*ZERO     WL0032  10
     C                     MOVEL*BLANK    WL0033  6
      * Define local variables for subroutine TKRVGN.
     C                     Z-ADD*ZERO     WL0034  30
     C                     Z-ADD*ZERO     WL0035  70
     C                     MOVEL*BLANK    WL0036  3
     C                     MOVEL*BLANK    WL0037  2
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  30
      * Define local variables for subroutine TLCRRC.
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  3
     C                     MOVEL*BLANK    WL0043  2
     C                     Z-ADD*ZERO     WL0044  70
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  50
     C                     Z-ADD*ZERO     WL0048 112
     C                     Z-ADD*ZERO     WL0049  50
     C                     MOVEL*BLANK    WL0050  4
     C                     Z-ADD*ZERO     WL0051  20
     C                     MOVEL*BLANK    WL0052  3
     C                     Z-ADD*ZERO     WL0053  50
     C                     MOVEL*BLANK    WL0054  4
     C                     Z-ADD*ZERO     WL0055  20
     C                     Z-ADD*ZERO     WL0056  70
     C                     MOVEL*BLANK    WL0057  1
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     MOVEL*BLANK    WL0061  1
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  1
     C                     Z-ADD*ZERO     WL0064  60
     C                     MOVEL*BLANK    WL0065 10
     C                     MOVEL*BLANK    WL0066 10
     C                     Z-ADD*ZERO     WL0067  70
      * Define local variables for subroutine TMRVGN.
     C                     Z-ADD*ZERO     WL0068  30
     C                     Z-ADD*ZERO     WL0069  70
     C                     MOVEL*BLANK    WL0070  3
     C                     Z-ADD*ZERO     WL0071  70
     C                     Z-ADD*ZERO     WL0072  50
     C                     MOVEL*BLANK    WL0073  4
     C                     Z-ADD*ZERO     WL0074  20
     C                     Z-ADD*ZERO     WL0075  70
     C                     Z-ADD*ZERO     WL0076 112
      * Define local variables for subroutine TNRVGN.
     C                     MOVEL*BLANK    WL0077  3
     C                     MOVEL*BLANK    WL0078  4
     C                     MOVEL*BLANK    WL0079  1
      * Define local variables for subroutine TORVGN.
     C                     MOVEL*BLANK    WL0080  1
     C                     Z-ADD*ZERO     WL0081  52
      * Define local variables for subroutine TPRVGN.
     C                     Z-ADD*ZERO     WL0082  30
     C                     Z-ADD*ZERO     WL0083  70
     C                     Z-ADD*ZERO     WL0084 112
     C                     MOVEL*BLANK    WL0085  2
      * Define local variables for subroutine TQCRRC.
     C                     Z-ADD*ZERO     WL0086  30
     C                     Z-ADD*ZERO     WL0087  70
     C                     MOVEL*BLANK    WL0088  3
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090  50
     C                     MOVEL*BLANK    WL0091  4
     C                     Z-ADD*ZERO     WL0092  20
     C                     Z-ADD*ZERO     WL0093  50
     C                     Z-ADD*ZERO     WL0094 112
     C                     Z-ADD*ZERO     WL0095  50
     C                     Z-ADD*ZERO     WL0096 112
     C                     Z-ADD*ZERO     WL0097  50
     C                     Z-ADD*ZERO     WL0098 112
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100  70
     C                     Z-ADD*ZERO     WL0101  70
     C                     Z-ADD*ZERO     WL0102  72
     C                     MOVEL*BLANK    WL0103  6
     C                     MOVEL*BLANK    WL0104  1
     C                     MOVEL*BLANK    WL0105  1
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  2
     C                     MOVEL*BLANK    WL0108  3
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  1
     C                     MOVEL*BLANK    WL0111  1
     C                     MOVEL*BLANK    WL0112  1
     C                     Z-ADD*ZERO     WL0113  60
     C                     MOVEL*BLANK    WL0114 10
     C                     MOVEL*BLANK    WL0115 10
     C                     Z-ADD*ZERO     WL0116  70
      * Define local variables for subroutine TSDLRC.
     C                     Z-ADD*ZERO     WL0117  30
     C                     Z-ADD*ZERO     WL0118  70
     C                     MOVEL*BLANK    WL0119  3
     C                     Z-ADD*ZERO     WL0120  70
     C                     Z-ADD*ZERO     WL0121  50
     C                     MOVEL*BLANK    WL0122  4
     C                     Z-ADD*ZERO     WL0123  20
      * Define local variables for subroutine TTRVGN.
     C                     Z-ADD*ZERO     WL0124  30
     C                     Z-ADD*ZERO     WL0125  70
     C                     MOVEL*BLANK    WL0126  3
     C                     Z-ADD*ZERO     WL0127  70
      * Define local variables for subroutine TVCHRC.
     C                     Z-ADD*ZERO     WL0128  30
     C                     Z-ADD*ZERO     WL0129  70
     C                     Z-ADD*ZERO     WL0130  30
     C                     Z-ADD*ZERO     WL0131  30
     C                     Z-ADD*ZERO     WL0132  50
     C                     MOVEL*BLANK    WL0133  1
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Load Start Company USR
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Condition Name USR
     C                     MOVEL*BLANK    YL0005 25
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0006132
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0007 40
      * Define local work field Load Change Type 2
     C                     MOVEL*BLANK    YL0008  6
      * Define local work field Load Change Type 3
     C                     MOVEL*BLANK    YL0009  6
      * Define local work field Load Change Type 4
     C                     MOVEL*BLANK    YL0010  6
      * Define local work field Load Change Type 5
     C                     MOVEL*BLANK    YL0011  6
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field Event Number
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field Event Code
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0018  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0019  30
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0021 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0022 155
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0024  2
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0026  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 PRKBILLING
00003 Unship Order
00004 UNSHIP
00005 INACTV
00006 ORDSHP
