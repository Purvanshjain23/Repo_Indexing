     H/TITLE UPD Alloc Frt to Hist  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 09/14/21  Time  : 15:08:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOBCCPL1IF  E           K        DISK
      * RTV : Load Freight Charge       Retrieval index
      *
     FOPBFCPNLIF  E           K        DISK
      * RSQ : Order Header TRG          Load ID/Ship To/Order
      *
     FPMDKCPL1IF  E           K        DISK
      * RTV : Load Freight Charge Ref   Retrieval index
      *
     FOPBFCPMGIF  E           K        DISK
      * RSQ : Order Header TRG          Load/State/City/Ord
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFLCPLCIF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order 2
      *
     FOMFLCPLFIF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order 3
      *
     FPOBCCPL2IF  E           K        DISK
      * RSQ : Load Freight Charge       Load ID/Spec Type
      *
     FOMHSTPN8IF  E           K        DISK
      * RSQ : Sales History             Load#/Order#
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPMD0CPL1IF  E           K        DISK
      * RTV : Sales History EXT         Retrieval index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOMHSTPL0UF  E           K        DISK
      * UPD : Sales History             Update index
      *
     FPMD0CPL0UF  E           K        DISK                      A
      * UPD : Sales History EXT         Update index
      *
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@BCCPJ8
      * Load Freight Charge       Retrieval index
      * Renamed input format fields
     I              BCRMNB                          WARMNB
     I              BCCDAA                          WACDAA
     I              BCEPNY                          WAEPNY
     I              BCC5VL                          WAC5VL
     I              BCKBSX                          WAKBSX
     I              BCCFAA                          WACFAA
     I              BCKDSX                          WAKDSX
     I              BCKESX                          WAKESX
     I              BCKFSX                          WAKFSX
     I              BCKGSX                          WAKGSX
     I              BCKSSX                          WAKSSX
     I              BCKTSX                          WAKTSX
     I              BCKHSX                          WAKHSX
     I              BCKISX                          WAKISX
     I              BCKJSX                          WAKJSX
     I              BCEQNY                          WAEQNY
     I              BCVSST                          WAVSST
     I              BCMJDT                          WAMJDT
     I              BCBETM                          WABETM
     I              BCCCVN                          WACCVN
     I              BCCDVN                          WACDVN
     I              BCMKDT                          WAMKDT
     I              BCBFTM                          WABFTM
     I              BCCEVN                          WACEVN
     I              BCCFVN                          WACFVN
      *
     I@BFCPR4
      * Order Header TRG          Load ID/Ship To/Order
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@DKCPRF
      * Load Freight Charge Ref   Retrieval index
      * Renamed input format fields
     I              DKRMNB                          WDRMNB
     I              DKCDAA                          WDCDAA
     I              DKEPNY                          WDEPNY
     I              DKIYAA                          WDIYAA
     I              DKKFTX                          WDKFTX
     I              DKKBNY                          WDKBNY
     I              DKNET1                          WDNET1
     I              DKAZST                          WDAZST
     I              DKVSST                          WDVSST
     I              DKMJDT                          WDMJDT
     I              DKBETM                          WDBETM
     I              DKCCVN                          WDCCVN
     I              DKCDVN                          WDCDVN
     I              DKMKDT                          WDMKDT
     I              DKBFTM                          WDBFTM
     I              DKCEVN                          WDCEVN
     I              DKCFVN                          WDCFVN
      *
     I@BFCPKE
      * Order Header TRG          Load/State/City/Ord
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WGRMNB
     I              FLRUNB                          WGRUNB
     I              FLRVNB                          WGRVNB
     I              FLDQTX                          WGDQTX
     I              FLRWNB                          WGRWNB
     I              FLRXNB                          WGRXNB
     I              FLSQNB                          WGSQNB
     I              FLT0NB                          WGT0NB
     I              FLT1NB                          WGT1NB
     I              FLR1NB                          WGR1NB
     I              FLAIC3                          WGAIC3
     I              FLC4NB                          WGC4NB
     I              FLVCST                          WGVCST
     I              FLKEDT                          WGKEDT
     I              FLSXNB                          WGSXNB
     I              FLKFDT                          WGKFDT
     I              FLACTM                          WGACTM
     I              FLK5TX                          WGK5TX
     I              FLW5CD                          WGW5CD
     I              FLEJDT                          WGEJDT
     I              FLAGTM                          WGAGTM
     I              FLKJDT                          WGKJDT
     I              FLATTM                          WGATTM
     I              FLHDDT                          WGHDDT
     I              FLAUTM                          WGAUTM
     I              FLKKDT                          WGKKDT
     I              FLAVTM                          WGAVTM
     I              FLZ4NB                          WGZ4NB
     I              FLY7ST                          WGY7ST
     I              FLY2ST                          WGY2ST
     I              FLWHTX                          WGWHTX
     I              FLWITX                          WGWITX
     I              FLWJTX                          WGWJTX
     I              FLWKTX                          WGWKTX
     I              FLWLTX                          WGWLTX
     I              FLN7DT                          WGN7DT
     I              FLN8DT                          WGN8DT
     I              FLN9DT                          WGN9DT
     I              FLB3TM                          WGB3TM
     I              FLB4TM                          WGB4TM
     I              FLB5TM                          WGB5TM
     I              FLIASX                          WGIASX
     I              FLIBSX                          WGIBSX
     I              FLICSX                          WGICSX
     I              FLWVTX                          WGWVTX
     I              FLWWTX                          WGWWTX
     I              FLWXTX                          WGWXTX
     I              FLUVST                          WGUVST
     I              FLUWST                          WGUWST
     I              FLUXST                          WGUXST
     I              FLAATM                          WGAATM
     I              FLAYNA                          WGAYNA
     I              FLA0NA                          WGA0NA
     I              FLAXDT                          WGAXDT
      *
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WHAIC3
     I              BEC4NB                          WHC4NB
     I              BEJNCD                          WHJNCD
     I              BEANC7                          WHANC7
     I              BEBKC7                          WHBKC7
     I              BEBRTX                          WHBRTX
     I              BEHMNA                          WHHMNA
     I              BEHONA                          WHHONA
     I              BEHPNA                          WHHPNA
     I              BEHNNA                          WHHNNA
     I              BEDBCD                          WHDBCD
     I              BECKTX                          WHCKTX
     I              BEB0C7                          WHB0C7
     I              BEAETX                          WHAETX
     I              BEB1NA                          WHB1NA
     I              BEB3NA                          WHB3NA
     I              BEB4NA                          WHB4NA
     I              BEB2NA                          WHB2NA
     I              BEBHCD                          WHBHCD
     I              BEC8TX                          WHC8TX
     I              BEBCNA                          WHBCNA
     I              BEA0DT                          WHA0DT
     I              BEA5DT                          WHA5DT
     I              BEGNDT                          WHGNDT
     I              BEACDT                          WHACDT
     I              BEAQCD                          WHAQCD
     I              BEB6NA                          WHB6NA
     I              BEBYNA                          WHBYNA
     I              BEBZNA                          WHBZNA
     I              BEGTST                          WHGTST
     I              BEGVST                          WHGVST
     I              BEGUST                          WHGUST
     I              BEQFST                          WHQFST
     I              BECQCD                          WHCQCD
     I              BEGJST                          WHGJST
     I              BEGWST                          WHGWST
     I              BEGXST                          WHGXST
     I              BEGYST                          WHGYST
     I              BEAODT                          WHAODT
     I              BEAIVN                          WHAIVN
     I              BECXDT                          WHCXDT
     I              BEJZVA                          WHJZVA
     I              BEA1WG                          WHA1WG
     I              BEXIST                          WHXIST
     I              BEXJST                          WHXJST
     I              BEXKST                          WHXKST
     I              BEEIDT                          WHEIDT
     I              BEAFTM                          WHAFTM
     I              BEE8CD                          WHE8CD
     I              BEE9CD                          WHE9CD
     I              BERMNB                          WHRMNB
     I              BETBNB                          WHTBNB
     I              BER1NB                          WHR1NB
     I              BEPJST                          WHPJST
     I              BEU0ST                          WHU0ST
     I              BEU1ST                          WHU1ST
     I              BEQ2CD                          WHQ2CD
     I              BEU2ST                          WHU2ST
     I              BEVEST                          WHVEST
     I              BEVFST                          WHVFST
     I              BEVGST                          WHVGST
     I              BERPCD                          WHRPCD
     I              BERNNB                          WHRNNB
     I              BEVDST                          WHVDST
     I              BEATIN                          WHATIN
     I              BEU4ST                          WHU4ST
     I              BEU5ST                          WHU5ST
     I              BERSRN                          WHRSRN
     I              BEMHNA                          WHMHNA
     I              BEMINA                          WHMINA
     I              BEWBST                          WHWBST
     I              BER4CD                          WHR4CD
     I              BEBFCD                          WHBFCD
     I              BEQ4CD                          WHQ4CD
     I              BET3NB                          WHT3NB
     I              BESICD                          WHSICD
     I              BECONB                          WHCONB
     I              BECEST                          WHCEST
     I              BEAWDT                          WHAWDT
     I              BEJPCD                          WHJPCD
     I              BEXUST                          WHXUST
     I              BEZ1ST                          WHZ1ST
     I              BEVRVA                          WHVRVA
     I              BEOBST                          WHOBST
     I              BEBCST                          WHBCST
     I              BEBDST                          WHBDST
     I              BEB7VL                          WHB7VL
     I              BEGASX                          WHGASX
     I              BEGBSX                          WHGBSX
     I              BEGCSX                          WHGCSX
     I              BEGDSX                          WHGDSX
     I              BEFNSX                          WHFNSX
     I              BEFOSX                          WHFOSX
     I              BEFPSX                          WHFPSX
     I              BEFQSX                          WHFQSX
     I              BEFRSX                          WHFRSX
     I              BEFSSX                          WHFSSX
     I              BEFTSX                          WHFTSX
     I              BEFUSX                          WHFUSX
     I              BEFVSX                          WHFVSX
     I              BEFWSX                          WHFWSX
     I              BEFXSX                          WHFXSX
     I              BEFYSX                          WHFYSX
     I              BENODT                          WHNODT
     I              BENPDT                          WHNPDT
     I              BENQDT                          WHNQDT
     I              BENRDT                          WHNRDT
     I              BENSDT                          WHNSDT
     I              BEBPTM                          WHBPTM
     I              BEBQTM                          WHBQTM
     I              BEBRTM                          WHBRTM
     I              BEBSTM                          WHBSTM
     I              BEBTTM                          WHBTTM
     I              BEH0NX                          WHH0NX
     I              BEH1NX                          WHH1NX
     I              BEH2NX                          WHH2NX
     I              BEH3NX                          WHH3NX
     I              BEH4NX                          WHH4NX
     I              BEC0C7                          WHC0C7
     I              BEUVST                          WHUVST
     I              BEUWST                          WHUWST
     I              BEUXST                          WHUXST
     I              BEAATM                          WHAATM
     I              BEAYNA                          WHAYNA
     I              BEA0NA                          WHA0NA
     I              BEAXDT                          WHAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WJRMNB
     I              FJAIC3                          WJAIC3
     I              FJAODT                          WJAODT
     I              FJPJST                          WJPJST
     I              FJPKST                          WJPKST
     I              FJRNNB                          WJRNNB
     I              FJDMTX                          WJDMTX
     I              FJDNTX                          WJDNTX
     I              FJDOTX                          WJDOTX
     I              FJWTTX                          WJWTTX
     I              FJWUTX                          WJWUTX
     I              FJRPNB                          WJRPNB
     I              FJFLAM                          WJFLAM
     I              FJXQST                          WJXQST
     I              FJRRNB                          WJRRNB
     I              FJDXTX                          WJDXTX
     I              FJDYTX                          WJDYTX
     I              FJSBNB                          WJSBNB
     I              FJBZNA                          WJBZNA
     I              FJRONB                          WJRONB
     I              FJSQNB                          WJSQNB
     I              FJR1NB                          WJR1NB
     I              FJVCST                          WJVCST
     I              FJVDST                          WJVDST
     I              FJSDNB                          WJSDNB
     I              FJPAOU                          WJPAOU
     I              FJDGWG                          WJDGWG
     I              FJSXNB                          WJSXNB
     I              FJHADT                          WJHADT
     I              FJAART                          WJAART
     I              FJDHWG                          WJDHWG
     I              FJDIWG                          WJDIWG
     I              FJAQDT                          WJAQDT
     I              FJS6NB                          WJS6NB
     I              FJT4NB                          WJT4NB
     I              FJPRTM                          WJPRTM
     I              FJNPSV                          WJNPSV
     I              FJJ8TX                          WJJ8TX
     I              FJTLMI                          WJTLMI
     I              FJJ9TX                          WJJ9TX
     I              FJQ2CD                          WJQ2CD
     I              FJVPCD                          WJVPCD
     I              FJDBCD                          WJDBCD
     I              FJGRWE                          WJGRWE
     I              FJXCCD                          WJXCCD
     I              FJU2ST                          WJU2ST
     I              FJF9DT                          WJF9DT
     I              FJONTM                          WJONTM
     I              FJJ4DT                          WJJ4DT
     I              FJTRTM                          WJTRTM
     I              FJJ5DT                          WJJ5DT
     I              FJSPTM                          WJSPTM
     I              FJJ6DT                          WJJ6DT
     I              FJLFTM                          WJLFTM
     I              FJJ7DT                          WJJ7DT
     I              FJBOTM                          WJBOTM
     I              FJJ8DT                          WJJ8DT
     I              FJBLTM                          WJBLTM
     I              FJKIDT                          WJKIDT
     I              FJASTM                          WJASTM
     I              FJKADT                          WJKADT
     I              FJAJCM                          WJAJCM
     I              FJXACD                          WJXACD
     I              FJOANA                          WJOANA
     I              FJK4TX                          WJK4TX
     I              FJVOAG                          WJVOAG
     I              FJKBDT                          WJKBDT
     I              FJNBBO                          WJNBBO
     I              FJW4CD                          WJW4CD
     I              FJEFDT                          WJEFDT
     I              FJCNTN                          WJCNTN
     I              FJKCDT                          WJKCDT
     I              FJTMIN                          WJTMIN
     I              FJKDDT                          WJKDDT
     I              FJVMNB                          WJVMNB
     I              FJOCFR                          WJOCFR
     I              FJKJDT                          WJKJDT
     I              FJATTM                          WJATTM
     I              FJOTRS                          WJOTRS
     I              FJRNST                          WJRNST
     I              FJBRBK                          WJBRBK
     I              FJEIDT                          WJEIDT
     I              FJRMST                          WJRMST
     I              FJAJCD                          WJAJCD
     I              FJKKDT                          WJKKDT
     I              FJAVTM                          WJAVTM
     I              FJKZDT                          WJKZDT
     I              FJAXTM                          WJAXTM
     I              FJLHOS                          WJLHOS
     I              FJLHOR                          WJLHOR
     I              FJWNTX                          WJWNTX
     I              FJOITX                          WJOITX
     I              FJOJTX                          WJOJTX
     I              FJLLDT                          WJLLDT
     I              FJLSHG                          WJLSHG
     I              FJYPST                          WJYPST
     I              FJK0DT                          WJK0DT
     I              FJAYTM                          WJAYTM
     I              FJKNNX                          WJKNNX
     I              FJICWG                          WJICWG
     I              FJIDWG                          WJIDWG
     I              FJH9SX                          WJH9SX
     I              FJWOTX                          WJWOTX
     I              FJK1DT                          WJK1DT
     I              FJAZTM                          WJAZTM
     I              FJK2DT                          WJK2DT
     I              FJA0TM                          WJA0TM
     I              FJROST                          WJROST
     I              FJRPST                          WJRPST
     I              FJRQST                          WJRQST
     I              FJRRST                          WJRRST
     I              FJZBVA                          WJZBVA
     I              FJWPTX                          WJWPTX
     I              FJWQTX                          WJWQTX
     I              FJWRTX                          WJWRTX
     I              FJWSTX                          WJWSTX
     I              FJRVSX                          WJRVSX
     I              FJRUSX                          WJRUSX
     I              FJRWSX                          WJRWSX
     I              FJRXSX                          WJRXSX
     I              FJRYSX                          WJRYSX
     I              FJRZSX                          WJRZSX
     I              FJR0SX                          WJR0SX
     I              FJR1SX                          WJR1SX
     I              FJR2SX                          WJR2SX
     I              FJR3SX                          WJR3SX
     I              FJR4SX                          WJR4SX
     I              FJPYDT                          WJPYDT
     I              FJCKTM                          WJCKTM
     I              FJPZDT                          WJPZDT
     I              FJCLTM                          WJCLTM
     I              FJP0DT                          WJP0DT
     I              FJCMTM                          WJCMTM
     I              FJP1DT                          WJP1DT
     I              FJCNTM                          WJCNTM
     I              FJP2DT                          WJP2DT
     I              FJCOTM                          WJCOTM
     I              FJP3DT                          WJP3DT
     I              FJCQTM                          WJCQTM
     I              FJUVST                          WJUVST
     I              FJUWST                          WJUWST
     I              FJUXST                          WJUXST
     I              FJAATM                          WJAATM
     I              FJAYNA                          WJAYNA
     I              FJA0NA                          WJA0NA
     I              FJAXDT                          WJAXDT
      *
     I@FLCPCW
      * Load Detail               Load/Stop/Order 2
      * Renamed input format fields
     I              FLRMNB                          WKRMNB
     I              FLRUNB                          WKRUNB
     I              FLRVNB                          WKRVNB
     I              FLDQTX                          WKDQTX
     I              FLRWNB                          WKRWNB
     I              FLRXNB                          WKRXNB
     I              FLSQNB                          WKSQNB
     I              FLT0NB                          WKT0NB
     I              FLT1NB                          WKT1NB
     I              FLR1NB                          WKR1NB
     I              FLAIC3                          WKAIC3
     I              FLC4NB                          WKC4NB
     I              FLVCST                          WKVCST
     I              FLKEDT                          WKKEDT
     I              FLSXNB                          WKSXNB
     I              FLKFDT                          WKKFDT
     I              FLACTM                          WKACTM
     I              FLK5TX                          WKK5TX
     I              FLW5CD                          WKW5CD
     I              FLEJDT                          WKEJDT
     I              FLAGTM                          WKAGTM
     I              FLKJDT                          WKKJDT
     I              FLATTM                          WKATTM
     I              FLHDDT                          WKHDDT
     I              FLAUTM                          WKAUTM
     I              FLKKDT                          WKKKDT
     I              FLAVTM                          WKAVTM
     I              FLZ4NB                          WKZ4NB
     I              FLY7ST                          WKY7ST
     I              FLY2ST                          WKY2ST
     I              FLWHTX                          WKWHTX
     I              FLWITX                          WKWITX
     I              FLWJTX                          WKWJTX
     I              FLWKTX                          WKWKTX
     I              FLWLTX                          WKWLTX
     I              FLN7DT                          WKN7DT
     I              FLN8DT                          WKN8DT
     I              FLN9DT                          WKN9DT
     I              FLB3TM                          WKB3TM
     I              FLB4TM                          WKB4TM
     I              FLB5TM                          WKB5TM
     I              FLIASX                          WKIASX
     I              FLIBSX                          WKIBSX
     I              FLICSX                          WKICSX
     I              FLWVTX                          WKWVTX
     I              FLWWTX                          WKWWTX
     I              FLWXTX                          WKWXTX
     I              FLUVST                          WKUVST
     I              FLUWST                          WKUWST
     I              FLUXST                          WKUXST
     I              FLAATM                          WKAATM
     I              FLAYNA                          WKAYNA
     I              FLA0NA                          WKA0NA
     I              FLAXDT                          WKAXDT
      *
     I@FLCPZA
      * Load Detail               Load/Stop/Order 3
      * Renamed input format fields
     I              FLRMNB                          WLRMNB
     I              FLRUNB                          WLRUNB
     I              FLRVNB                          WLRVNB
     I              FLDQTX                          WLDQTX
     I              FLRWNB                          WLRWNB
     I              FLRXNB                          WLRXNB
     I              FLSQNB                          WLSQNB
     I              FLT0NB                          WLT0NB
     I              FLT1NB                          WLT1NB
     I              FLR1NB                          WLR1NB
     I              FLAIC3                          WLAIC3
     I              FLC4NB                          WLC4NB
     I              FLVCST                          WLVCST
     I              FLKEDT                          WLKEDT
     I              FLSXNB                          WLSXNB
     I              FLKFDT                          WLKFDT
     I              FLACTM                          WLACTM
     I              FLK5TX                          WLK5TX
     I              FLW5CD                          WLW5CD
     I              FLEJDT                          WLEJDT
     I              FLAGTM                          WLAGTM
     I              FLKJDT                          WLKJDT
     I              FLATTM                          WLATTM
     I              FLHDDT                          WLHDDT
     I              FLAUTM                          WLAUTM
     I              FLKKDT                          WLKKDT
     I              FLAVTM                          WLAVTM
     I              FLZ4NB                          WLZ4NB
     I              FLY7ST                          WLY7ST
     I              FLY2ST                          WLY2ST
     I              FLWHTX                          WLWHTX
     I              FLWITX                          WLWITX
     I              FLWJTX                          WLWJTX
     I              FLWKTX                          WLWKTX
     I              FLWLTX                          WLWLTX
     I              FLN7DT                          WLN7DT
     I              FLN8DT                          WLN8DT
     I              FLN9DT                          WLN9DT
     I              FLB3TM                          WLB3TM
     I              FLB4TM                          WLB4TM
     I              FLB5TM                          WLB5TM
     I              FLIASX                          WLIASX
     I              FLIBSX                          WLIBSX
     I              FLICSX                          WLICSX
     I              FLWVTX                          WLWVTX
     I              FLWWTX                          WLWWTX
     I              FLWXTX                          WLWXTX
     I              FLUVST                          WLUVST
     I              FLUWST                          WLUWST
     I              FLUXST                          WLUXST
     I              FLAATM                          WLAATM
     I              FLAYNA                          WLAYNA
     I              FLA0NA                          WLA0NA
     I              FLAXDT                          WLAXDT
      *
     I@BCCPGQ
      * Load Freight Charge       Load ID/Spec Type
      * Renamed input format fields
     I              BCRMNB                          WMRMNB
     I              BCCDAA                          WMCDAA
     I              BCEPNY                          WMEPNY
     I              BCC5VL                          WMC5VL
     I              BCKBSX                          WMKBSX
     I              BCCFAA                          WMCFAA
     I              BCKDSX                          WMKDSX
     I              BCKESX                          WMKESX
     I              BCKFSX                          WMKFSX
     I              BCKGSX                          WMKGSX
     I              BCKSSX                          WMKSSX
     I              BCKTSX                          WMKTSX
     I              BCKHSX                          WMKHSX
     I              BCKISX                          WMKISX
     I              BCKJSX                          WMKJSX
     I              BCEQNY                          WMEQNY
     I              BCVSST                          WMVSST
     I              BCMJDT                          WMMJDT
     I              BCBETM                          WMBETM
     I              BCCCVN                          WMCCVN
     I              BCCDVN                          WMCDVN
     I              BCMKDT                          WMMKDT
     I              BCBFTM                          WMBFTM
     I              BCCEVN                          WMCEVN
     I              BCCFVN                          WMCFVN
      *
     I@HSTPUX
      * Sales History             Load#/Order#
      * Renamed input format fields
     I              F4AIC3                          WOAIC3
     I              F4C4NB                          WOC4NB
     I              F4DPNB                          WODPNB
     I              F4UENB                          WOUENB
     I              F4MONA                          WOMONA
     I              F4RJCD                          WORJCD
     I              F4RKCD                          WORKCD
     I              F4GPTX                          WOGPTX
     I              F4ABTX                          WOABTX
     I              F4KXCD                          WOKXCD
     I              F4BOCD                          WOBOCD
     I              F4BTC7                          WOBTC7
     I              F4ANC7                          WOANC7
     I              F4AQTX                          WOAQTX
     I              F4BKC7                          WOBKC7
     I              F4BRTX                          WOBRTX
     I              F4HNNA                          WOHNNA
     I              F4DBCD                          WODBCD
     I              F4CKTX                          WOCKTX
     I              F4BCNA                          WOBCNA
     I              F4A0DT                          WOA0DT
     I              F4ACDT                          WOACDT
     I              F4R4CD                          WOR4CD
     I              F4R5CD                          WOR5CD
     I              F4BFCD                          WOBFCD
     I              F4Q4CD                          WOQ4CD
     I              F4AQCD                          WOAQCD
     I              F4TBNB                          WOTBNB
     I              F4BZNA                          WOBZNA
     I              F4RLCD                          WORLCD
     I              F4JNCD                          WOJNCD
     I              F4Q2CD                          WOQ2CD
     I              F4U2ST                          WOU2ST
     I              F4ATIN                          WOATIN
     I              F4T3NB                          WOT3NB
     I              F4RSRN                          WORSRN
     I              F4ORIT                          WOORIT
     I              F4AJCD                          WOAJCD
     I              F4AVQT                          WOAVQT
     I              F4D0WG                          WOD0WG
     I              F4CCQT                          WOCCQT
     I              F4AUWG                          WOAUWG
     I              F4AGCD                          WOAGCD
     I              F4AKPR                          WOAKPR
     I              F4AUPR                          WOAUPR
     I              F4CRCD                          WOCRCD
     I              F4A5DT                          WOA5DT
     I              F4AWDT                          WOAWDT
     I              F4HDDT                          WOHDDT
     I              F4AGCS                          WOAGCS
     I              F4AQCS                          WOAQCS
     I              F4AVWG                          WOAVWG
     I              F4AYVA                          WOAYVA
     I              F4AMST                          WOAMST
     I              F4ANST                          WOANST
     I              F4VAST                          WOVAST
     I              F4L6NB                          WOL6NB
     I              F4UMCD                          WOUMCD
     I              F4HCDT                          WOHCDT
     I              F4ESNB                          WOESNB
     I              F4ETNB                          WOETNB
     I              F4BZNB                          WOBZNB
     I              F4EXQT                          WOEXQT
     I              F4BYWG                          WOBYWG
     I              F4S5NB                          WOS5NB
     I              F4MAVA                          WOMAVA
     I              F4KDVA                          WOKDVA
     I              F4USVA                          WOUSVA
     I              F4UTVA                          WOUTVA
     I              F4A4WG                          WOA4WG
     I              F4CKNB                          WOCKNB
     I              F4BMST                          WOBMST
     I              F4R8NB                          WOR8NB
     I              F4RMCD                          WORMCD
     I              F4BZPR                          WOBZPR
     I              F4RDCD                          WORDCD
     I              F4Q7CD                          WOQ7CD
     I              F4EXDT                          WOEXDT
     I              F4LQCD                          WOLQCD
     I              F4HICD                          WOHICD
     I              F4RBCD                          WORBCD
     I              F4RGNB                          WORGNB
     I              F4RHNB                          WORHNB
     I              F4RINB                          WORINB
     I              F4R1NB                          WOR1NB
     I              F4CONB                          WOCONB
     I              F4CEST                          WOCEST
     I              F4GNDT                          WOGNDT
     I              F4RMNB                          WORMNB
     I              F4AODT                          WOAODT
     I              F4LLCD                          WOLLCD
     I              F4LMCD                          WOLMCD
     I              F4SKNB                          WOSKNB
     I              F4SLNB                          WOSLNB
     I              F4SMNB                          WOSMNB
     I              F4G7NA                          WOG7NA
     I              F4ONVA                          WOONVA
     I              F4N0CD                          WON0CD
     I              F4B4NB                          WOB4NB
     I              F4B5NB                          WOB5NB
     I              F4N1CD                          WON1CD
     I              F4GIDT                          WOGIDT
     I              F4Z1ST                          WOZ1ST
     I              F4ULVA                          WOULVA
     I              F4UNVA                          WOUNVA
     I              F4UOVA                          WOUOVA
     I              F4UPVA                          WOUPVA
     I              F4UQVA                          WOUQVA
     I              F4SDCD                          WOSDCD
     I              F4QZCD                          WOQZCD
     I              F4XWST                          WOXWST
     I              F4T9CD                          WOT9CD
     I              F4UBCD                          WOUBCD
     I              F4CFC7                          WOCFC7
     I              F4X1CD                          WOX1CD
     I              F4GASX                          WOGASX
     I              F4DUPR                          WODUPR
     I              F4B6VL                          WOB6VL
     I              F4IANX                          WOIANX
     I              F4IBNX                          WOIBNX
     I              F4RPCD                          WORPCD
     I              F4NYDT                          WONYDT
     I              F4BZTM                          WOBZTM
     I              F4Z4NB                          WOZ4NB
     I              F4XACD                          WOXACD
     I              F4OANA                          WOOANA
     I              F4OKTX                          WOOKTX
     I              F4K4TX                          WOK4TX
     I              F4NBBO                          WONBBO
     I              F4OCFR                          WOOCFR
     I              F4C0C7                          WOC0C7
     I              F4A1AA                          WOA1AA
     I              F4VEST                          WOVEST
     I              F4A5PR                          WOA5PR
     I              F4CDPR                          WOCDPR
     I              F4D0PR                          WOD0PR
     I              F4D0VL                          WOD0VL
     I              F4IRSX                          WOIRSX
     I              F4CEVL                          WOCEVL
     I              F4ISSX                          WOISSX
     I              F4ITSX                          WOITSX
     I              F4IUSX                          WOIUSX
     I              F4OHDT                          WOOHDT
     I              F4D9PR                          WOD9PR
     I              F4CFVL                          WOCFVL
     I              F4UVST                          WOUVST
     I              F4UWST                          WOUWST
     I              F4UXST                          WOUXST
     I              F4AATM                          WOAATM
     I              F4AYNA                          WOAYNA
     I              F4A0NA                          WOA0NA
     I              F4AXDT                          WOAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WRRMNB
     I              FLRUNB                          WRRUNB
     I              FLRVNB                          WRRVNB
     I              FLDQTX                          WRDQTX
     I              FLRWNB                          WRRWNB
     I              FLRXNB                          WRRXNB
     I              FLSQNB                          WRSQNB
     I              FLT0NB                          WRT0NB
     I              FLT1NB                          WRT1NB
     I              FLR1NB                          WRR1NB
     I              FLAIC3                          WRAIC3
     I              FLC4NB                          WRC4NB
     I              FLVCST                          WRVCST
     I              FLKEDT                          WRKEDT
     I              FLSXNB                          WRSXNB
     I              FLKFDT                          WRKFDT
     I              FLACTM                          WRACTM
     I              FLK5TX                          WRK5TX
     I              FLW5CD                          WRW5CD
     I              FLEJDT                          WREJDT
     I              FLAGTM                          WRAGTM
     I              FLKJDT                          WRKJDT
     I              FLATTM                          WRATTM
     I              FLHDDT                          WRHDDT
     I              FLAUTM                          WRAUTM
     I              FLKKDT                          WRKKDT
     I              FLAVTM                          WRAVTM
     I              FLZ4NB                          WRZ4NB
     I              FLY7ST                          WRY7ST
     I              FLY2ST                          WRY2ST
     I              FLWHTX                          WRWHTX
     I              FLWITX                          WRWITX
     I              FLWJTX                          WRWJTX
     I              FLWKTX                          WRWKTX
     I              FLWLTX                          WRWLTX
     I              FLN7DT                          WRN7DT
     I              FLN8DT                          WRN8DT
     I              FLN9DT                          WRN9DT
     I              FLB3TM                          WRB3TM
     I              FLB4TM                          WRB4TM
     I              FLB5TM                          WRB5TM
     I              FLIASX                          WRIASX
     I              FLIBSX                          WRIBSX
     I              FLICSX                          WRICSX
     I              FLWVTX                          WRWVTX
     I              FLWWTX                          WRWWTX
     I              FLWXTX                          WRWXTX
     I              FLUVST                          WRUVST
     I              FLUWST                          WRUWST
     I              FLUXST                          WRUXST
     I              FLAATM                          WRAATM
     I              FLAYNA                          WRAYNA
     I              FLA0NA                          WRA0NA
     I              FLAXDT                          WRAXDT
      *
     I@FHSTD2
      * Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WSAIC3
     I              F4C4NB                          WSC4NB
     I              F4DPNB                          WSDPNB
     I              F4UENB                          WSUENB
     I              F4MONA                          WSMONA
     I              F4RJCD                          WSRJCD
     I              F4RKCD                          WSRKCD
     I              F4GPTX                          WSGPTX
     I              F4ABTX                          WSABTX
     I              F4KXCD                          WSKXCD
     I              F4BOCD                          WSBOCD
     I              F4BTC7                          WSBTC7
     I              F4ANC7                          WSANC7
     I              F4AQTX                          WSAQTX
     I              F4BKC7                          WSBKC7
     I              F4BRTX                          WSBRTX
     I              F4HNNA                          WSHNNA
     I              F4DBCD                          WSDBCD
     I              F4CKTX                          WSCKTX
     I              F4BCNA                          WSBCNA
     I              F4A0DT                          WSA0DT
     I              F4ACDT                          WSACDT
     I              F4R4CD                          WSR4CD
     I              F4R5CD                          WSR5CD
     I              F4BFCD                          WSBFCD
     I              F4Q4CD                          WSQ4CD
     I              F4AQCD                          WSAQCD
     I              F4TBNB                          WSTBNB
     I              F4BZNA                          WSBZNA
     I              F4RLCD                          WSRLCD
     I              F4JNCD                          WSJNCD
     I              F4Q2CD                          WSQ2CD
     I              F4U2ST                          WSU2ST
     I              F4ATIN                          WSATIN
     I              F4T3NB                          WST3NB
     I              F4RSRN                          WSRSRN
     I              F4ORIT                          WSORIT
     I              F4AJCD                          WSAJCD
     I              F4AVQT                          WSAVQT
     I              F4D0WG                          WSD0WG
     I              F4CCQT                          WSCCQT
     I              F4AUWG                          WSAUWG
     I              F4AGCD                          WSAGCD
     I              F4AKPR                          WSAKPR
     I              F4AUPR                          WSAUPR
     I              F4CRCD                          WSCRCD
     I              F4A5DT                          WSA5DT
     I              F4AWDT                          WSAWDT
     I              F4HDDT                          WSHDDT
     I              F4AGCS                          WSAGCS
     I              F4AQCS                          WSAQCS
     I              F4AVWG                          WSAVWG
     I              F4AYVA                          WSAYVA
     I              F4AMST                          WSAMST
     I              F4ANST                          WSANST
     I              F4VAST                          WSVAST
     I              F4L6NB                          WSL6NB
     I              F4UMCD                          WSUMCD
     I              F4HCDT                          WSHCDT
     I              F4ESNB                          WSESNB
     I              F4ETNB                          WSETNB
     I              F4BZNB                          WSBZNB
     I              F4EXQT                          WSEXQT
     I              F4BYWG                          WSBYWG
     I              F4S5NB                          WSS5NB
     I              F4MAVA                          WSMAVA
     I              F4KDVA                          WSKDVA
     I              F4USVA                          WSUSVA
     I              F4UTVA                          WSUTVA
     I              F4A4WG                          WSA4WG
     I              F4CKNB                          WSCKNB
     I              F4BMST                          WSBMST
     I              F4R8NB                          WSR8NB
     I              F4RMCD                          WSRMCD
     I              F4BZPR                          WSBZPR
     I              F4RDCD                          WSRDCD
     I              F4Q7CD                          WSQ7CD
     I              F4EXDT                          WSEXDT
     I              F4LQCD                          WSLQCD
     I              F4HICD                          WSHICD
     I              F4RBCD                          WSRBCD
     I              F4RGNB                          WSRGNB
     I              F4RHNB                          WSRHNB
     I              F4RINB                          WSRINB
     I              F4R1NB                          WSR1NB
     I              F4CONB                          WSCONB
     I              F4CEST                          WSCEST
     I              F4GNDT                          WSGNDT
     I              F4RMNB                          WSRMNB
     I              F4AODT                          WSAODT
     I              F4LLCD                          WSLLCD
     I              F4LMCD                          WSLMCD
     I              F4SKNB                          WSSKNB
     I              F4SLNB                          WSSLNB
     I              F4SMNB                          WSSMNB
     I              F4G7NA                          WSG7NA
     I              F4ONVA                          WSONVA
     I              F4N0CD                          WSN0CD
     I              F4B4NB                          WSB4NB
     I              F4B5NB                          WSB5NB
     I              F4N1CD                          WSN1CD
     I              F4GIDT                          WSGIDT
     I              F4Z1ST                          WSZ1ST
     I              F4ULVA                          WSULVA
     I              F4UNVA                          WSUNVA
     I              F4UOVA                          WSUOVA
     I              F4UPVA                          WSUPVA
     I              F4UQVA                          WSUQVA
     I              F4SDCD                          WSSDCD
     I              F4QZCD                          WSQZCD
     I              F4XWST                          WSXWST
     I              F4T9CD                          WST9CD
     I              F4UBCD                          WSUBCD
     I              F4CFC7                          WSCFC7
     I              F4X1CD                          WSX1CD
     I              F4GASX                          WSGASX
     I              F4DUPR                          WSDUPR
     I              F4B6VL                          WSB6VL
     I              F4IANX                          WSIANX
     I              F4IBNX                          WSIBNX
     I              F4RPCD                          WSRPCD
     I              F4NYDT                          WSNYDT
     I              F4BZTM                          WSBZTM
     I              F4Z4NB                          WSZ4NB
     I              F4XACD                          WSXACD
     I              F4OANA                          WSOANA
     I              F4OKTX                          WSOKTX
     I              F4K4TX                          WSK4TX
     I              F4NBBO                          WSNBBO
     I              F4OCFR                          WSOCFR
     I              F4C0C7                          WSC0C7
     I              F4A1AA                          WSA1AA
     I              F4VEST                          WSVEST
     I              F4A5PR                          WSA5PR
     I              F4CDPR                          WSCDPR
     I              F4D0PR                          WSD0PR
     I              F4D0VL                          WSD0VL
     I              F4IRSX                          WSIRSX
     I              F4CEVL                          WSCEVL
     I              F4ISSX                          WSISSX
     I              F4ITSX                          WSITSX
     I              F4IUSX                          WSIUSX
     I              F4OHDT                          WSOHDT
     I              F4D9PR                          WSD9PR
     I              F4CFVL                          WSCFVL
     I              F4UVST                          WSUVST
     I              F4UWST                          WSUWST
     I              F4UXST                          WSUXST
     I              F4AATM                          WSAATM
     I              F4AYNA                          WSAYNA
     I              F4A0NA                          WSA0NA
     I              F4AXDT                          WSAXDT
      *
     I@D0CPTQ
      * Sales History EXT         Retrieval index
      * Renamed input format fields
     I              D0AIC3                          WTAIC3
     I              D0C4NB                          WTC4NB
     I              D0DPNB                          WTDPNB
     I              D0UENB                          WTUENB
     I              D0I7VL                          WTI7VL
     I              D0JXAA                          WTJXAA
     I              D0SHES                          WTSHES
     I              D0SHS1                          WTSHS1
     I              D0SHS2                          WTSHS2
     I              D0OVTX                          WTOVTX
     I              D0SADT                          WTSADT
     I              D0LMT1                          WTLMT1
     I              D0SBDT                          WTSBDT
     I              D0I9VL                          WTI9VL
     I              D0JAVL                          WTJAVL
     I              D0JBVL                          WTJBVL
     I              D0GIPR                          WTGIPR
     I              D0GJPR                          WTGJPR
     I              D0TCDT                          WTTCDT
     I              D0TDDT                          WTTDDT
     I              D0F9ST                          WTF9ST
     I              D0GAST                          WTGAST
     I              D0LXAA                          WTLXAA
     I              D0F5ST                          WTF5ST
     I              D0WET1                          WTWET1
     I              D0WFT1                          WTWFT1
     I              D0WGT1                          WTWGT1
     I              D0WHT1                          WTWHT1
     I              D0QRNY                          WTQRNY
     I              D0QSNY                          WTQSNY
     I              D0QNNY                          WTQNNY
     I              D0QONY                          WTQONY
     I              D0QPNY                          WTQPNY
     I              D0QQNY                          WTQQNY
     I              D0QTNY                          WTQTNY
     I              D0QUNY                          WTQUNY
     I              D0VSST                          WTVSST
     I              D0MJDT                          WTMJDT
     I              D0BETM                          WTBETM
     I              D0CCVN                          WTCCVN
     I              D0CDVN                          WTCDVN
     I              D0MKDT                          WTMKDT
     I              D0BFTM                          WTBFTM
     I              D0CEVN                          WTCEVN
     I              D0CFVN                          WTCFVN
      *
     I@D0CPTP
      * Sales History EXT         Update index
      * Renamed input format fields
     I              D0AIC3                          WVAIC3
     I              D0C4NB                          WVC4NB
     I              D0DPNB                          WVDPNB
     I              D0UENB                          WVUENB
     I              D0I7VL                          WVI7VL
     I              D0JXAA                          WVJXAA
     I              D0SHES                          WVSHES
     I              D0SHS1                          WVSHS1
     I              D0SHS2                          WVSHS2
     I              D0OVTX                          WVOVTX
     I              D0SADT                          WVSADT
     I              D0LMT1                          WVLMT1
     I              D0SBDT                          WVSBDT
     I              D0I9VL                          WVI9VL
     I              D0JAVL                          WVJAVL
     I              D0JBVL                          WVJBVL
     I              D0GIPR                          WVGIPR
     I              D0GJPR                          WVGJPR
     I              D0TCDT                          WVTCDT
     I              D0TDDT                          WVTDDT
     I              D0F9ST                          WVF9ST
     I              D0GAST                          WVGAST
     I              D0LXAA                          WVLXAA
     I              D0F5ST                          WVF5ST
     I              D0WET1                          WVWET1
     I              D0WFT1                          WVWFT1
     I              D0WGT1                          WVWGT1
     I              D0WHT1                          WVWHT1
     I              D0QRNY                          WVQRNY
     I              D0QSNY                          WVQSNY
     I              D0QNNY                          WVQNNY
     I              D0QONY                          WVQONY
     I              D0QPNY                          WVQPNY
     I              D0QQNY                          WVQQNY
     I              D0QTNY                          WVQTNY
     I              D0QUNY                          WVQUNY
     I              D0VSST                          WVVSST
     I              D0MJDT                          WVMJDT
     I              D0BETM                          WVBETM
     I              D0CCVN                          WVCCVN
     I              D0CDVN                          WVCDVN
     I              D0MKDT                          WVMKDT
     I              D0BFTM                          WVBFTM
     I              D0CEVN                          WVCEVN
     I              D0CFVN                          WVCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            779
     IYCRDCS      DS                            779
     IYDRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IYERDCS      DS                            779
     IQOMHS1    E DSOMHSTPL0
      * UPD : Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WSAIC3
     I              F4C4NB                          WSC4NB
     I              F4DPNB                          WSDPNB
     I              F4UENB                          WSUENB
     I              F4MONA                          WSMONA
     I              F4RJCD                          WSRJCD
     I              F4RKCD                          WSRKCD
     I              F4GPTX                          WSGPTX
     I              F4ABTX                          WSABTX
     I              F4KXCD                          WSKXCD
     I              F4BOCD                          WSBOCD
     I              F4BTC7                          WSBTC7
     I              F4ANC7                          WSANC7
     I              F4AQTX                          WSAQTX
     I              F4BKC7                          WSBKC7
     I              F4BRTX                          WSBRTX
     I              F4HNNA                          WSHNNA
     I              F4DBCD                          WSDBCD
     I              F4CKTX                          WSCKTX
     I              F4BCNA                          WSBCNA
     I              F4A0DT                          WSA0DT
     I              F4ACDT                          WSACDT
     I              F4R4CD                          WSR4CD
     I              F4R5CD                          WSR5CD
     I              F4BFCD                          WSBFCD
     I              F4Q4CD                          WSQ4CD
     I              F4AQCD                          WSAQCD
     I              F4TBNB                          WSTBNB
     I              F4BZNA                          WSBZNA
     I              F4RLCD                          WSRLCD
     I              F4JNCD                          WSJNCD
     I              F4Q2CD                          WSQ2CD
     I              F4U2ST                          WSU2ST
     I              F4ATIN                          WSATIN
     I              F4T3NB                          WST3NB
     I              F4RSRN                          WSRSRN
     I              F4ORIT                          WSORIT
     I              F4AJCD                          WSAJCD
     I              F4AVQT                          WSAVQT
     I              F4D0WG                          WSD0WG
     I              F4CCQT                          WSCCQT
     I              F4AUWG                          WSAUWG
     I              F4AGCD                          WSAGCD
     I              F4AKPR                          WSAKPR
     I              F4AUPR                          WSAUPR
     I              F4CRCD                          WSCRCD
     I              F4A5DT                          WSA5DT
     I              F4AWDT                          WSAWDT
     I              F4HDDT                          WSHDDT
     I              F4AGCS                          WSAGCS
     I              F4AQCS                          WSAQCS
     I              F4AVWG                          WSAVWG
     I              F4AYVA                          WSAYVA
     I              F4AMST                          WSAMST
     I              F4ANST                          WSANST
     I              F4VAST                          WSVAST
     I              F4L6NB                          WSL6NB
     I              F4UMCD                          WSUMCD
     I              F4HCDT                          WSHCDT
     I              F4ESNB                          WSESNB
     I              F4ETNB                          WSETNB
     I              F4BZNB                          WSBZNB
     I              F4EXQT                          WSEXQT
     I              F4BYWG                          WSBYWG
     I              F4S5NB                          WSS5NB
     I              F4MAVA                          WSMAVA
     I              F4KDVA                          WSKDVA
     I              F4USVA                          WSUSVA
     I              F4UTVA                          WSUTVA
     I              F4A4WG                          WSA4WG
     I              F4CKNB                          WSCKNB
     I              F4BMST                          WSBMST
     I              F4R8NB                          WSR8NB
     I              F4RMCD                          WSRMCD
     I              F4BZPR                          WSBZPR
     I              F4RDCD                          WSRDCD
     I              F4Q7CD                          WSQ7CD
     I              F4EXDT                          WSEXDT
     I              F4LQCD                          WSLQCD
     I              F4HICD                          WSHICD
     I              F4RBCD                          WSRBCD
     I              F4RGNB                          WSRGNB
     I              F4RHNB                          WSRHNB
     I              F4RINB                          WSRINB
     I              F4R1NB                          WSR1NB
     I              F4CONB                          WSCONB
     I              F4CEST                          WSCEST
     I              F4GNDT                          WSGNDT
     I              F4RMNB                          WSRMNB
     I              F4AODT                          WSAODT
     I              F4LLCD                          WSLLCD
     I              F4LMCD                          WSLMCD
     I              F4SKNB                          WSSKNB
     I              F4SLNB                          WSSLNB
     I              F4SMNB                          WSSMNB
     I              F4G7NA                          WSG7NA
     I              F4ONVA                          WSONVA
     I              F4N0CD                          WSN0CD
     I              F4B4NB                          WSB4NB
     I              F4B5NB                          WSB5NB
     I              F4N1CD                          WSN1CD
     I              F4GIDT                          WSGIDT
     I              F4Z1ST                          WSZ1ST
     I              F4ULVA                          WSULVA
     I              F4UNVA                          WSUNVA
     I              F4UOVA                          WSUOVA
     I              F4UPVA                          WSUPVA
     I              F4UQVA                          WSUQVA
     I              F4SDCD                          WSSDCD
     I              F4QZCD                          WSQZCD
     I              F4XWST                          WSXWST
     I              F4T9CD                          WST9CD
     I              F4UBCD                          WSUBCD
     I              F4CFC7                          WSCFC7
     I              F4X1CD                          WSX1CD
     I              F4GASX                          WSGASX
     I              F4DUPR                          WSDUPR
     I              F4B6VL                          WSB6VL
     I              F4IANX                          WSIANX
     I              F4IBNX                          WSIBNX
     I              F4RPCD                          WSRPCD
     I              F4NYDT                          WSNYDT
     I              F4BZTM                          WSBZTM
     I              F4Z4NB                          WSZ4NB
     I              F4XACD                          WSXACD
     I              F4OANA                          WSOANA
     I              F4OKTX                          WSOKTX
     I              F4K4TX                          WSK4TX
     I              F4NBBO                          WSNBBO
     I              F4OCFR                          WSOCFR
     I              F4C0C7                          WSC0C7
     I              F4A1AA                          WSA1AA
     I              F4VEST                          WSVEST
     I              F4A5PR                          WSA5PR
     I              F4CDPR                          WSCDPR
     I              F4D0PR                          WSD0PR
     I              F4D0VL                          WSD0VL
     I              F4IRSX                          WSIRSX
     I              F4CEVL                          WSCEVL
     I              F4ISSX                          WSISSX
     I              F4ITSX                          WSITSX
     I              F4IUSX                          WSIUSX
     I              F4OHDT                          WSOHDT
     I              F4D9PR                          WSD9PR
     I              F4CFVL                          WSCFVL
     I              F4UVST                          WSUVST
     I              F4UWST                          WSUWST
     I              F4UXST                          WSUXST
     I              F4AATM                          WSAATM
     I              F4AYNA                          WSAYNA
     I              F4A0NA                          WSA0NA
     I              F4AXDT                          WSAXDT
      *
     IYFRDCS      DS                            792
     IQPMD01    E DSPMD0CPL0
      * UPD : Sales History EXT         Update index
      * Renamed input format fields
     I              D0AIC3                          WVAIC3
     I              D0C4NB                          WVC4NB
     I              D0DPNB                          WVDPNB
     I              D0UENB                          WVUENB
     I              D0I7VL                          WVI7VL
     I              D0JXAA                          WVJXAA
     I              D0SHES                          WVSHES
     I              D0SHS1                          WVSHS1
     I              D0SHS2                          WVSHS2
     I              D0OVTX                          WVOVTX
     I              D0SADT                          WVSADT
     I              D0LMT1                          WVLMT1
     I              D0SBDT                          WVSBDT
     I              D0I9VL                          WVI9VL
     I              D0JAVL                          WVJAVL
     I              D0JBVL                          WVJBVL
     I              D0GIPR                          WVGIPR
     I              D0GJPR                          WVGJPR
     I              D0TCDT                          WVTCDT
     I              D0TDDT                          WVTDDT
     I              D0F9ST                          WVF9ST
     I              D0GAST                          WVGAST
     I              D0LXAA                          WVLXAA
     I              D0F5ST                          WVF5ST
     I              D0WET1                          WVWET1
     I              D0WFT1                          WVWFT1
     I              D0WGT1                          WVWGT1
     I              D0WHT1                          WVWHT1
     I              D0QRNY                          WVQRNY
     I              D0QSNY                          WVQSNY
     I              D0QNNY                          WVQNNY
     I              D0QONY                          WVQONY
     I              D0QPNY                          WVQPNY
     I              D0QQNY                          WVQQNY
     I              D0QTNY                          WVQTNY
     I              D0QUNY                          WVQUNY
     I              D0VSST                          WVVSST
     I              D0MJDT                          WVMJDT
     I              D0BETM                          WVBETM
     I              D0CCVN                          WVCCVN
     I              D0CDVN                          WVCDVN
     I              D0MKDT                          WVMKDT
     I              D0BFTM                          WVBFTM
     I              D0CEVN                          WVCEVN
     I              D0CFVN                          WVCFVN
      *
     IYGRDCS      DS                            314
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I : RST Load ID
     I                                    P   1   40P1RMNB
      * I :  Flat Amount
     I                                    P   5  102P1FLAM
      * I :  Load Total Freight
     I                                    P  11  162P1OCFR
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1FLAM    PARM           WP0002 112       Flat Amount
     C           P1OCFR    PARM           WP0003 112       Load Total Frei
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Alloc Frt to Hist  XF
      * UPD Alloc Frt to Hist  IF
     C                     Z-ADDP1FLAM    YL0001           Total Freight U
     C                     Z-ADDP1OCFR    YL0002           Load Total Frei
     C                     Z-ADD0         YL0003           Total Amount
     C                     Z-ADD0         YL0004           USR Percent Wor
     C                     Z-ADD*ZERO     YL0005           USR Work Percen
     C                     Z-ADD*ZERO     YL0006           Reference Req F
     C                     Z-ADD*ZERO     WUBMNB           Total Weight Wo
      *
     C                     MOVEL*BLANK    WN0001  1        Status Flag 1
     C                     Z-ADD*ZERO     WN0002 130       Total Weight Wo
     C                     Z-ADD*ZERO     WN0003  96       USR Work Percen
      *
      * Upd Ref Act Frt Amt   IF
      * Upd Ref Act Frt Amt   RT - Load Freight Charge  * 
     C                     EXSR SARVGN
     C           YL0001    SUB  YL0007    WUEKNY           Bal Act Freight
     C           YL0002    SUB  YL0008    YL0048           Bal Load Total
      * ** Determine the allocation % to use to distribute balance of fre
      * ** Calculate Total Pound Miles for this load
      * R8827 JJH 01/23/17 - Calc Load Frt Chrg with Special Type=E
      * Upd Ref Act Frt Even  IF
      * Calc the Total Amount of LFC Charge Amt with Special Type = E
      * Rtv Ref Act Frt Even  RT - Load Freight Charge  * 
     C                     EXSR SURVGN
     C                     Z-ADDYL0050    YL0049           LFC Spc Typ=E A
      * CASE: LCL.LFC Spc Typ=E Amt USR is Not Entered
     C           YL0050    IFEQ 0                          *IF
      * No action if there are no Load Freight Charge Special Type=E
     C                     ELSE
      * CASE: *OTHERWISE
      * Get Total Stops from Load Header
      * Rtv Total Stops       RT - Load Header  * 
     C                     EXSR SVRVGN
      * Calc LFC Special Type=E Amt to be applied to each Stop
     C           YL0050    DIV  YL0052    YL0053           LFC Spc Typ=E A
     C                     MVR            YL0054           LFC Spc Typ=E A
      * Add Remaining cents so that it will be applied to the First Stop
     C           YL0053    ADD  YL0054    YL0055           LFC Spc Typ=E A
      * Calc and update LFC Special Type=E Amt to be applied to each Orde
      * Upd Ref Act Frt Even  RT - Load Detail  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C                     SUB  YL0049    WUEKNY           Bal Act Freight
     C                     SUB  YL0049    YL0048           Bal Load Total
      * R8827 JJH 01/18/17 - Modify calculation of Incremental Miles USR
      * CLC Total Lbs-Miles    RT - Load Detail  * 
     C                     EXSR TBRVGN
      * ** Calculate the Order Allocation % and use to distribute freight
      * ** and update each order on the Order Header
      * R8827 JJH 01/18/17 - Modify calculation of Incremental Miles USR
      * CLC UPD Order Alloc %  RT - Load Detail  * 
     C                     EXSR TDRVGN
      * ** Update the Sales History Detail with Actual Freight Amount
      *  make sure order is on this load and not an old one  12.7.16
      * UPD/Alloc Act Freight  RT - Sales History  * 
     C                     EXSR TGRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Upd Ref Act Frt Amt   RT - Load Freight Charge  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  96       USR Work Percen
     C                     MOVEL*BLANK    WN0005  1        Status Flag 1
     C                     Z-ADD*ZERO     WN0006 130       Total Weight Wo
     C                     MOVEL*BLANK    WN0007  6        CR Reference Co
     C                     MOVEL*BLANK    WN0008  1        LFCR Value Type
     C                     Z-ADD*ZERO     WN0009 155       LFCR Numeric Va
     C                     MOVEL*BLANK    WN0010 40        LFCR Alpha Valu
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Upd Init Ld Ref Amt   RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSA01           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSA01           Load ID
      * Establish starting position
     C           KRSSA     SETLL@BCCPJ8                    *
     C           KRSSA     READE@BCCPJ8                  90*
      * Data record not found
     C   90                MOVEL'USR3058' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * R8827 JJH 01/25/17 - Add additional condition LFC Special Type
      *   NE E=Evenly by Stop
      * CASE:
      *  - c1 AND NOT c2
      *   |- c1    : DB1.LFC Reference Required is Yes
      *   |- c2    : DB1.LFC Special Type is Evenly by Stop
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAKISX    IFEQ 'Y'                        *IF
     C           WAKTSX    IFEQ 'E'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Charge Reference  RT - Load Freight Charge Ref  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0001           Load ID
     C                     MOVELWACDAA    WL0002    P      FC Code
     C                     Z-ADDWAEPNY    WL0003           LFC Sequence Nu
     C                     MOVELWN0010    WL0007    P      LFCR Alpha Valu
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WN0007    P      CR Reference Co
     C                     MOVELWL0005    WN0008    P      LFCR Value Type
     C                     Z-ADDWL0006    WN0009           LFCR Numeric Va
     C                     MOVELWL0007    WN0010    P      LFCR Alpha Valu
      * If Reference Type of Charge Allocation found
      * CASE: PAR.CR Reference Code is Not Blanks
     C           WN0007    IFNE *BLANK                     *IF
      * UPD: Order Freight Reference Amount
      * CASE: PAR.CR Reference Code is Ship To
     C           WN0007    IFEQ @CN,001                    *IF
      * CVT: Ship To Customer
      * CASE: PAR.LFCR Value Type is Numeric Value Type
     C           WN0008    IFEQ 'N'                        *IF
     C                     Z-ADDWN0009    YL0010           Ship To Custome
     C                     ELSE
      * CASE: PAR.LFCR Value Type is Alpha Value Type
     C           WN0008    IFEQ 'A'                        *IF
     C                     MOVELWN0010    YL0011           USR Text 7
     C                     MOVE YL0011    YL0010           Ship To Custome
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Ld/ShipTo  OrdWgt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0008           Load ID
     C                     Z-ADDYL0010    WL0009           Ship To Custome
     C                     Z-ADDWN0006    WL0010           Total Weight Wo
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    WN0006           Total Weight Wo
      * Upd Ld/ShipTo  RefAmt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0011           Load ID
     C                     Z-ADDYL0010    WL0012           Ship To Custome
     C                     Z-ADDWN0006    WL0013           Total Weight Wo
     C                     Z-ADDWAC5VL    WL0014           LFC Amount
     C                     MOVELWAKBSX    WL0015    P      LFC Act Frt Inc
     C                     MOVELWAKSSX    WL0016    P      LFC Tot Freight
     C                     EXSR SFRVGN
     C                     ELSE
      * CASE: PAR.CR Reference Code is State
     C           WN0007    IFEQ 'STATE'                    *IF
     C                     MOVELWN0010    YL0017           Ship To State C
      * Rtv Ld/State Ord Wgt  RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0023           Load ID
     C                     MOVELYL0017    WL0024    P      Ship To State C
     C                     Z-ADDWN0006    WL0025           Total Weight Wo
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0025    WN0006           Total Weight Wo
      * Upd Ld/State   RefAmt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0026           Load ID
     C                     MOVELYL0017    WL0027    P      Ship To State C
     C                     Z-ADDWN0006    WL0028           Total Weight Wo
     C                     Z-ADDWAC5VL    WL0029           LFC Amount
     C                     MOVELWAKBSX    WL0030    P      LFC Act Frt Inc
     C                     MOVELWAKSSX    WL0031    P      LFC Tot Freight
     C                     EXSR SJRVGN
     C                     ELSE
      * CASE: PAR.CR Reference Code is City-St
     C           WN0007    IFEQ @CN,002                    *IF
     C                     Z-ADD20        YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0010:ZQ YL0023    P  90  Ship To City
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD21        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0010:ZQ YL0017    P  90  Ship To State C
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Ld/St/Cty  OrdWgt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0032           Load ID
     C                     MOVELYL0017    WL0033    P      Ship To State C
     C                     MOVELYL0023    WL0034    P      Ship To City
     C                     Z-ADDWN0006    WL0035           Total Weight Wo
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0035    WN0006           Total Weight Wo
      * Upd Ld/St/Cty  RefAmt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0036           Load ID
     C                     MOVELYL0017    WL0037    P      Ship To State C
     C                     MOVELYL0023    WL0038    P      Ship To City
     C                     Z-ADDWN0006    WL0039           Total Weight Wo
     C                     Z-ADDWAC5VL    WL0040           LFC Amount
     C                     MOVELWAKBSX    WL0041    P      LFC Act Frt Inc
     C                     MOVELWAKSSX    WL0042    P      LFC Tot Freight
     C                     EXSR SLRVGN
     C                     ELSE
      * CASE: PAR.CR Reference Code is Warehouse
     C           WN0007    IFEQ 'WHS'                      *IF
     C                     Z-ADD3         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0010:ZQ YL0029    P  90  Warehouse Code
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Rtv Ld/Whs     OrdWgt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0043           Load ID
     C                     MOVELYL0029    WL0044    P      Warehouse Code
     C                     Z-ADDWN0006    WL0045           Total Weight Wo
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0045    WN0006           Total Weight Wo
      * Upd Ld/WHS     RefAmt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0051           Load ID
     C                     MOVELYL0029    WL0052    P      Warehouse Code
     C                     Z-ADDWN0006    WL0053           Total Weight Wo
     C                     Z-ADDWAC5VL    WL0054           LFC Amount
     C                     MOVELWAKBSX    WL0055    P      LFC Act Frt Inc
     C                     MOVELWAKSSX    WL0056    P      LFC Tot Freight
     C                     EXSR SORVGN
     C                     ELSE
      * CASE: PAR.CR Reference Code is Drop Number
     C           WN0007    IFEQ 'DROP'                     *IF
      * CVT: Drop
      * CASE: PAR.LFCR Value Type is Numeric Value Type
     C           WN0008    IFEQ 'N'                        *IF
     C                     Z-ADDWN0009    YL0039           Stop/Drop
     C                     ELSE
      * CASE: PAR.LFCR Value Type is Alpha Value Type
     C           WN0008    IFEQ 'A'                        *IF
     C                     MOVELWN0010    YL0040           USR Work Field
     C                     MOVE YL0040    YL0039           Stop/Drop
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Ld/ShipTo  OrdWgt RT - Load Detail  * 
     C                     EXSR SPRVGN
      * Upd Ld/ShipTo  RefAmt RT - Load Detail  * 
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WAC5VL    YL0003           Total Amount
      * CASE: DB1.LFC Act Frt Include Sts is Yes
     C           WAKBSX    IFEQ 'Y'                        *IF
     C                     ADD  WAC5VL    YL0007           Act Frt Ref Amt
     C                     END                             *FI
      * CASE: DB1.LFC Tot Freight Inc Sts is Yes
     C           WAKSSX    IFEQ 'Y'                        *IF
     C                     ADD  WAC5VL    YL0008           Tot Frt Ref Amt
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@BCCPJ8                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Upd Init Ld Ref Amt   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSB01           Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSB01           Load ID
      * Establish starting position
     C           KRSSB     SETLL@BFCPR4                    *
     C           KRSSB     READE@BFCPR4                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Ord Init RefAmt   CH - Order Header TRG  * 
     C                     EXSR SCCHRC
     C           KRSSB     READE@BFCPR4                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Ord Init RefAmt   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0011  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0012  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0013  70       Ship To Custome
     C                     MOVEL*BLANK    WN0014 30        Ship To Name
     C                     MOVEL*BLANK    WN0015 30        Ship To Address
     C                     MOVEL*BLANK    WN0016 30        Ship To Address
     C                     MOVEL*BLANK    WN0017 30        Ship To Address
     C                     MOVEL*BLANK    WN0018 20        Ship To City
     C                     MOVEL*BLANK    WN0019  2        Ship To State C
     C                     MOVEL*BLANK    WN0020 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0021  70       Bill to Custome
     C                     MOVEL*BLANK    WN0022 30        Bill to Name
     C                     MOVEL*BLANK    WN0023 30        Bill to Address
     C                     MOVEL*BLANK    WN0024 30        Bill to Address
     C                     MOVEL*BLANK    WN0025 30        Bill to Address
     C                     MOVEL*BLANK    WN0026 20        Bill to City
     C                     MOVEL*BLANK    WN0027  2        Bill to State C
     C                     MOVEL*BLANK    WN0028 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0029 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0030  70       Order Date
     C                     Z-ADD*ZERO     WN0031  70       Requested Ship
     C                     Z-ADD*ZERO     WN0032  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0033  70       Cancel Date
     C                     MOVEL*BLANK    WN0034  2        Terms Code
     C                     MOVEL*BLANK    WN0035 40        Special Instruc
     C                     MOVEL*BLANK    WN0036 40        Special Instruc
     C                     MOVEL*BLANK    WN0037  3        Carrier Code
     C                     MOVEL*BLANK    WN0038  1        Comment Print A
     C                     MOVEL*BLANK    WN0039  1        Comment Print I
     C                     MOVEL*BLANK    WN0040  1        Comment Print P
     C                     MOVEL*BLANK    WN0041  1        Comment Print S
     C                     MOVEL*BLANK    WN0042  3        Reason Code
     C                     MOVEL*BLANK    WN0043  1        Order in Use
     C                     MOVEL*BLANK    WN0044  1        Header Status
     C                     MOVEL*BLANK    WN0045  1        Header Status L
     C                     MOVEL*BLANK    WN0046  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0047  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0048 10        User Original E
     C                     Z-ADD*ZERO     WN0049  70       Date of Origina
     C                     Z-ADD*ZERO     WN0050 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0051 112       Order Weight To
     C                     MOVEL*BLANK    WN0052  1        Credit Hold
     C                     MOVEL*BLANK    WN0053  1        Production Hold
     C                     MOVEL*BLANK    WN0054  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0055  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0056  40       Requested Deliv
     C                     MOVEL*BLANK    WN0057  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0058 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0059  70       Load ID
     C                     Z-ADD*ZERO     WN0060  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0061 112       Rated Freight
     C                     MOVEL*BLANK    WN0062  1        LTL Flag
     C                     MOVEL*BLANK    WN0063  1        Price Audit
     C                     MOVEL*BLANK    WN0064  1        Price Status
     C                     MOVEL*BLANK    WN0065  2        Shipping Method
     C                     MOVEL*BLANK    WN0066  1        Export Status
     C                     MOVEL*BLANK    WN0067  1        Palletize
     C                     MOVEL*BLANK    WN0068  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0069  1        Slip Sheet
     C                     MOVEL*BLANK    WN0070  1        Age Code
     C                     Z-ADD*ZERO     WN0071  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0072  1        Load Type
     C                     Z-ADD*ZERO     WN0073  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0074  1        Load Plan Order
     C                     MOVEL*BLANK    WN0075  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0076  70       Resell Referenc
     C                     MOVEL*BLANK    WN0077 30        Special Comment
     C                     MOVEL*BLANK    WN0078 30        Special Comment
     C                     MOVEL*BLANK    WN0079  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0080  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0081  2        Manager Level C
     C                     MOVEL*BLANK    WN0082  3        VP Level Code
     C                     Z-ADD*ZERO     WN0083  70       Attach to Order
     C                     MOVEL*BLANK    WN0084  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0085  70       Invoice Number
     C                     MOVEL*BLANK    WN0086  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0087  70       Invoice Date
     C                     MOVEL*BLANK    WN0088  2        Event Code
     C                     MOVEL*BLANK    WN0089  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0090  1        Modified Flag
     C                     Z-ADD*ZERO     WN0091 112       A/R order Value
     C                     MOVEL*BLANK    WN0092  1        Billing Activit
     C                     MOVEL*BLANK    WN0093  1        Block Order Fla
     C                     MOVEL*BLANK    WN0094  1        Order Certifica
     C                     Z-ADD*ZERO     WN0095 112       Invoice Order V
     C                     MOVEL*BLANK    WN0096  1        Process Sts for
     C                     MOVEL*BLANK    WN0097  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0098  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0099  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0100  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0101  1        Email Cust On O
     C                     MOVEL*BLANK    WN0102  1        Order Emailed
     C                     MOVEL*BLANK    WN0103  1        Export Docs Go
     C                     MOVEL*BLANK    WN0104  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0105  1        Broker Order St
     C                     MOVEL*BLANK    WN0106  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0107  2        Order Requires
     C                     MOVEL*BLANK    WN0108  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0109  2        Export USDA App
     C                     MOVEL*BLANK    WN0110  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0111  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0112  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0113  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0114  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0115  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0116  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0117  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0118  60       Time of Origina
     C                     Z-ADD*ZERO     WN0119  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0120  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0121  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0122 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0123 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0124 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0125  70       Claim Number
     C                     MOVEL*BLANK    WN0126  1        EDI Status 1
     C                     MOVEL*BLANK    WN0127  1        EDI Status 2
     C                     MOVEL*BLANK    WN0128  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0129  60       Job Time
     C                     MOVEL*BLANK    WN0130 10        User Id
     C                     MOVEL*BLANK    WN0131 10        Job Name
     C                     Z-ADD*ZERO     WN0132  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHSC    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Charge Reference  RT - Load Freight Charge Ref  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0009           Count USR
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           CR Reference Co
     C                     MOVEL*BLANK    WL0005           LFCR Value Type
     C                     Z-ADD*ZERO     WL0006           LFCR Numeric Va
     C                     MOVEL*BLANK    WL0007           LFCR Alpha Valu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSD01           Load ID
     C           *LIKE     DEFN WDCDAA    WQSD02           FC Code
     C           *LIKE     DEFN WDEPNY    WQSD03           LFC Sequence Nu
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Load ID
     C                     KFLD           WQSD02           FC Code
     C                     KFLD           WQSD03           LFC Sequence Nu
      * Setup key
     C                     Z-ADDWL0001    WQSD01           Load ID
     C                     MOVELWL0002    WQSD02           FC Code
     C                     Z-ADDWL0003    WQSD03           LFC Sequence Nu
      * Establish starting position
     C           KRSSD     SETLL@DKCPRF                    *
     C           KRSSD     READE@DKCPRF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3893' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           CR Reference Co
     C                     MOVEL*BLANK    WL0005           LFCR Value Type
     C                     Z-ADD*ZERO     WL0006           LFCR Numeric Va
     C                     MOVEL*BLANK    WL0007           LFCR Alpha Valu
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LFCR Reference Type is Charge Allocation
     C           WDAZST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWDIYAA    WL0004           CR Reference Co
     C                     MOVELWDKFTX    WL0005           LFCR Value Type
     C                     Z-ADDWDKBNY    WL0006           LFCR Numeric Va
     C                     MOVELWDNET1    WL0007           LFCR Alpha Valu
     C                     END                             *FI
     C           KRSSD     READE@DKCPRF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Ld/ShipTo  OrdWgt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0010           Total Weight Wo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSE01           Load ID
     C           *LIKE     DEFN WBBKC7    WQSE02           Ship To Custome
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Load ID
     C                     KFLD           WQSE02           Ship To Custome
      * Setup key
     C                     Z-ADDWL0008    WQSE01           Load ID
     C                     Z-ADDWL0009    WQSE02           Ship To Custome
      * Establish starting position
     C           KRSSE     SETLL@BFCPR4                    *
     C           KRSSE     READE@BFCPR4                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WBA1WG    WL0010           Total Weight Wo
     C           KRSSE     READE@BFCPR4                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Upd Ld/ShipTo  RefAmt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADDWL0014    YL0012           LFC Amount
      * * CALC: Freight Rate Per Pound
      * CASE: PAR.Total Weight Work is Not Zeros
     C           WL0013    IFNE 0                          *IF
     C           WL0014    DIV  WL0013    YL0013    H      Freight Rate US
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSF01           Load ID
     C           *LIKE     DEFN WBBKC7    WQSF02           Ship To Custome
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Load ID
     C                     KFLD           WQSF02           Ship To Custome
      * Setup key
     C                     Z-ADDWL0011    WQSF01           Load ID
     C                     Z-ADDWL0012    WQSF02           Ship To Custome
      * Establish starting position
     C           KRSSF     SETLL@BFCPR4                    *
     C           KRSSF     READE@BFCPR4                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * * CALC: Freight Amount for Order
     C           YL0013    MULT WBA1WG    YL0014    H      Freight Amount
      * UPD: Actual Freight Reference Amount
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0015    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WBH0NX    ADD  YL0014    YL0015           Act Frt Referen
      * * UPD: Update with New Reference Amount
      * Chg Ord ActFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0017           Company Number
     C                     Z-ADDWBC4NB    WL0018           Order Number
     C                     Z-ADDYL0015    WL0019           Act Frt Referen
     C                     EXSR SGCHRC
     C                     END                             *FI
      * UPD: Total Freight Reference Amount
      * CASE: PAR.LFC Tot Freight Inc Sts is Yes
     C           WL0016    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WBH4NX    ADD  YL0014    YL0016           OH Total Ref Fr
      * * UPD: Update with New Reference Amount
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0020           Company Number
     C                     Z-ADDWBC4NB    WL0021           Order Number
     C                     Z-ADDYL0016    WL0022           OH Total Ref Fr
     C                     EXSR SHCHRC
     C                     END                             *FI
      * * CALC: Remaining Amount to Allocate
     C                     SUB  YL0014    YL0012           LFC Amount
     C           KRSSF     READE@BFCPR4                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.LFC Amount is Entered
     C           YL0012    IFNE 0                          *IF
      * Adjust difference on last Order
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0015    IFEQ 'Y'                        *IF
     C                     ADD  YL0012    YL0015           Act Frt Referen
      * Chg Ord ActFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0017           Company Number
     C                     Z-ADDWBC4NB    WL0018           Order Number
     C                     Z-ADDYL0015    WL0019           Act Frt Referen
     C                     EXSR SGCHRC
     C                     END                             *FI
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0015    IFEQ 'Y'                        *IF
     C                     ADD  YL0012    YL0016           OH Total Ref Fr
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0020           Company Number
     C                     Z-ADDWBC4NB    WL0021           Order Number
     C                     Z-ADDYL0016    WL0022           OH Total Ref Fr
     C                     EXSR SHCHRC
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Ord ActFrt RefAmt CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0133  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0134  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0135  70       Ship To Custome
     C                     MOVEL*BLANK    WN0136 30        Ship To Name
     C                     MOVEL*BLANK    WN0137 30        Ship To Address
     C                     MOVEL*BLANK    WN0138 30        Ship To Address
     C                     MOVEL*BLANK    WN0139 30        Ship To Address
     C                     MOVEL*BLANK    WN0140 20        Ship To City
     C                     MOVEL*BLANK    WN0141  2        Ship To State C
     C                     MOVEL*BLANK    WN0142 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0143  70       Bill to Custome
     C                     MOVEL*BLANK    WN0144 30        Bill to Name
     C                     MOVEL*BLANK    WN0145 30        Bill to Address
     C                     MOVEL*BLANK    WN0146 30        Bill to Address
     C                     MOVEL*BLANK    WN0147 30        Bill to Address
     C                     MOVEL*BLANK    WN0148 20        Bill to City
     C                     MOVEL*BLANK    WN0149  2        Bill to State C
     C                     MOVEL*BLANK    WN0150 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0151 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0152  70       Order Date
     C                     Z-ADD*ZERO     WN0153  70       Requested Ship
     C                     Z-ADD*ZERO     WN0154  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0155  70       Cancel Date
     C                     MOVEL*BLANK    WN0156  2        Terms Code
     C                     MOVEL*BLANK    WN0157 40        Special Instruc
     C                     MOVEL*BLANK    WN0158 40        Special Instruc
     C                     MOVEL*BLANK    WN0159  3        Carrier Code
     C                     MOVEL*BLANK    WN0160  1        Comment Print A
     C                     MOVEL*BLANK    WN0161  1        Comment Print I
     C                     MOVEL*BLANK    WN0162  1        Comment Print P
     C                     MOVEL*BLANK    WN0163  1        Comment Print S
     C                     MOVEL*BLANK    WN0164  3        Reason Code
     C                     MOVEL*BLANK    WN0165  1        Order in Use
     C                     MOVEL*BLANK    WN0166  1        Header Status
     C                     MOVEL*BLANK    WN0167  1        Header Status L
     C                     MOVEL*BLANK    WN0168  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0169  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0170 10        User Original E
     C                     Z-ADD*ZERO     WN0171  70       Date of Origina
     C                     Z-ADD*ZERO     WN0172 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0173 112       Order Weight To
     C                     MOVEL*BLANK    WN0174  1        Credit Hold
     C                     MOVEL*BLANK    WN0175  1        Production Hold
     C                     MOVEL*BLANK    WN0176  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0177  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0178  40       Requested Deliv
     C                     MOVEL*BLANK    WN0179  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0180 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0181  70       Load ID
     C                     Z-ADD*ZERO     WN0182  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0183 112       Rated Freight
     C                     MOVEL*BLANK    WN0184  1        LTL Flag
     C                     MOVEL*BLANK    WN0185  1        Price Audit
     C                     MOVEL*BLANK    WN0186  1        Price Status
     C                     MOVEL*BLANK    WN0187  2        Shipping Method
     C                     MOVEL*BLANK    WN0188  1        Export Status
     C                     MOVEL*BLANK    WN0189  1        Palletize
     C                     MOVEL*BLANK    WN0190  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0191  1        Slip Sheet
     C                     MOVEL*BLANK    WN0192  1        Age Code
     C                     Z-ADD*ZERO     WN0193  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0194  1        Load Type
     C                     Z-ADD*ZERO     WN0195  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0196  1        Load Plan Order
     C                     MOVEL*BLANK    WN0197  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0198  70       Resell Referenc
     C                     MOVEL*BLANK    WN0199 30        Special Comment
     C                     MOVEL*BLANK    WN0200 30        Special Comment
     C                     MOVEL*BLANK    WN0201  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0202  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0203  2        Manager Level C
     C                     MOVEL*BLANK    WN0204  3        VP Level Code
     C                     Z-ADD*ZERO     WN0205  70       Attach to Order
     C                     MOVEL*BLANK    WN0206  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0207  70       Invoice Number
     C                     MOVEL*BLANK    WN0208  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0209  70       Invoice Date
     C                     MOVEL*BLANK    WN0210  2        Event Code
     C                     MOVEL*BLANK    WN0211  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0212  1        Modified Flag
     C                     Z-ADD*ZERO     WN0213 112       A/R order Value
     C                     MOVEL*BLANK    WN0214  1        Billing Activit
     C                     MOVEL*BLANK    WN0215  1        Block Order Fla
     C                     MOVEL*BLANK    WN0216  1        Order Certifica
     C                     Z-ADD*ZERO     WN0217 112       Invoice Order V
     C                     MOVEL*BLANK    WN0218  1        Process Sts for
     C                     MOVEL*BLANK    WN0219  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0220  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0221  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0222  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0223  1        Email Cust On O
     C                     MOVEL*BLANK    WN0224  1        Order Emailed
     C                     MOVEL*BLANK    WN0225  1        Export Docs Go
     C                     MOVEL*BLANK    WN0226  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0227  1        Broker Order St
     C                     MOVEL*BLANK    WN0228  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0229  2        Order Requires
     C                     MOVEL*BLANK    WN0230  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0231  2        Export USDA App
     C                     MOVEL*BLANK    WN0232  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0233  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0234  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0235  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0236  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0237  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0238  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0239  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0240  60       Time of Origina
     C                     Z-ADD*ZERO     WN0241  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0242  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0243  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0244 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0245 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0246 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0247 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0248  70       Claim Number
     C                     MOVEL*BLANK    WN0249  1        EDI Status 1
     C                     MOVEL*BLANK    WN0250  1        EDI Status 2
     C                     MOVEL*BLANK    WN0251  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0252  60       Job Time
     C                     MOVEL*BLANK    WN0253 10        User Id
     C                     MOVEL*BLANK    WN0254 10        Job Name
     C                     Z-ADD*ZERO     WN0255  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0017    WCAIC3           Company Number
     C                     Z-ADDWL0018    WCC4NB           Order Number
      *
     C           KLCHSG    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHSG    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YBRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0019    WCH0NX           Act Frt Referen
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0256  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0257  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0258  70       Ship To Custome
     C                     MOVEL*BLANK    WN0259 30        Ship To Name
     C                     MOVEL*BLANK    WN0260 30        Ship To Address
     C                     MOVEL*BLANK    WN0261 30        Ship To Address
     C                     MOVEL*BLANK    WN0262 30        Ship To Address
     C                     MOVEL*BLANK    WN0263 20        Ship To City
     C                     MOVEL*BLANK    WN0264  2        Ship To State C
     C                     MOVEL*BLANK    WN0265 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0266  70       Bill to Custome
     C                     MOVEL*BLANK    WN0267 30        Bill to Name
     C                     MOVEL*BLANK    WN0268 30        Bill to Address
     C                     MOVEL*BLANK    WN0269 30        Bill to Address
     C                     MOVEL*BLANK    WN0270 30        Bill to Address
     C                     MOVEL*BLANK    WN0271 20        Bill to City
     C                     MOVEL*BLANK    WN0272  2        Bill to State C
     C                     MOVEL*BLANK    WN0273 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0274 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0275  70       Order Date
     C                     Z-ADD*ZERO     WN0276  70       Requested Ship
     C                     Z-ADD*ZERO     WN0277  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0278  70       Cancel Date
     C                     MOVEL*BLANK    WN0279  2        Terms Code
     C                     MOVEL*BLANK    WN0280 40        Special Instruc
     C                     MOVEL*BLANK    WN0281 40        Special Instruc
     C                     MOVEL*BLANK    WN0282  3        Carrier Code
     C                     MOVEL*BLANK    WN0283  1        Comment Print A
     C                     MOVEL*BLANK    WN0284  1        Comment Print I
     C                     MOVEL*BLANK    WN0285  1        Comment Print P
     C                     MOVEL*BLANK    WN0286  1        Comment Print S
     C                     MOVEL*BLANK    WN0287  3        Reason Code
     C                     MOVEL*BLANK    WN0288  1        Order in Use
     C                     MOVEL*BLANK    WN0289  1        Header Status
     C                     MOVEL*BLANK    WN0290  1        Header Status L
     C                     MOVEL*BLANK    WN0291  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0292  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0293 10        User Original E
     C                     Z-ADD*ZERO     WN0294  70       Date of Origina
     C                     Z-ADD*ZERO     WN0295 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0296 112       Order Weight To
     C                     MOVEL*BLANK    WN0297  1        Credit Hold
     C                     MOVEL*BLANK    WN0298  1        Production Hold
     C                     MOVEL*BLANK    WN0299  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0300  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0301  40       Requested Deliv
     C                     MOVEL*BLANK    WN0302  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0303 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0304  70       Load ID
     C                     Z-ADD*ZERO     WN0305  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0306 112       Rated Freight
     C                     MOVEL*BLANK    WN0307  1        LTL Flag
     C                     MOVEL*BLANK    WN0308  1        Price Audit
     C                     MOVEL*BLANK    WN0309  1        Price Status
     C                     MOVEL*BLANK    WN0310  2        Shipping Method
     C                     MOVEL*BLANK    WN0311  1        Export Status
     C                     MOVEL*BLANK    WN0312  1        Palletize
     C                     MOVEL*BLANK    WN0313  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0314  1        Slip Sheet
     C                     MOVEL*BLANK    WN0315  1        Age Code
     C                     Z-ADD*ZERO     WN0316  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0317  1        Load Type
     C                     Z-ADD*ZERO     WN0318  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0319  1        Load Plan Order
     C                     MOVEL*BLANK    WN0320  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0321  70       Resell Referenc
     C                     MOVEL*BLANK    WN0322 30        Special Comment
     C                     MOVEL*BLANK    WN0323 30        Special Comment
     C                     MOVEL*BLANK    WN0324  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0325  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0326  2        Manager Level C
     C                     MOVEL*BLANK    WN0327  3        VP Level Code
     C                     Z-ADD*ZERO     WN0328  70       Attach to Order
     C                     MOVEL*BLANK    WN0329  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0330  70       Invoice Number
     C                     MOVEL*BLANK    WN0331  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0332  70       Invoice Date
     C                     MOVEL*BLANK    WN0333  2        Event Code
     C                     MOVEL*BLANK    WN0334  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0335  1        Modified Flag
     C                     Z-ADD*ZERO     WN0336 112       A/R order Value
     C                     MOVEL*BLANK    WN0337  1        Billing Activit
     C                     MOVEL*BLANK    WN0338  1        Block Order Fla
     C                     MOVEL*BLANK    WN0339  1        Order Certifica
     C                     Z-ADD*ZERO     WN0340 112       Invoice Order V
     C                     MOVEL*BLANK    WN0341  1        Process Sts for
     C                     MOVEL*BLANK    WN0342  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0343  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0344  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0345  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0346  1        Email Cust On O
     C                     MOVEL*BLANK    WN0347  1        Order Emailed
     C                     MOVEL*BLANK    WN0348  1        Export Docs Go
     C                     MOVEL*BLANK    WN0349  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0350  1        Broker Order St
     C                     MOVEL*BLANK    WN0351  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0352  2        Order Requires
     C                     MOVEL*BLANK    WN0353  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0354  2        Export USDA App
     C                     MOVEL*BLANK    WN0355  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0356  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0357  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0358  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0359  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0360  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0361  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0362  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0363  60       Time of Origina
     C                     Z-ADD*ZERO     WN0364  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0365  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0366  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0367 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0368 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0369 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0370 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0371  70       Claim Number
     C                     MOVEL*BLANK    WN0372  1        EDI Status 1
     C                     MOVEL*BLANK    WN0373  1        EDI Status 2
     C                     MOVEL*BLANK    WN0374  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0375  60       Job Time
     C                     MOVEL*BLANK    WN0376 10        User Id
     C                     MOVEL*BLANK    WN0377 10        Job Name
     C                     Z-ADD*ZERO     WN0378  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0020    WCAIC3           Company Number
     C                     Z-ADDWL0021    WCC4NB           Order Number
      *
     C           KLCHSH    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHSH    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0022    WCH4NX           OH Total Ref Fr
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Ld/State Ord Wgt  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0025           Total Weight Wo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSI02           Load ID
     C           *LIKE     DEFN WEDBCD    WQSI03           Ship To State C
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Load ID
     C                     KFLD           WQSI03           Ship To State C
      * Setup key
     C                     Z-ADDWL0023    WQSI02           Load ID
     C                     MOVELWL0024    WQSI03           Ship To State C
      * Establish starting position
     C           KRSSI     SETLL@BFCPKE                    *
     C           KRSSI     READE@BFCPKE                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WEA1WG    WL0025           Total Weight Wo
     C           KRSSI     READE@BFCPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Upd Ld/State   RefAmt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADDWL0029    YL0018           LFC Amount
      * * CALC: Freight Rate Per Pound
      * CASE: PAR.Total Weight Work is Not Zeros
     C           WL0028    IFNE 0                          *IF
     C           WL0029    DIV  WL0028    YL0019    H      Freight Rate US
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSJ02           Load ID
     C           *LIKE     DEFN WEDBCD    WQSJ03           Ship To State C
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ02           Load ID
     C                     KFLD           WQSJ03           Ship To State C
      * Setup key
     C                     Z-ADDWL0026    WQSJ02           Load ID
     C                     MOVELWL0027    WQSJ03           Ship To State C
      * Establish starting position
     C           KRSSJ     SETLL@BFCPKE                    *
     C           KRSSJ     READE@BFCPKE                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * * CALC: Freight Amount for Order
     C           YL0019    MULT WEA1WG    YL0020    H      Freight Amount
      * UPD: Actual Freight Reference Amount
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0030    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WEH0NX    ADD  YL0020    YL0021           Act Frt Referen
      * * UPD: Update with New Reference Amount
      * Chg Order Frt Ref Amt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0017           Company Number
     C                     Z-ADDWEC4NB    WL0018           Order Number
     C                     Z-ADDYL0021    WL0019           Act Frt Referen
     C                     EXSR SGCHRC
     C                     END                             *FI
      * UPD: Total Freight Reference Amount
      * CASE: PAR.LFC Tot Freight Inc Sts is Yes
     C           WL0031    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WEH4NX    ADD  YL0020    YL0022           OH Total Ref Fr
      * * UPD: Update with New Reference Amount
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0020           Company Number
     C                     Z-ADDWEC4NB    WL0021           Order Number
     C                     Z-ADDYL0022    WL0022           OH Total Ref Fr
     C                     EXSR SHCHRC
     C                     END                             *FI
      * * CALC: Remaining Amount to Allocate
     C                     SUB  YL0020    YL0018           LFC Amount
     C           KRSSJ     READE@BFCPKE                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.LFC Amount is Entered
     C           YL0018    IFNE 0                          *IF
      * Adjust difference on last Order
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0030    IFEQ 'Y'                        *IF
     C                     ADD  YL0018    YL0021           Act Frt Referen
      * Chg Order Frt Ref Amt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0017           Company Number
     C                     Z-ADDWEC4NB    WL0018           Order Number
     C                     Z-ADDYL0021    WL0019           Act Frt Referen
     C                     EXSR SGCHRC
     C                     END                             *FI
      * CASE: PAR.LFC Tot Freight Inc Sts is Yes
     C           WL0031    IFEQ 'Y'                        *IF
     C                     ADD  YL0018    YL0022           OH Total Ref Fr
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0020           Company Number
     C                     Z-ADDWEC4NB    WL0021           Order Number
     C                     Z-ADDYL0022    WL0022           OH Total Ref Fr
     C                     EXSR SHCHRC
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Ld/St/Cty  OrdWgt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0035           Total Weight Wo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSK02           Load ID
     C           *LIKE     DEFN WEDBCD    WQSK03           Ship To State C
     C           *LIKE     DEFN WEHNNA    WQSK04           Ship To City
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK02           Load ID
     C                     KFLD           WQSK03           Ship To State C
     C                     KFLD           WQSK04           Ship To City
      * Setup key
     C                     Z-ADDWL0032    WQSK02           Load ID
     C                     MOVELWL0033    WQSK03           Ship To State C
     C                     MOVELWL0034    WQSK04           Ship To City
      * Establish starting position
     C           KRSSK     SETLL@BFCPKE                    *
     C           KRSSK     READE@BFCPKE                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WEA1WG    WL0035           Total Weight Wo
     C           KRSSK     READE@BFCPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Upd Ld/St/Cty  RefAmt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADDWL0040    YL0024           LFC Amount
      * * CALC: Freight Rate Per Pound
      * CASE: PAR.Total Weight Work is Not Zeros
     C           WL0039    IFNE 0                          *IF
     C           WL0040    DIV  WL0039    YL0025    H      Freight Rate US
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSL02           Load ID
     C           *LIKE     DEFN WEDBCD    WQSL03           Ship To State C
     C           *LIKE     DEFN WEHNNA    WQSL04           Ship To City
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
     C                     KFLD           WQSL03           Ship To State C
     C                     KFLD           WQSL04           Ship To City
      * Setup key
     C                     Z-ADDWL0036    WQSL02           Load ID
     C                     MOVELWL0037    WQSL03           Ship To State C
     C                     MOVELWL0038    WQSL04           Ship To City
      * Establish starting position
     C           KRSSL     SETLL@BFCPKE                    *
     C           KRSSL     READE@BFCPKE                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * * CALC: Freight Amount for Order
     C           YL0025    MULT WEA1WG    YL0026    H      Freight Amount
      * UPD: Actual Freight Reference Amount
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0041    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WEH0NX    ADD  YL0026    YL0027           Act Frt Referen
      * * UPD: Update with New Reference Amount
      * Chg Order Frt Ref Amt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0017           Company Number
     C                     Z-ADDWEC4NB    WL0018           Order Number
     C                     Z-ADDYL0027    WL0019           Act Frt Referen
     C                     EXSR SGCHRC
     C                     END                             *FI
      * UPD: Total Freight Reference Amount
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0041    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WEH4NX    ADD  YL0026    YL0028           OH Total Ref Fr
      * * UPD: Update with New Reference Amount
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0020           Company Number
     C                     Z-ADDWEC4NB    WL0021           Order Number
     C                     Z-ADDYL0028    WL0022           OH Total Ref Fr
     C                     EXSR SHCHRC
     C                     END                             *FI
      * * CALC: Remaining Amount to Allocate
     C                     SUB  YL0026    YL0024           LFC Amount
     C           KRSSL     READE@BFCPKE                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.LFC Amount is Entered
     C           YL0024    IFNE 0                          *IF
      * Adjust difference on last Order
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0041    IFEQ 'Y'                        *IF
     C                     ADD  YL0024    YL0027           Act Frt Referen
      * Chg Order Frt Ref Amt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0017           Company Number
     C                     Z-ADDWEC4NB    WL0018           Order Number
     C                     Z-ADDYL0027    WL0019           Act Frt Referen
     C                     EXSR SGCHRC
     C                     END                             *FI
      * CASE: PAR.LFC Tot Freight Inc Sts is Yes
     C           WL0042    IFEQ 'Y'                        *IF
     C                     ADD  YL0024    YL0028           OH Total Ref Fr
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0020           Company Number
     C                     Z-ADDWEC4NB    WL0021           Order Number
     C                     Z-ADDYL0028    WL0022           OH Total Ref Fr
     C                     EXSR SHCHRC
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Ld/Whs     OrdWgt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0045           Total Weight Wo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSM01           Load ID
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Load ID
      * Setup key
     C                     Z-ADDWL0043    WQSM01           Load ID
      * Establish starting position
     C           KRSSM     SETLL@BFCPR4                    *
     C           KRSSM     READE@BFCPR4                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0046           Company Number
     C                     Z-ADDWBC4NB    WL0047           Order Number
     C                     Z-ADD*ZERO     WL0048           Order Sequence
     C                     Z-ADD*ZERO     WL0049           Order Secondary
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YL0030    P      Warehouse Code
      * CASE: LCL.Warehouse Code EQ PAR.Warehouse Code
     C           YL0030    IFEQ WL0044                     *IF
     C                     ADD  WBA1WG    WL0045           Total Weight Wo
     C                     END                             *FI
     C           KRSSM     READE@BFCPR4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSN02           Order Number
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
      * Setup key
     C                     Z-ADDWL0046    WQSN01           Company Number
     C                     Z-ADDWL0047    WQSN02           Order Number
     C                     Z-ADDWL0048    WFDPNB           Order Sequence
     C                     Z-ADDWL0049    WFUENB           Order Secondary
      * Establish starting position
     C           KPSSN     SETLL@BGWKL1                    *
     C           KRSSN     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0050           Warehouse Code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWFAJCD    WL0050           Warehouse Code
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSN     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Ld/WHS     RefAmt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADDWL0054    YL0031           LFC Amount
      * * CALC: Freight Rate Per Pound
      * CASE: PAR.Total Weight Work is Not Zeros
     C           WL0053    IFNE 0                          *IF
     C           WL0054    DIV  WL0053    YL0032    H      Freight Rate US
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSO01           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Load ID
      * Setup key
     C                     Z-ADDWL0051    WQSO01           Load ID
      * Establish starting position
     C           KRSSO     SETLL@BFCPR4                    *
     C           KRSSO     READE@BFCPR4                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0046           Company Number
     C                     Z-ADDWBC4NB    WL0047           Order Number
     C                     Z-ADD*ZERO     WL0048           Order Sequence
     C                     Z-ADD*ZERO     WL0049           Order Secondary
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0050    YL0033    P      Warehouse Code
      * CASE: LCL.Warehouse Code EQ PAR.Warehouse Code
     C           YL0033    IFEQ WL0052                     *IF
      * * CALC: Freight Amount for Order
     C           YL0032    MULT WBA1WG    YL0034    H      Freight Amount
      * UPD: Actual Freight Reference Amount
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0055    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WBH0NX    ADD  YL0034    YL0035           Act Frt Referen
      * * UPD: Update with New Reference Amount
      * Chg Order Frt Ref Amt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0017           Company Number
     C                     Z-ADDWBC4NB    WL0018           Order Number
     C                     Z-ADDYL0035    WL0019           Act Frt Referen
     C                     EXSR SGCHRC
     C                     END                             *FI
      * UPD: Total Freight Reference Amount
      * CASE: PAR.LFC Tot Freight Inc Sts is Yes
     C           WL0056    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WBH4NX    ADD  YL0034    YL0036           OH Total Ref Fr
      * * UPD: Update with New Reference Amount
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0020           Company Number
     C                     Z-ADDWBC4NB    WL0021           Order Number
     C                     Z-ADDYL0036    WL0022           OH Total Ref Fr
     C                     EXSR SHCHRC
     C                     END                             *FI
      * * CALC: Remaining Amount to Allocate
     C                     SUB  YL0034    YL0031           LFC Amount
      * * SAVE: Last Order with the Warehouse Code for Exit Processing
     C                     Z-ADDWBAIC3    YL0037           Company Number
     C                     Z-ADDWBC4NB    YL0038           Order Number
     C                     END                             *FI
     C           KRSSO     READE@BFCPR4                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.LFC Amount is Entered
     C           YL0031    IFNE 0                          *IF
      * Adjust difference on last Order
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0055    IFEQ 'Y'                        *IF
     C                     ADD  YL0031    YL0035           Act Frt Referen
      * Chg Ord ActFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0037    WL0017           Company Number
     C                     Z-ADDYL0038    WL0018           Order Number
     C                     Z-ADDYL0035    WL0019           Act Frt Referen
     C                     EXSR SGCHRC
     C                     END                             *FI
      * CASE: PAR.LFC Tot Freight Inc Sts is Yes
     C           WL0056    IFEQ 'Y'                        *IF
     C                     ADD  YL0031    YL0036           OH Total Ref Fr
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0037    WL0020           Company Number
     C                     Z-ADDYL0038    WL0021           Order Number
     C                     Z-ADDYL0036    WL0022           OH Total Ref Fr
     C                     EXSR SHCHRC
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Ld/ShipTo  OrdWgt RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0006           Total Weight Wo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSP02           Load ID
     C           *LIKE     DEFN WGRVNB    WQSP03           Stop/Drop
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP02           Load ID
     C                     KFLD           WQSP03           Stop/Drop
      * Setup key
     C                     Z-ADDWARMNB    WQSP02           Load ID
     C                     Z-ADDYL0039    WQSP03           Stop/Drop
      * Establish starting position
     C           KRSSP     SETLL@FLCPEB                    *
     C           KRSSP     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Ld/Order   OrdWgt RT - Order Header TRG  * 
     C                     EXSR SQRVGN
     C                     ADD  YL0041    WN0006           Total Weight Wo
     C           KRSSP     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Ld/Order   OrdWgt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQSQ02           Load ID
     C           *LIKE     DEFN WHC4NB    WQSQ03           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
     C                     KFLD           WQSQ03           Order Number
      * Setup key
     C                     Z-ADDWGRMNB    WQSQ02           Load ID
     C                     Z-ADDWGC4NB    WQSQ03           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@BFCPRQ                    *
     C           KRSSQ     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWHA1WG    YL0041           Order Weight To
     C           KRSSQ     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Upd Ld/ShipTo  RefAmt RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADDWAC5VL    YL0042           LFC Amount
      * * CALC: Freight Rate Per Pound
      * CASE: PAR.Total Weight Work is Not Zeros
     C           WN0006    IFNE 0                          *IF
     C           WAC5VL    DIV  WN0006    YL0043    H      Freight Rate US
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSR02           Load ID
     C           *LIKE     DEFN WGRVNB    WQSR03           Stop/Drop
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR02           Load ID
     C                     KFLD           WQSR03           Stop/Drop
      * Setup key
     C                     Z-ADDWARMNB    WQSR02           Load ID
     C                     Z-ADDYL0039    WQSR03           Stop/Drop
      * Establish starting position
     C           KRSSR     SETLL@FLCPEB                    *
     C           KRSSR     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * * CALC: Freight Amount for Order
      * RTV Order Weight       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0057           Company Number
     C                     Z-ADDWGC4NB    WL0058           Order Number
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0059    YL0044           Order Weight To
     C           YL0043    MULT YL0044    YL0045           Freight Amount
      * Upd Ld/Order   RefAmt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGRMNB    WL0060           Load ID
     C                     Z-ADDWGC4NB    WL0061           Order Number
     C                     Z-ADDYL0045    WL0062           Freight Amount
     C                     MOVELWAKBSX    WL0063    P      LFC Act Frt Inc
     C                     MOVELWAKSSX    WL0064    P      LFC Tot Freight
     C                     EXSR STRVGN
      * * CALC: Remaining Amount to Allocate
     C                     SUB  YL0045    YL0042           LFC Amount
     C           KRSSR     READE@FLCPEB                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.LFC Amount is Entered
     C           YL0042    IFNE 0                          *IF
      * Adjust difference on last Order
      * Upd Ld/Order   RefAmt RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGRMNB    WL0060           Load ID
     C                     Z-ADDWGC4NB    WL0061           Order Number
     C                     Z-ADDYL0042    WL0062           Freight Amount
     C                     MOVELWAKBSX    WL0063    P      LFC Act Frt Inc
     C                     MOVELWAKSSX    WL0064    P      LFC Tot Freight
     C                     EXSR STRVGN
     C                     END                             *FI
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Order Weight       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0057    WIAIC3           Company Number
     C                     Z-ADDWL0058    WIC4NB           Order Number
      * Establish starting position
     C           KRSSS     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0059           Order Weight To
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIA1WG    WL0059           Order Weight To
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Upd Ld/Order   RefAmt RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQST02           Load ID
     C           *LIKE     DEFN WHC4NB    WQST03           Order Number
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST02           Load ID
     C                     KFLD           WQST03           Order Number
      * Setup key
     C                     Z-ADDWL0060    WQST02           Load ID
     C                     Z-ADDWL0061    WQST03           Order Number
      * Establish starting position
     C           KRSST     SETLL@BFCPRQ                    *
     C           KRSST     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * UPD: Actual Freight Reference Amount
      * CASE: PAR.LFC Act Frt Include Sts is Yes
     C           WL0063    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WHH0NX    ADD  WL0062    YL0046           Act Frt Referen
      * * UPD: Update with New Reference Amount
      * Chg Ord ActFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0017           Company Number
     C                     Z-ADDWHC4NB    WL0018           Order Number
     C                     Z-ADDYL0046    WL0019           Act Frt Referen
     C                     EXSR SGCHRC
     C                     END                             *FI
      * UPD: Total Freight Reference Amount
      * CASE: PAR.LFC Tot Freight Inc Sts is Yes
     C           WL0064    IFEQ 'Y'                        *IF
      * * ADD: Add to the current value of Reference Amount
     C           WHH4NX    ADD  WL0062    YL0047           OH Total Ref Fr
      * * UPD: Update with New Reference Amount
      * Chg Ord TotFrt RefAmt CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0020           Company Number
     C                     Z-ADDWHC4NB    WL0021           Order Number
     C                     Z-ADDYL0047    WL0022           OH Total Ref Fr
     C                     EXSR SHCHRC
     C                     END                             *FI
     C           KRSST     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Ref Act Frt Even  RT - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0051           LFC Spc Typ=E A
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSU01           Load ID
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSU01           Load ID
      * Establish starting position
     C           KRSSU     SETLL@BCCPJ8                    *
     C           KRSSU     READE@BCCPJ8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3058' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     YL0050           LFC Spc Typ=E A
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LFC Special Type is Evenly by Stop
     C           WAKTSX    IFEQ 'E'                        *IF
     C                     ADD  WAC5VL    YL0051           LFC Spc Typ=E A
     C                     END                             *FI
     C           KRSSU     READE@BCCPJ8                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0051    YL0050           LFC Spc Typ=E A
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Total Stops       RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WJRMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WJRMNB           Load ID
      * Establish starting position
     C           KRSSV     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0052           Total Stops
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJRRNB    YL0052           Total Stops
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Upd Ref Act Frt Even  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0056           First Stop USR
     C                     Z-ADD*ZERO     YL0057           Stop/Drop
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSW02           Load ID
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSW02           Load ID
      * Establish starting position
     C           KRSSW     SETLL@FLCPEB                    *
     C           KRSSW     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Stop/Drop NE LCL.Stop/Drop
     C           WGRVNB    IFNE YL0057                     *IF
      * Determine how many orders are on Load/Stop
      * Rtv Ref Act Frt EvenCtRT - Load Detail  * 
     C                     EXSR SXRVGN
      * Reset LCL Fields to ZERO for the Next Stop
     C                     Z-ADD*ZERO     YL0060           LFC Spc Typ=E A
     C                     Z-ADD*ZERO     YL0061           LFC Spc Typ=E A
      * Calc LFC Freight Charge Special Type=E to be applied to each Orde
      * CASE: LCL.First Stop USR is Yes
     C           YL0056    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0056           First Stop USR
      * CASE: LCL.Load/Stop Ord Cnt USR is EQ 1
     C           YL0058    IFEQ 1                          *IF
     C                     Z-ADDYL0055    YL0061           LFC Spc Typ=E A
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0055    DIV  YL0058    YL0060           LFC Spc Typ=E A
     C                     MVR            YL0062           LFC Spc Typ=E A
     C           YL0060    ADD  YL0062    YL0061           LFC Spc Typ=E A
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Load/Stop Ord Cnt USR is EQ 1
     C           YL0058    IFEQ 1                          *IF
     C                     Z-ADDYL0053    YL0061           LFC Spc Typ=E A
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0053    DIV  YL0058    YL0060           LFC Spc Typ=E A
     C                     MVR            YL0063           LFC Spc Typ=E A
     C           YL0060    ADD  YL0063    YL0061           LFC Spc Typ=E A
     C                     END                             *FI
     C                     END                             *FI
      * Upd OHT - Act Frt Reference Amount & OH Total Ref Frt Amt
      * Upd Ref Act Frt EvenOHRT - Load Detail  * 
     C                     EXSR SYRVGN
      * Update LCL.Stop/Drop which is used to determine the next stop
     C                     Z-ADDWGRVNB    YL0057           Stop/Drop
     C                     END                             *FI
     C           KRSSW     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Ref Act Frt EvenCtRT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0059           Load/Stop Ord C
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKRMNB    WQSX01           Load ID
     C           *LIKE     DEFN WKRVNB    WQSX02           Stop/Drop
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Load ID
     C                     KFLD           WQSX02           Stop/Drop
      * Setup key
     C                     Z-ADDP1RMNB    WQSX01           Load ID
     C                     Z-ADDWGRVNB    WQSX02           Stop/Drop
      * Establish starting position
     C           KRSSX     SETLL@FLCPCW                    *
     C           KRSSX     READE@FLCPCW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0059           Load/Stop Ord C
     C           KRSSX     READE@FLCPCW                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0059    YL0058           Load/Stop Ord C
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Upd Ref Act Frt EvenOHRT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0064           First Order USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLRMNB    WQSY01           Load ID
     C           *LIKE     DEFN WLRVNB    WQSY02           Stop/Drop
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Load ID
     C                     KFLD           WQSY02           Stop/Drop
      * Setup key
     C                     Z-ADDWGRMNB    WQSY01           Load ID
     C                     Z-ADDWGRVNB    WQSY02           Stop/Drop
      * Establish starting position
     C           KRSSY     SETLL@FLCPZA                    *
     C           KRSSY     READE@FLCPZA                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Order USR is Yes
     C           YL0064    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0064           First Order USR
      * Upd Ref Act Frt EvenOHRT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0065           Company Number
     C                     Z-ADDWLC4NB    WL0066           Order Number
     C                     Z-ADDYL0061    WL0067           Act Frt Referen
     C                     Z-ADDYL0061    WL0068           OH Total Ref Fr
     C                     EXSR SZRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Upd Ref Act Frt EvenOHRT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLAIC3    WL0065           Company Number
     C                     Z-ADDWLC4NB    WL0066           Order Number
     C                     Z-ADDYL0060    WL0067           Act Frt Referen
     C                     Z-ADDYL0060    WL0068           OH Total Ref Fr
     C                     EXSR SZRVGN
     C                     END                             *FI
     C           KRSSY     READE@FLCPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Upd Ref Act Frt EvenOHRT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0065    WIAIC3           Company Number
     C                     Z-ADDWL0066    WIC4NB           Order Number
      * Establish starting position
     C           KRSSZ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WIH0NX    ADD  WL0067    YL0065           Act Frt Referen
     C           WIH4NX    ADD  WL0068    YL0066           OH Total Ref Fr
      * Chg Act/Tot Frt Ref   CH - Order Header TRG  * 
     C                     EXSR TACHRC
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * Chg Act/Tot Frt Ref   CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0379  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0380  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0381  70       Ship To Custome
     C                     MOVEL*BLANK    WN0382 30        Ship To Name
     C                     MOVEL*BLANK    WN0383 30        Ship To Address
     C                     MOVEL*BLANK    WN0384 30        Ship To Address
     C                     MOVEL*BLANK    WN0385 30        Ship To Address
     C                     MOVEL*BLANK    WN0386 20        Ship To City
     C                     MOVEL*BLANK    WN0387  2        Ship To State C
     C                     MOVEL*BLANK    WN0388 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0389  70       Bill to Custome
     C                     MOVEL*BLANK    WN0390 30        Bill to Name
     C                     MOVEL*BLANK    WN0391 30        Bill to Address
     C                     MOVEL*BLANK    WN0392 30        Bill to Address
     C                     MOVEL*BLANK    WN0393 30        Bill to Address
     C                     MOVEL*BLANK    WN0394 20        Bill to City
     C                     MOVEL*BLANK    WN0395  2        Bill to State C
     C                     MOVEL*BLANK    WN0396 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0397 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0398  70       Order Date
     C                     Z-ADD*ZERO     WN0399  70       Requested Ship
     C                     Z-ADD*ZERO     WN0400  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0401  70       Cancel Date
     C                     MOVEL*BLANK    WN0402  2        Terms Code
     C                     MOVEL*BLANK    WN0403 40        Special Instruc
     C                     MOVEL*BLANK    WN0404 40        Special Instruc
     C                     MOVEL*BLANK    WN0405  3        Carrier Code
     C                     MOVEL*BLANK    WN0406  1        Comment Print A
     C                     MOVEL*BLANK    WN0407  1        Comment Print I
     C                     MOVEL*BLANK    WN0408  1        Comment Print P
     C                     MOVEL*BLANK    WN0409  1        Comment Print S
     C                     MOVEL*BLANK    WN0410  3        Reason Code
     C                     MOVEL*BLANK    WN0411  1        Order in Use
     C                     MOVEL*BLANK    WN0412  1        Header Status
     C                     MOVEL*BLANK    WN0413  1        Header Status L
     C                     MOVEL*BLANK    WN0414  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0415  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0416 10        User Original E
     C                     Z-ADD*ZERO     WN0417  70       Date of Origina
     C                     Z-ADD*ZERO     WN0418 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0419 112       Order Weight To
     C                     MOVEL*BLANK    WN0420  1        Credit Hold
     C                     MOVEL*BLANK    WN0421  1        Production Hold
     C                     MOVEL*BLANK    WN0422  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0423  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0424  40       Requested Deliv
     C                     MOVEL*BLANK    WN0425  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0426 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0427  70       Load ID
     C                     Z-ADD*ZERO     WN0428  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0429 112       Rated Freight
     C                     MOVEL*BLANK    WN0430  1        LTL Flag
     C                     MOVEL*BLANK    WN0431  1        Price Audit
     C                     MOVEL*BLANK    WN0432  1        Price Status
     C                     MOVEL*BLANK    WN0433  2        Shipping Method
     C                     MOVEL*BLANK    WN0434  1        Export Status
     C                     MOVEL*BLANK    WN0435  1        Palletize
     C                     MOVEL*BLANK    WN0436  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0437  1        Slip Sheet
     C                     MOVEL*BLANK    WN0438  1        Age Code
     C                     Z-ADD*ZERO     WN0439  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0440  1        Load Type
     C                     Z-ADD*ZERO     WN0441  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0442  1        Load Plan Order
     C                     MOVEL*BLANK    WN0443  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0444  70       Resell Referenc
     C                     MOVEL*BLANK    WN0445 30        Special Comment
     C                     MOVEL*BLANK    WN0446 30        Special Comment
     C                     MOVEL*BLANK    WN0447  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0448  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0449  2        Manager Level C
     C                     MOVEL*BLANK    WN0450  3        VP Level Code
     C                     Z-ADD*ZERO     WN0451  70       Attach to Order
     C                     MOVEL*BLANK    WN0452  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0453  70       Invoice Number
     C                     MOVEL*BLANK    WN0454  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0455  70       Invoice Date
     C                     MOVEL*BLANK    WN0456  2        Event Code
     C                     MOVEL*BLANK    WN0457  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0458  1        Modified Flag
     C                     Z-ADD*ZERO     WN0459 112       A/R order Value
     C                     MOVEL*BLANK    WN0460  1        Billing Activit
     C                     MOVEL*BLANK    WN0461  1        Block Order Fla
     C                     MOVEL*BLANK    WN0462  1        Order Certifica
     C                     Z-ADD*ZERO     WN0463 112       Invoice Order V
     C                     MOVEL*BLANK    WN0464  1        Process Sts for
     C                     MOVEL*BLANK    WN0465  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0466  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0467  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0468  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0469  1        Email Cust On O
     C                     MOVEL*BLANK    WN0470  1        Order Emailed
     C                     MOVEL*BLANK    WN0471  1        Export Docs Go
     C                     MOVEL*BLANK    WN0472  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0473  1        Broker Order St
     C                     MOVEL*BLANK    WN0474  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0475  2        Order Requires
     C                     MOVEL*BLANK    WN0476  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0477  2        Export USDA App
     C                     MOVEL*BLANK    WN0478  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0479  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0480  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0481  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0482  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0483  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0484  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0485  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0486  60       Time of Origina
     C                     Z-ADD*ZERO     WN0487  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0488  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0489  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0490 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0491 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0492 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0493  70       Claim Number
     C                     MOVEL*BLANK    WN0494  1        EDI Status 1
     C                     MOVEL*BLANK    WN0495  1        EDI Status 2
     C                     MOVEL*BLANK    WN0496  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0497  60       Job Time
     C                     MOVEL*BLANK    WN0498 10        User Id
     C                     MOVEL*BLANK    WN0499 10        Job Name
     C                     Z-ADD*ZERO     WN0500  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWIAIC3    WCAIC3           Company Number
     C                     Z-ADDWIC4NB    WCC4NB           Order Number
      *
     C           KLCHTA    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHTA    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDYL0065    WCH0NX           Act Frt Referen
     C                     Z-ADDYL0066    WCH4NX           OH Total Ref Fr
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWCAIC3    PAAIC3           Company Number
     C                     Z-ADDWCC4NB    PAC4NB           Order Number
     C                     MOVELWCJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWCANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWCBKC7    PABKC7           Ship To Custome
     C                     MOVELWCBRTX    PABRTX    P      Ship To Name
     C                     MOVELWCHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWCHONA    PAHONA    P      Ship To Address
     C                     MOVELWCHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWCHNNA    PAHNNA    P      Ship To City
     C                     MOVELWCDBCD    PADBCD    P      Ship To State C
     C                     MOVELWCCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWCB0C7    PAB0C7           Bill to Custome
     C                     MOVELWCAETX    PAAETX    P      Bill to Name
     C                     MOVELWCB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWCB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWCB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWCB2NA    PAB2NA    P      Bill to City
     C                     MOVELWCBHCD    PABHCD    P      Bill to State C
     C                     MOVELWCC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWCBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWCA0DT    PAA0DT           Order Date
     C                     Z-ADDWCA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWCGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWCACDT    PAACDT           Cancel Date
     C                     MOVELWCAQCD    PAAQCD    P      Terms Code
     C                     MOVELWCB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWCBYNA    PABYNA    P      Special Instruc
     C                     MOVELWCBZNA    PABZNA    P      Carrier Code
     C                     MOVELWCGTST    PAGTST    P      Comment Print A
     C                     MOVELWCGVST    PAGVST    P      Comment Print I
     C                     MOVELWCGUST    PAGUST    P      Comment Print P
     C                     MOVELWCQFST    PAQFST    P      Comment Print S
     C                     MOVELWCCQCD    PACQCD    P      Reason Code
     C                     MOVELWCGJST    PAGJST    P      Order in Use
     C                     MOVELWCGWST    PAGWST    P      Header Status
     C                     MOVELWCGXST    PAGXST    P      Header Status L
     C                     MOVELWCGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWCAODT    PAAODT           Scheduled Ship
     C                     MOVELWCAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWCCXDT    PACXDT           Date of Origina
     C                     Z-ADDWCJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWCA1WG    PAA1WG           Order Weight To
     C                     MOVELWCXIST    PAXIST    P      Credit Hold
     C                     MOVELWCXJST    PAXJST    P      Production Hold
     C                     MOVELWCXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWCEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWCAFTM    PAAFTM           Requested Deliv
     C                     MOVELWCE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWCE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWCRMNB    PARMNB           Load ID
     C                     Z-ADDWCTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWCR1NB    PAR1NB           Rated Freight
     C                     MOVELWCPJST    PAPJST    P      LTL Flag
     C                     MOVELWCU0ST    PAU0ST    P      Price Audit
     C                     MOVELWCU1ST    PAU1ST    P      Price Status
     C                     MOVELWCQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWCU2ST    PAU2ST    P      Export Status
     C                     MOVELWCVEST    PAVEST    P      Palletize
     C                     MOVELWCVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWCVGST    PAVGST    P      Slip Sheet
     C                     MOVELWCRPCD    PARPCD    P      Age Code
     C                     Z-ADDWCRNNB    PARNNB           Reefer Temperat
     C                     MOVELWCVDST    PAVDST    P      Load Type
     C                     Z-ADDWCATIN    PAATIN           Attach to Invoi
     C                     MOVELWCU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWCU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWCRSRN    PARSRN           Resell Referenc
     C                     MOVELWCMHNA    PAMHNA    P      Special Comment
     C                     MOVELWCMINA    PAMINA    P      Special Comment
     C                     MOVELWCWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWCR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWCBFCD    PABFCD    P      Manager Level C
     C                     MOVELWCQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWCT3NB    PAT3NB           Attach to Order
     C                     MOVELWCSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWCCONB    PACONB           Invoice Number
     C                     MOVELWCCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWCAWDT    PAAWDT           Invoice Date
     C                     MOVELWCJPCD    PAJPCD    P      Event Code
     C                     MOVELWCXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWCZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWCVRVA    PAVRVA           A/R order Value
     C                     MOVELWCOBST    PAOBST    P      Billing Activit
     C                     MOVELWCBCST    PABCST    P      Block Order Fla
     C                     MOVELWCBDST    PABDST    P      Order Certifica
     C                     Z-ADDWCB7VL    PAB7VL           Invoice Order V
     C                     MOVELWCGASX    PAGASX    P      Process Sts for
     C                     MOVELWCGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWCGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWCGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWCFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWCFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWCFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWCFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWCFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWCFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWCFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWCFUSX    PAFUSX    P      Order Requires
     C                     MOVELWCFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWCFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWCFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWCFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWCNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWCNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWCNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWCNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWCNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWCBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWCBQTM    PABQTM           Time of Origina
     C                     Z-ADDWCBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWCBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWCBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWCH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWCH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWCH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWCH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWCH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWCC0C7    PAC0C7           Claim Number
     C                     MOVELWCUVST    PAUVST    P      EDI Status 1
     C                     MOVELWCUWST    PAUWST    P      EDI Status 2
     C                     MOVELWCUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWCAATM    PAAATM           Job Time
     C                     MOVELWCAYNA    PAAYNA    P      User Id
     C                     MOVELWCA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWCAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * CLC Total Lbs-Miles    RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0501  50       Stop/Drop
     C                     Z-ADD*ZERO     WN0502 112       Order Weight To
     C                     Z-ADD*ZERO     WN0503 152       Incremental Mil
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UBSUBR                     ***** Change Lo
     C                     Z-ADD*ZERO     WUEMNY           Lbs-Miles USR
     C                     Z-ADD*ZERO     WUENNY           Total Lbs-Miles
      * R8827 JJH 01/18/17 - Get MG Created Load from Load Header
      * RTV MG Created Load   RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0069           Load ID
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0070    YL0067    P      MG Created Load
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTB02           Load ID
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQTB02           Load ID
      * Establish starting position
     C           KRSTB     SETLL@FLCPEB                    *
     C           KRSTB     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Order Weight       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0057           Company Number
     C                     Z-ADDWGC4NB    WL0058           Order Number
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0059    WN0502           Order Weight To
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * R8827 JJH 01/18/17 - Modify calculation of Incremental Miles USR
      * ** Accumulate Incremental Miles when Stop/Drop changes
      * CASE: DB1.Stop/Drop NE PAR.Stop/Drop
     C           WGRVNB    IFNE WN0501                     *IF
      * CASE: LCL.MG Created Load is Yes
     C           YL0067    IFEQ 'Y'                        *IF
     C                     Z-ADDWGRWNB    WN0503           Incremental Mil
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WGRWNB    WN0503           Incremental Mil
     C                     END                             *FI
     C                     END                             *FI
      * ** Default Incremental Miles to 1 if it is zeros   3/10/08 FP1271
      * CASE: PAR.Incremental Miles USR is Zeros
     C           WN0503    IFEQ 0                          *IF
     C                     Z-ADD1         WN0503           Incremental Mil
     C                     END                             *FI
     C           WN0503    MULT WN0502    WUEMNY    H      Lbs-Miles USR
     C                     ADD  WUEMNY    WUENNY           Total Lbs-Miles
     C                     END                             *FI
     C                     Z-ADDWGRVNB    WN0501           Stop/Drop
     C           KRSTB     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV MG Created Load   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0069    WJRMNB           Load ID
      * Establish starting position
     C           KRSTC     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0070           MG Created Load
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJRYSX    WL0070           MG Created Load
     C                     GOTO TCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * CLC UPD Order Alloc %  RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0504  50       Stop/Drop
     C                     Z-ADD*ZERO     WN0505 112       Order Weight To
     C                     Z-ADD*ZERO     WN0506 152       Incremental Mil
     C                     Z-ADD*ZERO     WN0507 152       Lbs-Miles USR
     C                     Z-ADD*ZERO     WN0508  72       Fuel Surcharge
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UCSUBR                     ***** Change Lo
     C                     Z-ADD*ZERO     WUGCPC           Order Allocatio
      * *---- Retrieve Fuel Surcharge ----*
      * Rtv Special Chrg Amt  RT - Load Freight Charge  * 
     C                     EXSR TERVGN
      * R8827 JJH 01/18/17 - Get MG Created Load from Load Header
      * RTV MG Created Load   RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0069           Load ID
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0070    YL0068    P      MG Created Load
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQTD02           Load ID
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQTD02           Load ID
      * Establish starting position
     C           KRSTD     SETLL@FLCPEB                    *
     C           KRSTD     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Order Weight       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0057           Company Number
     C                     Z-ADDWGC4NB    WL0058           Order Number
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0059    WN0505           Order Weight To
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * R8827 JJH 01/18/17 - Modify calculation of Incremental Miles USR
      * ** Accumulate Incremental Miles when Stop/Drop changes
      * CASE: DB1.Stop/Drop NE PAR.Stop/Drop
     C           WGRVNB    IFNE WN0504                     *IF
      * CASE: LCL.MG Created Load is Yes
     C           YL0068    IFEQ 'Y'                        *IF
     C                     Z-ADDWGRWNB    WN0506           Incremental Mil
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WGRWNB    WN0506           Incremental Mil
     C                     END                             *FI
     C                     END                             *FI
      * ** If incremental miles is zeros, default to 1.   3/10/08 FP1271
      * CASE: PAR.Incremental Miles USR is Zeros
     C           WN0506    IFEQ 0                          *IF
     C                     Z-ADD1         WN0506           Incremental Mil
     C                     END                             *FI
     C           WN0506    MULT WN0505    WN0507    H      Lbs-Miles USR
      * ** Calc Ord Alloc%. If Tot Lbs-Miles=0, Set to 100%
      * CASE: PAR.Total Lbs-Miles USR is GT Zero
     C           WUENNY    IFGT 0                          *IF
     C           WN0507    DIV  WUENNY    WUGCPC    H      Order Allocatio
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         WUGCPC           Order Allocatio
     C                     END                             *FI
      * *--- Calculate Percent of total for the Order ---*
     C           WUEKNY    MULT WUGCPC    WUH1NX    H      Act Non-Ref Frt
     C           WN0508    MULT WUGCPC    YL0069    H      OH Fuel Surchar
     C           YL0048    MULT WUGCPC    YL0070    H      OH Total Non-Re
      * *--- Update Order Header ---*
      * Chg Alloc Frt Amount   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0071           Company Number
     C                     Z-ADDWGC4NB    WL0072           Order Number
     C                     Z-ADDWUH1NX    WL0073           Act Non-Ref Frt
     C                     Z-ADDYL0069    WL0074           OH Fuel Surchar
     C                     Z-ADDYL0070    WL0075           OH Total Non-Re
     C                     EXSR TFCHRC
      * *--- Accumulate allocated values ---*
     C                     ADD  WUH1NX    YL0071           Total Amount
     C                     ADD  YL0069    YL0072           Fuel Surcharge
     C                     ADD  YL0070    YL0073           Load Total Frei
     C                     Z-ADDWGAIC3    WUAIC3           Company Number
     C                     Z-ADDWGC4NB    WUC4NB           Order Number
     C                     END                             *FI
     C                     Z-ADDWGRVNB    WN0504           Stop/Drop
     C           KRSTD     READE@FLCPEB                  90*
     C                     ENDDO
      * USER: Exit processing
      * ** Subtract the accumulated allocated freight from the balance
      * ** of the freight after air freight has been removed. Add this to
      * ** the last order.
     C           WUEKNY    SUB  YL0071    YL0074           Freight Amount
     C                     ADD  YL0074    WUH1NX           Act Non-Ref Frt
     C           WN0508    SUB  YL0072    YL0075           Remaining to Ap
     C                     ADD  YL0075    YL0069           OH Fuel Surchar
     C           YL0048    SUB  YL0073    YL0075           Remaining to Ap
     C                     ADD  YL0075    YL0070           OH Total Non-Re
      * Chg Alloc Frt Amount   CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0071           Company Number
     C                     Z-ADDWUC4NB    WL0072           Order Number
     C                     Z-ADDWUH1NX    WL0073           Act Non-Ref Frt
     C                     Z-ADDYL0069    WL0074           OH Fuel Surchar
     C                     Z-ADDYL0070    WL0075           OH Total Non-Re
     C                     EXSR TFCHRC
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Special Chrg Amt  RT - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0508           LFC Amount
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMRMNB    WQTE01           Load ID
     C           *LIKE     DEFN WMKTSX    WQTE02           LFC Special Typ
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Load ID
     C                     KFLD           WQTE02           LFC Special Typ
      * Setup key
     C                     Z-ADDP1RMNB    WQTE01           Load ID
     C                     MOVEL'F'       WQTE02           LFC Special Typ
      * Establish starting position
     C           KRSTE     SETLL@BCCPGQ                    *
     C           KRSTE     READE@BCCPGQ                  90*
      * Data record not found
     C   90                MOVEL'USR3058' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WMC5VL    WN0508           LFC Amount
     C           KRSTE     READE@BCCPGQ                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * Chg Alloc Frt Amount   CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0509  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0510  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0511  70       Ship To Custome
     C                     MOVEL*BLANK    WN0512 30        Ship To Name
     C                     MOVEL*BLANK    WN0513 30        Ship To Address
     C                     MOVEL*BLANK    WN0514 30        Ship To Address
     C                     MOVEL*BLANK    WN0515 30        Ship To Address
     C                     MOVEL*BLANK    WN0516 20        Ship To City
     C                     MOVEL*BLANK    WN0517  2        Ship To State C
     C                     MOVEL*BLANK    WN0518 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0519  70       Bill to Custome
     C                     MOVEL*BLANK    WN0520 30        Bill to Name
     C                     MOVEL*BLANK    WN0521 30        Bill to Address
     C                     MOVEL*BLANK    WN0522 30        Bill to Address
     C                     MOVEL*BLANK    WN0523 30        Bill to Address
     C                     MOVEL*BLANK    WN0524 20        Bill to City
     C                     MOVEL*BLANK    WN0525  2        Bill to State C
     C                     MOVEL*BLANK    WN0526 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0527 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0528  70       Order Date
     C                     Z-ADD*ZERO     WN0529  70       Requested Ship
     C                     Z-ADD*ZERO     WN0530  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0531  70       Cancel Date
     C                     MOVEL*BLANK    WN0532  2        Terms Code
     C                     MOVEL*BLANK    WN0533 40        Special Instruc
     C                     MOVEL*BLANK    WN0534 40        Special Instruc
     C                     MOVEL*BLANK    WN0535  3        Carrier Code
     C                     MOVEL*BLANK    WN0536  1        Comment Print A
     C                     MOVEL*BLANK    WN0537  1        Comment Print I
     C                     MOVEL*BLANK    WN0538  1        Comment Print P
     C                     MOVEL*BLANK    WN0539  1        Comment Print S
     C                     MOVEL*BLANK    WN0540  3        Reason Code
     C                     MOVEL*BLANK    WN0541  1        Order in Use
     C                     MOVEL*BLANK    WN0542  1        Header Status
     C                     MOVEL*BLANK    WN0543  1        Header Status L
     C                     MOVEL*BLANK    WN0544  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0545  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0546 10        User Original E
     C                     Z-ADD*ZERO     WN0547  70       Date of Origina
     C                     Z-ADD*ZERO     WN0548 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0549 112       Order Weight To
     C                     MOVEL*BLANK    WN0550  1        Credit Hold
     C                     MOVEL*BLANK    WN0551  1        Production Hold
     C                     MOVEL*BLANK    WN0552  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0553  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0554  40       Requested Deliv
     C                     MOVEL*BLANK    WN0555  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0556 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0557  70       Load ID
     C                     Z-ADD*ZERO     WN0558  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0559 112       Rated Freight
     C                     MOVEL*BLANK    WN0560  1        LTL Flag
     C                     MOVEL*BLANK    WN0561  1        Price Audit
     C                     MOVEL*BLANK    WN0562  1        Price Status
     C                     MOVEL*BLANK    WN0563  2        Shipping Method
     C                     MOVEL*BLANK    WN0564  1        Export Status
     C                     MOVEL*BLANK    WN0565  1        Palletize
     C                     MOVEL*BLANK    WN0566  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0567  1        Slip Sheet
     C                     MOVEL*BLANK    WN0568  1        Age Code
     C                     Z-ADD*ZERO     WN0569  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0570  1        Load Type
     C                     Z-ADD*ZERO     WN0571  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0572  1        Load Plan Order
     C                     MOVEL*BLANK    WN0573  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0574  70       Resell Referenc
     C                     MOVEL*BLANK    WN0575 30        Special Comment
     C                     MOVEL*BLANK    WN0576 30        Special Comment
     C                     MOVEL*BLANK    WN0577  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0578  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0579  2        Manager Level C
     C                     MOVEL*BLANK    WN0580  3        VP Level Code
     C                     Z-ADD*ZERO     WN0581  70       Attach to Order
     C                     MOVEL*BLANK    WN0582  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0583  70       Invoice Number
     C                     MOVEL*BLANK    WN0584  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0585  70       Invoice Date
     C                     MOVEL*BLANK    WN0586  2        Event Code
     C                     MOVEL*BLANK    WN0587  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0588  1        Modified Flag
     C                     Z-ADD*ZERO     WN0589 112       A/R order Value
     C                     MOVEL*BLANK    WN0590  1        Billing Activit
     C                     MOVEL*BLANK    WN0591  1        Block Order Fla
     C                     MOVEL*BLANK    WN0592  1        Order Certifica
     C                     Z-ADD*ZERO     WN0593 112       Invoice Order V
     C                     MOVEL*BLANK    WN0594  1        Process Sts for
     C                     MOVEL*BLANK    WN0595  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0596  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0597  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0598  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0599  1        Email Cust On O
     C                     MOVEL*BLANK    WN0600  1        Order Emailed
     C                     MOVEL*BLANK    WN0601  1        Export Docs Go
     C                     MOVEL*BLANK    WN0602  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0603  1        Broker Order St
     C                     MOVEL*BLANK    WN0604  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0605  2        Order Requires
     C                     MOVEL*BLANK    WN0606  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0607  2        Export USDA App
     C                     MOVEL*BLANK    WN0608  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0609  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0610  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0611  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0612  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0613  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0614  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0615  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0616  60       Time of Origina
     C                     Z-ADD*ZERO     WN0617  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0618  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0619  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0620 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0621 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0622  70       Claim Number
     C                     MOVEL*BLANK    WN0623  1        EDI Status 1
     C                     MOVEL*BLANK    WN0624  1        EDI Status 2
     C                     MOVEL*BLANK    WN0625  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0626  60       Job Time
     C                     MOVEL*BLANK    WN0627 10        User Id
     C                     MOVEL*BLANK    WN0628 10        Job Name
     C                     Z-ADD*ZERO     WN0629  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0071    WCAIC3           Company Number
     C                     Z-ADDWL0072    WCC4NB           Order Number
      *
     C           KLCHTF    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHTF    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YERDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0073    WCH1NX           Act Non-Ref Frt
     C                     Z-ADDWL0074    WCH2NX           OH Fuel Surchar
     C                     Z-ADDWL0075    WCH3NX           OH Total Non-Re
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * UPD/Alloc Act Freight  RT - Sales History  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0630  70       Order Number
     C                     Z-ADD*ZERO     WN0631  96       USR Work Percen
     C                     Z-ADD*ZERO     WN0632  92       USR Weight Bill
     C                     Z-ADD*ZERO     WN0633 112       USR Remaining B
     C                     Z-ADD*ZERO     WN0634 112       Load Actual Fre
     C                     Z-ADD*ZERO     WN0635 117       Fuel Surcharge
     C                     Z-ADD*ZERO     WN0636 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0637 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0638 117       Load Total Frei
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * ** Used for Actual Freight
     C                     Z-ADD*ZERO     WUONVA           Actual Freight
     C                     Z-ADD*ZERO     WN0633           USR Remaining B
      * ** Used for Fuel Surcharge
     C                     Z-ADD*ZERO     YL0076           SH Fuel Surchar
     C                     Z-ADD*ZERO     YL0077           Fuel Surcharge
      * ** Used for Load Total Freight
     C                     Z-ADD*ZERO     YL0078           OH Total Non-Re
     C                     Z-ADD*ZERO     YL0079           Load Total Frei
     C                     Z-ADD*ZERO     WUU7VA           USR Amount Rema
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WORMNB    WQTG01           Load ID
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQTG01           Load ID
      * Establish starting position
     C           KRSTG     SETLL@HSTPUX                    *
     C           KRSTG     READE@HSTPUX                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Val Order on Load     RT - Load Detail  * 
     C                     EXSR THRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Add Air Freight Amount to Actual Freight Allocation from Order
      * ** Header to get the Total Freight for this order. Allocation % i
      * ** calculated by dividing the Total Freight Amount by the Order
      * ** Weight Total.
      * ** Rtv freight and allocation % by order number
      * CASE: DB1.Order Number NE PAR.Order Number
     C           WOC4NB    IFNE WN0630                     *IF
      * ** Update last detail record with any remaining freight amount
      * CASE: WRK.First Time Flag is NO
     C           WUTAST    IFEQ 'N'                        *IF
     C           WUTFAM    SUB  WN0633    WUMFQT           Total Amount
     C                     ADD  WUMFQT    WUONVA           Actual Freight
     C           WN0637    SUB  YL0079    YL0080           Remaining to Ap
     C                     ADD  YL0080    YL0078           OH Total Non-Re
      * CHG Act/Tot Frt Amt   CH - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0076           Company Number
     C                     Z-ADDWUC4NB    WL0077           Order Number
     C                     Z-ADDWUDPNB    WL0078           Order Sequence
     C                     Z-ADDWUUENB    WL0079           Order Secondary
     C                     Z-ADDWUONVA    WL0080           Actual Freight
     C                     Z-ADDYL0078    WL0081           Load Total Frei
     C                     EXSR TICHRC
     C                     Z-ADD*ZERO     WN0633           USR Remaining B
     C                     Z-ADD*ZERO     YL0079           Load Total Frei
      * *---- UPDATE TOTAL FREIGHT & FUEL SURCHARGE ----*
     C           WN0636    SUB  YL0077    YL0080           Remaining to Ap
     C                     ADD  YL0080    YL0076           SH Fuel Surchar
      * Upd Fuel Charge       RT - Sales History EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0082           Company Number
     C                     Z-ADDWUC4NB    WL0083           Order Number
     C                     Z-ADDWUDPNB    WL0084           Order Sequence
     C                     Z-ADDWUUENB    WL0085           Order Secondary
     C                     Z-ADDYL0076    WL0086           SH Fuel Surchar
     C                     EXSR TJRVGN
     C                     Z-ADD*ZERO     YL0077           Fuel Surcharge
     C                     END                             *FI
      * RTV Air&Actual Freight RT - Order Header TRG  * 
     C                     EXSR TMRVGN
     C                     Z-ADDWOC4NB    WN0630           Order Number
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
      * ** Distribute the freight to each detail record for the order
      * ** (Remaining Balance is actually a running balance of the
      * ** freight that is distributed for this order.)
      * CASE: DB1.Order Number EQ PAR.Order Number
     C           WOC4NB    IFEQ WN0630                     *IF
      * *---- UPDATE ACTUAL FREIGHT AMOUNT & Total Freight ----*
     C           WOBYWG    MULT WN0631    WUONVA           Actual Freight
     C           WOBYWG    MULT WN0638    YL0078           OH Total Non-Re
      * CHG Act/Tot Frt Amt   CH - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0076           Company Number
     C                     Z-ADDWOC4NB    WL0077           Order Number
     C                     Z-ADDWODPNB    WL0078           Order Sequence
     C                     Z-ADDWOUENB    WL0079           Order Secondary
     C                     Z-ADDWUONVA    WL0080           Actual Freight
     C                     Z-ADDYL0078    WL0081           Load Total Frei
     C                     EXSR TICHRC
      * *---- UPDATE FUEL SURCHARGE ----*
     C           WOBYWG    MULT WN0635    YL0076           SH Fuel Surchar
      * Upd Fuel Charge       RT - Sales History EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0082           Company Number
     C                     Z-ADDWOC4NB    WL0083           Order Number
     C                     Z-ADDWODPNB    WL0084           Order Sequence
     C                     Z-ADDWOUENB    WL0085           Order Secondary
     C                     Z-ADDYL0076    WL0086           SH Fuel Surchar
     C                     EXSR TJRVGN
      * *--- Accumulated Allocated Amount ---*
     C                     ADD  WUONVA    WN0633           USR Remaining B
     C                     ADD  YL0076    YL0077           Fuel Surcharge
     C                     ADD  YL0078    YL0079           Load Total Frei
      * ** Save parms for updating the last detail record for the order
     C                     Z-ADDWOAIC3    WUAIC3           Company Number
     C                     Z-ADDWOC4NB    WUC4NB           Order Number
     C                     Z-ADDWODPNB    WUDPNB           Order Sequence
     C                     Z-ADDWOUENB    WUUENB           Order Secondary
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTG     READE@HSTPUX                  90*
     C                     ENDDO
      * USER: Exit processing
      * *---- UPDATE Actual & Total Freight ----*
      * Update last record with any remaining freight
     C           WUTFAM    SUB  WN0633    WUMFQT           Total Amount
     C                     ADD  WUMFQT    WUONVA           Actual Freight
     C           WN0637    SUB  YL0079    YL0080           Remaining to Ap
     C                     ADD  YL0080    YL0078           OH Total Non-Re
      * CHG Act/Tot Frt Amt   CH - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0076           Company Number
     C                     Z-ADDWUC4NB    WL0077           Order Number
     C                     Z-ADDWUDPNB    WL0078           Order Sequence
     C                     Z-ADDWUUENB    WL0079           Order Secondary
     C                     Z-ADDWUONVA    WL0080           Actual Freight
     C                     Z-ADDYL0078    WL0081           Load Total Frei
     C                     EXSR TICHRC
      * *---- UPDATE FUEL SURCHARGE ----*
     C           WN0636    SUB  YL0077    YL0080           Remaining to Ap
     C                     ADD  YL0080    YL0076           SH Fuel Surchar
      * Upd Fuel Charge       RT - Sales History EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUAIC3    WL0082           Company Number
     C                     Z-ADDWUC4NB    WL0083           Order Number
     C                     Z-ADDWUDPNB    WL0084           Order Sequence
     C                     Z-ADDWUUENB    WL0085           Order Secondary
     C                     Z-ADDYL0076    WL0086           SH Fuel Surchar
     C                     EXSR TJRVGN
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Val Order on Load     RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRRMNB    WQTH02           Load ID
     C           *LIKE     DEFN WRC4NB    WQTH03           Order Number
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH02           Load ID
     C                     KFLD           WQTH03           Order Number
      * Setup key
     C                     Z-ADDWORMNB    WQTH02           Load ID
     C                     Z-ADDWOC4NB    WQTH03           Order Number
      * Establish starting position
     C           KRSTH     SETLL@FLCPKF                    *
     C           KRSTH     READE@FLCPKF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO THEXIT                     *QUIT
     C           KRSTH     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * CHG Act/Tot Frt Amt   CH - Sales History  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0639 20        A/R City
     C                     MOVEL*BLANK    WN0640  2        A/R State
     C                     MOVEL*BLANK    WN0641  6        A/R County Code
     C                     MOVEL*BLANK    WN0642 11        A/R Zip/Postal
     C                     MOVEL*BLANK    WN0643 25        Alpha Search
     C                     MOVEL*BLANK    WN0644  6        Country Code
     C                     MOVEL*BLANK    WN0645  2        Type Code
     C                     Z-ADD*ZERO     WN0646  70       Parent Customer
     C                     Z-ADD*ZERO     WN0647  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0648 30        A/R Customer Na
     C                     Z-ADD*ZERO     WN0649  70       Ship To Custome
     C                     MOVEL*BLANK    WN0650 30        Ship To Name
     C                     MOVEL*BLANK    WN0651 20        Ship To City
     C                     MOVEL*BLANK    WN0652  2        Ship To State C
     C                     MOVEL*BLANK    WN0653 11        Ship To Zip/Pos
     C                     MOVEL*BLANK    WN0654 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0655  70       Order Date
     C                     Z-ADD*ZERO     WN0656  70       Cancel Date
     C                     MOVEL*BLANK    WN0657  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0658  3        Original Salesp
     C                     MOVEL*BLANK    WN0659  2        Manager Level C
     C                     MOVEL*BLANK    WN0660  3        VP Level Code
     C                     MOVEL*BLANK    WN0661  2        Terms Code
     C                     Z-ADD*ZERO     WN0662  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0663  3        Carrier Code
     C                     MOVEL*BLANK    WN0664  3        Order Header Re
     C                     MOVEL*BLANK    WN0665  2        Order Type - Sa
     C                     MOVEL*BLANK    WN0666  2        Shipping Method
     C                     MOVEL*BLANK    WN0667  1        Export Status
     C                     Z-ADD*ZERO     WN0668  70       Attach to Invoi
     C                     Z-ADD*ZERO     WN0669  70       Attach to Order
     C                     Z-ADD*ZERO     WN0670  70       Resell Referenc
     C                     Z-ADD*ZERO     WN0671  70       Original Item
     C                     MOVEL*BLANK    WN0672  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0673 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0674 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0675 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0676 112       Weight Schedule
     C                     MOVEL*BLANK    WN0677  2        U/M - Ordered
     C                     Z-ADD*ZERO     WN0678 114       Unit Price
     C                     Z-ADD*ZERO     WN0679 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0680  2        U/M - Base Pric
     C                     Z-ADD*ZERO     WN0681  70       Requested Ship
     C                     Z-ADD*ZERO     WN0682  70       Invoice Date
     C                     Z-ADD*ZERO     WN0683  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0684 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0685 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0686 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0687 112       Extended Amount
     C                     MOVEL*BLANK    WN0688  1        Affect Inventor
     C                     MOVEL*BLANK    WN0689  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0690  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0691  70       Contract Number
     C                     MOVEL*BLANK    WN0692  6        Export Country
     C                     Z-ADD*ZERO     WN0693  70       LD Arrival Date
     C                     Z-ADD*ZERO     WN0694  40       Accounting Year
     C                     Z-ADD*ZERO     WN0695  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0696  30       OM Week
     C                     Z-ADD*ZERO     WN0697 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0698 112       Weight Billed
     C                     Z-ADD*ZERO     WN0699  70       Shipped Item Co
     C                     Z-ADD*ZERO     WN0700 112       Billing Detail
     C                     Z-ADD*ZERO     WN0701 112       Billing Detail
     C                     Z-ADD*ZERO     WN0702 112       FOB Gross Amoun
     C                     Z-ADD*ZERO     WN0703 112       Standard Overag
     C                     Z-ADD*ZERO     WN0704 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0705  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0706  1        G/L Update Stat
     C                     Z-ADD*ZERO     WN0707  30       Shipping Compan
     C                     MOVEL*BLANK    WN0708  3        Order Detail Re
     C                     Z-ADD*ZERO     WN0709 114       Price Overage O
     C                     MOVEL*BLANK    WN0710  3        Date Method Cod
     C                     MOVEL*BLANK    WN0711  3        Price Method Co
     C                     Z-ADD*ZERO     WN0712  70       Market Pricing
     C                     MOVEL*BLANK    WN0713  3        Commodity Marke
     C                     MOVEL*BLANK    WN0714  2        Quality Level
     C                     MOVEL*BLANK    WN0715  2        Item Level
     C                     Z-ADD*ZERO     WN0716  30       Item Structure
     C                     Z-ADD*ZERO     WN0717  30       Item Structure
     C                     Z-ADD*ZERO     WN0718  30       Item Structure
     C                     Z-ADD*ZERO     WN0719 112       Rated Freight
     C                     Z-ADD*ZERO     WN0720  70       Invoice Number
     C                     MOVEL*BLANK    WN0721  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0722  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0723  70       Load ID
     C                     Z-ADD*ZERO     WN0724  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0725  3        Packaging Code
     C                     MOVEL*BLANK    WN0726  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0727  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0728  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0729  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0730 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0731  3        Item Type Code
     C                     Z-ADD*ZERO     WN0732  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0733  50       PM Line Number
     C                     MOVEL*BLANK    WN0734  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0735  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0736  1        Modified Flag
     C                     Z-ADD*ZERO     WN0737 112       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0738 112       Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WN0739 112       Commission Amou
     C                     Z-ADD*ZERO     WN0740 112       Financials Amou
     C                     Z-ADD*ZERO     WN0741 112       Financials Amou
     C                     MOVEL*BLANK    WN0742  1        Group for Packa
     C                     MOVEL*BLANK    WN0743  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0744  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0745  3        Customer Group
     C                     MOVEL*BLANK    WN0746  3        Customer Group
     C                     Z-ADD*ZERO     WN0747  70       Order Group Cod
     C                     MOVEL*BLANK    WN0748  4        Shipping Zone C
     C                     MOVEL*BLANK    WN0749  1        Process Sts for
     C                     Z-ADD*ZERO     WN0750 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0751 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0752  30       Req Shipping Te
     C                     Z-ADD*ZERO     WN0753  30       Actual Shipping
     C                     MOVEL*BLANK    WN0754  1        Age Code
     C                     Z-ADD*ZERO     WN0755  70       Req Delivery Da
     C                     Z-ADD*ZERO     WN0756  60       Req Delivery Ti
     C                     Z-ADD*ZERO     WN0757  70       MPC Number
     C                     MOVEL*BLANK    WN0758  3        Shipping Line
     C                     MOVEL*BLANK    WN0759 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0760 25        Port City
     C                     MOVEL*BLANK    WN0761 30        Vessel Name
     C                     MOVEL*BLANK    WN0762 12        Booking Number
     C                     Z-ADD*ZERO     WN0763  70       Claim Number
     C                     Z-ADD*ZERO     WN0764  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0765  1        Palletize
     C                     Z-ADD*ZERO     WN0766 114       Commodity Marke
     C                     Z-ADD*ZERO     WN0767 114       Market Value
     C                     Z-ADD*ZERO     WN0768 114       Default Cmdty M
     C                     Z-ADD*ZERO     WN0769 114       Raw Material Co
     C                     MOVEL*BLANK    WN0770  1        Sales Expense P
     C                     Z-ADD*ZERO     WN0771 112       Sales Expense T
     C                     MOVEL*BLANK    WN0772  1        Data Mart Proce
     C                     MOVEL*BLANK    WN0773  1        LH Load Type
     C                     MOVEL*BLANK    WN0774  2        Order TF Exempt
     C                     Z-ADD*ZERO     WN0775  70       LD Sail Date
     C                     Z-ADD*ZERO     WN0776 114       NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WN0777 112       HST Item Target
     C                     MOVEL*BLANK    WN0778  1        EDI Status 1
     C                     MOVEL*BLANK    WN0779  1        EDI Status 2
     C                     MOVEL*BLANK    WN0780  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0781  60       Job Time
     C                     MOVEL*BLANK    WN0782 10        User Id
     C                     MOVEL*BLANK    WN0783 10        Job Name
     C                     Z-ADD*ZERO     WN0784  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FHSTD2
     C                     Z-ADDWL0076    WSAIC3           Company Number
     C                     Z-ADDWL0077    WSC4NB           Order Number
     C                     Z-ADDWL0078    WSDPNB           Order Sequence
     C                     Z-ADDWL0079    WSUENB           Order Secondary
      *
     C           KLCHTI    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
     C                     KFLD           WSDPNB           Order Sequence
     C                     KFLD           WSUENB           Order Secondary
     C           KLCHTI    CHAIN@FHSTD2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHSTPL0'MDACP
     C                     MOVEL'@FHSTD2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHS1    YFRDCS
      * USER: Processing after Data read
     C                     MOVEL'N'       WSISSX           Data Mart Proce
      * Move non-key fields to @FHSTD2
     C                     Z-ADDWL0080    WSONVA           Actual Freight
     C                     Z-ADDWL0081    WSOCFR           Load Total Frei
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WSAXDT           Change Date
     C                     Z-ADD##JTM     WSAATM           Change Time
     C                     MOVEL##USR     WSAYNA           Change User
     C                     MOVEL##PGM     WSA0NA           Change Program
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FHSTD2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHSTPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Upd Fuel Charge       RT - Sales History EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0785  3        SH Price Type
     C                     MOVEL*BLANK    WN0786  1        SH Slip Sheet
     C                     MOVEL*BLANK    WN0787  1        SH Spot Buy Sts
     C                     MOVEL*BLANK    WN0788  1        SH Unused Sts 2
     C                     MOVEL*BLANK    WN0789  2        SH Order Sales
     C                     Z-ADD*ZERO     WN0790  70       SH Price Type R
     C                     MOVEL*BLANK    WN0791 38        Delivery P.O. N
     C                     Z-ADD*ZERO     WN0792  70       SH Firm Date
     C                     Z-ADD*ZERO     WN0793 112       SH Revenue Adju
     C                     Z-ADD*ZERO     WN0794 112       Orig Ord ABS Fr
     C                     Z-ADD*ZERO     WN0795 112       SH Unused Value
     C                     Z-ADD*ZERO     WN0796 114       SH Gate Price
     C                     Z-ADD*ZERO     WN0797 114       SH Gate/Final A
     C                     MOVEL*BLANK    WN0798  1        Record Status
     C                     Z-ADD*ZERO     WN0799  70       Create Date
     C                     Z-ADD*ZERO     WN0800  60       Create Time
     C                     MOVEL*BLANK    WN0801 10        Create User
     C                     MOVEL*BLANK    WN0802 10        Create Program
     C                     Z-ADD*ZERO     WN0803  70       Change Date
     C                     Z-ADD*ZERO     WN0804  60       Change Time
     C                     MOVEL*BLANK    WN0805 10        Change User
     C                     MOVEL*BLANK    WN0806 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTDPNB           Order Sequence
     C                     KFLD           WTUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0082    WTAIC3           Company Number
     C                     Z-ADDWL0083    WTC4NB           Order Number
     C                     Z-ADDWL0084    WTDPNB           Order Sequence
     C                     Z-ADDWL0085    WTUENB           Order Secondary
      * Establish starting position
     C           KRSTJ     CHAIN@D0CPTQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3950' W0RTN   7
      * USER: Processing if Data record not found
      * FP1303 - Delivery P.O. field added
      * W77844 DN 09/14/21-Commented Out & Condition CRTOBJ Below.
      * W77844 DN 09/14/21-Only Create It if Order Sequence Number > 0.
      * CASE: PAR.Order Sequence Number is GT 0
     C           WL0084    IFGT 0                          *IF
      * - This should NOT be happening since the SHE record should have
      *   already been created.
      * - If Order Sequence Number = 0 it means it's a Transfer Order
      *   and we should NOT create the SHE record.
      * Crt Sales History EXT CR - Sales History EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0082    WL0087           Company Number
     C                     Z-ADDWL0083    WL0088           Order Number
     C                     Z-ADDWL0084    WL0089           Order Sequence
     C                     Z-ADDWL0085    WL0090           Order Secondary
     C                     Z-ADDWL0086    WL0091           SH Fuel Surchar
     C                     MOVELWN0785    WL0092    P      SH Price Type
     C                     MOVELWN0786    WL0093    P      SH Slip Sheet
     C                     MOVELWN0787    WL0094    P      SH Spot Buy Sts
     C                     MOVELWN0788    WL0095    P      SH Unused Sts 2
     C                     MOVELWN0789    WL0096    P      SH Order Sales
     C                     Z-ADDWN0790    WL0097           SH Price Type R
     C                     MOVELWN0791    WL0098    P      Delivery P.O. N
     C                     Z-ADDWN0792    WL0099           SH Firm Date
     C                     Z-ADDWN0793    WL0100           SH Revenue Adju
     C                     Z-ADDWN0794    WL0101           Orig Ord ABS Fr
     C                     Z-ADDWN0795    WL0102           SH Unused Value
     C                     Z-ADDWN0796    WL0103           SH Gate Price
     C                     Z-ADDWN0797    WL0104           SH Gate/Final A
     C                     Z-ADD*ZERO     WL0105           SH Unused Date
     C                     Z-ADD*ZERO     WL0106           SH Unused Date
     C                     MOVELYL0081    WL0107    P      SH Unused Statu
     C                     MOVELYL0082    WL0108    P      Invoiced Abs Ov
     C                     MOVEL*BLANK    WL0109           SH Intended for
     C                     MOVELYL0083    WL0110    P      SH Unused Statu
     C                     MOVEL*BLANK    WL0111           SH Unused Text
     C                     MOVEL*BLANK    WL0112           SH Booking Numb
     C                     MOVEL*BLANK    WL0113           SH Genset Numbe
     C                     MOVEL*BLANK    WL0114           SH Unused Text
     C                     Z-ADD*ZERO     WL0115           SH Calendar Wee
     C                     Z-ADD*ZERO     WL0116           SH Unused Numer
     C                     Z-ADD*ZERO     WL0117           SH Calendar Yea
     C                     Z-ADD*ZERO     WL0118           SH Original Ord
     C                     Z-ADD*ZERO     WL0119           SH Unused Numer
     C                     Z-ADD*ZERO     WL0120           SH Unused Numer
     C                     Z-ADD*ZERO     WL0121           SH Unused Numer
     C                     Z-ADD*ZERO     WL0122           SH Unused Numer
     C                     EXSR TKCRRC
     C                     END                             *FI
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Fuel Charge       CH - Sales History EXT  * 
     C                     EXSR TLCHRC
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt Sales History EXT CR - Sales History EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0807  1        Record Status
     C                     Z-ADD*ZERO     WN0808  70       Create Date
     C                     Z-ADD*ZERO     WN0809  60       Create Time
     C                     MOVEL*BLANK    WN0810 10        Create User
     C                     MOVEL*BLANK    WN0811 10        Create Program
     C                     Z-ADD*ZERO     WN0812  70       Change Date
     C                     Z-ADD*ZERO     WN0813  60       Change Time
     C                     MOVEL*BLANK    WN0814 10        Change User
     C                     MOVEL*BLANK    WN0815 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D0CPTP
     C                     Z-ADDWL0087    WVAIC3           Company Number
     C                     Z-ADDWL0088    WVC4NB           Order Number
     C                     Z-ADDWL0089    WVDPNB           Order Sequence
     C                     Z-ADDWL0090    WVUENB           Order Secondary
     C                     Z-ADDWL0091    WVI7VL           SH Fuel Surchar
     C                     MOVELWL0092    WVJXAA           SH Price Type
     C                     MOVELWL0093    WVSHES           SH Slip Sheet
     C                     MOVELWL0094    WVSHS1           SH Spot Buy Sts
     C                     MOVELWL0095    WVSHS2           SH Unused Sts 2
     C                     MOVELWL0096    WVOVTX           SH Order Sales
     C                     Z-ADDWL0097    WVSADT           SH Price Type R
     C                     MOVELWL0098    WVLMT1           Delivery P.O. N
     C                     Z-ADDWL0099    WVSBDT           SH Firm Date
     C                     Z-ADDWL0100    WVI9VL           SH Revenue Adju
     C                     Z-ADDWL0101    WVJAVL           Orig Ord ABS Fr
     C                     Z-ADDWL0102    WVJBVL           SH Unused Value
     C                     Z-ADDWL0103    WVGIPR           SH Gate Price
     C                     Z-ADDWL0104    WVGJPR           SH Gate/Final A
     C                     Z-ADDWL0105    WVTCDT           SH Unused Date
     C                     Z-ADDWL0106    WVTDDT           SH Unused Date
     C                     MOVELWL0107    WVF9ST           SH Unused Statu
     C                     MOVELWL0108    WVGAST           Invoiced Abs Ov
     C                     MOVELWL0109    WVLXAA           SH Intended for
     C                     MOVELWL0110    WVF5ST           SH Unused Statu
     C                     MOVELWL0111    WVWET1           SH Unused Text
     C                     MOVELWL0112    WVWFT1           SH Booking Numb
     C                     MOVELWL0113    WVWGT1           SH Genset Numbe
     C                     MOVELWL0114    WVWHT1           SH Unused Text
     C                     Z-ADDWL0115    WVQRNY           SH Calendar Wee
     C                     Z-ADDWL0116    WVQSNY           SH Unused Numer
     C                     Z-ADDWL0117    WVQNNY           SH Calendar Yea
     C                     Z-ADDWL0118    WVQONY           SH Original Ord
     C                     Z-ADDWL0119    WVQPNY           SH Unused Numer
     C                     Z-ADDWL0120    WVQQNY           SH Unused Numer
     C                     Z-ADDWL0121    WVQTNY           SH Unused Numer
     C                     Z-ADDWL0122    WVQUNY           SH Unused Numer
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WVVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WVMJDT           Create Date
     C                     Z-ADD##JTM     WVBETM           Create Time
     C                     MOVEL##USR     WVCCVN           Create User
     C                     MOVEL##PGM     WVCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WVMKDT           Change Date
     C                     Z-ADD*ZERO     WVBFTM           Change Time
     C                     MOVEL*BLANK    WVCEVN           Change User
     C                     MOVEL*BLANK    WVCFVN           Change Program
     C           KLCRTK    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C                     KFLD           WVDPNB           Order Sequence
     C                     KFLD           WVUENB           Order Secondary
      * Check for duplicate primary key
     C           KLCRTK    SETLL@D0CPTP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3951' W0RTN   7
      * Send message 'Sales History EXT      EX'
     C                     MOVEL'USR3951' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@D0CPTP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Chg Fuel Charge       CH - Sales History EXT  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0816  3        SH Price Type
     C                     MOVEL*BLANK    WN0817  1        SH Slip Sheet
     C                     MOVEL*BLANK    WN0818  1        SH Spot Buy Sts
     C                     MOVEL*BLANK    WN0819  1        SH Unused Sts 2
     C                     MOVEL*BLANK    WN0820  2        SH Order Sales
     C                     Z-ADD*ZERO     WN0821  70       SH Price Type R
     C                     MOVEL*BLANK    WN0822 38        Delivery P.O. N
     C                     Z-ADD*ZERO     WN0823  70       SH Firm Date
     C                     Z-ADD*ZERO     WN0824 112       SH Revenue Adju
     C                     Z-ADD*ZERO     WN0825 112       Orig Ord ABS Fr
     C                     Z-ADD*ZERO     WN0826 112       SH Unused Value
     C                     Z-ADD*ZERO     WN0827 114       SH Gate Price
     C                     Z-ADD*ZERO     WN0828 114       SH Gate/Final A
     C                     MOVEL*BLANK    WN0829  1        Record Status
     C                     Z-ADD*ZERO     WN0830  70       Create Date
     C                     Z-ADD*ZERO     WN0831  60       Create Time
     C                     MOVEL*BLANK    WN0832 10        Create User
     C                     MOVEL*BLANK    WN0833 10        Create Program
     C                     Z-ADD*ZERO     WN0834  70       Change Date
     C                     Z-ADD*ZERO     WN0835  60       Change Time
     C                     MOVEL*BLANK    WN0836 10        Change User
     C                     MOVEL*BLANK    WN0837 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @D0CPTP
     C                     Z-ADDWL0082    WVAIC3           Company Number
     C                     Z-ADDWL0083    WVC4NB           Order Number
     C                     Z-ADDWL0084    WVDPNB           Order Sequence
     C                     Z-ADDWL0085    WVUENB           Order Secondary
      *
     C           KLCHTL    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C                     KFLD           WVDPNB           Order Sequence
     C                     KFLD           WVUENB           Order Secondary
     C           KLCHTL    CHAIN@D0CPTP              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMD0CPL0'MDACP
     C                     MOVEL'@D0CPTP' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMD01    YGRDCS
      * Move non-key fields to @D0CPTP
     C                     Z-ADDWL0086    WVI7VL           SH Fuel Surchar
     C                     Z-ADDWTTCDT    WVTCDT           SH Unused Date
     C                     Z-ADDWTTDDT    WVTDDT           SH Unused Date
     C                     MOVELWTF9ST    WVF9ST    P      SH Unused Statu
     C                     MOVELWTGAST    WVGAST    P      Invoiced Abs Ov
     C                     MOVELWTLXAA    WVLXAA    P      SH Intended for
     C                     MOVELWTF5ST    WVF5ST    P      SH Unused Statu
     C                     MOVELWTWET1    WVWET1    P      SH Unused Text
     C                     MOVELWTWFT1    WVWFT1    P      SH Booking Numb
     C                     MOVELWTWGT1    WVWGT1    P      SH Genset Numbe
     C                     MOVELWTWHT1    WVWHT1    P      SH Unused Text
     C                     Z-ADDWTQRNY    WVQRNY           SH Calendar Wee
     C                     Z-ADDWTQSNY    WVQSNY           SH Unused Numer
     C                     Z-ADDWTQNNY    WVQNNY           SH Calendar Yea
     C                     Z-ADDWTQONY    WVQONY           SH Original Ord
     C                     Z-ADDWTQPNY    WVQPNY           SH Unused Numer
     C                     Z-ADDWTQQNY    WVQQNY           SH Unused Numer
     C                     Z-ADDWTQTNY    WVQTNY           SH Unused Numer
     C                     Z-ADDWTQUNY    WVQUNY           SH Unused Numer
      *
      * Set PGM.*Record Data Changed flag
     C           QPMD01    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WVMKDT           Change Date
     C                     Z-ADD##JTM     WVBFTM           Change Time
     C                     MOVEL##USR     WVCEVN           Change User
     C                     MOVEL##PGM     WVCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMD01    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@D0CPTP                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMD0CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * RTV Air&Actual Freight RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUTFAM           Total Freight A
     C                     Z-ADD*ZERO     WN0637           OH Total Non-Re
     C                     Z-ADD*ZERO     WN0636           OH Fuel Surchar
      * ***** Change Log and Comments
      * ** Prevent divide by zero               11/27/2006 LJB V61127A
      * *****
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHRMNB    WQTM02           Load ID
     C           *LIKE     DEFN WHC4NB    WQTM03           Order Number
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM02           Load ID
     C                     KFLD           WQTM03           Order Number
      * Setup key
     C                     Z-ADDWORMNB    WQTM02           Load ID
     C                     Z-ADDWOC4NB    WQTM03           Order Number
      * Establish starting position
     C           KRSTM     SETLL@BFCPRQ                    *
     C           KRSTM     READE@BFCPRQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUTFAM           Total Freight A
     C                     Z-ADD*ZERO     WN0631           USR Work Percen
     C                     Z-ADD*ZERO     WN0635           Fuel Surcharge
     C                     Z-ADD*ZERO     WN0636           OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0637           OH Total Non-Re
     C                     Z-ADD*ZERO     WN0638           Load Total Frei
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WHH1NX    ADD  WHH0NX    WUTFAM           Total Freight A
     C                     Z-ADDWHH2NX    WN0636           OH Fuel Surchar
     C           WHH3NX    ADD  WHH4NX    WN0637           OH Total Non-Re
      * ** Prevent divide by zero               11/27/2006 LJB V61127A
      * ** Calc percent - plug in zeros if db1.order weight total is zero
      * CASE: DB1.Order Weight Total is Not equal zero
     C           WHA1WG    IFNE 0                          *IF
     C           WUTFAM    DIV  WHA1WG    WN0631    H      USR Work Percen
     C           WHH2NX    DIV  WHA1WG    WN0635    H      Fuel Surcharge
     C           WN0637    DIV  WHA1WG    WN0638    H      Load Total Frei
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0631           USR Work Percen
     C                     Z-ADD*ZERO     WN0635           Fuel Surcharge
     C                     Z-ADD*ZERO     WN0638           Load Total Frei
     C                     END                             *FI
     C           KRSTM     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** Notes:
      * ** Only process freight records if Actual Freight Include
      * ** Sts = Y and Reference Required = Y.
      * ** Accumulate ref charge code amounts for the ship to customer
      * ** (reference) and pass out the total so it can be deducted
      * ** from the Total Actual Freight Amount for the Load ID.
      * ** The remainder of the Total Actual Freight Amount
      * ** will be allocated by Incremental Miles. (as it is done now)
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * R8827 JJH 01/18/17 - Correct Load Freight Allocation Calculation
      * - Get MG Created Load from Load Header
      * - Modify calculation of Incremental Miles.  If Mercury Gate creat
      *   use Miles to next stop from Load Detail, otherwise Increment mi
      * ** Calculations to get the total pound miles used in next calc
      * ** 1. Retrieve the order weight from the order header
      * ** 2. If stop/drop is different, add Miles to Next to Incremental
      * **    Miles
      * **    (this will be zeros if there was no Miles Between Cities re
      * ** 3. Default Incremental Miles to 1 if it is zeros
      * ** 4. Multiply Order Weight by Incremental Miles to get pound-mil
      * ** 5. Add Lbs-Miles to total pound-miles (Total Lbs-Miles)
      * ** 6. Return Total Lbs-Miles for next part of calculations
      * ** 03/10/2008 LJB FP1271
      * ** After db calcs, if incremental miles is zeros, default to 1.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * R8827 JJH 01/18/17 - Correct Load Freight Allocation Calculation
      * - Get MG Created Load from Load Header
      * - Modify calculation of Incremental Miles.  If Mercury Gate creat
      *   use Miles to next stop from Load Detail, otherwise Increment mi
      * ** 3/10/08 LJB FP1271
      * ** If incremental miles is zeros, default to 1.
      * ** Calculations to get the order allocation % to use to
      * ** calculate the Allocated Freight Amount
      * ** 1. Retrieve the order weight from the order header
      * ** 2. If stop/drop is different, add Miles to Next to Incremental
      * **    Miles
      * ** 3. If incremental miles is zeros, default to 1
      * ** 4. Multiply Order Weight by Incremental Miles to get Lbs-Miles
      * ** 5. Divide the Lbs-Miles by the Total Lbs-Miles to get the
      * **    Order Allocation %
      * ** 6. Multiply Balance Air Freight Amount by Order Allocation% to
      * **    get the Allocated Freight Amount for this order.
      * ** 7. Update the Order Header with the Allocated Freight Amount
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 08/26/2009 LJB E00157-Prompt OHE chg for newly added parms
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Total Weight Work
     C                     Z-ADD*ZERO     WUBMNB 130
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAEPNY           LFC Sequence Nu
     C                     Z-ADD*ZERO     WAC5VL           LFC Amount
     C                     Z-ADD*ZERO     WAEQNY           LFC TFP Carrier
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDEPNY           LFC Sequence Nu
     C                     Z-ADD*ZERO     WDKBNY           LFCR Numeric Va
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFL8VA           Billing Detail
     C                     Z-ADD*ZERO     WFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WFATWG           Weight Shipped
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WFNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WFBXTM           Substitution Li
     C                     Z-ADD*ZERO     WFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WFH7NX           OD Item Target
     C                     Z-ADD*ZERO     WFH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WFDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WFDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WFDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WFDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WFDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WFGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WFRINY           Item Age Days
     C                     Z-ADD*ZERO     WFTIDT           Production Ovr
     C                     Z-ADD*ZERO     WFTJDT           Production Ovr
     C                     Z-ADD*ZERO     WFTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WFTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WFTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WGRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WGRWNB           Miles to next s
     C                     Z-ADD*ZERO     WGRXNB           Freight Charge
     C                     Z-ADD*ZERO     WGSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WGT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WGT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WGSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WGKFDT           Appointment Con
     C                     Z-ADD*ZERO     WGACTM           Appointment Con
     C                     Z-ADD*ZERO     WGEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WGAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WGKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WGATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WGHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WGAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGKKDT           On Yard Date
     C                     Z-ADD*ZERO     WGAVTM           On Yard Time
     C                     Z-ADD*ZERO     WGZ4NB           MPC Number
     C                     Z-ADD*ZERO     WGN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WGN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WGN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WGB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WGB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WGB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Bal Act Freight Amt USR
     C                     Z-ADD*ZERO     WUEKNY 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJRMNB           Load ID
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WJRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WJFLAM           Flat Amount
     C                     Z-ADD*ZERO     WJRRNB           Total Stops
     C                     Z-ADD*ZERO     WJSBNB           BOL Time
     C                     Z-ADD*ZERO     WJSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJSDNB           Number Pallets
     C                     Z-ADD*ZERO     WJPAOU           Number Pallets
     C                     Z-ADD*ZERO     WJDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WJSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WJHADT           Actual Arrival
     C                     Z-ADD*ZERO     WJAART           Actual Arrival
     C                     Z-ADD*ZERO     WJDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WJDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WJAQDT           Actual Departur
     C                     Z-ADD*ZERO     WJS6NB           Departure Time
     C                     Z-ADD*ZERO     WJT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WJPRTM           Product Tempera
     C                     Z-ADD*ZERO     WJNPSV           Number Spacers
     C                     Z-ADD*ZERO     WJTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WJGRWE           Gross Weight
     C                     Z-ADD*ZERO     WJF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WJJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WJTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WJJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WJSPTM           Spotted Time
     C                     Z-ADD*ZERO     WJJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WJLFTM           Load Finished T
     C                     Z-ADD*ZERO     WJJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WJBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WJJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WJBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WJKIDT           Truck Departure
     C                     Z-ADD*ZERO     WJASTM           Truck Departure
     C                     Z-ADD*ZERO     WJKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WJAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WJVOAG           Voyage
     C                     Z-ADD*ZERO     WJKBDT           Sail Date
     C                     Z-ADD*ZERO     WJEFDT           Arrival Date
     C                     Z-ADD*ZERO     WJKCDT           Date In
     C                     Z-ADD*ZERO     WJTMIN           Time In
     C                     Z-ADD*ZERO     WJKDDT           Date Out
     C                     Z-ADD*ZERO     WJVMNB           Time Out
     C                     Z-ADD*ZERO     WJOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WJKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WJATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WJBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WJEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WJKKDT           On Yard Date
     C                     Z-ADD*ZERO     WJAVTM           On Yard Time
     C                     Z-ADD*ZERO     WJKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WJAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WJLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WJK0DT           Product Complet
     C                     Z-ADD*ZERO     WJAYTM           Product Complet
     C                     Z-ADD*ZERO     WJKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WJICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WJIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WJK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WJAZTM           Load Door 1
     C                     Z-ADD*ZERO     WJK2DT           Override Total
     C                     Z-ADD*ZERO     WJA0TM           Load Door 2
     C                     Z-ADD*ZERO     WJZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WJPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WJCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WJPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WJCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WJP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WJCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WJP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WJCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WJP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WJCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WJP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WJCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Lbs-Miles USR
     C                     Z-ADD*ZERO     WUEMNY 152
      * Define work field Total Lbs-Miles USR
     C                     Z-ADD*ZERO     WUENNY 152
      * Define work field Order Allocation % USR
     C                     Z-ADD*ZERO     WUGCPC  65
      * Define work field Act Non-Ref Frt Amount
     C                     Z-ADD*ZERO     WUH1NX 112
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Order Number
     C                     Z-ADD*ZERO     WUC4NB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOC4NB           Order Number
     C                     Z-ADD*ZERO     WODPNB           Order Sequence
     C                     Z-ADD*ZERO     WOUENB           Order Secondary
     C                     Z-ADD*ZERO     WOBTC7           Parent Customer
     C                     Z-ADD*ZERO     WOANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WOBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WOA0DT           Order Date
     C                     Z-ADD*ZERO     WOACDT           Cancel Date
     C                     Z-ADD*ZERO     WOTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WOATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WOT3NB           Attach to Order
     C                     Z-ADD*ZERO     WORSRN           Resell Referenc
     C                     Z-ADD*ZERO     WOORIT           Original Item
     C                     Z-ADD*ZERO     WOAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WOD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WOCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WOAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WOAKPR           Unit Price
     C                     Z-ADD*ZERO     WOAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WOA5DT           Requested Ship
     C                     Z-ADD*ZERO     WOAWDT           Invoice Date
     C                     Z-ADD*ZERO     WOHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WOAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WOAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WOAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WOAYVA           Extended Amount
     C                     Z-ADD*ZERO     WOL6NB           Contract Number
     C                     Z-ADD*ZERO     WOHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WOESNB           Accounting Year
     C                     Z-ADD*ZERO     WOETNB           Accounting Peri
     C                     Z-ADD*ZERO     WOBZNB           OM Week
     C                     Z-ADD*ZERO     WOEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WOBYWG           Weight Billed
     C                     Z-ADD*ZERO     WOS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WOMAVA           Billing Detail
     C                     Z-ADD*ZERO     WOKDVA           Billing Detail
     C                     Z-ADD*ZERO     WOUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WOUTVA           Standard Overag
     C                     Z-ADD*ZERO     WOA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WOCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WOR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WOBZPR           Price Overage O
     C                     Z-ADD*ZERO     WOEXDT           Market Pricing
     C                     Z-ADD*ZERO     WORGNB           Item Structure
     C                     Z-ADD*ZERO     WORHNB           Item Structure
     C                     Z-ADD*ZERO     WORINB           Item Structure
     C                     Z-ADD*ZERO     WOR1NB           Rated Freight
     C                     Z-ADD*ZERO     WOCONB           Invoice Number
     C                     Z-ADD*ZERO     WOGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WORMNB           Load ID
     C                     Z-ADD*ZERO     WOAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WOSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WOSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WOSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WOONVA           Actual Freight
     C                     Z-ADD*ZERO     WOB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WOB5NB           PM Line Number
     C                     Z-ADD*ZERO     WOGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WOULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WOUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WOUOVA           Commission Amou
     C                     Z-ADD*ZERO     WOUPVA           Financials Amou
     C                     Z-ADD*ZERO     WOUQVA           Financials Amou
     C                     Z-ADD*ZERO     WOCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WODUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WOB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WOIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WOIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WONYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WOBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WOZ4NB           MPC Number
     C                     Z-ADD*ZERO     WOOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WOC0C7           Claim Number
     C                     Z-ADD*ZERO     WOA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WOA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WOCDPR           Market Value
     C                     Z-ADD*ZERO     WOD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WOD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WOCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WOOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WOD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WOCFVL           HST Item Target
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field Actual Freight Amount
     C                     Z-ADD*ZERO     WUONVA 112
      * Define work field USR Amount Remaining
     C                     Z-ADD*ZERO     WUU7VA 112
      * Define work field Total Amount
     C                     Z-ADD*ZERO     WUMFQT 112
      * Define work field Total Freight Amount 13.2
     C                     Z-ADD*ZERO     WUTFAM 132
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Define work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     WUUENB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTC4NB           Order Number
     C                     Z-ADD*ZERO     WTDPNB           Order Sequence
     C                     Z-ADD*ZERO     WTUENB           Order Secondary
     C                     Z-ADD*ZERO     WTI7VL           SH Fuel Surchar
     C                     Z-ADD*ZERO     WTSADT           SH Price Type R
     C                     Z-ADD*ZERO     WTSBDT           SH Firm Date
     C                     Z-ADD*ZERO     WTI9VL           SH Revenue Adju
     C                     Z-ADD*ZERO     WTJAVL           Orig Ord ABS Fr
     C                     Z-ADD*ZERO     WTJBVL           SH Unused Value
     C                     Z-ADD*ZERO     WTGIPR           SH Gate Price
     C                     Z-ADD*ZERO     WTGJPR           SH Gate/Final A
     C                     Z-ADD*ZERO     WTTCDT           SH Unused Date
     C                     Z-ADD*ZERO     WTTDDT           SH Unused Date
     C                     Z-ADD*ZERO     WTQRNY           SH Calendar Wee
     C                     Z-ADD*ZERO     WTQSNY           SH Unused Numer
     C                     Z-ADD*ZERO     WTQNNY           SH Calendar Yea
     C                     Z-ADD*ZERO     WTQONY           SH Original Ord
     C                     Z-ADD*ZERO     WTQPNY           SH Unused Numer
     C                     Z-ADD*ZERO     WTQQNY           SH Unused Numer
     C                     Z-ADD*ZERO     WTQTNY           SH Unused Numer
     C                     Z-ADD*ZERO     WTQUNY           SH Unused Numer
     C                     Z-ADD*ZERO     WTMJDT           Create Date
     C                     Z-ADD*ZERO     WTBETM           Create Time
     C                     Z-ADD*ZERO     WTMKDT           Change Date
     C                     Z-ADD*ZERO     WTBFTM           Change Time
      * Clear all neither parameters
      * Crt Sales History EXT CR - Sales History EXT  * 
     C                     Z-ADD*ZERO     WVMJDT           Create Date
     C                     Z-ADD*ZERO     WVBETM           Create Time
     C                     Z-ADD*ZERO     WVMKDT           Change Date
     C                     Z-ADD*ZERO     WVBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  6
     C                     MOVEL*BLANK    WL0005  1
     C                     Z-ADD*ZERO     WL0006 155
     C                     MOVEL*BLANK    WL0007 40
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010 130
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013 130
     C                     Z-ADD*ZERO     WL0014  72
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
      * Define local variables for subroutine SGCHRC.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019 112
      * Define local variables for subroutine SHCHRC.
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022 112
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024  2
     C                     Z-ADD*ZERO     WL0025 130
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  2
     C                     Z-ADD*ZERO     WL0028 130
     C                     Z-ADD*ZERO     WL0029  72
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033  2
     C                     MOVEL*BLANK    WL0034 20
     C                     Z-ADD*ZERO     WL0035 130
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  2
     C                     MOVEL*BLANK    WL0038 20
     C                     Z-ADD*ZERO     WL0039 130
     C                     Z-ADD*ZERO     WL0040  72
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0043  70
     C                     MOVEL*BLANK    WL0044  3
     C                     Z-ADD*ZERO     WL0045 130
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0046  30
     C                     Z-ADD*ZERO     WL0047  70
     C                     Z-ADD*ZERO     WL0048  30
     C                     Z-ADD*ZERO     WL0049  30
     C                     MOVEL*BLANK    WL0050  3
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0051  70
     C                     MOVEL*BLANK    WL0052  3
     C                     Z-ADD*ZERO     WL0053 130
     C                     Z-ADD*ZERO     WL0054  72
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0057  30
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059 112
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061  70
     C                     Z-ADD*ZERO     WL0062 112
     C                     MOVEL*BLANK    WL0063  1
     C                     MOVEL*BLANK    WL0064  1
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0065  30
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067 112
     C                     Z-ADD*ZERO     WL0068 112
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0069  70
     C                     MOVEL*BLANK    WL0070  1
      * Define local variables for subroutine TFCHRC.
     C                     Z-ADD*ZERO     WL0071  30
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073 112
     C                     Z-ADD*ZERO     WL0074 112
     C                     Z-ADD*ZERO     WL0075 112
      * Define local variables for subroutine TICHRC.
     C                     Z-ADD*ZERO     WL0076  30
     C                     Z-ADD*ZERO     WL0077  70
     C                     Z-ADD*ZERO     WL0078  30
     C                     Z-ADD*ZERO     WL0079  30
     C                     Z-ADD*ZERO     WL0080 112
     C                     Z-ADD*ZERO     WL0081 112
      * Define local variables for subroutine TJRVGN.
     C                     Z-ADD*ZERO     WL0082  30
     C                     Z-ADD*ZERO     WL0083  70
     C                     Z-ADD*ZERO     WL0084  30
     C                     Z-ADD*ZERO     WL0085  30
     C                     Z-ADD*ZERO     WL0086 112
      * Define local variables for subroutine TKCRRC.
     C                     Z-ADD*ZERO     WL0087  30
     C                     Z-ADD*ZERO     WL0088  70
     C                     Z-ADD*ZERO     WL0089  30
     C                     Z-ADD*ZERO     WL0090  30
     C                     Z-ADD*ZERO     WL0091 112
     C                     MOVEL*BLANK    WL0092  3
     C                     MOVEL*BLANK    WL0093  1
     C                     MOVEL*BLANK    WL0094  1
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  2
     C                     Z-ADD*ZERO     WL0097  70
     C                     MOVEL*BLANK    WL0098 38
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100 112
     C                     Z-ADD*ZERO     WL0101 112
     C                     Z-ADD*ZERO     WL0102 112
     C                     Z-ADD*ZERO     WL0103 114
     C                     Z-ADD*ZERO     WL0104 114
     C                     Z-ADD*ZERO     WL0105  70
     C                     Z-ADD*ZERO     WL0106  70
     C                     MOVEL*BLANK    WL0107  2
     C                     MOVEL*BLANK    WL0108  2
     C                     MOVEL*BLANK    WL0109  6
     C                     MOVEL*BLANK    WL0110  6
     C                     MOVEL*BLANK    WL0111 10
     C                     MOVEL*BLANK    WL0112 15
     C                     MOVEL*BLANK    WL0113 30
     C                     MOVEL*BLANK    WL0114 50
     C                     Z-ADD*ZERO     WL0115  30
     C                     Z-ADD*ZERO     WL0116  30
     C                     Z-ADD*ZERO     WL0117  50
     C                     Z-ADD*ZERO     WL0118  50
     C                     Z-ADD*ZERO     WL0119  60
     C                     Z-ADD*ZERO     WL0120  60
     C                     Z-ADD*ZERO     WL0121  90
     C                     Z-ADD*ZERO     WL0122  90
      * Define local work field Total Freight USR
     C                     Z-ADD*ZERO     YL0001  72
      * Define local work field Load Total Freight
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field Total Amount
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field USR Percent Work, 7.4   1
     C                     Z-ADD*ZERO     YL0004  74
      * Define local work field USR Work Percent 7/6
     C                     Z-ADD*ZERO     YL0005  96
      * Define local work field Reference Req Freight Amt
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Act Frt Ref Amt USR
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Tot Frt Ref Amt USR
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field USR Text 7            USR
     C                     MOVEL*BLANK    YL0011  7
      * Define local work field LFC Amount
     C                     Z-ADD*ZERO     YL0012  72
      * Define local work field Freight Rate USR
     C                     Z-ADD*ZERO     YL0013  94
      * Define local work field Freight Amount
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YL0015 112
      * Define local work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YL0016 112
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field LFC Amount
     C                     Z-ADD*ZERO     YL0018  72
      * Define local work field Freight Rate USR
     C                     Z-ADD*ZERO     YL0019  94
      * Define local work field Freight Amount
     C                     Z-ADD*ZERO     YL0020 112
      * Define local work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YL0021 112
      * Define local work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YL0022 112
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0023 20
      * Define local work field LFC Amount
     C                     Z-ADD*ZERO     YL0024  72
      * Define local work field Freight Rate USR
     C                     Z-ADD*ZERO     YL0025  94
      * Define local work field Freight Amount
     C                     Z-ADD*ZERO     YL0026 112
      * Define local work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YL0028 112
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0029  3
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0030  3
      * Define local work field LFC Amount
     C                     Z-ADD*ZERO     YL0031  72
      * Define local work field Freight Rate USR
     C                     Z-ADD*ZERO     YL0032  94
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0033  3
      * Define local work field Freight Amount
     C                     Z-ADD*ZERO     YL0034 112
      * Define local work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YL0035 112
      * Define local work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YL0036 112
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0037  30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0038  70
      * Define local work field Stop/Drop
     C                     Z-ADD*ZERO     YL0039  50
      * Define local work field USR Work Field 5A     USR
     C                     MOVEL*BLANK    YL0040  5
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0041 112
      * Define local work field LFC Amount
     C                     Z-ADD*ZERO     YL0042  72
      * Define local work field Freight Rate USR
     C                     Z-ADD*ZERO     YL0043  94
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0044 112
      * Define local work field Freight Amount
     C                     Z-ADD*ZERO     YL0045 112
      * Define local work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YL0046 112
      * Define local work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YL0047 112
      * Define local work field Bal Load Total Frt USR
     C                     Z-ADD*ZERO     YL0048 112
      * Define local work field LFC Spc Typ=E Amt USR
     C                     Z-ADD*ZERO     YL0049  72
      * Define local work field LFC Spc Typ=E Amt USR
     C                     Z-ADD*ZERO     YL0050  72
      * Define local work field LFC Spc Typ=E Amt USR
     C                     Z-ADD*ZERO     YL0051  72
      * Define local work field Total Stops
     C                     Z-ADD*ZERO     YL0052  50
      * Define local work field LFC Spc Typ=E Amt Stp USR
     C                     Z-ADD*ZERO     YL0053  72
      * Define local work field LFC Spc Typ=E Amt Rem USR
     C                     Z-ADD*ZERO     YL0054  72
      * Define local work field LFC Spc Typ=E Amt Stp1USR
     C                     Z-ADD*ZERO     YL0055  72
      * Define local work field First Stop USR
     C                     MOVEL*BLANK    YL0056  1
      * Define local work field Stop/Drop
     C                     Z-ADD*ZERO     YL0057  50
      * Define local work field Load/Stop Ord Cnt USR
     C                     Z-ADD*ZERO     YL0058  50
      * Define local work field Load/Stop Ord Cnt USR
     C                     Z-ADD*ZERO     YL0059  50
      * Define local work field LFC Spc Typ=E Amt Ord USR
     C                     Z-ADD*ZERO     YL0060  72
      * Define local work field LFC Spc Typ=E Amt Ord1USR
     C                     Z-ADD*ZERO     YL0061  72
      * Define local work field LFC Spc Typ=E Amt Rem1USR
     C                     Z-ADD*ZERO     YL0062  72
      * Define local work field LFC Spc Typ=E Amt Rem USR
     C                     Z-ADD*ZERO     YL0063  72
      * Define local work field First Order USR
     C                     MOVEL*BLANK    YL0064  1
      * Define local work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YL0065 112
      * Define local work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YL0066 112
      * Define local work field MG Created Load
     C                     MOVEL*BLANK    YL0067  1
      * Define local work field MG Created Load
     C                     MOVEL*BLANK    YL0068  1
      * Define local work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YL0069 112
      * Define local work field OH Total Non-Ref Frt Amt
     C                     Z-ADD*ZERO     YL0070 112
      * Define local work field Total Amount
     C                     Z-ADD*ZERO     YL0071 112
      * Define local work field Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YL0072  72
      * Define local work field Load Total Freight
     C                     Z-ADD*ZERO     YL0073 112
      * Define local work field Freight Amount
     C                     Z-ADD*ZERO     YL0074 112
      * Define local work field Remaining to Apply
     C                     Z-ADD*ZERO     YL0075 112
      * Define local work field SH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YL0076 112
      * Define local work field Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YL0077  72
      * Define local work field OH Total Non-Ref Frt Amt
     C                     Z-ADD*ZERO     YL0078 112
      * Define local work field Load Total Freight USR
     C                     Z-ADD*ZERO     YL0079 112
      * Define local work field Remaining to Apply
     C                     Z-ADD*ZERO     YL0080 112
      * Define local work field SH Unused Status 2 2
     C                     MOVEL*BLANK    YL0081  2
      * Define local work field Invoiced Abs Ovrde Reason
     C                     MOVEL*BLANK    YL0082  2
      * Define local work field SH Unused Status 6 1
     C                     MOVEL*BLANK    YL0083  6
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 SHIPTO
00002 CITYST
00003 Y2U0005
