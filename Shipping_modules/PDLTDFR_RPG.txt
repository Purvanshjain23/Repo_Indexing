     H/TITLE Edt Load/Orders        DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/07/21  Time  : 10:18:29
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDLTDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Edt Load/Orders        DF Display file
      *
     FOPBFCPL8IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOPBGWKLGIF  E           K        DISK
      * RTV : Order Detail              Retrieval Index Opn Ords
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FOMFLCPL8IF  E           K        DISK
      * RSQ : Load Detail               Co/Order
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FCAB0REL0IF  E           K        DISK                      A
      * UPD : Item Balance              Update index
      *
     E                    #L7         7  1
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 015  5 0A
     E                    W0END   7 015  5 0A
     E                    W0NAM   7 015 10
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@BGWKKH
      * Order Detail              Retrieval Index Opn Ords
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WGRMNB
     I              FJAIC3                          WGAIC3
     I              FJAODT                          WGAODT
     I              FJPJST                          WGPJST
     I              FJPKST                          WGPKST
     I              FJRNNB                          WGRNNB
     I              FJDMTX                          WGDMTX
     I              FJDNTX                          WGDNTX
     I              FJDOTX                          WGDOTX
     I              FJWTTX                          WGWTTX
     I              FJWUTX                          WGWUTX
     I              FJRPNB                          WGRPNB
     I              FJFLAM                          WGFLAM
     I              FJXQST                          WGXQST
     I              FJRRNB                          WGRRNB
     I              FJDXTX                          WGDXTX
     I              FJDYTX                          WGDYTX
     I              FJSBNB                          WGSBNB
     I              FJBZNA                          WGBZNA
     I              FJRONB                          WGRONB
     I              FJSQNB                          WGSQNB
     I              FJR1NB                          WGR1NB
     I              FJVCST                          WGVCST
     I              FJVDST                          WGVDST
     I              FJSDNB                          WGSDNB
     I              FJPAOU                          WGPAOU
     I              FJDGWG                          WGDGWG
     I              FJSXNB                          WGSXNB
     I              FJHADT                          WGHADT
     I              FJAART                          WGAART
     I              FJDHWG                          WGDHWG
     I              FJDIWG                          WGDIWG
     I              FJAQDT                          WGAQDT
     I              FJS6NB                          WGS6NB
     I              FJT4NB                          WGT4NB
     I              FJPRTM                          WGPRTM
     I              FJNPSV                          WGNPSV
     I              FJJ8TX                          WGJ8TX
     I              FJTLMI                          WGTLMI
     I              FJJ9TX                          WGJ9TX
     I              FJQ2CD                          WGQ2CD
     I              FJVPCD                          WGVPCD
     I              FJDBCD                          WGDBCD
     I              FJGRWE                          WGGRWE
     I              FJXCCD                          WGXCCD
     I              FJU2ST                          WGU2ST
     I              FJF9DT                          WGF9DT
     I              FJONTM                          WGONTM
     I              FJJ4DT                          WGJ4DT
     I              FJTRTM                          WGTRTM
     I              FJJ5DT                          WGJ5DT
     I              FJSPTM                          WGSPTM
     I              FJJ6DT                          WGJ6DT
     I              FJLFTM                          WGLFTM
     I              FJJ7DT                          WGJ7DT
     I              FJBOTM                          WGBOTM
     I              FJJ8DT                          WGJ8DT
     I              FJBLTM                          WGBLTM
     I              FJKIDT                          WGKIDT
     I              FJASTM                          WGASTM
     I              FJKADT                          WGKADT
     I              FJAJCM                          WGAJCM
     I              FJXACD                          WGXACD
     I              FJOANA                          WGOANA
     I              FJK4TX                          WGK4TX
     I              FJVOAG                          WGVOAG
     I              FJKBDT                          WGKBDT
     I              FJNBBO                          WGNBBO
     I              FJW4CD                          WGW4CD
     I              FJEFDT                          WGEFDT
     I              FJCNTN                          WGCNTN
     I              FJKCDT                          WGKCDT
     I              FJTMIN                          WGTMIN
     I              FJKDDT                          WGKDDT
     I              FJVMNB                          WGVMNB
     I              FJOCFR                          WGOCFR
     I              FJKJDT                          WGKJDT
     I              FJATTM                          WGATTM
     I              FJOTRS                          WGOTRS
     I              FJRNST                          WGRNST
     I              FJBRBK                          WGBRBK
     I              FJEIDT                          WGEIDT
     I              FJRMST                          WGRMST
     I              FJAJCD                          WGAJCD
     I              FJKKDT                          WGKKDT
     I              FJAVTM                          WGAVTM
     I              FJKZDT                          WGKZDT
     I              FJAXTM                          WGAXTM
     I              FJLHOS                          WGLHOS
     I              FJLHOR                          WGLHOR
     I              FJWNTX                          WGWNTX
     I              FJOITX                          WGOITX
     I              FJOJTX                          WGOJTX
     I              FJLLDT                          WGLLDT
     I              FJLSHG                          WGLSHG
     I              FJYPST                          WGYPST
     I              FJK0DT                          WGK0DT
     I              FJAYTM                          WGAYTM
     I              FJKNNX                          WGKNNX
     I              FJICWG                          WGICWG
     I              FJIDWG                          WGIDWG
     I              FJH9SX                          WGH9SX
     I              FJWOTX                          WGWOTX
     I              FJK1DT                          WGK1DT
     I              FJAZTM                          WGAZTM
     I              FJK2DT                          WGK2DT
     I              FJA0TM                          WGA0TM
     I              FJROST                          WGROST
     I              FJRPST                          WGRPST
     I              FJRQST                          WGRQST
     I              FJRRST                          WGRRST
     I              FJZBVA                          WGZBVA
     I              FJWPTX                          WGWPTX
     I              FJWQTX                          WGWQTX
     I              FJWRTX                          WGWRTX
     I              FJWSTX                          WGWSTX
     I              FJRVSX                          WGRVSX
     I              FJRUSX                          WGRUSX
     I              FJRWSX                          WGRWSX
     I              FJRXSX                          WGRXSX
     I              FJRYSX                          WGRYSX
     I              FJRZSX                          WGRZSX
     I              FJR0SX                          WGR0SX
     I              FJR1SX                          WGR1SX
     I              FJR2SX                          WGR2SX
     I              FJR3SX                          WGR3SX
     I              FJR4SX                          WGR4SX
     I              FJPYDT                          WGPYDT
     I              FJCKTM                          WGCKTM
     I              FJPZDT                          WGPZDT
     I              FJCLTM                          WGCLTM
     I              FJP0DT                          WGP0DT
     I              FJCMTM                          WGCMTM
     I              FJP1DT                          WGP1DT
     I              FJCNTM                          WGCNTM
     I              FJP2DT                          WGP2DT
     I              FJCOTM                          WGCOTM
     I              FJP3DT                          WGP3DT
     I              FJCQTM                          WGCQTM
     I              FJUVST                          WGUVST
     I              FJUWST                          WGUWST
     I              FJUXST                          WGUXST
     I              FJAATM                          WGAATM
     I              FJAYNA                          WGAYNA
     I              FJA0NA                          WGA0NA
     I              FJAXDT                          WGAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     I@FLCPW9
      * Load Detail               Co/Order
      * Renamed input format fields
     I              FLRMNB                          WIRMNB
     I              FLRUNB                          WIRUNB
     I              FLRVNB                          WIRVNB
     I              FLDQTX                          WIDQTX
     I              FLRWNB                          WIRWNB
     I              FLRXNB                          WIRXNB
     I              FLSQNB                          WISQNB
     I              FLT0NB                          WIT0NB
     I              FLT1NB                          WIT1NB
     I              FLR1NB                          WIR1NB
     I              FLAIC3                          WIAIC3
     I              FLC4NB                          WIC4NB
     I              FLVCST                          WIVCST
     I              FLKEDT                          WIKEDT
     I              FLSXNB                          WISXNB
     I              FLKFDT                          WIKFDT
     I              FLACTM                          WIACTM
     I              FLK5TX                          WIK5TX
     I              FLW5CD                          WIW5CD
     I              FLEJDT                          WIEJDT
     I              FLAGTM                          WIAGTM
     I              FLKJDT                          WIKJDT
     I              FLATTM                          WIATTM
     I              FLHDDT                          WIHDDT
     I              FLAUTM                          WIAUTM
     I              FLKKDT                          WIKKDT
     I              FLAVTM                          WIAVTM
     I              FLZ4NB                          WIZ4NB
     I              FLY7ST                          WIY7ST
     I              FLY2ST                          WIY2ST
     I              FLWHTX                          WIWHTX
     I              FLWITX                          WIWITX
     I              FLWJTX                          WIWJTX
     I              FLWKTX                          WIWKTX
     I              FLWLTX                          WIWLTX
     I              FLN7DT                          WIN7DT
     I              FLN8DT                          WIN8DT
     I              FLN9DT                          WIN9DT
     I              FLB3TM                          WIB3TM
     I              FLB4TM                          WIB4TM
     I              FLB5TM                          WIB5TM
     I              FLIASX                          WIIASX
     I              FLIBSX                          WIIBSX
     I              FLICSX                          WIICSX
     I              FLWVTX                          WIWVTX
     I              FLWWTX                          WIWWTX
     I              FLWXTX                          WIWXTX
     I              FLUVST                          WIUVST
     I              FLUWST                          WIUWST
     I              FLUXST                          WIUXST
     I              FLAATM                          WIAATM
     I              FLAYNA                          WIAYNA
     I              FLA0NA                          WIA0NA
     I              FLAXDT                          WIAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WJRMNB
     I              FLRUNB                          WJRUNB
     I              FLRVNB                          WJRVNB
     I              FLDQTX                          WJDQTX
     I              FLRWNB                          WJRWNB
     I              FLRXNB                          WJRXNB
     I              FLSQNB                          WJSQNB
     I              FLT0NB                          WJT0NB
     I              FLT1NB                          WJT1NB
     I              FLR1NB                          WJR1NB
     I              FLAIC3                          WJAIC3
     I              FLC4NB                          WJC4NB
     I              FLVCST                          WJVCST
     I              FLKEDT                          WJKEDT
     I              FLSXNB                          WJSXNB
     I              FLKFDT                          WJKFDT
     I              FLACTM                          WJACTM
     I              FLK5TX                          WJK5TX
     I              FLW5CD                          WJW5CD
     I              FLEJDT                          WJEJDT
     I              FLAGTM                          WJAGTM
     I              FLKJDT                          WJKJDT
     I              FLATTM                          WJATTM
     I              FLHDDT                          WJHDDT
     I              FLAUTM                          WJAUTM
     I              FLKKDT                          WJKKDT
     I              FLAVTM                          WJAVTM
     I              FLZ4NB                          WJZ4NB
     I              FLY7ST                          WJY7ST
     I              FLY2ST                          WJY2ST
     I              FLWHTX                          WJWHTX
     I              FLWITX                          WJWITX
     I              FLWJTX                          WJWJTX
     I              FLWKTX                          WJWKTX
     I              FLWLTX                          WJWLTX
     I              FLN7DT                          WJN7DT
     I              FLN8DT                          WJN8DT
     I              FLN9DT                          WJN9DT
     I              FLB3TM                          WJB3TM
     I              FLB4TM                          WJB4TM
     I              FLB5TM                          WJB5TM
     I              FLIASX                          WJIASX
     I              FLIBSX                          WJIBSX
     I              FLICSX                          WJICSX
     I              FLWVTX                          WJWVTX
     I              FLWWTX                          WJWWTX
     I              FLWXTX                          WJWXTX
     I              FLUVST                          WJUVST
     I              FLUWST                          WJUWST
     I              FLUXST                          WJUXST
     I              FLAATM                          WJAATM
     I              FLAYNA                          WJAYNA
     I              FLA0NA                          WJA0NA
     I              FLAXDT                          WJAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WKAJCD
     I              ADF8NA                          WKF8NA
     I              ADACNA                          WKACNA
     I              ADADNA                          WKADNA
     I              ADAENA                          WKAENA
     I              ADAJNA                          WKAJNA
     I              ADBTTX                          WKBTTX
     I              ADAOCD                          WKAOCD
     I              ADBGCD                          WKBGCD
     I              ADVHST                          WKVHST
     I              ADMPNA                          WKMPNA
     I              ADWPST                          WKWPST
     I              ADXUST                          WKXUST
     I              ADT0ST                          WKT0ST
     I              ADT1ST                          WKT1ST
     I              ADDBNB                          WKDBNB
     I              ADT2ST                          WKT2ST
     I              ADT3ST                          WKT3ST
     I              ADT4ST                          WKT4ST
     I              ADT6ST                          WKT6ST
     I              ADBWC3                          WKBWC3
     I              ADBTC3                          WKBTC3
     I              ADBUC3                          WKBUC3
     I              ADBVC3                          WKBVC3
     I              ADFCAA                          WKFCAA
     I              ADRQSX                          WKRQSX
     I              ADRRSX                          WKRRSX
     I              ADRSSX                          WKRSSX
     I              ADRTSX                          WKRTSX
     I              ADT7ST                          WKT7ST
     I              ADT8ST                          WKT8ST
     I              ADRNSX                          WKRNSX
     I              ADROSX                          WKROSX
     I              ADRPSX                          WKRPSX
     I              ADUVST                          WKUVST
     I              ADUWST                          WKUWST
     I              ADUXST                          WKUXST
     I              ADVSST                          WKVSST
     I              ADAATM                          WKAATM
     I              ADAYNA                          WKAYNA
     I              ADA0NA                          WKA0NA
     I              ADAXDT                          WKAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WLAIC3
     I              B0HGCD                          WLHGCD
     I              B0AJCD                          WLAJCD
     I              B0AGCS                          WLAGCS
     I              B0AECS                          WLAECS
     I              B0BACS                          WLBACS
     I              B0BBCS                          WLBBCS
     I              B0CBPR                          WLCBPR
     I              B0GUDT                          WLGUDT
     I              B0XYST                          WLXYST
     I              B0CTPR                          WLCTPR
     I              B0G4DT                          WLG4DT
     I              B0BOWG                          WLBOWG
     I              B0DDQT                          WLDDQT
     I              B0DEQT                          WLDEQT
     I              B0DFQT                          WLDFQT
     I              B0HDQT                          WLHDQT
     I              B0HEQT                          WLHEQT
     I              B0AJQT                          WLAJQT
     I              B0AQQT                          WLAQQT
     I              B0AUQT                          WLAUQT
     I              B0EMQT                          WLEMQT
     I              B0DOQT                          WLDOQT
     I              B0ATNA                          WLATNA
     I              B0AKDT                          WLAKDT
     I              B0ANDT                          WLANDT
     I              B0IDVA                          WLIDVA
     I              B0JVST                          WLJVST
     I              B0BZPC                          WLBZPC
     I              B0DGQT                          WLDGQT
     I              B0DIDT                          WLDIDT
     I              B0ALCD                          WLALCD
     I              B0BFDY                          WLBFDY
     I              B0DJDT                          WLDJDT
     I              B0BGDY                          WLBGDY
     I              B0DKDT                          WLDKDT
     I              B0J2ST                          WLJ2ST
     I              B0DJQT                          WLDJQT
     I              B0BNWG                          WLBNWG
     I              B0DLDT                          WLDLDT
     I              B0DPQT                          WLDPQT
     I              B0DQQT                          WLDQQT
     I              B0DMDT                          WLDMDT
     I              B0M0ST                          WLM0ST
     I              B0J9ST                          WLJ9ST
     I              B0KBST                          WLKBST
     I              B0AKC8                          WLAKC8
     I              B0RINB                          WLRINB
     I              B0RHNB                          WLRHNB
     I              B0RGNB                          WLRGNB
     I              B0UVST                          WLUVST
     I              B0UWST                          WLUWST
     I              B0UXST                          WLUXST
     I              B0VSST                          WLVSST
     I              B0AATM                          WLAATM
     I              B0AYNA                          WLAYNA
     I              B0A0NA                          WLA0NA
     I              B0AXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PARMNB
      *
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop/Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
      * Outward parameters
     IPCRC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PCRMNB
      *
      * Outward parameters
     IPDRC        DS                              8
      * KEY : Order Header TRG          Load Id/Order Num
      * I : RST Load ID
     I                                    P   1   40PDRMNB
      * I :  Order Number
     I                                    P   5   80PDC4NB
      *
      * Outward parameters
     IPERC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I : RST Load ID
     I                                    P   1   40PERMNB
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPFRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PFAIC3
      * I :  Order Number
     I                                    P   3   60PFC4NB
      * I :  Order Type - Sales
     I                                        7   8 PFJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PFANC7
      * I :  Ship To Customer
     I                                    P  13  160PFBKC7
      * I :  Ship To Name
     I                                       17  46 PFBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PFHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PFHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PFHPNA
      * I :  Ship To City
     I                                      137 156 PFHNNA
      * I :  Ship To State Code
     I                                      157 158 PFDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PFCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PFB0C7
      * I :  Bill to Name
     I                                      174 203 PFAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PFB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PFB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PFB4NA
      * I :  Bill to City
     I                                      294 313 PFB2NA
      * I :  Bill to State Code
     I                                      314 315 PFBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PFC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PFBCNA
      * I :  Order Date
     I                                    P 342 3450PFA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PFA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PFGNDT
      * I :  Cancel Date
     I                                    P 354 3570PFACDT
      * I :  Terms Code
     I                                      358 359 PFAQCD
      * I :  Special Instructions
     I                                      360 399 PFB6NA
      * I :  Special Instructions 2
     I                                      400 439 PFBYNA
      * I :  Carrier Code
     I                                      440 442 PFBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PFGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PFGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PFGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PFQFST
      * I :  Reason Code
     I                                      447 449 PFCQCD
      * I :  Order in Use
     I                                      450 450 PFGJST
      * I :  Header Status
     I                                      451 451 PFGWST
      * I :  Header Status Last
     I                                      452 452 PFGXST
      * I :  Order Type Print Status
     I                                      453 453 PFGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PFAODT
      * I :  User Original Entry
     I                                      458 467 PFAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PFCXDT
      * I :  Order Value Total
     I                                    P 472 4772PFJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PFA1WG
      * I :  Credit Hold
     I                                      484 484 PFXIST
      * I :  Production Hold
     I                                      485 485 PFXJST
      * I :  New Customer Hold
     I                                      486 486 PFXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PFEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PFAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PFE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PFE9CD
      * I :  Load ID
     I                                    P 510 5130PFRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PFTBNB
      * I :  Rated Freight
     I                                    P 517 5222PFR1NB
      * I :  LTL Flag
     I                                      523 523 PFPJST
      * I :  Price Audit
     I                                      524 524 PFU0ST
      * I :  Price Status
     I                                      525 525 PFU1ST
      * I :  Shipping Method
     I                                      526 527 PFQ2CD
      * I :  Export Status
     I                                      528 528 PFU2ST
      * I :  Palletize
     I                                      529 529 PFVEST
      * I :  Shrink Wrap
     I                                      530 530 PFVFST
      * I :  Slip Sheet
     I                                      531 531 PFVGST
      * I :  Age Code
     I                                      532 532 PFRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PFRNNB
      * I :  Load Type
     I                                      536 536 PFVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PFATIN
      * I :  Load Plan Order
     I                                      541 541 PFU4ST
      * I :  Print Pick Slip
     I                                      542 542 PFU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PFRSRN
      * I :  Special Comment 1
     I                                      547 576 PFMHNA
      * I :  Special Comment 2
     I                                      577 606 PFMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PFWBST
      * I :  Sales Route Code
     I                                      608 610 PFR4CD
      * I :  Manager Level Code
     I                                      611 612 PFBFCD
      * I :  VP Level Code
     I                                      613 615 PFQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PFT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PFSICD
      * I :  Invoice Number
     I                                    P 623 6260PFCONB
      * I :  Invoice Suffix
     I                                      627 628 PFCEST
      * I :  Invoice Date
     I                                    P 629 6320PFAWDT
      * I :  Event Code
     I                                      633 634 PFJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PFXUST
      * I :  Modified Flag
     I                                      636 636 PFZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PFVRVA
      * I :  Billing Activity Type
     I                                      643 643 PFOBST
      * I :  Block Order Flag
     I                                      644 644 PFBCST
      * I :  Order Certification Flag
     I                                      645 645 PFBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PFB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PFGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PFGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PFGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PFGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PFFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PFFOSX
      * I :  Order Emailed
     I                                      658 658 PFFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PFFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PFFRSX
      * I :  Broker Order Status
     I                                      661 661 PFFSSX
      * I :  Air Freight Order
     I                                      662 662 PFFTSX
      * I :  Order Requires Review
     I                                      663 664 PFFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PFFVSX
      * I :  Export USDA Approved
     I                                      667 668 PFFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PFFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PFFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PFNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PFNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PFNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PFNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PFNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PFBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PFBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PFBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PFBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PFBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PFH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PFH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PFH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PFH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PFH4NX
      * I :  Claim Number
     I                                    P 745 7480PFC0C7
      * I :  EDI Status 1
     I                                      749 749 PFUVST
      * I :  EDI Status 2
     I                                      750 750 PFUWST
      * I :  EDI Status 3
     I                                      751 751 PFUXST
      * I :  Job Time
     I                                    P 752 7550PFAATM
      * I :  User Id
     I                                      756 765 PFAYNA
      * I :  Job Name
     I                                      766 775 PFA0NA
      * I :  Job Date
     I                                    P 776 7790PFAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     IYBRDCS      DS                            525
     IYCRDCS      DS                            779
      * Outward parameters
     IPGRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PGDXNB
      * I :  Load ID
     I                                    P  11  140PGRMNB
      * I :  Stop/Drop
     I                                    P  15  170PGRVNB
      * I :  Load Change Type
     I                                       18  23 PGRVST
      * I :  Department Control Code
     I                                       24  26 PGUJST
      * I :  Change Log Prior Value
     I                                       27  38 PGMNTX
      * I :  Change Log New Value
     I                                       39  50 PGMOTX
      * I :  User Id
     I                                       51  60 PGAYNA
      * I :  Job Name
     I                                       61  70 PGA0NA
      * I :  Carrier Code
     I                                       71  73 PGBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PGXMCD
      * I :  Company Number
     I                                    P  77  780PGAIC3
      * I :  Order Number
     I                                    P  79  820PGC4NB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WHRMNB
     I              FJAIC3                          WHAIC3
     I              FJAODT                          WHAODT
     I              FJPJST                          WHPJST
     I              FJPKST                          WHPKST
     I              FJRNNB                          WHRNNB
     I              FJDMTX                          WHDMTX
     I              FJDNTX                          WHDNTX
     I              FJDOTX                          WHDOTX
     I              FJWTTX                          WHWTTX
     I              FJWUTX                          WHWUTX
     I              FJRPNB                          WHRPNB
     I              FJFLAM                          WHFLAM
     I              FJXQST                          WHXQST
     I              FJRRNB                          WHRRNB
     I              FJDXTX                          WHDXTX
     I              FJDYTX                          WHDYTX
     I              FJSBNB                          WHSBNB
     I              FJBZNA                          WHBZNA
     I              FJRONB                          WHRONB
     I              FJSQNB                          WHSQNB
     I              FJR1NB                          WHR1NB
     I              FJVCST                          WHVCST
     I              FJVDST                          WHVDST
     I              FJSDNB                          WHSDNB
     I              FJPAOU                          WHPAOU
     I              FJDGWG                          WHDGWG
     I              FJSXNB                          WHSXNB
     I              FJHADT                          WHHADT
     I              FJAART                          WHAART
     I              FJDHWG                          WHDHWG
     I              FJDIWG                          WHDIWG
     I              FJAQDT                          WHAQDT
     I              FJS6NB                          WHS6NB
     I              FJT4NB                          WHT4NB
     I              FJPRTM                          WHPRTM
     I              FJNPSV                          WHNPSV
     I              FJJ8TX                          WHJ8TX
     I              FJTLMI                          WHTLMI
     I              FJJ9TX                          WHJ9TX
     I              FJQ2CD                          WHQ2CD
     I              FJVPCD                          WHVPCD
     I              FJDBCD                          WHDBCD
     I              FJGRWE                          WHGRWE
     I              FJXCCD                          WHXCCD
     I              FJU2ST                          WHU2ST
     I              FJF9DT                          WHF9DT
     I              FJONTM                          WHONTM
     I              FJJ4DT                          WHJ4DT
     I              FJTRTM                          WHTRTM
     I              FJJ5DT                          WHJ5DT
     I              FJSPTM                          WHSPTM
     I              FJJ6DT                          WHJ6DT
     I              FJLFTM                          WHLFTM
     I              FJJ7DT                          WHJ7DT
     I              FJBOTM                          WHBOTM
     I              FJJ8DT                          WHJ8DT
     I              FJBLTM                          WHBLTM
     I              FJKIDT                          WHKIDT
     I              FJASTM                          WHASTM
     I              FJKADT                          WHKADT
     I              FJAJCM                          WHAJCM
     I              FJXACD                          WHXACD
     I              FJOANA                          WHOANA
     I              FJK4TX                          WHK4TX
     I              FJVOAG                          WHVOAG
     I              FJKBDT                          WHKBDT
     I              FJNBBO                          WHNBBO
     I              FJW4CD                          WHW4CD
     I              FJEFDT                          WHEFDT
     I              FJCNTN                          WHCNTN
     I              FJKCDT                          WHKCDT
     I              FJTMIN                          WHTMIN
     I              FJKDDT                          WHKDDT
     I              FJVMNB                          WHVMNB
     I              FJOCFR                          WHOCFR
     I              FJKJDT                          WHKJDT
     I              FJATTM                          WHATTM
     I              FJOTRS                          WHOTRS
     I              FJRNST                          WHRNST
     I              FJBRBK                          WHBRBK
     I              FJEIDT                          WHEIDT
     I              FJRMST                          WHRMST
     I              FJAJCD                          WHAJCD
     I              FJKKDT                          WHKKDT
     I              FJAVTM                          WHAVTM
     I              FJKZDT                          WHKZDT
     I              FJAXTM                          WHAXTM
     I              FJLHOS                          WHLHOS
     I              FJLHOR                          WHLHOR
     I              FJWNTX                          WHWNTX
     I              FJOITX                          WHOITX
     I              FJOJTX                          WHOJTX
     I              FJLLDT                          WHLLDT
     I              FJLSHG                          WHLSHG
     I              FJYPST                          WHYPST
     I              FJK0DT                          WHK0DT
     I              FJAYTM                          WHAYTM
     I              FJKNNX                          WHKNNX
     I              FJICWG                          WHICWG
     I              FJIDWG                          WHIDWG
     I              FJH9SX                          WHH9SX
     I              FJWOTX                          WHWOTX
     I              FJK1DT                          WHK1DT
     I              FJAZTM                          WHAZTM
     I              FJK2DT                          WHK2DT
     I              FJA0TM                          WHA0TM
     I              FJROST                          WHROST
     I              FJRPST                          WHRPST
     I              FJRQST                          WHRQST
     I              FJRRST                          WHRRST
     I              FJZBVA                          WHZBVA
     I              FJWPTX                          WHWPTX
     I              FJWQTX                          WHWQTX
     I              FJWRTX                          WHWRTX
     I              FJWSTX                          WHWSTX
     I              FJRVSX                          WHRVSX
     I              FJRUSX                          WHRUSX
     I              FJRWSX                          WHRWSX
     I              FJRXSX                          WHRXSX
     I              FJRYSX                          WHRYSX
     I              FJRZSX                          WHRZSX
     I              FJR0SX                          WHR0SX
     I              FJR1SX                          WHR1SX
     I              FJR2SX                          WHR2SX
     I              FJR3SX                          WHR3SX
     I              FJR4SX                          WHR4SX
     I              FJPYDT                          WHPYDT
     I              FJCKTM                          WHCKTM
     I              FJPZDT                          WHPZDT
     I              FJCLTM                          WHCLTM
     I              FJP0DT                          WHP0DT
     I              FJCMTM                          WHCMTM
     I              FJP1DT                          WHP1DT
     I              FJCNTM                          WHCNTM
     I              FJP2DT                          WHP2DT
     I              FJCOTM                          WHCOTM
     I              FJP3DT                          WHP3DT
     I              FJCQTM                          WHCQTM
     I              FJUVST                          WHUVST
     I              FJUWST                          WHUWST
     I              FJUXST                          WHUXST
     I              FJAATM                          WHAATM
     I              FJAYNA                          WHAYNA
     I              FJA0NA                          WHA0NA
     I              FJAXDT                          WHAXDT
      *
     IYDRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WJRMNB
     I              FLRUNB                          WJRUNB
     I              FLRVNB                          WJRVNB
     I              FLDQTX                          WJDQTX
     I              FLRWNB                          WJRWNB
     I              FLRXNB                          WJRXNB
     I              FLSQNB                          WJSQNB
     I              FLT0NB                          WJT0NB
     I              FLT1NB                          WJT1NB
     I              FLR1NB                          WJR1NB
     I              FLAIC3                          WJAIC3
     I              FLC4NB                          WJC4NB
     I              FLVCST                          WJVCST
     I              FLKEDT                          WJKEDT
     I              FLSXNB                          WJSXNB
     I              FLKFDT                          WJKFDT
     I              FLACTM                          WJACTM
     I              FLK5TX                          WJK5TX
     I              FLW5CD                          WJW5CD
     I              FLEJDT                          WJEJDT
     I              FLAGTM                          WJAGTM
     I              FLKJDT                          WJKJDT
     I              FLATTM                          WJATTM
     I              FLHDDT                          WJHDDT
     I              FLAUTM                          WJAUTM
     I              FLKKDT                          WJKKDT
     I              FLAVTM                          WJAVTM
     I              FLZ4NB                          WJZ4NB
     I              FLY7ST                          WJY7ST
     I              FLY2ST                          WJY2ST
     I              FLWHTX                          WJWHTX
     I              FLWITX                          WJWITX
     I              FLWJTX                          WJWJTX
     I              FLWKTX                          WJWKTX
     I              FLWLTX                          WJWLTX
     I              FLN7DT                          WJN7DT
     I              FLN8DT                          WJN8DT
     I              FLN9DT                          WJN9DT
     I              FLB3TM                          WJB3TM
     I              FLB4TM                          WJB4TM
     I              FLB5TM                          WJB5TM
     I              FLIASX                          WJIASX
     I              FLIBSX                          WJIBSX
     I              FLICSX                          WJICSX
     I              FLWVTX                          WJWVTX
     I              FLWWTX                          WJWWTX
     I              FLWXTX                          WJWXTX
     I              FLUVST                          WJUVST
     I              FLUWST                          WJUWST
     I              FLUXST                          WJUXST
     I              FLAATM                          WJAATM
     I              FLAYNA                          WJAYNA
     I              FLA0NA                          WJA0NA
     I              FLAXDT                          WJAXDT
      *
     IYERDCS      DS                            367
     IYFRDCS      DS                            525
     IYGRDCS      DS                            779
     IYHRDCS      DS                            793
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WLAIC3
     I              B0HGCD                          WLHGCD
     I              B0AJCD                          WLAJCD
     I              B0AGCS                          WLAGCS
     I              B0AECS                          WLAECS
     I              B0BACS                          WLBACS
     I              B0BBCS                          WLBBCS
     I              B0CBPR                          WLCBPR
     I              B0GUDT                          WLGUDT
     I              B0XYST                          WLXYST
     I              B0CTPR                          WLCTPR
     I              B0G4DT                          WLG4DT
     I              B0BOWG                          WLBOWG
     I              B0DDQT                          WLDDQT
     I              B0DEQT                          WLDEQT
     I              B0DFQT                          WLDFQT
     I              B0HDQT                          WLHDQT
     I              B0HEQT                          WLHEQT
     I              B0AJQT                          WLAJQT
     I              B0AQQT                          WLAQQT
     I              B0AUQT                          WLAUQT
     I              B0EMQT                          WLEMQT
     I              B0DOQT                          WLDOQT
     I              B0ATNA                          WLATNA
     I              B0AKDT                          WLAKDT
     I              B0ANDT                          WLANDT
     I              B0IDVA                          WLIDVA
     I              B0JVST                          WLJVST
     I              B0BZPC                          WLBZPC
     I              B0DGQT                          WLDGQT
     I              B0DIDT                          WLDIDT
     I              B0ALCD                          WLALCD
     I              B0BFDY                          WLBFDY
     I              B0DJDT                          WLDJDT
     I              B0BGDY                          WLBGDY
     I              B0DKDT                          WLDKDT
     I              B0J2ST                          WLJ2ST
     I              B0DJQT                          WLDJQT
     I              B0BNWG                          WLBNWG
     I              B0DLDT                          WLDLDT
     I              B0DPQT                          WLDPQT
     I              B0DQQT                          WLDQQT
     I              B0DMDT                          WLDMDT
     I              B0M0ST                          WLM0ST
     I              B0J9ST                          WLJ9ST
     I              B0KBST                          WLKBST
     I              B0AKC8                          WLAKC8
     I              B0RINB                          WLRINB
     I              B0RHNB                          WLRHNB
     I              B0RGNB                          WLRGNB
     I              B0UVST                          WLUVST
     I              B0UWST                          WLUWST
     I              B0UXST                          WLUXST
     I              B0VSST                          WLVSST
     I              B0AATM                          WLAATM
     I              B0AYNA                          WLAYNA
     I              B0A0NA                          WLA0NA
     I              B0AXDT                          WLAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Order Number
     I                                    P   1   40P1C4NB
      * N :  Requested Delivery Date
     I                                    P   5   80P1EIDT
      * I : RST Load ID
     I                                    P   9  120P1RMNB
      * N :  Shipping Method
     I                                       13  14 P1Q2CD
     IP2PARM      DS
      * I :  Scheduled Ship Date
     I                                    P   1   40P2AODT
     IP3PARM      DS
      * FLD: *Arrays
      * N : MAP Warehouse Code
     I                                        1   3 P3AJCD
      * N : MAP Application Code
     I                                        4   9 P3DNCD
      * N : MAP Enterprise Code 1
     I                                       10  13 P3DQCD
      * N : MAP Enterprise Code 2
     I                                       14  25 P3DRCD
      * N : MAP Salesperson Code
     I                                       26  28 P3BCCD
      * N : MAP System Date Format
     I                                       29  31 P3B8NA
      * N : MAP User Profile Name
     I                                       32  41 P3AJVN
      * N : MAP Allow Multi-Company
     I                                       42  42 P3I6ST
      * N : MAP Default Printer
     I                                       43  52 P3MPNA
      * N : MAP First Time Flag
     I                                       53  53 P3TAST
      * I : MAP Name
     I                                       54  83 P3ADTX
      * N : MAP System Value Alpha
     I                                       84 123 P3BXTX
      * N : MAP Access Denied (Y/N)
     I                                      124 124 P3WVST
      * I :  Access Limited Sts USR
     I                                      125 125 P3HHST
     IP4PARM      DS
      * N :  USR Warehouse Code
     I                                        1   3 P4CPCD
     IP5PARM      DS
      * N :  Error Status
     I                                        1   1 P5ECST
     IP6PARM      DS
      * FLD: Order Detail
      * N :  Unit Cost Per Pound
     I                                    P   1   64P6AGCS
      * N :  Deadline Depart Date LH
     I                                    P   7  100P6NVDT
     IP7PARM      DS
      * N :  Allow Mult Whse to Order
     I                                        1   1 P7HSST
     IP8PARM      DS
      * N :  MG Created Load
     I                                        1   1 P8RYSX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PS Order Whs not Updated'
      * Order Number
     I                                        1   7 ZA0001
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0002
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0003
      * Warehouse Code
     I                                       11  13 ZA0004
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0005
      * Message data for 'Date => Job Date'
      * @Date - ATR
     I                                    P   1   40ZA0006
      * Job Date
     I                                    P   5   80ZA0007
      * Message data for 'Warehouse cant ship f/co'
      * Warehouse Code
     I                                        1   3 ZA0008
      * Company Number
     I                                        4   6 ZA0009
      * Message data for 'Warehouse not found'
      * Message data for 'Delivery Date < Ship Date'
      * Requested Delivery Date
     I                                    P   1   40ZA0010
      * Message data for 'Date must be entered'
      * Message data for 'Delivery Date < Ship Date'
      * Requested Delivery Date
     I                                    P   1   40ZA0011
      * Message data for 'Sched SD after Deliv Date'
      * Scheduled Ship Date USR
     I                                    P   1   40ZA0012
      * Message data for 'Calendar not found'
      * Message data for 'Calendar not found'
      * Message data for 'Req Ship Date < Job Date'
      * Requested Ship Date
     I                                    P   1   40ZA0013
      * Message data for 'Req Shp Dt GT Sch Shp Dt'
      * Requested Ship Date USR
     I                                    P   1   40ZA0014
      * Message data for 'Time Required'
      * @Time 4.0
     I                                    P   1   30ZA0015
      * Message data for 'Time Field GT 24 Hours'
      * Requested Delivery Time
     I                                    P   1   30ZA0016
      * Message data for 'Time field minutes GT 59'
      * Requested Delivery Time
     I                                    P   1   30ZA0017
      * Message data for 'Requested Ship Date can n'
      * Must Ship Date        USR
     I                                    P   1   40ZA0018
      * Message data for 'Invalid Dt Chg-DDD/T err1'
      * Scheduled Ship Date
     I                                    P   1   40ZA0019
      * Message data for 'Invalid Dt Chg-DDD/T err2'
      * Scheduled Delivery Time
     I                                    P   1   40ZA0020
      * Message data for 'Invalid Deadln Dt/Tm'
      * Requested Delivery Date
     I                                    P   1   40ZA0021
      * Message data for 'Requested Delv Date Error'
      * Requested Delivery Dt
     I                                    P   1   40ZA0022
      * Message data for 'Scheduled Ship Date Req'd'
      * Scheduled Ship Date
     I                                    P   1   40ZA0023
      * Message data for 'PrdDte Shipped BEF Made'
      * Production AgeDte Fr
     I                                    P   1   40ZA0024
      * Message data for 'Enter Age Days or Dates'
      * Item Age Days
     I                                    P   1   30ZA0025
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0026
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0027
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0028
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0029
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0030
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0031
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0032
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0033
      * Message data for 'Age OvrDate Ranage Invlid'
      * Item Age Days
     I                                    P   1   30ZA0034
      * Production Ovr AgeDte Fr
     I                                    P   4   70ZA0035
      * Production Ovr AgeDte To
     I                                    P   8  110ZA0036
      * Message data for 'Invalid Item Age Days'
      * Item Age Days
     I                                    P   1   30ZA0037
      * Message data for 'Invalid Prod OvrDates'
      * Production AgeDte Fr
     I                                    P   1   40ZA0038
      * Production AgeDte To
     I                                    P   5   80ZA0039
      * Message data for 'Warehouse cant ship f/co'
      * Warehouse Code
     I                                        1   3 ZA0040
      * Company Number
     I                                        4   6 ZA0041
      * Message data for 'Warehouse not found'
      * Message data for 'Item Bal NF & No UnitCost'
      * Warehouse Code
     I                                        1   3 ZA0042
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0043
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0044
      * Warehouse Code
     I                                       11  13 ZA0045
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0046
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0047
      * Application Code
     I                                       11  16 ZA0048
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0049
      * Application Code
     I                                       11  16 ZA0050
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1C4NB    PARM           WP0001  70       Order Number
     C           P1RMNB    PARM           WP0002  70       Load ID
     C           P2AODT    PARM           WP0003  70       Scheduled Ship
     C           P3ADTX    PARM           WP0004 30        Name
     C           P3HHST    PARM           WP0005  1        Access Limited
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * First time only default Scheduled Ship Date
      * CASE: PAR.First Time Flag is Yes
     C           P3TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP2AODT    #CHODT           Scheduled Ship
     C                     Z-ADDP2AODT    WUTBDT           Scheduled ShpDa
     C                     MOVEL'N'       P3TAST           First Time Flag
      * RTV MG Created Load   RT - Load Header  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * Retrieve warehouse code if not on the screen
      * CASE: CTL.Warehouse Code is Blanks
     C           #PAJCD    IFEQ *BLANK                     *IF
      * RTV Warehouse          RT - Load Header  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      * Retrieve warehouse description
      * CASE: CTL.Warehouse Code is Warehouse Code not Blank
     C           #PAJCD    IFNE *BLANK                     *IF
      * RTV Warehouse          RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PAJCD    WL0001    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CF8NA    P      Warehouse Descr
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BERMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    BERMNB
     C           KPOS      SETLL@BFCPD9
     C           KRST      KLIST
     C                     KFLD           BERMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    BERMNB
     C           KRST      READE@BFCPD9                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type - Sa
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
     C           *LIKE     DEFN #2A1WG    WZA1WG
     C                     MOVEL#2A1WG    WZA1WG           Order Weight To
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
     C           *LIKE     DEFN #2U2ST    WZU2ST
     C                     MOVEL#2U2ST    WZU2ST           Export Status
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPD9                  90*
     C  N82                READ @BFCPD9                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  4
     C                     MOVEAWKIND0    *IN,33
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           BEAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           BEC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C           #2JNCD    IFNE *BLANK                     Order Type - Sa
     C           BEJNCD    CABNE#2JNCD    BB020            Order Type - Sa
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C           #2BZNA    IFNE *BLANK                     Carrier Code
     C           BEBZNA    CABNE#2BZNA    BB020            Carrier Code
     C                     END
     C           #2A1WG    IFNE *ZERO                      Order Weight To
     C           BEA1WG    CABNE#2A1WG    BB020            Order Weight To
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           BEQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
     C           #2U2ST    IFNE *BLANK                     Export Status
     C           BEU2ST    CABNE#2U2ST    BB020            Export Status
     C                     END
     C           #2VDST    IFNE *BLANK                     Load Type
     C           BEVDST    CABNE#2VDST    BB020            Load Type
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
     C                     EXSR MC#1FN
     C                     SUB  1         ##RR
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * All orders on load have same shipping method
     C                     MOVEL#1Q2CD    P1Q2CD           Shipping Method
      * RTV Stop Number       RT - Load Detail  * 
     C                     EXSR SDRVGN
     C                     Z-ADDBEEIDT    #RJYDT           Sched Delivery
     C                     Z-ADDBEAFTM    #RTMPK           Sched Delivery
     C                     Z-ADDBEA5DT    #RGYDT           Requested Ship
      * ** Save fields to test for changes later              W288
     C                     Z-ADDBEEIDT    YL0001           Requested Deliv
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEEIDT    #RAPDZ           Scheduled Deliv
      * RCD.Time = DB1.Requested Delivery Time
     C                     Z-ADDBEAFTM    #RAPTM           Time
     C                     Z-ADDBEA5DT    #RHLDT           Ship Date USR
      * S17054 DN 04/07/21-Count Cases as Boxes. Replaced function with
      *   'RTV UM/Whs Code-Add CS RT'.
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
     C                     EXSR SERVGN
     C                     MOVEL#RAJCD    #RCPCD           USR Warehouse C
     C                     MOVEL#RAJCD    WUAJCD           Warehouse Code
     C                     Z-ADD#1AIC3    YL0005           USR Company Num
     C                     MOVEL*BLANK    #RB7SX           Must Ship Error
     C                     MOVEL'N'       YL0006           Error Flag
      * PK0302  Save 1st order for Sched Ship Wt Edit.
      * CASE: LCL.Order Number Saved USR is Equal to zeros
     C           YL0007    IFEQ *ZERO                      *IF
     C                     Z-ADDBEC4NB    YL0007           Order Number Sa
     C                     MOVELBEU2ST    YL0008           Export Status
     C                     MOVELBEJNCD    YL0009           Order Type - Sa
     C                     Z-ADDBEA1WG    YL0010           Order Weight To
     C                     MOVELBEVDST    YL0011           Load Type
     C                     MOVELBEQ2CD    YL0012           Shipping Method
     C                     END                             *FI
      * Deadline Depart Date/Time
     C                     EXSR UASUBR                     Deadline Depart
      * Change warehouses at load level
      * CASE: CTL.Warehouse Code is Warehouse Code not Blank
     C           #PAJCD    IFNE *BLANK                     *IF
      * CASE:
      *  - c1ANDc2
      *   |- c1    : RCD.Export Status is no
      *   |- c2    : RCD.U/M - Base Price is EQ Boxes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFEQ 'N'                        *IF
     C           #RCRCD    IFEQ 'BX'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL#PAJCD    #RAJCD           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'PS Order Whs not Updated'
     C                     MOVEL'USR2489' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@BFCPD9                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Scheduled Ship Date USR
      * External date
     C                     Z-ADDVCHODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #CHODT
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Send message 'Validation Processing'
     C                     MOVEL'USR4330' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * SEL: Warehouse Code
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Warehouse Code
     C           W0CFL     IFEQ '#PAJCD'                   *IF
      * Sel Warehouse         IF
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0058    IFEQ 'Y'                        *IF
      * Sel User Appl Whs     SR - User Application Whs  * 
     C                     CALL 'PNMMSRR'              90  Sel User Appl W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0001 10        User Profile Na
     C                     PARM 'O/P'     WQ0002  6        Application Cod
     C           #PAJCD    PARM #PAJCD    WQ0003  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #PAJCD    PARM #PAJCD    WQ0004  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * RTV Warehouse          RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PAJCD    WL0001    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CF8NA    P      Warehouse Descr
     C                     END                             *FI
      * Validate warehouse
      * CASE: CTL.Warehouse Code is Warehouse Code not Blank
     C           #PAJCD    IFNE *BLANK                     *IF
      * Val Warehouse         IF
      * VAL: Warehouse Code
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0058    IFEQ 'Y'                        *IF
      * CASE: PAR.Warehouse Code is Blanks
     C           #PAJCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#PAJCD    ZA0002           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0005 10        User Profile Na
     C                     PARM 'O/P'     WQ0006  6        Application Cod
     C                     PARM #PAJCD    WQ0007  3        Warehouse Code
     C                     PARM *ZERO     WQ0008  70       Item Code
     C           YL0059    PARM *BLANK    WQ0009  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0059    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0003           *USER
     C                     MOVEL#PAJCD    ZA0004           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code is Not Blanks
     C           #PAJCD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PAJCD    WL0053    P      Warehouse Code
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#PAJCD    ZA0005           Warehouse Code
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date  and MAX Sched Ship Wt for the day
      * CASE: CTL.Scheduled Ship Date USR LT JOB.*Job date
     C           #CHODT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0006
      * Convert *Job date to display format
      * Convert date
     C           1000000   ADD  ##JDT     XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0007
      * Send message 'Date => Job Date'
     C                     MOVEL'USR2018' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * processing
      * CASE: CTL.Scheduled Ship Date USR NE PAR.Scheduled Ship Date
     C           #CHODT    IFNE P2AODT                     *IF
      * PK0302 Perform Max Sched Ship Wt edit if flag is Y & Shp Mth = Tr
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : LCL.Max Schd Shp Wt Edit Flg is Yes
      *   |- c2    : LCL.Shipping Method is Not Rail
      *   |- c3    : LCL.Load Type is Regular
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0060    IFEQ 'Y'                        *IF
     C           YL0012    IFEQ 'CT'                       *IF
     C           YL0012    OREQ 'PT'
     C           YL0011    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If Warehouse is changing
      * CASE: CTL.Warehouse Code is Warehouse Code not Blank
     C           #PAJCD    IFNE *BLANK                     *IF
     C                     MOVEL#PAJCD    WUCPCD           USR Warehouse C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUAJCD    WUCPCD           USR Warehouse C
     C                     END                             *FI
      * ** Test slot limits for req date only if Seaboard     E001895
      * CASE: LCL.Company Organization is Seaboard
     C           YL0061    IFEQ 'S'                        *IF
      * SEL Sched Loads Cnfrm  PV - Load Header  * 
     C                     CALL 'POJSPVR'              90  SEL Sched Loads
     C                     PARM *BLANK    W0RTN   7
     C           YL0062    PARM YL0062    WQ0010  1        Status - Y or N
     C                     PARM #2RMNB    WQ0011  70       Load ID
     C                     PARM #CHODT    WQ0012  70       Scheduled Ship
     C                     PARM P6NVDT    WQ0013  70       Deadline Depart
     C           WUN7CD    PARM WUN7CD    WQ0014  1        USR Return Code
     C           YL0063    PARM YL0063    WQ0015  70       Scheduled Ship
     C                     PARM YL0064    WQ0016 112       Order Weight As
     C                     PARM WUCBAA    WQ0017  3        Warehouse Code
     C                     PARM WUJFSX    WQ0018  2        Warehouse Type
     C           YL0065    PARM YL0065    WQ0019  2        Slot Type f/New
     C                     PARM YL0066    WQ0020 112       Boxes Total Qua
     C                     PARM YL0001    WQ0021  70       Req Delivery Da
     C                     PARM #2C4NB    WQ0022  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POJSPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: LCL.Scheduled Ship Date USR is Entered
     C           YL0063    IFNE *ZERO                      *IF
     C                     Z-ADDYL0063    #CHODT           Scheduled Ship
     C                     END                             *FI
      * CASE: WRK.USR Return Code is Exists
     C           WUN7CD    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL*BLANK    WUECST           Error Status
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Warehouse Code   and Max Sched Ship WT for the day
      * CASE: CTL.Warehouse Code is Warehouse Code not Blank
     C           #PAJCD    IFNE *BLANK                     *IF
      * FP1054 2/19/09 RMC cant chg shipping company
      * Val WHS/Rtv ShpCo     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PAJCD    WL0054    P      Warehouse Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0055    YL0067           Shipping Compan
      * ** Test changed company, rtv organization
      * VAL: Shipping Company
      * CASE: LCL.Shipping Company NE LCL.USR Company Number
     C           YL0067    IFNE YL0005                     *IF
      * Setup message data for message
     C                     MOVEL#PAJCD    ZA0008           Warehouse Code
      * Convert USR Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           YL0005    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVELYL0005    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0009           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse cant ship f/co'
     C                     MOVEL'USR3362' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Retrieve Organization if company changes           E001895
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0067    WQ0023  30       Company Number
     C                     PARM *BLANK    WQ0024  1        Plant Company S
     C           YL0061    PARM *BLANK    WQ0025  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * whs processing, slotting, date tests
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * processing
      * CASE: CTL.Warehouse Code NE CTL.USR Warehouse Code
     C           #PAJCD    IFNE #CCPCD                     *IF
      * PK0302 Perform Max Sched Ship Wt edit if flag is Y & Shp Mth = PT
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : LCL.Max Schd Shp Wt Edit Flg is Yes
      *   |- c2    : LCL.Shipping Method is Not Rail
      *   |- c3    : LCL.Load Type is Regular
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0060    IFEQ 'Y'                        *IF
     C           YL0012    IFEQ 'CT'                       *IF
     C           YL0012    OREQ 'PT'
     C           YL0011    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If Warehouse is changing
      * CASE: CTL.Warehouse Code is Warehouse Code not Blank
     C           #PAJCD    IFNE *BLANK                     *IF
     C                     MOVEL#PAJCD    WUCPCD           USR Warehouse C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUAJCD    WUCPCD           USR Warehouse C
     C                     END                             *FI
      * ** Test for slotting limits for date-this whse        E001895
      * CASE: LCL.Company Organization is Seaboard
     C           YL0061    IFEQ 'S'                        *IF
      * SEL Sched Loads Cnfrm  PV - Load Header  * 
     C                     CALL 'POJSPVR'              90  SEL Sched Loads
     C                     PARM *BLANK    W0RTN   7
     C           YL0062    PARM YL0062    WQ0026  1        Status - Y or N
     C                     PARM #2RMNB    WQ0027  70       Load ID
     C                     PARM #CHODT    WQ0028  70       Scheduled Ship
     C                     PARM P6NVDT    WQ0029  70       Deadline Depart
     C           WUN7CD    PARM WUN7CD    WQ0030  1        USR Return Code
     C           YL0063    PARM YL0063    WQ0031  70       Scheduled Ship
     C                     PARM YL0064    WQ0032 112       Order Weight As
     C                     PARM WUCBAA    WQ0033  3        Warehouse Code
     C                     PARM WUJFSX    WQ0034  2        Warehouse Type
     C           YL0065    PARM YL0065    WQ0035  2        Slot Type f/New
     C                     PARM YL0066    WQ0036 112       Boxes Total Qua
     C                     PARM YL0001    WQ0037  70       Req Delivery Da
     C                     PARM #2C4NB    WQ0038  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POJSPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: LCL.Scheduled Ship Date USR is Entered
     C           YL0063    IFNE *ZERO                      *IF
     C                     Z-ADDYL0063    #CHODT           Scheduled Ship
     C                     END                             *FI
      * If error but F3 from Sched Loads Confrm pgm without chg to SSD
      * CASE: WRK.USR Return Code is Exists
     C           WUN7CD    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       WUECST           Error Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     MOVEL*BLANK    WUECST           Error Status
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reload subfile if CTL Warehouse is not equal to CTL USR Warehouse
      * CASE: CTL.Warehouse Code NE CTL.USR Warehouse Code
     C           #PAJCD    IFNE #CCPCD                     *IF
     C                     MOVEL#PAJCD    #CCPCD           USR Warehouse C
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * FP1309 perform validation on every detail line and if error
      * report this back to the control screen
      * If Scheduled Ship Date Changed: Test Item Age and invld SSD
      * CASE: WRK.Scheduled ShpDate SavUsr NE CTL.Scheduled Ship Date USR
     C           WUTBDT    IFNE #CHODT                     *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     MOVEL'N'       WUTUST           Error Status  2
      * testreviewslmvalidation
      * age date validation
      * CASE: CTL.Load ID is GT Zero
     C           #2RMNB    IFGT *ZERO                      *IF
      * Val ShpDt Allc By LD  XF - Order Header TRG  * 
     C                     CALL 'PNS0XFR'              90  Val ShpDt Allc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0039  70       Load ID
     C                     PARM #CHODT    WQ0040  70       Scheduled Ship
     C                     PARM ##PGM     WQ0041 10        Program name US
     C           YL0068    PARM YL0068    WQ0042  1        Error Status  3
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: WRK.Error Status  3 is Yes
     C           WUTXST    IFEQ 'Y'                        *IF
      * Send message 'Age Days/OvrDate Invalid'
     C                     MOVEL'USR4355' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Change Flag USR is No
     C           YL0069    IFEQ 'N'                        *IF
      * If no changes to subfile records, check for ctl SSD change  E0018
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
      * Val chgd SSD for Ld   XF - Order Header TRG  * 
     C                     CALL 'PBCFXFR'              90  Val chgd SSD fo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #CHODT    WQ0043  70       Scheduled Ship
     C                     PARM P1EIDT    WQ0044  70       Requested Deliv
     C                     PARM #2RMNB    WQ0045  70       Load ID
     C           YL0070    PARM YL0070    WQ0046  1        Error Status  2
     C                     PARM YL0061    WQ0047  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBCFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: LCL.Error Status  2 is Yes
     C           YL0070    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  P1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0010
      * Send message 'Delivery Date < Ship Date'
     C                     MOVEL'USR2063' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#CHODT    WUTBDT           Scheduled ShpDa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,33
     C                     SETOF                     98    *
      * Validate Sched Delivery Date USR
      * External date
     C                     Z-ADDVRJYDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9834  *
     C                     END
     C                     Z-ADDXDINDT    #RJYDT
      * Validate Requested Ship Date USR
      * External date
     C                     Z-ADDVRGYDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9836  *
     C                     END
     C                     Z-ADDXDINDT    #RGYDT
      * Warehouse Code required
     C           #RAJCD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9833  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Sched Delivery Date USR required
     C           #RJYDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9834  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Sched Delivery Time USR required
     C           #RTMPK    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9835  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Requested Ship Date USR required
     C           #RGYDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9836  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
     C           YPMTFD    CABNE*BLANKS   DCEXIT
     C                     EXSR MC#1FN
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
     C                     MOVEL'N'       YL0006           Error Flag
      * ** Retrieve Organization                              E001895
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0021    WQ0048  30       Company Number
     C                     PARM *BLANK    WQ0049  1        Plant Company S
     C           YL0061    PARM *BLANK    WQ0050  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * check subfile records's scheduled ship date usr
      * ** FP1251 LJB 01/22/2008 (Ship date CANNOT be after delivery date
      * ** E001895 CTL Ship date CANNOT be after RCD Delivery date
      *   testScheduledDeliveryShipDate
      * VAL:  Scheduled Delivery Date
      * CASE: RCD.Sched Delivery Date USR EQ WRK.ZERO
     C           #RJYDT    IFEQ WUW0NB                     *IF
      * Setup message data for message
      * Send message 'Date must be entered'
     C                     MOVEL'USR0231' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     ELSE
      * CASE: RCD.Sched Delivery Date USR LT RCD.Requested Ship Date USR
     C           #RJYDT    IFLT #RGYDT                     *IF
      * ** Prevent rcd.Delivery Date prior to req ship date    FP1251 1/4
      * Setup message data for message
      * Convert Sched Delivery Date USR to display format
      * Convert date
     C           1000000   ADD  #RJYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0011
      * Send message 'Delivery Date < Ship Date'
     C                     MOVEL'USR2063' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Scheduled Ship Date USR GT RCD.Sched Delivery Da
      *   |- c2    : LCL.Company Organization is Seaboard
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CHODT    IFGT #RJYDT                     *IF
     C           YL0061    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Prevent ctl Sched Ship Dt after rcd Req Ship Date   E001895
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0012
      * Send message 'Sched SD after Deliv Date'
     C                     MOVEL'USR4489' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0056           Company Number
     C                     Z-ADD#RJYDT    WL0057           Post to G/L Dat
     C                     EXSR SJRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * check subfile records's scheduled ship date usr
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0056           Company Number
     C                     Z-ADD#RGYDT    WL0057           Post to G/L Dat
     C                     EXSR SJRVGN
      * Val: Requested Ship Date - error if not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'Calendar not found'
     C                     MOVEL'USR0018' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     END                             *FI
      * E3796 JJH 02/24/15 - SNDERRMSG if Requested Ship Date GT Schedule
      *  Ship Date.
      * Val: Requested Ship Date GT Scheduled Ship Date
      * CASE: RCD.Requested Ship Date USR LT JOB.*Job date
     C           #RGYDT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Convert Requested Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #RGYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0013
      * Send message 'Req Ship Date < Job Date'
     C                     MOVEL'USR4797' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     ELSE
      * CASE: RCD.Requested Ship Date USR GT CTL.Scheduled Ship Date USR
     C           #RGYDT    IFGT #CHODT                     *IF
      * Setup message data for message
      * Convert Requested Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #RGYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0014
      * Send message 'Req Shp Dt GT Sch Shp Dt'
     C                     MOVEL'USR4780' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Delivery Time
      * CASE: RCD.Sched Delivery Time USR EQ WRK.ZERO
     C           #RTMPK    IFEQ WUW0NB                     *IF
      * Setup message data for message
     C                     Z-ADD#RTMPK    ZA0015           Sched Delivery
      * Send message 'Time Required'
     C                     MOVEL'USR2333' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * T12340 DN 01/18/18-Delivery Time cannot exceed 2400 or 59 for min
      * CASE: RCD.Sched Delivery Time USR is GT 24 Hour Day
     C           #RTMPK    IFGT 2400                       *IF
      * Setup message data for message
     C                     Z-ADD#RTMPK    ZA0016           Sched Delivery
      * Send message 'Time Field GT 24 Hours'
     C                     MOVEL'USR1712' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C           #RTMPK    DIV  100       YRWF00           *Modulo work fi
     C                     MVR            YL0071           USR Remainder
      * CASE: LCL.USR Remainder is GT 59 Minutes
     C           YL0071    IFGT 59                         *IF
      * Setup message data for message
     C                     Z-ADD#RTMPK    ZA0017           Sched Delivery
      * Send message 'Time field minutes GT 59'
     C                     MOVEL'USR2175' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calculating and comparing against Must Ship Date
      * CASE: RCD.Shipping Method is Buyers Truck
     C           #1Q2CD    IFEQ 'CR'                       *IF
     C           #1Q2CD    OREQ 'CT'
      *          C4086:  Don't check must ship for buyers truck
     C                     MOVEL*BLANK    #RB7SX           Must Ship Error
     C                     ELSE
      * CASE: RCD.Export Status is yes
     C           #1U2ST    IFEQ 'Y'                        *IF
      * E000647: No Miles is not an error for Exports
     C                     MOVEL*BLANK    #RB7SX           Must Ship Error
     C                     ELSE
      * CASE:
      *  - c2 OR c3 OR c4
      *   |- c2    : RCD.Sched Delivery Date USR NE RCD.Requested Deliver
      *   |- c3    : RCD.Sched Delivery Time USR NE RCD.Requested Deliver
      *   |- c4    : RCD.Warehouse Code NE RCD.USR Warehouse Code
      *   '-
     C           #RJYDT    IFNE #1EIDT                     *IF
     C           #RTMPK    ORNE #1AFTM                     *OR
     C           #RAJCD    ORNE #RCPCD                     *OR
      * process scheduled ship date changes separately, after confirm, so
      * it can use updated information
      * CLC Must Ship Date     XF - Order Header TRG  * 
     C                     CALL 'PDJBXFR'              90  CLC Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C           #RB7SX    PARM *BLANK    WQ0051  3        Must Ship Error
     C                     PARM #1C4NB    WQ0052  70       Order Number
     C                     PARM #RGYDT    WQ0053  70       Requested Ship
     C                     PARM #1HNNA    WQ0054 20        Ship To City
     C                     PARM #1DBCD    WQ0055  2        Ship To State C
     C                     PARM #1AIC3    WQ0056  30       Company Number
     C                     PARM #1RMNB    WQ0057  70       Load ID
     C                     PARM #RTMPK    WQ0058  40       Requested Deliv
     C                     PARM #CHODT    WQ0059  70       Scheduled Ship
     C                     PARM #RJYDT    WQ0060  70       Requested Deliv
     C           #RAJCD    PARM #RAJCD    WQ0061  3        Warehouse Code
     C           WULYDT    PARM WULYDT    WQ0062  70       Must Ship Date
     C           WUA5TM    PARM WUA5TM    WQ0063  60       Must Ship Time
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983635*
     C                     SETON                     313433*
     C                     END
      * ** Process dates out of order error
      * CASE: RCD.Must Ship Error is No Error
     C           #RB7SX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: RCD.Must Ship Error is Miles to Next=Zeros
     C           #RB7SX    IFEQ 'MTN'                      *IF
      * ** Don't prompt if no Miles Between Cities record
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUATUS           STATUS
      * PMT Must Ship Dt Accpt IF - Order Header TRG  * 
     C                     EXSR SKINFN
      * CASE: WRK.STATUS is No
     C           WUATUS    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Deadline Depart Date/Time, Shipping Restrictions-Seaboard only  W
     C                     EXSR UCSUBR                     Deadline Depart
      * Perform validation on age days
     C                     EXSR UGSUBR                     Perform validat
      * Validate Warehouse Code
      * CASE: RCD.Warehouse Code is Warehouse Code not Blank
     C           #RAJCD    IFNE *BLANK                     *IF
      * FP1054 2/19/09 RMC cant chg shipping company
      * Val WHS/Rtv ShpCo     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RAJCD    WL0054    P      Warehouse Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0055    YL0067           Shipping Compan
      * CASE: LCL.Shipping Company NE RCD.Company Number
     C           YL0067    IFNE #1AIC3                     *IF
      * Setup message data for message
     C                     MOVEL#RAJCD    ZA0040           Warehouse Code
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0041           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0041           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse cant ship f/co'
     C                     MOVEL'USR3362' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     END                             *FI
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     END                             *FI
     C                     END                             *FI
      * If warehouse code changed, check for item balance record and/or u
      * CASE: RCD.Warehouse Code NE RCD.USR Warehouse Code
     C           #RAJCD    IFNE #RCPCD                     *IF
      * VAL Item Bal/Unit Cost IF
      * VAL Item Bal/Unit Cost RT - PD Order Detail  * 
     C                     EXSR SQRVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Error Status is yes
      *   |- c2    : PAR.Unit Cost Per Pound is equal to zero
      *   '-
     C           P5ECST    IFEQ 'Y'                        *IF
     C           P6AGCS    OREQ 0                          *OR
      * Setup message data for message
     C                     MOVEL#RAJCD    ZA0042           Warehouse Code
      * Send message 'Item Bal NF & No UnitCost'
     C                     MOVEL'USR2556' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If deliv date/time or req ship date change, flag for update W288
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : RCD.Scheduled Delivery Dt NE RCD.Sched Delivery Date
      *   |- c2    : RCD.Time NE RCD.Sched Delivery Time USR
      *   |- c3    : RCD.Ship Date USR NE RCD.Requested Ship Date USR
      *   '-
     C           #RAPDZ    IFNE #RJYDT                     *IF
     C           #RAPTM    ORNE #RTMPK                     *OR
     C           #RHLDT    ORNE #RGYDT                     *OR
     C                     MOVEL'Y'       YL0077           Status Flag 1
     C                     END                             *FI
      * 8/18/2010 slm Add error message for MTN.
      * confirm if no errors
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : RCD.Must Ship Error is No Error
      *   |- c2    : RCD.Warehouse Code NE RCD.USR Warehouse Code
      *   |- c3    : LCL.Error Flag            USR is No
      *   '-
     C           #RB7SX    IFEQ *BLANK                     *IF
     C           #RAJCD    ORNE #RCPCD                     *OR
     C           YL0006    OREQ 'N'                        *OR
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Must Ship Error is Error List
      *   |- c2    : LCL.Error Flag            USR is Yes
      *   '-
     C           #RB7SX    IFEQ 'DDD'                      *IF
     C           #RB7SX    OREQ 'MTN'
     C           #RB7SX    OREQ 'NOW'
     C           #RB7SX    OREQ 'MSD'
     C           #RB7SX    OREQ 'RSD'
     C           #RB7SX    OREQ 'SSD'
     C           YL0006    OREQ 'Y'                        *OR
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * ** Set flag if one or more sfl recs are changed       E001895
     C                     MOVEL'Y'       YL0069           Change Flag USR
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * USER: Process subfile control (Post-confirm)
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * ** Update order header & Load Header with the chgd SSD
      * Re-allocate if Scheduled Ship Date Changed ; create log
      * CASE: PAR.Scheduled Ship Date NE CTL.Scheduled Ship Date USR
     C           P2AODT    IFNE #CHODT                     *IF
      * Log Sched ship date change (6/09/09 - wasnt doing this prior to n
     C                     MOVEL*BLANK    WUNITX           @Blank for 7
     C                     MOVELP2AODT    WUNITX           @Blank for 7
     C                     MOVEL*BLANK    WUO8TX           @Text 7
     C                     MOVEL#CHODT    WUO8TX           @Text 7
      * CRT Load/Order for DD/TXF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#2RMNB    PBRMNB           Load ID
     C                     Z-ADD*ZERO     PBRVNB           Stop/Drop
     C                     MOVEL'SCHSHP'  PBRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PBUJST    P      Department Cont
     C                     MOVELWUNITX    PBMNTX    P      Change Log Prio
     C                     MOVELWUO8TX    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##JOB     PBA0NA    P      Job Name
     C                     MOVEL#2BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADDYL0005    PBAIC3           Company Number
     C                     Z-ADD#2C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDKTXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** This also updates the Load Header with the chgd SSD
      * Upd ShpDt Allc By LD  XF - Order Header TRG  * 
     C                     CALL 'PNSVXFR'              90  Upd ShpDt Allc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0112  70       Load ID
     C                     PARM #CHODT    WQ0113  70       Scheduled Ship
     C                     PARM ##PGM     WQ0114 10        Program name US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNSVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
      * C4121:OMS315-- determine if dates in correct sequence before upda
     C                     MOVEL'Y'       WUSTYN           USR Exit Progra
      * Upd Load Header req delivery
      * UPD Rqs Deliv Date/1st XF - Load Detail  * 
     C                     CLEARPCRC
     C                     Z-ADD#2RMNB    PCRMNB           Load ID
      *
     C                     CALL 'PDFFXFR'              90  UPD Rqs Deliv D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Load Detai
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDFFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** RTV carrier appt date/time                         E00495
      * RTV Carrier Appt Dt/Tm XF - Load Detail  * 
     C                     CALL 'PNLVXFR'              90  RTV Carrier App
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2RMNB    WQ0115  70       Load ID
     C           WUN7DT    PARM *ZERO     WQ0116  70       LD Carrier Appt
     C           WUB3TM    PARM *ZERO     WQ0117  60       LD Carrier Appt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNLVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Determine if dates are in correct order on load
      * CASE: PAR.Shipping Method is Buyers Truck
     C           P1Q2CD    IFEQ 'CR'                       *IF
     C           P1Q2CD    OREQ 'CT'
      *        skip collect truck
     C                     ELSE
      * CASE: W288 add test for rcd.context change
      *  - c1 OR c2
      *   |- c1    : PAR.Scheduled Ship Date NE CTL.Scheduled Ship Date U
      *   |- c2    : LCL.Status Flag 1  Y/N is Yes
      *   '-
     C           P2AODT    IFNE #CHODT                     *IF
     C           YL0077    OREQ 'Y'                        *OR
     C                     MOVEL*BLANK    WUT3CD           Warehouse Code
      * ** Change to use XF instead if RT                     E00495
      * CLC Must Ship/Load     XF - Order Header TRG  * 
     C                     CLEARPDRC
     C                     Z-ADD#2RMNB    PDRMNB           Load ID
     C                     Z-ADD#2C4NB    PDC4NB           Order Number
      *
     C                     CALL 'PMQAXFR'              90  CLC Must Ship/L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Order Head
     C           WUB7SX    PARM *BLANK    WQ0118  3        Must Ship Error
     C           #PAJCD    PARM #PAJCD    WQ0119  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMQAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
      * CASE: WRK.Must Ship Error is No Error
     C           WUB7SX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: WRK.Must Ship Error is Req Ship should =Must Shp
     C           WUB7SX    IFEQ 'RSD'                      *IF
     C                     ELSE
      * CASE: WRK.Must Ship Error is Miles to Next=Zeros
     C           WUB7SX    IFEQ 'MTN'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Display program will log the deadline errors
      * DSP Must Ship Err/Load DF - OM Load Detail  * 
     C                     CLEARPERC
     C                     Z-ADD#2RMNB    PERMNB           Load ID
      *
     C                     CALL 'PDMBDFR'              90  DSP Must Ship E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Load Detai
     C                     PARM #CHODT    WQ0120  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMBDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'N'       WUSTYN           USR Exit Progra
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Update Deadline Depart Date/Time                   W288
     C                     MOVEL*BLANK    WULONA           USR Load Id ALp
     C                     MOVEL#2RMNB    WULONA           USR Load Id ALp
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           P8RYSX    IFEQ *BLANK                     *IF
      * CLC Depart Date f/web  XF - Load Header  * 
     C                     CALL 'PNMAXFR'              90  CLC Depart Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WULONA    WQ0121  7        USR Load Id ALp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Exit program if no date sequence errors found
      * CASE: WRK.USR Exit Program is yes
     C           WUSTYN    IFEQ 'Y'                        *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,33
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * E5534 JJH 04/11/16 - Perform Allocation if Req Delivery Date chan
      * Update Scheduled Delivery Dates from requested delivery date
      * CASE:
      *  - c1 OR c2
      *   |- c1    : RCD.Sched Delivery Date USR NE RCD.Requested Deliver
      *   |- c2    : RCD.Sched Delivery Time USR NE RCD.Requested Deliver
      *   '-
     C           #RJYDT    IFNE #1EIDT                     *IF
     C           #RTMPK    ORNE #1AFTM                     *OR
      * sched delivery date usr is requested delivery date
      * scheduled ship date usr (ctl) is the scheduled ship date
      * the following upd is new for this routine --- FP1309
      * This will be reallocating at the order level
      * CHG Delv Date/Time     CH - Order Header TRG  * 
     C                     EXSR SRCHRC
      * E5534 JJH 04/11/16 - Perform Allocation if Req Delivery Date chan
      * CASE: RCD.Sched Delivery Date USR NE RCD.Requested Delivery Date
     C           #RJYDT    IFNE #1EIDT                     *IF
      * Upd ReqDt Alloc ByOrd RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0062           Company Number
     C                     Z-ADD#1C4NB    WL0063           Order Number
     C                     Z-ADD#1A5DT    WL0064           Requested Ship
     C                     MOVEL##PGM     WL0065    P      Program name US
     C                     EXSR SSRVGN
     C                     END                             *FI
     C                     MOVEL'RQSDLV'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
     C                     MOVEL*BLANK    WUY8TX           Text USR 7
     C                     MOVEL#1EIDT    WUY8TX           Text USR 7
     C                     Z-ADD#1AFTM    YL0079           Calc 4
     C                     MOVELYL0079    WUZ7TX           Text USR 4
     C                     Z-ADD1         ZQ      50
     C           WUY8TX    CAT  WUZ7TX:ZQ WUMNTX    P      Change Log Prio
     C                     MOVEL*BLANK    WUY8TX           Text USR 7
     C                     MOVEL#RJYDT    WUY8TX           Text USR 7
     C                     Z-ADD#RTMPK    YL0079           Calc 4
     C                     MOVELYL0079    WUZ7TX           Text USR 4
     C                     Z-ADD1         ZQ      50
     C           WUY8TX    CAT  WUZ7TX:ZQ WUMOTX    P      Change Log New
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#2RMNB    PGRMNB           Load ID
     C                     Z-ADD#RRVNB    PGRVNB           Stop/Drop
     C                     MOVELWURVST    PGRVST    P      Load Change Typ
     C                     MOVELWUUJST    PGUJST    P      Department Cont
     C                     MOVELWUMNTX    PGMNTX    P      Change Log Prio
     C                     MOVELWUMOTX    PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#1BZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV ld Accpt/Load Status - Load Header  * 
     C                     EXSR SWRVGN
      * chg load acceptance flag
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Load Acceptance Flag is Load Accepted
      *   |- c2    : PAR.MG Created Load is Not MG Created Load
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0081    IFEQ 'A'                        *IF
     C           P8RYSX    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CHG Load Acceptance Sw CH - Load Header  * 
     C                     EXSR SXCHRC
     C                     END                             *FI
      * ------------  E2210 RMC
      * 8/2/12 change ld carrier appt to req delivery if it was there alr
      * RTV Chg LD APPT w/req RT - Load Detail  * 
     C                     EXSR SYRVGN
      * ------------
      * ** Update the rcd. context control fields for delivery date/time
     C                     Z-ADD#RJYDT    #1EIDT           Requested Deliv
     C                     Z-ADD#RTMPK    #1AFTM           Requested Deliv
     C                     Z-ADD#RJYDT    #RAPDZ           Scheduled Deliv
     C                     Z-ADD#1EIDT    YL0001           Requested Deliv
     C                     Z-ADD#1EIDT    #RAPDZ           Scheduled Deliv
     C                     END                             *FI
      * Log Requested ship date change
      * CASE: RCD.Requested Ship Date USR NE RCD.Requested Ship Date
     C           #RGYDT    IFNE #1A5DT                     *IF
      * E3796 JJH 02/24/15 - Moved logic into Upd ReqDt Alloc ByOrd RTs
      * E3796 JJH 02/24/15 - Reallocate if Requested Ship Date Changes
      * Upd ReqDt Alloc ByOrd RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0062           Company Number
     C                     Z-ADD#1C4NB    WL0063           Order Number
     C                     Z-ADD#RGYDT    WL0064           Requested Ship
     C                     MOVEL##PGM     WL0065    P      Program name US
     C                     EXSR SSRVGN
     C                     MOVEL*BLANK    WUNITX           @Blank for 7
     C                     MOVEL#1A5DT    WUNITX           @Blank for 7
     C                     MOVEL*BLANK    WUO8TX           @Text 7
     C                     MOVEL#RGYDT    WUO8TX           @Text 7
      * CRT Load/Order for DD/TXF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#1RMNB    PBRMNB           Load ID
     C                     Z-ADD#RRVNB    PBRVNB           Stop/Drop
     C                     MOVEL'RQSSHP'  PBRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PBUJST    P      Department Cont
     C                     MOVELWUNITX    PBMNTX    P      Change Log Prio
     C                     MOVELWUO8TX    PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDKTXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD#RGYDT    #1A5DT           Requested Ship
     C                     MOVEL'Y'       WUATUS           STATUS
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUATUS           STATUS
     C                     END                             *FI
      * Re-allocate if Warehouse Changed
      * CASE: RCD.Warehouse Code NE RCD.USR Warehouse Code
     C           #RAJCD    IFNE #RCPCD                     *IF
      * Upd WHS/Alc by Order  RT - Order Header TRG  * 
     C                     EXSR TARVGN
     C                     MOVEL'CHGWHS'  WURVST           Load Change Typ
     C                     MOVEL'TRF'     WUUJST           Department Cont
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPGRC
     C                     Z-ADD#2RMNB    PGRMNB           Load ID
     C                     Z-ADD#RRVNB    PGRVNB           Stop/Drop
     C                     MOVELWURVST    PGRVST    P      Load Change Typ
     C                     MOVELWUUJST    PGUJST    P      Department Cont
     C                     MOVEL#RCPCD    PGMNTX    P      Change Log Prio
     C                     MOVEL#RAJCD    PGMOTX    P      Change Log New
     C                     MOVEL##USR     PGAYNA    P      User Id
     C                     MOVEL##PGM     PGA0NA    P      Job Name
     C                     MOVEL#1BZNA    PGBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PGAIC3           Company Number
     C                     Z-ADD#1C4NB    PGC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PGRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * CRT IC Item Balance    RT - PD Order Detail  * 
     C                     EXSR TLRVGN
     C                     END                             *FI
      * Writing Load/Order Change Log.
      * CASE: RCD.Must Ship Error is No Error
     C           #RB7SX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: RCD.Must Ship Error is Miles to Next=Zeros
     C           #RB7SX    IFEQ 'MTN'                      *IF
      * ** Exports will not have miles here so skip.          E000550
      * CASE: RCD.Export Status is Not Yes
     C           #1U2ST    IFEQ *BLANK                     *IF
     C           #1U2ST    OREQ 'N'
      * ** There is no Miles Between Cities record
      * CRT Load/Order for DD/TXF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#2RMNB    PBRMNB           Load ID
     C                     Z-ADD#RRVNB    PBRVNB           Stop/Drop
     C                     MOVEL'NOMILE'  PBRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PBUJST    P      Department Cont
     C                     MOVEL*BLANK    PBMNTX    P      Change Log Prio
     C                     MOVEL##USR     PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDKTXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * User has accepted an order/load that cannot arrive on time
      * (This should never happen)
      * ** Put user id into new value field              E-OMS23
      * CRT Load/Order for DD/TXF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADD#2RMNB    PBRMNB           Load ID
     C                     Z-ADD#RRVNB    PBRVNB           Stop/Drop
     C                     MOVEL'ACCDEA'  PBRVST    P      Load Change Typ
     C                     MOVEL'TRF'     PBUJST    P      Department Cont
     C                     MOVEL*BLANK    PBMNTX    P      Change Log Prio
     C                     MOVEL##USR     PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVEL#1BZNA    PBBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PDKTXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           P8RYSX    IFEQ *BLANK                     *IF
      * Recalc DDD/T if this is stop 1
      * CASE: RCD.Stop/Drop is Stop One
     C           #RRVNB    IFEQ 1                          *IF
     C                     Z-ADD#RJYDT    YL0034           Deadline Depart
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0243  70       Load ID
     C           YL0034    PARM YL0034    WQ0244  70       Deadline Depart
     C           YL0035    PARM *ZERO     WQ0245  60       Deadline Depart
     C           YL0087    PARM *ZERO     WQ0246  70       Requested Deliv
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * ** DDD/T to MM/DD, HH/MM conversion                    W288
     C                     EXSR UHSUBR                     ** DDD/T to MM/
     C                     ELSE
      * CASE: *OTHERWISE
      * Put converted DDD/T in the subfile
     C                     Z-ADDWUYANB    #RYANB           Deadline Depart
     C                     Z-ADD#RYBNB    WUYBNB           Deadline Depart
     C                     END                             *FI
     C                     END                             *FI
      * before 6.29.16 RMC     AGAIN  8.29.26
      * CASE: RCD.OH Load Plan Ready is Yes
     C           #1FVSX    IFEQ 'Y'                        *IF
      * Rtv Crt OH Trigger    XF - TMS Order Header Trigger  * 
     C                     CALL 'PBWVXFR'              90  Rtv Crt OH Trig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1C4NB    WQ0247  70       Order Number
     C                     PARM #1AIC3    WQ0248  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPD9 fields to subfile
      *================================================================
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     Z-ADD*ZERO     #RRVNB           Stop/Drop
     C                     Z-ADD*ZERO     #RAPDZ           Scheduled Deliv
     C                     Z-ADD*ZERO     #RAPTM           Time
     C                     Z-ADD*ZERO     #RHLDT           Ship Date USR
     C                     MOVEL*BLANK    #RB7SX           Must Ship Error
     C                     MOVEL*BLANK    #RODCD           USR Unit of Mea
     C                     MOVEL*BLANK    #RCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #RAJCD           Warehouse Code
     C                     Z-ADD*ZERO     #RJYDT           Sched Delivery
      * Clear external version also
     C                     Z-ADD*ZERO     VRJYDT
     C                     Z-ADD*ZERO     #RTMPK           Sched Delivery
     C                     Z-ADD*ZERO     #RGYDT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VRGYDT
     C                     MOVEL*BLANK    #RCRCD           U/M - Base Pric
     C                     Z-ADD*ZERO     #RYANB           Deadline Depart
     C                     Z-ADD*ZERO     #RYBNB           Deadline Depart
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MC#1FN    BEGSR
      *================================================================
      * CALC: Subfile record function fields
      *================================================================
      * CALC: Subfile record function fields
      * SEL: Warehouse Code
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> RCD.Warehouse Code
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#RAJCD'                   *IF
      * Sel Warehouse         IF
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0058    IFEQ 'Y'                        *IF
      * Sel User Appl Whs     SR - User Application Whs  * 
     C                     CALL 'PNMMSRR'              90  Sel User Appl W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0249 10        User Profile Na
     C                     PARM 'O/P'     WQ0250  6        Application Cod
     C           #RAJCD    PARM #RAJCD    WQ0251  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #RAJCD    PARM #RAJCD    WQ0252  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * validate warehouse
      * CASE: RCD.Warehouse Code is Warehouse Code not Blank
     C           #RAJCD    IFNE *BLANK                     *IF
      * Val Warehouse         IF
      * VAL: Warehouse Code
      * CASE: PAR.Application WHS Restrict is yes
     C           YL0058    IFEQ 'Y'                        *IF
      * CASE: PAR.Warehouse Code is Blanks
     C           #RAJCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#RAJCD    ZA0043           Warehouse Code
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     GOTO MCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Val App Whs Itm Acs   XF - User Profile Control  * 
     C                     CALL 'PNMOXFR'              90  Val App Whs Itm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##USR     WQ0253 10        User Profile Na
     C                     PARM 'O/P'     WQ0254  6        Application Cod
     C                     PARM #RAJCD    WQ0255  3        Warehouse Code
     C                     PARM *ZERO     WQ0256  70       Item Code
     C           YL0059    PARM *BLANK    WQ0257  1        WHS/Item Access
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * CASE: LCL.WHS/Item Access Sts USR is Access Denied
     C           YL0059    IFEQ 'D'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0044           *USER
     C                     MOVEL#RAJCD    ZA0045           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     GOTO MCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Code is Not Blanks
     C           #RAJCD    IFNE *BLANK                     *IF
      * Val Warehouse Exists   RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#RAJCD    WL0053    P      Warehouse Code
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
     C                     MOVEL#RAJCD    ZA0046           Warehouse Code
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     GOTO MCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         MCEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP3DNCD    #PDNCD           Application Cod
     C                     MOVELP3DQCD    #PDQCD           Enterprise Code
     C                     MOVELP3DRCD    #PDRCD           Enterprise Code
     C                     MOVELP3BCCD    #PBCCD           Salesperson Cod
     C                     MOVELP3B8NA    #PB8NA           System Date For
     C                     MOVELP3AJVN    #PAJVN           User Profile Na
     C                     MOVELP3I6ST    #PI6ST           Allow Multi-Com
     C                     MOVELP3MPNA    #PMPNA           Default Printer
     C                     MOVELP3TAST    #PTAST           First Time Flag
     C                     MOVELP3BXTX    #PBXTX           System Value Al
     C                     MOVELP3WVST    #PWVST           Access Denied (
     C                     MOVELP3ADTX    #PADTX           Name
     C                     Z-ADD*ZERO     #2AIC3           Company Number
     C                     Z-ADD*ZERO     #2C4NB           Order Number
     C                     MOVEL*BLANK    #2JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
     C                     MOVEL*BLANK    #CCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
     C                     Z-ADD*ZERO     #2A1WG           Order Weight To
     C                     MOVEL*BLANK    #2Q2CD           Shipping Method
     C                     MOVEL*BLANK    #2U2ST           Export Status
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     Z-ADDP1RMNB    #2RMNB           Load ID
     C                     Z-ADD*ZERO     #CHODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VCHODT
     C                     MOVELP3AJCD    #PAJCD           Warehouse Code
     C                     MOVEL*BLANK    #CF8NA           Warehouse Descr
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Sched Delivery Date USR to display format
      * Convert date
     C           1000000   ADD  #RJYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRJYDT
      * Convert Requested Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #RGYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRGYDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCHODT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV MG Created Load   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSA     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P8RYSX           MG Created Load
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJRYSX    P8RYSX           MG Created Load
     C                     GOTO SAEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Warehouse          RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSB     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PAJCD           Warehouse Code
     C                     GOTO SBEXIT                     *QUIT
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJAJCD    #PAJCD           Warehouse Code
     C                     GOTO SBEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Warehouse Descr
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    WL0002           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Stop Number       RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     #RRVNB           Stop/Drop
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSD01           Load ID
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSD01           Load ID
      * Establish starting position
     C           KRSSD     SETLL@FLCPBW                    *
     C           KRSSD     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WUNFNN           Appointment Con
     C                     Z-ADD*ZERO     WUNFNN           Appointment Con
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If order number is found, retrieve stop number
      * CASE: PAR.Order Number EQ DB1.Order Number
     C           #1C4NB    IFEQ FLC4NB                     *IF
     C                     Z-ADDFLRVNB    #RRVNB           Stop/Drop
      * PAR = DB1 By name
     C                     Z-ADDFLRVNB    #RRVNB           Stop/Drop
     C                     Z-ADDFLKFDT    WUNFNN           Appointment Con
     C                     Z-ADDFLACTM    WUNFNN           Appointment Con
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD*ZERO     YL0002           Boxes Total Qua
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSE01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSE02           Order Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSE01           Company Number
     C                     Z-ADD#1C4NB    WQSE02           Order Number
     C                     Z-ADD*ZERO     OMDPNB           Order Sequence
     C                     Z-ADD*ZERO     OMUENB           Order Secondary
      * Establish starting position
     C           KPSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #RAJCD           Warehouse Code
     C                     MOVEL*BLANK    #RCRCD           USR Unit of Mea
     C                     GOTO SEEXIT                     *QUIT
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PF3280 -- add "Cases" to the case-stmt
     C                     MOVELOMAJCD    #RAJCD           Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.U/M - Ordered is EQ Boxes
      *   |- c3    : DB1.U/M - Ordered is Mixed
      *   |- c4    : DB1.U/M - Ordered is Cases
      *   '-
     C           OMAGCD    IFEQ 'CB'                       *IF
     C           OMAGCD    OREQ 'BX'                       *OR
     C           OMAGCD    OREQ 'MX'                       *OR
     C           OMAGCD    OREQ 'CS'                       *OR
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/06/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/06/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELOMAGCD    YL0003           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0003    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0003           U/M - Ordered
     C                     END                             *FI
      * Sum for later check
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0003    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    YL0002           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           #RCRCD    IFEQ *BLANK                     *IF
     C                     MOVELYL0003    #RCRCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0003    IFEQ #RCRCD                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WUAGCD           U/M - Ordered
     C                     MOVELWUAGCD    #RCRCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * E2709 RMC 9/12/13  Classify as BX/CB - never MX
      * CASE: PAR.USR Unit of Measure is Mixed
     C           #RCRCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0003           Company Number
     C                     MOVEL'BOXLOAD' WL0004    P      Company Value C
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0004           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0002    IFLT YL0004                     *IF
     C                     MOVEL'CB'      #RCRCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      #RCRCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0003    KMAIC3           Company Number
     C                     MOVELWL0004    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSF     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0005           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV 1st Stop Info      RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSG02           Load ID
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG02           Load ID
     C                     KFLD           WARVNB           Stop/Drop
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Load ID
      * Setup key
     C                     Z-ADDWL0006    WQSG02           Load ID
     C                     Z-ADDWL0008    WARVNB           Stop/Drop
      * Establish starting position
     C           KPSSG     SETLL@FLCPEB                    *
     C           KRSSG     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARUNB    WL0007           Stop/Drop Seque
     C                     MOVELWADQTX    WL0009           Comments for Pi
     C                     Z-ADDWARWNB    WL0010           Miles to next s
     C                     Z-ADDWARXNB    WL0011           Freight Charge
     C                     Z-ADDWASQNB    WL0012           Ld Hdr/Ld Dtl U
     C                     Z-ADDWAT0NB    WL0013           Freight Misc. C
     C                     Z-ADDWAT1NB    WL0014           Freight Stop Ch
     C                     Z-ADDWAR1NB    WL0015           Rated Freight
     C                     Z-ADDWAAIC3    WL0016           Company Number
     C                     Z-ADDWAC4NB    WL0017           Order Number
     C                     MOVELWAVCST    WL0018           Ship Status
     C                     Z-ADDWAKEDT    WL0019           Estimated Arriv
     C                     Z-ADDWASXNB    WL0020           Estimated Arriv
     C                     Z-ADDWAKFDT    WL0021           Appointment Con
     C                     Z-ADDWAACTM    WL0022           Appointment Con
     C                     MOVELWAK5TX    WL0023           Confirmation Ma
     C                     MOVELWAW5CD    WL0024           Confirmation Nu
     C                     Z-ADDWAEJDT    WL0025           Actual Delivery
     C                     Z-ADDWAAGTM    WL0026           Actual Delivery
     C                     Z-ADDWAKJDT    WL0027           Scheduled Deliv
     C                     Z-ADDWAATTM    WL0028           Scheduled Deliv
     C                     Z-ADDWAHDDT    WL0029           Deadline Depart
     C                     Z-ADDWAAUTM    WL0030           Deadline Depart
     C                     Z-ADDWAKKDT    WL0031           On Yard Date
     C                     Z-ADDWAAVTM    WL0032           On Yard Time
     C                     Z-ADDWAZ4NB    WL0033           MPC Number
     C                     MOVELWAY7ST    WL0034           Load Dtl On Tim
     C                     MOVELWAY2ST    WL0035           On Time Add'l R
     C                     MOVELWAWHTX    WL0036           Seal Nbr 1
     C                     MOVELWAWITX    WL0037           Seal Nbr 2
     C                     MOVELWAWJTX    WL0038           Seal Nbr 3
     C                     MOVELWAWKTX    WL0039           Seal Nbr 4
     C                     MOVELWAWLTX    WL0040           Seal Nbr 5
     C                     Z-ADDWAN7DT    WL0041           LD Carrier Appt
     C                     Z-ADDWAN8DT    WL0042           LD Unused Date
     C                     Z-ADDWAN9DT    WL0043           LD Unused Date
     C                     Z-ADDWAB3TM    WL0044           LD Carrier Appt
     C                     Z-ADDWAB4TM    WL0045           LD Unused Time
     C                     Z-ADDWAB5TM    WL0046           LD Unused Time
     C                     MOVELWAIASX    WL0047           Miles Error Sts
     C                     MOVELWAIBSX    WL0048           LD Unused Sts 2
     C                     MOVELWAICSX    WL0049           HPB Transload S
     C                     MOVELWAWVTX    WL0050           LD Cst Svc Trac
     C                     MOVELWAWWTX    WL0051           Carrier Ref PRO
     C                     MOVELWAWXTX    WL0052           Cust Assigned A
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val Warehouse Exists   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0053    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Val WHS/Rtv ShpCo     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0054    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBWC3    WL0055           Shipping Compan
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * VAL Date               RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           AFAIC3           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0056    AFAIC3           Company Number
     C                     Z-ADDWL0057    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSJ     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKINFN    BEGSR
      *================================================================
      * PMT Must Ship Dt Accpt IF - Order Header TRG  * 
      *================================================================
      * PMT Must Ship Dt Accpt IF
      * PMT Must Ship Dt Accpt PV - Order Header TRG  * 
     C                     CALL 'PDJFPVR'              90  PMT Must Ship D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RJYDT    WQ0064  70       Requested Deliv
     C                     PARM WULYDT    WQ0065  70       Must Ship Date
     C                     PARM #RGYDT    WQ0066  70       Requested Ship
     C           WUATUS    PARM WUATUS    WQ0067  1        STATUS
     C                     PARM WUA5TM    WQ0068  60       Must Ship Time
     C                     PARM #RTMPK    WQ0069  40       Requested Deliv
     C                     PARM #RB7SX    WQ0070  3        Must Ship Error
     C                     PARM #1C4NB    WQ0071  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJFPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983436*
     C                     SETON                     35    *
     C                     END
      * CASE: PAR.STATUS is No
     C           WUATUS    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert Must Ship Date        USR to display format
      * Convert date
     C           1000000   ADD  WULYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0018
      * Send message 'Requested Ship Date can n'
     C                     MOVEL'USR2662' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSL     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJQ2CD    YL0072           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSM02           Load ID
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM02           Load ID
     C                     KFLD           WARVNB           Stop/Drop
     C                     KFLD           WAC4NB           Order Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM02           Load ID
      * Setup key
     C                     Z-ADDWL0058    WQSM02           Load ID
     C                     Z-ADDWL0059    WARVNB           Stop/Drop
     C                     Z-ADDWL0060    WAC4NB           Order Number
      * Establish starting position
     C           KPSSM     SETLL@FLCPEB                    *
     C           KRSSM     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARWNB    WL0061           Miles to next s
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           LGMILE           Miles to First
      * Setup key
     C                     Z-ADDWN0003    LGMILE           Miles to First
      * Establish starting position
     C           KPSSN     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDLGHRRQ    YL0073           Hours Required
     C                     GOTO SNEXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSO     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJPKST    WUG0TX           Load Status
     C                     Z-ADDFJTLMI    WUTLMI           Total Load Mile
     C                     Z-ADDFJK2DT    WUK2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Val Chgd ShpDt/ItmAge  Rt - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSP02           Order Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSP01           Company Number
     C                     Z-ADD#1C4NB    WQSP02           Order Number
      * Establish starting position
     C           KRSSP     SETLL@BGWKKH                    *
     C           KRSSP     READE@BGWKKH                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Validate Item Age Date based on changed SSD and RDD   E001895
      * Val Age Information   IF
     C                     MOVEL*BLANK    WUB8SX           Error Flag
     C                     MOVEL*BLANK    YL0068           Error Status
     C                     MOVEL*BLANK    WUKWTX           Error Reason De
     C                     MOVEL*BLANK    WUKXTX           Error Reason De
     C                     MOVEL*BLANK    WUKYTX           Error Reason De
     C                     MOVEL*BLANK    WUKZTX           Error Reason De
     C                     MOVEL*BLANK    WUTITX           Error Reason De
      * CASE: PAR.Company Organization is Seaboard
     C           YL0061    IFEQ 'S'                        *IF
      * CASE: PAR.Requested Delivery Date is not entered
     C           #RJYDT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #RJYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0022
      * Send message 'Requested Delv Date Error'
     C                     MOVEL'USR4329' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9834  *
      *
     C                     ELSE
      * CASE: PAR.Scheduled Ship Date is not entered
     C           #CHODT    IFEQ 0                          *IF
      * Setup message data for message
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0023
      * Send message 'Scheduled Ship Date Req'd'
     C                     MOVEL'USR2230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9831  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Age information   XF - Order Detail  * 
     C                     CALL 'PNQNXFR'              90  Val Age informa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHGCD    WQ0084  70       Item Code
     C                     PARM WBAJCD    WQ0085  3        Warehouse Code
     C           WUB8SX    PARM WUB8SX    WQ0086  1        Error Flag
     C           WUKWTX    PARM WUKWTX    WQ0087 30        Error Reason De
     C           WUKXTX    PARM WUKXTX    WQ0088 30        Error Reason De
     C           WUKYTX    PARM WUKYTX    WQ0089 30        Error Reason De
     C           WUKZTX    PARM WUKZTX    WQ0090 30        Error Reason De
     C           WUTITX    PARM WUTITX    WQ0091 30        Error Reason De
     C                     PARM WBAIC3    WQ0092  30       Company Number
     C                     PARM #CHODT    WQ0093  70       Scheduled Ship
     C                     PARM #RJYDT    WQ0094  70       Requested Deliv
     C                     PARM WBRINY    WQ0095  40       Item Age Days
     C                     PARM WBTIDT    WQ0096  70       Production Ovr
     C                     PARM WBTJDT    WQ0097  70       Production Ovr
     C           YL0075    PARM YL0075    WQ0098  70       Production AgeD
     C           YL0076    PARM YL0076    WQ0099  70       Production AgeD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983134*
     C                     END
      * Verify if message should be sent if validation is required
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Error Flag            USR is Yes
      *   |- c2    : PAR.Production Dates Sts Usr is Validation routine
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUB8SX    IFEQ 'Y'                        *IF
     C           'V'       IFEQ 'V'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * message 1 Product is shipped before product is made
      * CASE: WRK.Error Reason Descript 1 NE WRK.Blank for 30          US
     C           WUKWTX    IFNE WUW4TX                     *IF
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0075    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0024
      * Send message 'PrdDte Shipped BEF Made'
     C                     MOVEL'USR4307' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * message 2 Either Days or override date but not both
      * CASE: WRK.Error Reason Descript 2 NE WRK.Blank for 30          US
     C           WUKXTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0025           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WBTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0026
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WBTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0027
      * Send message 'Enter Age Days or Dates'
     C                     MOVEL'USR4304' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * message 3 With Chill Days Either Days or Override Dates required
      * CASE: WRK.Error Reason Descript 3 NE WRK.Blank for 30          US
     C           WUKYTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0028           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WBTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0029
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WBTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0030
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * message 4 From date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 4 NE WRK.Blank for 30          US
     C           WUKZTX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0031           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WBTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0032
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WBTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0033
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * message 5 To date is > then SHIP DATE
      * CASE: WRK.Error Reason Descript 5 NE WRK.Blank for 30          US
     C           WUTITX    IFNE WUW4TX                     *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0034           Item Age Days
      * Convert Production Ovr AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  WBTIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0035
      * Convert Production Ovr AgeDte To to display format
      * Convert date
     C           1000000   ADD  WBTJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0036
      * Send message 'Age OvrDate Ranage Invlid'
     C                     MOVEL'USR4305' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
      * CASE: PAR.Production Ovr AgeDte Fr is not entered
     C           WBTIDT    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADDWBRINY    ZA0037           Item Age Days
      * Send message 'Invalid Item Age Days'
     C                     MOVEL'USR4309' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  YL0075    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0038
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  YL0076    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0039
      * Send message 'Invalid Prod OvrDates'
     C                     MOVEL'USR4310' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     END                             *FI
     C                     MOVEL'Y'       YL0068           Error Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Error Status  3 is Yes
     C           YL0068    IFEQ 'Y'                        *IF
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@BGWKKH                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * VAL Item Bal/Unit Cost RT - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0011  70       Pricing Date Us
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       P5ECST           Error Status
     C                     Z-ADD1         P6AGCS           Unit Cost Per P
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSQ02           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSQ01           Company Number
     C                     Z-ADD#1C4NB    WQSQ02           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@BGWKAE                    *
     C           KRSSQ     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Unit Cost Per Pound is Not equal to zero
     C           P6AGCS    IFNE 0                          *IF
      * CASE: DB1.Detail Line Status is Cancelled
     C           WCGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Itm Bal. Exists    XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDCUXFR'              90  VAL Itm Bal. Ex
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0100  30       Company Number
     C                     PARM WCHGCD    WQ0101  70       Item Code
     C                     PARM #RAJCD    WQ0102  3        Warehouse Code
     C           P5ECST    PARM *BLANK    WQ0103  1        Error Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * CASE: PAR.Error Status is yes
     C           P5ECST    IFEQ 'Y'                        *IF
      * CLC Rtv Unit Cost/LB   XF - IC Item Balance  * 
     C                     CALL 'PDLSXFR'              90  CLC Rtv Unit Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0104  30       Company Number
     C                     PARM WCHGCD    WQ0105  70       Item Code
     C                     PARM #RAJCD    WQ0106  3        Warehouse Code
     C           P6AGCS    PARM P6AGCS    WQ0107 114       Unit Cost Per P
     C           WUBACS    PARM WUBACS    WQ0108 114       Cost per Primar
     C           WN0011    PARM WN0011    WQ0109  70       Pricing Date Us
     C           WUU1ST    PARM WUU1ST    WQ0110  1        Price Status
     C                     PARM ##JDT     WQ0111  70       As of Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * CHG Delv Date/Time     CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0012  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0013  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0014  70       Ship To Custome
     C                     MOVEL*BLANK    WN0015 30        Ship To Name
     C                     MOVEL*BLANK    WN0016 30        Ship To Address
     C                     MOVEL*BLANK    WN0017 30        Ship To Address
     C                     MOVEL*BLANK    WN0018 30        Ship To Address
     C                     MOVEL*BLANK    WN0019 20        Ship To City
     C                     MOVEL*BLANK    WN0020  2        Ship To State C
     C                     MOVEL*BLANK    WN0021 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0022  70       Bill to Custome
     C                     MOVEL*BLANK    WN0023 30        Bill to Name
     C                     MOVEL*BLANK    WN0024 30        Bill to Address
     C                     MOVEL*BLANK    WN0025 30        Bill to Address
     C                     MOVEL*BLANK    WN0026 30        Bill to Address
     C                     MOVEL*BLANK    WN0027 20        Bill to City
     C                     MOVEL*BLANK    WN0028  2        Bill to State C
     C                     MOVEL*BLANK    WN0029 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0030 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0031  70       Order Date
     C                     Z-ADD*ZERO     WN0032  70       Requested Ship
     C                     Z-ADD*ZERO     WN0033  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0034  70       Cancel Date
     C                     MOVEL*BLANK    WN0035  2        Terms Code
     C                     MOVEL*BLANK    WN0036 40        Special Instruc
     C                     MOVEL*BLANK    WN0037 40        Special Instruc
     C                     MOVEL*BLANK    WN0038  3        Carrier Code
     C                     MOVEL*BLANK    WN0039  1        Comment Print A
     C                     MOVEL*BLANK    WN0040  1        Comment Print I
     C                     MOVEL*BLANK    WN0041  1        Comment Print P
     C                     MOVEL*BLANK    WN0042  1        Comment Print S
     C                     MOVEL*BLANK    WN0043  3        Reason Code
     C                     MOVEL*BLANK    WN0044  1        Order in Use
     C                     MOVEL*BLANK    WN0045  1        Header Status
     C                     MOVEL*BLANK    WN0046  1        Header Status L
     C                     MOVEL*BLANK    WN0047  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0048  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0049 10        User Original E
     C                     Z-ADD*ZERO     WN0050  70       Date of Origina
     C                     Z-ADD*ZERO     WN0051 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0052 112       Order Weight To
     C                     MOVEL*BLANK    WN0053  1        Credit Hold
     C                     MOVEL*BLANK    WN0054  1        Production Hold
     C                     MOVEL*BLANK    WN0055  1        New Customer Ho
     C                     MOVEL*BLANK    WN0056  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0057 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0058  70       Load ID
     C                     Z-ADD*ZERO     WN0059  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0060 112       Rated Freight
     C                     MOVEL*BLANK    WN0061  1        LTL Flag
     C                     MOVEL*BLANK    WN0062  1        Price Audit
     C                     MOVEL*BLANK    WN0063  1        Price Status
     C                     MOVEL*BLANK    WN0064  2        Shipping Method
     C                     MOVEL*BLANK    WN0065  1        Export Status
     C                     MOVEL*BLANK    WN0066  1        Palletize
     C                     MOVEL*BLANK    WN0067  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0068  1        Slip Sheet
     C                     MOVEL*BLANK    WN0069  1        Age Code
     C                     Z-ADD*ZERO     WN0070  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0071  1        Load Type
     C                     Z-ADD*ZERO     WN0072  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0073  1        Load Plan Order
     C                     MOVEL*BLANK    WN0074  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0075  70       Resell Referenc
     C                     MOVEL*BLANK    WN0076 30        Special Comment
     C                     MOVEL*BLANK    WN0077 30        Special Comment
     C                     MOVEL*BLANK    WN0078  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0079  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0080  2        Manager Level C
     C                     MOVEL*BLANK    WN0081  3        VP Level Code
     C                     Z-ADD*ZERO     WN0082  70       Attach to Order
     C                     MOVEL*BLANK    WN0083  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0084  70       Invoice Number
     C                     MOVEL*BLANK    WN0085  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0086  70       Invoice Date
     C                     MOVEL*BLANK    WN0087  2        Event Code
     C                     MOVEL*BLANK    WN0088  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0089  1        Modified Flag
     C                     Z-ADD*ZERO     WN0090 112       A/R order Value
     C                     MOVEL*BLANK    WN0091  1        Billing Activit
     C                     MOVEL*BLANK    WN0092  1        Block Order Fla
     C                     MOVEL*BLANK    WN0093  1        Order Certifica
     C                     Z-ADD*ZERO     WN0094 112       Invoice Order V
     C                     MOVEL*BLANK    WN0095  1        Process Sts for
     C                     MOVEL*BLANK    WN0096  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0097  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0098  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0099  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0100  1        Email Cust On O
     C                     MOVEL*BLANK    WN0101  1        Order Emailed
     C                     MOVEL*BLANK    WN0102  1        Export Docs Go
     C                     MOVEL*BLANK    WN0103  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0104  1        Broker Order St
     C                     MOVEL*BLANK    WN0105  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0106  2        Order Requires
     C                     MOVEL*BLANK    WN0107  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0108  2        Export USDA App
     C                     MOVEL*BLANK    WN0109  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0110  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0111  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0112  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0113  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0114  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0115  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0116  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0117  60       Time of Origina
     C                     Z-ADD*ZERO     WN0118  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0119  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0120  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0121 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0122 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0123 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0124 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0125 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0126  70       Claim Number
     C                     MOVEL*BLANK    WN0127  1        EDI Status 1
     C                     MOVEL*BLANK    WN0128  1        EDI Status 2
     C                     MOVEL*BLANK    WN0129  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0130  60       Job Time
     C                     MOVEL*BLANK    WN0131 10        User Id
     C                     MOVEL*BLANK    WN0132 10        Job Name
     C                     Z-ADD*ZERO     WN0133  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    WDAIC3           Company Number
     C                     Z-ADD#1C4NB    WDC4NB           Order Number
      *
     C           KLCHSR    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C           KLCHSR    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD#RJYDT    WDEIDT           Requested Deliv
     C                     Z-ADD#RTMPK    WDAFTM           Requested Deliv
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPFRC
     C                     Z-ADDWDAIC3    PFAIC3           Company Number
     C                     Z-ADDWDC4NB    PFC4NB           Order Number
     C                     MOVELWDJNCD    PFJNCD    P      Order Type - Sa
     C                     Z-ADDWDANC7    PFANC7           A/R Customer Nu
     C                     Z-ADDWDBKC7    PFBKC7           Ship To Custome
     C                     MOVELWDBRTX    PFBRTX    P      Ship To Name
     C                     MOVELWDHMNA    PFHMNA    P      Ship To Address
     C                     MOVELWDHONA    PFHONA    P      Ship To Address
     C                     MOVELWDHPNA    PFHPNA    P      Ship To Address
     C                     MOVELWDHNNA    PFHNNA    P      Ship To City
     C                     MOVELWDDBCD    PFDBCD    P      Ship To State C
     C                     MOVELWDCKTX    PFCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWDB0C7    PFB0C7           Bill to Custome
     C                     MOVELWDAETX    PFAETX    P      Bill to Name
     C                     MOVELWDB1NA    PFB1NA    P      Bill to Address
     C                     MOVELWDB3NA    PFB3NA    P      Bill to Address
     C                     MOVELWDB4NA    PFB4NA    P      Bill to Address
     C                     MOVELWDB2NA    PFB2NA    P      Bill to City
     C                     MOVELWDBHCD    PFBHCD    P      Bill to State C
     C                     MOVELWDC8TX    PFC8TX    P      Bill to Zip/Pos
     C                     MOVELWDBCNA    PFBCNA    P      Customer Purcha
     C                     Z-ADDWDA0DT    PFA0DT           Order Date
     C                     Z-ADDWDA5DT    PFA5DT           Requested Ship
     C                     Z-ADDWDGNDT    PFGNDT           Actual Shipped
     C                     Z-ADDWDACDT    PFACDT           Cancel Date
     C                     MOVELWDAQCD    PFAQCD    P      Terms Code
     C                     MOVELWDB6NA    PFB6NA    P      Special Instruc
     C                     MOVELWDBYNA    PFBYNA    P      Special Instruc
     C                     MOVELWDBZNA    PFBZNA    P      Carrier Code
     C                     MOVELWDGTST    PFGTST    P      Comment Print A
     C                     MOVELWDGVST    PFGVST    P      Comment Print I
     C                     MOVELWDGUST    PFGUST    P      Comment Print P
     C                     MOVELWDQFST    PFQFST    P      Comment Print S
     C                     MOVELWDCQCD    PFCQCD    P      Reason Code
     C                     MOVELWDGJST    PFGJST    P      Order in Use
     C                     MOVELWDGWST    PFGWST    P      Header Status
     C                     MOVELWDGXST    PFGXST    P      Header Status L
     C                     MOVELWDGYST    PFGYST    P      Order Type Prin
     C                     Z-ADDWDAODT    PFAODT           Scheduled Ship
     C                     MOVELWDAIVN    PFAIVN    P      User Original E
     C                     Z-ADDWDCXDT    PFCXDT           Date of Origina
     C                     Z-ADDWDJZVA    PFJZVA           Order Value Tot
     C                     Z-ADDWDA1WG    PFA1WG           Order Weight To
     C                     MOVELWDXIST    PFXIST    P      Credit Hold
     C                     MOVELWDXJST    PFXJST    P      Production Hold
     C                     MOVELWDXKST    PFXKST    P      New Customer Ho
     C                     Z-ADDWDEIDT    PFEIDT           Requested Deliv
     C                     Z-ADDWDAFTM    PFAFTM           Requested Deliv
     C                     MOVELWDE8CD    PFE8CD    P      Accounts Receiv
     C                     MOVELWDE9CD    PFE9CD    P      Accounts Receiv
     C                     Z-ADDWDRMNB    PFRMNB           Load ID
     C                     Z-ADDWDTBNB    PFTBNB           Absorbed Freigh
     C                     Z-ADDWDR1NB    PFR1NB           Rated Freight
     C                     MOVELWDPJST    PFPJST    P      LTL Flag
     C                     MOVELWDU0ST    PFU0ST    P      Price Audit
     C                     MOVELWDU1ST    PFU1ST    P      Price Status
     C                     MOVELWDQ2CD    PFQ2CD    P      Shipping Method
     C                     MOVELWDU2ST    PFU2ST    P      Export Status
     C                     MOVELWDVEST    PFVEST    P      Palletize
     C                     MOVELWDVFST    PFVFST    P      Shrink Wrap
     C                     MOVELWDVGST    PFVGST    P      Slip Sheet
     C                     MOVELWDRPCD    PFRPCD    P      Age Code
     C                     Z-ADDWDRNNB    PFRNNB           Reefer Temperat
     C                     MOVELWDVDST    PFVDST    P      Load Type
     C                     Z-ADDWDATIN    PFATIN           Attach to Invoi
     C                     MOVELWDU4ST    PFU4ST    P      Load Plan Order
     C                     MOVELWDU5ST    PFU5ST    P      Print Pick Slip
     C                     Z-ADDWDRSRN    PFRSRN           Resell Referenc
     C                     MOVELWDMHNA    PFMHNA    P      Special Comment
     C                     MOVELWDMINA    PFMINA    P      Special Comment
     C                     MOVELWDWBST    PFWBST    P      Affect Auto Acc
     C                     MOVELWDR4CD    PFR4CD    P      Sales Route Cod
     C                     MOVELWDBFCD    PFBFCD    P      Manager Level C
     C                     MOVELWDQ4CD    PFQ4CD    P      VP Level Code
     C                     Z-ADDWDT3NB    PFT3NB           Attach to Order
     C                     MOVELWDSICD    PFSICD    P      Reason for Pric
     C                     Z-ADDWDCONB    PFCONB           Invoice Number
     C                     MOVELWDCEST    PFCEST    P      Invoice Suffix
     C                     Z-ADDWDAWDT    PFAWDT           Invoice Date
     C                     MOVELWDJPCD    PFJPCD    P      Event Code
     C                     MOVELWDXUST    PFXUST    P      Trans Contol AS
     C                     MOVELWDZ1ST    PFZ1ST    P      Modified Flag
     C                     Z-ADDWDVRVA    PFVRVA           A/R order Value
     C                     MOVELWDOBST    PFOBST    P      Billing Activit
     C                     MOVELWDBCST    PFBCST    P      Block Order Fla
     C                     MOVELWDBDST    PFBDST    P      Order Certifica
     C                     Z-ADDWDB7VL    PFB7VL           Invoice Order V
     C                     MOVELWDGASX    PFGASX    P      Process Sts for
     C                     MOVELWDGBSX    PFGBSX    P      Order Conf Fax
     C                     MOVELWDGCSX    PFGCSX    P      Manifest Fax St
     C                     MOVELWDGDSX    PFGDSX    P      Invoice Fax Sts
     C                     MOVELWDFNSX    PFFNSX    P      Transfer in Sto
     C                     MOVELWDFOSX    PFFOSX    P      Email Cust On O
     C                     MOVELWDFPSX    PFFPSX    P      Order Emailed
     C                     MOVELWDFQSX    PFFQSX    P      Export Docs Go
     C                     MOVELWDFRSX    PFFRSX    P      Shipping Temp C
     C                     MOVELWDFSSX    PFFSSX    P      Broker Order St
     C                     MOVELWDFTSX    PFFTSX    P      Air Freight Ord
     C                     MOVELWDFUSX    PFFUSX    P      Order Requires
     C                     MOVELWDFVSX    PFFVSX    P      OH Load Plan Re
     C                     MOVELWDFWSX    PFFWSX    P      Export USDA App
     C                     MOVELWDFXSX    PFFXSX    P      HPB Ship to War
     C                     MOVELWDFYSX    PFFYSX    P      OH TF Exempt Co
     C                     Z-ADDWDNODT    PFNODT           OH Appt Confirm
     C                     Z-ADDWDNPDT    PFNPDT           JPN Invoice Iss
     C                     Z-ADDWDNQDT    PFNQDT           Load Actual Shi
     C                     Z-ADDWDNRDT    PFNRDT           Load BOL Comple
     C                     Z-ADDWDNSDT    PFNSDT           Load Truck Depa
     C                     Z-ADDWDBPTM    PFBPTM           Maximum Gross W
     C                     Z-ADDWDBQTM    PFBQTM           Time of Origina
     C                     Z-ADDWDBRTM    PFBRTM           OH Appt Confirm
     C                     Z-ADDWDBSTM    PFBSTM           Load BOL Comple
     C                     Z-ADDWDBTTM    PFBTTM           Load Truck Depa
     C                     Z-ADDWDH0NX    PFH0NX           Act Frt Referen
     C                     Z-ADDWDH1NX    PFH1NX           Act Non-Ref Frt
     C                     Z-ADDWDH2NX    PFH2NX           OH Fuel Surchar
     C                     Z-ADDWDH3NX    PFH3NX           OH Total Non-Re
     C                     Z-ADDWDH4NX    PFH4NX           OH Total Ref Fr
     C                     Z-ADDWDC0C7    PFC0C7           Claim Number
     C                     MOVELWDUVST    PFUVST    P      EDI Status 1
     C                     MOVELWDUWST    PFUWST    P      EDI Status 2
     C                     MOVELWDUXST    PFUXST    P      EDI Status 3
     C                     Z-ADDWDAATM    PFAATM           Job Time
     C                     MOVELWDAYNA    PFAYNA    P      User Id
     C                     MOVELWDA0NA    PFA0NA    P      Job Name
     C                     Z-ADDWDAXDT    PFAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Upd ReqDt Alloc ByOrd RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0134  1        Header Status
     C                     MOVEL*BLANK    WN0135  1        Header Status L
     C                     Z-ADD*ZERO     WN0136 112       Order Weight To
     C                     MOVEL*BLANK    WN0137  1        Credit Hold
     C                     MOVEL*BLANK    WN0138  1        Production Hold
     C                     Z-ADD*ZERO     WN0139 112       A/R order Value
     C                     Z-ADD*ZERO     WN0140 112       USR Order Value
     C                     MOVEL*BLANK    WN0141  1        Credit Hold Sta
     C                     Z-ADD*ZERO     WN0142  70       Parent Customer
     C                     MOVEL*BLANK    WN0143  1        Credit Check A/
     C                     MOVEL*BLANK    WN0144  1        Credit Check Pa
     C                     Z-ADD*ZERO     WN0145 112       Parent Credit L
     C                     Z-ADD*ZERO     WN0146 112       A/R Credit Limi
     C                     MOVEL*BLANK    WN0147  1        Affect Sales Do
     C                     Z-ADD*ZERO     WN0148  50       Stop/Drop
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * E3796 JJH 02/24/15 - This function was copied from the "Upd ShpDt
      *   Alloc ByLoad RT - Order Header TRG.
      * - The purpose of this function is to perform allocation and
      *   Dealocation when the Requested Ship Date Changes for an Order.
      * - All unused functionality has been removed from this function.
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0062    WEAIC3           Company Number
     C                     Z-ADDWL0063    WEC4NB           Order Number
      * Establish starting position
     C           KRSSS     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Upd ReqDt/Alc by Ord  RT - Order Detail  * 
     C                     EXSR STRVGN
      * CHG Requested Ship Dt  CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0073           Company Number
     C                     Z-ADDWEC4NB    WL0074           Order Number
     C                     Z-ADDWL0064    WL0075           Requested Ship
     C                     EXSR SVCHRC
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0170  30       Company Number
     C                     PARM WEC4NB    WQ0171  70       Order Number
     C                     PARM WEBKC7    WQ0172  70       Ship To Custome
     C           YL0078    PARM YL0078    WQ0173 112       Order Value Tot
     C           WN0136    PARM *ZERO     WQ0174 112       Order Weight To
     C                     PARM 'PS'      WQ0175  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Upd ReqDt/Alc by Ord  RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0149 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0150 112       Weight Schedule
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * E3796 JJH 02/24/15 - This function was copied from the "Upd ReqDt
      *   /Alc by Ord  RT - Order Detail.
      * - The purpose of this function is to perform allocation and
      *   Dealocation when the Requested Ship Date Changes for an Order.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQST01           Company Number
     C           *LIKE     DEFN WBC4NB    WQST02           Order Number
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQST01           Company Number
     C                     Z-ADDWEC4NB    WQST02           Order Number
      * Establish starting position
     C           KRSST     SETLL@BGWKKH                    *
     C           KRSST     READE@BGWKKH                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.OD Production Plan Sts is Yes
     C           WBR1ST    IFEQ *BLANK                     *IF
     C                     Z-ADDWBCCQT    WN0149           Quantity Schedu
     C                     Z-ADDWBAUWG    WN0150           Weight Schedule
      * E3796 JJH 02/24/15 - Changed Parameter Input Field
      *  Changed: I  Ship Date USR       FLD   DB1 Scheduled Ship Date
      *  To:      I  Ship Date USR       FLD   DB1 Requested Ship Date
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0122  30       Company Number
     C                     PARM WBC4NB    WQ0123  70       Order Number
     C                     PARM WBDPNB    WQ0124  30       Order Sequence
     C                     PARM WBUENB    WQ0125  30       Order Secondary
     C                     PARM WBHGCD    WQ0126  70       Item Code
     C                     PARM WBAJCD    WQ0127  3        Warehouse Code
     C                     PARM WBA5DT    WQ0128  70       Ship Date USR
     C                     PARM *ZERO     WQ0129 112       Quantity Ordere
     C                     PARM *ZERO     WQ0130 112       Weight Ordered
     C           WN0149    PARM WN0149    WQ0131 112       Quantity Schedu
     C           WN0150    PARM WN0150    WQ0132 112       Weight Schedule
     C                     PARM 'OD'      WQ0133  2        ATS Adj Type US
     C                     PARM @CN,002   WQ0134 10        PSAA Program Na
     C                     PARM WBRINY    WQ0135  40       Item Age Days
     C                     PARM WBTIDT    WQ0136  70       Production Ovr
     C                     PARM WBTJDT    WQ0137  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * FP1054 chg to use ordered instead of scheduled
      * (uses scheduled, not ordered)
     C                     Z-ADD*ZERO     WN0149           Quantity Schedu
     C                     Z-ADD*ZERO     WN0150           Weight Schedule
      * E3796 JJH 02/24/15 - Changed Parameter Input Field
      *  Changed: I  Ship Date USR       FLD   PAR Scheduled Ship Date
      *  To:      I  Ship Date USR       FLD   PAR Requested Ship Date
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0138  30       Company Number
     C                     PARM WBC4NB    WQ0139  70       Order Number
     C                     PARM WBDPNB    WQ0140  30       Order Sequence
     C                     PARM WBUENB    WQ0141  30       Order Secondary
     C                     PARM WBHGCD    WQ0142  70       Item Code
     C                     PARM WBAJCD    WQ0143  3        Warehouse Code
     C                     PARM WL0064    WQ0144  70       Ship Date USR
     C                     PARM WBAVQT    WQ0145 112       Quantity Ordere
     C                     PARM WBD0WG    WQ0146 112       Weight Ordered
     C           WN0149    PARM WN0149    WQ0147 112       Quantity Schedu
     C           WN0150    PARM WN0150    WQ0148 112       Weight Schedule
     C                     PARM 'OA'      WQ0149  2        ATS Adj Type US
     C                     PARM @CN,002   WQ0150 10        PSAA Program Na
     C                     PARM WBRINY    WQ0151  40       Item Age Days
     C                     PARM WBTIDT    WQ0152  70       Production Ovr
     C                     PARM WBTJDT    WQ0153  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * 10/06/16  RMC Re-instate this - want it to resched whatever it ha
      * Schedule As Ordered.   FP1054- dont sched as ordered
      * CASE: PAR.Quantity Scheduled NE DB1.Quantity Scheduled
     C           WN0149    IFNE WBCCQT                     *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0154  30       Company Number
     C                     PARM WBC4NB    WQ0155  70       Order Number
     C                     PARM WBDPNB    WQ0156  30       Order Sequence
     C                     PARM WBUENB    WQ0157  30       Order Secondary
     C                     PARM WBHGCD    WQ0158  70       Item Code
     C                     PARM WBAJCD    WQ0159  3        Warehouse Code
     C                     PARM WL0064    WQ0160  70       Ship Date USR
     C                     PARM WBCCQT    WQ0161 112       Quantity Ordere
     C                     PARM WBAUWG    WQ0162 112       Weight Ordered
     C           WN0149    PARM WN0149    WQ0163 112       Quantity Schedu
     C           WN0150    PARM WN0150    WQ0164 112       Weight Schedule
     C                     PARM 'AO'      WQ0165  2        ATS Adj Type US
     C                     PARM @CN,002   WQ0166 10        PSAA Program Na
     C                     PARM WBRINY    WQ0167  40       Item Age Days
     C                     PARM WBTIDT    WQ0168  70       Production Ovr
     C                     PARM WBTJDT    WQ0169  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * FP1054 Chg sched ship date and Sched Qty and Weight
      * E3796 JJH 02/24/15 - Use new function: Chg Reque Ship Dt/qty CH
      * Chg Reque Ship Dt/qty CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0066           Company Number
     C                     Z-ADDWBC4NB    WL0067           Order Number
     C                     Z-ADDWBDPNB    WL0068           Order Sequence
     C                     Z-ADDWBUENB    WL0069           Order Secondary
     C                     Z-ADDWN0149    WL0070           Quantity Schedu
     C                     Z-ADDWN0150    WL0071           Weight Schedule
     C                     Z-ADDWL0064    WL0072           Requested Ship
     C                     EXSR SUCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 Chg sched ship date only if prod plan is  NO  6/17/09
      * E3796 JJH 02/24/15 - Use new function: Chg Reque Ship Dt/qty CH
      * Chg Reque Ship Dt/qty CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0066           Company Number
     C                     Z-ADDWBC4NB    WL0067           Order Number
     C                     Z-ADDWBDPNB    WL0068           Order Sequence
     C                     Z-ADDWBUENB    WL0069           Order Secondary
     C                     Z-ADDWBCCQT    WL0070           Quantity Schedu
     C                     Z-ADDWBAUWG    WL0071           Weight Schedule
     C                     Z-ADDWL0064    WL0072           Requested Ship
     C                     EXSR SUCHRC
     C                     END                             *FI
     C           KRSST     READE@BGWKKH                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Reque Ship Dt/qty CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0151  70       Item Code
     C                     MOVEL*BLANK    WN0152  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0153  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0154  70       Order Group Cod
     C                     MOVEL*BLANK    WN0155  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0156  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0157 112       Billing Detail
     C                     Z-ADD*ZERO     WN0158 112       Billing Detail
     C                     Z-ADD*ZERO     WN0159 112       Billing Detail
     C                     Z-ADD*ZERO     WN0160 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0161  1        Comment Print A
     C                     MOVEL*BLANK    WN0162  1        Comment Print I
     C                     MOVEL*BLANK    WN0163  1        Comment Print P
     C                     MOVEL*BLANK    WN0164  1        Comment Print S
     C                     Z-ADD*ZERO     WN0165 112       Extended Amount
     C                     Z-ADD*ZERO     WN0166  70       Market Pricing
     C                     MOVEL*BLANK    WN0167  3        Commodity Marke
     C                     MOVEL*BLANK    WN0168  3        Date Method Cod
     C                     MOVEL*BLANK    WN0169  3        Price Method Co
     C                     Z-ADD*ZERO     WN0170 114       Price Overage O
     C                     Z-ADD*ZERO     WN0171  70       Contract Number
     C                     MOVEL*BLANK    WN0172  1        Price Status
     C                     Z-ADD*ZERO     WN0173  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0174  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0175  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0176  1        Work Confirm St
     C                     MOVEL*BLANK    WN0177  1        Work Over/Short
     C                     MOVEL*BLANK    WN0178  1        OD Production P
     C                     MOVEL*BLANK    WN0179 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0180 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0181  1        Age Code
     C                     MOVEL*BLANK    WN0182  1        Palletize
     C                     MOVEL*BLANK    WN0183  1        Slip Sheet
     C                     MOVEL*BLANK    WN0184  1        Catch Weight St
     C                     MOVEL*BLANK    WN0185  1        Price Audit
     C                     MOVEL*BLANK    WN0186  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0187  1        Production Date
     C                     Z-ADD*ZERO     WN0188 112       Rated Freight
     C                     Z-ADD*ZERO     WN0189 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0190 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0191 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0192 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0193 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0194 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0195 114       Unit Price
     C                     Z-ADD*ZERO     WN0196 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0197 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0198 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0199 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0200  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0201  70       Actual Shipped
     C                     MOVEL*BLANK    WN0202  1        Affect Inventor
     C                     MOVEL*BLANK    WN0203  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0204  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0205  30       Item Structure
     C                     Z-ADD*ZERO     WN0206  30       Item Structure
     C                     Z-ADD*ZERO     WN0207  30       Item Structure
     C                     MOVEL*BLANK    WN0208  2        Item Level
     C                     MOVEL*BLANK    WN0209  2        Quality Level
     C                     MOVEL*BLANK    WN0210  2        Pricing Product
     C                     MOVEL*BLANK    WN0211  2        Season Product
     C                     Z-ADD*ZERO     WN0212  70       Date of Origina
     C                     MOVEL*BLANK    WN0213 10        User Profile Na
     C                     MOVEL*BLANK    WN0214  6        Country Code
     C                     MOVEL*BLANK    WN0215  2        Event Code
     C                     MOVEL*BLANK    WN0216  3        Reason Code
     C                     MOVEL*BLANK    WN0217  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0218  1        Modified Flag
     C                     MOVEL*BLANK    WN0219  1        Substituted Fla
     C                     MOVEL*BLANK    WN0220  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0221 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0222 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0223  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0224  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0225  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0226  1        Affect Commissi
     C                     MOVEL*BLANK    WN0227  1        Affect Pricing
     C                     MOVEL*BLANK    WN0228  1        Released by Use
     C                     MOVEL*BLANK    WN0229  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0230  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0231  3        Production Ware
     C                     MOVEL*BLANK    WN0232  3        OD Price Type
     C                     Z-ADD*ZERO     WN0233  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0234  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0235  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0236  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0237  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0238  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0239  60       Price Code
     C                     Z-ADD*ZERO     WN0240  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0241  60       Substitution Li
     C                     Z-ADD*ZERO     WN0242  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0243 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0244 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0245 112       OD Item Target
     C                     Z-ADD*ZERO     WN0246 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0247 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0248 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0249 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0250 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0251 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0252 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0253 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0254 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0255 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0256  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0257  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0258  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0259 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0260  40       Item Age Days
     C                     Z-ADD*ZERO     WN0261  70       Production Ovr
     C                     Z-ADD*ZERO     WN0262  70       Production Ovr
     C                     MOVEL*BLANK    WN0263  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0264  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0265  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0266  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0267  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0268  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0269  1        EDI Status 1
     C                     MOVEL*BLANK    WN0270  1        EDI Status 2
     C                     MOVEL*BLANK    WN0271  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0272  60       Job Time
     C                     MOVEL*BLANK    WN0273 10        User Id
     C                     MOVEL*BLANK    WN0274 10        Job Name
     C                     Z-ADD*ZERO     WN0275  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0066    WFAIC3           Company Number
     C                     Z-ADDWL0067    WFC4NB           Order Number
     C                     Z-ADDWL0068    WFDPNB           Order Sequence
     C                     Z-ADDWL0069    WFUENB           Order Secondary
      *
     C           KLCHSU    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C           KLCHSU    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0070    WFCCQT           Quantity Schedu
     C                     Z-ADDWL0071    WFAUWG           Weight Schedule
     C                     Z-ADDWL0072    WFA5DT           Requested Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * CHG Requested Ship Dt  CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0276  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0277  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0278  70       Ship To Custome
     C                     MOVEL*BLANK    WN0279 30        Ship To Name
     C                     MOVEL*BLANK    WN0280 30        Ship To Address
     C                     MOVEL*BLANK    WN0281 30        Ship To Address
     C                     MOVEL*BLANK    WN0282 30        Ship To Address
     C                     MOVEL*BLANK    WN0283 20        Ship To City
     C                     MOVEL*BLANK    WN0284  2        Ship To State C
     C                     MOVEL*BLANK    WN0285 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0286  70       Bill to Custome
     C                     MOVEL*BLANK    WN0287 30        Bill to Name
     C                     MOVEL*BLANK    WN0288 30        Bill to Address
     C                     MOVEL*BLANK    WN0289 30        Bill to Address
     C                     MOVEL*BLANK    WN0290 30        Bill to Address
     C                     MOVEL*BLANK    WN0291 20        Bill to City
     C                     MOVEL*BLANK    WN0292  2        Bill to State C
     C                     MOVEL*BLANK    WN0293 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0294 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0295  70       Order Date
     C                     Z-ADD*ZERO     WN0296  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0297  70       Cancel Date
     C                     MOVEL*BLANK    WN0298  2        Terms Code
     C                     MOVEL*BLANK    WN0299 40        Special Instruc
     C                     MOVEL*BLANK    WN0300 40        Special Instruc
     C                     MOVEL*BLANK    WN0301  3        Carrier Code
     C                     MOVEL*BLANK    WN0302  1        Comment Print A
     C                     MOVEL*BLANK    WN0303  1        Comment Print I
     C                     MOVEL*BLANK    WN0304  1        Comment Print P
     C                     MOVEL*BLANK    WN0305  1        Comment Print S
     C                     MOVEL*BLANK    WN0306  3        Reason Code
     C                     MOVEL*BLANK    WN0307  1        Order in Use
     C                     MOVEL*BLANK    WN0308  1        Header Status
     C                     MOVEL*BLANK    WN0309  1        Header Status L
     C                     MOVEL*BLANK    WN0310  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0311  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0312 10        User Original E
     C                     Z-ADD*ZERO     WN0313  70       Date of Origina
     C                     Z-ADD*ZERO     WN0314 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0315 112       Order Weight To
     C                     MOVEL*BLANK    WN0316  1        Credit Hold
     C                     MOVEL*BLANK    WN0317  1        Production Hold
     C                     MOVEL*BLANK    WN0318  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0319  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0320  40       Requested Deliv
     C                     MOVEL*BLANK    WN0321  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0322 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0323  70       Load ID
     C                     Z-ADD*ZERO     WN0324  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0325 112       Rated Freight
     C                     MOVEL*BLANK    WN0326  1        LTL Flag
     C                     MOVEL*BLANK    WN0327  1        Price Audit
     C                     MOVEL*BLANK    WN0328  1        Price Status
     C                     MOVEL*BLANK    WN0329  2        Shipping Method
     C                     MOVEL*BLANK    WN0330  1        Export Status
     C                     MOVEL*BLANK    WN0331  1        Palletize
     C                     MOVEL*BLANK    WN0332  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0333  1        Slip Sheet
     C                     MOVEL*BLANK    WN0334  1        Age Code
     C                     Z-ADD*ZERO     WN0335  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0336  1        Load Type
     C                     Z-ADD*ZERO     WN0337  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0338  1        Load Plan Order
     C                     MOVEL*BLANK    WN0339  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0340  70       Resell Referenc
     C                     MOVEL*BLANK    WN0341 30        Special Comment
     C                     MOVEL*BLANK    WN0342 30        Special Comment
     C                     MOVEL*BLANK    WN0343  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0344  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0345  2        Manager Level C
     C                     MOVEL*BLANK    WN0346  3        VP Level Code
     C                     Z-ADD*ZERO     WN0347  70       Attach to Order
     C                     MOVEL*BLANK    WN0348  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0349  70       Invoice Number
     C                     MOVEL*BLANK    WN0350  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0351  70       Invoice Date
     C                     MOVEL*BLANK    WN0352  2        Event Code
     C                     MOVEL*BLANK    WN0353  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0354  1        Modified Flag
     C                     Z-ADD*ZERO     WN0355 112       A/R order Value
     C                     MOVEL*BLANK    WN0356  1        Billing Activit
     C                     MOVEL*BLANK    WN0357  1        Block Order Fla
     C                     MOVEL*BLANK    WN0358  1        Order Certifica
     C                     Z-ADD*ZERO     WN0359 112       Invoice Order V
     C                     MOVEL*BLANK    WN0360  1        Process Sts for
     C                     MOVEL*BLANK    WN0361  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0362  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0363  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0364  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0365  1        Email Cust On O
     C                     MOVEL*BLANK    WN0366  1        Order Emailed
     C                     MOVEL*BLANK    WN0367  1        Export Docs Go
     C                     MOVEL*BLANK    WN0368  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0369  1        Broker Order St
     C                     MOVEL*BLANK    WN0370  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0371  2        Order Requires
     C                     MOVEL*BLANK    WN0372  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0373  2        Export USDA App
     C                     MOVEL*BLANK    WN0374  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0375  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0376  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0377  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0378  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0379  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0380  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0381  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0382  60       Time of Origina
     C                     Z-ADD*ZERO     WN0383  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0384  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0385  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0386 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0387 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0388 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0389 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0390 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0391  70       Claim Number
     C                     MOVEL*BLANK    WN0392  1        EDI Status 1
     C                     MOVEL*BLANK    WN0393  1        EDI Status 2
     C                     MOVEL*BLANK    WN0394  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0395  60       Job Time
     C                     MOVEL*BLANK    WN0396 10        User Id
     C                     MOVEL*BLANK    WN0397 10        Job Name
     C                     Z-ADD*ZERO     WN0398  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0073    WDAIC3           Company Number
     C                     Z-ADDWL0074    WDC4NB           Order Number
      *
     C           KLCHSV    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C           KLCHSV    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0075    WDA5DT           Requested Ship
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPFRC
     C                     Z-ADDWDAIC3    PFAIC3           Company Number
     C                     Z-ADDWDC4NB    PFC4NB           Order Number
     C                     MOVELWDJNCD    PFJNCD    P      Order Type - Sa
     C                     Z-ADDWDANC7    PFANC7           A/R Customer Nu
     C                     Z-ADDWDBKC7    PFBKC7           Ship To Custome
     C                     MOVELWDBRTX    PFBRTX    P      Ship To Name
     C                     MOVELWDHMNA    PFHMNA    P      Ship To Address
     C                     MOVELWDHONA    PFHONA    P      Ship To Address
     C                     MOVELWDHPNA    PFHPNA    P      Ship To Address
     C                     MOVELWDHNNA    PFHNNA    P      Ship To City
     C                     MOVELWDDBCD    PFDBCD    P      Ship To State C
     C                     MOVELWDCKTX    PFCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWDB0C7    PFB0C7           Bill to Custome
     C                     MOVELWDAETX    PFAETX    P      Bill to Name
     C                     MOVELWDB1NA    PFB1NA    P      Bill to Address
     C                     MOVELWDB3NA    PFB3NA    P      Bill to Address
     C                     MOVELWDB4NA    PFB4NA    P      Bill to Address
     C                     MOVELWDB2NA    PFB2NA    P      Bill to City
     C                     MOVELWDBHCD    PFBHCD    P      Bill to State C
     C                     MOVELWDC8TX    PFC8TX    P      Bill to Zip/Pos
     C                     MOVELWDBCNA    PFBCNA    P      Customer Purcha
     C                     Z-ADDWDA0DT    PFA0DT           Order Date
     C                     Z-ADDWDA5DT    PFA5DT           Requested Ship
     C                     Z-ADDWDGNDT    PFGNDT           Actual Shipped
     C                     Z-ADDWDACDT    PFACDT           Cancel Date
     C                     MOVELWDAQCD    PFAQCD    P      Terms Code
     C                     MOVELWDB6NA    PFB6NA    P      Special Instruc
     C                     MOVELWDBYNA    PFBYNA    P      Special Instruc
     C                     MOVELWDBZNA    PFBZNA    P      Carrier Code
     C                     MOVELWDGTST    PFGTST    P      Comment Print A
     C                     MOVELWDGVST    PFGVST    P      Comment Print I
     C                     MOVELWDGUST    PFGUST    P      Comment Print P
     C                     MOVELWDQFST    PFQFST    P      Comment Print S
     C                     MOVELWDCQCD    PFCQCD    P      Reason Code
     C                     MOVELWDGJST    PFGJST    P      Order in Use
     C                     MOVELWDGWST    PFGWST    P      Header Status
     C                     MOVELWDGXST    PFGXST    P      Header Status L
     C                     MOVELWDGYST    PFGYST    P      Order Type Prin
     C                     Z-ADDWDAODT    PFAODT           Scheduled Ship
     C                     MOVELWDAIVN    PFAIVN    P      User Original E
     C                     Z-ADDWDCXDT    PFCXDT           Date of Origina
     C                     Z-ADDWDJZVA    PFJZVA           Order Value Tot
     C                     Z-ADDWDA1WG    PFA1WG           Order Weight To
     C                     MOVELWDXIST    PFXIST    P      Credit Hold
     C                     MOVELWDXJST    PFXJST    P      Production Hold
     C                     MOVELWDXKST    PFXKST    P      New Customer Ho
     C                     Z-ADDWDEIDT    PFEIDT           Requested Deliv
     C                     Z-ADDWDAFTM    PFAFTM           Requested Deliv
     C                     MOVELWDE8CD    PFE8CD    P      Accounts Receiv
     C                     MOVELWDE9CD    PFE9CD    P      Accounts Receiv
     C                     Z-ADDWDRMNB    PFRMNB           Load ID
     C                     Z-ADDWDTBNB    PFTBNB           Absorbed Freigh
     C                     Z-ADDWDR1NB    PFR1NB           Rated Freight
     C                     MOVELWDPJST    PFPJST    P      LTL Flag
     C                     MOVELWDU0ST    PFU0ST    P      Price Audit
     C                     MOVELWDU1ST    PFU1ST    P      Price Status
     C                     MOVELWDQ2CD    PFQ2CD    P      Shipping Method
     C                     MOVELWDU2ST    PFU2ST    P      Export Status
     C                     MOVELWDVEST    PFVEST    P      Palletize
     C                     MOVELWDVFST    PFVFST    P      Shrink Wrap
     C                     MOVELWDVGST    PFVGST    P      Slip Sheet
     C                     MOVELWDRPCD    PFRPCD    P      Age Code
     C                     Z-ADDWDRNNB    PFRNNB           Reefer Temperat
     C                     MOVELWDVDST    PFVDST    P      Load Type
     C                     Z-ADDWDATIN    PFATIN           Attach to Invoi
     C                     MOVELWDU4ST    PFU4ST    P      Load Plan Order
     C                     MOVELWDU5ST    PFU5ST    P      Print Pick Slip
     C                     Z-ADDWDRSRN    PFRSRN           Resell Referenc
     C                     MOVELWDMHNA    PFMHNA    P      Special Comment
     C                     MOVELWDMINA    PFMINA    P      Special Comment
     C                     MOVELWDWBST    PFWBST    P      Affect Auto Acc
     C                     MOVELWDR4CD    PFR4CD    P      Sales Route Cod
     C                     MOVELWDBFCD    PFBFCD    P      Manager Level C
     C                     MOVELWDQ4CD    PFQ4CD    P      VP Level Code
     C                     Z-ADDWDT3NB    PFT3NB           Attach to Order
     C                     MOVELWDSICD    PFSICD    P      Reason for Pric
     C                     Z-ADDWDCONB    PFCONB           Invoice Number
     C                     MOVELWDCEST    PFCEST    P      Invoice Suffix
     C                     Z-ADDWDAWDT    PFAWDT           Invoice Date
     C                     MOVELWDJPCD    PFJPCD    P      Event Code
     C                     MOVELWDXUST    PFXUST    P      Trans Contol AS
     C                     MOVELWDZ1ST    PFZ1ST    P      Modified Flag
     C                     Z-ADDWDVRVA    PFVRVA           A/R order Value
     C                     MOVELWDOBST    PFOBST    P      Billing Activit
     C                     MOVELWDBCST    PFBCST    P      Block Order Fla
     C                     MOVELWDBDST    PFBDST    P      Order Certifica
     C                     Z-ADDWDB7VL    PFB7VL           Invoice Order V
     C                     MOVELWDGASX    PFGASX    P      Process Sts for
     C                     MOVELWDGBSX    PFGBSX    P      Order Conf Fax
     C                     MOVELWDGCSX    PFGCSX    P      Manifest Fax St
     C                     MOVELWDGDSX    PFGDSX    P      Invoice Fax Sts
     C                     MOVELWDFNSX    PFFNSX    P      Transfer in Sto
     C                     MOVELWDFOSX    PFFOSX    P      Email Cust On O
     C                     MOVELWDFPSX    PFFPSX    P      Order Emailed
     C                     MOVELWDFQSX    PFFQSX    P      Export Docs Go
     C                     MOVELWDFRSX    PFFRSX    P      Shipping Temp C
     C                     MOVELWDFSSX    PFFSSX    P      Broker Order St
     C                     MOVELWDFTSX    PFFTSX    P      Air Freight Ord
     C                     MOVELWDFUSX    PFFUSX    P      Order Requires
     C                     MOVELWDFVSX    PFFVSX    P      OH Load Plan Re
     C                     MOVELWDFWSX    PFFWSX    P      Export USDA App
     C                     MOVELWDFXSX    PFFXSX    P      HPB Ship to War
     C                     MOVELWDFYSX    PFFYSX    P      OH TF Exempt Co
     C                     Z-ADDWDNODT    PFNODT           OH Appt Confirm
     C                     Z-ADDWDNPDT    PFNPDT           JPN Invoice Iss
     C                     Z-ADDWDNQDT    PFNQDT           Load Actual Shi
     C                     Z-ADDWDNRDT    PFNRDT           Load BOL Comple
     C                     Z-ADDWDNSDT    PFNSDT           Load Truck Depa
     C                     Z-ADDWDBPTM    PFBPTM           Maximum Gross W
     C                     Z-ADDWDBQTM    PFBQTM           Time of Origina
     C                     Z-ADDWDBRTM    PFBRTM           OH Appt Confirm
     C                     Z-ADDWDBSTM    PFBSTM           Load BOL Comple
     C                     Z-ADDWDBTTM    PFBTTM           Load Truck Depa
     C                     Z-ADDWDH0NX    PFH0NX           Act Frt Referen
     C                     Z-ADDWDH1NX    PFH1NX           Act Non-Ref Frt
     C                     Z-ADDWDH2NX    PFH2NX           OH Fuel Surchar
     C                     Z-ADDWDH3NX    PFH3NX           OH Total Non-Re
     C                     Z-ADDWDH4NX    PFH4NX           OH Total Ref Fr
     C                     Z-ADDWDC0C7    PFC0C7           Claim Number
     C                     MOVELWDUVST    PFUVST    P      EDI Status 1
     C                     MOVELWDUWST    PFUWST    P      EDI Status 2
     C                     MOVELWDUXST    PFUXST    P      EDI Status 3
     C                     Z-ADDWDAATM    PFAATM           Job Time
     C                     MOVELWDAYNA    PFAYNA    P      User Id
     C                     MOVELWDA0NA    PFA0NA    P      Job Name
     C                     Z-ADDWDAXDT    PFAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV ld Accpt/Load Status - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0080           Load Status
     C                     MOVEL*BLANK    YL0081           Load Acceptance
     C                     MOVEL*BLANK    P8RYSX           MG Created Load
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSW02           Load ID
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSW02           Load ID
      * Establish starting position
     C           KRSSW     SETLL@FJCPSB                    *
     C           KRSSW     READE@FJCPSB                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGPKST    YL0080           Load Status
     C                     MOVELWGRMST    YL0081           Load Acceptance
     C                     MOVELWGRYSX    P8RYSX           MG Created Load
     C           KRSSW     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * CHG Load Acceptance Sw CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0399  30       Company Number
     C                     Z-ADD*ZERO     WN0400  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0401  1        LTL Flag
     C                     MOVEL*BLANK    WN0402  1        Load Status
     C                     Z-ADD*ZERO     WN0403  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0404 15        Seal 1
     C                     MOVEL*BLANK    WN0405 15        Seal 2
     C                     MOVEL*BLANK    WN0406 15        Seal 3
     C                     MOVEL*BLANK    WN0407 15        Seal 4
     C                     MOVEL*BLANK    WN0408 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0409  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0410 112       Flat Amount
     C                     MOVEL*BLANK    WN0411  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0412  50       Total Stops
     C                     MOVEL*BLANK    WN0413 20        Trailer Id
     C                     MOVEL*BLANK    WN0414  3        Transloader Car
     C                     Z-ADD*ZERO     WN0415  40       BOL Time
     C                     MOVEL*BLANK    WN0416  3        Carrier Code
     C                     MOVEL*BLANK    WN0417  7        Truck Size
     C                     Z-ADD*ZERO     WN0418  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0419 112       Rated Freight
     C                     MOVEL*BLANK    WN0420  1        Ship Status
     C                     MOVEL*BLANK    WN0421  1        Load Type
     C                     Z-ADD*ZERO     WN0422  50       Number Pallets
     C                     Z-ADD*ZERO     WN0423  50       Number Pallets
     C                     Z-ADD*ZERO     WN0424 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0425  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0426  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0427  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0428 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0429 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0430  70       Actual Departur
     C                     Z-ADD*ZERO     WN0431  40       Departure Time
     C                     Z-ADD*ZERO     WN0432  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0433  52       Product Tempera
     C                     Z-ADD*ZERO     WN0434  50       Number Spacers
     C                     MOVEL*BLANK    WN0435 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0436  70       Total Load Mile
     C                     MOVEL*BLANK    WN0437 12        Recorder ID
     C                     MOVEL*BLANK    WN0438  2        Shipping Method
     C                     MOVEL*BLANK    WN0439  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0440  2        Ship To State C
     C                     Z-ADD*ZERO     WN0441  70       Gross Weight
     C                     MOVEL*BLANK    WN0442  3        Carrier Broker
     C                     MOVEL*BLANK    WN0443  1        Export Status
     C                     Z-ADD*ZERO     WN0444  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0445  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0446  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0447  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0448  70       Spotted Date
     C                     Z-ADD*ZERO     WN0449  60       Spotted Time
     C                     Z-ADD*ZERO     WN0450  70       Load Finished D
     C                     Z-ADD*ZERO     WN0451  60       Load Finished T
     C                     Z-ADD*ZERO     WN0452  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0453  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0454  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0455  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0456  70       Truck Departure
     C                     Z-ADD*ZERO     WN0457  60       Truck Departure
     C                     Z-ADD*ZERO     WN0458  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0459  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0460  3        Shipping Line
     C                     MOVEL*BLANK    WN0461 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0462 30        Vessel Name
     C                     Z-ADD*ZERO     WN0463  50       Voyage
     C                     Z-ADD*ZERO     WN0464  70       Sail Date
     C                     MOVEL*BLANK    WN0465 12        Booking Number
     C                     MOVEL*BLANK    WN0466 20        Discharge Port
     C                     Z-ADD*ZERO     WN0467  70       Arrival Date
     C                     MOVEL*BLANK    WN0468 12        Container Numbe
     C                     Z-ADD*ZERO     WN0469  70       Date In
     C                     Z-ADD*ZERO     WN0470  60       Time In
     C                     Z-ADD*ZERO     WN0471  70       Date Out
     C                     Z-ADD*ZERO     WN0472  60       Time Out
     C                     Z-ADD*ZERO     WN0473 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0474  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0475  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0476  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0477  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0478  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0479  70       Requested Deliv
     C                     MOVEL*BLANK    WN0480  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0481  70       On Yard Date
     C                     Z-ADD*ZERO     WN0482  60       On Yard Time
     C                     Z-ADD*ZERO     WN0483  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0484  60       Deadline Depart
     C                     MOVEL*BLANK    WN0485  1        Load Held Over
     C                     MOVEL*BLANK    WN0486  1        Load Held Over
     C                     MOVEL*BLANK    WN0487 15        Load Held Over
     C                     MOVEL*BLANK    WN0488 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0489 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0490  70       Express Mail Da
     C                     MOVEL*BLANK    WN0491  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0492  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0493  70       Product Complet
     C                     Z-ADD*ZERO     WN0494  60       Product Complet
     C                     Z-ADD*ZERO     WN0495  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0496  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0497  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0498  1        Load Confirmed
     C                     MOVEL*BLANK    WN0499 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0500  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0501  60       Load Door 1
     C                     Z-ADD*ZERO     WN0502  70       Override Total
     C                     Z-ADD*ZERO     WN0503  60       Load Door 2
     C                     MOVEL*BLANK    WN0504  1        Partial Load
     C                     MOVEL*BLANK    WN0505  1        Load Confirmati
     C                     MOVEL*BLANK    WN0506  1        Export Load USD
     C                     MOVEL*BLANK    WN0507  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0508 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0509 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0510 15        Late Billing Em
     C                     MOVEL*BLANK    WN0511 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0512 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0513  1        Multi Company L
     C                     MOVEL*BLANK    WN0514  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0515  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0516  1        LH Power Only L
     C                     MOVEL*BLANK    WN0517  1        MG Created Load
     C                     MOVEL*BLANK    WN0518  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0519  2        Load U/M
     C                     MOVEL*BLANK    WN0520  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0521  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0522  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0523  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0524  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0525  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0526  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0527  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0528  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0529  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0530  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0531  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0532  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0533  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0534  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0535  60       LH Unused Time
     C                     MOVEL*BLANK    WN0536  1        EDI Status 1
     C                     MOVEL*BLANK    WN0537  1        EDI Status 2
     C                     MOVEL*BLANK    WN0538  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0539  60       Job Time
     C                     MOVEL*BLANK    WN0540 10        User Id
     C                     MOVEL*BLANK    WN0541 10        Job Name
     C                     Z-ADD*ZERO     WN0542  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADD#1RMNB    WHRMNB           Load ID
      *
     C           KLCHSX    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHSX    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * Move non-key fields to @FJCPBO
     C                     MOVEL'U'       WHRMST    P      Load Acceptance
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Chg LD APPT w/req RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WIC4NB    WQSY02           Order Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSY01           Company Number
     C                     Z-ADD#1C4NB    WQSY02           Order Number
      * Establish starting position
     C           KRSSY     SETLL@FLCPW9                    *
     C           KRSSY     READE@FLCPW9                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Upd Ld Carr Appt if entered
      * CASE: DB1.LD Carrier Appt Date is Entered
     C           WIN7DT    IFGT 0                          *IF
     C                     Z-ADD#RJYDT    YL0082           LD Carrier Appt
     C           #RTMPK    MULT 100       YL0083           LD Carrier Appt
      * Chg LD APPT/CNFRM    CH - Load Detail  * 
     C                     EXSR SZCHRC
      * Exc Email Ord RqDtChg XF - Order Header TRG  * 
     C                     CALL 'PBEPXFR'              90  Exc Email Ord R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WIAIC3    WQ0176  30       Company Number
     C                     PARM WIC4NB    WQ0177  70       Order Number
     C                     PARM #1R4CD    WQ0178  3        Sales Route Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBEPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C           KRSSY     READE@FLCPW9                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg LD APPT/CNFRM    CH - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0543 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0544  50       Miles to next s
     C                     Z-ADD*ZERO     WN0545  72       Freight Charge
     C                     Z-ADD*ZERO     WN0546  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0547 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0548  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0549 112       Rated Freight
     C                     Z-ADD*ZERO     WN0550  30       Company Number
     C                     Z-ADD*ZERO     WN0551  70       Order Number
     C                     MOVEL*BLANK    WN0552  1        Ship Status
     C                     Z-ADD*ZERO     WN0553  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0554  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0555  70       Appointment Con
     C                     Z-ADD*ZERO     WN0556  60       Appointment Con
     C                     Z-ADD*ZERO     WN0557  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0558  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0559  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0560  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0561  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0562  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0563  70       On Yard Date
     C                     Z-ADD*ZERO     WN0564  60       On Yard Time
     C                     Z-ADD*ZERO     WN0565  70       MPC Number
     C                     MOVEL*BLANK    WN0566  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0567  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0568 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0569 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0570 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0571 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0572 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0573  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0574  60       LD Unused Time
     C                     MOVEL*BLANK    WN0575  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0576  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0577  2        HPB Transload S
     C                     MOVEL*BLANK    WN0578 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0579 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN0580 25        Cust Assigned A
     C                     MOVEL*BLANK    WN0581  1        EDI Status 1
     C                     MOVEL*BLANK    WN0582  1        EDI Status 2
     C                     MOVEL*BLANK    WN0583  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0584  60       Job Time
     C                     MOVEL*BLANK    WN0585 10        User Id
     C                     MOVEL*BLANK    WN0586 10        Job Name
     C                     Z-ADD*ZERO     WN0587  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWIRMNB    WJRMNB           Load ID
     C                     Z-ADDWIRUNB    WJRUNB           Stop/Drop Seque
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WJRMNB           Load ID
     C                     KFLD           WJRUNB           Stop/Drop Seque
     C           KLCHSZ    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YERDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWIRVNB    WJRVNB           Stop/Drop
     C                     MOVELWIK5TX    WJK5TX    P      Confirmation Ma
     C                     MOVELWIW5CD    WJW5CD    P      Confirmation Nu
     C                     Z-ADDYL0082    WJN7DT           LD Carrier Appt
     C                     Z-ADDWIN8DT    WJN8DT           LD Unused Date
     C                     Z-ADDYL0083    WJB3TM           LD Carrier Appt
     C                     Z-ADDWIB4TM    WJB4TM           LD Unused Time
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Upd WHS/Alc by Order  RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0588  1        Trans Contol AS
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3           Company Number
     C                     Z-ADD#1C4NB    WEC4NB           Order Number
      * Establish starting position
     C           KRSTA     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Upd WHS/Alc by Order RT - Order Detail  * 
     C                     EXSR TBRVGN
      * RTV Whse Type,Control  RT - Warehouse  * 
     C                     EXSR TERVGN
      * CHG Trans Control      CH - Order Header TRG  * 
     C                     EXSR TFCHRC
      * Change Load Hdr warehouse, and recalc load miles       * OMS259
      * ** 11/16/2007 LJB FP1251 Total Load Miles will=zeros if there is
      * ** no Miles Between Cities record
      * CASE: DB1.Load ID is NE Blank
     C           WERMNB    IFNE 0                          *IF
      * Rtv/Chg Whs,ld miles  RT - OM Load Header  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
     C                     ENDIF
      * USER: Exit processing
      * FP1054  post order so it will come off prod hold if it can
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0229  30       Company Number
     C                     PARM WEC4NB    WQ0230  70       Order Number
     C                     PARM WEBKC7    WQ0231  70       Ship To Custome
     C           YL0085    PARM YL0085    WQ0232 112       Order Value Tot
     C           YL0086    PARM *ZERO     WQ0233 112       Order Weight To
     C                     PARM 'OE'      WQ0234  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Upd WHS/Alc by Order RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0589 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0590 112       Weight Schedule
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** PA PROCESS - USE REQUESTED SHIP DATE FOR Ship Date USR ****
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQTB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQTB02           Order Number
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQTB01           Company Number
     C                     Z-ADDWEC4NB    WQTB02           Order Number
      * Establish starting position
     C           KRSTB     SETLL@BGWKKH                    *
     C           KRSTB     READE@BGWKKH                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWBCCQT    WN0589           Quantity Schedu
     C                     Z-ADDWBAUWG    WN0590           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0179  30       Company Number
     C                     PARM WBC4NB    WQ0180  70       Order Number
     C                     PARM WBDPNB    WQ0181  30       Order Sequence
     C                     PARM WBUENB    WQ0182  30       Order Secondary
     C                     PARM WBHGCD    WQ0183  70       Item Code
     C                     PARM WBAJCD    WQ0184  3        Warehouse Code
     C                     PARM WBA5DT    WQ0185  70       Ship Date USR
     C                     PARM *ZERO     WQ0186 112       Quantity Ordere
     C                     PARM *ZERO     WQ0187 112       Weight Ordered
     C           WN0589    PARM WN0589    WQ0188 112       Quantity Schedu
     C           WN0590    PARM WN0590    WQ0189 112       Weight Schedule
     C                     PARM 'OD'      WQ0190  2        ATS Adj Type US
     C                     PARM @CN,003   WQ0191 10        PSAA Program Na
     C                     PARM WBRINY    WQ0192  40       Item Age Days
     C                     PARM WBTIDT    WQ0193  70       Production Ovr
     C                     PARM WBTJDT    WQ0194  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     Z-ADD*ZERO     WN0589           Quantity Schedu
     C                     Z-ADD*ZERO     WN0590           Weight Schedule
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0195  30       Company Number
     C                     PARM WBC4NB    WQ0196  70       Order Number
     C                     PARM WBDPNB    WQ0197  30       Order Sequence
     C                     PARM WBUENB    WQ0198  30       Order Secondary
     C                     PARM WBHGCD    WQ0199  70       Item Code
     C                     PARM #RAJCD    WQ0200  3        Warehouse Code
     C                     PARM WBA5DT    WQ0201  70       Ship Date USR
     C                     PARM WBCCQT    WQ0202 112       Quantity Ordere
     C                     PARM WBAUWG    WQ0203 112       Weight Ordered
     C           WN0589    PARM WN0589    WQ0204 112       Quantity Schedu
     C           WN0590    PARM WN0590    WQ0205 112       Weight Schedule
     C                     PARM 'OA'      WQ0206  2        ATS Adj Type US
     C                     PARM @CN,003   WQ0207 10        PSAA Program Na
     C                     PARM WBRINY    WQ0208  40       Item Age Days
     C                     PARM WBTIDT    WQ0209  70       Production Ovr
     C                     PARM WBTJDT    WQ0210  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * Schedule As Ordered.
      * CASE: PAR.Quantity Scheduled NE DB1.Quantity Scheduled
     C           WN0589    IFNE WBCCQT                     *IF
      * UPD Avail-To-Sell  ORD XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDQNXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0211  30       Company Number
     C                     PARM WBC4NB    WQ0212  70       Order Number
     C                     PARM WBDPNB    WQ0213  30       Order Sequence
     C                     PARM WBUENB    WQ0214  30       Order Secondary
     C                     PARM WBHGCD    WQ0215  70       Item Code
     C                     PARM #RAJCD    WQ0216  3        Warehouse Code
     C                     PARM WBA5DT    WQ0217  70       Ship Date USR
     C                     PARM WBCCQT    WQ0218 112       Quantity Ordere
     C                     PARM WBAUWG    WQ0219 112       Weight Ordered
     C           WN0589    PARM WN0589    WQ0220 112       Quantity Schedu
     C           WN0590    PARM WN0590    WQ0221 112       Weight Schedule
     C                     PARM 'AO'      WQ0222  2        ATS Adj Type US
     C                     PARM @CN,003   WQ0223 10        PSAA Program Na
     C                     PARM WBRINY    WQ0224  40       Item Age Days
     C                     PARM WBTIDT    WQ0225  70       Production Ovr
     C                     PARM WBTJDT    WQ0226  70       Production Ovr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     END                             *FI
      * FP1054 upd production warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR TCRVGN
      * Chg Warehouse         CH - Order Detail  * 
     C                     EXSR TDCHRC
     C           KRSTB     READE@BGWKKH                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBAJCD    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSTC     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0084           Production Ware
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKAOCD    YL0084           Production Ware
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * Chg Warehouse         CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0591  70       Item Code
     C                     Z-ADD*ZERO     WN0592  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0593  70       Order Group Cod
     C                     MOVEL*BLANK    WN0594  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0595  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0596 112       Billing Detail
     C                     Z-ADD*ZERO     WN0597 112       Billing Detail
     C                     Z-ADD*ZERO     WN0598 112       Billing Detail
     C                     Z-ADD*ZERO     WN0599 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0600  1        Comment Print A
     C                     MOVEL*BLANK    WN0601  1        Comment Print I
     C                     MOVEL*BLANK    WN0602  1        Comment Print P
     C                     MOVEL*BLANK    WN0603  1        Comment Print S
     C                     Z-ADD*ZERO     WN0604 112       Extended Amount
     C                     Z-ADD*ZERO     WN0605  70       Market Pricing
     C                     MOVEL*BLANK    WN0606  3        Commodity Marke
     C                     MOVEL*BLANK    WN0607  3        Date Method Cod
     C                     MOVEL*BLANK    WN0608  3        Price Method Co
     C                     Z-ADD*ZERO     WN0609 114       Price Overage O
     C                     Z-ADD*ZERO     WN0610  70       Contract Number
     C                     MOVEL*BLANK    WN0611  1        Price Status
     C                     Z-ADD*ZERO     WN0612  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0613  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0614  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0615  1        Work Confirm St
     C                     MOVEL*BLANK    WN0616  1        Work Over/Short
     C                     MOVEL*BLANK    WN0617  1        OD Production P
     C                     MOVEL*BLANK    WN0618 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0619 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0620  1        Age Code
     C                     MOVEL*BLANK    WN0621  1        Palletize
     C                     MOVEL*BLANK    WN0622  1        Slip Sheet
     C                     MOVEL*BLANK    WN0623  1        Catch Weight St
     C                     MOVEL*BLANK    WN0624  1        Price Audit
     C                     MOVEL*BLANK    WN0625  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0626  1        Production Date
     C                     Z-ADD*ZERO     WN0627 112       Rated Freight
     C                     Z-ADD*ZERO     WN0628 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0629 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0630 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0631 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0632 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0633 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0634 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0635 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0636 114       Unit Price
     C                     Z-ADD*ZERO     WN0637 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0638 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0639 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0640 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0641  70       Requested Ship
     C                     Z-ADD*ZERO     WN0642  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0643  70       Actual Shipped
     C                     MOVEL*BLANK    WN0644  1        Affect Inventor
     C                     MOVEL*BLANK    WN0645  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0646  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0647  30       Item Structure
     C                     Z-ADD*ZERO     WN0648  30       Item Structure
     C                     Z-ADD*ZERO     WN0649  30       Item Structure
     C                     MOVEL*BLANK    WN0650  2        Item Level
     C                     MOVEL*BLANK    WN0651  2        Quality Level
     C                     MOVEL*BLANK    WN0652  2        Pricing Product
     C                     MOVEL*BLANK    WN0653  2        Season Product
     C                     Z-ADD*ZERO     WN0654  70       Date of Origina
     C                     MOVEL*BLANK    WN0655 10        User Profile Na
     C                     MOVEL*BLANK    WN0656  6        Country Code
     C                     MOVEL*BLANK    WN0657  2        Event Code
     C                     MOVEL*BLANK    WN0658  3        Reason Code
     C                     MOVEL*BLANK    WN0659  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0660  1        Modified Flag
     C                     MOVEL*BLANK    WN0661  1        Substituted Fla
     C                     MOVEL*BLANK    WN0662  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0663 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0664 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0665  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0666  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0667  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0668  1        Affect Commissi
     C                     MOVEL*BLANK    WN0669  1        Affect Pricing
     C                     MOVEL*BLANK    WN0670  1        Released by Use
     C                     MOVEL*BLANK    WN0671  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0672  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0673  3        OD Price Type
     C                     Z-ADD*ZERO     WN0674  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0675  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0676  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0677  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0678  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0679  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0680  60       Price Code
     C                     Z-ADD*ZERO     WN0681  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0682  60       Substitution Li
     C                     Z-ADD*ZERO     WN0683  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0684 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0685 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0686 112       OD Item Target
     C                     Z-ADD*ZERO     WN0687 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0688 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0689 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0690 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0691 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0692 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0693 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0694 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0695 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0696 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0697  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0698  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0699  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0700 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0701  40       Item Age Days
     C                     Z-ADD*ZERO     WN0702  70       Production Ovr
     C                     Z-ADD*ZERO     WN0703  70       Production Ovr
     C                     MOVEL*BLANK    WN0704  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0705  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0706  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0707  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0708  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0709  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0710  1        EDI Status 1
     C                     MOVEL*BLANK    WN0711  1        EDI Status 2
     C                     MOVEL*BLANK    WN0712  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0713  60       Job Time
     C                     MOVEL*BLANK    WN0714 10        User Id
     C                     MOVEL*BLANK    WN0715 10        Job Name
     C                     Z-ADD*ZERO     WN0716  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWBAIC3    WFAIC3           Company Number
     C                     Z-ADDWBC4NB    WFC4NB           Order Number
     C                     Z-ADDWBDPNB    WFDPNB           Order Sequence
     C                     Z-ADDWBUENB    WFUENB           Order Secondary
      *
     C           KLCHTD    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C           KLCHTD    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YFRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL#RAJCD    WFAJCD    P      Warehouse Code
     C                     MOVELYL0084    WFF6SX    P      Production Ware
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Whse Type,Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#RAJCD    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSTE     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WUWPST           Warehouse Type
     C                     MOVEL*BLANK    WN0588           Trans Contol AS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKWPST    WUWPST           Warehouse Type
     C                     MOVELWKXUST    WN0588           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * CHG Trans Control      CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0717  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0718  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0719  70       Ship To Custome
     C                     MOVEL*BLANK    WN0720 30        Ship To Name
     C                     MOVEL*BLANK    WN0721 30        Ship To Address
     C                     MOVEL*BLANK    WN0722 30        Ship To Address
     C                     MOVEL*BLANK    WN0723 30        Ship To Address
     C                     MOVEL*BLANK    WN0724 20        Ship To City
     C                     MOVEL*BLANK    WN0725  2        Ship To State C
     C                     MOVEL*BLANK    WN0726 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0727  70       Bill to Custome
     C                     MOVEL*BLANK    WN0728 30        Bill to Name
     C                     MOVEL*BLANK    WN0729 30        Bill to Address
     C                     MOVEL*BLANK    WN0730 30        Bill to Address
     C                     MOVEL*BLANK    WN0731 30        Bill to Address
     C                     MOVEL*BLANK    WN0732 20        Bill to City
     C                     MOVEL*BLANK    WN0733  2        Bill to State C
     C                     MOVEL*BLANK    WN0734 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0735 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0736  70       Order Date
     C                     Z-ADD*ZERO     WN0737  70       Requested Ship
     C                     Z-ADD*ZERO     WN0738  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0739  70       Cancel Date
     C                     MOVEL*BLANK    WN0740  2        Terms Code
     C                     MOVEL*BLANK    WN0741 40        Special Instruc
     C                     MOVEL*BLANK    WN0742 40        Special Instruc
     C                     MOVEL*BLANK    WN0743  3        Carrier Code
     C                     MOVEL*BLANK    WN0744  1        Comment Print A
     C                     MOVEL*BLANK    WN0745  1        Comment Print I
     C                     MOVEL*BLANK    WN0746  1        Comment Print P
     C                     MOVEL*BLANK    WN0747  1        Comment Print S
     C                     MOVEL*BLANK    WN0748  3        Reason Code
     C                     MOVEL*BLANK    WN0749  1        Order in Use
     C                     MOVEL*BLANK    WN0750  1        Header Status
     C                     MOVEL*BLANK    WN0751  1        Header Status L
     C                     MOVEL*BLANK    WN0752  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0753  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0754 10        User Original E
     C                     Z-ADD*ZERO     WN0755  70       Date of Origina
     C                     Z-ADD*ZERO     WN0756 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0757 112       Order Weight To
     C                     MOVEL*BLANK    WN0758  1        Credit Hold
     C                     MOVEL*BLANK    WN0759  1        Production Hold
     C                     MOVEL*BLANK    WN0760  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0761  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0762  40       Requested Deliv
     C                     MOVEL*BLANK    WN0763  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0764 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0765  70       Load ID
     C                     Z-ADD*ZERO     WN0766  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0767 112       Rated Freight
     C                     MOVEL*BLANK    WN0768  1        LTL Flag
     C                     MOVEL*BLANK    WN0769  1        Price Audit
     C                     MOVEL*BLANK    WN0770  1        Price Status
     C                     MOVEL*BLANK    WN0771  2        Shipping Method
     C                     MOVEL*BLANK    WN0772  1        Export Status
     C                     MOVEL*BLANK    WN0773  1        Palletize
     C                     MOVEL*BLANK    WN0774  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0775  1        Slip Sheet
     C                     MOVEL*BLANK    WN0776  1        Age Code
     C                     Z-ADD*ZERO     WN0777  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0778  1        Load Type
     C                     Z-ADD*ZERO     WN0779  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0780  1        Load Plan Order
     C                     MOVEL*BLANK    WN0781  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0782  70       Resell Referenc
     C                     MOVEL*BLANK    WN0783 30        Special Comment
     C                     MOVEL*BLANK    WN0784 30        Special Comment
     C                     MOVEL*BLANK    WN0785  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0786  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0787  2        Manager Level C
     C                     MOVEL*BLANK    WN0788  3        VP Level Code
     C                     Z-ADD*ZERO     WN0789  70       Attach to Order
     C                     MOVEL*BLANK    WN0790  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0791  70       Invoice Number
     C                     MOVEL*BLANK    WN0792  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0793  70       Invoice Date
     C                     MOVEL*BLANK    WN0794  2        Event Code
     C                     MOVEL*BLANK    WN0795  1        Modified Flag
     C                     Z-ADD*ZERO     WN0796 112       A/R order Value
     C                     MOVEL*BLANK    WN0797  1        Billing Activit
     C                     MOVEL*BLANK    WN0798  1        Block Order Fla
     C                     MOVEL*BLANK    WN0799  1        Order Certifica
     C                     Z-ADD*ZERO     WN0800 112       Invoice Order V
     C                     MOVEL*BLANK    WN0801  1        Process Sts for
     C                     MOVEL*BLANK    WN0802  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0803  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0804  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0805  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0806  1        Email Cust On O
     C                     MOVEL*BLANK    WN0807  1        Order Emailed
     C                     MOVEL*BLANK    WN0808  1        Export Docs Go
     C                     MOVEL*BLANK    WN0809  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0810  1        Broker Order St
     C                     MOVEL*BLANK    WN0811  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0812  2        Order Requires
     C                     MOVEL*BLANK    WN0813  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0814  2        Export USDA App
     C                     MOVEL*BLANK    WN0815  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0816  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0817  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0818  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0819  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0820  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0821  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0822  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0823  60       Time of Origina
     C                     Z-ADD*ZERO     WN0824  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0825  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0826  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0827 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0828 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0829 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0830 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0831 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0832  70       Claim Number
     C                     MOVEL*BLANK    WN0833  1        EDI Status 1
     C                     MOVEL*BLANK    WN0834  1        EDI Status 2
     C                     MOVEL*BLANK    WN0835  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0836  60       Job Time
     C                     MOVEL*BLANK    WN0837 10        User Id
     C                     MOVEL*BLANK    WN0838 10        Job Name
     C                     Z-ADD*ZERO     WN0839  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWEAIC3    WDAIC3           Company Number
     C                     Z-ADDWEC4NB    WDC4NB           Order Number
      *
     C           KLCHTF    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C           KLCHTF    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YGRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWN0588    WDXUST    P      Trans Contol AS
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPFRC
     C                     Z-ADDWDAIC3    PFAIC3           Company Number
     C                     Z-ADDWDC4NB    PFC4NB           Order Number
     C                     MOVELWDJNCD    PFJNCD    P      Order Type - Sa
     C                     Z-ADDWDANC7    PFANC7           A/R Customer Nu
     C                     Z-ADDWDBKC7    PFBKC7           Ship To Custome
     C                     MOVELWDBRTX    PFBRTX    P      Ship To Name
     C                     MOVELWDHMNA    PFHMNA    P      Ship To Address
     C                     MOVELWDHONA    PFHONA    P      Ship To Address
     C                     MOVELWDHPNA    PFHPNA    P      Ship To Address
     C                     MOVELWDHNNA    PFHNNA    P      Ship To City
     C                     MOVELWDDBCD    PFDBCD    P      Ship To State C
     C                     MOVELWDCKTX    PFCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWDB0C7    PFB0C7           Bill to Custome
     C                     MOVELWDAETX    PFAETX    P      Bill to Name
     C                     MOVELWDB1NA    PFB1NA    P      Bill to Address
     C                     MOVELWDB3NA    PFB3NA    P      Bill to Address
     C                     MOVELWDB4NA    PFB4NA    P      Bill to Address
     C                     MOVELWDB2NA    PFB2NA    P      Bill to City
     C                     MOVELWDBHCD    PFBHCD    P      Bill to State C
     C                     MOVELWDC8TX    PFC8TX    P      Bill to Zip/Pos
     C                     MOVELWDBCNA    PFBCNA    P      Customer Purcha
     C                     Z-ADDWDA0DT    PFA0DT           Order Date
     C                     Z-ADDWDA5DT    PFA5DT           Requested Ship
     C                     Z-ADDWDGNDT    PFGNDT           Actual Shipped
     C                     Z-ADDWDACDT    PFACDT           Cancel Date
     C                     MOVELWDAQCD    PFAQCD    P      Terms Code
     C                     MOVELWDB6NA    PFB6NA    P      Special Instruc
     C                     MOVELWDBYNA    PFBYNA    P      Special Instruc
     C                     MOVELWDBZNA    PFBZNA    P      Carrier Code
     C                     MOVELWDGTST    PFGTST    P      Comment Print A
     C                     MOVELWDGVST    PFGVST    P      Comment Print I
     C                     MOVELWDGUST    PFGUST    P      Comment Print P
     C                     MOVELWDQFST    PFQFST    P      Comment Print S
     C                     MOVELWDCQCD    PFCQCD    P      Reason Code
     C                     MOVELWDGJST    PFGJST    P      Order in Use
     C                     MOVELWDGWST    PFGWST    P      Header Status
     C                     MOVELWDGXST    PFGXST    P      Header Status L
     C                     MOVELWDGYST    PFGYST    P      Order Type Prin
     C                     Z-ADDWDAODT    PFAODT           Scheduled Ship
     C                     MOVELWDAIVN    PFAIVN    P      User Original E
     C                     Z-ADDWDCXDT    PFCXDT           Date of Origina
     C                     Z-ADDWDJZVA    PFJZVA           Order Value Tot
     C                     Z-ADDWDA1WG    PFA1WG           Order Weight To
     C                     MOVELWDXIST    PFXIST    P      Credit Hold
     C                     MOVELWDXJST    PFXJST    P      Production Hold
     C                     MOVELWDXKST    PFXKST    P      New Customer Ho
     C                     Z-ADDWDEIDT    PFEIDT           Requested Deliv
     C                     Z-ADDWDAFTM    PFAFTM           Requested Deliv
     C                     MOVELWDE8CD    PFE8CD    P      Accounts Receiv
     C                     MOVELWDE9CD    PFE9CD    P      Accounts Receiv
     C                     Z-ADDWDRMNB    PFRMNB           Load ID
     C                     Z-ADDWDTBNB    PFTBNB           Absorbed Freigh
     C                     Z-ADDWDR1NB    PFR1NB           Rated Freight
     C                     MOVELWDPJST    PFPJST    P      LTL Flag
     C                     MOVELWDU0ST    PFU0ST    P      Price Audit
     C                     MOVELWDU1ST    PFU1ST    P      Price Status
     C                     MOVELWDQ2CD    PFQ2CD    P      Shipping Method
     C                     MOVELWDU2ST    PFU2ST    P      Export Status
     C                     MOVELWDVEST    PFVEST    P      Palletize
     C                     MOVELWDVFST    PFVFST    P      Shrink Wrap
     C                     MOVELWDVGST    PFVGST    P      Slip Sheet
     C                     MOVELWDRPCD    PFRPCD    P      Age Code
     C                     Z-ADDWDRNNB    PFRNNB           Reefer Temperat
     C                     MOVELWDVDST    PFVDST    P      Load Type
     C                     Z-ADDWDATIN    PFATIN           Attach to Invoi
     C                     MOVELWDU4ST    PFU4ST    P      Load Plan Order
     C                     MOVELWDU5ST    PFU5ST    P      Print Pick Slip
     C                     Z-ADDWDRSRN    PFRSRN           Resell Referenc
     C                     MOVELWDMHNA    PFMHNA    P      Special Comment
     C                     MOVELWDMINA    PFMINA    P      Special Comment
     C                     MOVELWDWBST    PFWBST    P      Affect Auto Acc
     C                     MOVELWDR4CD    PFR4CD    P      Sales Route Cod
     C                     MOVELWDBFCD    PFBFCD    P      Manager Level C
     C                     MOVELWDQ4CD    PFQ4CD    P      VP Level Code
     C                     Z-ADDWDT3NB    PFT3NB           Attach to Order
     C                     MOVELWDSICD    PFSICD    P      Reason for Pric
     C                     Z-ADDWDCONB    PFCONB           Invoice Number
     C                     MOVELWDCEST    PFCEST    P      Invoice Suffix
     C                     Z-ADDWDAWDT    PFAWDT           Invoice Date
     C                     MOVELWDJPCD    PFJPCD    P      Event Code
     C                     MOVELWDXUST    PFXUST    P      Trans Contol AS
     C                     MOVELWDZ1ST    PFZ1ST    P      Modified Flag
     C                     Z-ADDWDVRVA    PFVRVA           A/R order Value
     C                     MOVELWDOBST    PFOBST    P      Billing Activit
     C                     MOVELWDBCST    PFBCST    P      Block Order Fla
     C                     MOVELWDBDST    PFBDST    P      Order Certifica
     C                     Z-ADDWDB7VL    PFB7VL           Invoice Order V
     C                     MOVELWDGASX    PFGASX    P      Process Sts for
     C                     MOVELWDGBSX    PFGBSX    P      Order Conf Fax
     C                     MOVELWDGCSX    PFGCSX    P      Manifest Fax St
     C                     MOVELWDGDSX    PFGDSX    P      Invoice Fax Sts
     C                     MOVELWDFNSX    PFFNSX    P      Transfer in Sto
     C                     MOVELWDFOSX    PFFOSX    P      Email Cust On O
     C                     MOVELWDFPSX    PFFPSX    P      Order Emailed
     C                     MOVELWDFQSX    PFFQSX    P      Export Docs Go
     C                     MOVELWDFRSX    PFFRSX    P      Shipping Temp C
     C                     MOVELWDFSSX    PFFSSX    P      Broker Order St
     C                     MOVELWDFTSX    PFFTSX    P      Air Freight Ord
     C                     MOVELWDFUSX    PFFUSX    P      Order Requires
     C                     MOVELWDFVSX    PFFVSX    P      OH Load Plan Re
     C                     MOVELWDFWSX    PFFWSX    P      Export USDA App
     C                     MOVELWDFXSX    PFFXSX    P      HPB Ship to War
     C                     MOVELWDFYSX    PFFYSX    P      OH TF Exempt Co
     C                     Z-ADDWDNODT    PFNODT           OH Appt Confirm
     C                     Z-ADDWDNPDT    PFNPDT           JPN Invoice Iss
     C                     Z-ADDWDNQDT    PFNQDT           Load Actual Shi
     C                     Z-ADDWDNRDT    PFNRDT           Load BOL Comple
     C                     Z-ADDWDNSDT    PFNSDT           Load Truck Depa
     C                     Z-ADDWDBPTM    PFBPTM           Maximum Gross W
     C                     Z-ADDWDBQTM    PFBQTM           Time of Origina
     C                     Z-ADDWDBRTM    PFBRTM           OH Appt Confirm
     C                     Z-ADDWDBSTM    PFBSTM           Load BOL Comple
     C                     Z-ADDWDBTTM    PFBTTM           Load Truck Depa
     C                     Z-ADDWDH0NX    PFH0NX           Act Frt Referen
     C                     Z-ADDWDH1NX    PFH1NX           Act Non-Ref Frt
     C                     Z-ADDWDH2NX    PFH2NX           OH Fuel Surchar
     C                     Z-ADDWDH3NX    PFH3NX           OH Total Non-Re
     C                     Z-ADDWDH4NX    PFH4NX           OH Total Ref Fr
     C                     Z-ADDWDC0C7    PFC0C7           Claim Number
     C                     MOVELWDUVST    PFUVST    P      EDI Status 1
     C                     MOVELWDUWST    PFUWST    P      EDI Status 2
     C                     MOVELWDUXST    PFUXST    P      EDI Status 3
     C                     Z-ADDWDAATM    PFAATM           Job Time
     C                     MOVELWDAYNA    PFAYNA    P      User Id
     C                     MOVELWDA0NA    PFA0NA    P      Job Name
     C                     Z-ADDWDAXDT    PFAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PFRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - OM Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0840  70       Total Load Mile
     C                     MOVEL*BLANK    WN0841  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0842  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0843  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWERMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTG     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
     C                     EXSR THRVGN
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           FJAJCD    IFEQ WN0841                     *IF
     C                     MOVEL*BLANK    WN0842           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELFJAJCD    WN0842           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           FJRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDFJTLMI    WN0840           Total Load Mile
     C                     Z-ADDFJK2DT    WN0843           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADDFJRMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WN0840    PARM WN0840    WQ0227  70       Total Load Mile
     C           WN0843    PARM WN0843    WQ0228  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR TKCHRC
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQTH02           Load ID
      * Define keylist
     C           KPSTH     KLIST
     C                     KFLD           WQTH02           Load ID
     C                     KFLD           WARVNB           Stop/Drop
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH02           Load ID
      * Setup key
     C                     Z-ADDFJRMNB    WQTH02           Load ID
     C                     Z-ADD1         WARVNB           Stop/Drop
      * Establish starting position
     C           KPSTH     SETLL@FLCPEB                    *
     C           KRSTH     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR TIRVGN
     C                     GOTO THEXIT                     *QUIT
     C           KRSTH     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQTI01           Company Number
     C           *LIKE     DEFN WCC4NB    WQTI02           Order Number
      * Define keylist
     C           KPSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQTI01           Company Number
     C                     Z-ADDWAC4NB    WQTI02           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
      * Establish starting position
     C           KPSTI     SETLL@BGWKAE                    *
     C           KRSTI     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0841           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR TJRVGN
      * PAR = DB1 By name
     C                     MOVELWCAJCD    WN0841           Warehouse Code
     C                     GOTO TIEXIT                     *QUIT
     C           KRSTI     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWCAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSTJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0844  30       Company Number
     C                     Z-ADD*ZERO     WN0845  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0846  1        LTL Flag
     C                     MOVEL*BLANK    WN0847  1        Load Status
     C                     Z-ADD*ZERO     WN0848  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0849 15        Seal 1
     C                     MOVEL*BLANK    WN0850 15        Seal 2
     C                     MOVEL*BLANK    WN0851 15        Seal 3
     C                     MOVEL*BLANK    WN0852 15        Seal 4
     C                     MOVEL*BLANK    WN0853 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0854  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0855 112       Flat Amount
     C                     MOVEL*BLANK    WN0856  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0857  50       Total Stops
     C                     MOVEL*BLANK    WN0858 20        Trailer Id
     C                     MOVEL*BLANK    WN0859  3        Transloader Car
     C                     Z-ADD*ZERO     WN0860  40       BOL Time
     C                     MOVEL*BLANK    WN0861  3        Carrier Code
     C                     MOVEL*BLANK    WN0862  7        Truck Size
     C                     Z-ADD*ZERO     WN0863  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0864 112       Rated Freight
     C                     MOVEL*BLANK    WN0865  1        Ship Status
     C                     MOVEL*BLANK    WN0866  1        Load Type
     C                     Z-ADD*ZERO     WN0867  50       Number Pallets
     C                     Z-ADD*ZERO     WN0868  50       Number Pallets
     C                     Z-ADD*ZERO     WN0869 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0870  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0871  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0872  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0873 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0874 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0875  70       Actual Departur
     C                     Z-ADD*ZERO     WN0876  40       Departure Time
     C                     Z-ADD*ZERO     WN0877  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0878  52       Product Tempera
     C                     Z-ADD*ZERO     WN0879  50       Number Spacers
     C                     MOVEL*BLANK    WN0880 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0881 12        Recorder ID
     C                     MOVEL*BLANK    WN0882  2        Shipping Method
     C                     MOVEL*BLANK    WN0883  2        Ship To State C
     C                     Z-ADD*ZERO     WN0884  70       Gross Weight
     C                     MOVEL*BLANK    WN0885  3        Carrier Broker
     C                     MOVEL*BLANK    WN0886  1        Export Status
     C                     Z-ADD*ZERO     WN0887  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0888  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0889  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0890  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0891  70       Spotted Date
     C                     Z-ADD*ZERO     WN0892  60       Spotted Time
     C                     Z-ADD*ZERO     WN0893  70       Load Finished D
     C                     Z-ADD*ZERO     WN0894  60       Load Finished T
     C                     Z-ADD*ZERO     WN0895  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0896  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0897  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0898  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0899  70       Truck Departure
     C                     Z-ADD*ZERO     WN0900  60       Truck Departure
     C                     Z-ADD*ZERO     WN0901  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0902  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0903  3        Shipping Line
     C                     MOVEL*BLANK    WN0904 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0905 30        Vessel Name
     C                     Z-ADD*ZERO     WN0906  50       Voyage
     C                     Z-ADD*ZERO     WN0907  70       Sail Date
     C                     MOVEL*BLANK    WN0908 12        Booking Number
     C                     MOVEL*BLANK    WN0909 20        Discharge Port
     C                     Z-ADD*ZERO     WN0910  70       Arrival Date
     C                     MOVEL*BLANK    WN0911 12        Container Numbe
     C                     Z-ADD*ZERO     WN0912  70       Date In
     C                     Z-ADD*ZERO     WN0913  60       Time In
     C                     Z-ADD*ZERO     WN0914  70       Date Out
     C                     Z-ADD*ZERO     WN0915  60       Time Out
     C                     Z-ADD*ZERO     WN0916 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0917  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0918  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0919  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0920  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0921  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0922  70       Requested Deliv
     C                     MOVEL*BLANK    WN0923  1        Load Acceptance
     C                     Z-ADD*ZERO     WN0924  70       On Yard Date
     C                     Z-ADD*ZERO     WN0925  60       On Yard Time
     C                     Z-ADD*ZERO     WN0926  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0927  60       Deadline Depart
     C                     MOVEL*BLANK    WN0928  1        Load Held Over
     C                     MOVEL*BLANK    WN0929  1        Load Held Over
     C                     MOVEL*BLANK    WN0930 15        Load Held Over
     C                     MOVEL*BLANK    WN0931 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0932 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0933  70       Express Mail Da
     C                     MOVEL*BLANK    WN0934  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0935  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0936  70       Product Complet
     C                     Z-ADD*ZERO     WN0937  60       Product Complet
     C                     Z-ADD*ZERO     WN0938  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0939  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0940  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0941  1        Load Confirmed
     C                     MOVEL*BLANK    WN0942 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0943  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0944  60       Load Door 1
     C                     Z-ADD*ZERO     WN0945  60       Load Door 2
     C                     MOVEL*BLANK    WN0946  1        Partial Load
     C                     MOVEL*BLANK    WN0947  1        Load Confirmati
     C                     MOVEL*BLANK    WN0948  1        Export Load USD
     C                     MOVEL*BLANK    WN0949  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0950 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0951 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0952 15        Late Billing Em
     C                     MOVEL*BLANK    WN0953 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0954 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0955  1        Multi Company L
     C                     MOVEL*BLANK    WN0956  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0957  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0958  1        LH Power Only L
     C                     MOVEL*BLANK    WN0959  1        MG Created Load
     C                     MOVEL*BLANK    WN0960  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0961  2        Load U/M
     C                     MOVEL*BLANK    WN0962  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0963  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0964  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0965  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0966  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0967  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0968  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0969  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0970  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0971  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0972  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0973  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0974  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0975  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0976  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0977  60       LH Unused Time
     C                     MOVEL*BLANK    WN0978  1        EDI Status 1
     C                     MOVEL*BLANK    WN0979  1        EDI Status 2
     C                     MOVEL*BLANK    WN0980  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0981  60       Job Time
     C                     MOVEL*BLANK    WN0982 10        User Id
     C                     MOVEL*BLANK    WN0983 10        Job Name
     C                     Z-ADD*ZERO     WN0984  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDFJRMNB    WHRMNB           Load ID
      *
     C           KLCHTK    KLIST
     C                     KFLD           WHRMNB           Load ID
     C           KLCHTK    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YHRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0840    WHTLMI           Total Load Mile
     C                     MOVELWN0841    WHVPCD    P      Ship From Wareh
     C                     MOVELWN0842    WHAJCD    P      Warehouse Code
     C                     Z-ADDWN0843    WHK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * CRT IC Item Balance    RT - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0985 114       Unit Cost Per P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQTL01           Company Number
     C           *LIKE     DEFN OMC4NB    WQTL02           Order Number
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTL01           Company Number
     C                     Z-ADD#1C4NB    WQTL02           Order Number
      * Establish starting position
     C           KRSTL     SETLL@BGWKL1                    *
     C           KRSTL     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Val Item Bal Exist    RT - IC Item Balance  * 
     C                     EXSR TMRVGN
      * If item balance record is not found, create one
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
      * CLC Rtv Unit Cost/LB   XF - IC Item Balance  * 
     C                     CALL 'PDLSXFR'              90  CLC Rtv Unit Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM OMAIC3    WQ0235  30       Company Number
     C                     PARM OMHGCD    WQ0236  70       Item Code
     C                     PARM OMAJCD    WQ0237  3        Warehouse Code
     C           WN0985    PARM WN0985    WQ0238 114       Unit Cost Per P
     C           WUBACS    PARM WUBACS    WQ0239 114       Cost per Primar
     C           WUGIDT    PARM WUGIDT    WQ0240  70       Pricing Date Us
     C           WUU1ST    PARM WUU1ST    WQ0241  1        Price Status
     C                     PARM ##JDT     WQ0242  70       As of Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Crt Item Balance       CR - IC Item Balance  * 
     C                     EXSR TNCRRC
     C                     END                             *FI
     C           KRSTL     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Val Item Bal Exist    RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           B0AIC3           Company Number
     C                     KFLD           B0HGCD           Item Code
     C                     KFLD           B0AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDOMAIC3    B0AIC3           Company Number
     C                     Z-ADDOMHGCD    B0HGCD           Item Code
     C                     MOVELOMAJCD    B0AJCD           Warehouse Code
      * Establish starting position
     C           KRSTM     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUWXST           Record Found US
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - IC Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0986  60       Job Time
     C                     MOVEL*BLANK    WN0987 10        User Id
     C                     MOVEL*BLANK    WN0988 10        Job Name
     C                     Z-ADD*ZERO     WN0989  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDOMAIC3    WLAIC3           Company Number
     C                     Z-ADDOMHGCD    WLHGCD           Item Code
     C                     MOVELOMAJCD    WLAJCD           Warehouse Code
     C                     Z-ADDWN0985    WLAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WLAECS           Last Cost
     C                     Z-ADD*ZERO     WLBACS           Cost per Primar
     C                     Z-ADD*ZERO     WLBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WLCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WLGUDT           Revaluation Eff
     C                     MOVEL*BLANK    WLXYST           Revaluation Cos
     C                     Z-ADD*ZERO     WLCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WLG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WLBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WLDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WLDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WLDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WLHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WLHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WLAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WLAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WLAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WLEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WLDOQT           Quantity Avail.
     C                     MOVEL*BLANK    WLATNA           Cycle Count Cod
     C                     Z-ADD*ZERO     WLAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WLANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WLIDVA           Value of On Han
     C                     MOVEL'N'       WLJVST           Inventory Plann
     C                     Z-ADD*ZERO     WLBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WLDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WLDIDT           Stock Out Date
     C                     MOVEL*BLANK    WLALCD           Buyer Code
     C                     Z-ADD*ZERO     WLBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WLDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WLBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WLDKDT           Lead Time - Dat
     C                     MOVEL'N'       WLJ2ST           Lead Time - Exc
     C                     Z-ADD*ZERO     WLDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WLBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WLDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WLDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WLDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WLDMDT           Last Physical C
     C                     MOVEL'N'       WLM0ST           Requisition Mod
     C                     MOVEL'N'       WLJ9ST           Cost Update Pen
     C                     MOVEL'N'       WLKBST           Post G/L Status
     C                     Z-ADD*ZERO     WLAKC8           Vendor - Item/W
     C                     Z-ADDOMRINB    WLRINB           Item Structure
     C                     Z-ADDOMRHNB    WLRHNB           Item Structure
     C                     Z-ADDOMRGNB    WLRGNB           Item Structure
     C                     MOVEL*BLANK    WLUVST           EDI Status 1
     C                     MOVEL*BLANK    WLUWST           EDI Status 2
     C                     MOVEL*BLANK    WLUXST           EDI Status 3
     C                     MOVEL'A'       WLVSST           Record Status
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WLAATM' defaulted for 'Job Time'.
      * Field '(DB1) WLAYNA' defaulted for 'User Id'.
      * Field '(DB1) WLA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WLAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
     C           KLCRTN    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRTN    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'Item Balance           EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0990    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTO     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    #PI6ST           Allow Multi-Com
     C                     MOVELDRMPNA    #PMPNA           Default Printer
     C                     MOVELDRBCCD    #PBCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0088           Company Number
     C                     MOVELDRBUVN    WN0991           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0076    DTAJVN           User Profile Na
     C                     MOVELWL0077    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTP     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0078           Company Number
     C                     MOVELDTAJCD    WL0079           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTQ01           Application Cod
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTQ01           Application Cod
     C                     MOVEL'P/S'     WQTQ01           Application Cod
      * Establish starting position
     C           KRSTQ     SETLL@DNRESF                    *
     C           KRSTQ     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TRRVGN
     C                     END                             *FI
     C           KRSTQ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTR01           Application Cod
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTR01           Application Cod
      * Establish starting position
     C           KRSTR     SETLL@DNRESF                    *
     C           KRSTR     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTR     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV Load Str Company  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSTS     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0021           Company Number
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAIC3    YL0021           Company Number
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDYL0021    KMAIC3           Company Number
     C                     MOVEL@CN,004   KMV8CD           Company Value C
      * Establish starting position
     C           KRSTT     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    YL0060           System Value Al
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTU     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0058           Application WHS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI7ST    YL0058           Application WHS
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Deadline Depart Date/Time
      *================================================================
      * ** Get DDD/T from Load Detail                         W288
      * RTV 1st Stop Info      RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0006           Load ID
     C                     Z-ADD1         WL0008           Stop/Drop
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0013           Stop/Drop Seque
     C                     MOVELWL0009    YL0014    P      Comments for Pi
     C                     Z-ADDWL0010    YL0015           Miles to next s
     C                     Z-ADDWL0011    YL0016           Freight Charge
     C                     Z-ADDWL0012    YL0017           Ld Hdr/Ld Dtl U
     C                     Z-ADDWL0013    YL0018           Freight Misc. C
     C                     Z-ADDWL0014    YL0019           Freight Stop Ch
     C                     Z-ADDWL0015    YL0020           Rated Freight
     C                     Z-ADDWL0016    YL0021           Company Number
     C                     Z-ADDWL0017    YL0022           Order Number
     C                     MOVELWL0018    YL0023    P      Ship Status
     C                     Z-ADDWL0019    YL0024           Estimated Arriv
     C                     Z-ADDWL0020    YL0025           Estimated Arriv
     C                     Z-ADDWL0021    YL0026           Appointment Con
     C                     Z-ADDWL0022    YL0027           Appointment Con
     C                     MOVELWL0023    YL0028    P      Confirmation Ma
     C                     MOVELWL0024    YL0029    P      Confirmation Nu
     C                     Z-ADDWL0025    YL0030           Actual Delivery
     C                     Z-ADDWL0026    YL0031           Actual Delivery
     C                     Z-ADDWL0027    YL0032           Scheduled Deliv
     C                     Z-ADDWL0028    YL0033           Scheduled Deliv
     C                     Z-ADDWL0029    YL0034           Deadline Depart
     C                     Z-ADDWL0030    YL0035           Deadline Depart
     C                     Z-ADDWL0031    YL0036           On Yard Date
     C                     Z-ADDWL0032    YL0037           On Yard Time
     C                     Z-ADDWL0033    YL0038           MPC Number
     C                     MOVELWL0034    YL0039    P      Load Dtl On Tim
     C                     MOVELWL0035    YL0040    P      On Time Add'l R
     C                     MOVELWL0036    YL0041    P      Seal Nbr 1
     C                     MOVELWL0037    YL0042    P      Seal Nbr 2
     C                     MOVELWL0038    YL0043    P      Seal Nbr 3
     C                     MOVELWL0039    YL0044    P      Seal Nbr 4
     C                     MOVELWL0040    YL0045    P      Seal Nbr 5
     C                     Z-ADDWL0041    YL0046           LD Carrier Appt
     C                     Z-ADDWL0042    YL0047           LD Unused Date
     C                     Z-ADDWL0043    YL0048           LD Unused Date
     C                     Z-ADDWL0044    YL0049           LD Carrier Appt
     C                     Z-ADDWL0045    YL0050           LD Unused Time
     C                     Z-ADDWL0046    YL0051           LD Unused Time
     C                     MOVELWL0047    YL0052    P      Miles Error Sts
     C                     MOVELWL0048    YL0053    P      LD Unused Sts 2
     C                     MOVELWL0049    YL0054    P      HPB Transload S
     C                     MOVELWL0050    YL0055    P      LD Cst Svc Trac
     C                     MOVELWL0051    YL0056    P      Carrier Ref PRO
     C                     MOVELWL0052    YL0057    P      Cust Assigned A
      * CASE: LCL.Deadline Depart DT    HDR is not entered
     C           YL0034    IFEQ *ZERO                      *IF
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           P8RYSX    IFEQ *BLANK                     *IF
      * if export w/no state then default in SSD and 8:00am for time
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Export Status is yes
      *   |- c2    : DB1.Ship To State Code is International Accounts
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BEU2ST    IFEQ 'Y'                        *IF
     C           BEDBCD    IFEQ '.'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * WRK.Month NBR USR = CTL.Scheduled Ship Date USR *MONTH
     C           #CHODT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUI9NX
     C                     MOVELWUI9NX    WUMONT           Month USR
      * WRK.Day NBR USR = CTL.Scheduled Ship Date USR *DAY OF MONTH
     C           #CHODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WUDNBU
     C                     MOVELWUDNBU    WUI5TX           Day USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMONT    CAT  WUI5TX:ZQ WUUBT1    P      Month/Day Alpha
     C                     MOVE WUUBT1    #RYANB           Deadline Depart
      * default time to 8:00am
     C                     Z-ADD0800      #RYBNB           Deadline Depart
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ** DDD/T to MM/DD, HH/MM conversion                W288
     C                     EXSR UBSUBR                     ** DDD/T to MM/
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ** DDD/T to MM/DD, HH/MM conversion                W288
      *================================================================
      * convert date to mm/dd
      * WRK.Month NBR USR = LCL.Deadline Depart DT    HDR *MONTH
     C           YL0034    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUI9NX
     C                     MOVELWUI9NX    WUMONT           Month USR
      * WRK.Day NBR USR = LCL.Deadline Depart DT    HDR *DAY OF MONTH
     C           YL0034    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WUDNBU
     C                     MOVELWUDNBU    WUI5TX           Day USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMONT    CAT  WUI5TX:ZQ WUUBT1    P      Month/Day Alpha
     C                     MOVE WUUBT1    #RYANB           Deadline Depart
      * convert time to hh/mm
      * WRK.Hour 1 USR = LCL.Deadline Depart Time  HDR *HOURS
     C                     Z-ADDYL0035    XTTIM
     C                     Z-ADDXTHH      WUIJNX
     C                     MOVELWUIJNX    WUVDCD           Hours  2A
      * WRK.@Minutes = LCL.Deadline Depart Time  HDR *MINUTES
     C                     Z-ADDYL0035    XTTIM
     C                     Z-ADDXTNN      WUG7NX
     C                     MOVELWUG7NX    WUVECD           Minutes  2A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVDCD    CAT  WUVECD:ZQ WUVBCD    P      Time  4A
     C                     MOVE WUVBCD    #RYBNB           Deadline Depart
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Deadline Depart Date/Time, Shipping Restrictions-Seaboard only
      *================================================================
      * ** Retrieve 1st stop order number                       W288
      * RTV 1st Stop Info      RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0006           Load ID
     C                     Z-ADD1         WL0008           Stop/Drop
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0013           Stop/Drop Seque
     C                     MOVELWL0009    YN0002    P      Comments for Pi
     C                     Z-ADDWL0010    YN0003           Miles to next s
     C                     Z-ADDWL0011    YN0004           Freight Charge
     C                     Z-ADDWL0012    YN0005           Ld Hdr/Ld Dtl U
     C                     Z-ADDWL0013    YN0006           Freight Misc. C
     C                     Z-ADDWL0014    YN0007           Freight Stop Ch
     C                     Z-ADDWL0015    YN0008           Rated Freight
     C                     Z-ADDWL0016    YN0009           Company Number
     C                     Z-ADDWL0017    YL0022           Order Number
     C                     MOVELWL0018    YN0010    P      Ship Status
     C                     Z-ADDWL0019    YN0011           Estimated Arriv
     C                     Z-ADDWL0020    YN0012           Estimated Arriv
     C                     Z-ADDWL0021    YN0013           Appointment Con
     C                     Z-ADDWL0022    YN0014           Appointment Con
     C                     MOVELWL0023    YN0015    P      Confirmation Ma
     C                     MOVELWL0024    YN0016    P      Confirmation Nu
     C                     Z-ADDWL0025    YN0017           Actual Delivery
     C                     Z-ADDWL0026    YN0018           Actual Delivery
     C                     Z-ADDWL0027    YN0019           Scheduled Deliv
     C                     Z-ADDWL0028    YN0020           Scheduled Deliv
     C                     Z-ADDWL0029    YN0021           Deadline Depart
     C                     Z-ADDWL0030    YN0022           Deadline Depart
     C                     Z-ADDWL0031    YN0023           On Yard Date
     C                     Z-ADDWL0032    YN0024           On Yard Time
     C                     Z-ADDWL0033    YN0025           MPC Number
     C                     MOVELWL0034    YN0026    P      Load Dtl On Tim
     C                     MOVELWL0035    YN0027    P      On Time Add'l R
     C                     MOVELWL0036    YN0028    P      Seal Nbr 1
     C                     MOVELWL0037    YN0029    P      Seal Nbr 2
     C                     MOVELWL0038    YN0030    P      Seal Nbr 3
     C                     MOVELWL0039    YN0031    P      Seal Nbr 4
     C                     MOVELWL0040    YN0032    P      Seal Nbr 5
     C                     Z-ADDWL0041    YL0046           LD Carrier Appt
     C                     Z-ADDWL0042    YN0033           LD Unused Date
     C                     Z-ADDWL0043    YN0034           LD Unused Date
     C                     Z-ADDWL0044    YL0049           LD Carrier Appt
     C                     Z-ADDWL0045    YN0035           LD Unused Time
     C                     Z-ADDWL0046    YN0036           LD Unused Time
     C                     MOVELWL0047    YN0037    P      Miles Error Sts
     C                     MOVELWL0048    YN0038    P      LD Unused Sts 2
     C                     MOVELWL0049    YN0039    P      HPB Transload S
     C                     MOVELWL0050    YN0040    P      LD Cst Svc Trac
     C                     MOVELWL0051    YN0041    P      Carrier Ref PRO
     C                     MOVELWL0052    YN0042    P      Cust Assigned A
      * Only calc DDD/T for 1st stop order                    W288
      * CASE: RCD.Order Number EQ LCL.Order Number
     C           #1C4NB    IFEQ YL0022                     *IF
     C                     Z-ADD#RJYDT    YL0034           Deadline Depart
      * ** Calc DDD/T from Scheduled Delivery Date/Time       W288
      * IF NOT MG LOAD-->  ADDED 1.18.2017 RMC
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           P8RYSX    IFEQ *BLANK                     *IF
      *
     C                     Z-ADD*ZERO     WN0001  60       Deadline Depart
      *
      * CLC Deadline Date/Time IF
      * ** Convert time from 4.0 to 6.0
     C           #RTMPK    MULT 100       WN0001           Deadline Depart
      *
     C                     Z-ADD*ZERO     WN0002  51       Hours Required
     C                     Z-ADD*ZERO     WN0003  50       Miles to next s
     C                     Z-ADD*ZERO     WN0004  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0005  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0006  50       @Days 5
     C                     Z-ADD*ZERO     WN0007  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0008  20       USR Period
     C                     Z-ADD*ZERO     WN0009  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0010  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UDSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
     C                     EXSR SLRVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0072    IFEQ 'CT'                       *IF
     C           YL0072    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0058           Load ID
     C                     Z-ADD*ZERO     WL0059           Stop/Drop
     C                     Z-ADD*ZERO     WL0060           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0061    WN0003           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0003    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0072  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0073  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0058           Load ID
     C                     Z-ADD*ZERO     WL0059           Stop/Drop
     C                     Z-ADD*ZERO     WL0060           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0061    WN0003           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0003    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     YL0034           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0001           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0002           Hours Required
     C                     Z-ADD*ZERO     YL0073           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
     C                     EXSR SNRVGN
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0074  70       Load ID
     C           YL0074    PARM YL0074    WQ0075  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C           YL0073    ADD  YL0074    WN0002           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0002    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0002    DIV  24        WN0006           @Days 5
     C           WN0006    MULT 24        WU               USR Hours 5.0
     C           WN0002    SUB  WU        WN0004           USR Hours 5.0
     C           WN0004    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0006    IFGT 0                          *IF
     C                     MULT -1        WN0006           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           YL0034    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0006    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0034
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0034
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0001                     *IF
     C                     SUB  WN0001    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0006           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           YL0034    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0006    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0034
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0034
     C                     END
     C           240000    SUB  WUPINB    WN0001           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0001           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      * ** Convert time back to 6.0
     C                     Z-ADDWN0001    YL0035           Deadline Depart
      * ***** Change Log and Comments
     C                     EXSR UESUBR                     ***** Change Lo
      * ** If Export & no state code, dflt DDD = SSD & DDT = 8:00am   W28
      * CASE: LCL.Deadline Depart DT    HDR is not entered
     C           YL0034    IFEQ *ZERO                      *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Export Status is yes
      *   |- c2    : RCD.Ship To State Code is International Accounts
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1U2ST    IFEQ 'Y'                        *IF
     C           #1DBCD    IFEQ '.'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD#CHODT    YL0034           Deadline Depart
     C                     Z-ADD80000     YL0035           Deadline Depart
     C                     MOVEL*BLANK    #RB7SX           Must Ship Error
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0076  30       Company Number
     C                     PARM *BLANK    WQ0077  1        Plant Company S
     C           YL0061    PARM *BLANK    WQ0078  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Seaboard only
      * CASE: LCL.Company Organization is Seaboard
     C           YL0061    IFEQ 'S'                        *IF
      * ** Only test dates if Access Limited is Yes     W288
      * CASE: PAR.Access Limited Sts USR is yes
     C           P3HHST    IFEQ 'Y'                        *IF
      * CASE: PAR.MG Created Load is Yes
     C           P8RYSX    IFEQ 'Y'                        *IF
      * S7362 JJH 10/20/16 - Do not send error if MG created Load
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Prevent Scheduled Ship Date after Deadline Depart   W288
      * CASE: CTL.Scheduled Ship Date USR GT LCL.Deadline Depart DT    HD
     C           #CHODT    IFGT YL0034                     *IF
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #CHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0019
      * Send message 'Invalid Dt Chg-DDD/T err1'
     C                     MOVEL'USR4222' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9831  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve Shipping restricted hours (maintained by scheduling)
      * ** (this is maintained by scheduling)                 W288
      * RTV Dock Unavail Range XF - Warehouse Control  * 
     C                     CALL 'PNNIXFR'              90  RTV Dock Unavai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #RAJCD    WQ0079  3        Warehouse Code
     C           WUDPTM    PARM *ZERO     WQ0080  60       Dock Unavail St
     C           WUDQTM    PARM *ZERO     WQ0081  60       Dock Unavail En
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
      * ** DDT cannot be during Shipping Restricted Hours  W288
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      *       skip - not an error if no record
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Dock Unavail Start Time is Zeros
      *   |- c2    : WRK.Dock Unavail End Time is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDPTM    IFEQ *ZERO                      *IF
     C           WUDQTM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *       skip - not an error if times are zeros
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If SSD = DDD then enforce Restricted Time Range    W288
      * CASE: LCL.Deadline Depart DT    HDR EQ CTL.Scheduled Ship Date US
     C           YL0034    IFEQ #CHODT                     *IF
      * CASE: PAR.MG Created Load is Yes
     C           P8RYSX    IFEQ 'Y'                        *IF
      * S7362 JJH 10/20/16 - Do not send error if MG created load.
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Error if DDT falls within Shipping Restricted hours   W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Deadline Depart Time  HDR GE WRK.Dock Unavail St
      *   |- c2    : LCL.Deadline Depart Time  HDR LE WRK.Dock Unavail En
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0035    IFGE WUDPTM                     *IF
     C           YL0035    IFLE WUDQTM                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#RTMPK    ZA0020           Sched Delivery
      * Send message 'Invalid Dt Chg-DDD/T err2'
     C                     MOVEL'USR4223' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** DDD/T cannot be in the past. Truck will not have time to load
      * ** and leave.                                         W288
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WUSDTE    PARM *ZERO     WQ0082 155       Current System
     C           WUZHNB    PARM *ZERO     WQ0083 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * ** Error if DDD = Today & DDT is before system time   W288
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Deadline Depart DT    HDR EQ WRK.Current System
      *   |- c2    : LCL.Deadline Depart Time  HDR LE WRK.Current System
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0034    IFEQ WUSDTE                     *IF
     C           YL0035    IFLE WUZHNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Requested Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #RGYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0021
      * Send message 'Invalid Deadln Dt/Tm'
     C                     MOVEL'USR4233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9836  *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * IF NOT MG LOAD-->  ADDED 1.18.2017 RMC
      * CASE: PAR.MG Created Load is Not MG Created Load
     C           P8RYSX    IFEQ *BLANK                     *IF
      * ** DDD/T to MM/DD, HH/MM conversion                    W288
     C                     EXSR UFSUBR                     ** DDD/T to MM/
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 08/12/2008 LJB E00207
      * ** Total Load Miles can be overriden. This will not change the
      * ** Deadline Depart date, however.
      * *****
      * ** 11/16/2007 LJB FP1251
      * ** Date and time are set to zeros if there is no
      * ** Miles Between Cites record which means there were no
      * ** total load miles calculated.
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * ** DDD/T to MM/DD, HH/MM conversion                    W288
      *================================================================
      * convert date to mm/dd
      * WRK.Month NBR USR = LCL.Deadline Depart DT    HDR *MONTH
     C           YL0034    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUI9NX
     C                     MOVELWUI9NX    WUMONT           Month USR
      * WRK.Day NBR USR = LCL.Deadline Depart DT    HDR *DAY OF MONTH
     C           YL0034    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WUDNBU
     C                     MOVELWUDNBU    WUI5TX           Day USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMONT    CAT  WUI5TX:ZQ WUUBT1    P      Month/Day Alpha
     C                     MOVE WUUBT1    #RYANB           Deadline Depart
      * convert time to hh/mm
      * WRK.Hour 1 USR = LCL.Deadline Depart Time  HDR *HOURS
     C                     Z-ADDYL0035    XTTIM
     C                     Z-ADDXTHH      WUIJNX
     C                     MOVELWUIJNX    WUVDCD           Hours  2A
      * WRK.@Minutes = LCL.Deadline Depart Time  HDR *MINUTES
     C                     Z-ADDYL0035    XTTIM
     C                     Z-ADDXTNN      WUG7NX
     C                     MOVELWUG7NX    WUVECD           Minutes  2A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVDCD    CAT  WUVECD:ZQ WUVBCD    P      Time  4A
     C                     MOVE WUVBCD    #RYBNB           Deadline Depart
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Perform validation on age days
      *================================================================
      * testreviewvaldtl
      * FP1309 perform validation on every detail line and if error
      * report this back to the order header (detail screen)
      * ** Use ctl SSD and rcd RDD from the screen in case they have chan
     C                     MOVEL'N'       YL0068           Error Status  3
      * Val Chgd ShpDt/ItmAge  Rt - Order Detail  * 
     C                     EXSR SPRVGN
      * CASE: LCL.Error Status  3 is Yes
     C           YL0068    IFEQ 'Y'                        *IF
      * Send message 'Age Days/OvrDate Invalid'
     C                     MOVEL'USR4355' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       YL0006           Error Flag
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * ** DDD/T to MM/DD, HH/MM conversion                    W288
      *================================================================
      * convert date to mm/dd
      * WRK.Month NBR USR = LCL.Deadline Depart DT    HDR *MONTH
     C           YL0034    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WUI9NX
     C                     MOVELWUI9NX    WUMONT           Month USR
      * WRK.Day NBR USR = LCL.Deadline Depart DT    HDR *DAY OF MONTH
     C           YL0034    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WUDNBU
     C                     MOVELWUDNBU    WUI5TX           Day USR
     C                     Z-ADD*ZERO     ZQ      50
     C           WUMONT    CAT  WUI5TX:ZQ WUUBT1    P      Month/Day Alpha
     C                     MOVE WUUBT1    #RYANB           Deadline Depart
     C                     Z-ADD#RYANB    WUYANB           Deadline Depart
      * convert time to hh/mm
      * WRK.Hour 1 USR = LCL.Deadline Depart Time  HDR *HOURS
     C                     Z-ADDYL0035    XTTIM
     C                     Z-ADDXTHH      WUIJNX
     C                     MOVELWUIJNX    WUVDCD           Hours  2A
      * WRK.@Minutes = LCL.Deadline Depart Time  HDR *MINUTES
     C                     Z-ADDYL0035    XTTIM
     C                     Z-ADDXTNN      WUG7NX
     C                     MOVELWUG7NX    WUVECD           Minutes  2A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVDCD    CAT  WUVECD:ZQ WUVBCD    P      Time  4A
     C                     MOVE WUVBCD    #RYBNB           Deadline Depart
     C                     Z-ADD#RYBNB    WUYBNB           Deadline Depart
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#2RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #2RMNB    PARM #2RMNB    WQ0258  70       Load ID
     C           #2AIC3    PARM #2AIC3    WQ0259  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAFJ    KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    FJRMNB
     C           KLVAFJ    CHAIN@FJCPBN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Load Header            NF'
     C                     MOVEL'USR1188' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR1188' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 02560
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  10        W0CSRR  50
     C           02560     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD10        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
     C                     MOVEL*BLANK    P1Q2CD           Shipping Method
     C                     MOVEL*BLANK    P3AJCD           Warehouse Code
     C                     MOVEL*BLANK    P3DNCD           Application Cod
     C                     MOVEL*BLANK    P3DQCD           Enterprise Code
     C                     MOVEL*BLANK    P3DRCD           Enterprise Code
     C                     MOVEL*BLANK    P3BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P3B8NA           System Date For
     C                     MOVEL*BLANK    P3AJVN           User Profile Na
     C                     MOVEL*BLANK    P3I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P3MPNA           Default Printer
     C                     MOVEL*BLANK    P3TAST           First Time Flag
     C                     MOVEL*BLANK    P3BXTX           System Value Al
     C                     MOVEL*BLANK    P3WVST           Access Denied (
     C                     MOVEL*BLANK    P4CPCD           USR Warehouse C
     C                     MOVEL*BLANK    P5ECST           Error Status
     C                     Z-ADD*ZERO     P6AGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     P6NVDT           Deadline Depart
     C                     MOVEL*BLANK    P7HSST           Allow Mult Whse
     C                     MOVEL*BLANK    P8RYSX           MG Created Load
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Scheduled ShpDate SavUsr
     C                     Z-ADD*ZERO     WUTBDT  70
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Define work field U/M - Ordered
     C                     MOVEL*BLANK    WUAGCD  2
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Month NBR USR
     C                     Z-ADD*ZERO     WUI9NX  20
      * Define work field Month USR
     C                     MOVEL*BLANK    WUMONT  2
      * Define work field Day NBR USR
     C                     Z-ADD*ZERO     WUDNBU  20
      * Define work field Day USR
     C                     MOVEL*BLANK    WUI5TX  2
      * Define work field Month/Day Alpha MMDD
     C                     MOVEL*BLANK    WUUBT1  4
      * Define work field Hour 1 USR
     C                     Z-ADD*ZERO     WUIJNX  20
      * Define work field Hours  2A            USR
     C                     MOVEL*BLANK    WUVDCD  2
      * Define work field @Minutes
     C                     Z-ADD*ZERO     WUG7NX  20
      * Define work field Minutes  2A          USR
     C                     MOVEL*BLANK    WUVECD  2
      * Define work field Time  4A             USR
     C                     MOVEL*BLANK    WUVBCD  4
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field USR Warehouse Code
     C                     MOVEL*BLANK    WUCPCD  3
      * Define work field USR Return Code
     C                     MOVEL*BLANK    WUN7CD  1
      * Define work field Warehouse Code Assigned
     C                     MOVEL*BLANK    WUCBAA  3
      * Define work field Warehouse Type Assigned
     C                     MOVEL*BLANK    WUJFSX  2
      * Define work field Error Status
     C                     MOVEL*BLANK    WUECST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Error Status  3
     C                     MOVEL*BLANK    WUTXST  1
      * Define work field Error Status  2
     C                     MOVEL*BLANK    WUTUST  1
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Must Ship Date        USR
     C                     Z-ADD*ZERO     WULYDT  70
      * Define work field Must Ship Time        USR
     C                     Z-ADD*ZERO     WUA5TM  60
      * Define work field STATUS
     C                     MOVEL*BLANK    WUATUS  1
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Dock Unavail Start Time
     C                     Z-ADD*ZERO     WUDPTM  60
      * Define work field Dock Unavail End Time
     C                     Z-ADD*ZERO     WUDQTM  60
      * Define work field Current System Date
     C                     Z-ADD*ZERO     WUSDTE 155
      * Define work field Current System Time
     C                     Z-ADD*ZERO     WUZHNB 155
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Error Flag            USR
     C                     MOVEL*BLANK    WUB8SX  1
      * Define work field Error Reason Descript 1
     C                     MOVEL*BLANK    WUKWTX 30
      * Define work field Error Reason Descript 2
     C                     MOVEL*BLANK    WUKXTX 30
      * Define work field Error Reason Descript 3
     C                     MOVEL*BLANK    WUKYTX 30
      * Define work field Error Reason Descript 4
     C                     MOVEL*BLANK    WUKZTX 30
      * Define work field Error Reason Descript 5
     C                     MOVEL*BLANK    WUTITX 30
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Define work field Cost per Primary U/M
     C                     Z-ADD*ZERO     WUBACS 114
      * Define work field Price Status
     C                     MOVEL*BLANK    WUU1ST  1
      * Define work field @Blank for 7
     C                     MOVEL*BLANK    WUNITX  7
      * Define work field @Text 7
     C                     MOVEL*BLANK    WUO8TX  7
      * Define work field USR Exit Program
     C                     MOVEL*BLANK    WUSTYN  1
      * Define work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     WUN7DT  70
      * Define work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     WUB3TM  60
      * Define work field Warehouse Code PASS   USR
     C                     MOVEL*BLANK    WUT3CD  3
      * Define work field Must Ship Error
     C                     MOVEL*BLANK    WUB7SX  3
      * Define work field USR Load Id ALpha
     C                     MOVEL*BLANK    WULONA  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Load Change Type
     C                     MOVEL*BLANK    WURVST  6
      * Define work field Department Control Code
     C                     MOVEL*BLANK    WUUJST  3
      * Define work field Text USR 7
     C                     MOVEL*BLANK    WUY8TX  7
      * Define work field Text USR 4
     C                     MOVEL*BLANK    WUZ7TX  4
      * Define work field Change Log Prior Value
     C                     MOVEL*BLANK    WUMNTX 12
      * Define work field Change Log New Value
     C                     MOVEL*BLANK    WUMOTX 12
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WGRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WGFLAM           Flat Amount
     C                     Z-ADD*ZERO     WGRRNB           Total Stops
     C                     Z-ADD*ZERO     WGSBNB           BOL Time
     C                     Z-ADD*ZERO     WGSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGSDNB           Number Pallets
     C                     Z-ADD*ZERO     WGPAOU           Number Pallets
     C                     Z-ADD*ZERO     WGDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WGSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WGHADT           Actual Arrival
     C                     Z-ADD*ZERO     WGAART           Actual Arrival
     C                     Z-ADD*ZERO     WGDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WGDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WGAQDT           Actual Departur
     C                     Z-ADD*ZERO     WGS6NB           Departure Time
     C                     Z-ADD*ZERO     WGT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WGPRTM           Product Tempera
     C                     Z-ADD*ZERO     WGNPSV           Number Spacers
     C                     Z-ADD*ZERO     WGTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WGGRWE           Gross Weight
     C                     Z-ADD*ZERO     WGF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WGJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WGTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WGJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WGSPTM           Spotted Time
     C                     Z-ADD*ZERO     WGJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WGLFTM           Load Finished T
     C                     Z-ADD*ZERO     WGJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WGBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WGJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WGBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WGKIDT           Truck Departure
     C                     Z-ADD*ZERO     WGASTM           Truck Departure
     C                     Z-ADD*ZERO     WGKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WGAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WGVOAG           Voyage
     C                     Z-ADD*ZERO     WGKBDT           Sail Date
     C                     Z-ADD*ZERO     WGEFDT           Arrival Date
     C                     Z-ADD*ZERO     WGKCDT           Date In
     C                     Z-ADD*ZERO     WGTMIN           Time In
     C                     Z-ADD*ZERO     WGKDDT           Date Out
     C                     Z-ADD*ZERO     WGVMNB           Time Out
     C                     Z-ADD*ZERO     WGOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WGKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WGATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WGBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WGEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WGKKDT           On Yard Date
     C                     Z-ADD*ZERO     WGAVTM           On Yard Time
     C                     Z-ADD*ZERO     WGKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WGAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WGLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WGK0DT           Product Complet
     C                     Z-ADD*ZERO     WGAYTM           Product Complet
     C                     Z-ADD*ZERO     WGKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WGICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WGIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WGK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WGAZTM           Load Door 1
     C                     Z-ADD*ZERO     WGK2DT           Override Total
     C                     Z-ADD*ZERO     WGA0TM           Load Door 2
     C                     Z-ADD*ZERO     WGZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WGPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WGCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WGPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WGCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WGP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WGCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WGP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WGCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WKBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WKBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WKBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WKBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Define work field Pricing Date Used
     C                     Z-ADD*ZERO     WUGIDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WLAECS           Last Cost
     C                     Z-ADD*ZERO     WLBACS           Cost per Primar
     C                     Z-ADD*ZERO     WLBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WLCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WLGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WLCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WLG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WLBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WLDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WLDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WLDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WLHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WLHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WLAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WLAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WLAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WLEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WLDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WLAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WLANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WLIDVA           Value of On Han
     C                     Z-ADD*ZERO     WLBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WLDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WLDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WLBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WLDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WLBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WLDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WLDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WLBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WLDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WLDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WLDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WLDMDT           Last Physical C
     C                     Z-ADD*ZERO     WLAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WLRINB           Item Structure
     C                     Z-ADD*ZERO     WLRHNB           Item Structure
     C                     Z-ADD*ZERO     WLRGNB           Item Structure
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field Deadline Departure MM/DD
     C                     Z-ADD*ZERO     WUYANB  40
      * Define work field Deadline Depart Time 4,0
     C                     Z-ADD*ZERO     WUYBNB  40
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRWF00  40       Sched Delivery
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004 10
     C                     Z-ADD*ZERO     WL0005 155
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  50
     C                     Z-ADD*ZERO     WL0008  50
     C                     MOVEL*BLANK    WL0009 30
     C                     Z-ADD*ZERO     WL0010  50
     C                     Z-ADD*ZERO     WL0011  72
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014  72
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018  1
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  60
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  60
     C                     MOVEL*BLANK    WL0023 30
     C                     MOVEL*BLANK    WL0024 10
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  60
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  60
     C                     Z-ADD*ZERO     WL0029  70
     C                     Z-ADD*ZERO     WL0030  60
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  60
     C                     Z-ADD*ZERO     WL0033  70
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     MOVEL*BLANK    WL0036 15
     C                     MOVEL*BLANK    WL0037 15
     C                     MOVEL*BLANK    WL0038 15
     C                     MOVEL*BLANK    WL0039 15
     C                     MOVEL*BLANK    WL0040 15
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  70
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  60
     C                     Z-ADD*ZERO     WL0045  60
     C                     Z-ADD*ZERO     WL0046  60
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  2
     C                     MOVEL*BLANK    WL0050 15
     C                     MOVEL*BLANK    WL0051 25
     C                     MOVEL*BLANK    WL0052 25
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0053  3
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0054  3
     C                     Z-ADD*ZERO     WL0055  30
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0056  30
     C                     Z-ADD*ZERO     WL0057  70
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  50
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061  50
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0062  30
     C                     Z-ADD*ZERO     WL0063  70
     C                     Z-ADD*ZERO     WL0064  70
     C                     MOVEL*BLANK    WL0065 10
      * Define local variables for subroutine SUCHRC.
     C                     Z-ADD*ZERO     WL0066  30
     C                     Z-ADD*ZERO     WL0067  70
     C                     Z-ADD*ZERO     WL0068  30
     C                     Z-ADD*ZERO     WL0069  30
     C                     Z-ADD*ZERO     WL0070 112
     C                     Z-ADD*ZERO     WL0071 112
     C                     Z-ADD*ZERO     WL0072  70
      * Define local variables for subroutine SVCHRC.
     C                     Z-ADD*ZERO     WL0073  30
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  70
      * Define local variables for subroutine TPRVGN.
     C                     MOVEL*BLANK    WL0076 10
     C                     MOVEL*BLANK    WL0077  6
     C                     Z-ADD*ZERO     WL0078  30
     C                     MOVEL*BLANK    WL0079  3
      * Define local work field Requested Delivery DateUs
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field USR Company Number
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field Error Flag            USR
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Order Number Saved USR
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Order Type - Sales
     C                     MOVEL*BLANK    YL0009  2
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field Comments for Pickup
     C                     MOVEL*BLANK    YL0014 30
      * Define local work field Miles to next stop
     C                     Z-ADD*ZERO     YL0015  50
      * Define local work field Freight Charge
     C                     Z-ADD*ZERO     YL0016  72
      * Define local work field Ld Hdr/Ld Dtl Unused
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Freight Misc. Charge
     C                     Z-ADD*ZERO     YL0018 112
      * Define local work field Freight Stop Charge
     C                     Z-ADD*ZERO     YL0019  72
      * Define local work field Rated Freight
     C                     Z-ADD*ZERO     YL0020 112
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0021  30
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field Ship Status
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Estimated Arrival Date
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YL0025  60
      * Define local work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YL0027  60
      * Define local work field Confirmation Made With
     C                     MOVEL*BLANK    YL0028 30
      * Define local work field Confirmation Number
     C                     MOVEL*BLANK    YL0029 10
      * Define local work field Actual Delivery Date
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field Actual Delivery time
     C                     Z-ADD*ZERO     YL0031  60
      * Define local work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YL0033  60
      * Define local work field Deadline Depart DT    HDR
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     YL0035  60
      * Define local work field On Yard Date
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field On Yard Time
     C                     Z-ADD*ZERO     YL0037  60
      * Define local work field MPC Number
     C                     Z-ADD*ZERO     YL0038  70
      * Define local work field Load Dtl On Time Flag
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field On Time Add'l Rsn Unused
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field Seal Nbr 1
     C                     MOVEL*BLANK    YL0041 15
      * Define local work field Seal Nbr 2
     C                     MOVEL*BLANK    YL0042 15
      * Define local work field Seal Nbr 3
     C                     MOVEL*BLANK    YL0043 15
      * Define local work field Seal Nbr 4
     C                     MOVEL*BLANK    YL0044 15
      * Define local work field Seal Nbr 5
     C                     MOVEL*BLANK    YL0045 15
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0046  70
      * Define local work field LD Unused Date 2
     C                     Z-ADD*ZERO     YL0047  70
      * Define local work field LD Unused Date 3
     C                     Z-ADD*ZERO     YL0048  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0049  60
      * Define local work field LD Unused Time 2
     C                     Z-ADD*ZERO     YL0050  60
      * Define local work field LD Unused Time 3
     C                     Z-ADD*ZERO     YL0051  60
      * Define local work field Miles Error Sts
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field LD Unused Sts 2
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field HPB Transload Station
     C                     MOVEL*BLANK    YL0054  2
      * Define local work field LD Cst Svc Tracer Cmmnt
     C                     MOVEL*BLANK    YL0055 15
      * Define local work field Carrier Ref PRO/Inv
     C                     MOVEL*BLANK    YL0056 25
      * Define local work field Cust Assigned Appt #
     C                     MOVEL*BLANK    YL0057 25
      * Define local work field Application WHS Restrict
     C                     MOVEL*BLANK    YL0058  1
      * Define local work field WHS/Item Access Sts USR
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field Max Schd Shp Wt Edit Flg
     C                     MOVEL*BLANK    YL0060  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0061  1
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0062  1
      * Define local work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     YL0063  70
      * Define local work field Order Weight Assigned
     C                     Z-ADD*ZERO     YL0064 112
      * Define local work field Slot Type f/New Ords USR
     C                     MOVEL*BLANK    YL0065  2
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0066 112
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0067  30
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Error Status  3
     C                     MOVEL*BLANK    YL0068  1
      * Define local work field Change Flag USR
     C                     MOVEL*BLANK    YL0069  1
      * Define local work field Error Status  2
     C                     MOVEL*BLANK    YL0070  1
      * Define local work field USR Remainder
     C                     Z-ADD*ZERO     YL0071  40
      * Define null work field Comments for Pickup
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Miles to next stop
     C                     Z-ADD*ZERO     YN0003  50
      * Define null work field Freight Charge
     C                     Z-ADD*ZERO     YN0004  72
      * Define null work field Ld Hdr/Ld Dtl Unused
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field Freight Misc. Charge
     C                     Z-ADD*ZERO     YN0006 112
      * Define null work field Freight Stop Charge
     C                     Z-ADD*ZERO     YN0007  72
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0008 112
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0009  30
      * Define null work field Ship Status
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Estimated Arrival Date
     C                     Z-ADD*ZERO     YN0011  70
      * Define null work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YN0012  60
      * Define null work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YN0013  70
      * Define null work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YN0014  60
      * Define null work field Confirmation Made With
     C                     MOVEL*BLANK    YN0015 30
      * Define null work field Confirmation Number
     C                     MOVEL*BLANK    YN0016 10
      * Define null work field Actual Delivery Date
     C                     Z-ADD*ZERO     YN0017  70
      * Define null work field Actual Delivery time
     C                     Z-ADD*ZERO     YN0018  60
      * Define null work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YN0019  70
      * Define null work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YN0020  60
      * Define null work field Deadline Depart DT    HDR
     C                     Z-ADD*ZERO     YN0021  70
      * Define null work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     YN0022  60
      * Define null work field On Yard Date
     C                     Z-ADD*ZERO     YN0023  70
      * Define null work field On Yard Time
     C                     Z-ADD*ZERO     YN0024  60
      * Define null work field MPC Number
     C                     Z-ADD*ZERO     YN0025  70
      * Define null work field Load Dtl On Time Flag
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field On Time Add'l Rsn Unused
     C                     MOVEL*BLANK    YN0027  1
      * Define null work field Seal Nbr 1
     C                     MOVEL*BLANK    YN0028 15
      * Define null work field Seal Nbr 2
     C                     MOVEL*BLANK    YN0029 15
      * Define null work field Seal Nbr 3
     C                     MOVEL*BLANK    YN0030 15
      * Define null work field Seal Nbr 4
     C                     MOVEL*BLANK    YN0031 15
      * Define null work field Seal Nbr 5
     C                     MOVEL*BLANK    YN0032 15
      * Define null work field LD Unused Date 2
     C                     Z-ADD*ZERO     YN0033  70
      * Define null work field LD Unused Date 3
     C                     Z-ADD*ZERO     YN0034  70
      * Define null work field LD Unused Time 2
     C                     Z-ADD*ZERO     YN0035  60
      * Define null work field LD Unused Time 3
     C                     Z-ADD*ZERO     YN0036  60
      * Define null work field Miles Error Sts
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field LD Unused Sts 2
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field HPB Transload Station
     C                     MOVEL*BLANK    YN0039  2
      * Define null work field LD Cst Svc Tracer Cmmnt
     C                     MOVEL*BLANK    YN0040 15
      * Define null work field Carrier Ref PRO/Inv
     C                     MOVEL*BLANK    YN0041 25
      * Define null work field Cust Assigned Appt #
     C                     MOVEL*BLANK    YN0042 25
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0072  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0073  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0074  50
      * Define local work field Production AgeDte Fr
     C                     Z-ADD*ZERO     YL0075  70
      * Define local work field Production AgeDte To
     C                     Z-ADD*ZERO     YL0076  70
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0077  1
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0078 112
      * Define local work field Calc 4
     C                     Z-ADD*ZERO     YL0079  40
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0080  1
      * Define local work field Load Acceptance Flag
     C                     MOVEL*BLANK    YL0081  1
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0082  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0083  60
      * Define local work field Production Warehouse
     C                     MOVEL*BLANK    YL0084  3
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0043  30
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0085 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0086 112
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0087  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0088  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0089  3
      * Define local work field Status Flag 4  Y/N
     C                     MOVEL*BLANK    YL0090  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD12        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0990 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0990           User Profile Na
      *
     C                     MOVEL*BLANK    WN0991 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TORVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0990    ZA0047           User Profile Na
     C                     MOVEL'P/S'     ZA0048           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0991    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0990    WL0076    P      User Profile Na
     C                     MOVEL'P/S'     WL0077    P      Application Cod
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0078    WUAIC3           Company Number
     C                     MOVELWL0079    YL0089    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0991    WL0076    P      User Profile Na
     C                     MOVEL'P/S'     WL0077    P      Application Cod
     C                     EXSR TPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0078    WUAIC3           Company Number
     C                     MOVELWL0079    YL0089    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0089    WUAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0990    ZA0049           User Profile Na
     C                     MOVEL'P/S'     ZA0050           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0088    IFNE 0                          *IF
     C                     Z-ADDYL0088    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0089    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           WUAJCD    PARM *BLANK    WQ0260  3        Warehouse Code
     C                     PARM YL0088    WQ0261  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TQRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       P3TAST           First Time Flag
      * RTV Load Str Company  RT - Load Header  * 
     C                     EXSR TSRVGN
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR TTRVGN
     C                     MOVEL*BLANK    YL0090           Status Flag 4
     C                     MOVEL'N'       YL0006           Error Flag
      * ** Add rcd.context changed flag                       W288
     C                     MOVEL'N'       YL0077           Status Flag 1
     C                     Z-ADD*ZERO     YL0007           Order Number Sa
      * RTV Appl Whs Restrict  RT - User Profile Control  * 
     C                     EXSR TURVGN
      * ** Retrieve Organization early, for slotting shed     E001895
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0021    WQ0262  30       Company Number
     C                     PARM *BLANK    WQ0263  1        Plant Company S
     C           YL0061    PARM *BLANK    WQ0264  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'N'       YL0069           Change Flag USR
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01047013030155901566025620257002574
02578025870259202601026230262602629
02635
** W0END
01053013100156101595025680257202576
02585025900259902620026230262702633
02639
** W0NAM
#2RMNB    VCHODT    #PAJCD    #CF8NA    V1C4NB    V1AIC3    #RAJCD
VRJYDT    #RTMPK    VRGYDT    #1BRTX    #1U2ST    #RCRCD    #RYANB
#RYBNB
** @CN
00001 Y2U0005
00002 CHGSHPDTE
00003 CHGWHS
00004 MAXFLAG
