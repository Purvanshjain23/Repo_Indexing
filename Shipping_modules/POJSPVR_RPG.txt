     H/TITLE SEL Sched Loads Cnfrm  PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/09/21  Time  : 09:19:39
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPOJSPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: SEL Sched Loads Cnfrm  PV Prompt & validate record
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPOA3REL2IF  E           K        DISK
      * RSQ : Load Slotting Sched Ctl   Co/Whse/Day  (D)
      *
     FOMFJCPLFIF  E           K        DISK
      * RSQ : Load Header               Whse/SchdShpDt/Load
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBGWKMBIF  E           K        DISK
      * RSQ : Order Detail              Co/Whse/SchDt/,Sel NOT X
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMFKREL0IF  E           K        DISK
      * RTV : Truck Size                Retrieval index
      *
     FCAACREL1IF  E           K        DISK
      * RTV : State                     Retrieval index       NV
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
      * Set wdw location allowed?
     E                    YSL         1  1
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@A3REI3
      * Load Slotting Sched Ctl   Co/Whse/Day  (D)
      * Renamed input format fields
     I              A3AIC3                          WBAIC3
     I              A3AJCD                          WBAJCD
     I              A3A9ST                          WBA9ST
     I              A3NVNX                          WBNVNX
     I              A3NWNX                          WBNWNX
     I              A3NXNX                          WBNXNX
     I              A3IOWG                          WBIOWG
     I              A3IPWG                          WBIPWG
     I              A3IQWG                          WBIQWG
     I              A3JCSX                          WBJCSX
     I              A3NYNX                          WBNYNX
     I              A3IRWG                          WBIRWG
     I              A3UVST                          WBUVST
     I              A3UWST                          WBUWST
     I              A3UXST                          WBUXST
     I              A3VSST                          WBVSST
     I              A3AATM                          WBAATM
     I              A3AYNA                          WBAYNA
     I              A3A0NA                          WBA0NA
     I              A3AXDT                          WBAXDT
      *
     I@FJCPN3
      * Load Header               Whse/SchdShpDt/Load
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WGAIC3
     I              KMV8CD                          WGV8CD
     I              KMAUNA                          WGAUNA
     I              KMI5ST                          WGI5ST
     I              KMBXTX                          WGBXTX
     I              KMM8NB                          WGM8NB
     I              KMUVST                          WGUVST
     I              KMUWST                          WGUWST
     I              KMUXST                          WGUXST
     I              KMVSST                          WGVSST
     I              KMAATM                          WGAATM
     I              KMAYNA                          WGAYNA
     I              KMA0NA                          WGA0NA
     I              KMAXDT                          WGAXDT
      *
     I@BGWKII
      * Order Detail              Co/Whse/SchDt/,Sel NOT X
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@ABREUA
      * Company Name and Address  Active records
      * Renamed input format fields
     I              ABAIC3                          WJAIC3
     I              ABADTX                          WJADTX
     I              ABACNA                          WJACNA
     I              ABADNA                          WJADNA
     I              ABAENA                          WJAENA
     I              ABAJNA                          WJAJNA
     I              ABBTTX                          WJBTTX
     I              ABBVTX                          WJBVTX
     I              ABBWTX                          WJBWTX
     I              ABA2NA                          WJA2NA
     I              ABABTX                          WJABTX
     I              ABBGCD                          WJBGCD
     I              ABKXCD                          WJKXCD
     I              ABUVST                          WJUVST
     I              ABUWST                          WJUWST
     I              ABUXST                          WJUXST
     I              ABVSST                          WJVSST
     I              ABAATM                          WJAATM
     I              ABAYNA                          WJAYNA
     I              ABA0NA                          WJA0NA
     I              ABAXDT                          WJAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WKBZNA
     I              FFADTX                          WKADTX
     I              FFACNA                          WKACNA
     I              FFADNA                          WKADNA
     I              FFAENA                          WKAENA
     I              FFAJNA                          WKAJNA
     I              FFBTTX                          WKBTTX
     I              FFEZNB                          WKEZNB
     I              FFBGCD                          WKBGCD
     I              FFEEDT                          WKEEDT
     I              FFDUTX                          WKDUTX
     I              FFNRVA                          WKNRVA
     I              FFNSVA                          WKNSVA
     I              FFNTVA                          WKNTVA
     I              FFNUVA                          WKNUVA
     I              FFP1ST                          WKP1ST
     I              FFDVTX                          WKDVTX
     I              FFDWTX                          WKDWTX
     I              FFLVCD                          WKLVCD
     I              FFS8NB                          WKS8NB
     I              FFS9NB                          WKS9NB
     I              FFNMVA                          WKNMVA
     I              FFNOVA                          WKNOVA
     I              FFNPVA                          WKNPVA
     I              FFNQVA                          WKNQVA
     I              FFMFCD                          WKMFCD
     I              FFQXNB                          WKQXNB
     I              FFQ1NB                          WKQ1NB
     I              FFMRNG                          WKMRNG
     I              FFMRNE                          WKMRNE
     I              FFRFNB                          WKRFNB
     I              FFMREG                          WKMREG
     I              FFBQPR                          WKBQPR
     I              FFBRPR                          WKBRPR
     I              FFBSPR                          WKBSPR
     I              FFBTPR                          WKBTPR
     I              FFBUPR                          WKBUPR
     I              FFBVPR                          WKBVPR
     I              FFDJWG                          WKDJWG
     I              FFDKWG                          WKDKWG
     I              FFDLWG                          WKDLWG
     I              FFDMWG                          WKDMWG
     I              FFDNWG                          WKDNWG
     I              FFDOWG                          WKDOWG
     I              FFB2PR                          WKB2PR
     I              FFB3PR                          WKB3PR
     I              FFB4PR                          WKB4PR
     I              FFB5PR                          WKB5PR
     I              FFB6PR                          WKB6PR
     I              FFB7PR                          WKB7PR
     I              FFAAC7                          WKAAC7
     I              FFCOFI                          WKCOFI
     I              FFK6TX                          WKK6TX
     I              FFOCNA                          WKOCNA
     I              FFODNA                          WKODNA
     I              FFW7CD                          WKW7CD
     I              FFK7TX                          WKK7TX
     I              FFTENO                          WKTENO
     I              FFK8TX                          WKK8TX
     I              FFAOFC                          WKAOFC
     I              FFAOLI                          WKAOLI
     I              FFKHDT                          WKKHDT
     I              FFUNUS                          WKUNUS
     I              FFUNU2                          WKUNU2
     I              FFUNU3                          WKUNU3
     I              FFUVST                          WKUVST
     I              FFUWST                          WKUWST
     I              FFUXST                          WKUXST
     I              FFVSST                          WKVSST
     I              FFAATM                          WKAATM
     I              FFAYNA                          WKAYNA
     I              FFA0NA                          WKA0NA
     I              FFAXDT                          WKAXDT
      *
     I@FKREBT
      * Truck Size                Retrieval index
      * Renamed input format fields
     I              FKRONB                          WLRONB
     I              FKDPTX                          WLDPTX
     I              FKRSNB                          WLRSNB
     I              FKRTNB                          WLRTNB
     I              FKTANB                          WLTANB
     I              FKUVST                          WLUVST
     I              FKUWST                          WLUWST
     I              FKUXST                          WLUXST
     I              FKVSST                          WLVSST
     I              FKAATM                          WLAATM
     I              FKAYNA                          WLAYNA
     I              FKA0NA                          WLA0NA
     I              FKAXDT                          WLAXDT
      *
     I@ACREAH
      * State                     Retrieval index       NV
      * Renamed input format fields
     I              ACBGCD                          WMBGCD
     I              ACAUNA                          WMAUNA
     I              ACUVST                          WMUVST
     I              ACUWST                          WMUWST
     I              ACUXST                          WMUXST
     I              ACVSST                          WMVSST
     I              ACAATM                          WMAATM
     I              ACAYNA                          WMAYNA
     I              ACA0NA                          WMA0NA
     I              ACAXDT                          WMAXDT
      *
     I@LCREL2
      * Shipping Line/Port        Retrieval index
      * Renamed input format fields
     I              LCXACD                          WOXACD
     I              LCOANA                          WOOANA
     I              LCOKTX                          WOOKTX
     I              LCLBTX                          WOLBTX
     I              LCLATX                          WOLATX
     I              LCXBCD                          WOXBCD
     I              LCLCTX                          WOLCTX
     I              LCSPPN                          WOSPPN
     I              LCLDTX                          WOLDTX
     I              LCPYAA                          WOPYAA
     I              LCUVST                          WOUVST
     I              LCUWST                          WOUWST
     I              LCUXST                          WOUXST
     I              LCVSST                          WOVSST
     I              LCAATM                          WOAATM
     I              LCAYNA                          WOAYNA
     I              LCA0NA                          WOA0NA
     I              LCAXDT                          WOAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WRAJVN
     I              DRAUNA                          WRAUNA
     I              DRB8NA                          WRB8NA
     I              DRAHVN                          WRAHVN
     I              DRI6ST                          WRI6ST
     I              DRI7ST                          WRI7ST
     I              DRXMST                          WRXMST
     I              DRXNST                          WRXNST
     I              DRI8ST                          WRI8ST
     I              DRNLNB                          WRNLNB
     I              DRMPNA                          WRMPNA
     I              DRBCCD                          WRBCCD
     I              DRAIC3                          WRAIC3
     I              DRDQCD                          WRDQCD
     I              DRDRCD                          WRDRCD
     I              DRAJCD                          WRAJCD
     I              DRBUVN                          WRBUVN
     I              DRUVST                          WRUVST
     I              DRUWST                          WRUWST
     I              DRUXST                          WRUXST
     I              DRAATM                          WRAATM
     I              DRAYNA                          WRAYNA
     I              DRA0NA                          WRA0NA
     I              DRAXDT                          WRAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WSAJVN
     I              DTDNCD                          WSDNCD
     I              DTAIC3                          WSAIC3
     I              DTDQCD                          WSDQCD
     I              DTDRCD                          WSDRCD
     I              DTAJCD                          WSAJCD
     I              DTJFST                          WSJFST
     I              DTUVST                          WSUVST
     I              DTUWST                          WSUWST
     I              DTUXST                          WSUXST
     I              DTAATM                          WSAATM
     I              DTAYNA                          WSAYNA
     I              DTA0NA                          WSA0NA
     I              DTAXDT                          WSAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                              8
      * KEY : Order Header TRG          Load Exports
      * I : RST Load ID
     I                                    P   1   40PARMNB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * B :  Status - Y or N
     I                                        1   1 P1B8ST
      * I :  Load ID
     I                                    P   2   50P1RMNB
      * I :  Scheduled Ship Date
     I                                    P   6   90P1AODT
      * I :  Deadline Depart Date LH
     I                                    P  10  130P1NVDT
      * B :  USR Return Code
     I                                       14  14 P1N7CD
      * B :  Scheduled Ship Date USR
     I                                    P  15  180P1HODT
      * I :  Order Weight Assigned
     I                                    P  19  242P1ISWG
      * I :  Warehouse Code Assigned
     I                                       25  27 P1CBAA
      * I :  Warehouse Type Assigned
     I                                       28  29 P1JFSX
      * B :  Slot Type f/New Ords USR
     I                                       30  31 P1JRSX
      * I :  Boxes Total Quantity
     I                                    P  32  372P1I0QT
      * I :  Req Delivery Date
     I                                    P  38  410P1NYDT
      * I :  Order Number
     I                                    P  42  450P1C4NB
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Scheduled Ship Date must'
      * Message data for 'Sched SD after Deliv Date'
      * Scheduled Ship Date USR
     I                                    P   1   40ZA0001
      * Message data for 'Scheduled Ship Wt exceedd'
      * Message data for 'Scheduled Ship Wt exceedd'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1B8ST    PARM P1B8ST    WP0001  1        Status - Y or N
     C           P1RMNB    PARM           WP0002  70       Load ID
     C           P1AODT    PARM           WP0003  70       Scheduled Ship
     C           P1NVDT    PARM           WP0004  70       Deadline Depart
     C           P1N7CD    PARM P1N7CD    WP0005  1        USR Return Code
     C           P1HODT    PARM P1HODT    WP0006  70       Scheduled Ship
     C           P1ISWG    PARM           WP0007 112       Order Weight As
     C           P1CBAA    PARM           WP0008  3        Warehouse Code
     C           P1JFSX    PARM           WP0009  2        Warehouse Type
     C           P1JRSX    PARM P1JRSX    WP0010  2        Slot Type f/New
     C           P1I0QT    PARM           WP0011 112       Boxes Total Qua
     C           P1NYDT    PARM           WP0012  70       Req Delivery Da
     C           P1C4NB    PARM           WP0013  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Reposition window
     C   26                CAS            ZRRPWD
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     Z-ADD1         YWPNNO  10       Panel number
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
     C                     Z-ADD1         W0WASM  10
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * F5=Display Load Slotting Activity
      * CASE: DTL.*CMD key is CF05
     C           *IN05     IFEQ '1'                        *IF
      * CASE: DTL.Scheduled Ship Date USR is Entered
     C           #DHODT    IFNE *ZERO                      *IF
      * If new date is entered, save
     C                     Z-ADD#DHODT    WUHODT           Scheduled Ship
     C                     ELSE
      * CASE: *OTHERWISE
      * Else save original date, save to test slotting activity
     C                     Z-ADD#1AODT    WUHODT           Scheduled Ship
     C                     END                             *FI
      * Dsp Load Slot Actvty  XF - Load Slotting Sched Activ  * 
     C                     CALL 'POJZXFR'              90  Dsp Load Slot A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0001  30       Company Number
     C                     PARM #1AJCD    WQ0002  3        Warehouse Code
     C                     PARM WUHODT    WQ0003  70       Scheduled Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POJZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * Exit pgm if Confirm is NO and the new Sched ship date was not dis
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DTL.Status - Y or N is no
      *   |- c2    : LCL.Display Flag is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DB8ST    IFEQ 'N'                        *IF
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL#DB8ST    P1B8ST           Status - Y or N
     C                     Z-ADD*ZERO     P1HODT           Scheduled Ship
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Scheduled Ship Date USR
      * External date
     C                     Z-ADDVDHODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #DHODT
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * If Load/Weight exceeded, retrieve new Sched Ship Date data.
      * CASE: LCL.Display Flag is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * validate entered date
      * CASE: DTL.Scheduled Ship Date USR LT JOB.*Job date
     C           #DHODT    IFLT ##JDT                      *IF
      * Setup message data for message
      * Send message 'Scheduled Ship Date must'
     C                     MOVEL'USR3022' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Scheduled Ship Date USR GT DTL.Requested Deliver
      *   |- c2    : DTL.Requested Delivery Date is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DHODT    IFGT #1EIDT                     *IF
     C           #1EIDT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #DHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Send message 'Sched SD after Deliv Date'
     C                     MOVEL'USR4489' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Day and Week No.   RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0001           Company Number
     C                     Z-ADD#DHODT    WL0002           Post to G/L Dat
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0003           Accounting Peri
     C                     MOVELWL0004    YL0004    P      Day of Week
     C                     Z-ADDWL0005    YL0005           Week Number
      * Get New Load and Weight Limits from Control file
      * CASE: LCL.WHS Slotting Limit Type is By Load
     C           YL0006    IFEQ 'L'                        *IF
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0006           Company Number
     C                     MOVEL#1AJCD    WL0007    P      Warehouse Code
     C                     MOVELYL0004    WL0008    P      Day of Week
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    #DNVNX           Slot Limit for
     C                     Z-ADDWL0010    #DNWNX           Slot Limit for
     C                     Z-ADDWL0011    #DNXNX           Slot Limit for
     C                     Z-ADDWL0012    YN0001           Weight Limit fo
     C                     Z-ADDWL0013    YN0002           Weight Limit fo
     C                     Z-ADDWL0014    YN0003           Weight Limit fo
     C                     ELSE
      * CASE: LCL.WHS Slotting Limit Type is By Weight
     C           YL0006    IFEQ 'W'                        *IF
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0006           Company Number
     C                     MOVEL#1AJCD    WL0007    P      Warehouse Code
     C                     MOVELYL0004    WL0008    P      Day of Week
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YN0004           Slot Limit for
     C                     Z-ADDWL0010    YN0005           Slot Limit for
     C                     Z-ADDWL0011    YN0006           Slot Limit for
     C                     Z-ADDWL0012    #DIOWG           Weight Limit fo
     C                     Z-ADDWL0013    #DIPWG           Weight Limit fo
     C                     Z-ADDWL0014    #DIQWG           Weight Limit fo
     C                     END                             *FI
     C                     END                             *FI
      * Check for Load Limit exceeded.
      * CASE: LCL.WHS Slotting Limit Type is By Load
     C           YL0006    IFEQ 'L'                        *IF
     C                     Z-ADD*ZERO     #DIUNX           Export Load Lim
     C                     Z-ADD*ZERO     #DBINX           Combo Load Limi
     C                     Z-ADD*ZERO     #DBHNX           Box Load Limit
      * RTV Limit Loads f/Slot RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0015    P      Ship From Wareh
     C                     Z-ADD#DHODT    WL0016           Scheduled Ship
     C                     Z-ADD#1RMNB    WL0017           Load ID
     C                     Z-ADD#DIUNX    WL0018           Export Load Lim
     C                     Z-ADD#DBINX    WL0019           Combo Load Limi
     C                     Z-ADD#DBHNX    WL0020           Box Load Limit
     C                     MOVELYL0007    WL0021    P      Record Found -O
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    #DIUNX           Export Load Lim
     C                     Z-ADDWL0019    #DBINX           Combo Load Limi
     C                     Z-ADDWL0020    #DBHNX           Box Load Limit
     C                     MOVELWL0021    YL0007    P      Record Found -O
      * Check for limit being exceeded
      * CASE: LCL.Slot Type f/load USR is Export
     C           YL0016    IFEQ 'EX'                       *IF
      * Add this load to load total if it's a new load
      * CASE: LCL.Record Found -OrdDtlUSR is Record Not Found
     C           YL0007    IFEQ 'N'                        *IF
     C                     ADD  1         #DIUNX           Export Load Lim
     C                     END                             *FI
      * Export Load Info Message
      * CASE: DTL.Export Load Limit GT DTL.Slot Limit for Export
     C           #DIUNX    IFGT #DNVNX                     *IF
      * Send message 'No Shipping Slots Avail'
     C                     MOVEL'USR3032' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       #DB8ST           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       P1N7CD           USR Return Code
     C                     MOVEL'Y'       #DB8ST           Status - Y or N
     C                     Z-ADD#DHODT    P1HODT           Scheduled Ship
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Slot Type f/load USR is Box
     C           YL0016    IFEQ 'BX'                       *IF
      * add this load to load total
      * CASE: LCL.Record Found -OrdDtlUSR is Record Not Found
     C           YL0007    IFEQ 'N'                        *IF
     C                     ADD  1         #DBHNX           Box Load Limit
     C                     END                             *FI
      * Box Load Info Message
      * CASE: DTL.Box Load Limit        USR GT DTL.Slot Limit for Box/Oth
     C           #DBHNX    IFGT #DNXNX                     *IF
      * Send message 'No Shipping Slots Avail'
     C                     MOVEL'USR3032' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       #DB8ST           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       P1N7CD           USR Return Code
     C                     MOVEL'Y'       #DB8ST           Status - Y or N
     C                     Z-ADD#DHODT    P1HODT           Scheduled Ship
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Slot Type f/load USR is Combo
     C           YL0016    IFEQ 'CB'                       *IF
      * Add this load to load total
      * CASE: LCL.Record Found -OrdDtlUSR is Record Not Found
     C           YL0007    IFEQ 'N'                        *IF
     C                     ADD  1         #DBINX           Combo Load Limi
     C                     END                             *FI
      * Combo Load Info Message
      * CASE: DTL.Combo Load Limit GT DTL.Slot Limit for Combo
     C           #DBINX    IFGT #DNWNX                     *IF
      * Send message 'No Shipping Slots Avail'
     C                     MOVEL'USR3032' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       #DB8ST           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       P1N7CD           USR Return Code
     C                     MOVEL'Y'       #DB8ST           Status - Y or N
     C                     Z-ADD#DHODT    P1HODT           Scheduled Ship
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Check for Weight Limit exceeded - Priority: CB,EX,BX
      * CASE: LCL.WHS Slotting Limit Type is By Weight
     C           YL0006    IFEQ 'W'                        *IF
     C                     Z-ADD*ZERO     YL0017           Weight Schedule
      * RTV Shipping Co        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0022    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0001           Shipping Compan
      * Rtv OrderWt f/ShpDate RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0027           Company Number
     C                     MOVEL#1AJCD    WL0028    P      Warehouse Code
     C                     MOVELYL0018    WL0029    P      U/M - Ordered
     C                     Z-ADD#DHODT    WL0030           Scheduled Ship
     C                     Z-ADDYL0017    WL0031           Weight Schedule
     C                     MOVELYL0019    WL0032    P      Export Status
     C                     MOVELYL0016    WL0033    P      LSSA Load Slot
     C                     MOVELYL0007    WL0034    P      Record Found -O
     C                     Z-ADD#1RMNB    WL0035           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0031    YL0017           Weight Schedule
     C                     MOVELWL0034    YL0007    P      Record Found -O
     C                     ADD  P1ISWG    YL0017           Weight Schedule
      * CASE: LCL.Record Found -OrdDtlUSR is Record Not Found
     C           YL0007    IFEQ 'N'                        *IF
     C                     ADD  YL0030    YL0017           Weight Schedule
     C                     END                             *FI
      * Weight exceeded message
      * CASE: LCL.Weight Scheduled USR GT DTL.Weight Limit for Export
     C           YL0017    IFGT #DIOWG                     *IF
      * Setup message data for message
      * Send message 'Scheduled Ship Wt exceedd'
     C                     MOVEL'USR3021' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       #DB8ST           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       P1N7CD           USR Return Code
     C                     MOVEL'Y'       #DB8ST           Status - Y or N
     C                     Z-ADD#DHODT    P1HODT           Scheduled Ship
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'R'       P1N7CD           USR Return Code
     C                     MOVEL'Y'       #DB8ST           Status - Y or N
     C                     Z-ADD*ZERO     P1HODT           Scheduled Ship
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Carrier
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Truck Size
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Warehouse
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to State
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Carrier
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Shipping Line/Port
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Warehouse
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     EXSR ZVCFPM
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLWR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0006    IFEQ 'W'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0006    IFEQ 'L'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0041    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1AIC3           Company Number
     C                     Z-ADD*ZERO     #DNVDT           Deadline Depart
     C                     MOVEL*BLANK    #1U2ST           Export Status
     C                     Z-ADD*ZERO     #DIPWG           Weight Limit fo
     C                     Z-ADD*ZERO     #DIQWG           Weight Limit fo
     C                     MOVEL*BLANK    #DB8ST           Status - Y or N
     C                     MOVEL*BLANK    #1PJST           LTL Flag
     C                     MOVEL*BLANK    #1PKST           Load Status
     C                     Z-ADD*ZERO     #1RNNB           Reefer Temperat
     C                     MOVEL*BLANK    #1DMTX           Seal 1
     C                     MOVEL*BLANK    #1DNTX           Seal 2
     C                     MOVEL*BLANK    #1DOTX           Seal 3
     C                     MOVEL*BLANK    #1WTTX           Seal 4
     C                     MOVEL*BLANK    #1WUTX           Seal 2 Unused
     C                     Z-ADD*ZERO     #1RPNB           Total Load Orde
     C                     Z-ADD*ZERO     #1FLAM           Flat Amount
     C                     MOVEL*BLANK    #1XQST           Allocate Pounds
     C                     Z-ADD*ZERO     #1RRNB           Total Stops
     C                     MOVEL*BLANK    #1DXTX           Trailer Id
     C                     MOVEL*BLANK    #1DYTX           Transloader Car
     C                     Z-ADD*ZERO     #1SBNB           BOL Time
     C                     MOVEL*BLANK    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #1RONB           Truck Size
     C                     Z-ADD*ZERO     #1SQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     #1R1NB           Rated Freight
     C                     MOVEL*BLANK    #1VCST           Ship Status
     C                     MOVEL*BLANK    #1VDST           Load Type
     C                     Z-ADD*ZERO     #1SDNB           Number Pallets
     C                     Z-ADD*ZERO     #1PAOU           Number Pallets
     C                     Z-ADD*ZERO     #1DGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     #1SXNB           Estimated Arriv
     C                     Z-ADD*ZERO     #1HADT           Actual Arrival
     C                     Z-ADD*ZERO     #1AART           Actual Arrival
     C                     Z-ADD*ZERO     #1DHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     #1DIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     #1AQDT           Actual Departur
     C                     Z-ADD*ZERO     #1S6NB           Departure Time
     C                     Z-ADD*ZERO     #1T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #1PRTM           Product Tempera
     C                     Z-ADD*ZERO     #1NPSV           Number Spacers
     C                     MOVEL*BLANK    #1J8TX           Car/Veh. Initia
     C                     Z-ADD*ZERO     #1TLMI           Total Load Mile
     C                     MOVEL*BLANK    #1J9TX           Recorder ID
     C                     MOVEL*BLANK    #1Q2CD           Shipping Method
     C                     MOVEL*BLANK    #1VPCD           Ship From Wareh
     C                     MOVEL*BLANK    #1DBCD           Ship To State C
     C                     Z-ADD*ZERO     #1GRWE           Gross Weight
     C                     MOVEL*BLANK    #1XCCD           Carrier Broker
     C                     Z-ADD*ZERO     #1F9DT           Actual Ship Dat
     C                     MOVEL*BLANK    #1ONTM           On Time - (Y/N)
     C                     Z-ADD*ZERO     #1J4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     #1TRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     #1J5DT           Spotted Date
     C                     Z-ADD*ZERO     #1SPTM           Spotted Time
     C                     Z-ADD*ZERO     #1J6DT           Load Finished D
     C                     Z-ADD*ZERO     #1LFTM           Load Finished T
     C                     Z-ADD*ZERO     #1J7DT           BOL Complete Da
     C                     Z-ADD*ZERO     #1BOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     #1J8DT           BOL Received Da
     C                     Z-ADD*ZERO     #1BLTM           BOL Received Ti
     C                     Z-ADD*ZERO     #1KIDT           Truck Departure
     C                     Z-ADD*ZERO     #1ASTM           Truck Departure
     C                     Z-ADD*ZERO     #1KADT           Adjusted Depart
     C                     Z-ADD*ZERO     #1AJCM           Adjusted Depart
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     MOVEL*BLANK    #1K4TX           Vessel Name
     C                     Z-ADD*ZERO     #1VOAG           Voyage
     C                     Z-ADD*ZERO     #1KBDT           Sail Date
     C                     MOVEL*BLANK    #1NBBO           Booking Number
     C                     MOVEL*BLANK    #1W4CD           Discharge Port
     C                     Z-ADD*ZERO     #1EFDT           Arrival Date
     C                     MOVEL*BLANK    #1CNTN           Container Numbe
     C                     Z-ADD*ZERO     #1KCDT           Date In
     C                     Z-ADD*ZERO     #1TMIN           Time In
     C                     Z-ADD*ZERO     #1KDDT           Date Out
     C                     Z-ADD*ZERO     #1VMNB           Time Out
     C                     Z-ADD*ZERO     #1OCFR           Load Total Frei
     C                     Z-ADD*ZERO     #1KJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     #1ATTM           Scheduled Deliv
     C                     MOVEL*BLANK    #1OTRS           LH Unused Sts
     C                     MOVEL*BLANK    #1RNST           LH Carrier Paym
     C                     Z-ADD*ZERO     #1BRBK           Bring Back Mile
     C                     MOVEL*BLANK    #1RMST           Load Acceptance
     C                     Z-ADD*ZERO     #1KKDT           On Yard Date
     C                     Z-ADD*ZERO     #1AVTM           On Yard Time
     C                     Z-ADD*ZERO     #1KZDT           Deadline Depart
     C                     Z-ADD*ZERO     #1AXTM           Deadline Depart
     C                     MOVEL*BLANK    #1LHOS           Load Held Over
     C                     MOVEL*BLANK    #1LHOR           Load Held Over
     C                     MOVEL*BLANK    #1WNTX           Load Held Over
     C                     MOVEL*BLANK    #1OITX           Ocean BOL Numbe
     C                     MOVEL*BLANK    #1OJTX           Express Mail Nu
     C                     Z-ADD*ZERO     #1LLDT           Express Mail Da
     C                     MOVEL*BLANK    #1LSHG           Load Shag Flag
     C                     MOVEL*BLANK    #1YPST           Load Wash Flag
     C                     Z-ADD*ZERO     #1K0DT           Product Complet
     C                     Z-ADD*ZERO     #1AYTM           Product Complet
     C                     Z-ADD*ZERO     #1KNNX           Pallets Loaded
     C                     Z-ADD*ZERO     #1ICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     #1IDWG           Tot Pallet Tare
     C                     MOVEL*BLANK    #1H9SX           Load Confirmed
     C                     MOVEL*BLANK    #1WOTX           Load Confirmed
     C                     Z-ADD*ZERO     #1K1DT           Load Confirmati
     C                     Z-ADD*ZERO     #1AZTM           Load Door 1
     C                     Z-ADD*ZERO     #1K2DT           Override Total
     C                     Z-ADD*ZERO     #1A0TM           Load Door 2
     C                     MOVEL*BLANK    #1ROST           Partial Load
     C                     MOVEL*BLANK    #1RPST           Load Confirmati
     C                     MOVEL*BLANK    #1RQST           Export Load USD
     C                     MOVEL*BLANK    #1RRST           Late Delivery E
     C                     Z-ADD*ZERO     #1ZBVA           Load Actual Fre
     C                     MOVEL*BLANK    #1WPTX           Hide on WW Load
     C                     MOVEL*BLANK    #1WQTX           Late Billing Em
     C                     MOVEL*BLANK    #1WRTX           Shipping Temp C
     C                     MOVEL*BLANK    #1WSTX           LH Held Over Rs
     C                     MOVEL*BLANK    #1RVSX           Multi Company L
     C                     MOVEL*BLANK    #1RUSX           Fax Sent to SSI
     C                     MOVEL*BLANK    #1RWSX           Schedule Pos Lo
     C                     MOVEL*BLANK    #1RXSX           LH Power Only L
     C                     MOVEL*BLANK    #1RYSX           MG Created Load
     C                     MOVEL*BLANK    #1RZSX           LH Unused Sts 5
     C                     MOVEL*BLANK    #1R0SX           Load U/M
     C                     MOVEL*BLANK    #1R1SX           TPM Shipment St
     C                     MOVEL*BLANK    #1R2SX           LH Unused Sts 8
     C                     MOVEL*BLANK    #1R3SX           LH On-Time Reas
     C                     MOVEL*BLANK    #1R4SX           LH Held Over Re
     C                     Z-ADD*ZERO     #1PYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     #1CKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     #1PZDT           LH Last Combo P
     C                     Z-ADD*ZERO     #1CLTM           LH Last Combo P
     C                     Z-ADD*ZERO     #1P0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     #1CMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     #1P1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     #1CNTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P2DT           LH Unused Date
     C                     Z-ADD*ZERO     #1COTM           LH Unused Time
     C                     Z-ADD*ZERO     #1P3DT           LH Unused Date
     C                     Z-ADD*ZERO     #1CQTM           LH Unused Time
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #1RMNB           Load ID
     C                     Z-ADD*ZERO     #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADD*ZERO     #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     MOVEL*BLANK    #DJDSX           LSSA Load Slot
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     #DBINX           Combo Load Limi
     C                     Z-ADD*ZERO     #DNWNX           Slot Limit for
     C                     Z-ADD*ZERO     #DIUNX           Export Load Lim
     C                     Z-ADD*ZERO     #DNVNX           Slot Limit for
     C                     Z-ADD*ZERO     #DBHNX           Box Load Limit
     C                     Z-ADD*ZERO     #DNXNX           Slot Limit for
     C                     Z-ADD*ZERO     #DGXWG           Weight Schedule
     C                     Z-ADD*ZERO     #DIOWG           Weight Limit fo
     C                     Z-ADD*ZERO     #DHODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VDHODT
      * USER: Load screen
     C                     Z-ADDP1AODT    #1AODT           Scheduled Ship
     C                     Z-ADDP1NYDT    #1EIDT           Requested Deliv
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
     C                     MOVEL'Y'       #DB8ST           Status - Y or N
      * Get Warehouse code/type/UM for existing ordrs on the load
     C                     Z-ADD*ZERO     YL0042           Boxes Qty for a
      * 05/11/04 SLM PKTR01 Multi-Company - remove Company RST or Pos
      * RTV UM/Whs Code f/Lmt  RT - Order Header TRG  * 
     C                     EXSR SKRVGN
      * Update slot type if it is blanks
      * CASE: PAR.Slot Type f/New Ords USR EQ WRK.Blank 6 USR
     C           P1JRSX    IFEQ WUXKTX                     *IF
     C                     MOVELYL0016    P1JRSX           Slot Type f/New
     C                     END                             *FI
      * Set Warehouse for Load based on orders already assigned, and to b
      * CASE: LCL.Warehouse Type NE PAR.Warehouse Type Assigned
     C           YL0044    IFNE P1JFSX                     *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Warehouse Type Assigned is Fresh
      *   |- c2    : LCL.Warehouse Type is Equal blank
      *   '-
     C           P1JFSX    IFEQ 'FR'                       *IF
     C           YL0044    OREQ *BLANK                     *OR
     C                     MOVELP1JFSX    YL0044           Warehouse Type
     C                     MOVELP1CBAA    YL0043           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  P1I0QT    YL0042           Boxes Qty for a
      * Clc Load Slot Type    IF
      * RMC E2706 9/11/13- No more MX, if MX and boxqty<BOXLOAD Comp valu
      *    then CB Else BX
      * Set UM based on Orders to be assgnd- Priority- CB,EX,BX,MX
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Slot Type f/New Ords USR is Combo
      *   |- c2    : PAR.Slot Type f/load USR is Combo
      *   |- c3    : PAR.Slot Type f/load USR EQ WRK.Blank 6 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1JRSX    IFEQ 'CB'                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0016    IFEQ 'CB'                       *IF
     C           YL0016    OREQ WUXKTX                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'CB'      YL0016           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : PAR.Slot Type f/New Ords USR is Export
      *   |- c2    : PAR.Slot Type f/load USR is Export
      *   |- c3    : PAR.Export Status is yes
      *   '-
     C           P1JRSX    IFEQ 'EX'                       *IF
     C           YL0016    OREQ 'EX'                       *OR
     C           YL0019    OREQ 'Y'                        *OR
     C                     MOVEL'EX'      YL0016           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Slot Type f/New Ords USR is Box
      *   |- c2    : PAR.Slot Type f/load USR is Box
      *   |- c3    : PAR.Slot Type f/load USR EQ WRK.Blank 6 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1JRSX    IFEQ 'BX'                       *IF
     C                     MOVEL'0'       Y0CX02  1
     C           YL0016    IFEQ 'BX'                       *IF
     C           YL0016    OREQ WUXKTX                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'BX'      YL0016           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      YL0016           Slot Type f/loa
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Slot Type f/load USR is Mixed
     C           YL0016    IFEQ 'MX'                       *IF
      *
     C                     MOVEL*BLANK    WN0001 10        User Code Model
      *
      * RTV Default Co No App IF
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SNRVGN
      * CASE: LCL.Company Number is Equal to zero
     C           YL0050    IFEQ 0                          *IF
      * CASE: PAR.User Code Model is equal to blank
     C           WN0001    IFEQ *BLANK                     *IF
      * RTV First Default Co  RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0036    P      User Profile Na
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    YL0049           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV First Default Co  RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0036    P      User Profile Na
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    YL0049           Company Number
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0050    YL0049           Company Number
     C                     END                             *FI
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0049    WL0024           Company Number
     C                     MOVEL'BOXLOAD' WL0025    P      Company Value C
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    YL0051           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0042    IFLT YL0051                     *IF
     C                     MOVEL'CB'      YL0016           Slot Type f/loa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0016           Slot Type f/loa
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELYL0043    #1AJCD           Warehouse Code
      * RTV Warehouse Slot Typ RT - Warehouse  * 
     C                     EXSR SPRVGN
      * RTV Shipping Co        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0043    WL0022    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0001           Shipping Compan
      * ** RTV Day of Week to use for later retrieve          E000233
      * RTV Day and Week No.   RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0001           Company Number
     C                     Z-ADD#1AODT    WL0002           Post to G/L Dat
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0003           Accounting Peri
     C                     MOVELWL0004    YL0004    P      Day of Week
     C                     Z-ADDWL0005    YL0005           Week Number
      * Get Load and Weight Limits from Control file
      * CASE: LCL.WHS Slotting Limit Type is By Load
     C           YL0006    IFEQ 'L'                        *IF
      * ** Use Day of Week instead of effective date          E000233
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0006           Company Number
     C                     MOVEL#1AJCD    WL0007    P      Warehouse Code
     C                     MOVELYL0004    WL0008    P      Day of Week
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    #DNVNX           Slot Limit for
     C                     Z-ADDWL0010    #DNWNX           Slot Limit for
     C                     Z-ADDWL0011    #DNXNX           Slot Limit for
     C                     Z-ADDWL0012    YN0001           Weight Limit fo
     C                     Z-ADDWL0013    YN0002           Weight Limit fo
     C                     Z-ADDWL0014    YN0003           Weight Limit fo
     C                     ELSE
      * CASE: LCL.WHS Slotting Limit Type is By Weight
     C           YL0006    IFEQ 'W'                        *IF
      * ** Use Day of Week instead of effective date          E000233
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0006           Company Number
     C                     MOVEL#1AJCD    WL0007    P      Warehouse Code
     C                     MOVELYL0004    WL0008    P      Day of Week
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YN0004           Slot Limit for
     C                     Z-ADDWL0010    YN0005           Slot Limit for
     C                     Z-ADDWL0011    YN0006           Slot Limit for
     C                     Z-ADDWL0012    #DIOWG           Weight Limit fo
     C                     Z-ADDWL0013    #DIPWG           Weight Limit fo
     C                     Z-ADDWL0014    #DIQWG           Weight Limit fo
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELYL0016    #DJDSX           LSSA Load Slot
     C           YL0030    ADD  P1ISWG    YL0052           USR Weight
      * Get Sched Load Slots.
      * CASE: LCL.WHS Slotting Limit Type is By Load
     C           YL0006    IFEQ 'L'                        *IF
     C                     Z-ADD*ZERO     #DIUNX           Export Load Lim
     C                     Z-ADD*ZERO     #DBINX           Combo Load Limi
     C                     Z-ADD*ZERO     #DBHNX           Box Load Limit
      * RTV Limit Loads f/Slot RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0015    P      Ship From Wareh
     C                     Z-ADD#1AODT    WL0016           Scheduled Ship
     C                     Z-ADDP1RMNB    WL0017           Load ID
     C                     Z-ADD#DIUNX    WL0018           Export Load Lim
     C                     Z-ADD#DBINX    WL0019           Combo Load Limi
     C                     Z-ADD#DBHNX    WL0020           Box Load Limit
     C                     MOVELYL0007    WL0021    P      Record Found -O
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    #DIUNX           Export Load Lim
     C                     Z-ADDWL0019    #DBINX           Combo Load Limi
     C                     Z-ADDWL0020    #DBHNX           Box Load Limit
     C                     MOVELWL0021    YL0007    P      Record Found -O
     C                     END                             *FI
      * Get Sched Weight Slots.
      * CASE: LCL.WHS Slotting Limit Type is By Weight
     C           YL0006    IFEQ 'W'                        *IF
     C                     Z-ADD*ZERO     YL0017           Weight Schedule
      * RTV Shipping Co        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0022    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0001           Shipping Compan
      * Rtv OrderWt f/ShpDate RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0027           Company Number
     C                     MOVEL#1AJCD    WL0028    P      Warehouse Code
     C                     MOVELYL0053    WL0029    P      U/M - Ordered
     C                     Z-ADDP1AODT    WL0030           Scheduled Ship
     C                     Z-ADDYL0017    WL0031           Weight Schedule
     C                     MOVELYL0019    WL0032    P      Export Status
     C                     MOVELYL0016    WL0033    P      LSSA Load Slot
     C                     MOVELYL0007    WL0034    P      Record Found -O
     C                     Z-ADDP1RMNB    WL0035           Load ID
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0031    YL0017           Weight Schedule
     C                     MOVELWL0034    YL0007    P      Record Found -O
     C                     END                             *FI
     C                     MOVEL'N'       YL0041           Display Partial
      * Check for Load Limit exceeded.
      * CASE: LCL.WHS Slotting Limit Type is By Load
     C           YL0006    IFEQ 'L'                        *IF
      * CASE: LCL.USR Weight GT LCL.Partial Load Max Lbs USR
     C           YL0052    IFGT YL0054                     *IF
      * Check for limit being exceeded
      * CASE: LCL.Slot Type f/load USR is Export
     C           YL0016    IFEQ 'EX'                       *IF
      * Add this load to load total if it's a new load
      * CASE: LCL.Record Found -OrdDtlUSR is Record Not Found
     C           YL0007    IFEQ 'N'                        *IF
     C                     ADD  1         #DIUNX           Export Load Lim
     C                     END                             *FI
      * Export Load Info Message
      * CASE: DTL.Export Load Limit GT DTL.Slot Limit for Export
     C           #DIUNX    IFGT #DNVNX                     *IF
      * Send message 'No Shipping Slots Avail'
     C                     MOVEL'USR3032' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       #DB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Slot Type f/load USR is Box
     C           YL0016    IFEQ 'BX'                       *IF
      * add this load to load total
      * CASE: LCL.Record Found -OrdDtlUSR is Record Not Found
     C           YL0007    IFEQ 'N'                        *IF
     C                     ADD  1         #DBHNX           Box Load Limit
     C                     END                             *FI
      * Box Load Info Message
      * CASE: DTL.Box Load Limit        USR GT DTL.Slot Limit for Box/Oth
     C           #DBHNX    IFGT #DNXNX                     *IF
      * Send message 'No Shipping Slots Avail'
     C                     MOVEL'USR3032' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       #DB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Slot Type f/load USR is Combo
     C           YL0016    IFEQ 'CB'                       *IF
      * Add this load to load total
      * CASE: LCL.Record Found -OrdDtlUSR is Record Not Found
     C           YL0007    IFEQ 'N'                        *IF
     C                     ADD  1         #DBINX           Combo Load Limi
     C                     END                             *FI
      * Combo Load Info Message
      * CASE: DTL.Combo Load Limit GT DTL.Slot Limit for Combo
     C           #DBINX    IFGT #DNWNX                     *IF
      * Send message 'No Shipping Slots Avail'
     C                     MOVEL'USR3032' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       #DB8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0041           Display Partial
     C                     END                             *FI
     C                     END                             *FI
      * Check for Weight Limit exceeded
      * CASE: LCL.WHS Slotting Limit Type is By Weight
     C           YL0006    IFEQ 'W'                        *IF
     C                     ADD  P1ISWG    YL0017           Weight Schedule
      * CASE: LCL.Record Found -OrdDtlUSR is Record Not Found
     C           YL0007    IFEQ 'N'                        *IF
     C                     ADD  YL0030    YL0017           Weight Schedule
     C                     END                             *FI
      * Weight exceeded message
      * CASE: LCL.Weight Scheduled USR GT DTL.Weight Limit for Export
     C           YL0017    IFGT #DIOWG                     *IF
      * Setup message data for message
      * Send message 'Scheduled Ship Wt exceedd'
     C                     MOVEL'USR3021' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'N'       #DB8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0017    #DGXWG           Weight Schedule
      * Setup Scheduled Ship Date if the Load or Weight Limit was exceede
      * CASE: DTL.Status - Y or N is no
     C           #DB8ST    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       YL0002           Display Flag
     C                     Z-ADD#1AODT    #DHODT           Scheduled Ship
     C                     Z-ADD#DHODT    YL0055           Scheduled Ship
     C                     ELSE
      * CASE: *OTHERWISE
      * Limits not found.
      * CASE:
      *  - c1ANDc2ANDc3ANDc4
      *   |- c1    : DTL.Slot Limit for Export EQ WRK.ZERO
      *   |- c2    : DTL.Slot Limit for Combo EQ WRK.ZERO
      *   |- c3    : DTL.Slot Limit for Box/Other EQ WRK.ZERO
      *   |- c4    : DTL.Weight Limit for Export EQ WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DNVNX    IFEQ WUW0NB                     *IF
     C           #DNWNX    IFEQ WUW0NB                     *IF
     C           #DNXNX    IFEQ WUW0NB                     *IF
     C           #DIOWG    IFEQ WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Slottin Limits not found'
     C                     MOVEL'USR3037' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL'N'       YL0002           Display Flag
      * *******
      * 2007/09/24 PKD Exit if slotting was not exceeded.
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
      * *******
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      * Convert Scheduled Ship Date USR to display format
      * Convert date
     C           1000000   ADD  #DHODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDHODT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WABCDT    WQSA02           Post to G/L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Company Number
     C                     Z-ADDWL0002    WQSA02           Post to G/L Dat
      * Establish starting position
     C           KRSSA     SETLL@AFREYY                    *
     C           KRSSA     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDWAETNB    WL0003           Accounting Peri
     C                     MOVELWAA9ST    WL0004           Day of Week
     C                     Z-ADDWAEINB    WL0005           Week Number
     C           KRSSA     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBAJCD    WQSB02           Warehouse Code
     C           *LIKE     DEFN WBA9ST    WQSB03           Day of Week
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Warehouse Code
     C                     KFLD           WQSB03           Day of Week
      * Setup key
     C                     Z-ADDWL0006    WQSB01           Company Number
     C                     MOVELWL0007    WQSB02           Warehouse Code
     C                     MOVELWL0008    WQSB03           Day of Week
      * Establish starting position
     C           KRSSB     SETLL@A3REI3                    *
     C           KRSSB     READE@A3REI3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3033' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0009           Slot Limit for
     C                     Z-ADD*ZERO     WL0010           Slot Limit for
     C                     Z-ADD*ZERO     WL0011           Slot Limit for
     C                     Z-ADD*ZERO     WL0012           Weight Limit fo
     C                     Z-ADD*ZERO     WL0013           Weight Limit fo
     C                     Z-ADD*ZERO     WL0014           Weight Limit fo
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBNVNX    WL0009           Slot Limit for
     C                     Z-ADDWBNWNX    WL0010           Slot Limit for
     C                     Z-ADDWBNXNX    WL0011           Slot Limit for
     C                     Z-ADDWBIOWG    WL0012           Weight Limit fo
     C                     Z-ADDWBIPWG    WL0013           Weight Limit fo
     C                     Z-ADDWBIQWG    WL0014           Weight Limit fo
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@A3REI3                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Limit Loads f/Slot RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0018           Export Load Lim
     C                     Z-ADD*ZERO     WL0019           Combo Load Limi
     C                     Z-ADD*ZERO     WL0020           Box Load Limit
     C                     MOVEL'N'       WL0021           Record Found -O
      * RTV Shipping Co        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0015    WL0022    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0008           Shipping Compan
      * ** Retrieve needed values from System Values file     E000233
      * Rtv Company Ctl Vals  XF - Company Values  * 
     C                     CALL 'PNOQXFR'              90  Rtv Company Ctl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0008    WQ0004  30       Company Number
     C           YL0009    PARM *ZERO     WQ0005  50       Box Load Min Bo
     C           YL0010    PARM *ZERO     WQ0006  70       Partial Load Ma
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * change log
     C                     EXSR UASUBR                     change log
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCVPCD    WQSC02           Ship From Wareh
     C           *LIKE     DEFN WCAODT    WQSC03           Scheduled Ship
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Ship From Wareh
     C                     KFLD           WQSC03           Scheduled Ship
      * Setup key
     C                     MOVELWL0015    WQSC02           Ship From Wareh
     C                     Z-ADDWL0016    WQSC03           Scheduled Ship
      * Establish starting position
     C           KRSSC     SETLL@FJCPN3                    *
     C           KRSSC     READE@FJCPN3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC 9/11/13 E2709
      * Check for Mixed having box qty>BOXLOAD qty, if yes, then BX, else
      * Change Priority 3/14/01    RMC
      * Check for Mixed having a box qty > 60 to stay BX   6/12/01    RMC
      * Per Steve Burke - 6/27/01
      * Dont check just for Prepaid Trucks.  Collect and Prepaid trucks i
      * If Partial Load (<= 20000 lbs) dont count.
      * Priority :  Combo , Export, Box
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Load Type is Regular
      *   |- c2    : DB1.Total Load Order Weight GT LCL.Partial Load Max
      *   |- c3    : DB1.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCVDST    IFEQ 'R'                        *IF
     C           WCRPNB    IFGT YL0010                     *IF
     C           WCQ2CD    IFEQ 'CT'                       *IF
     C           WCQ2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Update load found so this load wont be counted again in the calli
      * CASE: DB1.Load ID EQ PAR.Load ID
     C           WCRMNB    IFEQ WL0017                     *IF
     C                     MOVEL'Y'       WL0021           Record Found -O
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0011           Boxes Total Qua
      * 05/11/04 SLM PKTR01 Multi-Company - Function chgd-remove Company
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
     C                     EXSR SERVGN
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0012    IFEQ 'CB'                       *IF
     C                     ADD  1         WL0019           Combo Load Limi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWCU2ST    YL0015           Export Status D
      * Count Load as Export if order whse = Ship-From-Whse & Export 8/3/
      * CASE: DB1.Export Status is yes
     C           WCU2ST    IFEQ 'Y'                        *IF
      * See if export order whse matches load Shipfrom whse  08/03/07 RMC
      * For example a load could be export sts=Y and ship from whse is GP
      * there are multiple orders, and the one that is export is out of C
      *  in that case, dont count the load as export- per Steve B and Jim
      * RTV ExpOrd Whse for LD XF - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWCRMNB    PARMNB           Load ID
      *
     C                     CALL 'PMK2XFR'              90  RTV ExpOrd Whse
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
     C                     PARM WCVPCD    WQ0007  3        Ship From Wareh
     C           YL0015    PARM YL0015    WQ0008  1        Export Status D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMK2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: LCL.Export Status Dft is yes
     C           YL0015    IFEQ 'Y'                        *IF
     C                     ADD  1         WL0018           Export Load Lim
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WL0020           Box Load Limit
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@FJCPN3                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0022    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0023           Shipping Compan
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDBWC3    WL0023           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Funt chg to rmv Co RST or Pos
     C                     MOVEL*BLANK    YL0012           USR Unit of Mea
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSE01           Load ID
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Load ID
     C                     KFLD           WEC4NB           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Load ID
      * Setup key
     C                     Z-ADDWCRMNB    WQSE01           Load ID
     C                     Z-ADD*ZERO     WEC4NB           Order Number
      * Establish starting position
     C           KPSSE     SETLL@BFCPR0                    *
     C           KRSSE     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
     C                     EXSR SFRVGN
     C           KRSSE     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * RMC E2709 added here so it wont need to be in every calling pgm
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0012    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0024           Company Number
     C                     MOVEL'BOXLOAD' WL0025    P      Company Value C
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    YL0014           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0011    IFLT YL0014                     *IF
     C                     MOVEL'CB'      YL0012           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0012           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSF01           Company Number
     C                     Z-ADDWEC4NB    WQSF02           Order Number
     C                     Z-ADD1         WFDPNB           Order Sequence
      * Establish starting position
     C           KPSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0012           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0011           Boxes Total Qua
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SFEXIT                     *QUIT
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/08/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/08/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELWFAGCD    YL0013           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0013    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0013           U/M - Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration  6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0013    IFEQ 'BX'                       *IF
     C                     ADD  WFAVQT    YL0011           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           YL0012    IFEQ *BLANK                     *IF
     C                     MOVELYL0013    YL0012           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0013    IFEQ YL0012                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      YL0012           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0024    WGAIC3           Company Number
     C                     MOVELWL0025    WGV8CD           Company Value C
      * Establish starting position
     C           KRSSG     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGM8NB    WL0026           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv OrderWt f/ShpDate RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 10/02/07 set return code to *normal if no rcd found- not an e
     C                     MOVEL'N'       WL0034           Record Found -O
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHAJCD    WQSH02           Warehouse Code
     C           *LIKE     DEFN WHAODT    WQSH03           Scheduled Ship
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Warehouse Code
     C                     KFLD           WQSH03           Scheduled Ship
      * Setup key
     C                     Z-ADDWL0027    WQSH01           Company Number
     C                     MOVELWL0028    WQSH02           Warehouse Code
     C                     Z-ADDWL0030    WQSH03           Scheduled Ship
      * Establish starting position
     C           KRSSH     SETLL@BGWKII                    *
     C           KRSSH     READE@BGWKII                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0020           Record Selected
      * CASE: DB1.Order Number NE WRK.Order Number Saved USR
     C           WHC4NB    IFNE WUDLC7                     *IF
      * RTV Load ID,shp mth   RT - Order Header TRG  * 
     C                     EXSR SIRVGN
      * S17054 DN 04/07/21-Count Cases as Boxes. Replaced function with
      *   'RTV UM/Whs Code-Add CS RT'.
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
     C                     EXSR SJRVGN
     C                     Z-ADDWHC4NB    WUDLC7           Order Number Sa
     C                     END                             *FI
      * CASE: LCL.Load ID is Blank
     C           YL0021    IFEQ 0                          *IF
     C                     MOVEL'N'       YL0020           Record Selected
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Shipping Method is Rail
      *   |- c2    : LCL.Load Type is Not Regular
      *   '-
     C           YL0022    IFEQ 'CR'                       *IF
     C           YL0022    OREQ 'PR'
     C           YL0024    OREQ *BLANK                     *OR
     C           YL0024    OREQ 'B'
     C                     MOVEL'N'       YL0020           Record Selected
     C                     END                             *FI
      * Priority: CB,EX,BX
      * CASE: LCL.Record Selected       USR is yes
     C           YL0020    IFEQ 'Y'                        *IF
      * CASE: PAR.LSSA Load Slot Type is Combo
     C           WL0033    IFEQ 'CB'                       *IF
      * CASE: LCL.USR Unit of Measure is Combos
     C           YL0026    IFEQ 'CB'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0020           Record Selected
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.LSSA Load Slot Type is Export
     C           WL0033    IFEQ 'EX'                       *IF
      * CASE: LCL.Export Status is Not Yes
     C           YL0023    IFEQ *BLANK                     *IF
     C           YL0023    OREQ 'N'
     C                     MOVEL'N'       YL0020           Record Selected
     C                     END                             *FI
      * CASE: PAR.LSSA Load Slot Type is Box
     C           WL0033    IFEQ 'BX'                       *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.USR Unit of Measure is Boxed
      *   |- c2    : LCL.USR Unit of Measure is Mixed
      *   '-
     C           YL0026    IFEQ 'BX'                       *IF
     C           YL0026    OREQ 'MX'                       *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0020           Record Selected
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Record Selected       USR is yes
     C           YL0020    IFEQ 'Y'                        *IF
     C                     ADD  WHAUWG    WL0031           Weight Schedule
      * Update load found so this load wont be counted again in the calli
      * CASE: PAR.Load ID EQ LCL.Load ID
     C           WL0035    IFEQ YL0021                     *IF
     C                     MOVEL'Y'       WL0034           Record Found -O
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@BGWKII                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Load ID,shp mth   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
      * Setup key
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
      * Establish starting position
     C           KRSSI     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0021           Load ID
     C                     MOVEL*BLANK    YL0022           Shipping Method
     C                     MOVEL*BLANK    YL0023           Export Status
     C                     MOVEL*BLANK    YL0024           Load Type
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIRMNB    YL0021           Load ID
     C                     MOVELWIQ2CD    YL0022           Shipping Method
     C                     MOVELWIU2ST    YL0023           Export Status
     C                     MOVELWIVDST    YL0024           Load Type
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code-Add CS RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD*ZERO     YL0027           Boxes Total Qua
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSJ02           Order Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDWHAIC3    WQSJ01           Company Number
     C                     Z-ADDWHC4NB    WQSJ02           Order Number
     C                     Z-ADD1         WFDPNB           Order Sequence
     C                     Z-ADD1         WFUENB           Order Secondary
      * Establish starting position
     C           KPSSJ     SETLL@BGWKL1                    *
     C           KRSSJ     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0025           Warehouse Code
     C                     MOVEL*BLANK    YL0026           USR Unit of Mea
     C                     GOTO SJEXIT                     *QUIT
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PF3280 -- add "Cases" to the case-stmt
     C                     MOVELWFAJCD    YL0025           Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.U/M - Ordered is EQ Boxes
      *   |- c3    : DB1.U/M - Ordered is Mixed
      *   |- c4    : DB1.U/M - Ordered is Cases
      *   '-
     C           WFAGCD    IFEQ 'CB'                       *IF
     C           WFAGCD    OREQ 'BX'                       *OR
     C           WFAGCD    OREQ 'MX'                       *OR
     C           WFAGCD    OREQ 'CS'                       *OR
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/06/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/06/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELWFAGCD    YL0028           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0028    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0028           U/M - Ordered
     C                     END                             *FI
      * Sum for later check
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0028    IFEQ 'BX'                       *IF
     C                     ADD  WFAVQT    YL0027           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           YL0026    IFEQ *BLANK                     *IF
     C                     MOVELYL0028    YL0026           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0028    IFEQ YL0026                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WUAGCD           U/M - Ordered
     C                     MOVELWUAGCD    YL0026           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * E2709 RMC 9/12/13  Classify as BX/CB - never MX
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0026    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0024           Company Number
     C                     MOVEL'BOXLOAD' WL0025    P      Company Value C
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    YL0029           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0027    IFLT YL0029                     *IF
     C                     MOVEL'CB'      YL0026           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0026           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code f/Lmt  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Funt chg to rmv Co RST or Pos
     C                     MOVEL*BLANK    YL0016           USR Unit of Mea
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSK01           Load ID
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Load ID
     C                     KFLD           WEC4NB           Order Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSK01           Load ID
     C                     Z-ADD*ZERO     WEC4NB           Order Number
      * Establish starting position
     C           KPSSK     SETLL@BFCPR0                    *
     C           KRSSK     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 6/12/01 Accum Box Qty for Slotting consideration
      * RTV UM/Whs Code Lmt,Bx RT - Order Detail  * 
     C                     EXSR SLRVGN
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SMRVGN
      * Fresh Orders on a Load make the Load FRESH.
      * CASE: LCL.Warehouse Type is Fresh
     C           YL0048    IFEQ 'FR'                       *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Warehouse Type is Frozen
      *   |- c2    : PAR.Warehouse Type is Equal blank
      *   '-
     C           YL0044    IFEQ 'FZ'                       *IF
     C           YL0044    OREQ *BLANK                     *OR
     C                     MOVELYL0048    YL0044           Warehouse Type
     C                     MOVELYL0045    YL0043           Warehouse Code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Type is Equal blank
     C           YL0044    IFEQ *BLANK                     *IF
     C                     MOVELYL0048    YL0044           Warehouse Type
     C                     MOVELYL0045    YL0043           Warehouse Code
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELYL0016    WUAGCD           U/M - Ordered
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Export Status is Not Yes
      *   |- c2    : DB1.Export Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0019    IFEQ *BLANK                     *IF
     C           YL0019    OREQ 'N'
     C           WEU2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWEU2ST    YL0019           Export Status
     C                     END                             *FI
     C           KRSSK     READE@BFCPR0                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code Lmt,Bx RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSL02           Order Number
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADDWEAIC3    WQSL01           Company Number
     C                     Z-ADDWEC4NB    WQSL02           Order Number
     C                     Z-ADD1         WFDPNB           Order Sequence
     C                     Z-ADD1         WFUENB           Order Secondary
      * Establish starting position
     C           KPSSL     SETLL@BGWKL1                    *
     C           KRSSL     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0045           Warehouse Code
     C                     MOVEL*BLANK    YL0016           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0042           Boxes Total Qua
     C                     Z-ADD*ZERO     YL0030           USR Weight   9.
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PF3280 -- add "Cases" to the case-stmt
     C                     MOVELWFAJCD    YL0045           Warehouse Code
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : DB1.U/M - Ordered is Combos
      *   |- c2    : DB1.U/M - Ordered is EQ Boxes
      *   |- c3    : DB1.U/M - Ordered is Mixed
      *   |- c4    : DB1.U/M - Ordered is Cases
      *   '-
     C           WFAGCD    IFEQ 'CB'                       *IF
     C           WFAGCD    OREQ 'BX'                       *OR
     C           WFAGCD    OREQ 'MX'                       *OR
     C           WFAGCD    OREQ 'CS'                       *OR
      * CASE: DB1.Detail Line Status is Cancelled
     C           WFGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/09/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/09/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELWFAGCD    YL0046           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0046    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0046           U/M - Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration 6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0046    IFEQ 'BX'                       *IF
     C                     ADD  WFAVQT    YL0042           Boxes Total Qua
     C                     END                             *FI
     C                     ADD  WFAUWG    YL0030           USR Weight   9.
      * CASE: PAR.USR Unit of Measure is *Blank
     C           YL0016    IFEQ *BLANK                     *IF
     C                     MOVELYL0046    YL0016           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0046    IFEQ YL0016                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WUAGCD           U/M - Ordered
     C                     MOVELWUAGCD    YL0016           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0016    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0024           Company Number
     C                     MOVEL'BOXLOAD' WL0025    P      Company Value C
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    YL0047           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0042    IFLT YL0047                     *IF
     C                     MOVEL'CB'      YL0016           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0016           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0045    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0048           Warehouse Type
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDWPST    YL0048           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     WRAJVN           User Profile Na
      * Establish starting position
     C           KRSSN     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAIC3    YL0050           Company Number
     C                     MOVELWRBUVN    WN0001           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV First Default Co  RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAJVN    WQSO01           User Profile Na
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           User Profile Na
      * Setup key
     C                     MOVELWL0036    WQSO01           User Profile Na
      * Establish starting position
     C           KRSSO     SETLL@DTRETE                    *
     C           KRSSO     READE@DTRETE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0037           Company Number
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWSAIC3    WL0037           Company Number
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@DTRETE                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Warehouse Slot Typ RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0043    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSP     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           WHS Slotting Li
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDT6ST    YL0006           WHS Slotting Li
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * change log
      *================================================================
      * 02/03/2010 LJB E000233
      *    Retrieve needed values from System Values file
      * 08/03/07 RMC dly029 Count Load as Export if export order whse
      *    matches ShipFrom Whse on the load   -- per jim n, steve b
      * 05/11/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *    from Logical View
      * 05/17/04 RMC PKTR01 Multi-Company - Use Shipping Co from Whse
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1RMNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'OMCPSRR'              90  SEL Load ID
     C                     PARM *BLANK    W0RTN   7
     C           #1RMNB    PARM #1RMNB    WQ0009  70       Load ID
     C           #1AIC3    PARM #1AIC3    WQ0010  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMCPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0011  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWJ    KLIST
     C                     KFLD           WJAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WJAIC3
     C           KLVBWJ    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Carrier
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BZNA    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1BZNA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BZNA' defaulted for 'Carrier Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0031' defaulted for 'Name'.
     C                     CALL 'PDWHSRR'              90  SEL Carrier Nam
     C                     PARM *BLANK    W0RTN   7
     C           #1BZNA    PARM #1BZNA    WQ0012  3        Carrier Code
     C           YL0031    PARM *BLANK    WQ0013 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BZNA    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BZNA    IFEQ *BLANK                     Carrier Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWK    KLIST
     C                     KFLD           WKBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1BZNA    WKBZNA
     C           KLVCWK    CHAIN@FFREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Carrier                NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Truck Size
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RONB    WK1X01  1
     C           WK1X01    IFEQ '?'                        Truck Size
     C           YPMTFD    OREQ '#1RONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RONB' defaulted for 'Truck Size'.
     C                     CALL 'PDEPSRR'              90  SEL Truck Size
     C                     PARM *BLANK    W0RTN   7
     C           #1RONB    PARM #1RONB    WQ0014  7        Truck Size
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RONB    IFNE *BLANK                     Truck Size
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RONB    IFEQ *BLANK                     Truck Size
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWL    KLIST
     C                     KFLD           WLRONB           Truck Size
      * Setup key
     C                     MOVEL#1RONB    WLRONB
     C           KLVDWL    CHAIN@FKREBT              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Truck Size             NF'
     C                     MOVEL'USR1190' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1190' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Warehouse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1VPCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1VPCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1VPCD' defaulted for 'Ship From Warehouse'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1VPCD    PARM #1VPCD    WQ0015  3        Warehouse Code
     C                     PARM *ZERO     WQ0016  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1VPCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1VPCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWD    KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1VPCD    WDAJCD
     C           KLVEWD    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to State
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1DBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        State Code
     C           YPMTFD    OREQ '#1DBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1DBCD' defaulted for 'Ship To State Code'.
     C                     CALL 'CAAHSRR'              90  SEL State
     C                     PARM *BLANK    W0RTN   7
     C           #1DBCD    PARM #1DBCD    WQ0017  2        State Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1DBCD    IFNE *BLANK                     State Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1DBCD    IFEQ *BLANK                     State Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWM    KLIST
     C                     KFLD           WMBGCD           State Code
      * Setup key
     C                     MOVEL#1DBCD    WMBGCD
     C           KLVFWM    CHAIN@ACREAH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'State                  NF'
     C                     MOVEL'USR0005' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0005' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Carrier
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1XCCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Carrier Code
     C           YPMTFD    OREQ '#1XCCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1XCCD' defaulted for 'Carrier Broker'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0031' defaulted for 'Name'.
     C                     CALL 'PDWHSRR'              90  SEL Carrier Nam
     C                     PARM *BLANK    W0RTN   7
     C           #1XCCD    PARM #1XCCD    WQ0018  3        Carrier Code
     C           YL0031    PARM *BLANK    WQ0019 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1XCCD    IFNE *BLANK                     Carrier Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1XCCD    IFEQ *BLANK                     Carrier Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGWK    KLIST
     C                     KFLD           WKBZNA           Carrier Code
      * Setup key
     C                     MOVEL#1XCCD    WKBZNA
     C           KLVGWK    CHAIN@FFREBF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Carrier                NF'
     C                     MOVEL'USR1180' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1180' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Shipping Line/Port
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1XACD    WK1X01  1
     C                     MOVEL#1OANA    WK1X02  1
     C           WK1X01    IFEQ '?'                        Shipping Line
     C           YPMTFD    OREQ '#1XACD'
     C           WK1X02    OREQ '?'                        Port Delv Termi
     C           YPMTFD    OREQ '#1OANA'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1XACD' defaulted for 'Shipping Line'.
      * Field '(DTL) #1OANA' defaulted for 'Port Delv Terminal'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0032' defaulted for 'Port City'.
      * Field '(LCL) YL0033' defaulted for 'Port Address Line 1'.
      * Field '(LCL) YL0034' defaulted for 'Port Address Line 2'.
      * Field '(LCL) YL0035' defaulted for 'Sail Port State'.
      * Field '(LCL) YL0036' defaulted for 'Port Zip/Postal Code'.
      * Field '(LCL) YL0037' defaulted for 'Port Phone Number'.
      * Field '(LCL) YL0038' defaulted for 'Port Fax Number'.
      * Field '(LCL) YL0039' defaulted for 'TPM Location Code'.
      * Field '(LCL) YL0040' defaulted for 'Record Status'.
     C                     CALL 'PBGISRR'              90  SEL ShipLine Al
     C                     PARM *BLANK    W0RTN   7
     C           #1XACD    PARM #1XACD    WQ0020  3        Shipping Line
     C           #1OANA    PARM #1OANA    WQ0021 20        Port Delv Termi
     C           YL0032    PARM *BLANK    WQ0022 25        Port City
     C           YL0033    PARM *BLANK    WQ0023 25        Port Address Li
     C           YL0034    PARM *BLANK    WQ0024 25        Port Address Li
     C           YL0035    PARM *BLANK    WQ0025  2        Sail Port State
     C           YL0036    PARM *BLANK    WQ0026 11        Port Zip/Postal
     C           YL0037    PARM *ZERO     WQ0027 110       Port Phone Numb
     C           YL0038    PARM *BLANK    WQ0028 25        Port Fax Number
     C           YL0039    PARM *BLANK    WQ0029 10        TPM Location Co
     C           YL0040    PARM *BLANK    WQ0030  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBGISRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1XACD    IFNE *BLANK                     Shipping Line
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1OANA    IFNE *BLANK                     Port Delv Termi
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1XACD    IFEQ *BLANK                     Shipping Line
     C           #1OANA    ANDEQ*BLANK                     Port Delv Termi
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHWO    KLIST
     C                     KFLD           WOXACD           Shipping Line
     C                     KFLD           WOOANA           Port Delv Termi
      * Setup key
     C                     MOVEL#1XACD    WOXACD
     C                     MOVEL#1OANA    WOOANA
     C           KLVHWO    CHAIN@LCREL2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Shipping Line/Port     NF'
     C                     MOVEL'USR2419' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2419' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Warehouse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AJCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1AJCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AJCD' defaulted for 'Warehouse Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *ZERO' defaulted for 'Accounting Company'.
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1AJCD    PARM #1AJCD    WQ0031  3        Warehouse Code
     C                     PARM *ZERO     WQ0032  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AJCD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJCD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIWD    KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1AJCD    WDAJCD
     C           KLVIWD    CHAIN@ADREAO              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         YKDDW1    BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 1
      *================================================================
      *================================================================
     CSR         YKEXT1    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ##WSR     MULT 256       ZWORK   50
     C                     ADD  ##WSC     ZWORK
     C                     SUB  ZWORK     ZINPOS
     C                     SUB  1         ZINPOS
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           ZHCSRW    SUB  ##WSR     YWPORW  30
     C           ZHCSCL    SUB  ##WSC     YWPOC1  30
     C                     SUB  1         YWPOC1
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM YWPORW    YYRW    50       Row
     C                     PARM YWPOC1    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZRRPWD    BEGSR
      *================================================================
      * *Reposition window
      *================================================================
     C                     MOVEL'Y'       YSL,1            Set wdw locatio
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
      *
      * Redisplay previous panel
     C                     WRITEASSUME
      *================================================================
     CSR         ZREXIT    ENDSR
      /EJECT
     CSR         ZSSTLC    BEGSR
      *================================================================
      * Set window location
      *================================================================
     C           YSL,1     IFEQ 'Y'                        Set wdw locatio
     C                     MOVEL'*CALC'   YWWDCR           Window referenc
     C                     Z-ADD-3        YWWDRW           Window start ro
     C                     Z-ADD-3        YWWDCL           Window start co
     C                     Z-ADD056       YWWDWD           Window width
     C                     Z-ADD021       YWWDDP           Window depth
     C                     MOVEL'N'       YSL,1            Set wdw locatio
      *
     C                     EXSR ZURTLC                     Retrieve window
     C                     EXSR ZTWDFD                     Move window fie
     C                     END
      *================================================================
     CSR         ZSEXIT    ENDSR
      /EJECT
     CSR         ZTWDFD    BEGSR
      *================================================================
      * Move window fields by panel
      *================================================================
     C                     Z-ADDYWWDRW    ##WSR            Window start ro
     C                     Z-ADDYWWDCL    ##WSC            Window start co
     C                     EXSR YKDDW1
      *================================================================
     CSR         ZTEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZVCFPM    BEGSR
      *================================================================
      * Set Confirm Prompt window location
      *================================================================
      *
     C           ##WSR     ADD  021       YWWDRW
     C           ##WSC     ADD  056       YWWDCL
      *
     C                     ADD  1         YWWDCL
     C                     SUB  1         YWWDRW           Window start ro
     C                     SUB  21        YWWDCL           Window start co
     C                     Z-ADD18        YWWDWD           Window width
     C                     Z-ADD2         YWWDDP           Window depth
     C                     MOVEL'*TL  '   YWWDCR           Window referenc
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN           Retrieval Funct
     C                     EXSR ZURTLC                     Retrieve window
     C                     Z-ADDYWWDRW    ##WSRC           *Window start r
     C                     Z-ADDYWWDCL    ##WSCC           *Window start c
      *
      *================================================================
     CSR         ZVEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
     C                     MOVEL#DB8ST    P1B8ST           Status - Y or N
      * CASE: DTL.*CMD key is CF03
     C           *IN03     IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     P1HODT           Scheduled Ship
     C                     MOVEL'N'       P1B8ST           Status - Y or N
     C                     MOVEL'E'       P1N7CD           USR Return Code
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialise Allow Set Window Location flags
     C                     MOVEA*ALL'Y'   YSL
      * Set display size
     C                     SETOF                         93*
     C           @#SCRW    COMP 27                       93*
      * Initialise window location variables.
     C                     Z-ADD*ZEROS    ##WSR
     C                     Z-ADD*ZEROS    ##WSC
      * Define work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     WUHODT  70
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBNVNX           Slot Limit for
     C                     Z-ADD*ZERO     WBNWNX           Slot Limit for
     C                     Z-ADD*ZERO     WBNXNX           Slot Limit for
     C                     Z-ADD*ZERO     WBIOWG           Weight Limit fo
     C                     Z-ADD*ZERO     WBIPWG           Weight Limit fo
     C                     Z-ADD*ZERO     WBIQWG           Weight Limit fo
     C                     Z-ADD*ZERO     WBNYNX           LSSC Unused Lim
     C                     Z-ADD*ZERO     WBIRWG           LSSC Unused Lim
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Spacers
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Override Total
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WCCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WCPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WCCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WCP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WCCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WCP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WCCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WENPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WENQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WENRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WENSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WEBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WEBQTM           Time of Origina
     C                     Z-ADD*ZERO     WEBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WEBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WEBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WEH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WEH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WEH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WEH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WEH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFL8VA           Billing Detail
     C                     Z-ADD*ZERO     WFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WFATWG           Weight Shipped
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WFNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WFBXTM           Substitution Li
     C                     Z-ADD*ZERO     WFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WFH7NX           OD Item Target
     C                     Z-ADD*ZERO     WFH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WFDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WFDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WFDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WFDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WFDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WFGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WFRINY           Item Age Days
     C                     Z-ADD*ZERO     WFTIDT           Production Ovr
     C                     Z-ADD*ZERO     WFTJDT           Production Ovr
     C                     Z-ADD*ZERO     WFTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WFTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WFTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGM8NB           System Value Nu
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Order Number Saved USR
     C                     Z-ADD*ZERO     WUDLC7  70
      * Define work field U/M - Ordered
     C                     MOVEL*BLANK    WUAGCD  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WKEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WKNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WKNSVA           Long hook balan
     C                     Z-ADD*ZERO     WKNTVA           Short hook bala
     C                     Z-ADD*ZERO     WKNUVA           Tub Balance
     C                     Z-ADD*ZERO     WKS8NB           Home Phone
     C                     Z-ADD*ZERO     WKS9NB           Other Phone
     C                     Z-ADD*ZERO     WKNMVA           Flat Rate
     C                     Z-ADD*ZERO     WKNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WKNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WKNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WKQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WKQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WKMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WKMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WKRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WKMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WKBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WKBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WKBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WKBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WKBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WKBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WKDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WKDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WKDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WKDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WKDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WKDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WKB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WKB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WKB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WKB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WKB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WKB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WKAAC7           Contact Number
     C                     Z-ADD*ZERO     WKTENO           Carrier Unused
     C                     Z-ADD*ZERO     WKAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WKAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WKKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLRSNB           Maximum pounds
     C                     Z-ADD*ZERO     WLRTNB           Maximum Units
     C                     Z-ADD*ZERO     WLTANB           Minimum pounds
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOSPPN           Port Phone Numb
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field Blank 6 USR
     C                     MOVEL*BLANK    WUXKTX  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRNLNB           Entity Number
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  20
     C                     MOVEL*BLANK    WL0004  1
     C                     Z-ADD*ZERO     WL0005  20
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  1
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012 110
     C                     Z-ADD*ZERO     WL0013 110
     C                     Z-ADD*ZERO     WL0014 110
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0015  3
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  30
     C                     MOVEL*BLANK    WL0021  1
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0022  3
     C                     Z-ADD*ZERO     WL0023  30
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0024  30
     C                     MOVEL*BLANK    WL0025 10
     C                     Z-ADD*ZERO     WL0026 155
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0027  30
     C                     MOVEL*BLANK    WL0028  3
     C                     MOVEL*BLANK    WL0029  2
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031 112
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  2
     C                     MOVEL*BLANK    WL0034  1
     C                     Z-ADD*ZERO     WL0035  70
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0036 10
     C                     Z-ADD*ZERO     WL0037  30
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Accounting Period Code
     C                     Z-ADD*ZERO     YL0003  20
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Week Number
     C                     Z-ADD*ZERO     YL0005  20
      * Define local work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YL0006  1
      * Define null work field Weight Limit for Export
     C                     Z-ADD*ZERO     YN0001 110
      * Define null work field Weight Limit for Combo
     C                     Z-ADD*ZERO     YN0002 110
      * Define null work field Weight Limit for Box/Othr
     C                     Z-ADD*ZERO     YN0003 110
      * Define null work field Slot Limit for Export
     C                     Z-ADD*ZERO     YN0004  30
      * Define null work field Slot Limit for Combo
     C                     Z-ADD*ZERO     YN0005  30
      * Define null work field Slot Limit for Box/Other
     C                     Z-ADD*ZERO     YN0006  30
      * Define local work field Record Found -OrdDtlUSR
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0008  30
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field Partial Load Max Lbs USR
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0011 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field Export Status Dft
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Slot Type f/load USR
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field Weight Scheduled USR
     C                     Z-ADD*ZERO     YL0017 112
      * Define local work field USR Unit of Measure
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0022  2
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field USR Warehouse Code
     C                     MOVEL*BLANK    YL0025  3
      * Define local work field USR Unit of Measure
     C                     MOVEL*BLANK    YL0026  2
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0028  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0029  50
      * Define local work field USR Weight   9.1  3
     C                     Z-ADD*ZERO     YL0030  91
      * Define local work field Name
     C                     MOVEL*BLANK    YL0031 30
      * Define local work field Port City
     C                     MOVEL*BLANK    YL0032 25
      * Define local work field Port Address Line 1
     C                     MOVEL*BLANK    YL0033 25
      * Define local work field Port Address Line 2
     C                     MOVEL*BLANK    YL0034 25
      * Define local work field Sail Port State
     C                     MOVEL*BLANK    YL0035  2
      * Define local work field Port Zip/Postal Code
     C                     MOVEL*BLANK    YL0036 11
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0037 110
      * Define local work field Port Fax Number
     C                     MOVEL*BLANK    YL0038 25
      * Define local work field TPM Location Code
     C                     MOVEL*BLANK    YL0039 10
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field Display Partial Flag
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field Boxes Qty for a Load USR
     C                     Z-ADD*ZERO     YL0042 112
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0043  3
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0044  2
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0045  3
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0046  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0047  50
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0048  2
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0049  30
      * Define null work field Allow Multi-Company
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0008 10
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0009  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0050  30
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0051  50
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0010  2
      * Define local work field USR Weight
     C                     Z-ADD*ZERO     YL0052 112
      * Define local work field Slot Type f/New Ords USR
     C                     MOVEL*BLANK    YL0053  2
      * Define local work field Partial Load Max Lbs USR
     C                     Z-ADD*ZERO     YL0054  70
      * Define local work field Scheduled Ship Date USR
     C                     Z-ADD*ZERO     YL0055  70
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0056  50
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * RTV Shipping Co        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1CBAA    WL0022    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0001           Shipping Compan
      * Rtv Company Ctl Vals  XF - Company Values  * 
     C                     CALL 'PNOQXFR'              90  Rtv Company Ctl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0033  30       Company Number
     C           YL0056    PARM *ZERO     WQ0034  50       Box Load Min Bo
     C           YL0054    PARM *ZERO     WQ0035  70       Partial Load Ma
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
