     H/TITLE EXC Fax Acknwgmnt     XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSGOYA
     H* Date          : 04/17/25  Time  : 01:04:42
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPAQREL2IF  E           K        DISK
      * RSQ : Company Document Defaults Co#/Dept/Type
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FPDM3REL1IF  E           K        DISK
      * RTV : Customer Fax              Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDLWREL1IF  E           K        DISK
      * RTV : Territory State           Retrieval index
      *
     FPDLVREL1IF  E           K        DISK
      * RTV : Territory Master          Retrieval index
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker News               Retrieval index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@AQREJ5
      * Company Document Defaults Co#/Dept/Type
      * Renamed input format fields
     I              AQAIC3                          WAAIC3
     I              AQESTX                          WAESTX
     I              AQFPAA                          WAFPAA
     I              AQRPNA                          WARPNA
     I              AQDTVN                          WADTVN
     I              AQDUVN                          WADUVN
     I              AQDVVN                          WADVVN
     I              AQEWT1                          WAEWT1
     I              AQEXT1                          WAEXT1
     I              AQDXVN                          WADXVN
     I              AQKMT1                          WAKMT1
     I              AQKNT1                          WAKNT1
     I              AQGXNY                          WAGXNY
     I              AQDWVN                          WADWVN
     I              AQGZNY                          WAGZNY
     I              AQG0NY                          WAG0NY
     I              AQG1NY                          WAG1NY
     I              AQG2NY                          WAG2NY
     I              AQGYNY                          WAGYNY
     I              AQKOT1                          WAKOT1
     I              AQDYVN                          WADYVN
     I              AQDZVN                          WADZVN
     I              AQD0VN                          WAD0VN
     I              AQG3NY                          WAG3NY
     I              AQG4NY                          WAG4NY
     I              AQG5NY                          WAG5NY
     I              AQG6NY                          WAG6NY
     I              AQG7NY                          WAG7NY
     I              AQEYT1                          WAEYT1
     I              AQEZT1                          WAEZT1
     I              AQKBT1                          WAKBT1
     I              AQKCT1                          WAKCT1
     I              AQKDT1                          WAKDT1
     I              AQETTX                          WAETTX
     I              AQEXTX                          WAEXTX
     I              AQE0TX                          WAE0TX
     I              AQE3TX                          WAE3TX
     I              AQE0T1                          WAE0T1
     I              AQE1T1                          WAE1T1
     I              AQKET1                          WAKET1
     I              AQKFT1                          WAKFT1
     I              AQKGT1                          WAKGT1
     I              AQQ4DT                          WAQ4DT
     I              AQQ5DT                          WAQ5DT
     I              AQQ7DT                          WAQ7DT
     I              AQCYTM                          WACYTM
     I              AQCWTM                          WACWTM
     I              AQCXTM                          WACXTM
     I              AQVSST                          WAVSST
     I              AQMJDT                          WAMJDT
     I              AQBETM                          WABETM
     I              AQCCVN                          WACCVN
     I              AQCDVN                          WACDVN
     I              AQMKDT                          WAMKDT
     I              AQBFTM                          WABFTM
     I              AQCEVN                          WACEVN
     I              AQCFVN                          WACFVN
      *
     I@BBREE9
      * Customer Master           Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WBBKC7
     I              BBAYTX                          WBAYTX
     I              BBACNA                          WBACNA
     I              BBADNA                          WBADNA
     I              BBAENA                          WBAENA
     I              BBAJNA                          WBAJNA
     I              BBBGCD                          WBBGCD
     I              BBG5CD                          WBG5CD
     I              BBBTTX                          WBBTTX
     I              BBBVTX                          WBBVTX
     I              BBBWTX                          WBBWTX
     I              BBABTX                          WBABTX
     I              BBA2NA                          WBA2NA
     I              BBCBST                          WBCBST
     I              BBB0NA                          WBB0NA
     I              BBP3NB                          WBP3NB
     I              BBAXNA                          WBAXNA
     I              BBI6DT                          WBI6DT
     I              BBAYDT                          WBAYDT
     I              BBANC7                          WBANC7
     I              BBBTC7                          WBBTC7
     I              BBK6ST                          WBK6ST
     I              BBUZST                          WBUZST
     I              BBKXCD                          WBKXCD
     I              BBLTCD                          WBLTCD
     I              BBQNST                          WBQNST
     I              BBS2NB                          WBS2NB
     I              BBVHVA                          WBVHVA
     I              BBI7DT                          WBI7DT
     I              BBRJST                          WBRJST
     I              BBRKST                          WBRKST
     I              BBQWST                          WBQWST
     I              BBQXST                          WBQXST
     I              BBQYST                          WBQYST
     I              BBUNCS                          WBUNCS
     I              BBUVST                          WBUVST
     I              BBUWST                          WBUWST
     I              BBUXST                          WBUXST
     I              BBVSST                          WBVSST
     I              BBAATM                          WBAATM
     I              BBAYNA                          WBAYNA
     I              BBA0NA                          WBA0NA
     I              BBAXDT                          WBAXDT
      *
     I@M3REZE
      * Customer Fax              Retrieval index
      * Renamed input format fields
     I              M3BKC7                          WCBKC7
     I              M3A0AA                          WCA0AA
     I              M3HXNX                          WCHXNX
     I              M3TFTX                          WCTFTX
     I              M3W5T1                          WCW5T1
     I              M3HYNX                          WCHYNX
     I              M3TGTX                          WCTGTX
     I              M3HZNX                          WCHZNX
     I              M3THTX                          WCTHTX
     I              M3D7T1                          WCD7T1
     I              M3D8T1                          WCD8T1
     I              M3D9T1                          WCD9T1
     I              M3EAT1                          WCEAT1
     I              M3FISX                          WCFISX
     I              M3FJSX                          WCFJSX
     I              M3FKSX                          WCFKSX
     I              M3FLSX                          WCFLSX
     I              M3FMSX                          WCFMSX
     I              M3VSST                          WCVSST
     I              M3MJDT                          WCMJDT
     I              M3BETM                          WCBETM
     I              M3CCVN                          WCCCVN
     I              M3CDVN                          WCCDVN
     I              M3MKDT                          WCMKDT
     I              M3BFTM                          WCBFTM
     I              M3CEVN                          WCCEVN
     I              M3CFVN                          WCCFVN
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@LWRERA
      * Territory State           Retrieval index
      * Renamed input format fields
     I              LWBGCD                          WEBGCD
     I              LWX3CD                          WEX3CD
     I              LWUVST                          WEUVST
     I              LWUWST                          WEUWST
     I              LWUXST                          WEUXST
     I              LWVSST                          WEVSST
     I              LWAATM                          WEAATM
     I              LWAYNA                          WEAYNA
     I              LWA0NA                          WEA0NA
     I              LWAXDT                          WEAXDT
      *
     I@LVREQ7
      * Territory Master          Retrieval index
      * Renamed input format fields
     I              LVX3CD                          WFX3CD
     I              LVOKNA                          WFOKNA
     I              LVS1SX                          WFS1SX
     I              LVS2SX                          WFS2SX
     I              LVS3SX                          WFS3SX
     I              LVS4SX                          WFS4SX
     I              LVFQAA                          WFFQAA
     I              LVUVST                          WFUVST
     I              LVUWST                          WFUWST
     I              LVUXST                          WFUXST
     I              LVVSST                          WFVSST
     I              LVAATM                          WFAATM
     I              LVAYNA                          WFAYNA
     I              LVA0NA                          WFA0NA
     I              LVAXDT                          WFAXDT
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WGBCCD
     I              APALTX                          WGALTX
     I              APACNA                          WGACNA
     I              APADNA                          WGADNA
     I              APAENA                          WGAENA
     I              APAJNA                          WGAJNA
     I              APBGCD                          WGBGCD
     I              APBTTX                          WGBTTX
     I              APBVTX                          WGBVTX
     I              APBWTX                          WGBWTX
     I              APDZTX                          WGDZTX
     I              APD0TX                          WGD0TX
     I              APD1TX                          WGD1TX
     I              APLVCD                          WGLVCD
     I              APKZCD                          WGKZCD
     I              APAIC3                          WGAIC3
     I              APAVNB                          WGAVNB
     I              APDSCD                          WGDSCD
     I              APUVST                          WGUVST
     I              APUWST                          WGUWST
     I              APUXST                          WGUXST
     I              APVSST                          WGVSST
     I              APAATM                          WGAATM
     I              APAYNA                          WGAYNA
     I              APA0NA                          WGA0NA
     I              APAXDT                          WGAXDT
      *
     I@HORELA
      * Customer Accrual          Retrieval index
      * Renamed input format fields
     I              HOBKC7                          WHBKC7
     I              HOOJCD                          WHOJCD
     I              HOGUNY                          WHGUNY
     I              HOBFDT                          WHBFDT
     I              HOA2DT                          WHA2DT
     I              HOBKPR                          WHBKPR
     I              HOTTST                          WHTTST
     I              HOSHSX                          WHSHSX
     I              HOQDSX                          WHQDSX
     I              HOPJDT                          WHPJDT
     I              HOPKDT                          WHPKDT
     I              HOECVL                          WHECVL
     I              HOQESX                          WHQESX
     I              HOQFSX                          WHQFSX
     I              HOHHAA                          WHHHAA
     I              HOHQVL                          WHHQVL
     I              HOQGSX                          WHQGSX
     I              HOQHSX                          WHQHSX
     I              HOQISX                          WHQISX
     I              HOQJSX                          WHQJSX
     I              HOUVST                          WHUVST
     I              HOUWST                          WHUWST
     I              HOUXST                          WHUXST
     I              HOAATM                          WHAATM
     I              HOAYNA                          WHAYNA
     I              HOA0NA                          WHA0NA
     I              HOAXDT                          WHAXDT
      *
     I@C5RESJ
      * Broker News               Retrieval index
      * Renamed input format fields
     I              C5HHAA                          WIHHAA
     I              C5C4T1                          WIC4T1
     I              C5QMNA                          WIQMNA
     I              C5QNNA                          WIQNNA
     I              C5QONA                          WIQONA
     I              C5QPNA                          WIQPNA
     I              C5C5T1                          WIC5T1
     I              C5C6T1                          WIC6T1
     I              C5C7T1                          WIC7T1
     I              C5C8T1                          WIC8T1
     I              C5C9T1                          WIC9T1
     I              C5DAT1                          WIDAT1
     I              C5DBT1                          WIDBT1
     I              C5DCT1                          WIDCT1
     I              C5DDT1                          WIDDT1
     I              C5PWSX                          WIPWSX
     I              C5PXSX                          WIPXSX
     I              C5PYSX                          WIPYSX
     I              C5PZSX                          WIPZSX
     I              C5BCCD                          WIBCCD
     I              C5UVST                          WIUVST
     I              C5UWST                          WIUWST
     I              C5UXST                          WIUXST
     I              C5VSST                          WIVSST
     I              C5AATM                          WIAATM
     I              C5AYNA                          WIAYNA
     I              C5A0NA                          WIA0NA
     I              C5AXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Ship To Customer
     I                                    P   7  100P1BKC7
      * I :  HPB Ship to Warehouse
     I                                       11  13 P1FXSX
     IP2PARM      DS
      * FLD: Broker News
      * N :  Broker Name
     I                                        1  30 P2C4T1
      * N :  Broker Fax Number
     I                                       31  55 P2C8T1
     IP3PARM      DS
      * FLD: Customer Master
      * N :  Customer Name
     I                                        1  30 P3AYTX
     IP4PARM      DS
      * FLD: Customer Fax
      * N :  Buyer Fax Number
     I                                        1  25 P4HXNX
      * N :  Buyer Fax Name
     I                                       26  50 P4TFTX
     IP5PARM      DS
      * FLD: Salesperson
      * I :  Salesperson Code
     I                                        1   3 P5BCCD
      * N :  Salesperson Name
     I                                        4  33 P5ALTX
      * N :  Fax Number FF
     I                                       34  58 P5BWTX
     IP6PARM      DS
      * FLD: *Arrays
      * I :  USR Update Flag
     I                                        1   1 P6R4ST
      * I :  USR Check Y/N Status
     I                                        2   2 P6JDST
      * I :  Status - Y or N
     I                                        3   3 P6B8ST
     IP7PARM      DS
      * FLD: Company Document Defaults
      * N :  CDD Type
     I                                        1   2 P7ESTX
      * N :  CDD Department Code
     I                                        3   8 P7FPAA
      * N :  CDD Name of Overlay
     I                                        9  16 P7RPNA
      * N :  CDD Program Name
     I                                       17  26 P7DTVN
      * N :  CDD Printer File Name
     I                                       27  36 P7DUVN
      * N :  CDD Additional Object
     I                                       37  46 P7DVVN
      * N :  CDD Sender Phone
     I                                       47  71 P7EWT1
      * N :  CDD Sender Fax
     I                                       72  96 P7EXT1
      * N :  Output Queue
     I                                       97 106 P7DXVN
      * N :  Hold File
     I                                      107 110 P7KMT1
      * N :  Save File
     I                                      111 114 P7KNT1
      * N :  Source Drawer
     I                                    P 115 1160P7GXNY
      * N :  Printer Device Type
     I                                      117 126 P7DWVN
      * N :  Page Length 2
     I                                    P 127 1280P7GZNY
      * N :  Page Width 2
     I                                    P 129 1300P7G0NY
      * N :  Page LPI
     I                                    P 131 1320P7G1NY
      * N :  Page CPI
     I                                    P 133 1341P7G2NY
      * N :  Page Overflow
     I                                    P 135 1360P7GYNY
      * N :  Page Rotation
     I                                      137 141 P7KOT1
      * N :  CDD Comment 1
     I                                      142 191 P7EYT1
      * N :  CDD Comment 2
     I                                      192 241 P7EZT1
      * N :  CDD Comment 3
     I                                      242 291 P7KBT1
      * N :  CDD Comment 4
     I                                      292 341 P7KCT1
      * N :  CDD Comment 5
     I                                      342 391 P7KDT1
      * N :  Record Status
     I                                      392 392 P7VSST
     IP8PARM      DS
      * FLD: *Arrays
      * N :  Spool File Selection
     I                                        1  10 P8LHTX
      * N :  Display Fax Select Screen
     I                                       11  11 P8PHST
      * N :  Page Length
     I                                    P  12  130P8PGLN
      * N :  Page Width
     I                                    P  14  150P8PGWD
      * N :  CPI
     I                                    P  16  170P8CPII
      * N :  LPI
     I                                    P  18  190P8LPII
      * N :  Printer Name or Outq
     I                                       20  29 P8LJTX
      * N :  Outq Library
     I                                       30  39 P8LKTX
      * N :  Fax Recipient
     I                                       40  64 P8LLTX
      * N :  Company Recipient Name
     I                                       65  94 P8LMTX
      * N :  Fax Phone Number
     I                                       95 119 P8LNTX
      * N :  Country Description
     I                                      120 149 P8DATX
      * N :  Index
     I                                    P 150 1510P8INDE
     IP9PARM      DS
      * FLD: *Arrays
      * I :  Status Flag 7  Y/N
     I                                        1   1 P9AKTX
      * I :  Email to Broker Usr
     I                                        2   2 P9QESC
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P1FXSX    PARM           WP0004  3        HPB Ship to War
     C           P5BCCD    PARM           WP0005  3        Salesperson Cod
     C           P6R4ST    PARM           WP0006  1        USR Update Flag
     C           P6JDST    PARM           WP0007  1        USR Check Y/N S
     C           P6B8ST    PARM           WP0008  1        Status - Y or N
     C           P9AKTX    PARM           WP0009  1        Status Flag 7
     C           P9QESC    PARM           WP0010  1        Email to Broker
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EXC Fax Acknwgmnt     XF
      * ** Retrieve overlay info for coversheet
     C                     MOVEL'FX'      P7ESTX           CDD Type
     C                     MOVEL*BLANK    P7FPAA           CDD Department
     C                     MOVEL'ACKNW'   P7FPAA           CDD Department
      * RTV CDD for Overlays   RT - Company Document Defaults  * 
     C                     EXSR SARVGN
      * RTV Name Only          RT - Customer  * 
     C                     EXSR SBRVGN
     C                     MOVEL*BLANK    P4HXNX           Buyer Fax Numbe
     C                     MOVEL*BLANK    P4TFTX           Buyer Fax Name
     C                     MOVEL*BLANK    P5ALTX           Salesperson Nam
     C                     MOVEL*BLANK    P8LNTX           Fax Phone Numbe
      * Buyer
      * CASE: PAR.USR Update Flag is Yes
     C           P6R4ST    IFEQ 'Y'                        *IF
      * Rtv Cust Fax Buyer NbrsRT - Customer Fax  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      * Rgn Sls Manager
      * CASE: PAR.USR Check Y/N Status is yes
     C           P6JDST    IFEQ 'Y'                        *IF
      * RTV Order/ShipState    RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * RTV Reg Sls Mgr FaxOnlyRT - Territory State  * 
     C                     EXSR SERVGN
     C                     END                             *FI
      * ** Retrieve customer fax if requested
      * CASE: PAR.Status Flag 7  Y/N is Yes
     C           P9AKTX    IFEQ 'Y'                        *IF
      * RTV Fax number ff      RT - Customer  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * ** Fax the acknowledgement if at least one fax number is entered.
      * CASE:
      *  - c1ORc3ORc4ORc5
      *   |- c1    : PAR.Buyer Fax Number is Not equal to blanks
      *   |- c3    : PAR.Broker Fax Number is Not equal to blanks
      *   |- c4    : WRK.Fax Number FF is Not equal to blanks
      *   |- c5    : PAR.Fax Phone Number is NE Blanks
      *   '-
     C           P4HXNX    IFNE *BLANK                     *IF
     C           P2C8T1    ORNE *BLANK                     *OR
     C           WUBWTX    ORNE *BLANK                     *OR
     C           P8LNTX    ORNE *BLANK                     *OR
      * PRT Acknowledgements UP - Order Header TRG  * 
     C                     CALL 'PDJWPCLP'             90  PRT Acknowledge
     C                     PARM P1AIC3    WQ0001 155       Company Number
     C                     PARM P1C4NB    WQ0002 155       Order Number 1
     C                     PARM P1C4NB    WQ0003 155       Order Number 2
     C                     PARM *ZERO     WQ0004 155       Date 1
     C                     PARM *ZERO     WQ0005 155       Date 2
     C                     PARM *ZERO     WQ0006 155       Thru Date Pass
     C                     PARM *BLANK    WQ0007  2        Order Type_Sale
     C                     PARM WUOTTX    WQ0008  2        Shipping Method
     C                     PARM '1'       WQ0009  1        Billing Activit
     C                     PARM 'A'       WQ0010  1        Export Sales
     C                     PARM *BLANK    WQ0011  3        USR Warehouse C
     C                     PARM *BLANK    WQ0012  3        USR CDE Parm 1
     C                     PARM *BLANK    WQ0013  3        USR CDE Parm 2
     C                     PARM *BLANK    WQ0014  3        USR CDE Parm 3
     C                     PARM *BLANK    WQ0015  3        USR CDE Parm 4
     C                     PARM *BLANK    WQ0016  3        USR CDE Parm 5
     C                     PARM *BLANK    WQ0017  3        USR CDE Parm 6
     C                     PARM *BLANK    WQ0018  3        USR CDE Parm 7
     C                     PARM *BLANK    WQ0019  3        USR CDE Parm 8
     C                     PARM *BLANK    WQ0020  3        USR CDE Parm 9
     C                     PARM 'S'       WQ0021  1        USR Select/Omit
     C                     PARM 'FAXQ'    WQ0022 10        PRT Printer Dev
     C                     PARM '*NO'     WQ0023  4        PRT Hold Output
     C                     PARM '*NO'     WQ0024  4        PRT Save Output
     C                     PARM 1         WQ0025 155       System Value Nu
     C                     PARM '*JOBD'   WQ0026 10        PRT Night Queue
     C                     PARM *ZERO     WQ0027 155       Date 3
     C                     PARM *BLANK    WQ0028  1        Email To Whs
     C                     PARM *BLANK    WQ0029  3        Email to Wareho
     C                     PARM 'N'       WQ0030  1        Email to Salesp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJWPCLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * par.fax number ff not used anymore 5/3/13 removed from cond stmt
      * PRC Call Telex 3       UP - /UT User Programs  * 
     C                     CALL 'PPFEUPC'              90  PRC Call Telex
     C                     PARM @CN,001   WQ0031 10        Spool File Sele
     C                     PARM P8LLTX    WQ0032 25        Fax Recipient
     C                     PARM WUAYTX    WQ0033 30        Company Recipie
     C                     PARM *BLANK    WQ0034  3        Fax Area Code
     C                     PARM P8LNTX    WQ0035 25        Fax Phone Numbe
     C                     PARM @CN,002   WQ0036 30        Country Descrip
     C                     PARM P1AIC3    WQ0037  30       Company Number
     C                     PARM P7ESTX    WQ0038  2        CDD Type
     C                     PARM P7FPAA    WQ0039  6        CDD Department
     C                     PARM P7RPNA    WQ0040  8        CDD Name of Ove
     C                     PARM P7DTVN    WQ0041 10        CDD Program Nam
     C                     PARM P7DUVN    WQ0042 10        CDD Printer Fil
     C                     PARM P7DXVN    WQ0043 10        Output Queue
     C                     PARM P7KMT1    WQ0044  4        Hold File
     C                     PARM P7KNT1    WQ0045  4        Save File
     C                     PARM P7GXNY    WQ0046  30       Source Drawer
     C                     PARM P7DWVN    WQ0047 10        Printer Device
     C                     PARM P7GZNY    WQ0048  30       Page Length 2
     C                     PARM P7G0NY    WQ0049  30       Page Width 2
     C                     PARM P7G1NY    WQ0050  30       Page LPI
     C                     PARM P7G2NY    WQ0051  31       Page CPI
     C                     PARM P7GYNY    WQ0052  30       Page Overflow
     C                     PARM P7KOT1    WQ0053  5        Page Rotation
     C                     PARM P4HXNX    WQ0054 25        Buyer Fax Numbe
     C                     PARM P4TFTX    WQ0055 25        Buyer Fax Name
     C                     PARM WUBWTX    WQ0056 25        Fax Number 2
     C                     PARM WULLTX    WQ0057 25        Fax Contact Nam
     C                     PARM P2C4T1    WQ0058 30        Broker Name
     C                     PARM P2C8T1    WQ0059 25        Broker Fax Numb
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPFEUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * 08/06/24 SP S312312 (Add C3 "Email to Broker Usr")
      * ** Email acknowledgement if buyer or regional selected
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : PAR.USR Update Flag is Yes
      *   |- c2    : PAR.USR Check Y/N Status is yes
      *   |- c3    : PAR.Email to Broker Usr is Yes
      *   '-
     C           P6R4ST    IFEQ 'Y'                        *IF
     C           P6JDST    OREQ 'Y'                        *OR
     C           P9QESC    OREQ 'Y'                        *OR
     C                     Z-ADDP1AIC3    YL0004           Company Number
     C                     Z-ADDP1C4NB    YL0005           Order Number 1
     C                     Z-ADDP1C4NB    YL0006           Order Number 2
     C                     Z-ADDP1BKC7    YL0007           Customer Number
      * 08/21/2017 DN T11489-Use Salesperson Code to set Sales Route Code
      * 08/06/24 SP S312312-Start
      * Get "Email to Broker"
      * CASE: PAR.Email to Broker Usr is Yes
     C           P9QESC    IFEQ 'Y'                        *IF
      * Rtv Ship to Broker Eml RT - Customer Accrual  * 
     C                     EXSR SIRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0008           Broker Email Ad
     C                     END                             *FI
      * Eml Acknowledgements UP - Order Header TRG  * 
     C                     CALL 'PBIQUPC'              90  Eml Acknowledge
     C                     PARM YL0004    WQ0060 155       Company Number
     C                     PARM YL0005    WQ0061 155       Order Number 1
     C                     PARM YL0006    WQ0062 155       Order Number 2
     C                     PARM YL0007    WQ0063 155       Customer Number
     C                     PARM P5BCCD    WQ0064  3        Sales Route Cod
     C                     PARM P6R4ST    WQ0065  1        Status Flag 2
     C                     PARM P6JDST    WQ0066  1        Status Flag 3
     C                     PARM YL0008    WQ0067 50        Broker Email Ad
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBIQUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * 08/06/24 SP S312312-End
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV CDD for Overlays   RT - Company Document Defaults  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAFPAA    WQSA02           CDD Department
     C           *LIKE     DEFN WAESTX    WQSA03           CDD Type
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           CDD Department
     C                     KFLD           WQSA03           CDD Type
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     MOVELP7FPAA    WQSA02           CDD Department
     C                     MOVELP7ESTX    WQSA03           CDD Type
      * Establish starting position
     C           KRSSA     SETLL@AQREJ5                    *
     C           KRSSA     READE@AQREJ5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3410' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P7RPNA           CDD Name of Ove
     C                     MOVEL*BLANK    P7DTVN           CDD Program Nam
     C                     MOVEL*BLANK    P7DUVN           CDD Printer Fil
     C                     MOVEL*BLANK    P7DVVN           CDD Additional
     C                     MOVEL*BLANK    P7EWT1           CDD Sender Phon
     C                     MOVEL*BLANK    P7EXT1           CDD Sender Fax
     C                     MOVEL*BLANK    P7DXVN           Output Queue
     C                     MOVEL*BLANK    P7KMT1           Hold File
     C                     MOVEL*BLANK    P7KNT1           Save File
     C                     Z-ADD*ZERO     P7GXNY           Source Drawer
     C                     MOVEL*BLANK    P7DWVN           Printer Device
     C                     Z-ADD*ZERO     P7GZNY           Page Length 2
     C                     Z-ADD*ZERO     P7G0NY           Page Width 2
     C                     Z-ADD*ZERO     P7G1NY           Page LPI
     C                     Z-ADD*ZERO     P7G2NY           Page CPI
     C                     Z-ADD*ZERO     P7GYNY           Page Overflow
     C                     MOVEL*BLANK    P7KOT1           Page Rotation
     C                     MOVEL*BLANK    P7EYT1           CDD Comment 1
     C                     MOVEL*BLANK    P7EZT1           CDD Comment 2
     C                     MOVEL*BLANK    P7KBT1           CDD Comment 3
     C                     MOVEL*BLANK    P7KCT1           CDD Comment 4
     C                     MOVEL*BLANK    P7KDT1           CDD Comment 5
     C                     MOVEL*BLANK    P7VSST           Record Status
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWARPNA    P7RPNA           CDD Name of Ove
     C                     MOVELWADTVN    P7DTVN           CDD Program Nam
     C                     MOVELWADUVN    P7DUVN           CDD Printer Fil
     C                     MOVELWADVVN    P7DVVN           CDD Additional
     C                     MOVELWAEWT1    P7EWT1           CDD Sender Phon
     C                     MOVELWAEXT1    P7EXT1           CDD Sender Fax
     C                     MOVELWADXVN    P7DXVN           Output Queue
     C                     MOVELWAKMT1    P7KMT1           Hold File
     C                     MOVELWAKNT1    P7KNT1           Save File
     C                     Z-ADDWAGXNY    P7GXNY           Source Drawer
     C                     MOVELWADWVN    P7DWVN           Printer Device
     C                     Z-ADDWAGZNY    P7GZNY           Page Length 2
     C                     Z-ADDWAG0NY    P7G0NY           Page Width 2
     C                     Z-ADDWAG1NY    P7G1NY           Page LPI
     C                     Z-ADDWAG2NY    P7G2NY           Page CPI
     C                     Z-ADDWAGYNY    P7GYNY           Page Overflow
     C                     MOVELWAKOT1    P7KOT1           Page Rotation
     C                     MOVELWAEYT1    P7EYT1           CDD Comment 1
     C                     MOVELWAEZT1    P7EZT1           CDD Comment 2
     C                     MOVELWAKBT1    P7KBT1           CDD Comment 3
     C                     MOVELWAKCT1    P7KCT1           CDD Comment 4
     C                     MOVELWAKDT1    P7KDT1           CDD Comment 5
     C                     MOVELWAVSST    P7VSST           Record Status
     C           KRSSA     READE@AQREJ5                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Name Only          RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSB     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P8LMTX           Customer Name
     C                     GOTO SBEXIT                     *QUIT
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAYTX    P8LMTX           Customer Name
     C                     GOTO SBEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Cust Fax Buyer NbrsRT - Customer Fax  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBKC7           Ship To Custome
     C                     KFLD           WCA0AA           Fax Application
      * Setup key
     C                     Z-ADDP1BKC7    WCBKC7           Ship To Custome
     C                     MOVEL*BLANK    WCA0AA           Fax Application
      * Establish starting position
     C           KRSSC     CHAIN@M3REZE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2843' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P4HXNX           Buyer Fax Numbe
     C                     MOVEL*BLANK    P4TFTX           Buyer Fax Name
     C                     MOVEL*BLANK    YL0001           Buyer Email Add
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCHXNX    P4HXNX           Buyer Fax Numbe
     C                     MOVELWCTFTX    P4TFTX           Buyer Fax Name
     C                     MOVELWCW5T1    YL0001           Buyer Email Add
     C                     GOTO SCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Order/ShipState    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADDP1C4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Ship To State C
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDDBCD    YL0002           Ship To State C
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Reg Sls Mgr FaxOnlyRT - Territory State  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBGCD    WQSE01           State Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           State Code
      * Setup key
     C                     MOVELYL0002    WQSE01           State Code
      * Establish starting position
     C           KRSSE     SETLL@LWRERA                    *
     C           KRSSE     READE@LWRERA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2583' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'USR0650' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    P8LLTX           Salesperson Nam
     C                     MOVEL*BLANK    P8LNTX           Fax Number FF
      * RTV Reg Sls Mgr FaxOnlyRT - Territory  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * RTV Reg Sls Mgr FaxOnlyRT - Salesperson  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@LWRERA                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Reg Sls Mgr FaxOnlyRT - Territory  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFX3CD           Territory Code
      * Setup key
     C                     MOVELWEX3CD    WFX3CD           Territory Code
      * Establish starting position
     C           KRSSF     CHAIN@LVREQ7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2581' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFFQAA    YL0003           Regional Salesp
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Reg Sls Mgr FaxOnlyRT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGBCCD           Salesperson Cod
      * Setup key
     C                     MOVELYL0003    WGBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSG     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGALTX    P8LLTX           Salesperson Nam
     C                     MOVELWGBWTX    P8LNTX           Fax Number FF
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Fax number ff      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAYTX           Customer Name
     C                     MOVEL*BLANK    WUBWTX           Fax Number FF
     C                     GOTO SHEXIT                     *QUIT
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAYTX    WUAYTX           Customer Name
     C                     MOVELWBBWTX    WUBWTX           Fax Number FF
     C                     GOTO SHEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Ship to Broker Eml RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YN0001           Broker Code
     C                     MOVEL*BLANK    YL0008           Broker Email Ad
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHBKC7    WQSI01           Ship To Custome
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WQSI01           Ship To Custome
      * Establish starting position
     C           KRSSI     SETLL@HORELA                    *
     C           KRSSI     READE@HORELA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1520' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Period Beginning Date LE PAR.Date From
      *   |- c2    : DB1.Period Ending Date GE PAR.Date From
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WHBFDT    IFLE ##JDT                      *IF
     C           WHA2DT    IFGE ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Broker Code is Entered
     C           WHHHAA    IFNE *BLANK                     *IF
      * Rtv All details        RT - Broker News  * 
     C                     EXSR SJRVGN
      * CASE: LCL.Record Status is Active
     C           YL0010    IFEQ 'A'                        *IF
     C                     MOVELWHHHAA    YN0001           Broker Code
     C                     MOVELYL0009    YL0008           Broker Email Ad
     C                     GOTO SIEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSI     READE@HORELA                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv All details        RT - Broker News  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0009           Broker Email Ad
     C                     MOVEL*BLANK    YL0010           Record Status
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIHHAA           Broker Code
      * Setup key
     C                     MOVELWHHHAA    WIHHAA           Broker Code
      * Establish starting position
     C           KRSSJ     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIC9T1    YL0009           Broker Email Ad
     C                     MOVELWIVSST    YL0010           Record Status
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2C4T1           Broker Name
     C                     MOVEL*BLANK    P2C8T1           Broker Fax Numb
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3AYTX           Customer Name
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4HXNX           Buyer Fax Numbe
     C                     MOVEL*BLANK    P4TFTX           Buyer Fax Name
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5ALTX           Salesperson Nam
     C                     MOVEL*BLANK    P5BWTX           Fax Number FF
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7ESTX           CDD Type
     C                     MOVEL*BLANK    P7FPAA           CDD Department
     C                     MOVEL*BLANK    P7RPNA           CDD Name of Ove
     C                     MOVEL*BLANK    P7DTVN           CDD Program Nam
     C                     MOVEL*BLANK    P7DUVN           CDD Printer Fil
     C                     MOVEL*BLANK    P7DVVN           CDD Additional
     C                     MOVEL*BLANK    P7EWT1           CDD Sender Phon
     C                     MOVEL*BLANK    P7EXT1           CDD Sender Fax
     C                     MOVEL*BLANK    P7DXVN           Output Queue
     C                     MOVEL*BLANK    P7KMT1           Hold File
     C                     MOVEL*BLANK    P7KNT1           Save File
     C                     Z-ADD*ZERO     P7GXNY           Source Drawer
     C                     MOVEL*BLANK    P7DWVN           Printer Device
     C                     Z-ADD*ZERO     P7GZNY           Page Length 2
     C                     Z-ADD*ZERO     P7G0NY           Page Width 2
     C                     Z-ADD*ZERO     P7G1NY           Page LPI
     C                     Z-ADD*ZERO     P7G2NY           Page CPI
     C                     Z-ADD*ZERO     P7GYNY           Page Overflow
     C                     MOVEL*BLANK    P7KOT1           Page Rotation
     C                     MOVEL*BLANK    P7EYT1           CDD Comment 1
     C                     MOVEL*BLANK    P7EZT1           CDD Comment 2
     C                     MOVEL*BLANK    P7KBT1           CDD Comment 3
     C                     MOVEL*BLANK    P7KCT1           CDD Comment 4
     C                     MOVEL*BLANK    P7KDT1           CDD Comment 5
     C                     MOVEL*BLANK    P7VSST           Record Status
      * Clear all neither parameters
     C                     MOVEL*BLANK    P8LHTX           Spool File Sele
     C                     MOVEL*BLANK    P8PHST           Display Fax Sel
     C                     Z-ADD*ZERO     P8PGLN           Page Length
     C                     Z-ADD*ZERO     P8PGWD           Page Width
     C                     Z-ADD*ZERO     P8CPII           CPI
     C                     Z-ADD*ZERO     P8LPII           LPI
     C                     MOVEL*BLANK    P8LJTX           Printer Name or
     C                     MOVEL*BLANK    P8LKTX           Outq Library
     C                     MOVEL*BLANK    P8LLTX           Fax Recipient
     C                     MOVEL*BLANK    P8LMTX           Company Recipie
     C                     MOVEL*BLANK    P8LNTX           Fax Phone Numbe
     C                     MOVEL*BLANK    P8DATX           Country Descrip
     C                     Z-ADD*ZERO     P8INDE           Index
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAGXNY           Source Drawer
     C                     Z-ADD*ZERO     WAGZNY           Page Length 2
     C                     Z-ADD*ZERO     WAG0NY           Page Width 2
     C                     Z-ADD*ZERO     WAG1NY           Page LPI
     C                     Z-ADD*ZERO     WAG2NY           Page CPI
     C                     Z-ADD*ZERO     WAGYNY           Page Overflow
     C                     Z-ADD*ZERO     WAG3NY           CDD Copies
     C                     Z-ADD*ZERO     WAG4NY           CDD Number 2 Un
     C                     Z-ADD*ZERO     WAG5NY           CDD Number 3 Un
     C                     Z-ADD*ZERO     WAG6NY           CDD Number 4 Un
     C                     Z-ADD*ZERO     WAG7NY           CDD Number 5 Un
     C                     Z-ADD*ZERO     WAQ4DT           CDD Unused Date
     C                     Z-ADD*ZERO     WAQ5DT           CDD Unused Date
     C                     Z-ADD*ZERO     WAQ7DT           CDD Unused Date
     C                     Z-ADD*ZERO     WACYTM           CDD Unused Time
     C                     Z-ADD*ZERO     WACWTM           CDD Unused Time
     C                     Z-ADD*ZERO     WACXTM           CDD Unused Time
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBP3NB           D_B Number
     C                     Z-ADD*ZERO     WBI6DT           Date of D_B Rat
     C                     Z-ADD*ZERO     WBAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WBANC7           AR Customer Num
     C                     Z-ADD*ZERO     WBBTC7           Parent Customer
     C                     Z-ADD*ZERO     WBS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WBVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WBI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           AR Customer Num
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A_R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Customer Name
     C                     MOVEL*BLANK    WUAYTX 30
      * Define work field Fax Number FF
     C                     MOVEL*BLANK    WUBWTX 25
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field Fax Recipient
     C                     MOVEL*BLANK    WULLTX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WHBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WHA2DT           Period Ending D
     C                     Z-ADD*ZERO     WHBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WHPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WHPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WHECVL           Comm Min Amt_Pe
     C                     Z-ADD*ZERO     WHHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDAT1           Broker G_L Vend
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Buyer Email Address
     C                     MOVEL*BLANK    YL0001 50
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Regional Salesperson Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Company Number Pass   USR
     C                     Z-ADD*ZERO     YL0004 155
      * Define local work field Order Number 1  PASS  USR
     C                     Z-ADD*ZERO     YL0005 155
      * Define local work field Order Number 2  PASS  USR
     C                     Z-ADD*ZERO     YL0006 155
      * Define local work field Customer Number Pass  USR
     C                     Z-ADD*ZERO     YL0007 155
      * Define null work field Broker Code
     C                     MOVEL*BLANK    YN0001  6
      * Define local work field Broker Email Address
     C                     MOVEL*BLANK    YL0008 50
      * Define null work field Broker Name
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Broker Address Line 1
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Broker Address Line 2
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Broker City
     C                     MOVEL*BLANK    YN0005 20
      * Define null work field Broker State
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field Broker Zip
     C                     MOVEL*BLANK    YN0007 11
      * Define null work field Broker Office Manager
     C                     MOVEL*BLANK    YN0008 30
      * Define null work field Broker Telephone Number
     C                     MOVEL*BLANK    YN0009 25
      * Define null work field Broker Fax Number
     C                     MOVEL*BLANK    YN0010 25
      * Define local work field Broker Email Address
     C                     MOVEL*BLANK    YL0009 50
      * Define null work field Broker G_L Vendor Number
     C                     Z-ADD*ZERO     YN0011  80
      * Define null work field Broker unused txt 1
     C                     MOVEL*BLANK    YN0012 25
      * Define null work field Broker M3 Supplier
     C                     MOVEL*BLANK    YN0013 20
      * Define null work field Broker EDI Trade Partner
     C                     MOVEL*BLANK    YN0014 20
      * Define null work field Broker Fax_Email Inv
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Broker Fax_Email Prc Sht
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Payee Type
     C                     MOVEL*BLANK    YN0017  2
      * Define null work field Broker unused sts 4
     C                     MOVEL*BLANK    YN0018  3
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0019  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0022  1
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0010  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PDKOPFR$
00002 Print Acknowledgements
