     H/TITLE Val Upd Held 856 f/TP XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 11/25/24  Time  : 03:21:47
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPM2  IF   E           K DISK
      * RSQ : Order Header TRG          Load/BTC#/Co/Order
      *
     FPNGQREL1  IF   E           K DISK
      * RTV : EDI Bill To Interchange   Retrieval index
      *
     FOPBGWKLA  IF   E           K DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1  IF   E           K DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOMFLCPL5  IF   E           K DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPMAMREL1  IF   E           K DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPMAMREL0  UF   E           K DISK
      * UPD : Order Header Extension    Update index
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPMAM1        E DS                  EXTNAME(PMAMREL0)
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     D  WGAIC3       E                     EXTFLD(AMAIC3)
     D  WGC4NB       E                     EXTFLD(AMC4NB)
     D  WGRMNB       E                     EXTFLD(AMRMNB)
     D  WGRUNB       E                     EXTFLD(AMRUNB)
     D  WGXACD       E                     EXTFLD(AMXACD)
     D  WGOANA       E                     EXTFLD(AMOANA)
     D  WGHBAA       E                     EXTFLD(AMHBAA)
     D  WGJ0T1       E                     EXTFLD(AMJ0T1)
     D  WGGENY       E                     EXTFLD(AMGENY)
     D  WGJ1T1       E                     EXTFLD(AMJ1T1)
     D  WGHCAA       E                     EXTFLD(AMHCAA)
     D  WGQWDT       E                     EXTFLD(AMQWDT)
     D  WGQXDT       E                     EXTFLD(AMQXDT)
     D  WGQYDT       E                     EXTFLD(AMQYDT)
     D  WGHDAA       E                     EXTFLD(AMHDAA)
     D  WGCCTX       E                     EXTFLD(AMCCTX)
     D  WGJ2T1       E                     EXTFLD(AMJ2T1)
     D  WGRLNA       E                     EXTFLD(AMRLNA)
     D  WGRMNA       E                     EXTFLD(AMRMNA)
     D  WGGINY       E                     EXTFLD(AMGINY)
     D  WGGFNY       E                     EXTFLD(AMGFNY)
     D  WGGGNY       E                     EXTFLD(AMGGNY)
     D  WGGHNY       E                     EXTFLD(AMGHNY)
     D  WGHEVL       E                     EXTFLD(AMHEVL)
     D  WGHFVL       E                     EXTFLD(AMHFVL)
     D  WGHGVL       E                     EXTFLD(AMHGVL)
     D  WGQZDT       E                     EXTFLD(AMQZDT)
     D  WGQ0DT       E                     EXTFLD(AMQ0DT)
     D  WGQ1DT       E                     EXTFLD(AMQ1DT)
     D  WGQ2DT       E                     EXTFLD(AMQ2DT)
     D  WGC2TX       E                     EXTFLD(AMC2TX)
     D  WGC3TX       E                     EXTFLD(AMC3TX)
     D  WGC6TX       E                     EXTFLD(AMC6TX)
     D  WGCHTX       E                     EXTFLD(AMCHTX)
     D  WGCITX       E                     EXTFLD(AMCITX)
     D  WGCLTX       E                     EXTFLD(AMCLTX)
     D  WGB4TX       E                     EXTFLD(AMB4TX)
     D  WGCUTX       E                     EXTFLD(AMCUTX)
     D  WGCVTX       E                     EXTFLD(AMCVTX)
     D  WGB9TX       E                     EXTFLD(AMB9TX)
     D  WGJWSC       E                     EXTFLD(AMJWSC)
     D  WGITNY       E                     EXTFLD(AMITNY)
     D  WGLMT1       E                     EXTFLD(AMLMT1)
     D  WGLWAA       E                     EXTFLD(AMLWAA)
     D  WGFVST       E                     EXTFLD(AMFVST)
     D  WGF0ST       E                     EXTFLD(AMF0ST)
     D  WGF2ST       E                     EXTFLD(AMF2ST)
     D  WGF3ST       E                     EXTFLD(AMF3ST)
     D  WGJUSC       E                     EXTFLD(AMJUSC)
     D  WGJVSC       E                     EXTFLD(AMJVSC)
     D  WGV3T1       E                     EXTFLD(AMV3T1)
     D  WGV4T1       E                     EXTFLD(AMV4T1)
     D  WGV5T1       E                     EXTFLD(AMV5T1)
     D  WGV6T1       E                     EXTFLD(AMV6T1)
     D  WGV7T1       E                     EXTFLD(AMV7T1)
     D  WGV8T1       E                     EXTFLD(AMV8T1)
     D  WGV9T1       E                     EXTFLD(AMV9T1)
     D  WGWAT1       E                     EXTFLD(AMWAT1)
     D  WGWBT1       E                     EXTFLD(AMWBT1)
     D  WGWCT1       E                     EXTFLD(AMWCT1)
     D  WGWDT1       E                     EXTFLD(AMWDT1)
     D  WGQJNY       E                     EXTFLD(AMQJNY)
     D  WGQKNY       E                     EXTFLD(AMQKNY)
     D  WGQLNY       E                     EXTFLD(AMQLNY)
     D  WGP8NY       E                     EXTFLD(AMP8NY)
     D  WGP9NY       E                     EXTFLD(AMP9NY)
     D  WGQANY       E                     EXTFLD(AMQANY)
     D  WGQCNY       E                     EXTFLD(AMQCNY)
     D  WGQDNY       E                     EXTFLD(AMQDNY)
     D  WGQENY       E                     EXTFLD(AMQENY)
     D  WGQFNY       E                     EXTFLD(AMQFNY)
     D  WGQGNY       E                     EXTFLD(AMQGNY)
     D  WGQHNY       E                     EXTFLD(AMQHNY)
     D  WGQINY       E                     EXTFLD(AMQINY)
     D  WGQMNY       E                     EXTFLD(AMQMNY)
     D  WGMYU1       E                     EXTFLD(AMMYU1)
     D  WGJXSC       E                     EXTFLD(AMJXSC)
     D  WGJYSC       E                     EXTFLD(AMJYSC)
     D  WGJZSC       E                     EXTFLD(AMJZSC)
     D  WGJ0SC       E                     EXTFLD(AMJ0SC)
     D  WGMZU1       E                     EXTFLD(AMMZU1)
     D  WGM0U1       E                     EXTFLD(AMM0U1)
     D  WGM1U1       E                     EXTFLD(AMM1U1)
     D  WGM2U1       E                     EXTFLD(AMM2U1)
     D  WGM3U1       E                     EXTFLD(AMM3U1)
     D  WGW5DT       E                     EXTFLD(AMW5DT)
     D  WGW6DT       E                     EXTFLD(AMW6DT)
     D  WGUVST       E                     EXTFLD(AMUVST)
     D  WGUWST       E                     EXTFLD(AMUWST)
     D  WGUXST       E                     EXTFLD(AMUXST)
     D  WGVSST       E                     EXTFLD(AMVSST)
     D  WGAATM       E                     EXTFLD(AMAATM)
     D  WGAYNA       E                     EXTFLD(AMAYNA)
     D  WGA0NA       E                     EXTFLD(AMA0NA)
     D  WGAXDT       E                     EXTFLD(AMAXDT)
      *
     D YARDCS          DS           894
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  WP0002         S              1
     D  WP0003         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              1
     D  WQSA01         S                   LIKE(WARMNB)
     D  WQSA02         S                   LIKE(WAB0C7)
     D  YL0002         S              6
     D  YN0001         S              6
     D  YN0002         S              3
     D  YN0003         S              1
     D  YL0003         S              3
     D  YL0004         S              1
     D  WL0001         S              7  0
     D  WL0002         S              6
     D  WL0003         S              6
     D  WL0004         S              3
     D  WL0005         S              1
     D  Y0CX01         S              1
     D  YL0005         S              3
     D  WL0006         S              3  0
     D  WL0007         S              7  0
     D  WL0008         S              3  0
     D  WL0009         S              3  0
     D  WL0010         S              3
     D  WL0011         S              6
     D  WQSC01         S                   LIKE(WCAIC3)
     D  WQSC02         S                   LIKE(WCC4NB)
     D  YL0006         S              1
     D  YL0007         S              1
     D  YN0004         S              1
     D  YL0008         S              1
     D  WL0012         S              3
     D  WL0013         S              1
     D  WL0014         S              1
     D  WL0015         S              1
     D  WL0016         S              1
     D  YL0009         S              1
     D  WQ0001         S              3  0
     D  WQ0002         S              7  0
     D  WQ0003         S              6
     D  WQ0004         S              1
     D  W0CLPG         S             10
     D  YL0010         S             25
     D  YL0011         S             25
     D  WQSE02         S                   LIKE(WERMNB)
     D  WQSE03         S                   LIKE(WEC4NB)
     D  YN0005         S              5
     D  YL0012         S              1
     D  YN0006         S              1
     D  WL0017         S              3  0
     D  WL0018         S              7  0
     D  WL0019         S              5
     D  WL0020         S              1
     D  WL0021         S              1
     D  WL0022         S              3  0
     D  WL0023         S              7  0
     D  WL0024         S              5
     D  WL0025         S              1
     D  WN0001         S              7  0
     D  WN0002         S              5  0
     D  WN0003         S              3
     D  WN0004         S             20
     D  WN0005         S             25
     D  WN0006         S             30
     D  WN0007         S             15
     D  WN0008         S             15
     D  WN0009         S             20
     D  WN0010         S              7  0
     D  WN0011         S              7  0
     D  WN0012         S              7  0
     D  WN0013         S              3
     D  WN0014         S              1
     D  WN0015         S             12
     D  WN0016         S             35
     D  WN0017         S             75
     D  WN0018         S             11  0
     D  WN0019         S             11  0
     D  WN0020         S             11  0
     D  WN0021         S             11  0
     D  WN0022         S             11  2
     D  WN0023         S             11  2
     D  WN0024         S             11  2
     D  WN0025         S              7  0
     D  WN0026         S              7  0
     D  WN0027         S              7  0
     D  WN0028         S              7  0
     D  WN0029         S              4
     D  WN0030         S              4
     D  WN0031         S              4
     D  WN0032         S              2
     D  WN0033         S              2
     D  WN0034         S              2
     D  WN0035         S              3
     D  WN0036         S              3
     D  WN0037         S              3
     D  WN0038         S              5
     D  WN0039         S              5  0
     D  WN0040         S             38
     D  WN0041         S              6
     D  WN0042         S              6
     D  WN0043         S              6
     D  WN0044         S              6
     D  WN0045         S              6
     D  WN0046         S              1
     D  WN0047         S             10
     D  WN0048         S             10
     D  WN0049         S             10
     D  WN0050         S             15
     D  WN0051         S             15
     D  WN0052         S             15
     D  WN0053         S             30
     D  WN0054         S             30
     D  WN0055         S             30
     D  WN0056         S             50
     D  WN0057         S             50
     D  WN0058         S              3  0
     D  WN0059         S              3  0
     D  WN0060         S              3  0
     D  WN0061         S              5  2
     D  WN0062         S              5  2
     D  WN0063         S              5  0
     D  WN0064         S              6  0
     D  WN0065         S              6  0
     D  WN0066         S              6  0
     D  WN0067         S              6  0
     D  WN0068         S              9  0
     D  WN0069         S              9  0
     D  WN0070         S              9  0
     D  WN0071         S              9  6
     D  WN0072         S             15
     D  WN0073         S              1
     D  WN0074         S              1
     D  WN0075         S              2
     D  WN0076         S              2
     D  WN0077         S              5
     D  WN0078         S              5
     D  WN0079         S             15
     D  WN0080         S             15
     D  WN0081         S             30
     D  WN0082         S              7  0
     D  WN0083         S              7  0
     D  WN0084         S              1
     D  WN0085         S              1
     D  WN0086         S              1
     D  WN0087         S              1
     D  WN0088         S              6  0
     D  WN0089         S             10
     D  WN0090         S             10
     D  WN0091         S              7  0
     D  YARDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS            14
      * KEY: Order Header TRG          Load/BTC#/Co/Order
      * I :  Load ID
     D  P1RMNB                 1      4P 0
      * I :  Bill to Customer
     D  P1B0C7                 5      8P 0
     D P2PARM          DS
      * FLD: Trade Partner Control
      * I :  Hold 856 f_Cust Asgn App#
     D  P2CFSC                 1      1
      * I :  Hold 856 f_Carr PRO
     D  P2CGSC                 2      2
     D P3PARM          DS
      * FLD: *Arrays
      * B :  Create EDI ASN 856 V2 USR
     D  P3KGSC                 1      1
     D                 DS
     D  ZAMSDA                 1    132
     I@BFCPHX
      * Order Header TRG          Load/BTC#/Co/Order
      * Renamed input format fields
     I              BEAIC3                      WAAIC3
     I              BEC4NB                      WAC4NB
     I              BEJNCD                      WAJNCD
     I              BEANC7                      WAANC7
     I              BEBKC7                      WABKC7
     I              BEBRTX                      WABRTX
     I              BEHMNA                      WAHMNA
     I              BEHONA                      WAHONA
     I              BEHPNA                      WAHPNA
     I              BEHNNA                      WAHNNA
     I              BEDBCD                      WADBCD
     I              BECKTX                      WACKTX
     I              BEB0C7                      WAB0C7
     I              BEAETX                      WAAETX
     I              BEB1NA                      WAB1NA
     I              BEB3NA                      WAB3NA
     I              BEB4NA                      WAB4NA
     I              BEB2NA                      WAB2NA
     I              BEBHCD                      WABHCD
     I              BEC8TX                      WAC8TX
     I              BEBCNA                      WABCNA
     I              BEA0DT                      WAA0DT
     I              BEA5DT                      WAA5DT
     I              BEGNDT                      WAGNDT
     I              BEACDT                      WAACDT
     I              BEAQCD                      WAAQCD
     I              BEB6NA                      WAB6NA
     I              BEBYNA                      WABYNA
     I              BEBZNA                      WABZNA
     I              BEGTST                      WAGTST
     I              BEGVST                      WAGVST
     I              BEGUST                      WAGUST
     I              BEQFST                      WAQFST
     I              BECQCD                      WACQCD
     I              BEGJST                      WAGJST
     I              BEGWST                      WAGWST
     I              BEGXST                      WAGXST
     I              BEGYST                      WAGYST
     I              BEAODT                      WAAODT
     I              BEAIVN                      WAAIVN
     I              BECXDT                      WACXDT
     I              BEJZVA                      WAJZVA
     I              BEA1WG                      WAA1WG
     I              BEXIST                      WAXIST
     I              BEXJST                      WAXJST
     I              BEXKST                      WAXKST
     I              BEEIDT                      WAEIDT
     I              BEAFTM                      WAAFTM
     I              BEE8CD                      WAE8CD
     I              BEE9CD                      WAE9CD
     I              BERMNB                      WARMNB
     I              BETBNB                      WATBNB
     I              BER1NB                      WAR1NB
     I              BEPJST                      WAPJST
     I              BEU0ST                      WAU0ST
     I              BEU1ST                      WAU1ST
     I              BEQ2CD                      WAQ2CD
     I              BEU2ST                      WAU2ST
     I              BEVEST                      WAVEST
     I              BEVFST                      WAVFST
     I              BEVGST                      WAVGST
     I              BERPCD                      WARPCD
     I              BERNNB                      WARNNB
     I              BEVDST                      WAVDST
     I              BEATIN                      WAATIN
     I              BEU4ST                      WAU4ST
     I              BEU5ST                      WAU5ST
     I              BERSRN                      WARSRN
     I              BEMHNA                      WAMHNA
     I              BEMINA                      WAMINA
     I              BEWBST                      WAWBST
     I              BER4CD                      WAR4CD
     I              BEBFCD                      WABFCD
     I              BEQ4CD                      WAQ4CD
     I              BET3NB                      WAT3NB
     I              BESICD                      WASICD
     I              BECONB                      WACONB
     I              BECEST                      WACEST
     I              BEAWDT                      WAAWDT
     I              BEJPCD                      WAJPCD
     I              BEXUST                      WAXUST
     I              BEZ1ST                      WAZ1ST
     I              BEVRVA                      WAVRVA
     I              BEOBST                      WAOBST
     I              BEBCST                      WABCST
     I              BEBDST                      WABDST
     I              BEB7VL                      WAB7VL
     I              BEGASX                      WAGASX
     I              BEGBSX                      WAGBSX
     I              BEGCSX                      WAGCSX
     I              BEGDSX                      WAGDSX
     I              BEFNSX                      WAFNSX
     I              BEFOSX                      WAFOSX
     I              BEFPSX                      WAFPSX
     I              BEFQSX                      WAFQSX
     I              BEFRSX                      WAFRSX
     I              BEFSSX                      WAFSSX
     I              BEFTSX                      WAFTSX
     I              BEFUSX                      WAFUSX
     I              BEFVSX                      WAFVSX
     I              BEFWSX                      WAFWSX
     I              BEFXSX                      WAFXSX
     I              BEFYSX                      WAFYSX
     I              BENODT                      WANODT
     I              BENPDT                      WANPDT
     I              BENQDT                      WANQDT
     I              BENRDT                      WANRDT
     I              BENSDT                      WANSDT
     I              BEBPTM                      WABPTM
     I              BEBQTM                      WABQTM
     I              BEBRTM                      WABRTM
     I              BEBSTM                      WABSTM
     I              BEBTTM                      WABTTM
     I              BEH0NX                      WAH0NX
     I              BEH1NX                      WAH1NX
     I              BEH2NX                      WAH2NX
     I              BEH3NX                      WAH3NX
     I              BEH4NX                      WAH4NX
     I              BEC0C7                      WAC0C7
     I              BEUVST                      WAUVST
     I              BEUWST                      WAUWST
     I              BEUXST                      WAUXST
     I              BEAATM                      WAAATM
     I              BEAYNA                      WAAYNA
     I              BEA0NA                      WAA0NA
     I              BEAXDT                      WAAXDT
      *
     I@GQREH2
      * EDI Bill To Interchange   Retrieval index
      * Renamed input format fields
     I              GQB0C7                      WBB0C7
     I              GQM4AA                      WBM4AA
     I              GQM7AA                      WBM7AA
     I              GQJ5NX                      WBJ5NX
     I              GQA8U1                      WBA8U1
     I              GQA9U1                      WBA9U1
     I              GQBAU1                      WBBAU1
     I              GQBBU1                      WBBBU1
     I              GQY4NY                      WBY4NY
     I              GQY5NY                      WBY5NY
     I              GQBFU1                      WBBFU1
     I              GQBGU1                      WBBGU1
     I              GQBHU1                      WBBHU1
     I              GQBIU1                      WBBIU1
     I              GQSIAA                      WBSIAA
     I              GQSJAA                      WBSJAA
     I              GQVSST                      WBVSST
     I              GQMJDT                      WBMJDT
     I              GQBETM                      WBBETM
     I              GQCCVN                      WBCCVN
     I              GQCDVN                      WBCDVN
     I              GQMKDT                      WBMKDT
     I              GQBFTM                      WBBFTM
     I              GQCEVN                      WBCEVN
     I              GQCFVN                      WBCFVN
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                      WCAIC3
     I              OMC4NB                      WCC4NB
     I              OMDPNB                      WCDPNB
     I              OMUENB                      WCUENB
     I              OMHGCD                      WCHGCD
     I              OMAJCD                      WCAJCD
     I              OMBKC7                      WCBKC7
     I              OMCFC7                      WCCFC7
     I              OMGMST                      WCGMST
     I              OMGNST                      WCGNST
     I              OMMAVA                      WCMAVA
     I              OMKDVA                      WCKDVA
     I              OML8VA                      WCL8VA
     I              OML9VA                      WCL9VA
     I              OMGTST                      WCGTST
     I              OMGVST                      WCGVST
     I              OMGUST                      WCGUST
     I              OMQFST                      WCQFST
     I              OMAYVA                      WCAYVA
     I              OMEXDT                      WCEXDT
     I              OMLQCD                      WCLQCD
     I              OMRDCD                      WCRDCD
     I              OMQ7CD                      WCQ7CD
     I              OMBZPR                      WCBZPR
     I              OML6NB                      WCL6NB
     I              OMU1ST                      WCU1ST
     I              OMGIDT                      WCGIDT
     I              OMCRCD                      WCCRCD
     I              OMAGCD                      WCAGCD
     I              OMRZST                      WCRZST
     I              OMR0ST                      WCR0ST
     I              OMR1ST                      WCR1ST
     I              OMG7NA                      WCG7NA
     I              OMG8NA                      WCG8NA
     I              OMRPCD                      WCRPCD
     I              OMVEST                      WCVEST
     I              OMVGST                      WCVGST
     I              OMAVST                      WCAVST
     I              OMU0ST                      WCU0ST
     I              OMRFCD                      WCRFCD
     I              OMFZST                      WCFZST
     I              OMR1NB                      WCR1NB
     I              OMAVQT                      WCAVQT
     I              OMD0WG                      WCD0WG
     I              OMCCQT                      WCCCQT
     I              OMAUWG                      WCAUWG
     I              OMCBQT                      WCCBQT
     I              OMATWG                      WCATWG
     I              OMAQCS                      WCAQCS
     I              OMAGCS                      WCAGCS
     I              OMAKPR                      WCAKPR
     I              OMALPR                      WCALPR
     I              OMAUPR                      WCAUPR
     I              OMAVWG                      WCAVWG
     I              OMA4WG                      WCA4WG
     I              OMA5DT                      WCA5DT
     I              OMAODT                      WCAODT
     I              OMGNDT                      WCGNDT
     I              OMAMST                      WCAMST
     I              OMANST                      WCANST
     I              OMVAST                      WCVAST
     I              OMRGNB                      WCRGNB
     I              OMRHNB                      WCRHNB
     I              OMRINB                      WCRINB
     I              OMRBCD                      WCRBCD
     I              OMHICD                      WCHICD
     I              OMRNCD                      WCRNCD
     I              OMROCD                      WCROCD
     I              OMCXDT                      WCCXDT
     I              OMAJVN                      WCAJVN
     I              OMKXCD                      WCKXCD
     I              OMJPCD                      WCJPCD
     I              OMCQCD                      WCCQCD
     I              OMR4CD                      WCR4CD
     I              OMZ1ST                      WCZ1ST
     I              OMZ3ST                      WCZ3ST
     I              OMZ4ST                      WCZ4ST
     I              OMDUPR                      WCDUPR
     I              OMB6VL                      WCB6VL
     I              OMA1AA                      WCA1AA
     I              OMFZSX                      WCFZSX
     I              OMF0SX                      WCF0SX
     I              OMF1SX                      WCF1SX
     I              OMF2SX                      WCF2SX
     I              OMF3SX                      WCF3SX
     I              OMF4SX                      WCF4SX
     I              OMF5SX                      WCF5SX
     I              OMF6SX                      WCF6SX
     I              OMF7SX                      WCF7SX
     I              OMNTDT                      WCNTDT
     I              OMNUDT                      WCNUDT
     I              OMNVDT                      WCNVDT
     I              OMNWDT                      WCNWDT
     I              OMNXDT                      WCNXDT
     I              OMBUTM                      WCBUTM
     I              OMBVTM                      WCBVTM
     I              OMBWTM                      WCBWTM
     I              OMBXTM                      WCBXTM
     I              OMBYTM                      WCBYTM
     I              OMH5NX                      WCH5NX
     I              OMH6NX                      WCH6NX
     I              OMH7NX                      WCH7NX
     I              OMH8NX                      WCH8NX
     I              OMH9NX                      WCH9NX
     I              OMDVPR                      WCDVPR
     I              OMDWPR                      WCDWPR
     I              OMDXPR                      WCDXPR
     I              OMDYPR                      WCDYPR
     I              OMDZPR                      WCDZPR
     I              OMGSPR                      WCGSPR
     I              OMGTPR                      WCGTPR
     I              OMGUPR                      WCGUPR
     I              OMHOST                      WCHOST
     I              OMHPST                      WCHPST
     I              OMIOST                      WCIOST
     I              OMPEWG                      WCPEWG
     I              OMRINY                      WCRINY
     I              OMTIDT                      WCTIDT
     I              OMTJDT                      WCTJDT
     I              OMH2ST                      WCH2ST
     I              OMH0ST                      WCH0ST
     I              OMH1ST                      WCH1ST
     I              OMTKDT                      WCTKDT
     I              OMTLDT                      WCTLDT
     I              OMTMDT                      WCTMDT
     I              OMUVST                      WCUVST
     I              OMUWST                      WCUWST
     I              OMUXST                      WCUXST
     I              OMAATM                      WCAATM
     I              OMAYNA                      WCAYNA
     I              OMA0NA                      WCA0NA
     I              OMAXDT                      WCAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                      WDAJCD
     I              ADF8NA                      WDF8NA
     I              ADACNA                      WDACNA
     I              ADADNA                      WDADNA
     I              ADAENA                      WDAENA
     I              ADAJNA                      WDAJNA
     I              ADBTTX                      WDBTTX
     I              ADAOCD                      WDAOCD
     I              ADBGCD                      WDBGCD
     I              ADVHST                      WDVHST
     I              ADMPNA                      WDMPNA
     I              ADWPST                      WDWPST
     I              ADXUST                      WDXUST
     I              ADT0ST                      WDT0ST
     I              ADT1ST                      WDT1ST
     I              ADDBNB                      WDDBNB
     I              ADT2ST                      WDT2ST
     I              ADT3ST                      WDT3ST
     I              ADT4ST                      WDT4ST
     I              ADT6ST                      WDT6ST
     I              ADBWC3                      WDBWC3
     I              ADBTC3                      WDBTC3
     I              ADBUC3                      WDBUC3
     I              ADBVC3                      WDBVC3
     I              ADFCAA                      WDFCAA
     I              ADRQSX                      WDRQSX
     I              ADRRSX                      WDRRSX
     I              ADRSSX                      WDRSSX
     I              ADRTSX                      WDRTSX
     I              ADT7ST                      WDT7ST
     I              ADT8ST                      WDT8ST
     I              ADRNSX                      WDRNSX
     I              ADROSX                      WDROSX
     I              ADRPSX                      WDRPSX
     I              ADUVST                      WDUVST
     I              ADUWST                      WDUWST
     I              ADUXST                      WDUXST
     I              ADVSST                      WDVSST
     I              ADAATM                      WDAATM
     I              ADAYNA                      WDAYNA
     I              ADA0NA                      WDA0NA
     I              ADAXDT                      WDAXDT
     I              ADQDSC                      WDQDSC
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                      WERMNB
     I              FLRUNB                      WERUNB
     I              FLRVNB                      WERVNB
     I              FLDQTX                      WEDQTX
     I              FLRWNB                      WERWNB
     I              FLRXNB                      WERXNB
     I              FLSQNB                      WESQNB
     I              FLT0NB                      WET0NB
     I              FLT1NB                      WET1NB
     I              FLR1NB                      WER1NB
     I              FLAIC3                      WEAIC3
     I              FLC4NB                      WEC4NB
     I              FLVCST                      WEVCST
     I              FLKEDT                      WEKEDT
     I              FLSXNB                      WESXNB
     I              FLKFDT                      WEKFDT
     I              FLACTM                      WEACTM
     I              FLK5TX                      WEK5TX
     I              FLW5CD                      WEW5CD
     I              FLEJDT                      WEEJDT
     I              FLAGTM                      WEAGTM
     I              FLKJDT                      WEKJDT
     I              FLATTM                      WEATTM
     I              FLHDDT                      WEHDDT
     I              FLAUTM                      WEAUTM
     I              FLKKDT                      WEKKDT
     I              FLAVTM                      WEAVTM
     I              FLZ4NB                      WEZ4NB
     I              FLY7ST                      WEY7ST
     I              FLY2ST                      WEY2ST
     I              FLWHTX                      WEWHTX
     I              FLWITX                      WEWITX
     I              FLWJTX                      WEWJTX
     I              FLWKTX                      WEWKTX
     I              FLWLTX                      WEWLTX
     I              FLN7DT                      WEN7DT
     I              FLN8DT                      WEN8DT
     I              FLN9DT                      WEN9DT
     I              FLB3TM                      WEB3TM
     I              FLB4TM                      WEB4TM
     I              FLB5TM                      WEB5TM
     I              FLIASX                      WEIASX
     I              FLIBSX                      WEIBSX
     I              FLICSX                      WEICSX
     I              FLWVTX                      WEWVTX
     I              FLWWTX                      WEWWTX
     I              FLWXTX                      WEWXTX
     I              FLUVST                      WEUVST
     I              FLUWST                      WEUWST
     I              FLUXST                      WEUXST
     I              FLAATM                      WEAATM
     I              FLAYNA                      WEAYNA
     I              FLA0NA                      WEA0NA
     I              FLAXDT                      WEAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                      WFAIC3
     I              AMC4NB                      WFC4NB
     I              AMRMNB                      WFRMNB
     I              AMRUNB                      WFRUNB
     I              AMXACD                      WFXACD
     I              AMOANA                      WFOANA
     I              AMHBAA                      WFHBAA
     I              AMJ0T1                      WFJ0T1
     I              AMGENY                      WFGENY
     I              AMJ1T1                      WFJ1T1
     I              AMHCAA                      WFHCAA
     I              AMQWDT                      WFQWDT
     I              AMQXDT                      WFQXDT
     I              AMQYDT                      WFQYDT
     I              AMHDAA                      WFHDAA
     I              AMCCTX                      WFCCTX
     I              AMJ2T1                      WFJ2T1
     I              AMRLNA                      WFRLNA
     I              AMRMNA                      WFRMNA
     I              AMGINY                      WFGINY
     I              AMGFNY                      WFGFNY
     I              AMGGNY                      WFGGNY
     I              AMGHNY                      WFGHNY
     I              AMHEVL                      WFHEVL
     I              AMHFVL                      WFHFVL
     I              AMHGVL                      WFHGVL
     I              AMQZDT                      WFQZDT
     I              AMQ0DT                      WFQ0DT
     I              AMQ1DT                      WFQ1DT
     I              AMQ2DT                      WFQ2DT
     I              AMC2TX                      WFC2TX
     I              AMC3TX                      WFC3TX
     I              AMC6TX                      WFC6TX
     I              AMCHTX                      WFCHTX
     I              AMCITX                      WFCITX
     I              AMCLTX                      WFCLTX
     I              AMB4TX                      WFB4TX
     I              AMCUTX                      WFCUTX
     I              AMCVTX                      WFCVTX
     I              AMB9TX                      WFB9TX
     I              AMJWSC                      WFJWSC
     I              AMITNY                      WFITNY
     I              AMLMT1                      WFLMT1
     I              AMLWAA                      WFLWAA
     I              AMFVST                      WFFVST
     I              AMF0ST                      WFF0ST
     I              AMF2ST                      WFF2ST
     I              AMF3ST                      WFF3ST
     I              AMJUSC                      WFJUSC
     I              AMJVSC                      WFJVSC
     I              AMV3T1                      WFV3T1
     I              AMV4T1                      WFV4T1
     I              AMV5T1                      WFV5T1
     I              AMV6T1                      WFV6T1
     I              AMV7T1                      WFV7T1
     I              AMV8T1                      WFV8T1
     I              AMV9T1                      WFV9T1
     I              AMWAT1                      WFWAT1
     I              AMWBT1                      WFWBT1
     I              AMWCT1                      WFWCT1
     I              AMWDT1                      WFWDT1
     I              AMQJNY                      WFQJNY
     I              AMQKNY                      WFQKNY
     I              AMQLNY                      WFQLNY
     I              AMP8NY                      WFP8NY
     I              AMP9NY                      WFP9NY
     I              AMQANY                      WFQANY
     I              AMQCNY                      WFQCNY
     I              AMQDNY                      WFQDNY
     I              AMQENY                      WFQENY
     I              AMQFNY                      WFQFNY
     I              AMQGNY                      WFQGNY
     I              AMQHNY                      WFQHNY
     I              AMQINY                      WFQINY
     I              AMQMNY                      WFQMNY
     I              AMMYU1                      WFMYU1
     I              AMJXSC                      WFJXSC
     I              AMJYSC                      WFJYSC
     I              AMJZSC                      WFJZSC
     I              AMJ0SC                      WFJ0SC
     I              AMMZU1                      WFMZU1
     I              AMM0U1                      WFM0U1
     I              AMM1U1                      WFM1U1
     I              AMM2U1                      WFM2U1
     I              AMM3U1                      WFM3U1
     I              AMW5DT                      WFW5DT
     I              AMW6DT                      WFW6DT
     I              AMUVST                      WFUVST
     I              AMUWST                      WFUWST
     I              AMUXST                      WFUXST
     I              AMVSST                      WFVSST
     I              AMAATM                      WFAATM
     I              AMAYNA                      WFAYNA
     I              AMA0NA                      WFA0NA
     I              AMAXDT                      WFAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                      WGAIC3
     I              AMC4NB                      WGC4NB
     I              AMRMNB                      WGRMNB
     I              AMRUNB                      WGRUNB
     I              AMXACD                      WGXACD
     I              AMOANA                      WGOANA
     I              AMHBAA                      WGHBAA
     I              AMJ0T1                      WGJ0T1
     I              AMGENY                      WGGENY
     I              AMJ1T1                      WGJ1T1
     I              AMHCAA                      WGHCAA
     I              AMQWDT                      WGQWDT
     I              AMQXDT                      WGQXDT
     I              AMQYDT                      WGQYDT
     I              AMHDAA                      WGHDAA
     I              AMCCTX                      WGCCTX
     I              AMJ2T1                      WGJ2T1
     I              AMRLNA                      WGRLNA
     I              AMRMNA                      WGRMNA
     I              AMGINY                      WGGINY
     I              AMGFNY                      WGGFNY
     I              AMGGNY                      WGGGNY
     I              AMGHNY                      WGGHNY
     I              AMHEVL                      WGHEVL
     I              AMHFVL                      WGHFVL
     I              AMHGVL                      WGHGVL
     I              AMQZDT                      WGQZDT
     I              AMQ0DT                      WGQ0DT
     I              AMQ1DT                      WGQ1DT
     I              AMQ2DT                      WGQ2DT
     I              AMC2TX                      WGC2TX
     I              AMC3TX                      WGC3TX
     I              AMC6TX                      WGC6TX
     I              AMCHTX                      WGCHTX
     I              AMCITX                      WGCITX
     I              AMCLTX                      WGCLTX
     I              AMB4TX                      WGB4TX
     I              AMCUTX                      WGCUTX
     I              AMCVTX                      WGCVTX
     I              AMB9TX                      WGB9TX
     I              AMJWSC                      WGJWSC
     I              AMITNY                      WGITNY
     I              AMLMT1                      WGLMT1
     I              AMLWAA                      WGLWAA
     I              AMFVST                      WGFVST
     I              AMF0ST                      WGF0ST
     I              AMF2ST                      WGF2ST
     I              AMF3ST                      WGF3ST
     I              AMJUSC                      WGJUSC
     I              AMJVSC                      WGJVSC
     I              AMV3T1                      WGV3T1
     I              AMV4T1                      WGV4T1
     I              AMV5T1                      WGV5T1
     I              AMV6T1                      WGV6T1
     I              AMV7T1                      WGV7T1
     I              AMV8T1                      WGV8T1
     I              AMV9T1                      WGV9T1
     I              AMWAT1                      WGWAT1
     I              AMWBT1                      WGWBT1
     I              AMWCT1                      WGWCT1
     I              AMWDT1                      WGWDT1
     I              AMQJNY                      WGQJNY
     I              AMQKNY                      WGQKNY
     I              AMQLNY                      WGQLNY
     I              AMP8NY                      WGP8NY
     I              AMP9NY                      WGP9NY
     I              AMQANY                      WGQANY
     I              AMQCNY                      WGQCNY
     I              AMQDNY                      WGQDNY
     I              AMQENY                      WGQENY
     I              AMQFNY                      WGQFNY
     I              AMQGNY                      WGQGNY
     I              AMQHNY                      WGQHNY
     I              AMQINY                      WGQINY
     I              AMQMNY                      WGQMNY
     I              AMMYU1                      WGMYU1
     I              AMJXSC                      WGJXSC
     I              AMJYSC                      WGJYSC
     I              AMJZSC                      WGJZSC
     I              AMJ0SC                      WGJ0SC
     I              AMMZU1                      WGMZU1
     I              AMM0U1                      WGM0U1
     I              AMM1U1                      WGM1U1
     I              AMM2U1                      WGM2U1
     I              AMM3U1                      WGM3U1
     I              AMW5DT                      WGW5DT
     I              AMW6DT                      WGW6DT
     I              AMUVST                      WGUVST
     I              AMUWST                      WGUWST
     I              AMUXST                      WGUXST
     I              AMVSST                      WGVSST
     I              AMAATM                      WGAATM
     I              AMAYNA                      WGAYNA
     I              AMA0NA                      WGA0NA
     I              AMAXDT                      WGAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         KEY: Order Head
     C     P2CFSC        PARM                    WP0001                         Hold 856 f_Cust
     C     P2CGSC        PARM                    WP0002                         Hold 856 f_Carr
     C     P3KGSC        PARM      P3KGSC        WP0003                         Create EDI ASN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Val Upd Held 856 f/TP XF
      * Val Upd Held 856 f/TP RT - Order Header TRG  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Val Upd Held 856 f/TP RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   MOVEL     'N'           P3KGSC                         Create EDI ASN
     C                   MOVEL     'N'           YL0001                         Order Upd to He
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA01                         Load ID
     C                   KFLD                    WQSA02                         Bill to Custome
      * Setup key
     C                   Z-ADD     P1RMNB        WQSA01                         Load ID
     C                   Z-ADD     P1B0C7        WQSA02                         Bill to Custome
      * Establish starting position
     C     KRSSA         SETLL     @BFCPHX                                      *
     C     KRSSA         READE     @BFCPHX                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * WI609_2 JM 11/21/24-Added output parm warehouse location to array
      *                     PAR EDI 856 ASN V2-Val Cust Setup 4/856 V2IF.
      *                     Recompile only.
      * Val Cust Setup 4/856 V2IF
      * VALIDATIONS: Is Bill To Customer Setup for EDI 856 ASN V2?
      * CASE: *OTHERWISE
     C                   DOW       NOT *IN90
     C                   MOVEL     'N'           P3KGSC                         Create EDI ASN
      * RTV EDI ASN 856 Info  RT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     P1B0C7        WL0001                         Bill to Custome
     C                   MOVEL(P)  'ADVSN'       WL0002                         Interchange Cod
     C                   EXSR      SBRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0003        YL0002                         EDI Trading Par
     C                   MOVEL(P)  WL0004        YL0003                         EDI Detailed AS
     C                   MOVEL(P)  WL0005        YL0004                         Record Status
      * Do Not Check Customer & Warehouse if Coming From PDN2XFR Program.
      * CASE: *OTHERWISE
      * Bill To Customer Must Be Active & Setup for EDI 856.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.EDI Detailed ASN 856 Rqd is Yes
      *   |- c2    : LCL.Record Status is Active
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0003 = 'Y'
     C                   IF        YL0004 = 'A'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           P3KGSC                         Create EDI ASN
     C                   END                                                    *FI
      * WI609_2 Check Internal or External Warehouse Qualifies for 856 AS
      * CASE: PAR.Create EDI ASN 856 V2 USR is Yes
      * RTV 1st Whse/Country   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3KGSC = 'Y'
     C                   Z-ADD     WAAIC3        WL0006                         Company Number
     C                   Z-ADD     WAC4NB        WL0007                         Order Number
     C                   Z-ADD     1             WL0008                         Order Sequence
     C                   Z-ADD     1             WL0009                         Order Secondary
     C                   EXSR      SCRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0010        YL0005                         Warehouse Code
     C                   MOVEL(P)  WL0011        YN0001                         Country Code
      * Rtv EDI 856 ASN Info RT - Warehouse Codes  * 
      * Move input parameters to subroutine local variables.
     C                   MOVEL(P)  YL0005        WL0012                         Warehouse Code
     C                   EXSR      SDRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0013        YL0006                         Warehouse Locat
     C                   MOVEL(P)  WL0014        YL0007                         WHS Live with C
     C                   MOVEL(P)  WL0015        YN0004                         WHS PFS Interfa
     C                   MOVEL(P)  WL0016        YL0008                         Crt 856 ASN for
     C                   MOVEL     YL0006        YN0003                         Warehouse Locat
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Warehouse Location is Internal (Plant)
      *   |- c2    : LCL.WHS Live w/Carlisle is Yes
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0006 = 'I'
     C                   IF        YL0007 = 'Y'
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   IF        Y0CX01 = '1'
     C                   MOVEL     'Y'           P3KGSC                         Create EDI ASN
     C                   MOVEL     YL0005        YN0002                         Warehouse Code
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           P3KGSC                         Create EDI ASN
      * WI609_2 JM 10/08/24-Allow External 3PL Warehouses to Receive EDI
      * CASE: LCL.Warehouse Location is External
      * CASE: LCL.Crt 856 ASN for 3PL Whse is Yes
     C                   IF        YL0006 = 'E'
     C                   IF        YL0008 = 'Y'
     C                   MOVEL     'Y'           P3KGSC                         Create EDI ASN
     C                   MOVEL     YL0005        YN0002                         Warehouse Code
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * WI609_2 JM 10/08/24-Check EDI Manual PO.
      * CASE: PAR.Create EDI ASN 856 V2 USR is Yes
      * Rtv EDI Manual PO Sts XF - EDI Bill To Interchange  * ADVSN
     C                   IF        P3KGSC = 'Y'
     C                   CALL      'PUTBXFR'                            90      Rtv EDI Manual
     C                   PARM      *BLANK        W0RTN
     C                   PARM      WAAIC3        WQ0001                         Company Number
     C                   PARM      WAC4NB        WQ0002                         Order Number
     C                   PARM      'ADVSN'       WQ0003                         Interchange Cod
     C     YL0009        PARM      *BLANK        WQ0004                         Send EDI Docume
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PUTBXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * If Send EDI Documents = N, set Create EDI ASN 856 V2 USR = N
      * CASE: LCL.Send EDI Document Y/N is No
     C                   IF        YL0009 = 'N'
     C                   MOVEL     'N'           P3KGSC                         Create EDI ASN
     C                   END                                                    *FI
     C                   END                                                    *FI
      * CASE: PAR.Create EDI ASN 856 V2 USR is Yes
      * RTV EDI 856 Flags     RT - Load Detail  * 
     C                   IF        P3KGSC = 'Y'
     C                   EXSR      SERVGN
      * Check Held 'Cust Assigned Appt #' - Designated for Walmart.
      * CASE: PAR.Hold 856 f/Cust Asgn App# is Yes
      * RTV EDI 856/824 Sts    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P2CFSC = 'Y'
     C                   Z-ADD     WAAIC3        WL0017                         Company Number
     C                   Z-ADD     WAC4NB        WL0018                         Order Number
     C                   EXSR      SFRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0019        YN0005                         OHE EDI Error R
     C                   MOVEL(P)  WL0020        YL0012                         OHE EDI 856 Act
     C                   MOVEL(P)  WL0021        YN0006                         OHE EDI 824 Act
      * Continue Validation if NOT 'Sent'.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.OHE EDI 856 Action is Sent
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0012 = 'S'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
      * Determine if OK to Create EDI 856?
      * CASE: LCL.Cust Assigned Appt # is Not Entered
     C                   IF        Y0CX01 = '1'
     C                   IF        YL0011 = ' '
     C                   MOVEL     'Y'           YL0001                         Order Upd to He
     C                   MOVEL     'N'           P3KGSC                         Create EDI ASN
      * If Not Already 'Held', Update to 'Held' in OHE file.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.OHE EDI 856 Action is Held
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0012 = 'H'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
      * Upd OHE EDI 856 Error  RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     WAAIC3        WL0022                         Company Number
     C                   Z-ADD     WAC4NB        WL0023                         Order Number
     C                   EVAL      WL0024 = ' '                                 OHE EDI Error R
     C                   MOVEL(P)  'H'           WL0025                         OHE EDI 856 Act
     C                   EXSR      SGRVGN
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * If ALL Orders for Load/BTC# falls through here, create EDI 856.
     C                   MOVEL     'Y'           P3KGSC                         Create EDI ASN
      * If OHE EDI 856 'Held' Status, Change it to 'Blank'.
      * CASE: LCL.OHE EDI 856 Action is Held
      * Upd OHE EDI 856 Error  RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0012 = 'H'
     C                   Z-ADD     WAAIC3        WL0022                         Company Number
     C                   Z-ADD     WAC4NB        WL0023                         Order Number
     C                   EVAL      WL0024 = ' '                                 OHE EDI Error R
     C                   EVAL      WL0025 = ' '                                 OHE EDI 856 Act
     C                   EXSR      SGRVGN
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Check Held 'Carrier Ref PRO/Inv' - Designated for Hello Fresh.
      * CASE: PAR.Hold 856 f/Carr PRO is Yes
      * RTV EDI 856/824 Sts    RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P2CGSC = 'Y'
     C                   Z-ADD     WAAIC3        WL0017                         Company Number
     C                   Z-ADD     WAC4NB        WL0018                         Order Number
     C                   EXSR      SFRVGN
      * Move subroutine local variables to output parameters.
     C                   MOVEL(P)  WL0019        YN0005                         OHE EDI Error R
     C                   MOVEL(P)  WL0020        YL0012                         OHE EDI 856 Act
     C                   MOVEL(P)  WL0021        YN0006                         OHE EDI 824 Act
      * Continue Validation if NOT 'Sent'.
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.OHE EDI 856 Action is Sent
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        YL0012 = 'S'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
      * Determine if OK to Create EDI 856?
      * CASE: LCL.Carrier Ref PRO/Inv is Not Entered
     C                   IF        Y0CX01 = '1'
     C                   IF        YL0010 = ' '
     C                   MOVEL     'Y'           YL0001                         Order Upd to He
     C                   MOVEL     'N'           P3KGSC                         Create EDI ASN
      * If Not Already 'Held', Update to 'Held' in OHE file.
      * CASE: LCL.OHE EDI 856 Action is Held
      * Upd OHE EDI 856 Error  RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0012 = 'H'
     C                   Z-ADD     WAAIC3        WL0022                         Company Number
     C                   Z-ADD     WAC4NB        WL0023                         Order Number
     C                   EVAL      WL0024 = ' '                                 OHE EDI Error R
     C                   MOVEL(P)  'H'           WL0025                         OHE EDI 856 Act
     C                   EXSR      SGRVGN
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * If ALL Orders for Load/BTC# falls through here, create EDI 856.
     C                   MOVEL     'Y'           P3KGSC                         Create EDI ASN
      * If OHE EDI 856 'Held' Status, Change it to 'Blank'.
      * CASE: LCL.OHE EDI 856 Action is Held
      * Upd OHE EDI 856 Error  RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0012 = 'H'
     C                   Z-ADD     WAAIC3        WL0022                         Company Number
     C                   Z-ADD     WAC4NB        WL0023                         Order Number
     C                   EVAL      WL0024 = ' '                                 OHE EDI Error R
     C                   EVAL      WL0025 = ' '                                 OHE EDI 856 Act
     C                   EXSR      SGRVGN
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSA         READE     @BFCPHX                                90    *
     C                   ENDDO
      * USER: Exit processing
      * At Least 1 or More Orders Updated to 'Held' for 856, Do NOT Creat
      * CASE: LCL.Order Upd to Held f/856 U is Yes
     C                   IF        YL0001 = 'Y'
     C                   MOVEL     'N'           P3KGSC                         Create EDI ASN
     C                   END                                                    *FI
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * RTV EDI ASN 856 Info  RT - EDI Bill To Interchange  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0003 = ' '                                 EDI Trading Par
     C                   EVAL      WL0004 = ' '                                 EDI Detailed AS
     C                   EVAL      WL0005 = ' '                                 Record Status
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBB0C7                         Bill to Custome
     C                   KFLD                    WBM4AA                         Interchange Cod
      * Setup key
     C                   Z-ADD     WL0001        WBB0C7                         Bill to Custome
     C                   MOVEL     WL0002        WBM4AA                         Interchange Cod
      * Establish starting position
     C     KRSSB         CHAIN     @GQREH2                            90        *
      * Data record not found
     C   90              MOVEL     'USR4373'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WBJ5NX        WL0003                         EDI Trading Par
     C                   MOVEL     WBBIU1        WL0004                         EDI Detailed AS
     C                   MOVEL     WBVSST        WL0005                         Record Status
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * RTV 1st Whse/Country   RT - Order Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KPSSC         KLIST
     C                   KFLD                    WQSC01                         Company Number
     C                   KFLD                    WQSC02                         Order Number
     C                   KFLD                    WCDPNB                         Order Sequence
     C                   KFLD                    WCUENB                         Order Secondary
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WQSC01                         Company Number
     C                   KFLD                    WQSC02                         Order Number
      * Setup key
     C                   Z-ADD     WL0006        WQSC01                         Company Number
     C                   Z-ADD     WL0007        WQSC02                         Order Number
     C                   Z-ADD     WL0008        WCDPNB                         Order Sequence
     C                   Z-ADD     WL0009        WCUENB                         Order Secondary
      * Establish starting position
     C     KPSSC         SETLL     @BGWKAE                                      *
     C     KRSSC         READE     @BGWKAE                                90    *
      * Data record not found
     C   90              MOVEL     'USR1309'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WCAJCD        WL0010                         Warehouse Code
     C                   MOVEL     WCKXCD        WL0011                         Country Code
     C                   GOTO      SCEXIT                                       *QUIT
     C     KRSSC         READE     @BGWKAE                                90    *
     C                   ENDDO
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Rtv EDI 856 ASN Info RT - Warehouse Codes  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WDAJCD                         Warehouse Code
      * Setup key
     C                   MOVEL     WL0012        WDAJCD                         Warehouse Code
      * Establish starting position
     C     KRSSD         CHAIN     @ADREAO                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0007'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      WL0013 = ' '                                 Warehouse Locat
     C                   EVAL      WL0014 = ' '                                 WHS Live with C
     C                   EVAL      WL0015 = ' '                                 WHS PFS Interfa
     C                   EVAL      WL0016 = ' '                                 Crt 856 ASN for
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WDT0ST        WL0013                         Warehouse Locat
     C                   MOVEL     WDRRSX        WL0014                         WHS Live with C
     C                   MOVEL     WDRSSX        WL0015                         WHS PFS Interfa
     C                   MOVEL     WDQDSC        WL0016                         Crt 856 ASN for
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SERVGN        BEGSR
      *================================================================
      * RTV EDI 856 Flags     RT - Load Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      YL0010 = ' '                                 Carrier Ref PRO
     C                   EVAL      YL0011 = ' '                                 Cust Assigned A
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSE         KLIST
     C                   KFLD                    WQSE02                         Load ID
     C                   KFLD                    WQSE03                         Order Number
      * Setup key
     C                   Z-ADD     P1RMNB        WQSE02                         Load ID
     C                   Z-ADD     WAC4NB        WQSE03                         Order Number
      * Establish starting position
     C     KRSSE         SETLL     @FLCPKF                                      *
     C     KRSSE         READE     @FLCPKF                                90    *
      * Data record not found
     C   90              MOVEL     'USR1192'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   DOW       NOT *IN90
     C                   MOVEL     WEWWTX        YL0010                         Carrier Ref PRO
     C                   MOVEL     WEWXTX        YL0011                         Cust Assigned A
     C     KRSSE         READE     @FLCPKF                                90    *
     C                   ENDDO
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * RTV EDI 856/824 Sts    RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * PAR = CON By name
     C                   EVAL      WL0019 = ' '                                 OHE EDI Error R
     C                   EVAL      WL0020 = ' '                                 OHE EDI 856 Act
     C                   EVAL      WL0021 = ' '                                 OHE EDI 824 Act
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    WFAIC3                         Company Number
     C                   KFLD                    WFC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WL0017        WFAIC3                         Company Number
     C                   Z-ADD     WL0018        WFC4NB                         Order Number
      * Establish starting position
     C     KRSSF         CHAIN     @AMREJF                            90        *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   MOVEL     WFJWSC        WL0019                         OHE EDI Error R
     C                   MOVEL     WFJUSC        WL0020                         OHE EDI 856 Act
     C                   MOVEL     WFJVSC        WL0021                         OHE EDI 824 Act
     C                   ENDIF
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   SGRVGN        BEGSR
      *================================================================
      * Upd OHE EDI 856 Error  RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSG         KLIST
     C                   KFLD                    WFAIC3                         Company Number
     C                   KFLD                    WFC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WL0022        WFAIC3                         Company Number
     C                   Z-ADD     WL0023        WFC4NB                         Order Number
      * Establish starting position
     C     KRSSG         CHAIN     @AMREJF                            90        *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * CHG OHE EDI 856 Error  CH - Order Header Extension  * 
     C                   IF        NOT *IN90
     C                   EXSR      SHCHRC
     C                   ENDIF
      *================================================================
     CSR   SGEXIT        ENDSR
      /EJECT
     CSR   SHCHRC        BEGSR
      *================================================================
      * CHG OHE EDI 856 Error  CH - Order Header Extension  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Load ID
     C                   Z-ADD     *ZERO         WN0002                         Stop_Drop Seque
     C                   EVAL      WN0003 = ' '                                 Shipping Line
     C                   EVAL      WN0004 = ' '                                 Port Delv Termi
     C                   EVAL      WN0005 = ' '                                 OHE City
     C                   EVAL      WN0006 = ' '                                 OHE Vessel_Airl
     C                   EVAL      WN0007 = ' '                                 OHE Voyage_Flig
     C                   EVAL      WN0008 = ' '                                 OHE Booking Num
     C                   EVAL      WN0009 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         WN0010                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WN0011                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WN0012                         OHE Arrival Dat
     C                   EVAL      WN0013 = ' '                                 OHE Late Delive
     C                   EVAL      WN0014 = ' '                                 OHE Ship Status
     C                   EVAL      WN0015 = ' '                                 OHE Container N
     C                   EVAL      WN0016 = ' '                                 OHE Comment 1
     C                   EVAL      WN0017 = ' '                                 OHE Comment 2
     C                   Z-ADD     *ZERO         WN0018                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0019                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0020                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0021                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0022                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WN0023                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WN0024                         Transload Termi
     C                   Z-ADD     *ZERO         WN0025                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WN0026                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WN0027                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WN0028                         OHE Actual Ship
     C                   EVAL      WN0029 = ' '                                 OHE Carrier SCA
     C                   EVAL      WN0030 = ' '                                 OHE Spot Buy
     C                   EVAL      WN0031 = ' '                                 OHE PO ACK Flag
     C                   EVAL      WN0032 = ' '                                 OHE Override Ty
     C                   EVAL      WN0033 = ' '                                 OHE Backhaul St
     C                   EVAL      WN0034 = ' '                                 OHE Backhaul ET
     C                   EVAL      WN0035 = ' '                                 OHE Load Haul T
     C                   EVAL      WN0036 = ' '                                 OHE Backhaul Ca
     C                   EVAL      WN0037 = ' '                                 OHE Bookings Co
     C                   EVAL      WN0038 = ' '                                 OHE EDI Error R
     C                   Z-ADD     *ZERO         WN0039                         HPB COA Batch N
     C                   EVAL      WN0040 = ' '                                 Delivery P_O  N
     C                   EVAL      WN0041 = ' '                                 OHE Intended fo
     C                   EVAL      WN0042 = ' '                                 OHE EDI 943 Act
     C                   EVAL      WN0043 = ' '                                 OHE EDI 944 Act
     C                   EVAL      WN0044 = ' '                                 OHE EDI 940 Act
     C                   EVAL      WN0045 = ' '                                 OHE EDI 945 Act
     C                   EVAL      WN0046 = ' '                                 OHE EDI 824 Act
     C                   EVAL      WN0047 = ' '                                 OHE Transload S
     C                   EVAL      WN0048 = ' '                                 OHE Abs Rate Ov
     C                   EVAL      WN0049 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0050 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0051 = ' '                                 OHE Backhaul Ch
     C                   EVAL      WN0052 = ' '                                 OHE Transload C
     C                   EVAL      WN0053 = ' '                                 OHE Pier Pass I
     C                   EVAL      WN0054 = ' '                                 OHE Carrier Nm
     C                   EVAL      WN0055 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0056 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0057 = ' '                                 Letter of Credi
     C                   Z-ADD     *ZERO         WN0058                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WN0059                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WN0060                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0061                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WN0062                         OHE Port Check
     C                   Z-ADD     *ZERO         WN0063                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WN0064                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WN0065                         OHE Load Sched
     C                   Z-ADD     *ZERO         WN0066                         Original Appoin
     C                   Z-ADD     *ZERO         WN0067                         Original Appoin
     C                   Z-ADD     *ZERO         WN0068                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0069                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0070                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WN0071                         OHE Orig ABS Fr
     C                   EVAL      WN0072 = ' '                                 OHE Genset Numb
     C                   EVAL      WN0073 = ' '                                 OHE Email BOL_S
     C                   EVAL      WN0074 = ' '                                 OHE EDI Order A
     C                   EVAL      WN0075 = ' '                                 OHE EDI 601 Act
     C                   EVAL      WN0076 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0077 = ' '                                 OHE Unused Text
     C                   EVAL      WN0078 = ' '                                 OHE Unused Text
     C                   EVAL      WN0079 = ' '                                 OHE Customer Ve
     C                   EVAL      WN0080 = ' '                                 OHE EDI 824 AES
     C                   EVAL      WN0081 = ' '                                 OHE Unused Text
     C                   Z-ADD     *ZERO         WN0082                         OHE Unused Date
     C                   Z-ADD     *ZERO         WN0083                         OHE Unused Date
     C                   EVAL      WN0084 = ' '                                 EDI Status 1
     C                   EVAL      WN0085 = ' '                                 EDI Status 2
     C                   EVAL      WN0086 = ' '                                 EDI Status 3
     C                   EVAL      WN0087 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0088                         Job Time
     C                   EVAL      WN0089 = ' '                                 User Id
     C                   EVAL      WN0090 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0091                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @AMREJE
     C                   Z-ADD     WFAIC3        WGAIC3                         Company Number
     C                   Z-ADD     WFC4NB        WGC4NB                         Order Number
      *
     C     KLCHSH        KLIST
     C                   KFLD                    WGAIC3                         Company Number
     C                   KFLD                    WGC4NB                         Order Number
     C     KLCHSH        CHAIN     @AMREJE                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PMAMREL0'    MDACP
     C                   MOVEL     '@AMREJE'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SHEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SHEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPMAM1        YARDCS
      * Move non-key fields to @AMREJE
     C                   MOVEL(P)  WL0024        WGJWSC                         OHE EDI Error R
     C                   MOVEL(P)  WL0025        WGJUSC                         OHE EDI 856 Act
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
     C                   Z-ADD     ##JTM         WGAATM                         Job Time
     C                   Z-ADD     ##JDT         WGAXDT                         Job Date
     C                   MOVEL     ##PGM         WGA0NA                         Job Name
     C                   MOVEL     ##USR         WGAYNA                         User Id
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @AMREJE                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PMAMREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SHEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WAANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WAA0DT                         Order Date
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WAACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WAJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WAA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WAEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WAAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WATBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WARNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WAATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WARSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WAT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WACONB                         Invoice Number
     C                   Z-ADD     *ZERO         WAAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WAVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WAB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WANODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WANPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WANQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WANRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WANSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WABPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WABQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WABRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WABSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WABTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WAH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WAH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WAH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WAH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WAH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WAC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WBY4NY                         EDI Alt ST Cust
     C                   Z-ADD     *ZERO         WBY5NY                         EDI unused nbr
     C                   Z-ADD     *ZERO         WBMJDT                         Create Date
     C                   Z-ADD     *ZERO         WBBETM                         Create Time
     C                   Z-ADD     *ZERO         WBMKDT                         Change Date
     C                   Z-ADD     *ZERO         WBBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCAIC3                         Company Number
     C                   Z-ADD     *ZERO         WCC4NB                         Order Number
     C                   Z-ADD     *ZERO         WCDPNB                         Order Sequence
     C                   Z-ADD     *ZERO         WCUENB                         Order Secondary
     C                   Z-ADD     *ZERO         WCHGCD                         Item Code
     C                   Z-ADD     *ZERO         WCBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WCCFC7                         Order Group Cod
     C                   Z-ADD     *ZERO         WCMAVA                         Billing Detail
     C                   Z-ADD     *ZERO         WCKDVA                         Billing Detail
     C                   Z-ADD     *ZERO         WCL8VA                         Billing Detail
     C                   Z-ADD     *ZERO         WCL9VA                         Quantity to Sub
     C                   Z-ADD     *ZERO         WCAYVA                         Extended Amount
     C                   Z-ADD     *ZERO         WCEXDT                         Market Pricing
     C                   Z-ADD     *ZERO         WCBZPR                         Price Overage O
     C                   Z-ADD     *ZERO         WCL6NB                         Contract Number
     C                   Z-ADD     *ZERO         WCGIDT                         Pricing Date Us
     C                   Z-ADD     *ZERO         WCR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WCAVQT                         Quantity Ordere
     C                   Z-ADD     *ZERO         WCD0WG                         Weight Ordered
     C                   Z-ADD     *ZERO         WCCCQT                         Quantity Schedu
     C                   Z-ADD     *ZERO         WCAUWG                         Weight Schedule
     C                   Z-ADD     *ZERO         WCCBQT                         Quantity Shippe
     C                   Z-ADD     *ZERO         WCATWG                         Weight Shipped
     C                   Z-ADD     *ZERO         WCAQCS                         Unit Cost Prici
     C                   Z-ADD     *ZERO         WCAGCS                         Unit Cost Per P
     C                   Z-ADD     *ZERO         WCAKPR                         Unit Price
     C                   Z-ADD     *ZERO         WCALPR                         Unit Price_Cred
     C                   Z-ADD     *ZERO         WCAUPR                         Unit Price Orde
     C                   Z-ADD     *ZERO         WCAVWG                         Unit Weight Ord
     C                   Z-ADD     *ZERO         WCA4WG                         Tare Weight Tot
     C                   Z-ADD     *ZERO         WCA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WCAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WCGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WCRGNB                         Item Structure
     C                   Z-ADD     *ZERO         WCRHNB                         Item Structure
     C                   Z-ADD     *ZERO         WCRINB                         Item Structure
     C                   Z-ADD     *ZERO         WCCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WCDUPR                         Invoice Unit Pr
     C                   Z-ADD     *ZERO         WCB6VL                         Invoice Extende
     C                   Z-ADD     *ZERO         WCA1AA                         Ham Group Numbe
     C                   Z-ADD     *ZERO         WCNTDT                         Warehouse Palle
     C                   Z-ADD     *ZERO         WCNUDT                         Consumed Item C
     C                   Z-ADD     *ZERO         WCNVDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WCNWDT                         OD Price Type R
     C                   Z-ADD     *ZERO         WCNXDT                         OD Firm Date
     C                   Z-ADD     *ZERO         WCBUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WCBVTM                         Price Code
     C                   Z-ADD     *ZERO         WCBWTM                         Maximum Net Wei
     C                   Z-ADD     *ZERO         WCBXTM                         Substitution Li
     C                   Z-ADD     *ZERO         WCBYTM                         Max Qty to sche
     C                   Z-ADD     *ZERO         WCH5NX                         Warehouse Palle
     C                   Z-ADD     *ZERO         WCH6NX                         Warehouse Avg P
     C                   Z-ADD     *ZERO         WCH7NX                         OD Item Target
     C                   Z-ADD     *ZERO         WCH8NX                         OD Estimated Gr
     C                   Z-ADD     *ZERO         WCH9NX                         OD Maximum Unit
     C                   Z-ADD     *ZERO         WCDVPR                         Order Gate_Fina
     C                   Z-ADD     *ZERO         WCDWPR                         OD Ceiling Pric
     C                   Z-ADD     *ZERO         WCDXPR                         OD Gate_Final P
     C                   Z-ADD     *ZERO         WCDYPR                         OD Weighted Avg
     C                   Z-ADD     *ZERO         WCDZPR                         OD Original Ord
     C                   Z-ADD     *ZERO         WCGSPR                         OD Cancel Date
     C                   Z-ADD     *ZERO         WCGTPR                         OD Unused Prc 7
     C                   Z-ADD     *ZERO         WCGUPR                         OD Unused Prc 8
     C                   Z-ADD     *ZERO         WCPEWG                         Weight Amount E
     C                   Z-ADD     *ZERO         WCRINY                         Item Age Days
     C                   Z-ADD     *ZERO         WCTIDT                         Production Ovr
     C                   Z-ADD     *ZERO         WCTJDT                         Production Ovr
     C                   Z-ADD     *ZERO         WCTKDT                         OD Market Begin
     C                   Z-ADD     *ZERO         WCTLDT                         OD Market Endin
     C                   Z-ADD     *ZERO         WCTMDT                         OD Atch to Ord
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDDBNB                         Warehouse Chill
     C                   Z-ADD     *ZERO         WDBWC3                         Shipping Compan
     C                   Z-ADD     *ZERO         WDBTC3                         Accounting Comp
     C                   Z-ADD     *ZERO         WDBUC3                         WHS Sched Prod
     C                   Z-ADD     *ZERO         WDBVC3                         WHS Inventory C
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WERMNB                         Load ID
     C                   Z-ADD     *ZERO         WERUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         WERVNB                         Stop_Drop
     C                   Z-ADD     *ZERO         WERWNB                         Miles to next s
     C                   Z-ADD     *ZERO         WERXNB                         Freight Charge
     C                   Z-ADD     *ZERO         WESQNB                         Ld Hdr_Ld Dtl U
     C                   Z-ADD     *ZERO         WET0NB                         Freight Misc_Ch
     C                   Z-ADD     *ZERO         WET1NB                         Freight Stop Ch
     C                   Z-ADD     *ZERO         WER1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WEAIC3                         Company Number
     C                   Z-ADD     *ZERO         WEC4NB                         Order Number
     C                   Z-ADD     *ZERO         WEKEDT                         Estimated Arriv
     C                   Z-ADD     *ZERO         WESXNB                         Estimated Arriv
     C                   Z-ADD     *ZERO         WEKFDT                         Appointment Con
     C                   Z-ADD     *ZERO         WEACTM                         Appointment Con
     C                   Z-ADD     *ZERO         WEEJDT                         Actual Delivery
     C                   Z-ADD     *ZERO         WEAGTM                         Actual Delivery
     C                   Z-ADD     *ZERO         WEKJDT                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WEATTM                         Scheduled Deliv
     C                   Z-ADD     *ZERO         WEHDDT                         Deadline Depart
     C                   Z-ADD     *ZERO         WEAUTM                         Deadline Depart
     C                   Z-ADD     *ZERO         WEKKDT                         On Yard Date
     C                   Z-ADD     *ZERO         WEAVTM                         On Yard Time
     C                   Z-ADD     *ZERO         WEZ4NB                         MPC Number
     C                   Z-ADD     *ZERO         WEN7DT                         LD Carrier Appt
     C                   Z-ADD     *ZERO         WEN8DT                         LD Unused Date
     C                   Z-ADD     *ZERO         WEN9DT                         LD Unused Date
     C                   Z-ADD     *ZERO         WEB3TM                         LD Carrier Appt
     C                   Z-ADD     *ZERO         WEB4TM                         LD Unused Time
     C                   Z-ADD     *ZERO         WEB5TM                         LD Unused Time
     C                   Z-ADD     *ZERO         WEAATM                         Job Time
     C                   Z-ADD     *ZERO         WEAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WFAIC3                         Company Number
     C                   Z-ADD     *ZERO         WFC4NB                         Order Number
     C                   Z-ADD     *ZERO         WFRMNB                         Load ID
     C                   Z-ADD     *ZERO         WFRUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         WFQWDT                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WFQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WFQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WFGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WFHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WFHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WFQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WFQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WFQ1DT                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WFQ2DT                         OHE Actual Ship
     C                   Z-ADD     *ZERO         WFITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WFQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WFQKNY                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WFQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WFP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WFP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WFQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WFQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WFQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WFQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WFQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WFQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WFQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WFQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WFQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WFW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WFW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WFAATM                         Job Time
     C                   Z-ADD     *ZERO         WFAXDT                         Job Date
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SBRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   EVAL      WL0002 = ' '
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
     C                   EVAL      WL0005 = ' '
      * Define local variables for subroutine SCRVGN.
     C                   Z-ADD     *ZERO         WL0006
     C                   Z-ADD     *ZERO         WL0007
     C                   Z-ADD     *ZERO         WL0008
     C                   Z-ADD     *ZERO         WL0009
     C                   EVAL      WL0010 = ' '
     C                   EVAL      WL0011 = ' '
      * Define local variables for subroutine SDRVGN.
     C                   EVAL      WL0012 = ' '
     C                   EVAL      WL0013 = ' '
     C                   EVAL      WL0014 = ' '
     C                   EVAL      WL0015 = ' '
     C                   EVAL      WL0016 = ' '
      * Define local variables for subroutine SFRVGN.
     C                   Z-ADD     *ZERO         WL0017
     C                   Z-ADD     *ZERO         WL0018
     C                   EVAL      WL0019 = ' '
     C                   EVAL      WL0020 = ' '
     C                   EVAL      WL0021 = ' '
      * Define local variables for subroutine SGRVGN.
     C                   Z-ADD     *ZERO         WL0022
     C                   Z-ADD     *ZERO         WL0023
     C                   EVAL      WL0024 = ' '
     C                   EVAL      WL0025 = ' '
      * Define local work field Order Upd to Held f/856 U
     C                   EVAL      YL0001 = ' '
      * Define local work field EDI Trading Partner No
     C                   EVAL      YL0002 = ' '
      * Define null work field Country Code
     C                   EVAL      YN0001 = ' '
      * Define null work field Warehouse Code
     C                   EVAL      YN0002 = ' '
      * Define null work field Warehouse Location
     C                   EVAL      YN0003 = ' '
      * Define local work field EDI Detailed ASN 856 Rqd
     C                   EVAL      YL0003 = ' '
      * Define local work field Record Status
     C                   EVAL      YL0004 = ' '
      * Define local work field Warehouse Code
     C                   EVAL      YL0005 = ' '
      * Define local work field Warehouse Location
     C                   EVAL      YL0006 = ' '
      * Define local work field WHS Live with Carlisle
     C                   EVAL      YL0007 = ' '
      * Define null work field WHS PFS Interface
     C                   EVAL      YN0004 = ' '
      * Define local work field Crt 856 ASN for 3PL Whse
     C                   EVAL      YL0008 = ' '
      * Define local work field Send EDI Document Y/N
     C                   EVAL      YL0009 = ' '
      * Define local work field Carrier Ref PRO_Inv
     C                   EVAL      YL0010 = ' '
      * Define local work field Cust Assigned Appt #
     C                   EVAL      YL0011 = ' '
      * Define null work field OHE EDI Error Reasons 2
     C                   EVAL      YN0005 = ' '
      * Define local work field OHE EDI 856 Action
     C                   EVAL      YL0012 = ' '
      * Define null work field OHE EDI 824 Action
     C                   EVAL      YN0006 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
