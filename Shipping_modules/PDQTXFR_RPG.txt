     H/TITLE Upd Balances Transfer  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 01/26/24  Time  : 12:33:27
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPUC6REL1IF  E           K        DISK
      * RTV : OMS Transformation Ctl    Retrieval index
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FCAB7CPL1IF  E           K        DISK
      * RTV : Item Transaction Detail   Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FCAB0REL0UF  E           K        DISK                      A
      * UPD : Item Balance              Update index
      *
      * Long constants
     E                    @CN#    1  11  6   @CN    25
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WBAIC3
     I              B0HGCD                          WBHGCD
     I              B0AJCD                          WBAJCD
     I              B0AGCS                          WBAGCS
     I              B0AECS                          WBAECS
     I              B0BACS                          WBBACS
     I              B0BBCS                          WBBBCS
     I              B0CBPR                          WBCBPR
     I              B0GUDT                          WBGUDT
     I              B0XYST                          WBXYST
     I              B0CTPR                          WBCTPR
     I              B0G4DT                          WBG4DT
     I              B0BOWG                          WBBOWG
     I              B0DDQT                          WBDDQT
     I              B0DEQT                          WBDEQT
     I              B0DFQT                          WBDFQT
     I              B0HDQT                          WBHDQT
     I              B0HEQT                          WBHEQT
     I              B0AJQT                          WBAJQT
     I              B0AQQT                          WBAQQT
     I              B0AUQT                          WBAUQT
     I              B0EMQT                          WBEMQT
     I              B0DOQT                          WBDOQT
     I              B0ATNA                          WBATNA
     I              B0AKDT                          WBAKDT
     I              B0ANDT                          WBANDT
     I              B0IDVA                          WBIDVA
     I              B0JVST                          WBJVST
     I              B0BZPC                          WBBZPC
     I              B0DGQT                          WBDGQT
     I              B0DIDT                          WBDIDT
     I              B0ALCD                          WBALCD
     I              B0BFDY                          WBBFDY
     I              B0DJDT                          WBDJDT
     I              B0BGDY                          WBBGDY
     I              B0DKDT                          WBDKDT
     I              B0J2ST                          WBJ2ST
     I              B0DJQT                          WBDJQT
     I              B0BNWG                          WBBNWG
     I              B0DLDT                          WBDLDT
     I              B0DPQT                          WBDPQT
     I              B0DQQT                          WBDQQT
     I              B0DMDT                          WBDMDT
     I              B0M0ST                          WBM0ST
     I              B0J9ST                          WBJ9ST
     I              B0KBST                          WBKBST
     I              B0AKC8                          WBAKC8
     I              B0RINB                          WBRINB
     I              B0RHNB                          WBRHNB
     I              B0RGNB                          WBRGNB
     I              B0UVST                          WBUVST
     I              B0UWST                          WBUWST
     I              B0UXST                          WBUXST
     I              B0VSST                          WBVSST
     I              B0AATM                          WBAATM
     I              B0AYNA                          WBAYNA
     I              B0A0NA                          WBA0NA
     I              B0AXDT                          WBAXDT
      *
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WCAIC3
     I              ASAXNB                          WCAXNB
     I              ASNGNB                          WCNGNB
     I              ASBZNB                          WCBZNB
     I              ASC5NB                          WCC5NB
     I              ASC3NB                          WCC3NB
     I              ASCYNB                          WCCYNB
     I              ASIONB                          WCIONB
     I              ASI6NB                          WCI6NB
     I              ASDCNB                          WCDCNB
     I              ASC7NB                          WCC7NB
     I              ASC2NB                          WCC2NB
     I              ASC1NB                          WCC1NB
     I              ASL8NB                          WCL8NB
     I              ASBANB                          WCBANB
     I              ASCHST                          WCCHST
     I              ASCKST                          WCCKST
     I              ASCIST                          WCCIST
     I              ASCGST                          WCCGST
     I              ASAIPC                          WCAIPC
     I              ASASPC                          WCASPC
     I              ASA2VA                          WCA2VA
     I              ASC2ST                          WCC2ST
     I              ASD8ST                          WCD8ST
     I              ASD7ST                          WCD7ST
     I              ASA8NA                          WCA8NA
     I              ASA9NA                          WCA9NA
     I              ASBANA                          WCBANA
     I              ASBBNA                          WCBBNA
     I              ASEUST                          WCEUST
     I              ASAADY                          WCAADY
     I              ASABDY                          WCABDY
     I              ASACDY                          WCACDY
     I              ASADDY                          WCADDY
     I              ASAEDY                          WCAEDY
     I              ASAFDY                          WCAFDY
     I              ASAGDY                          WCAGDY
     I              ASAHDY                          WCAHDY
     I              ASAENB                          WCAENB
     I              ASALNB                          WCALNB
     I              ASEVNB                          WCEVNB
     I              ASRPOP                          WCRPOP
     I              ASDWNB                          WCDWNB
     I              ASR3NB                          WCR3NB
     I              ASPNST                          WCPNST
     I              ASR4NB                          WCR4NB
     I              ASPOST                          WCPOST
     I              ASSCNB                          WCSCNB
     I              ASVIST                          WCVIST
     I              ASVJST                          WCVJST
     I              ASBVVN                          WCBVVN
     I              ASUVST                          WCUVST
     I              ASUWST                          WCUWST
     I              ASUXST                          WCUXST
     I              ASVSST                          WCVSST
     I              ASAATM                          WCAATM
     I              ASAYNA                          WCAYNA
     I              ASA0NA                          WCA0NA
     I              ASAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@C6REMK
      * OMS Transformation Ctl    Retrieval index
      * Renamed input format fields
     I              C6B3AB                          WEB3AB
     I              C6HUNZ                          WEHUNZ
     I              C6OCSC                          WEOCSC
     I              C6UNU1                          WEUNU1
     I              C6VSST                          WEVSST
     I              C6BGTS                          WEBGTS
     I              C6RUU1                          WERUU1
     I              C6RVU1                          WERVU1
     I              C6BHTS                          WEBHTS
     I              C6RWU1                          WERWU1
     I              C6RXU1                          WERXU1
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WGAIC3
     I              B7HGCD                          WGHGCD
     I              B7AJCD                          WGAJCD
     I              B7W9ST                          WGW9ST
     I              B7BSST                          WGBSST
     I              B7B4DT                          WGB4DT
     I              B7C4NY                          WGC4NY
     I              B7DXNB                          WGDXNB
     I              B7ELDT                          WGELDT
     I              B7HVCD                          WGHVCD
     I              B7F1ST                          WGF1ST
     I              B7AUNA                          WGAUNA
     I              B7A5QT                          WGA5QT
     I              B7AHWG                          WGAHWG
     I              B7AKCS                          WGAKCS
     I              B7CGCD                          WGCGCD
     I              B7AYVA                          WGAYVA
     I              B7BJNA                          WGBJNA
     I              B7CKNB                          WGCKNB
     I              B7BMST                          WGBMST
     I              B7CQCD                          WGCQCD
     I              B7DTCD                          WGDTCD
     I              B7MGNA                          WGMGNA
     I              B7TRBN                          WGTRBN
     I              B7TRBS                          WGTRBS
     I              B7C4NB                          WGC4NB
     I              B7RINB                          WGRINB
     I              B7RHNB                          WGRHNB
     I              B7RGNB                          WGRGNB
     I              B7M3NA                          WGM3NA
     I              B7AWTM                          WGAWTM
     I              B7XLCD                          WGXLCD
     I              B7K7DT                          WGK7DT
     I              B7UVST                          WGUVST
     I              B7UWST                          WGUWST
     I              B7UXST                          WGUXST
     I              B7VSST                          WGVSST
     I              B7AATM                          WGAATM
     I              B7AYNA                          WGAYNA
     I              B7A0NA                          WGA0NA
     I              B7AXDT                          WGAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WJAIC3
     I              B1HGCD                          WJHGCD
     I              B1AJCD                          WJAJCD
     I              B1ELDT                          WJELDT
     I              B1ABWG                          WJABWG
     I              B1AGQT                          WJAGQT
     I              B1AHQT                          WJAHQT
     I              B1AIQT                          WJAIQT
     I              B1CTST                          WJCTST
     I              B1ACWG                          WJACWG
     I              B1ARQT                          WJARQT
     I              B1ASQT                          WJASQT
     I              B1ATQT                          WJATQT
     I              B1HDQT                          WJHDQT
     I              B1HEQT                          WJHEQT
     I              B1F6ST                          WJF6ST
     I              B1BMWG                          WJBMWG
     I              B1DSQT                          WJDSQT
     I              B1DTQT                          WJDTQT
     I              B1DUQT                          WJDUQT
     I              B1DHDT                          WJDHDT
     I              B1AGCS                          WJAGCS
     I              B1AECS                          WJAECS
     I              B1IDVA                          WJIDVA
     I              B1K7DT                          WJK7DT
     I              B1RINB                          WJRINB
     I              B1RHNB                          WJRHNB
     I              B1RGNB                          WJRGNB
     I              B1UVST                          WJUVST
     I              B1UWST                          WJUWST
     I              B1UXST                          WJUXST
     I              B1VSST                          WJVSST
     I              B1AATM                          WJAATM
     I              B1AYNA                          WJAYNA
     I              B1A0NA                          WJA0NA
     I              B1AXDT                          WJAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WKAIC3
     I              B0HGCD                          WKHGCD
     I              B0AJCD                          WKAJCD
     I              B0AGCS                          WKAGCS
     I              B0AECS                          WKAECS
     I              B0BACS                          WKBACS
     I              B0BBCS                          WKBBCS
     I              B0CBPR                          WKCBPR
     I              B0GUDT                          WKGUDT
     I              B0XYST                          WKXYST
     I              B0CTPR                          WKCTPR
     I              B0G4DT                          WKG4DT
     I              B0BOWG                          WKBOWG
     I              B0DDQT                          WKDDQT
     I              B0DEQT                          WKDEQT
     I              B0DFQT                          WKDFQT
     I              B0HDQT                          WKHDQT
     I              B0HEQT                          WKHEQT
     I              B0AJQT                          WKAJQT
     I              B0AQQT                          WKAQQT
     I              B0AUQT                          WKAUQT
     I              B0EMQT                          WKEMQT
     I              B0DOQT                          WKDOQT
     I              B0ATNA                          WKATNA
     I              B0AKDT                          WKAKDT
     I              B0ANDT                          WKANDT
     I              B0IDVA                          WKIDVA
     I              B0JVST                          WKJVST
     I              B0BZPC                          WKBZPC
     I              B0DGQT                          WKDGQT
     I              B0DIDT                          WKDIDT
     I              B0ALCD                          WKALCD
     I              B0BFDY                          WKBFDY
     I              B0DJDT                          WKDJDT
     I              B0BGDY                          WKBGDY
     I              B0DKDT                          WKDKDT
     I              B0J2ST                          WKJ2ST
     I              B0DJQT                          WKDJQT
     I              B0BNWG                          WKBNWG
     I              B0DLDT                          WKDLDT
     I              B0DPQT                          WKDPQT
     I              B0DQQT                          WKDQQT
     I              B0DMDT                          WKDMDT
     I              B0M0ST                          WKM0ST
     I              B0J9ST                          WKJ9ST
     I              B0KBST                          WKKBST
     I              B0AKC8                          WKAKC8
     I              B0RINB                          WKRINB
     I              B0RHNB                          WKRHNB
     I              B0RGNB                          WKRGNB
     I              B0UVST                          WKUVST
     I              B0UWST                          WKUWST
     I              B0UXST                          WKUXST
     I              B0VSST                          WKVSST
     I              B0AATM                          WKAATM
     I              B0AYNA                          WKAYNA
     I              B0A0NA                          WKA0NA
     I              B0AXDT                          WKAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          WLAJCD
     I              L2YMCD                          WLYMCD
     I              L2YPCD                          WLYPCD
     I              L2LCBY                          WLLCBY
     I              L2LCCT                          WLLCCT
     I              L2WLUS                          WLWLUS
     I              L2WUSD                          WLWUSD
     I              L2WLUN                          WLWLUN
     I              L2AGSX                          WLAGSX
     I              L2UVST                          WLUVST
     I              L2UWST                          WLUWST
     I              L2UXST                          WLUXST
     I              L2VSST                          WLVSST
     I              L2AATM                          WLAATM
     I              L2AYNA                          WLAYNA
     I              L2A0NA                          WLA0NA
     I              L2AXDT                          WLAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WMAIC3
     I              B0HGCD                          WMHGCD
     I              B0AJCD                          WMAJCD
     I              B0AGCS                          WMAGCS
     I              B0AECS                          WMAECS
     I              B0BACS                          WMBACS
     I              B0BBCS                          WMBBCS
     I              B0CBPR                          WMCBPR
     I              B0GUDT                          WMGUDT
     I              B0XYST                          WMXYST
     I              B0CTPR                          WMCTPR
     I              B0G4DT                          WMG4DT
     I              B0BOWG                          WMBOWG
     I              B0DDQT                          WMDDQT
     I              B0DEQT                          WMDEQT
     I              B0DFQT                          WMDFQT
     I              B0HDQT                          WMHDQT
     I              B0HEQT                          WMHEQT
     I              B0AJQT                          WMAJQT
     I              B0AQQT                          WMAQQT
     I              B0AUQT                          WMAUQT
     I              B0EMQT                          WMEMQT
     I              B0DOQT                          WMDOQT
     I              B0ATNA                          WMATNA
     I              B0AKDT                          WMAKDT
     I              B0ANDT                          WMANDT
     I              B0IDVA                          WMIDVA
     I              B0JVST                          WMJVST
     I              B0BZPC                          WMBZPC
     I              B0DGQT                          WMDGQT
     I              B0DIDT                          WMDIDT
     I              B0ALCD                          WMALCD
     I              B0BFDY                          WMBFDY
     I              B0DJDT                          WMDJDT
     I              B0BGDY                          WMBGDY
     I              B0DKDT                          WMDKDT
     I              B0J2ST                          WMJ2ST
     I              B0DJQT                          WMDJQT
     I              B0BNWG                          WMBNWG
     I              B0DLDT                          WMDLDT
     I              B0DPQT                          WMDPQT
     I              B0DQQT                          WMDQQT
     I              B0DMDT                          WMDMDT
     I              B0M0ST                          WMM0ST
     I              B0J9ST                          WMJ9ST
     I              B0KBST                          WMKBST
     I              B0AKC8                          WMAKC8
     I              B0RINB                          WMRINB
     I              B0RHNB                          WMRHNB
     I              B0RGNB                          WMRGNB
     I              B0UVST                          WMUVST
     I              B0UWST                          WMUWST
     I              B0UXST                          WMUXST
     I              B0VSST                          WMVSST
     I              B0AATM                          WMAATM
     I              B0AYNA                          WMAYNA
     I              B0A0NA                          WMA0NA
     I              B0AXDT                          WMAXDT
      *
     IRB7CPJ3
      * Item Transaction Detail   Retrieval index       NV
      * Renamed input format fields
     I              B7AIC3                          WOAIC3
     I              B7HGCD                          WOHGCD
     I              B7AJCD                          WOAJCD
     I              B7W9ST                          WOW9ST
     I              B7BSST                          WOBSST
     I              B7B4DT                          WOB4DT
     I              B7C4NY                          WOC4NY
     I              B7DXNB                          WODXNB
     I              B7ELDT                          WOELDT
     I              B7HVCD                          WOHVCD
     I              B7F1ST                          WOF1ST
     I              B7AUNA                          WOAUNA
     I              B7A5QT                          WOA5QT
     I              B7AHWG                          WOAHWG
     I              B7AKCS                          WOAKCS
     I              B7CGCD                          WOCGCD
     I              B7AYVA                          WOAYVA
     I              B7BJNA                          WOBJNA
     I              B7CKNB                          WOCKNB
     I              B7BMST                          WOBMST
     I              B7CQCD                          WOCQCD
     I              B7DTCD                          WODTCD
     I              B7MGNA                          WOMGNA
     I              B7TRBN                          WOTRBN
     I              B7TRBS                          WOTRBS
     I              B7C4NB                          WOC4NB
     I              B7RINB                          WORINB
     I              B7RHNB                          WORHNB
     I              B7RGNB                          WORGNB
     I              B7M3NA                          WOM3NA
     I              B7AWTM                          WOAWTM
     I              B7XLCD                          WOXLCD
     I              B7K7DT                          WOK7DT
     I              B7UVST                          WOUVST
     I              B7UWST                          WOUWST
     I              B7UXST                          WOUXST
     I              B7VSST                          WOVSST
     I              B7AATM                          WOAATM
     I              B7AYNA                          WOAYNA
     I              B7A0NA                          WOA0NA
     I              B7AXDT                          WOAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WRAIC3
     I              B1HGCD                          WRHGCD
     I              B1AJCD                          WRAJCD
     I              B1ELDT                          WRELDT
     I              B1ABWG                          WRABWG
     I              B1AGQT                          WRAGQT
     I              B1AHQT                          WRAHQT
     I              B1AIQT                          WRAIQT
     I              B1CTST                          WRCTST
     I              B1ACWG                          WRACWG
     I              B1ARQT                          WRARQT
     I              B1ASQT                          WRASQT
     I              B1ATQT                          WRATQT
     I              B1HDQT                          WRHDQT
     I              B1HEQT                          WRHEQT
     I              B1F6ST                          WRF6ST
     I              B1BMWG                          WRBMWG
     I              B1DSQT                          WRDSQT
     I              B1DTQT                          WRDTQT
     I              B1DUQT                          WRDUQT
     I              B1DHDT                          WRDHDT
     I              B1AGCS                          WRAGCS
     I              B1AECS                          WRAECS
     I              B1IDVA                          WRIDVA
     I              B1K7DT                          WRK7DT
     I              B1RINB                          WRRINB
     I              B1RHNB                          WRRHNB
     I              B1RGNB                          WRRGNB
     I              B1UVST                          WRUVST
     I              B1UWST                          WRUWST
     I              B1UXST                          WRUXST
     I              B1VSST                          WRVSST
     I              B1AATM                          WRAATM
     I              B1AYNA                          WRAYNA
     I              B1A0NA                          WRA0NA
     I              B1AXDT                          WRAXDT
      *
     I@DPRETD
      * System Values             Retrieval index       NV
      * Renamed input format fields
     I              DPDOCD                          WSDOCD
     I              DPAUNA                          WSAUNA
     I              DPI5ST                          WSI5ST
     I              DPBXTX                          WSBXTX
     I              DPM8NB                          WSM8NB
     I              DPUVST                          WSUVST
     I              DPUWST                          WSUWST
     I              DPUXST                          WSUXST
     I              DPVSST                          WSVSST
     I              DPAATM                          WSAATM
     I              DPAYNA                          WSAYNA
     I              DPA0NA                          WSA0NA
     I              DPAXDT                          WSAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WCAIC3
     I              ASAXNB                          WCAXNB
     I              ASNGNB                          WCNGNB
     I              ASBZNB                          WCBZNB
     I              ASC5NB                          WCC5NB
     I              ASC3NB                          WCC3NB
     I              ASCYNB                          WCCYNB
     I              ASIONB                          WCIONB
     I              ASI6NB                          WCI6NB
     I              ASDCNB                          WCDCNB
     I              ASC7NB                          WCC7NB
     I              ASC2NB                          WCC2NB
     I              ASC1NB                          WCC1NB
     I              ASL8NB                          WCL8NB
     I              ASBANB                          WCBANB
     I              ASCHST                          WCCHST
     I              ASCKST                          WCCKST
     I              ASCIST                          WCCIST
     I              ASCGST                          WCCGST
     I              ASAIPC                          WCAIPC
     I              ASASPC                          WCASPC
     I              ASA2VA                          WCA2VA
     I              ASC2ST                          WCC2ST
     I              ASD8ST                          WCD8ST
     I              ASD7ST                          WCD7ST
     I              ASA8NA                          WCA8NA
     I              ASA9NA                          WCA9NA
     I              ASBANA                          WCBANA
     I              ASBBNA                          WCBBNA
     I              ASEUST                          WCEUST
     I              ASAADY                          WCAADY
     I              ASABDY                          WCABDY
     I              ASACDY                          WCACDY
     I              ASADDY                          WCADDY
     I              ASAEDY                          WCAEDY
     I              ASAFDY                          WCAFDY
     I              ASAGDY                          WCAGDY
     I              ASAHDY                          WCAHDY
     I              ASAENB                          WCAENB
     I              ASALNB                          WCALNB
     I              ASEVNB                          WCEVNB
     I              ASRPOP                          WCRPOP
     I              ASDWNB                          WCDWNB
     I              ASR3NB                          WCR3NB
     I              ASPNST                          WCPNST
     I              ASR4NB                          WCR4NB
     I              ASPOST                          WCPOST
     I              ASSCNB                          WCSCNB
     I              ASVIST                          WCVIST
     I              ASVJST                          WCVJST
     I              ASBVVN                          WCBVVN
     I              ASUVST                          WCUVST
     I              ASUWST                          WCUWST
     I              ASUXST                          WCUXST
     I              ASVSST                          WCVSST
     I              ASAATM                          WCAATM
     I              ASAYNA                          WCAYNA
     I              ASA0NA                          WCA0NA
     I              ASAXDT                          WCAXDT
      *
     IYARDCS      DS                            278
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WGAIC3
     I              B7HGCD                          WGHGCD
     I              B7AJCD                          WGAJCD
     I              B7W9ST                          WGW9ST
     I              B7BSST                          WGBSST
     I              B7B4DT                          WGB4DT
     I              B7C4NY                          WGC4NY
     I              B7DXNB                          WGDXNB
     I              B7ELDT                          WGELDT
     I              B7HVCD                          WGHVCD
     I              B7F1ST                          WGF1ST
     I              B7AUNA                          WGAUNA
     I              B7A5QT                          WGA5QT
     I              B7AHWG                          WGAHWG
     I              B7AKCS                          WGAKCS
     I              B7CGCD                          WGCGCD
     I              B7AYVA                          WGAYVA
     I              B7BJNA                          WGBJNA
     I              B7CKNB                          WGCKNB
     I              B7BMST                          WGBMST
     I              B7CQCD                          WGCQCD
     I              B7DTCD                          WGDTCD
     I              B7MGNA                          WGMGNA
     I              B7TRBN                          WGTRBN
     I              B7TRBS                          WGTRBS
     I              B7C4NB                          WGC4NB
     I              B7RINB                          WGRINB
     I              B7RHNB                          WGRHNB
     I              B7RGNB                          WGRGNB
     I              B7M3NA                          WGM3NA
     I              B7AWTM                          WGAWTM
     I              B7XLCD                          WGXLCD
     I              B7K7DT                          WGK7DT
     I              B7UVST                          WGUVST
     I              B7UWST                          WGUWST
     I              B7UXST                          WGUXST
     I              B7VSST                          WGVSST
     I              B7AATM                          WGAATM
     I              B7AYNA                          WGAYNA
     I              B7A0NA                          WGA0NA
     I              B7AXDT                          WGAXDT
      *
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     IYBRDCS      DS                            163
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WKAIC3
     I              B0HGCD                          WKHGCD
     I              B0AJCD                          WKAJCD
     I              B0AGCS                          WKAGCS
     I              B0AECS                          WKAECS
     I              B0BACS                          WKBACS
     I              B0BBCS                          WKBBCS
     I              B0CBPR                          WKCBPR
     I              B0GUDT                          WKGUDT
     I              B0XYST                          WKXYST
     I              B0CTPR                          WKCTPR
     I              B0G4DT                          WKG4DT
     I              B0BOWG                          WKBOWG
     I              B0DDQT                          WKDDQT
     I              B0DEQT                          WKDEQT
     I              B0DFQT                          WKDFQT
     I              B0HDQT                          WKHDQT
     I              B0HEQT                          WKHEQT
     I              B0AJQT                          WKAJQT
     I              B0AQQT                          WKAQQT
     I              B0AUQT                          WKAUQT
     I              B0EMQT                          WKEMQT
     I              B0DOQT                          WKDOQT
     I              B0ATNA                          WKATNA
     I              B0AKDT                          WKAKDT
     I              B0ANDT                          WKANDT
     I              B0IDVA                          WKIDVA
     I              B0JVST                          WKJVST
     I              B0BZPC                          WKBZPC
     I              B0DGQT                          WKDGQT
     I              B0DIDT                          WKDIDT
     I              B0ALCD                          WKALCD
     I              B0BFDY                          WKBFDY
     I              B0DJDT                          WKDJDT
     I              B0BGDY                          WKBGDY
     I              B0DKDT                          WKDKDT
     I              B0J2ST                          WKJ2ST
     I              B0DJQT                          WKDJQT
     I              B0BNWG                          WKBNWG
     I              B0DLDT                          WKDLDT
     I              B0DPQT                          WKDPQT
     I              B0DQQT                          WKDQQT
     I              B0DMDT                          WKDMDT
     I              B0M0ST                          WKM0ST
     I              B0J9ST                          WKJ9ST
     I              B0KBST                          WKKBST
     I              B0AKC8                          WKAKC8
     I              B0RINB                          WKRINB
     I              B0RHNB                          WKRHNB
     I              B0RGNB                          WKRGNB
     I              B0UVST                          WKUVST
     I              B0UWST                          WKUWST
     I              B0UXST                          WKUXST
     I              B0VSST                          WKVSST
     I              B0AATM                          WKAATM
     I              B0AYNA                          WKAYNA
     I              B0A0NA                          WKA0NA
     I              B0AXDT                          WKAXDT
      *
     IYCRDCS      DS                            245
     IYDRDCS      DS                            245
     IYERDCS      DS                            163
      * Outward parameters
     IPARC        DS                            157
      * RCD : PAR API WIM Inv Shipping2
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Ship From Warehouse
     I                                        7   9 PAVPCD
      * I :  WIM Inventory Trans ID
     I                                       10  12 PANOSC
      * I :  WIM Inventory Trans Type
     I                                       13  15 PANPSC
      * I :  Transaction Date
     I                                    P  16  190PAA9DT
      * I :  Production Date
     I                                    P  20  230PAELDT
      * I :  Item Transaction Source
     I                                       24  25 PAF1ST
      * I :  Transaction Description
     I                                       26  55 PAVQNA
      * I :  Transaction Reason Code
     I                                       56  58 PAA1AB
      * I :  Order Number
     I                                    P  59  620PAC4NB
      * I :  Shift Number
     I                                       63  63 PAXLCD
      * I :  Ship To Warehouse
     I                                       64  66 PAL9AA
      * I :  Transaction Weight
     I                                    P  67  722PAAHWG
      * I :  Transaction Quantity
     I                                    P  73  782PAA5QT
      * I :  USR Unship Flag
     I                                       79  79 PAUSST
      * I :  Inter-Plant Transfer USR
     I                                       80  80 PAA5TX
      * O :  API EccResult-MsgId U
     I                                       81  87 PACLAB
      * O :  API EccResult-MsgDesc U
     I                                       88 137 PAVGU1
      * B :  API Request Key U
     I                                      138 147 PACKAB
      * I :  API Mode U
     I                                      148 157 PACJAB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Transaction Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
      * I :  Warehouse Code
     I                                        7   9 P1AJCD
      * I :  Inventory Trans ID
     I                                       10  10 P1W9ST
      * I :  Inventory Trans Type
     I                                       11  12 P1BSST
      * I :  Transaction Date Code
     I                                    P  13  160P1B4DT
      * I :  Production Date
     I                                    P  17  200P1ELDT
      * I :  Item Transaction Source
     I                                       21  22 P1F1ST
      * I :  Description
     I                                       23  52 P1AUNA
      * N :  Transaction Quantity
     I                                    P  53  582P1A5QT
      * N :  Transaction Weight
     I                                    P  59  642P1AHWG
      * I :  Reason Code
     I                                       65  67 P1CQCD
      * N :  Transfer Batch Number
     I                                    P  68  710P1TRBN
      * N :  Transfer Batch Sequence
     I                                    P  72  730P1TRBS
      * I :  Order Number
     I                                    P  74  770P1C4NB
      * I :  Shift Number
     I                                       78  78 P1XLCD
      * I :  Label Date
     I                                    P  79  820P1K7DT
     IP2PARM      DS
      * FLD: Company Item
      * N :  UOM Primary
     I                                        1   2 P2ADCD
      * N :  Conversion Factor 1
     I                                    P   3   74P2AWPC
      * N :  Operation Factor 1
     I                                        8   8 P2LXST
      * N :  UOM Second
     I                                        9  10 P2AECD
      * N :  Conversion Factor 2
     I                                    P  11  154P2AXPC
      * N :  Operation Factor 2
     I                                       16  16 P2LYST
      * N :  UOM Third
     I                                       17  18 P2AFCD
      * N :  UOM Pricing
     I                                       19  20 P2AICD
      * N :  Unit Weight
     I                                    P  21  262P2AIWG
      * N :  Production Date Control
     I                                       27  27 P2FZST
      * N :  Catch Weight Status
     I                                       28  28 P2AVST
     IP3PARM      DS
      * I :  USR Warehouse Code
     I                                        1   3 P3CPCD
     IP4PARM      DS
      * I :  USR Weight Accumulated
     I                                    P   1   62P4CDWG
     IP5PARM      DS
      * I :  USR Quantity
     I                                    P   1   62P5BAQT
     IP6PARM      DS
      * FLD: Item Balance
      * N :  Unit Cost Per Pound
     I                                    P   1   64P6AGCS
     IP7PARM      DS
      * N :  Unit Cost - Detail
     I                                    P   1   64P7ARCS
     IP8PARM      DS
      * FLD: *Arrays
      * I :  USR Unship Flag
     I                                        1   1 P8USST
      * I :  Inter-Plant Transfer USR
     I                                        2   2 P8A5TX
      * O :  Inventory Updated USR
     I                                        3   3 P8ORSC
      * O :  API was Called? U
     I                                        4   4 P8OQSC
      * I :  Called From Program
     I                                        5  14 P8COAB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1AJCD    PARM           WP0003  3        Warehouse Code
     C           P1W9ST    PARM           WP0004  1        Inventory Trans
     C           P1BSST    PARM           WP0005  2        Inventory Trans
     C           P1B4DT    PARM           WP0006  70       Transaction Dat
     C           P1ELDT    PARM           WP0007  70       Production Date
     C           P1F1ST    PARM           WP0008  2        Item Transactio
     C           P1AUNA    PARM           WP0009 30        Description
     C           P1CQCD    PARM           WP0010  3        Reason Code
     C           P1C4NB    PARM           WP0011  70       Order Number
     C           P1XLCD    PARM           WP0012  1        Shift Number
     C           P1K7DT    PARM           WP0013  70       Label Date
     C           P3CPCD    PARM           WP0014  3        USR Warehouse C
     C           P4CDWG    PARM           WP0015 112       USR Weight Accu
     C           P5BAQT    PARM           WP0016 112       USR Quantity
     C           P8USST    PARM           WP0017  1        USR Unship Flag
     C           P8A5TX    PARM           WP0018  1        Inter-Plant Tra
     C                     PARM P8ORSC    WP0019  1        Inventory Updat
     C                     PARM P8OQSC    WP0020  1        API was Called?
     C           P8COAB    PARM           WP0021 10        Called From Pro
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Balances Transfer  XF
     C                     Z-ADDP5BAQT    P1A5QT           Transaction Qua
     C                     Z-ADDP4CDWG    P1AHWG           Transaction Wei
     C                     Z-ADD1         P1TRBS           Transfer Batch
      * Rtv Base Values        RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1HGCD    WL0002           Item Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUAWNA    P      Description Lin
     C                     MOVELWL0005    P2ADCD    P      UOM Primary
     C                     Z-ADDWL0006    P2AWPC           Conversion Fact
     C                     MOVELWL0007    P2LXST    P      Operation Facto
     C                     MOVELWL0008    P2AECD    P      UOM Second
     C                     Z-ADDWL0009    P2AXPC           Conversion Fact
     C                     MOVELWL0010    P2LYST    P      Operation Facto
     C                     MOVELWL0011    P2AFCD    P      UOM Third
     C                     MOVELWL0012    P2AICD    P      UOM Pricing
     C                     Z-ADDWL0013    P2AIWG           Unit Weight
     C                     MOVELWL0014    P2FZST    P      Production Date
     C                     MOVELWL0015    P2AVST    P      Catch Weight St
     C                     Z-ADDWL0016    WUCHTM           Fresh Chilling
      * get FROM Whse unit cost
      * RTV Unit Cost          RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0017           Company Number
     C                     Z-ADDP1HGCD    WL0018           Item Code
     C                     MOVELP1AJCD    WL0019    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    P6AGCS           Unit Cost Per P
      * Rtv Next Tran Batch #  CH - Company Control  * 
     C                     EXSR SCCHRC
      * get TO Whse unit cost
      * RTV Unit Cost          RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0017           Company Number
     C                     Z-ADDP1HGCD    WL0018           Item Code
     C                     MOVELP3CPCD    WL0019    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    P7ARCS           Unit Cost Per P
      * ** Get load id, put into lot#                  FP1127
      * ** Lot Number will go into the From Warehouse record
      * ** Lot Number Usr will go into the To Warehouse record
      * RTV Load ID            RT - Order Header TRG  * 
     C                     EXSR SDRVGN
     C                     Z-ADDWURMNB    WULTNT           Lot Number USR
     C                     Z-ADD*ZERO     WULXNM           Lot Number
      * 10/05/23 DN WI517-Added 'Inventory Updated USR', API was Called?
      *   & 'Called From Program' Parms.
      *
     C                     Z-ADD*ZERO     WN0059  30       Item Structure
     C                     Z-ADD*ZERO     WN0060  30       Item Structure
     C                     Z-ADD*ZERO     WN0061  30       Item Structure
     C                     Z-ADD*ZERO     WN0062  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0063  30       Sequence Number
     C                     Z-ADD*ZERO     WN0064 114       USR Transaction
     C                     Z-ADD*ZERO     WN0065 112       Extended Amount
     C                     Z-ADD*ZERO     WN0066 112       Quantity based
     C                     Z-ADD*ZERO     WN0067 112       Quantity based
     C                     Z-ADD*ZERO     WN0068 112       Quantity based
     C                     Z-ADD*ZERO     WN0069 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0070 112       On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0071 112       Value of On Han
     C                     Z-ADD*ZERO     WN0072  70       Production Date
     C                     Z-ADD*ZERO     WN0073  70       Label Date  USR
     C                     MOVEL*BLANK    WN0074  3        USR Reason Code
      *
      * UPD Balances Transfer  IF
      * NOTES: WI517 DN 10/09/23-Per Business (Ace C./Ryan H.), we will N
      *        pass in the 'negative' Qty/Wgt when processing the WIM API
      *        WIM API logic will handle this scenario.
      * WI517 DN 07/05/23-Get WIM Module Release Status.
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
     C                     EXSR SERVGN
     C                     MOVEL'N'       P8ORSC           Inventory Updat
     C                     MOVEL'N'       P8OQSC           API was Called?
      * WI517 DN 10/09/23-Save Original Transaction Qty/Wgt in LCL contex
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5QT    YL0002           Transaction Qua
     C                     Z-ADDP1AHWG    YL0003           Transaction Wei
      * 08/10/23 DN WI517-Call Existing Legacy Process.
      * CASE: *OTHERWISE
     C                     MOVELP1CQCD    WN0074           USR Reason Code
      * Error if FROM unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           P6AGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0074           USR Reason Code
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0075 112       Quantity based
     C                     Z-ADD*ZERO     WN0076 112       Quantity based
     C                     Z-ADD*ZERO     WN0077 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0066           USR Qty based o
     C                     Z-ADD*ZERO     WN0067           USR Qty based o
     C                     Z-ADD*ZERO     WN0068           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           P2ADCD    IFEQ P2ADCD                     *IF
     C                     Z-ADDP1A5QT    WN0066           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           P2AECD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
     C           P1A5QT    MULT P2AWPC    WN0076    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P1A5QT    DIV  P2AWPC    WN0076    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0076    WN0067           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           WN0076    MULT P2AXPC    WN0077    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           WN0076    DIV  P2AXPC    WN0077    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0077    WN0068           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           P2AECD    IFEQ P2ADCD                     *IF
     C                     Z-ADDP1A5QT    WN0067           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           P1A5QT    DIV  P2AWPC    WN0066    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           P1A5QT    MULT P2AWPC    WN0066    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P2AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
     C           P1A5QT    MULT P2AXPC    WN0077    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P1A5QT    DIV  P2AXPC    WN0077    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0077    WN0068           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           P2AFCD    IFEQ P2ADCD                     *IF
     C                     Z-ADDP1A5QT    WN0068           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P2LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P2AXPC    IFNE 0                          *IF
     C           P1A5QT    DIV  P2AXPC    WN0076    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P2LYST    IFEQ 'D'                        *IF
     C           P1A5QT    MULT P2AXPC    WN0076    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0076    WN0067           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P2LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P2AWPC    IFNE 0                          *IF
     C           WN0076    DIV  P2AWPC    WN0066    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P2LXST    IFEQ 'D'                        *IF
     C           WN0076    MULT P2AWPC    WN0066    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P6AGCS    MULT P1AHWG    WN0065    H      Extended Amount
      * Adjust sign of transaction based on transaction type
      * CASE: PAR.Inventory Trans. Type is Transfer Warehouse
     C           P1BSST    IFEQ 'TW'                       *IF
     C                     ADD  1         P1TRBS           Transfer Batch
     C                     Z-ADDP1AHWG    WUAHWG           Transaction Wei
     C                     Z-ADDP1A5QT    WUA5QT           Transaction Qua
      * CASE: PAR.USR Unship Flag is yes
     C           P8USST    IFEQ 'Y'                        *IF
      * if this is an Unship, reverse the TO whse qty/wgt (neg rct)
     C           *ZERO     SUB  WUA5QT    WUA5QT           Transaction Qua
     C           *ZERO     SUB  WUAHWG    WUAHWG           Transaction Wei
     C                     ELSE
      * CASE: *OTHERWISE
      * if this is NOT an Unship, reverse the FROM whse qty, wgt (reverse
     C           *ZERO     SUB  P1A5QT    P1A5QT           Transaction Qua
     C           *ZERO     SUB  WN0066    WN0066           Quantity based
     C           *ZERO     SUB  P1AHWG    P1AHWG           Transaction Wei
     C           *ZERO     SUB  WN0065    WN0065           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
      * 08/10/23 DN WI517-Call Legacy Process if Not Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Not Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0001    IFEQ 'N'                        *IF
     C           YL0001    OREQ 'P'                        *OR
      * 09/26/23 DN WI517-Set 'Inventory Updated USR' Flag.
     C                     MOVEL'Y'       P8ORSC           Inventory Updat
      * *****************************************************************
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the FROM ITEM
      * *****************************************************************
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0021           Company Number
     C                     Z-ADDP1HGCD    WL0022           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    WN0059           Item Structure
     C                     Z-ADDWL0024    WN0060           Item Structure
     C                     Z-ADDWL0025    WN0061           Item Structure
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0026           Company Number
     C                     Z-ADDP1HGCD    WL0027           Item Code
     C                     MOVELP1AJCD    WL0028    P      Warehouse Code
     C                     MOVELP1W9ST    WL0029    P      Inventory Trans
     C                     MOVELP1BSST    WL0030    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0031           Transaction Dat
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    WN0062           ITD Sequence Nu
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0033           Company Number
     C                     Z-ADDP1HGCD    WL0034           Item Code
     C                     MOVELP1AJCD    WL0035    P      Warehouse Code
     C                     MOVELP1W9ST    WL0036    P      Inventory Trans
     C                     MOVELP1BSST    WL0037    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0038           Transaction Dat
     C                     Z-ADDWN0062    WL0039           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0040           Sequence Number
     C                     Z-ADDP1ELDT    WL0041           Production Date
     C                     MOVELP2ADCD    WL0042    P      UOM Transaction
     C                     MOVELP1F1ST    WL0043    P      Item Transactio
     C                     MOVELP1AUNA    WL0044    P      Description
     C                     Z-ADDP1A5QT    WL0045           Transaction Qua
     C                     Z-ADDP1AHWG    WL0046           Transaction Wei
     C                     Z-ADD*ZERO     WL0047           USR Transaction
     C                     MOVEL'LB'      WL0048    P      UOM Cost
     C                     Z-ADDWN0065    WL0049           Extended Amount
     C                     MOVEL*BLANK    WL0050           Ticket Number
     C                     Z-ADD*ZERO     WL0051           GL Document Num
     C                     MOVEL'N'       WL0052    P      GL Update Statu
     C                     MOVELWN0074    WL0053    P      Reason Code
     C                     MOVEL*BLANK    WL0054           Reference Numbe
     C                     MOVEL*BLANK    WL0055           Lot ID
     C                     Z-ADDP1TRBN    WL0056           Transfer Batch
     C                     Z-ADDP1TRBS    WL0057           Transfer Batch
     C                     Z-ADDP1C4NB    WL0058           Order Number
     C                     Z-ADDWN0059    WL0059           Item Structure
     C                     Z-ADDWN0060    WL0060           Item Structure
     C                     Z-ADDWN0061    WL0061           Item Structure
     C                     MOVEL*BLANK    WL0062           Employee Badge
     C                     Z-ADD*ZERO     WL0063           Production Time
     C                     MOVELP1XLCD    WL0064    P      Shift Number
     C                     Z-ADDP1K7DT    WL0065           Label Date
     C                     MOVEL*BLANK    WL0066           EDI Status 1
     C                     MOVEL*BLANK    WL0067           EDI Status 2
     C                     MOVEL*BLANK    WL0068           EDI Status 3
     C                     MOVEL'A'       WL0069    P      Record Status
     C                     EXSR SHCRRC
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0070           Company Number
     C                     Z-ADDP1HGCD    WL0071           Item Code
     C                     MOVELP1AJCD    WL0072    P      Warehouse Code
     C                     Z-ADDP1ELDT    WL0073           Production Date
     C                     Z-ADDWN0059    WL0074           Item Structure
     C                     Z-ADDWN0060    WL0075           Item Structure
     C                     Z-ADDWN0061    WL0076           Item Structure
     C                     MOVELP2ADCD    WL0077    P      UOM Primary
     C                     Z-ADDP2AWPC    WL0078           Conversion Fact
     C                     MOVELP2LXST    WL0079    P      Operation Facto
     C                     MOVELP2AECD    WL0080    P      UOM Second
     C                     Z-ADDP2AXPC    WL0081           Conversion Fact
     C                     MOVELP2LYST    WL0082    P      Operation Facto
     C                     MOVELP2AFCD    WL0083    P      UOM Third
     C                     MOVELP2FZST    WL0084    P      Production Date
     C                     MOVELP2AVST    WL0085    P      Catch Weight St
     C                     MOVELP1W9ST    WL0086    P      Inventory Trans
     C                     MOVELP1BSST    WL0087    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0088           Transaction Dat
     C                     MOVELP2ADCD    WL0089    P      UOM Transaction
     C                     Z-ADDWN0066    WL0090           Transaction Qua
     C                     Z-ADDP1AHWG    WL0091           Transaction Wei
     C                     Z-ADD*ZERO     WL0092           USR Transaction
     C                     MOVEL'LB'      WL0093    P      UOM Cost
     C                     Z-ADDWN0065    WL0094           Extended Amount
     C                     Z-ADDP1K7DT    WL0095           Label Date  USR
     C                     EXSR SICHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0134           Company Number
     C                     Z-ADDP1HGCD    WL0135           Item Code
     C                     MOVELP1AJCD    WL0136    P      Warehouse Code
     C                     Z-ADDWN0069    WL0137           Quantity on Han
     C                     Z-ADDWN0070    WL0138           Quantity on Han
     C                     Z-ADDWUNFNN    WL0139           Quantity on Han
     C                     Z-ADDWUNFNN    WL0140           Quantity on Han
     C                     Z-ADDWN0071    WL0141           Value of On Han
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0137    WN0069           Quantity on Han
     C                     Z-ADDWL0138    WN0070           Quantity on Han
     C                     Z-ADDWL0139    WUNFNN           Quantity on Han
     C                     Z-ADDWL0140    WUNFNN           Quantity on Han
     C                     Z-ADDWL0141    WN0071           Value of On Han
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0142           Company Number
     C                     Z-ADDP1HGCD    WL0143           Item Code
     C                     MOVELP1AJCD    WL0144    P      Warehouse Code
     C                     Z-ADDWN0069    WL0145           On Hand Weight
     C                     Z-ADDWN0070    WL0146           On Hand UOM1 Su
     C                     Z-ADDWN0071    WL0147           Value of On Han
     C                     EXSR SNCHRC
      * ** FP1127:
      * ** Update location quantity on hand for External warehouse that
      * ** is lot controlled and not Carlisle controlled
      * ** Optional Lot number is passed in from the calling program
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0148    P      Warehouse Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0149    YN0001    P      Warehouse Descr
     C                     MOVELWL0150    YN0002    P      Address Line 1
     C                     MOVELWL0151    YN0003    P      Address Line 2
     C                     MOVELWL0152    YN0004    P      Address Line 3
     C                     MOVELWL0153    YN0005    P      City
     C                     MOVELWL0154    YN0006    P      Zip Postal Code
     C                     MOVELWL0155    YN0007    P      Production Ware
     C                     MOVELWL0156    YN0008    P      State Code
     C                     MOVELWL0157    YL0004    P      Lot Tracking Fl
     C                     MOVELWL0158    YN0009    P      Default Printer
     C                     MOVELWL0159    YN0010    P      Warehouse Type
     C                     MOVELWL0160    YN0011    P      Trans Contol AS
     C                     MOVELWL0161    YL0005    P      Warehouse Locat
     C                     MOVELWL0162    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0163    YN0013           Warehouse Chill
     C                     MOVELWL0164    YN0014    P      Include in Auto
     C                     MOVELWL0165    YN0015    P      Default Manifes
     C                     MOVELWL0166    YN0016    P      Default Load Se
     C                     MOVELWL0167    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0168    YN0018           Shipping Compan
     C                     Z-ADDWL0169    YN0019           Accounting Comp
     C                     Z-ADDWL0170    YN0020           WHS Sched Prod
     C                     Z-ADDWL0171    YN0021           WHS Inventory C
     C                     MOVELWL0172    YN0022    P      Parent Warehous
     C                     MOVELWL0173    YN0023    P      Default Shippin
     C                     MOVELWL0174    YL0006    P      WHS Live with C
     C                     MOVELWL0175    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0176    YN0025    P      WHS Req Meter R
     C                     MOVELWL0177    YN0026    P      WHS Default Loa
     C                     MOVELWL0178    YN0027    P      WHS TMS Plannin
     C                     MOVELWL0179    YN0028    P      Default Carrier
     C                     MOVELWL0180    YN0029    P      Inventory Logic
     C                     MOVELWL0181    YN0030    P      WHS Auto Inv Re
     C                     MOVELWL0182    YN0031    P      EDI Status 1
     C                     MOVELWL0183    YN0032    P      EDI Status 2
     C                     MOVELWL0184    YN0033    P      EDI Status 3
     C                     MOVELWL0185    YN0034    P      Record Status
     C                     Z-ADDWL0186    YN0035           Job Time
     C                     MOVELWL0187    YN0036    P      User Id
     C                     MOVELWL0188    YN0037    P      Job Name
     C                     Z-ADDWL0189    YN0038           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFEQ 'E'                        *IF
     C           YL0006    IFEQ *BLANK                     *IF
     C           YL0006    OREQ 'N'
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0190    P      Warehouse Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0191    WUYMCD    P      Location Code
     C                     MOVELWL0192    YL0007    P      Location Aisle
     C                     Z-ADDWL0193    YL0008           Location Bay
     C                     Z-ADDWL0194    YL0009           Loc Unused Chil
      * ** Lot # will be the "from warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0056  30       Company Number
     C                     PARM P1HGCD    WQ0057  70       Item Code
     C                     PARM P1AJCD    WQ0058  3        Warehouse Code
     C                     PARM P1ELDT    WQ0059  70       Production Date
     C                     PARM WULXNM    WQ0060  50       Lot Number
     C                     PARM WUYMCD    WQ0061  4        Location Code
     C                     PARM WUYNCD    WQ0062  20       Location Level
     C                     PARM P1A5QT    WQ0063  70       Quantity Loc Tr
     C                     PARM P1C4NB    WQ0064  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * *****************************************************************
      * The following block of code will update Item Balance,
      * Item Balance Detail and Transaction Detail for the TO ITEM
      * *****************************************************************
      * ** 12/05/2008 LJB FP1127 Update Auto-Locate Whse inventory
      * ** Only process auto-locate if not a Carlisle Controlled warehous
      * ** and lot tracking has been turned on.
      * 12/04/06 PKD PK0040 Only add inventory to the To Warehouse
      *              if the Inter-Plant Transfer is No.  If the Inter-Pla
      *              Transfer is Yes, then the receiving plant's receivin
      *              process will add the inventory to the To Warehouse.
      * RTV Shipping Co        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3CPCD    WL0195    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0196    YL0010           Shipping Compan
      * CASE: PAR.Inter-Plant Transfer USR is No
     C           P8A5TX    IFEQ 'N'                        *IF
      * Validate that Item Balance for TO Whse exists; if not, create it
      * Val Item Balance       RT - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0197           Company Number
     C                     Z-ADDP1HGCD    WL0198           Item Code
     C                     MOVELP3CPCD    WL0199    P      Warehouse Code
     C                     EXSR SRRVGN
      * Create item balance if none exists
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Balance       CR - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0200           Company Number
     C                     Z-ADDP1HGCD    WL0201           Item Code
     C                     MOVELP3CPCD    WL0202    P      Warehouse Code
     C                     Z-ADDP7ARCS    WL0203           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0204           Last Cost
     C                     Z-ADD*ZERO     WL0205           Cost per Primar
     C                     Z-ADD*ZERO     WL0206           Cost per Pricin
     C                     Z-ADD*ZERO     WL0207           Revaluation Cos
     C                     Z-ADD*ZERO     WL0208           Revaluation Eff
     C                     MOVELWUGSTX    WL0209    P      Revaluation Cos
     C                     Z-ADD*ZERO     WL0210           Last Revaluatio
     C                     Z-ADD*ZERO     WL0211           Last Revaluatio
     C                     Z-ADD*ZERO     WL0212           On Hand Weight
     C                     Z-ADD*ZERO     WL0213           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WL0214           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WL0215           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WL0216           Quantity In Chi
     C                     Z-ADD*ZERO     WL0217           Weight In Chill
     C                     Z-ADD*ZERO     WL0218           Quantity Schedu
     C                     Z-ADD*ZERO     WL0219           Quantity on Sal
     C                     Z-ADD*ZERO     WL0220           Quantity on Pur
     C                     Z-ADD*ZERO     WL0221           Quantity on Tra
     C                     Z-ADD*ZERO     WL0222           Quantity Avail
     C                     MOVEL*BLANK    WL0223           Cycle Count Cod
     C                     Z-ADD*ZERO     WL0224           Date of Last Or
     C                     Z-ADD*ZERO     WL0225           Date of Last Sh
     C                     Z-ADD*ZERO     WL0226           Value of On Han
     C                     MOVELWUGSTX    WL0227    P      Inventory Plann
     C                     Z-ADD*ZERO     WL0228           Safety Allowanc
     C                     Z-ADD*ZERO     WL0229           Safety Allowanc
     C                     Z-ADD*ZERO     WL0230           Stock Out Date
     C                     MOVEL*BLANK    WL0231           Buyer Code
     C                     Z-ADD*ZERO     WL0232           Lead Time Last
     C                     Z-ADD*ZERO     WL0233           Lead Time Date
     C                     Z-ADD*ZERO     WL0234           Lead Time Next
     C                     Z-ADD*ZERO     WL0235           Lead Time Date
     C                     MOVEL'N'       WL0236    P      Lead Time Excep
     C                     Z-ADD*ZERO     WL0237           Usage Qty per C
     C                     Z-ADD*ZERO     WL0238           Usage Weight pe
     C                     Z-ADD*ZERO     WL0239           Inventory Manag
     C                     Z-ADD*ZERO     WL0240           Minimum Quantit
     C                     Z-ADD*ZERO     WL0241           Maximum Quantit
     C                     Z-ADD*ZERO     WL0242           Last Physical C
     C                     MOVELWUGSTX    WL0243    P      Requisition Mod
     C                     MOVELWUGSTX    WL0244    P      Cost Update Pen
     C                     MOVELWUGSTX    WL0245    P      Post GL Status
     C                     Z-ADD*ZERO     WL0246           Vendor Item_Whs
     C                     Z-ADDWN0059    WL0247           Item Structure
     C                     Z-ADDWN0060    WL0248           Item Structure
     C                     Z-ADDWN0061    WL0249           Item Structure
     C                     MOVELWUUVST    WL0250    P      EDI Status 1
     C                     MOVELWUUWST    WL0251    P      EDI Status 2
     C                     MOVELWUUXST    WL0252    P      EDI Status 3
     C                     MOVEL'A'       WL0253    P      Record Status
     C                     EXSR SSCRRC
     C                     END                             *FI
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost - Detail EQ WRK.ZERO
     C           P7ARCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0074           USR Reason Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP1CQCD    WN0074           USR Reason Code
     C                     END                             *FI
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0021           Company Number
     C                     Z-ADDP1HGCD    WL0022           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    WN0059           Item Structure
     C                     Z-ADDWL0024    WN0060           Item Structure
     C                     Z-ADDWL0025    WN0061           Item Structure
     C           P7ARCS    MULT WUAHWG    WN0065    H      Extended Amount
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0026           Company Number
     C                     Z-ADDP1HGCD    WL0027           Item Code
     C                     MOVELP3CPCD    WL0028    P      Warehouse Code
     C                     MOVELP1W9ST    WL0029    P      Inventory Trans
     C                     MOVELP1BSST    WL0030    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0031           Transaction Dat
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    WN0062           ITD Sequence Nu
      * Reset Production/Label Date if Lot Tracking warehouse.
     C                     EXSR UASUBR                     Reset Productio
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0033           Company Number
     C                     Z-ADDP1HGCD    WL0034           Item Code
     C                     MOVELP3CPCD    WL0035    P      Warehouse Code
     C                     MOVELP1W9ST    WL0036    P      Inventory Trans
     C                     MOVELP1BSST    WL0037    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0038           Transaction Dat
     C                     Z-ADDWN0062    WL0039           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0040           Sequence Number
     C                     Z-ADDWN0072    WL0041           Production Date
     C                     MOVELP2ADCD    WL0042    P      UOM Transaction
     C                     MOVELP1F1ST    WL0043    P      Item Transactio
     C                     MOVELP1AUNA    WL0044    P      Description
     C                     Z-ADDWUA5QT    WL0045           Transaction Qua
     C                     Z-ADDWUAHWG    WL0046           Transaction Wei
     C                     Z-ADD*ZERO     WL0047           USR Transaction
     C                     MOVEL'LB'      WL0048    P      UOM Cost
     C                     Z-ADDWN0065    WL0049           Extended Amount
     C                     MOVEL*BLANK    WL0050           Ticket Number
     C                     Z-ADD*ZERO     WL0051           GL Document Num
     C                     MOVEL*BLANK    WL0052           GL Update Statu
     C                     MOVELWN0074    WL0053    P      Reason Code
     C                     MOVEL*BLANK    WL0054           Reference Numbe
     C                     MOVEL*BLANK    WL0055           Lot ID
     C                     Z-ADDP1TRBN    WL0056           Transfer Batch
     C                     Z-ADDP1TRBS    WL0057           Transfer Batch
     C                     Z-ADDP1C4NB    WL0058           Order Number
     C                     Z-ADDWN0059    WL0059           Item Structure
     C                     Z-ADDWN0060    WL0060           Item Structure
     C                     Z-ADDWN0061    WL0061           Item Structure
     C                     MOVEL*BLANK    WL0062           Employee Badge
     C                     Z-ADD*ZERO     WL0063           Production Time
     C                     MOVELP1XLCD    WL0064    P      Shift Number
     C                     Z-ADDWN0073    WL0065           Label Date
     C                     MOVEL*BLANK    WL0066           EDI Status 1
     C                     MOVEL*BLANK    WL0067           EDI Status 2
     C                     MOVEL*BLANK    WL0068           EDI Status 3
     C                     MOVEL'A'       WL0069    P      Record Status
     C                     EXSR SHCRRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * * Post transaction to Item Balance & Item Balance Detail
      * Prc Create Dtl Receipt IF
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0254           Company Number
     C                     Z-ADDP1HGCD    WL0255           Item Code
     C                     MOVELP3CPCD    WL0256    P      Warehouse Code
     C                     MOVELP1W9ST    WL0257    P      Inventory Trans
     C                     MOVELP1BSST    WL0258    P      Inventory Trans
     C                     Z-ADDP1B4DT    WL0259           Transaction Dat
     C                     Z-ADDWN0062    WL0260           ITD Sequence Nu
     C                     Z-ADD*ZERO     WL0261           Sequence Number
     C                     MOVELP1XLCD    WL0262    P      Shift Number
     C                     Z-ADDWN0073    WL0263           Label Date
     C                     EXSR STRVGN
      * ** Process Auto-Locate Whse inventory             FP1127
      * RTV Warehouse Info     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3CPCD    WL0148    P      Warehouse Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0149    YN0001    P      Warehouse Descr
     C                     MOVELWL0150    YN0002    P      Address Line 1
     C                     MOVELWL0151    YN0003    P      Address Line 2
     C                     MOVELWL0152    YN0004    P      Address Line 3
     C                     MOVELWL0153    YN0005    P      City
     C                     MOVELWL0154    YN0006    P      Zip Postal Code
     C                     MOVELWL0155    YN0007    P      Production Ware
     C                     MOVELWL0156    YN0008    P      State Code
     C                     MOVELWL0157    YL0004    P      Lot Tracking Fl
     C                     MOVELWL0158    YN0009    P      Default Printer
     C                     MOVELWL0159    YN0010    P      Warehouse Type
     C                     MOVELWL0160    YN0011    P      Trans Contol AS
     C                     MOVELWL0161    YL0005    P      Warehouse Locat
     C                     MOVELWL0162    YN0012    P      Warehouse Std C
     C                     Z-ADDWL0163    YN0013           Warehouse Chill
     C                     MOVELWL0164    YN0014    P      Include in Auto
     C                     MOVELWL0165    YN0015    P      Default Manifes
     C                     MOVELWL0166    YN0016    P      Default Load Se
     C                     MOVELWL0167    YN0017    P      WHS Slotting Li
     C                     Z-ADDWL0168    YN0018           Shipping Compan
     C                     Z-ADDWL0169    YN0019           Accounting Comp
     C                     Z-ADDWL0170    YN0020           WHS Sched Prod
     C                     Z-ADDWL0171    YN0021           WHS Inventory C
     C                     MOVELWL0172    YN0022    P      Parent Warehous
     C                     MOVELWL0173    YN0023    P      Default Shippin
     C                     MOVELWL0174    YL0006    P      WHS Live with C
     C                     MOVELWL0175    YN0024    P      WHS PFS Interfa
     C                     MOVELWL0176    YN0025    P      WHS Req Meter R
     C                     MOVELWL0177    YN0026    P      WHS Default Loa
     C                     MOVELWL0178    YN0027    P      WHS TMS Plannin
     C                     MOVELWL0179    YN0028    P      Default Carrier
     C                     MOVELWL0180    YN0029    P      Inventory Logic
     C                     MOVELWL0181    YN0030    P      WHS Auto Inv Re
     C                     MOVELWL0182    YN0031    P      EDI Status 1
     C                     MOVELWL0183    YN0032    P      EDI Status 2
     C                     MOVELWL0184    YN0033    P      EDI Status 3
     C                     MOVELWL0185    YN0034    P      Record Status
     C                     Z-ADDWL0186    YN0035           Job Time
     C                     MOVELWL0187    YN0036    P      User Id
     C                     MOVELWL0188    YN0037    P      Job Name
     C                     Z-ADDWL0189    YN0038           Job Date
      * ** Process lot tracking if External, not Carlisle, Lot trk=Y
      * CASE: Process lots if External, not Carlisle, Lot trk=Y
      *  - c1 AND c2 AND c3
      *   |- c1    : LCL.Warehouse Location is External
      *   |- c2    : LCL.WHS Live w/Carlisle is *No/Blank
      *   |- c3    : LCL.Lot Tracking Flag is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFEQ 'E'                        *IF
     C           YL0006    IFEQ *BLANK                     *IF
     C           YL0006    OREQ 'N'
     C           YL0004    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Lot Number is passed in and is optional
      * RTV Whse Location Info RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3CPCD    WL0190    P      Warehouse Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0191    WUYMCD    P      Location Code
     C                     MOVELWL0192    YL0007    P      Location Aisle
     C                     Z-ADDWL0193    YL0008           Location Bay
     C                     Z-ADDWL0194    YL0009           Loc Unused Chil
      * ** Lot# will be the "to warehouse" lot# or zeros    FP1127
      * UPD Auto-Loc TR Ord ItmXF - Item Lot Location  * 
     C                     CALL 'PMBVXFR'              90  UPD Auto-Loc TR
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0079  30       Company Number
     C                     PARM P1HGCD    WQ0080  70       Item Code
     C                     PARM P3CPCD    WQ0081  3        Warehouse Code
     C                     PARM P1B4DT    WQ0082  70       Production Date
     C                     PARM WULTNT    WQ0083  50       Lot Number
     C                     PARM WUYMCD    WQ0084  4        Location Code
     C                     PARM WUYNCD    WQ0085  20       Location Level
     C                     PARM WUA5QT    WQ0086  70       Quantity Loc Tr
     C                     PARM P1C4NB    WQ0087  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMBVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      * 08/10/23 DN WI517-Call WIM API if Live or Parallel.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Module Release Status is Is Live
      *   |- c2    : LCL.Module Release Status is Parallel
      *   '-
     C           YL0001    IFEQ 'Y'                        *IF
     C           YL0001    OREQ 'P'                        *OR
     C                     MOVEL'Y'       P8OQSC           API was Called?
     C                     MOVEL*BLANK    YL0011           API EccResult-M
     C                     MOVEL*BLANK    YL0012           API EccResult-M
     C                     MOVEL*BLANK    YL0013           API Request Key
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,002   CAT  'ry':ZQ   YL0014    P      API Name
      * RTV Numeric Value      RT - System Values  * 
     C                     EXSR SYRVGN
      * Call API Wrapper Program for wim.ordershipping.inventory API.
      * 1/6/24 DN SR08283-Added 'API Request Key U' & 'API Mode U' Parms.
      * API WIM Inv Shipping   UP - WIM Item Trans Detail  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
     C                     Z-ADDP1HGCD    PAHGCD           Item Code
     C                     MOVELP1AJCD    PAVPCD    P      Ship From Wareh
     C                     MOVELP1W9ST    PANOSC    P      WIM Inventory T
     C                     MOVELP1BSST    PANPSC    P      WIM Inventory T
     C                     Z-ADDP1B4DT    PAA9DT           Transaction Dat
     C                     Z-ADDP1ELDT    PAELDT           Production Date
     C                     MOVELP1F1ST    PAF1ST    P      Item Transactio
     C                     MOVELP1AUNA    PAVQNA    P      Transaction Des
     C                     MOVEL*BLANK    PAA1AB    P      Transaction Rea
     C                     Z-ADDP1C4NB    PAC4NB           Order Number
     C                     MOVELP1XLCD    PAXLCD    P      Shift Number
     C                     MOVELP3CPCD    PAL9AA    P      Ship To Warehou
     C                     Z-ADDYL0003    PAAHWG           Transaction Wei
     C                     Z-ADDYL0002    PAA5QT           Transaction Qua
     C                     MOVELP8USST    PAUSST    P      USR Unship Flag
     C                     MOVELP8A5TX    PAA5TX    P      Inter-Plant Tra
     C                     MOVELYL0013    PACKAB    P      API Request Key
     C                     MOVEL'*SNDRCV' PACJAB    P      API Mode U
      *
     C                     CALL 'PVAYUPR'              90  API WIM Inv Shi
     C                     PARM YL0015    WQ0088  50       API Wait Time U
     C                     PARM           PARC             RCD: *Arrays
      *
     C                     MOVELPACLAB    YL0011           API EccResult-M
     C                     MOVELPAVGU1    YL0012           API EccResult-M
     C                     MOVELPACKAB    YL0013           API Request Key
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVAYUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * API Call Successful? If Not, Create Log & Send Email.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.API EccResult-MsgId U is Success
      *   |- c2    : LCL.API EccResult-MsgId U is Timeout
      *   '-
     C           YL0011    IFEQ @CN,004                    *IF
     C           YL0011    OREQ @CN,005                    *OR
     C                     MOVEL'Y'       P8ORSC           Inventory Updat
      * 01/06/24 DN SR08283-Create Log Record for Timeout Transaction.
      * CASE: LCL.API EccResult-MsgId U is Timeout
     C           YL0011    IFEQ @CN,005                    *IF
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Timeout Failur
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0014    WQ0089 45        API Name
     C                     PARM YL0011    WQ0090  7        API EccResult M
     C                     PARM YL0012    WQ0091 50        API EccResult-M
     C                     PARM YL0013    WQ0092 10        API Request Key
     C                     PARM P8COAB    WQ0093 10        Called From Pro
     C                     PARM P1AIC3    WQ0094  30       Company Number
     C                     PARM P1HGCD    WQ0095  70       Item Code
     C                     PARM P1AJCD    WQ0096  3        Ship From Wareh
     C                     PARM P1W9ST    WQ0097  3        WIM Inventory T
     C                     PARM P1BSST    WQ0098  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0099  70       Transaction Dat
     C                     PARM P1ELDT    WQ0100  70       Production Date
     C                     PARM P1F1ST    WQ0101  2        Item Transactio
     C                     PARM P1AUNA    WQ0102 30        Transaction Des
     C                     PARM *BLANK    WQ0103  3        Transaction Rea
     C                     PARM P1C4NB    WQ0104  70       Order Number
     C                     PARM P1XLCD    WQ0105  1        Shift Number
     C                     PARM P3CPCD    WQ0106  3        Ship To Warehou
     C                     PARM YL0003    WQ0107 112       Transaction Wei
     C                     PARM YL0002    WQ0108 112       Transaction Qua
     C                     PARM P8USST    WQ0109  1        Unship Flag
     C                     PARM P8A5TX    WQ0110  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * SR07943 DN 12/21/23-Added 'API EccResult-MsgId U is Entered' Cond
      * CASE: LCL.API EccResult-MsgId U is Entered
     C           YL0011    IFNE *BLANK                     *IF
     C                     MOVEL'N'       P8ORSC           Inventory Updat
      * 1/6/24 DN SR08283-Added 'API Request Key' as Input Parm.
      * Crt WIM API Failure LogXF - WIM API Failure Log  * Hardstop Failu
     C                     CALL 'PVA8XFR'              90  Crt WIM API Fai
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0014    WQ0111 45        API Name
     C                     PARM YL0011    WQ0112  7        API EccResult M
     C                     PARM YL0012    WQ0113 50        API EccResult-M
     C                     PARM YL0013    WQ0114 10        API Request Key
     C                     PARM P8COAB    WQ0115 10        Called From Pro
     C                     PARM P1AIC3    WQ0116  30       Company Number
     C                     PARM P1HGCD    WQ0117  70       Item Code
     C                     PARM P1AJCD    WQ0118  3        Ship From Wareh
     C                     PARM P1W9ST    WQ0119  3        WIM Inventory T
     C                     PARM P1BSST    WQ0120  3        WIM Inventory T
     C                     PARM P1B4DT    WQ0121  70       Transaction Dat
     C                     PARM P1ELDT    WQ0122  70       Production Date
     C                     PARM P1F1ST    WQ0123  2        Item Transactio
     C                     PARM P1AUNA    WQ0124 30        Transaction Des
     C                     PARM *BLANK    WQ0125  3        Transaction Rea
     C                     PARM P1C4NB    WQ0126  70       Order Number
     C                     PARM P1XLCD    WQ0127  1        Shift Number
     C                     PARM P3CPCD    WQ0128  3        Ship To Warehou
     C                     PARM YL0003    WQ0129 112       Transaction Wei
     C                     PARM YL0002    WQ0130 112       Transaction Qua
     C                     PARM P8USST    WQ0131  1        Unship Flag
     C                     PARM P8A5TX    WQ0132  1        Inter Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Keep Track of Batch Processing Functions so Email will NOT be Sen
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : PAR.Called From Program is Exc Upd EDI 944 Trsn   XF
      *   |- c2    : PAR.Called From Program is EDT Confirm Ship Detl  DF
      *   |- c3    : PAR.Called From Program is ADD Ready to Confirm  XL
      *   |- c4    : PAR.Called From Program is Exc Upd EDI 945 Trsn   XF
      *   |- c5    : PAR.Called From Program is PFS Reopen Order      XL
      *   |- c6    : PAR.Called From Program is WW Unship Orders       DF
      *   '-
     C           P8COAB    IFEQ @CN,006                    *IF
     C           P8COAB    OREQ @CN,007                    *OR
     C           P8COAB    OREQ @CN,008                    *OR
     C           P8COAB    OREQ @CN,009                    *OR
     C           P8COAB    OREQ @CN,010                    *OR
     C           P8COAB    OREQ @CN,011                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Send Email to Business & IT.
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                     CALL 'PVA9XFR'              90  Prc Eml Shippin
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P8COAB    WQ0133 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     Z-ADDWL0002    WAHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     MOVEL*BLANK    WL0004           Description Lin
     C                     MOVEL*BLANK    WL0005           UOM Primary
     C                     Z-ADD*ZERO     WL0006           Conversion Fact
     C                     MOVEL*BLANK    WL0007           Operation Facto
     C                     MOVEL*BLANK    WL0008           UOM Second
     C                     Z-ADD*ZERO     WL0009           Conversion Fact
     C                     MOVEL*BLANK    WL0010           Operation Facto
     C                     MOVEL*BLANK    WL0011           UOM Third
     C                     MOVEL*BLANK    WL0012           UOM Pricing
     C                     Z-ADD*ZERO     WL0013           Unit Weight
     C                     MOVEL*BLANK    WL0014           Production Date
     C                     MOVEL*BLANK    WL0015           Catch Weight St
     C                     Z-ADD*ZERO     WL0016           Fresh Chilling
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    WL0003           Description Lin
     C                     MOVELWAAWNA    WL0004           Description Lin
     C                     MOVELWAADCD    WL0005           UOM Primary
     C                     Z-ADDWAAWPC    WL0006           Conversion Fact
     C                     MOVELWALXST    WL0007           Operation Facto
     C                     MOVELWAAECD    WL0008           UOM Second
     C                     Z-ADDWAAXPC    WL0009           Conversion Fact
     C                     MOVELWALYST    WL0010           Operation Facto
     C                     MOVELWAAFCD    WL0011           UOM Third
     C                     MOVELWAAICD    WL0012           UOM Pricing
     C                     Z-ADDWAAIWG    WL0013           Unit Weight
     C                     MOVELWAFZST    WL0014           Production Date
     C                     MOVELWAAVST    WL0015           Catch Weight St
     C                     Z-ADDWACHTM    WL0016           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Unit Cost          RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0017    WBAIC3           Company Number
     C                     Z-ADDWL0018    WBHGCD           Item Code
     C                     MOVELWL0019    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@B0REJX              90    *
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAGCS    WL0020           Unit Cost Per P
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Rtv Next Tran Batch #  CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  40       Current Account
     C                     Z-ADD*ZERO     WN0002  20       Current Account
     C                     Z-ADD*ZERO     WN0003  30       OM Week
     C                     Z-ADD*ZERO     WN0004  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0005  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0006  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0007  70       Next Charge Bac
     C                     Z-ADD*ZERO     WN0008  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0009  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0010  70       Next Customer #
     C                     Z-ADD*ZERO     WN0011  70       Next Inventory
     C                     Z-ADD*ZERO     WN0012  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0013  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0014  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0015  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0016  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0017  1        Auto Customers
     C                     MOVEL*BLANK    WN0018  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0019  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0020  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0021 112       Late Charge Min
     C                     MOVEL*BLANK    WN0022  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0023  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0024  1        Allocate Credit
     C                     MOVEL*BLANK    WN0025 30        Message Line 1
     C                     MOVEL*BLANK    WN0026 30        Message Line 2
     C                     MOVEL*BLANK    WN0027 30        Message Line 3
     C                     MOVEL*BLANK    WN0028 30        Message Line 4
     C                     MOVEL*BLANK    WN0029  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0030  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0031  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0032  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0033  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0034  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0035  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0036  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0037  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0038  30       Retention Perio
     C                     Z-ADD*ZERO     WN0039  30       Retention Perio
     C                     Z-ADD*ZERO     WN0040  30       Retention Perio
     C                     Z-ADD*ZERO     WN0041  30       Retention Perio
     C                     Z-ADD*ZERO     WN0042  30       Retention Perio
     C                     Z-ADD*ZERO     WN0043  70       Next Load ID
     C                     MOVEL*BLANK    WN0044  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0045  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0046  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0047  30       Production Numb
     C                     MOVEL*BLANK    WN0048  1        Freight by Poun
     C                     MOVEL*BLANK    WN0049  1        Price Audit Act
     C                     MOVEL*BLANK    WN0050 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0051  1        EDI Status 1
     C                     MOVEL*BLANK    WN0052  1        EDI Status 2
     C                     MOVEL*BLANK    WN0053  1        EDI Status 3
     C                     MOVEL*BLANK    WN0054  1        Record Status
     C                     Z-ADD*ZERO     WN0055  60       Job Time
     C                     MOVEL*BLANK    WN0056 10        User Id
     C                     MOVEL*BLANK    WN0057 10        Job Name
     C                     Z-ADD*ZERO     WN0058  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADDP1AIC3    WCAIC3           Company Number
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C           KLCHSC    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YARDCS
      * USER: Processing after Data read
     C                     MOVEL'Y'       YARDC            *Record Data Ch
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADDWCBANB    P1TRBN           Transfer Batch
     C                     ADD  1         WCBANB           Next HPB Batch
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADDP1C4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURMNB           Load ID
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDRMNB    WURMNB           Load ID
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Module Release Sts RT - OMS Transformation Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Module Release
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEB3AB           Module ID
     C                     KFLD           WEHUNZ           Release Number
      * Setup key
     C                     MOVEL'WIM'     WEB3AB           Module ID
     C                     Z-ADD1         WEHUNZ           Release Number
      * Establish starting position
     C           KRSSE     CHAIN@C6REMK              90    *
      * Data record not found
     C   90                MOVEL'USR5307' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WEVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWEOCSC    YL0001           Module Release
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0021    WAAIC3           Company Number
     C                     Z-ADDWL0022    WAHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWARINB    WL0023           Item Structure
     C                     Z-ADDWARHNB    WL0024           Item Structure
     C                     Z-ADDWARGNB    WL0025           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFHGCD    WQSG02           Item Code
     C           *LIKE     DEFN WFAJCD    WQSG03           Warehouse Code
     C           *LIKE     DEFN WFW9ST    WQSG04           Inventory Trans
     C           *LIKE     DEFN WFBSST    WQSG05           Inventory Trans
     C           *LIKE     DEFN WFB4DT    WQSG06           Transaction Dat
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Item Code
     C                     KFLD           WQSG03           Warehouse Code
     C                     KFLD           WQSG04           Inventory Trans
     C                     KFLD           WQSG05           Inventory Trans
     C                     KFLD           WQSG06           Transaction Dat
      * Setup key
     C                     Z-ADDWL0026    WQSG01           Company Number
     C                     Z-ADDWL0027    WQSG02           Item Code
     C                     MOVELWL0028    WQSG03           Warehouse Code
     C                     MOVELWL0029    WQSG04           Inventory Trans
     C                     MOVELWL0030    WQSG05           Inventory Trans
     C                     Z-ADDWL0031    WQSG06           Transaction Dat
      * Establish starting position
     C           KRSSG     SETLL@B7CPZA                    *
     C           KRSSG     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0032           ITD Sequence Nu
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WFC4NY    ADD  1         WL0032           ITD Sequence Nu
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0078  60       Job Time
     C                     MOVEL*BLANK    WN0079 10        User Id
     C                     MOVEL*BLANK    WN0080 10        Job Name
     C                     Z-ADD*ZERO     WN0081  70       Job Date
     C                     Z-ADD*ZERO     WN0082  20       Production Hour
     C                     Z-ADD*ZERO     WN0083 112       Production Weig
     C                     Z-ADD*ZERO     WN0084  50       Production Quan
     C                     Z-ADD*ZERO     WN0085  70       Production Piec
     C                     MOVEL*BLANK    WN0086  1        Export_Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWL0033    WGAIC3           Company Number
     C                     Z-ADDWL0034    WGHGCD           Item Code
     C                     MOVELWL0035    WGAJCD           Warehouse Code
     C                     MOVELWL0036    WGW9ST           Inventory Trans
     C                     MOVELWL0037    WGBSST           Inventory Trans
     C                     Z-ADDWL0038    WGB4DT           Transaction Dat
     C                     Z-ADDWL0039    WGC4NY           ITD Sequence Nu
     C                     Z-ADDWL0040    WGDXNB           Sequence Number
     C                     Z-ADDWL0041    WGELDT           Production Date
     C                     MOVELWL0042    WGHVCD           UOM Transaction
     C                     MOVELWL0043    WGF1ST           Item Transactio
     C                     MOVELWL0044    WGAUNA           Description
     C                     Z-ADDWL0045    WGA5QT           Transaction Qua
     C                     Z-ADDWL0046    WGAHWG           Transaction Wei
     C                     Z-ADDWL0047    WGAKCS           USR Transaction
     C                     MOVELWL0048    WGCGCD           UOM Cost
     C                     Z-ADDWL0049    WGAYVA           Extended Amount
     C                     MOVELWL0050    WGBJNA           Ticket Number
     C                     Z-ADDWL0051    WGCKNB           GL Document Num
     C                     MOVELWL0052    WGBMST           GL Update Statu
     C                     MOVELWL0053    WGCQCD           Reason Code
     C                     MOVELWL0054    WGDTCD           Reference Numbe
     C                     MOVELWL0055    WGMGNA           Lot ID
     C                     Z-ADDWL0056    WGTRBN           Transfer Batch
     C                     Z-ADDWL0057    WGTRBS           Transfer Batch
     C                     Z-ADDWL0058    WGC4NB           Order Number
     C                     Z-ADDWL0059    WGRINB           Item Structure
     C                     Z-ADDWL0060    WGRHNB           Item Structure
     C                     Z-ADDWL0061    WGRGNB           Item Structure
     C                     MOVELWL0062    WGM3NA           Employee Badge
     C                     Z-ADDWL0063    WGAWTM           Production Time
     C                     MOVELWL0064    WGXLCD           Shift Number
     C                     Z-ADDWL0065    WGK7DT           Label Date
     C                     MOVELWL0066    WGUVST           EDI Status 1
     C                     MOVELWL0067    WGUWST           EDI Status 2
     C                     MOVELWL0068    WGUXST           EDI Status 3
     C                     MOVELWL0069    WGVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0001 155       Current System
     C           WGAATM    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGW9ST           Inventory Trans
     C                     KFLD           WGBSST           Inventory Trans
     C                     KFLD           WGB4DT           Transaction Dat
     C                     KFLD           WGC4NY           ITD Sequence Nu
     C                     KFLD           WGDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSH    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0003  30       Company Number
     C                     PARM WGHGCD    WQ0004  70       Item Code
     C                     PARM WGAJCD    WQ0005  3        Warehouse Code
     C                     PARM WGW9ST    WQ0006  1        Inventory Trans
     C                     PARM WGBSST    WQ0007  2        Inventory Trans
     C                     PARM WGB4DT    WQ0008  70       Transaction Dat
     C                     PARM WGDXNB    WQ0009  30       Sequence Number
     C                     PARM WGELDT    WQ0010  70       Production Date
     C                     PARM WGHVCD    WQ0011  2        UOM Transaction
     C                     PARM WGF1ST    WQ0012  2        Item Transactio
     C                     PARM WGAUNA    WQ0013 30        Description
     C                     PARM WGA5QT    WQ0014 112       Transaction Qua
     C                     PARM WGAHWG    WQ0015 112       Transaction Wei
     C                     PARM WGAKCS    WQ0016 114       USR Transaction
     C                     PARM WGCGCD    WQ0017  2        UOM Cost
     C                     PARM WGAYVA    WQ0018 112       Extended Amount
     C                     PARM WGBJNA    WQ0019  6        Ticket Number
     C                     PARM WGCKNB    WQ0020  80       GL Document Num
     C                     PARM WGBMST    WQ0021  1        GL Update Statu
     C                     PARM WGCQCD    WQ0022  3        Reason Code
     C                     PARM WGDTCD    WQ0023 15        Reference Numbe
     C                     PARM WGMGNA    WQ0024 10        Lot ID
     C                     PARM WGTRBN    WQ0025  70       Transfer Batch
     C                     PARM WGTRBS    WQ0026  30       Transfer Batch
     C                     PARM WGC4NB    WQ0027  70       Order Number
     C                     PARM WGRINB    WQ0028  30       Item Structure
     C                     PARM WGRHNB    WQ0029  30       Item Structure
     C                     PARM WGRGNB    WQ0030  30       Item Structure
     C                     PARM WGM3NA    WQ0031 10        Employee Badge
     C                     PARM WGAWTM    WQ0032  60       Production Time
     C                     PARM WGXLCD    WQ0033  1        Shift Number
     C                     PARM WGK7DT    WQ0034  70       Label Date
     C                     PARM WGVSST    WQ0035  1        Record Status
     C                     PARM WGAATM    WQ0036  60       Job Time
     C                     PARM WGAXDT    WQ0037  70       Job Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0087 112       Physical Count
     C                     Z-ADD*ZERO     WN0088 112       Physical Count
     C                     Z-ADD*ZERO     WN0089 112       Physical Count
     C                     Z-ADD*ZERO     WN0090 112       Physical Count
     C                     MOVEL*BLANK    WN0091  1        Physical Count
     C                     Z-ADD*ZERO     WN0092 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0093 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0094 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0095 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0096 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0097 112       Weight In Chill
     C                     MOVEL*BLANK    WN0098  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0099 112       Physical Start
     C                     Z-ADD*ZERO     WN0100 112       Physical Start
     C                     Z-ADD*ZERO     WN0101 112       Physical Start
     C                     Z-ADD*ZERO     WN0102 112       Physical Start
     C                     Z-ADD*ZERO     WN0103  70       Physical Start
     C                     Z-ADD*ZERO     WN0104 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0105 114       Last Cost
     C                     Z-ADD*ZERO     WN0106 112       Value of On Han
     C                     Z-ADD*ZERO     WN0107  70       Label Date
     C                     MOVEL*BLANK    WN0108  1        EDI Status 1
     C                     MOVEL*BLANK    WN0109  1        EDI Status 2
     C                     MOVEL*BLANK    WN0110  1        EDI Status 3
     C                     MOVEL*BLANK    WN0111  1        Record Status
     C                     Z-ADD*ZERO     WN0112  60       Job Time
     C                     MOVEL*BLANK    WN0113 10        User Id
     C                     MOVEL*BLANK    WN0114 10        Job Name
     C                     Z-ADD*ZERO     WN0115  70       Job Date
     C                     MOVEL*BLANK    WN0116  1        Shift Number
     C                     MOVEL*BLANK    WN0117  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0116           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0070    WHAIC3           Company Number
     C                     Z-ADDWL0071    WHHGCD           Item Code
     C                     MOVELWL0072    WHAJCD    P      Warehouse Code
     C                     Z-ADDWL0073    WHELDT           Production Date
      *
     C           KLCHSI    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLCHSI    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0070    WL0096           Company Number
     C                     Z-ADDWL0071    WL0097           Item Code
     C                     MOVELWL0072    WL0098    P      Warehouse Code
     C                     Z-ADDWL0073    WL0099           Production Date
     C                     Z-ADD*ZERO     WL0100           Physical Count
     C                     Z-ADD*ZERO     WL0101           Physical Count
     C                     Z-ADD*ZERO     WL0102           Physical Count
     C                     Z-ADD*ZERO     WL0103           Physical Count
     C                     MOVEL*BLANK    WL0104           Physical Count
     C                     Z-ADDWL0091    WL0105           Quantity on Han
     C                     Z-ADDWL0090    WL0106           Quantity on Han
     C                     Z-ADD*ZERO     WL0107           Quantity on Han
     C                     Z-ADD*ZERO     WL0108           Quantity on Han
     C                     Z-ADD*ZERO     WL0109           Quantity In Chi
     C                     Z-ADD*ZERO     WL0110           Weight In Chill
     C                     MOVEL'N'       WL0111    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0112           Physical Start
     C                     Z-ADD*ZERO     WL0113           Physical Start
     C                     Z-ADD*ZERO     WL0114           Physical Start
     C                     Z-ADD*ZERO     WL0115           Physical Start
     C                     Z-ADD*ZERO     WL0116           Physical Start
     C                     Z-ADD*ZERO     WL0117           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0118           Last Cost
     C                     Z-ADDWL0094    WL0119           Value of On Han
     C                     Z-ADDWL0095    WL0120           Label Date
     C                     Z-ADDWL0074    WL0121           Item Structure
     C                     Z-ADDWL0075    WL0122           Item Structure
     C                     Z-ADDWL0076    WL0123           Item Structure
     C                     MOVEL*BLANK    WL0124           EDI Status 1
     C                     MOVEL*BLANK    WL0125           EDI Status 2
     C                     MOVEL*BLANK    WL0126           EDI Status 3
     C                     MOVEL'A'       WL0127    P      Record Status
     C                     EXSR SJCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YBRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWL0074    WHRINB           Item Structure
     C                     Z-ADDWL0075    WHRHNB           Item Structure
     C                     Z-ADDWL0076    WHRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
     C                     ADD  WL0090    WHARQT           Quantity on Han
     C                     ADD  WL0091    WHACWG           Quantity on Han
     C                     ADD  WL0094    WHIDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WHARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - Item Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0040  30       Company Number
     C                     PARM WHHGCD    WQ0041  70       Item Code
     C                     PARM WHAJCD    WQ0042  3        Warehouse Code
     C                     PARM WL0088    WQ0043  70       Transaction Dat
     C                     PARM WHELDT    WQ0044  70       Production Date
     C                     PARM WL0089    WQ0045  2        UOM Transaction
     C                     PARM WHACWG    WQ0046 112       Transaction Wei
     C                     PARM WL0092    WQ0047 114       USR Transaction
     C                     PARM WL0093    WQ0048  2        UOM Cost
     C                     PARM WHRINB    WQ0049  30       Item Structure
     C                     PARM WHRHNB    WQ0050  30       Item Structure
     C                     PARM WHRGNB    WQ0051  30       Item Structure
     C                     PARM WN0116    WQ0052  1        Shift Number
     C                     PARM WHK7DT    WQ0053  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WHACWG           Quantity on Han
     C                     Z-ADD*ZERO     WHIDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WHAXDT    PARM *ZERO     WQ0054 155       Current System
     C           WHAATM    PARM *ZERO     WQ0055 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WHARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWHAJCD    WL0128    P      Warehouse Code
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0129    WN0117    P      Lot Tracking Fl
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0117    IFEQ *BLANK                     *IF
     C           WN0117    OREQ 'N'
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0130           Company Number
     C                     Z-ADDWHHGCD    WL0131           Item Code
     C                     MOVELWHAJCD    WL0132    P      Warehouse Code
     C                     Z-ADDWHELDT    WL0133           Production Date
     C                     EXSR SLDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0118  60       Job Time
     C                     MOVEL*BLANK    WN0119 10        User Id
     C                     MOVEL*BLANK    WN0120 10        Job Name
     C                     Z-ADD*ZERO     WN0121  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWL0096    WHAIC3           Company Number
     C                     Z-ADDWL0097    WHHGCD           Item Code
     C                     MOVELWL0098    WHAJCD           Warehouse Code
     C                     Z-ADDWL0099    WHELDT           Production Date
     C                     Z-ADDWL0100    WHABWG           Physical Count
     C                     Z-ADDWL0101    WHAGQT           Physical Count
     C                     Z-ADDWL0102    WHAHQT           Physical Count
     C                     Z-ADDWL0103    WHAIQT           Physical Count
     C                     MOVELWL0104    WHCTST           Physical Count
     C                     Z-ADDWL0105    WHACWG           Quantity on Han
     C                     Z-ADDWL0106    WHARQT           Quantity on Han
     C                     Z-ADDWL0107    WHASQT           Quantity on Han
     C                     Z-ADDWL0108    WHATQT           Quantity on Han
     C                     Z-ADDWL0109    WHHDQT           Quantity In Chi
     C                     Z-ADDWL0110    WHHEQT           Weight In Chill
     C                     MOVELWL0111    WHF6ST           Update Exceptio
     C                     Z-ADDWL0112    WHBMWG           Physical Start
     C                     Z-ADDWL0113    WHDSQT           Physical Start
     C                     Z-ADDWL0114    WHDTQT           Physical Start
     C                     Z-ADDWL0115    WHDUQT           Physical Start
     C                     Z-ADDWL0116    WHDHDT           Physical Start
     C                     Z-ADDWL0117    WHAGCS           Unit Cost Per P
     C                     Z-ADDWL0118    WHAECS           Last Cost
     C                     Z-ADDWL0119    WHIDVA           Value of On Han
     C                     Z-ADDWL0120    WHK7DT           Label Date
     C                     Z-ADDWL0121    WHRINB           Item Structure
     C                     Z-ADDWL0122    WHRHNB           Item Structure
     C                     Z-ADDWL0123    WHRGNB           Item Structure
     C                     MOVELWL0124    WHUVST           EDI Status 1
     C                     MOVELWL0125    WHUWST           EDI Status 2
     C                     MOVELWL0126    WHUXST           EDI Status 3
     C                     MOVELWL0127    WHVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WHAXDT    PARM *ZERO     WQ0038 155       Current System
     C           WHAATM    PARM *ZERO     WQ0039 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSJ    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0128    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0129           Lot Tracking Fl
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIVHST    WL0129           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDWL0130    WHAIC3           Company Number
     C                     Z-ADDWL0131    WHHGCD           Item Code
     C                     MOVELWL0132    WHAJCD           Warehouse Code
     C                     Z-ADDWL0133    WHELDT           Production Date
      *
     C           KLDLSL    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLDLSL    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0137           Quantity on Han
     C                     Z-ADD*ZERO     WL0138           Quantity on Han
     C                     Z-ADD*ZERO     WL0139           Quantity on Han
     C                     Z-ADD*ZERO     WL0140           Quantity on Han
     C                     Z-ADD*ZERO     WL0141           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WJHGCD    WQSM02           Item Code
     C           *LIKE     DEFN WJAJCD    WQSM03           Warehouse Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
     C                     KFLD           WQSM03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0134    WQSM01           Company Number
     C                     Z-ADDWL0135    WQSM02           Item Code
     C                     MOVELWL0136    WQSM03           Warehouse Code
      * Establish starting position
     C           KRSSM     SETLLCAB1RL4                    *
     C           KRSSM     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WJACWG    WL0137           Quantity on Han
     C                     ADD  WJARQT    WL0138           Quantity on Han
     C                     ADD  WJASQT    WL0139           Quantity on Han
     C                     ADD  WJATQT    WL0140           Quantity on Han
     C                     ADD  WJIDVA    WL0141           Value of On Han
     C           KRSSM     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0122 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0123 114       Last Cost
     C                     Z-ADD*ZERO     WN0124 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0125 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0126 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0127  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0128  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0129 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0130  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0131 112       On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0132 112       On Hand UOM3 Su
     C                     Z-ADD*ZERO     WN0133 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0134 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0135 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0136 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0137 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0138 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0139 112       Quantity Avail
     C                     MOVEL*BLANK    WN0140  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0141  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0142  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0143  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0144  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0145 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0146  70       Stock Out Date
     C                     MOVEL*BLANK    WN0147  3        Buyer Code
     C                     Z-ADD*ZERO     WN0148  30       Lead Time Last
     C                     Z-ADD*ZERO     WN0149  70       Lead Time Date
     C                     Z-ADD*ZERO     WN0150  30       Lead Time Next
     C                     Z-ADD*ZERO     WN0151  70       Lead Time Date
     C                     MOVEL*BLANK    WN0152  1        Lead Time Excep
     C                     Z-ADD*ZERO     WN0153 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0154 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0155  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0156 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0157 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0158  70       Last Physical C
     C                     MOVEL*BLANK    WN0159  1        Requisition Mod
     C                     MOVEL*BLANK    WN0160  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0161  1        Post GL Status
     C                     Z-ADD*ZERO     WN0162  80       Vendor Item_Whs
     C                     Z-ADD*ZERO     WN0163  30       Item Structure
     C                     Z-ADD*ZERO     WN0164  30       Item Structure
     C                     Z-ADD*ZERO     WN0165  30       Item Structure
     C                     MOVEL*BLANK    WN0166  1        EDI Status 1
     C                     MOVEL*BLANK    WN0167  1        EDI Status 2
     C                     MOVEL*BLANK    WN0168  1        EDI Status 3
     C                     MOVEL*BLANK    WN0169  1        Record Status
     C                     Z-ADD*ZERO     WN0170  60       Job Time
     C                     MOVEL*BLANK    WN0171 10        User Id
     C                     MOVEL*BLANK    WN0172 10        Job Name
     C                     Z-ADD*ZERO     WN0173  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWL0142    WKAIC3           Company Number
     C                     Z-ADDWL0143    WKHGCD           Item Code
     C                     MOVELWL0144    WKAJCD    P      Warehouse Code
      *
     C           KLCHSN    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
     C           KLCHSN    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YCRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWL0145    WKBOWG           On Hand Weight
     C                     Z-ADDWL0146    WKDDQT           On Hand UOM1 Su
     C                     Z-ADDWL0147    WKIDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YCRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDWKDDQT    WKDOQT           Quantity Avail
     C                     SUB  WKAQQT    WKDOQT           Quantity Avail
     C                     SUB  WKAUQT    WKDOQT           Quantity Avail
     C                     SUB  WKEMQT    WKDOQT           Quantity Avail
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Warehouse Info     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0148    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSO     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0149           Warehouse Descr
     C                     MOVEL*BLANK    WL0150           Address Line 1
     C                     MOVEL*BLANK    WL0151           Address Line 2
     C                     MOVEL*BLANK    WL0152           Address Line 3
     C                     MOVEL*BLANK    WL0153           City
     C                     MOVEL*BLANK    WL0154           Zip Postal Code
     C                     MOVEL*BLANK    WL0155           Production Ware
     C                     MOVEL*BLANK    WL0156           State Code
     C                     MOVEL*BLANK    WL0157           Lot Tracking Fl
     C                     MOVEL*BLANK    WL0158           Default Printer
     C                     MOVEL*BLANK    WL0159           Warehouse Type
     C                     MOVEL*BLANK    WL0160           Trans Contol AS
     C                     MOVEL*BLANK    WL0161           Warehouse Locat
     C                     MOVEL*BLANK    WL0162           Warehouse Std C
     C                     Z-ADD*ZERO     WL0163           Warehouse Chill
     C                     MOVEL*BLANK    WL0164           Include in Auto
     C                     MOVEL*BLANK    WL0165           Default Manifes
     C                     MOVEL*BLANK    WL0166           Default Load Se
     C                     MOVEL*BLANK    WL0167           WHS Slotting Li
     C                     Z-ADD*ZERO     WL0168           Shipping Compan
     C                     Z-ADD*ZERO     WL0169           Accounting Comp
     C                     Z-ADD*ZERO     WL0170           WHS Sched Prod
     C                     Z-ADD*ZERO     WL0171           WHS Inventory C
     C                     MOVEL*BLANK    WL0172           Parent Warehous
     C                     MOVEL*BLANK    WL0173           Default Shippin
     C                     MOVEL*BLANK    WL0174           WHS Live with C
     C                     MOVEL*BLANK    WL0175           WHS PFS Interfa
     C                     MOVEL*BLANK    WL0176           WHS Req Meter R
     C                     MOVEL*BLANK    WL0177           WHS Default Loa
     C                     MOVEL*BLANK    WL0178           WHS TMS Plannin
     C                     MOVEL*BLANK    WL0179           Default Carrier
     C                     MOVEL*BLANK    WL0180           Inventory Logic
     C                     MOVEL*BLANK    WL0181           WHS Auto Inv Re
     C                     MOVEL*BLANK    WL0182           EDI Status 1
     C                     MOVEL*BLANK    WL0183           EDI Status 2
     C                     MOVEL*BLANK    WL0184           EDI Status 3
     C                     MOVEL*BLANK    WL0185           Record Status
     C                     Z-ADD*ZERO     WL0186           Job Time
     C                     MOVEL*BLANK    WL0187           User Id
     C                     MOVEL*BLANK    WL0188           Job Name
     C                     Z-ADD*ZERO     WL0189           Job Date
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIF8NA    WL0149           Warehouse Descr
     C                     MOVELWIACNA    WL0150           Address Line 1
     C                     MOVELWIADNA    WL0151           Address Line 2
     C                     MOVELWIAENA    WL0152           Address Line 3
     C                     MOVELWIAJNA    WL0153           City
     C                     MOVELWIBTTX    WL0154           Zip Postal Code
     C                     MOVELWIAOCD    WL0155           Production Ware
     C                     MOVELWIBGCD    WL0156           State Code
     C                     MOVELWIVHST    WL0157           Lot Tracking Fl
     C                     MOVELWIMPNA    WL0158           Default Printer
     C                     MOVELWIWPST    WL0159           Warehouse Type
     C                     MOVELWIXUST    WL0160           Trans Contol AS
     C                     MOVELWIT0ST    WL0161           Warehouse Locat
     C                     MOVELWIT1ST    WL0162           Warehouse Std C
     C                     Z-ADDWIDBNB    WL0163           Warehouse Chill
     C                     MOVELWIT2ST    WL0164           Include in Auto
     C                     MOVELWIT3ST    WL0165           Default Manifes
     C                     MOVELWIT4ST    WL0166           Default Load Se
     C                     MOVELWIT6ST    WL0167           WHS Slotting Li
     C                     Z-ADDWIBWC3    WL0168           Shipping Compan
     C                     Z-ADDWIBTC3    WL0169           Accounting Comp
     C                     Z-ADDWIBUC3    WL0170           WHS Sched Prod
     C                     Z-ADDWIBVC3    WL0171           WHS Inventory C
     C                     MOVELWIFCAA    WL0172           Parent Warehous
     C                     MOVELWIRQSX    WL0173           Default Shippin
     C                     MOVELWIRRSX    WL0174           WHS Live with C
     C                     MOVELWIRSSX    WL0175           WHS PFS Interfa
     C                     MOVELWIRTSX    WL0176           WHS Req Meter R
     C                     MOVELWIT7ST    WL0177           WHS Default Loa
     C                     MOVELWIT8ST    WL0178           WHS TMS Plannin
     C                     MOVELWIRNSX    WL0179           Default Carrier
     C                     MOVELWIROSX    WL0180           Inventory Logic
     C                     MOVELWIRPSX    WL0181           WHS Auto Inv Re
     C                     MOVELWIUVST    WL0182           EDI Status 1
     C                     MOVELWIUWST    WL0183           EDI Status 2
     C                     MOVELWIUXST    WL0184           EDI Status 3
     C                     MOVELWIVSST    WL0185           Record Status
     C                     Z-ADDWIAATM    WL0186           Job Time
     C                     MOVELWIAYNA    WL0187           User Id
     C                     MOVELWIA0NA    WL0188           Job Name
     C                     Z-ADDWIAXDT    WL0189           Job Date
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Whse Location Info RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAJCD    WQSP01           Warehouse Code
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Warehouse Code
      * Setup key
     C                     MOVELWL0190    WQSP01           Warehouse Code
      * Establish starting position
     C           KRSSP     SETLL@L2RESM                    *
     C           KRSSP     READE@L2RESM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0191           Location Code
     C                     MOVEL*BLANK    WL0192           Location Aisle
     C                     Z-ADD*ZERO     WL0193           Location Bay
     C                     Z-ADD*ZERO     WL0194           Loc Unused Chil
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLYMCD    WL0191           Location Code
     C                     MOVELWLYPCD    WL0192           Location Aisle
     C                     Z-ADDWLLCBY    WL0193           Location Bay
     C                     Z-ADDWLLCCT    WL0194           Loc Unused Chil
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@L2RESM                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0195    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0196           Shipping Compan
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIBWC3    WL0196           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Val Item Balance       RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0197    WMAIC3           Company Number
     C                     Z-ADDWL0198    WMHGCD           Item Code
     C                     MOVELWL0199    WMAJCD           Warehouse Code
      * Establish starting position
     C           KRSSR     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0174  60       Job Time
     C                     MOVEL*BLANK    WN0175 10        User Id
     C                     MOVEL*BLANK    WN0176 10        Job Name
     C                     Z-ADD*ZERO     WN0177  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDWL0200    WKAIC3           Company Number
     C                     Z-ADDWL0201    WKHGCD           Item Code
     C                     MOVELWL0202    WKAJCD           Warehouse Code
     C                     Z-ADDWL0203    WKAGCS           Unit Cost Per P
     C                     Z-ADDWL0204    WKAECS           Last Cost
     C                     Z-ADDWL0205    WKBACS           Cost per Primar
     C                     Z-ADDWL0206    WKBBCS           Cost per Pricin
     C                     Z-ADDWL0207    WKCBPR           Revaluation Cos
     C                     Z-ADDWL0208    WKGUDT           Revaluation Eff
     C                     MOVELWL0209    WKXYST           Revaluation Cos
     C                     Z-ADDWL0210    WKCTPR           Last Revaluatio
     C                     Z-ADDWL0211    WKG4DT           Last Revaluatio
     C                     Z-ADDWL0212    WKBOWG           On Hand Weight
     C                     Z-ADDWL0213    WKDDQT           On Hand UOM1 Su
     C                     Z-ADDWL0214    WKDEQT           On Hand UOM2 Su
     C                     Z-ADDWL0215    WKDFQT           On Hand UOM3 Su
     C                     Z-ADDWL0216    WKHDQT           Quantity In Chi
     C                     Z-ADDWL0217    WKHEQT           Weight In Chill
     C                     Z-ADDWL0218    WKAJQT           Quantity Schedu
     C                     Z-ADDWL0219    WKAQQT           Quantity on Sal
     C                     Z-ADDWL0220    WKAUQT           Quantity on Pur
     C                     Z-ADDWL0221    WKEMQT           Quantity on Tra
     C                     Z-ADDWL0222    WKDOQT           Quantity Avail
     C                     MOVELWL0223    WKATNA           Cycle Count Cod
     C                     Z-ADDWL0224    WKAKDT           Date of Last Or
     C                     Z-ADDWL0225    WKANDT           Date of Last Sh
     C                     Z-ADDWL0226    WKIDVA           Value of On Han
     C                     MOVELWL0227    WKJVST           Inventory Plann
     C                     Z-ADDWL0228    WKBZPC           Safety Allowanc
     C                     Z-ADDWL0229    WKDGQT           Safety Allowanc
     C                     Z-ADDWL0230    WKDIDT           Stock Out Date
     C                     MOVELWL0231    WKALCD           Buyer Code
     C                     Z-ADDWL0232    WKBFDY           Lead Time Last
     C                     Z-ADDWL0233    WKDJDT           Lead Time Date
     C                     Z-ADDWL0234    WKBGDY           Lead Time Next
     C                     Z-ADDWL0235    WKDKDT           Lead Time Date
     C                     MOVELWL0236    WKJ2ST           Lead Time Excep
     C                     Z-ADDWL0237    WKDJQT           Usage Qty per C
     C                     Z-ADDWL0238    WKBNWG           Usage Weight pe
     C                     Z-ADDWL0239    WKDLDT           Inventory Manag
     C                     Z-ADDWL0240    WKDPQT           Minimum Quantit
     C                     Z-ADDWL0241    WKDQQT           Maximum Quantit
     C                     Z-ADDWL0242    WKDMDT           Last Physical C
     C                     MOVELWL0243    WKM0ST           Requisition Mod
     C                     MOVELWL0244    WKJ9ST           Cost Update Pen
     C                     MOVELWL0245    WKKBST           Post GL Status
     C                     Z-ADDWL0246    WKAKC8           Vendor Item_Whs
     C                     Z-ADDWL0247    WKRINB           Item Structure
     C                     Z-ADDWL0248    WKRHNB           Item Structure
     C                     Z-ADDWL0249    WKRGNB           Item Structure
     C                     MOVELWL0250    WKUVST           EDI Status 1
     C                     MOVELWL0251    WKUWST           EDI Status 2
     C                     MOVELWL0252    WKUXST           EDI Status 3
     C                     MOVELWL0253    WKVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
     C           KLCRSS    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSS    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'Item Balance           EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Prc Create Dtl Receipt RT - Item Transaction Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0178  2        UOM Cost
     C                     Z-ADD*ZERO     WN0179 112       Extended Amount
     C                     MOVEL*BLANK    WN0180  1        GL Update Statu
     C                     MOVEL*BLANK    WN0181 30        Description Lin
     C                     MOVEL*BLANK    WN0182  2        UOM Primary
     C                     Z-ADD*ZERO     WN0183  94       Conversion Fact
     C                     MOVEL*BLANK    WN0184  1        Operation Facto
     C                     MOVEL*BLANK    WN0185  2        UOM Second
     C                     Z-ADD*ZERO     WN0186  94       Conversion Fact
     C                     MOVEL*BLANK    WN0187  1        Operation Facto
     C                     MOVEL*BLANK    WN0188  2        UOM Third
     C                     MOVEL*BLANK    WN0189  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0190 112       Unit Weight
     C                     MOVEL*BLANK    WN0191  1        Production Date
     C                     MOVEL*BLANK    WN0192  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0193  30       Item Structure
     C                     Z-ADD*ZERO     WN0194  30       Item Structure
     C                     Z-ADD*ZERO     WN0195  30       Item Structure
     C                     Z-ADD*ZERO     WN0196 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0197 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0198 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0199 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0200 114       Unit Cost Per P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOHGCD           Item Code
     C                     KFLD           WOAJCD           Warehouse Code
     C                     KFLD           WOW9ST           Inventory Trans
     C                     KFLD           WOBSST           Inventory Trans
     C                     KFLD           WOB4DT           Transaction Dat
     C                     KFLD           WOC4NY           ITD Sequence Nu
     C                     KFLD           WODXNB           Sequence Number
      * Setup key
     C                     Z-ADDWL0254    WOAIC3           Company Number
     C                     Z-ADDWL0255    WOHGCD           Item Code
     C                     MOVELWL0256    WOAJCD           Warehouse Code
     C                     MOVELWL0257    WOW9ST           Inventory Trans
     C                     MOVELWL0258    WOBSST           Inventory Trans
     C                     Z-ADDWL0259    WOB4DT           Transaction Dat
     C                     Z-ADDWL0260    WOC4NY           ITD Sequence Nu
     C                     Z-ADDWL0261    WODXNB           Sequence Number
      * Establish starting position
     C           KRSST     CHAINRB7CPJ3              90    *
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Base Values        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWOAIC3    WL0001           Company Number
     C                     Z-ADDWOHGCD    WL0002           Item Code
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WN0181    P      Description Lin
     C                     MOVELWL0004    WUAWNA    P      Description Lin
     C                     MOVELWL0005    WN0182    P      UOM Primary
     C                     Z-ADDWL0006    WN0183           Conversion Fact
     C                     MOVELWL0007    WN0184    P      Operation Facto
     C                     MOVELWL0008    WN0185    P      UOM Second
     C                     Z-ADDWL0009    WN0186           Conversion Fact
     C                     MOVELWL0010    WN0187    P      Operation Facto
     C                     MOVELWL0011    WN0188    P      UOM Third
     C                     MOVELWL0012    WUAICD    P      UOM Pricing
     C                     Z-ADDWL0013    WN0190           Unit Weight
     C                     MOVELWL0014    WN0191    P      Production Date
     C                     MOVELWL0015    WN0192    P      Catch Weight St
     C                     Z-ADDWL0016    WUCHTM           Fresh Chilling
      * Rtv Quantity/Dollars   RT - Item Balance  * 
     C                     EXSR SURVGN
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
     C                     EXSR SVCHRC
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Quantity/Dollars   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWOAIC3    WBAIC3           Company Number
     C                     Z-ADDWOHGCD    WBHGCD           Item Code
     C                     MOVELWOAJCD    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSU     CHAIN@B0REJX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0200           Unit Cost Per P
     C                     Z-ADD*ZERO     WN0196           On Hand Weight
     C                     Z-ADD*ZERO     WN0197           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WN0198           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WN0199           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WUIDVA           Value of On Han
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAGCS    WN0200           Unit Cost Per P
     C                     Z-ADDWBBOWG    WN0196           On Hand Weight
     C                     Z-ADDWBDDQT    WN0197           On Hand UOM1 Su
     C                     Z-ADDWBDEQT    WN0198           On Hand UOM2 Su
     C                     Z-ADDWBDFQT    WN0199           On Hand UOM3 Su
     C                     Z-ADDWBIDVA    WUIDVA           Value of On Han
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * UPD Value/Qty/Wgt      CH - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0201 112       Quantity based
     C                     Z-ADD*ZERO     WN0202 112       Quantity based
     C                     Z-ADD*ZERO     WN0203 112       Quantity based
     C                     Z-ADD*ZERO     WN0204 114       Cost based on U
     C                     Z-ADD*ZERO     WN0205 114       Cost based on U
     C                     Z-ADD*ZERO     WN0206 114       Cost based on U
     C                     Z-ADD*ZERO     WN0207 112       Quantity Total
     C                     Z-ADD*ZERO     WN0208 112       Quantity Total
     C                     Z-ADD*ZERO     WN0209 112       Cost Replace Do
     C                     Z-ADD*ZERO     WN0210 112       USR Allocated P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      *
     C                     Z-ADD*ZERO     WN0211 114       Cost based on U
     C                     Z-ADD*ZERO     WN0212 114       Cost based on U
     C                     Z-ADD*ZERO     WN0213 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0204           Cost based on U
     C                     Z-ADD*ZERO     WN0205           Cost based on U
     C                     Z-ADD*ZERO     WN0206           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           WN0182    IFEQ WOCGCD                     *IF
     C                     Z-ADDWN0200    WN0204           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           WN0185    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0184    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0183    IFNE 0                          *IF
     C           WN0200    DIV  WN0183    WN0212    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0184    IFEQ 'D'                        *IF
     C           WN0200    MULT WN0183    WN0212    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0212    WN0205           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0188    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0187    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0186    IFNE 0                          *IF
     C           WN0212    DIV  WN0186    WN0206    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0187    IFEQ 'D'                        *IF
     C           WN0212    MULT WN0186    WN0206    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           WN0185    IFEQ WOCGCD                     *IF
     C                     Z-ADDWN0200    WN0205           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0184    IFEQ 'M'                        *IF
     C           WN0200    MULT WN0183    WN0204    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0184    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0183    IFNE 0                          *IF
     C           WN0200    DIV  WN0183    WN0204    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0188    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0187    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0186    IFNE 0                          *IF
     C           WN0200    DIV  WN0186    WN0206    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0187    IFEQ 'D'                        *IF
     C           WN0200    MULT WN0186    WN0206    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           WN0188    IFEQ WOCGCD                     *IF
     C                     Z-ADDWN0200    WN0206           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0187    IFEQ 'M'                        *IF
     C           WN0200    MULT WN0186    WN0212    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0187    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0186    IFNE 0                          *IF
     C           WN0200    DIV  WN0186    WN0212    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0212    WN0205           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0184    IFEQ 'M'                        *IF
     C           WN0212    MULT WN0183    WN0204    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0184    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0183    IFNE 0                          *IF
     C           WN0212    DIV  WN0183    WN0204    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0214 112       Quantity based
     C                     Z-ADD*ZERO     WN0215 112       Quantity based
     C                     Z-ADD*ZERO     WN0216 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0201           USR Qty based o
     C                     Z-ADD*ZERO     WN0202           USR Qty based o
     C                     Z-ADD*ZERO     WN0203           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           WN0182    IFEQ WOHVCD                     *IF
     C                     Z-ADDWOA5QT    WN0201           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           WN0185    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0184    IFEQ 'M'                        *IF
     C           WOA5QT    MULT WN0183    WN0215    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0184    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0183    IFNE 0                          *IF
     C           WOA5QT    DIV  WN0183    WN0215    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0215    WN0202           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0188    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0187    IFEQ 'M'                        *IF
     C           WN0215    MULT WN0186    WN0216    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0187    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0186    IFNE 0                          *IF
     C           WN0215    DIV  WN0186    WN0216    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0216    WN0203           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           WN0185    IFEQ WOHVCD                     *IF
     C                     Z-ADDWOA5QT    WN0202           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0184    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0183    IFNE 0                          *IF
     C           WOA5QT    DIV  WN0183    WN0201    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0184    IFEQ 'D'                        *IF
     C           WOA5QT    MULT WN0183    WN0201    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0188    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0187    IFEQ 'M'                        *IF
     C           WOA5QT    MULT WN0186    WN0216    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0187    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0186    IFNE 0                          *IF
     C           WOA5QT    DIV  WN0186    WN0216    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0216    WN0203           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           WN0188    IFEQ WOHVCD                     *IF
     C                     Z-ADDWOA5QT    WN0203           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0187    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0186    IFNE 0                          *IF
     C           WOA5QT    DIV  WN0186    WN0215    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0187    IFEQ 'D'                        *IF
     C           WOA5QT    MULT WN0186    WN0215    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0215    WN0202           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0184    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0183    IFNE 0                          *IF
     C           WN0215    DIV  WN0183    WN0201    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0184    IFEQ 'D'                        *IF
     C           WN0215    MULT WN0183    WN0201    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWOAIC3    WKAIC3           Company Number
     C                     Z-ADDWOHGCD    WKHGCD           Item Code
     C                     MOVELWOAJCD    WKAJCD    P      Warehouse Code
      *
     C           KLCHSV    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
     C           KLCHSV    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YDRDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YDRDC            *Record Data Ch
      * (Creates IB if not found or updates if it exists)
      * Update IC Item Balance Detail
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
     C                     EXSR SWRVGN
      * Update the quantity/weight on hand in the item balance file
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0134           Company Number
     C                     Z-ADDWKHGCD    WL0135           Item Code
     C                     MOVELWKAJCD    WL0136    P      Warehouse Code
     C                     Z-ADDWKBOWG    WL0137           Quantity on Han
     C                     Z-ADDWKDDQT    WL0138           Quantity on Han
     C                     Z-ADDWUNFNN    WL0139           Quantity on Han
     C                     Z-ADDWUNFNN    WL0140           Quantity on Han
     C                     Z-ADDWKIDVA    WL0141           Value of On Han
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0137    WKBOWG           Quantity on Han
     C                     Z-ADDWL0138    WKDDQT           Quantity on Han
     C                     Z-ADDWL0139    WUNFNN           Quantity on Han
     C                     Z-ADDWL0140    WUNFNN           Quantity on Han
     C                     Z-ADDWL0141    WKIDVA           Value of On Han
     C                     Z-ADD*ZERO     WKDOQT           Available Prima
      * Available Primary U/M
     C           WKDDQT    SUB  WKAJQT    WKDOQT           Available Prima
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WKAATM' defaulted for 'Job Time'.
      * Field '(DB1) WKAYNA' defaulted for 'User Id'.
      * Field '(DB1) WKA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WKAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * UPD Value/Qty          RT - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0217 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0218 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0219 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0220 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0221 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0222 114       Last Cost
     C                     Z-ADD*ZERO     WN0223 112       Value of On Han
     C                     MOVEL*BLANK    WN0224  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
     C                     KFLD           WRAJCD           Warehouse Code
     C                     KFLD           WRELDT           Production Date
      * Setup key
     C                     Z-ADDWKAIC3    WRAIC3           Company Number
     C                     Z-ADDWKHGCD    WRHGCD           Item Code
     C                     MOVELWKAJCD    WRAJCD           Warehouse Code
     C                     Z-ADDWOELDT    WRELDT           Production Date
      * Establish starting position
     C           KRSSW     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Quantity based on U/M1 S EQ WRK.ZERO
     C           WN0201    IFEQ WUW0NB                     *IF
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0096           Company Number
     C                     Z-ADDWKHGCD    WL0097           Item Code
     C                     MOVELWKAJCD    WL0098    P      Warehouse Code
     C                     Z-ADDWOELDT    WL0099           Production Date
     C                     Z-ADD*ZERO     WL0100           Physical Count
     C                     Z-ADD*ZERO     WL0101           Physical Count
     C                     Z-ADD*ZERO     WL0102           Physical Count
     C                     Z-ADD*ZERO     WL0103           Physical Count
     C                     MOVEL*BLANK    WL0104           Physical Count
     C                     Z-ADD*ZERO     WL0105           Quantity on Han
     C                     Z-ADDWN0201    WL0106           Quantity on Han
     C                     Z-ADD*ZERO     WL0107           Quantity on Han
     C                     Z-ADD*ZERO     WL0108           Quantity on Han
     C                     Z-ADD*ZERO     WL0109           Quantity In Chi
     C                     Z-ADD*ZERO     WL0110           Weight In Chill
     C                     MOVEL'N'       WL0111    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0112           Physical Start
     C                     Z-ADD*ZERO     WL0113           Physical Start
     C                     Z-ADD*ZERO     WL0114           Physical Start
     C                     Z-ADD*ZERO     WL0115           Physical Start
     C                     Z-ADD*ZERO     WL0116           Physical Start
     C                     Z-ADD*ZERO     WL0117           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0118           Last Cost
     C                     Z-ADD*ZERO     WL0119           Value of On Han
     C                     Z-ADDWOK7DT    WL0120           Label Date
     C                     Z-ADDWKRINB    WL0121           Item Structure
     C                     Z-ADDWKRHNB    WL0122           Item Structure
     C                     Z-ADDWKRGNB    WL0123           Item Structure
     C                     MOVEL*BLANK    WL0124           EDI Status 1
     C                     MOVEL*BLANK    WL0125           EDI Status 2
     C                     MOVEL*BLANK    WL0126           EDI Status 3
     C                     MOVEL'A'       WL0127    P      Record Status
     C                     EXSR SJCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0096           Company Number
     C                     Z-ADDWKHGCD    WL0097           Item Code
     C                     MOVELWKAJCD    WL0098    P      Warehouse Code
     C                     Z-ADDWOELDT    WL0099           Production Date
     C                     Z-ADD*ZERO     WL0100           Physical Count
     C                     Z-ADD*ZERO     WL0101           Physical Count
     C                     Z-ADD*ZERO     WL0102           Physical Count
     C                     Z-ADD*ZERO     WL0103           Physical Count
     C                     MOVEL*BLANK    WL0104           Physical Count
     C                     Z-ADDWOAHWG    WL0105           Quantity on Han
     C                     Z-ADDWN0201    WL0106           Quantity on Han
     C                     Z-ADD*ZERO     WL0107           Quantity on Han
     C                     Z-ADD*ZERO     WL0108           Quantity on Han
     C                     Z-ADD*ZERO     WL0109           Quantity In Chi
     C                     Z-ADD*ZERO     WL0110           Weight In Chill
     C                     MOVEL'N'       WL0111    P      Update Exceptio
     C                     Z-ADD*ZERO     WL0112           Physical Start
     C                     Z-ADD*ZERO     WL0113           Physical Start
     C                     Z-ADD*ZERO     WL0114           Physical Start
     C                     Z-ADD*ZERO     WL0115           Physical Start
     C                     Z-ADD*ZERO     WL0116           Physical Start
     C                     Z-ADD*ZERO     WL0117           Unit Cost Per P
     C                     Z-ADD*ZERO     WL0118           Last Cost
     C                     Z-ADDWOAYVA    WL0119           Value of On Han
     C                     Z-ADDWOK7DT    WL0120           Label Date
     C                     Z-ADDWKRINB    WL0121           Item Structure
     C                     Z-ADDWKRHNB    WL0122           Item Structure
     C                     Z-ADDWKRGNB    WL0123           Item Structure
     C                     MOVEL*BLANK    WL0124           EDI Status 1
     C                     MOVEL*BLANK    WL0125           EDI Status 2
     C                     MOVEL*BLANK    WL0126           EDI Status 3
     C                     MOVEL'A'       WL0127    P      Record Status
     C                     EXSR SJCRRC
     C                     END                             *FI
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Calculate new On Hand Value
      * CASE: PAR.Inventory Trans. Type is Adjustment Cycle Count
     C           WOBSST    IFEQ 'AC'                       *IF
     C           WRIDVA    ADD  WOAYVA    WN0223           Value of On Han
     C                     ELSE
      * CASE: PAR.Inventory Trans. Type is Quantity based Avg. Cost
     C           WOBSST    IFEQ 'R'                        *IF
     C           WOBSST    OREQ 'RP'
     C           WOBSST    OREQ 'S'
     C           WOBSST    OREQ 'TW'
     C           WOBSST    OREQ 'RW'
     C           WOBSST    OREQ 'RR'
     C           WRIDVA    ADD  WOAYVA    WN0223           Value of On Han
     C                     END                             *FI
     C                     END                             *FI
     C           WOAHWG    ADD  WRACWG    WN0217           Quantity on Han
     C           WRARQT    ADD  WN0201    WN0218           Quantity on Han
      * If quantity goes TO exactly 0, wgt and value to go 0
      * CASE: PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WN0218    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - IC Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WRAIC3    WQ0065  30       Company Number
     C                     PARM WRHGCD    WQ0066  70       Item Code
     C                     PARM WRAJCD    WQ0067  3        Warehouse Code
     C                     PARM WOB4DT    WQ0068  70       Transaction Dat
     C                     PARM WRELDT    WQ0069  70       Production Date
     C                     PARM WOHVCD    WQ0070  2        UOM Transaction
     C                     PARM WN0217    WQ0071 112       Transaction Wei
     C                     PARM WN0221    WQ0072 114       USR Transaction
     C                     PARM WOCGCD    WQ0073  2        UOM Cost
     C                     PARM WRRINB    WQ0074  30       Item Structure
     C                     PARM WRRHNB    WQ0075  30       Item Structure
     C                     PARM WRRGNB    WQ0076  30       Item Structure
     C                     PARM WL0262    WQ0077  1        Shift Number
     C                     PARM WRK7DT    WQ0078  70       Label Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0217           Quantity on Han
     C                     Z-ADD*ZERO     WN0223           Value of On Han
     C                     END                             *FI
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWRAJCD    WL0128    P      Warehouse Code
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0129    WN0224    P      Lot Tracking Fl
      * CASE: Qty = 0 & production date <> 0 & Lot Trk=N
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Quantity on Hand - U/M1 EQ WRK.ZERO
      *   |- c2    : DB1.Production Date NE WRK.ZERO
      *   |- c3    : PAR.Lot Tracking Flag is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0218    IFEQ WUW0NB                     *IF
     C           WRELDT    IFNE WUW0NB                     *IF
     C           WN0224    IFEQ *BLANK                     *IF
     C           WN0224    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0130           Company Number
     C                     Z-ADDWRHGCD    WL0131           Item Code
     C                     MOVELWRAJCD    WL0132    P      Warehouse Code
     C                     Z-ADDWRELDT    WL0133           Production Date
     C                     EXSR SLDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
     C                     EXSR SXCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0225  70       Label Date
     C                     MOVEL*BLANK    WN0226  1        EDI Status 1
     C                     MOVEL*BLANK    WN0227  1        EDI Status 2
     C                     MOVEL*BLANK    WN0228  1        EDI Status 3
     C                     MOVEL*BLANK    WN0229  1        Record Status
     C                     Z-ADD*ZERO     WN0230  60       Job Time
     C                     MOVEL*BLANK    WN0231 10        User Id
     C                     MOVEL*BLANK    WN0232 10        Job Name
     C                     Z-ADD*ZERO     WN0233  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWRAIC3    WHAIC3           Company Number
     C                     Z-ADDWRHGCD    WHHGCD           Item Code
     C                     MOVELWRAJCD    WHAJCD    P      Warehouse Code
     C                     Z-ADDWRELDT    WHELDT           Production Date
      *
     C           KLCHSX    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLCHSX    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YERDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWRABWG    WHABWG           Physical Count
     C                     Z-ADDWRAGQT    WHAGQT           Physical Count
     C                     Z-ADDWRAHQT    WHAHQT           Physical Count
     C                     Z-ADDWRAIQT    WHAIQT           Physical Count
     C                     MOVELWRCTST    WHCTST    P      Physical Count
     C                     Z-ADDWN0217    WHACWG           Quantity on Han
     C                     Z-ADDWN0218    WHARQT           Quantity on Han
     C                     Z-ADDWRASQT    WHASQT           Quantity on Han
     C                     Z-ADDWRATQT    WHATQT           Quantity on Han
     C                     Z-ADDWRHDQT    WHHDQT           Quantity In Chi
     C                     Z-ADDWRHEQT    WHHEQT           Weight In Chill
     C                     MOVELWRF6ST    WHF6ST    P      Update Exceptio
     C                     Z-ADDWRBMWG    WHBMWG           Physical Start
     C                     Z-ADDWRDSQT    WHDSQT           Physical Start
     C                     Z-ADDWRDTQT    WHDTQT           Physical Start
     C                     Z-ADDWRDUQT    WHDUQT           Physical Start
     C                     Z-ADDWRDHDT    WHDHDT           Physical Start
     C                     Z-ADDWRAGCS    WHAGCS           Unit Cost Per P
     C                     Z-ADDWRAECS    WHAECS           Last Cost
     C                     Z-ADDWN0223    WHIDVA           Value of On Han
     C                     Z-ADDWRRINB    WHRINB           Item Structure
     C                     Z-ADDWRRHNB    WHRHNB           Item Structure
     C                     Z-ADDWRRGNB    WHRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C                     MOVEL##PGM     WHA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WSDOCD           System Value Co
      * Setup key
     C                     MOVEL@CN,003   WSDOCD           System Value Co
      * Establish starting position
     C           KRSSY     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWSM8NB    YL0015           System Value Nu
     C                     GOTO SYEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Reset Production/Label Date if Lot Tracking warehouse.
      *================================================================
     C                     Z-ADDP1ELDT    WN0072           Production Date
     C                     Z-ADDP1K7DT    WN0073           Label Date  USR
      * Determine the Lot Tracking Flag for From Warehouse.
      * If the From Warehouse Lot Tracking Flag is "N", then perform the
      * following "Clc" to determine if the To Warehouse Lot Tracking
      * Flag is "Y" and replace the Production Date with Job Date if it
      * is "Y".
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1A5QT           Transaction Qua
     C                     Z-ADD*ZERO     P1AHWG           Transaction Wei
     C                     Z-ADD*ZERO     P1TRBN           Transfer Batch
     C                     Z-ADD*ZERO     P1TRBS           Transfer Batch
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2ADCD           UOM Primary
     C                     Z-ADD*ZERO     P2AWPC           Conversion Fact
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     MOVEL*BLANK    P2AECD           UOM Second
     C                     Z-ADD*ZERO     P2AXPC           Conversion Fact
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     MOVEL*BLANK    P2AFCD           UOM Third
     C                     MOVEL*BLANK    P2AICD           UOM Pricing
     C                     Z-ADD*ZERO     P2AIWG           Unit Weight
     C                     MOVEL*BLANK    P2FZST           Production Date
     C                     MOVEL*BLANK    P2AVST           Catch Weight St
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6AGCS           Unit Cost Per P
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7ARCS           Unit Cost - Det
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBBACS           Cost per Primar
     C                     Z-ADD*ZERO     WBBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WBCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WBGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WBCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WBG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WBBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WBDDQT           On Hand UOM1 Su
     C                     Z-ADD*ZERO     WBDEQT           On Hand UOM2 Su
     C                     Z-ADD*ZERO     WBDFQT           On Hand UOM3 Su
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WBAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WBEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WBDOQT           Quantity Avail
     C                     Z-ADD*ZERO     WBAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WBANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WBDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WBDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WBBFDY           Lead Time Last
     C                     Z-ADD*ZERO     WBDJDT           Lead Time Date
     C                     Z-ADD*ZERO     WBBGDY           Lead Time Next
     C                     Z-ADD*ZERO     WBDKDT           Lead Time Date
     C                     Z-ADD*ZERO     WBDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WBBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WBDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WBDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WBDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WBDMDT           Last Physical C
     C                     Z-ADD*ZERO     WBAKC8           Vendor Item_Whs
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAXNB           Current Account
     C                     Z-ADD*ZERO     WCNGNB           Current Account
     C                     Z-ADD*ZERO     WCBZNB           OM Week
     C                     Z-ADD*ZERO     WCC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WCC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WCCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WCIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WCI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WCDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WCC7NB           Next Customer #
     C                     Z-ADD*ZERO     WCC2NB           Next Inventory
     C                     Z-ADD*ZERO     WCC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WCL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WCBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WCAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WCASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WCA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WCAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WCABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WCACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WCADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WCAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WCAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WCAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WCAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WCAENB           Retention Perio
     C                     Z-ADD*ZERO     WCALNB           Retention Perio
     C                     Z-ADD*ZERO     WCEVNB           Retention Perio
     C                     Z-ADD*ZERO     WCRPOP           Retention Perio
     C                     Z-ADD*ZERO     WCDWNB           Retention Perio
     C                     Z-ADD*ZERO     WCR3NB           Next Load ID
     C                     Z-ADD*ZERO     WCR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WCSCNB           Production Numb
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Load ID
     C                     Z-ADD*ZERO     WURMNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           AR Customer Num
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Lot Number USR
     C                     Z-ADD*ZERO     WULTNT  50
      * Define work field Lot Number
     C                     Z-ADD*ZERO     WULXNM  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHUNZ           Release Number
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,001   XDTSDL
     C                     MOVELXDTSDL    WEBGTS           Create Date Tim
     C                     MOVELXDTSDL    WEBHTS           Update Date Tim
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Transaction Weight
     C                     Z-ADD*ZERO     WUAHWG 112
      * Define work field Transaction Quantity
     C                     Z-ADD*ZERO     WUA5QT 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WFC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WFDXNB           Sequence Number
     C                     Z-ADD*ZERO     WFELDT           Production Date
     C                     Z-ADD*ZERO     WFA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WFAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WFAKCS           USR Transaction
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFCKNB           GL Document Num
     C                     Z-ADD*ZERO     WFTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WFTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFAWTM           Production Time
     C                     Z-ADD*ZERO     WFK7DT           Label Date
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. W/SystDt CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHABWG           Physical Count
     C                     Z-ADD*ZERO     WHAGQT           Physical Count
     C                     Z-ADD*ZERO     WHAHQT           Physical Count
     C                     Z-ADD*ZERO     WHAIQT           Physical Count
     C                     Z-ADD*ZERO     WHACWG           Quantity on Han
     C                     Z-ADD*ZERO     WHARQT           Quantity on Han
     C                     Z-ADD*ZERO     WHASQT           Quantity on Han
     C                     Z-ADD*ZERO     WHATQT           Quantity on Han
     C                     Z-ADD*ZERO     WHHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WHHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WHBMWG           Physical Start
     C                     Z-ADD*ZERO     WHDSQT           Physical Start
     C                     Z-ADD*ZERO     WHDTQT           Physical Start
     C                     Z-ADD*ZERO     WHDUQT           Physical Start
     C                     Z-ADD*ZERO     WHDHDT           Physical Start
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAECS           Last Cost
     C                     Z-ADD*ZERO     WHIDVA           Value of On Han
     C                     Z-ADD*ZERO     WHK7DT           Label Date
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WIBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field Location Code
     C                     MOVEL*BLANK    WUYMCD  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLLCBY           Location Bay
     C                     Z-ADD*ZERO     WLLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field Location Level
     C                     Z-ADD*ZERO     WUYNCD  20
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Clear all neither parameters
      * Crt Item Balance       CR - Item Balance  * 
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field UOM Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Value of On Hand Inventor
     C                     Z-ADD*ZERO     WUIDVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSM8NB           System Value Nu
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005  2
     C                     Z-ADD*ZERO     WL0006  94
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  2
     C                     Z-ADD*ZERO     WL0009  94
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  2
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013 112
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     Z-ADD*ZERO     WL0016  52
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     MOVEL*BLANK    WL0019  3
     C                     Z-ADD*ZERO     WL0020 114
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  30
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028  3
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  2
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  50
      * Define local variables for subroutine SHCRRC.
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  70
     C                     MOVEL*BLANK    WL0035  3
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  2
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039  50
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  2
     C                     MOVEL*BLANK    WL0043  2
     C                     MOVEL*BLANK    WL0044 30
     C                     Z-ADD*ZERO     WL0045 112
     C                     Z-ADD*ZERO     WL0046 112
     C                     Z-ADD*ZERO     WL0047 114
     C                     MOVEL*BLANK    WL0048  2
     C                     Z-ADD*ZERO     WL0049 112
     C                     MOVEL*BLANK    WL0050  6
     C                     Z-ADD*ZERO     WL0051  80
     C                     MOVEL*BLANK    WL0052  1
     C                     MOVEL*BLANK    WL0053  3
     C                     MOVEL*BLANK    WL0054 15
     C                     MOVEL*BLANK    WL0055 10
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  30
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  30
     C                     Z-ADD*ZERO     WL0060  30
     C                     Z-ADD*ZERO     WL0061  30
     C                     MOVEL*BLANK    WL0062 10
     C                     Z-ADD*ZERO     WL0063  60
     C                     MOVEL*BLANK    WL0064  1
     C                     Z-ADD*ZERO     WL0065  70
     C                     MOVEL*BLANK    WL0066  1
     C                     MOVEL*BLANK    WL0067  1
     C                     MOVEL*BLANK    WL0068  1
     C                     MOVEL*BLANK    WL0069  1
      * Define local variables for subroutine SICHRC.
     C                     Z-ADD*ZERO     WL0070  30
     C                     Z-ADD*ZERO     WL0071  70
     C                     MOVEL*BLANK    WL0072  3
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  30
     C                     Z-ADD*ZERO     WL0075  30
     C                     Z-ADD*ZERO     WL0076  30
     C                     MOVEL*BLANK    WL0077  2
     C                     Z-ADD*ZERO     WL0078  94
     C                     MOVEL*BLANK    WL0079  1
     C                     MOVEL*BLANK    WL0080  2
     C                     Z-ADD*ZERO     WL0081  94
     C                     MOVEL*BLANK    WL0082  1
     C                     MOVEL*BLANK    WL0083  2
     C                     MOVEL*BLANK    WL0084  1
     C                     MOVEL*BLANK    WL0085  1
     C                     MOVEL*BLANK    WL0086  1
     C                     MOVEL*BLANK    WL0087  2
     C                     Z-ADD*ZERO     WL0088  70
     C                     MOVEL*BLANK    WL0089  2
     C                     Z-ADD*ZERO     WL0090 112
     C                     Z-ADD*ZERO     WL0091 112
     C                     Z-ADD*ZERO     WL0092 114
     C                     MOVEL*BLANK    WL0093  2
     C                     Z-ADD*ZERO     WL0094 112
     C                     Z-ADD*ZERO     WL0095  70
      * Define local variables for subroutine SJCRRC.
     C                     Z-ADD*ZERO     WL0096  30
     C                     Z-ADD*ZERO     WL0097  70
     C                     MOVEL*BLANK    WL0098  3
     C                     Z-ADD*ZERO     WL0099  70
     C                     Z-ADD*ZERO     WL0100 112
     C                     Z-ADD*ZERO     WL0101 112
     C                     Z-ADD*ZERO     WL0102 112
     C                     Z-ADD*ZERO     WL0103 112
     C                     MOVEL*BLANK    WL0104  1
     C                     Z-ADD*ZERO     WL0105 112
     C                     Z-ADD*ZERO     WL0106 112
     C                     Z-ADD*ZERO     WL0107 112
     C                     Z-ADD*ZERO     WL0108 112
     C                     Z-ADD*ZERO     WL0109 112
     C                     Z-ADD*ZERO     WL0110 112
     C                     MOVEL*BLANK    WL0111  1
     C                     Z-ADD*ZERO     WL0112 112
     C                     Z-ADD*ZERO     WL0113 112
     C                     Z-ADD*ZERO     WL0114 112
     C                     Z-ADD*ZERO     WL0115 112
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117 114
     C                     Z-ADD*ZERO     WL0118 114
     C                     Z-ADD*ZERO     WL0119 112
     C                     Z-ADD*ZERO     WL0120  70
     C                     Z-ADD*ZERO     WL0121  30
     C                     Z-ADD*ZERO     WL0122  30
     C                     Z-ADD*ZERO     WL0123  30
     C                     MOVEL*BLANK    WL0124  1
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
      * Define local variables for subroutine SKRVGN.
     C                     MOVEL*BLANK    WL0128  3
     C                     MOVEL*BLANK    WL0129  1
      * Define local variables for subroutine SLDLRC.
     C                     Z-ADD*ZERO     WL0130  30
     C                     Z-ADD*ZERO     WL0131  70
     C                     MOVEL*BLANK    WL0132  3
     C                     Z-ADD*ZERO     WL0133  70
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0134  30
     C                     Z-ADD*ZERO     WL0135  70
     C                     MOVEL*BLANK    WL0136  3
     C                     Z-ADD*ZERO     WL0137 112
     C                     Z-ADD*ZERO     WL0138 112
     C                     Z-ADD*ZERO     WL0139 112
     C                     Z-ADD*ZERO     WL0140 112
     C                     Z-ADD*ZERO     WL0141 112
      * Define local variables for subroutine SNCHRC.
     C                     Z-ADD*ZERO     WL0142  30
     C                     Z-ADD*ZERO     WL0143  70
     C                     MOVEL*BLANK    WL0144  3
     C                     Z-ADD*ZERO     WL0145 112
     C                     Z-ADD*ZERO     WL0146 112
     C                     Z-ADD*ZERO     WL0147 112
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0148  3
     C                     MOVEL*BLANK    WL0149 30
     C                     MOVEL*BLANK    WL0150 30
     C                     MOVEL*BLANK    WL0151 30
     C                     MOVEL*BLANK    WL0152 30
     C                     MOVEL*BLANK    WL0153 20
     C                     MOVEL*BLANK    WL0154 11
     C                     MOVEL*BLANK    WL0155  3
     C                     MOVEL*BLANK    WL0156  2
     C                     MOVEL*BLANK    WL0157  1
     C                     MOVEL*BLANK    WL0158 10
     C                     MOVEL*BLANK    WL0159  2
     C                     MOVEL*BLANK    WL0160  1
     C                     MOVEL*BLANK    WL0161  1
     C                     MOVEL*BLANK    WL0162  1
     C                     Z-ADD*ZERO     WL0163  52
     C                     MOVEL*BLANK    WL0164  1
     C                     MOVEL*BLANK    WL0165  1
     C                     MOVEL*BLANK    WL0166  1
     C                     MOVEL*BLANK    WL0167  1
     C                     Z-ADD*ZERO     WL0168  30
     C                     Z-ADD*ZERO     WL0169  30
     C                     Z-ADD*ZERO     WL0170  30
     C                     Z-ADD*ZERO     WL0171  30
     C                     MOVEL*BLANK    WL0172  3
     C                     MOVEL*BLANK    WL0173  1
     C                     MOVEL*BLANK    WL0174  1
     C                     MOVEL*BLANK    WL0175  1
     C                     MOVEL*BLANK    WL0176  1
     C                     MOVEL*BLANK    WL0177  2
     C                     MOVEL*BLANK    WL0178  2
     C                     MOVEL*BLANK    WL0179  3
     C                     MOVEL*BLANK    WL0180  3
     C                     MOVEL*BLANK    WL0181  3
     C                     MOVEL*BLANK    WL0182  1
     C                     MOVEL*BLANK    WL0183  1
     C                     MOVEL*BLANK    WL0184  1
     C                     MOVEL*BLANK    WL0185  1
     C                     Z-ADD*ZERO     WL0186  60
     C                     MOVEL*BLANK    WL0187 10
     C                     MOVEL*BLANK    WL0188 10
     C                     Z-ADD*ZERO     WL0189  70
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0190  3
     C                     MOVEL*BLANK    WL0191  4
     C                     MOVEL*BLANK    WL0192  2
     C                     Z-ADD*ZERO     WL0193  20
     C                     Z-ADD*ZERO     WL0194  52
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0195  3
     C                     Z-ADD*ZERO     WL0196  30
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0197  30
     C                     Z-ADD*ZERO     WL0198  70
     C                     MOVEL*BLANK    WL0199  3
      * Define local variables for subroutine SSCRRC.
     C                     Z-ADD*ZERO     WL0200  30
     C                     Z-ADD*ZERO     WL0201  70
     C                     MOVEL*BLANK    WL0202  3
     C                     Z-ADD*ZERO     WL0203 114
     C                     Z-ADD*ZERO     WL0204 114
     C                     Z-ADD*ZERO     WL0205 114
     C                     Z-ADD*ZERO     WL0206 114
     C                     Z-ADD*ZERO     WL0207 114
     C                     Z-ADD*ZERO     WL0208  70
     C                     MOVEL*BLANK    WL0209  1
     C                     Z-ADD*ZERO     WL0210 114
     C                     Z-ADD*ZERO     WL0211  70
     C                     Z-ADD*ZERO     WL0212 112
     C                     Z-ADD*ZERO     WL0213 112
     C                     Z-ADD*ZERO     WL0214 112
     C                     Z-ADD*ZERO     WL0215 112
     C                     Z-ADD*ZERO     WL0216 112
     C                     Z-ADD*ZERO     WL0217 112
     C                     Z-ADD*ZERO     WL0218 112
     C                     Z-ADD*ZERO     WL0219 112
     C                     Z-ADD*ZERO     WL0220 112
     C                     Z-ADD*ZERO     WL0221 112
     C                     Z-ADD*ZERO     WL0222 112
     C                     MOVEL*BLANK    WL0223  3
     C                     Z-ADD*ZERO     WL0224  70
     C                     Z-ADD*ZERO     WL0225  70
     C                     Z-ADD*ZERO     WL0226 112
     C                     MOVEL*BLANK    WL0227  1
     C                     Z-ADD*ZERO     WL0228  52
     C                     Z-ADD*ZERO     WL0229 112
     C                     Z-ADD*ZERO     WL0230  70
     C                     MOVEL*BLANK    WL0231  3
     C                     Z-ADD*ZERO     WL0232  30
     C                     Z-ADD*ZERO     WL0233  70
     C                     Z-ADD*ZERO     WL0234  30
     C                     Z-ADD*ZERO     WL0235  70
     C                     MOVEL*BLANK    WL0236  1
     C                     Z-ADD*ZERO     WL0237 112
     C                     Z-ADD*ZERO     WL0238 112
     C                     Z-ADD*ZERO     WL0239  70
     C                     Z-ADD*ZERO     WL0240 112
     C                     Z-ADD*ZERO     WL0241 112
     C                     Z-ADD*ZERO     WL0242  70
     C                     MOVEL*BLANK    WL0243  1
     C                     MOVEL*BLANK    WL0244  1
     C                     MOVEL*BLANK    WL0245  1
     C                     Z-ADD*ZERO     WL0246  80
     C                     Z-ADD*ZERO     WL0247  30
     C                     Z-ADD*ZERO     WL0248  30
     C                     Z-ADD*ZERO     WL0249  30
     C                     MOVEL*BLANK    WL0250  1
     C                     MOVEL*BLANK    WL0251  1
     C                     MOVEL*BLANK    WL0252  1
     C                     MOVEL*BLANK    WL0253  1
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0254  30
     C                     Z-ADD*ZERO     WL0255  70
     C                     MOVEL*BLANK    WL0256  3
     C                     MOVEL*BLANK    WL0257  1
     C                     MOVEL*BLANK    WL0258  2
     C                     Z-ADD*ZERO     WL0259  70
     C                     Z-ADD*ZERO     WL0260  50
     C                     Z-ADD*ZERO     WL0261  30
     C                     MOVEL*BLANK    WL0262  1
     C                     Z-ADD*ZERO     WL0263  70
      * Define local work field Module Release Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Transaction Quantity
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field Transaction Weight
     C                     Z-ADD*ZERO     YL0003 112
      * Define null work field Warehouse Description
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0005 20
      * Define null work field Zip Postal Code
     C                     MOVEL*BLANK    YN0006 11
      * Define null work field Production Warehouse Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0004  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field Warehouse Type
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0011  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0005  1
      * Define null work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Warehouse Chill Time
     C                     Z-ADD*ZERO     YN0013  52
      * Define null work field Include in Auto Pre Pick
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Default Manifest Copies
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Default Load Sequence
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field WHS Slotting Limit Type
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0018  30
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0019  30
      * Define null work field WHS Sched Prod Max Days
     C                     Z-ADD*ZERO     YN0020  30
      * Define null work field WHS Inventory Chill Time
     C                     Z-ADD*ZERO     YN0021  30
      * Define null work field Parent Warehouse
     C                     MOVEL*BLANK    YN0022  3
      * Define null work field Default Shipping Whs
     C                     MOVEL*BLANK    YN0023  1
      * Define local work field WHS Live with Carlisle
     C                     MOVEL*BLANK    YL0006  1
      * Define null work field WHS PFS Interface
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field WHS Default Load Type
     C                     MOVEL*BLANK    YN0026  2
      * Define null work field WHS TMS Planning Region
     C                     MOVEL*BLANK    YN0027  2
      * Define null work field Default Carrier Code
     C                     MOVEL*BLANK    YN0028  3
      * Define null work field Inventory Logic Version
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field WHS Auto Inv Restoration
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0035  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0036 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0037 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0038  70
      * Define local work field Location Aisle
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Location Bay
     C                     Z-ADD*ZERO     YL0008  20
      * Define local work field Loc Unused Chill Time
     C                     Z-ADD*ZERO     YL0009  52
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field API EccResult-MsgId U
     C                     MOVEL*BLANK    YL0011  7
      * Define local work field API EccResult-MsgDesc U
     C                     MOVEL*BLANK    YL0012 50
      * Define local work field API Request Key U
     C                     MOVEL*BLANK    YL0013 10
      * Define local work field API Name
     C                     MOVEL*BLANK    YL0014 45
      * Define local work field API Wait Time U
     C                     Z-ADD*ZERO     YL0015  50
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
00002 wim.ordershipping.invento
00003 APIWAITTME
00004 ECC0000
00005 TIMEOUT
00006 PUDLXFR
00007 PDL8DFR
00008 PNTKXFR
00009 PUEJXFR
00010 PNTWXFR
00011 PDMLDFR
