     H/TITLE WW Orders - Chg Header DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 05/24/16  Time  : 08:13:16
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDLKDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Orders - Chg Header DF Display file
      *
     FOMBFCPM5IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          RSQ Co/Ord not Inv or Cn
      *
     FPPBKCPLBIF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Co/Ord/Sts/Dte(d)/Tme(d)
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFNCPLAIF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Seq#/SSeq/Srl
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FPPBKCPL9IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Ord/Picked as XO
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPEYCPL0UF  E           K        DISK
      * UPD : Order Events              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPPBKCPL0UF  E           K        DISK
      * UPD : PFS Ship Load/Order Sts   Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 029  5 0A
     E                    W0END   7 029  5 0A
     E                    W0NAM   7 029 10
      * Long constants
     E                    @CN#    1  32  6   @CN    25
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WAAIC3
     I              EYC4NB                          WAC4NB
     I              EYQ2NB                          WAQ2NB
     I              EYJPCD                          WAJPCD
     I              EYAUC3                          WAAUC3
     I              EYQ7NB                          WAQ7NB
     I              EYOMST                          WAOMST
     I              EYD2DT                          WAD2DT
     I              EYONST                          WAONST
     I              EYOOST                          WAOOST
     I              EYOPST                          WAOPST
     I              EYAWC3                          WAAWC3
     I              EYQ8NB                          WAQ8NB
     I              EYQ9NB                          WAQ9NB
     I              EYBKC7                          WABKC7
     I              EYUVST                          WAUVST
     I              EYUWST                          WAUWST
     I              EYUXST                          WAUXST
     I              EYAATM                          WAAATM
     I              EYAYNA                          WAAYNA
     I              EYA0NA                          WAA0NA
     I              EYAXDT                          WAAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WBAIC3
     I              EYC4NB                          WBC4NB
     I              EYQ2NB                          WBQ2NB
     I              EYJPCD                          WBJPCD
     I              EYAUC3                          WBAUC3
     I              EYQ7NB                          WBQ7NB
     I              EYOMST                          WBOMST
     I              EYD2DT                          WBD2DT
     I              EYONST                          WBONST
     I              EYOOST                          WBOOST
     I              EYOPST                          WBOPST
     I              EYAWC3                          WBAWC3
     I              EYQ8NB                          WBQ8NB
     I              EYQ9NB                          WBQ9NB
     I              EYBKC7                          WBBKC7
     I              EYUVST                          WBUVST
     I              EYUWST                          WBUWST
     I              EYUXST                          WBUXST
     I              EYAATM                          WBAATM
     I              EYAYNA                          WBAYNA
     I              EYA0NA                          WBA0NA
     I              EYAXDT                          WBAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@BKCPEK
      * PFS Ship Load/Order Sts   Load/Order Picked
      * Renamed input format fields
     I              BKY1NX                          WEY1NX
     I              BKAID8                          WEAID8
     I              BKAFTS                          WEAFTS
     I              BKBCNY                          WEBCNY
     I              BKVRSX                          WEVRSX
     I              BKZGNX                          WEZGNX
     I              BKZPNX                          WEZPNX
     I              BKW0SX                          WEW0SX
     I              BKUWSX                          WEUWSX
     I              BKUXSX                          WEUXSX
     I              BKV3SX                          WEV3SX
     I              BKAHNY                          WEAHNY
     I              BKAINY                          WEAINY
     I              BKAJNY                          WEAJNY
     I              BKAKNY                          WEAKNY
      *
     I@BKCPZU
      * PFS Ship Load/Order Sts   Update index
      * Renamed input format fields
     I              BKY1NX                          WFY1NX
     I              BKAID8                          WFAID8
     I              BKAFTS                          WFAFTS
     I              BKBCNY                          WFBCNY
     I              BKVRSX                          WFVRSX
     I              BKZGNX                          WFZGNX
     I              BKZPNX                          WFZPNX
     I              BKW0SX                          WFW0SX
     I              BKUWSX                          WFUWSX
     I              BKUXSX                          WFUXSX
     I              BKV3SX                          WFV3SX
     I              BKAHNY                          WFAHNY
     I              BKAINY                          WFAINY
     I              BKAJNY                          WFAJNY
     I              BKAKNY                          WFAKNY
      *
     I@BKCPGZ
      * PFS Ship Load/Order Sts   Load/Ord/Picked as XO
      * Renamed input format fields
     I              BKY1NX                          WGY1NX
     I              BKAID8                          WGAID8
     I              BKAFTS                          WGAFTS
     I              BKBCNY                          WGBCNY
     I              BKVRSX                          WGVRSX
     I              BKZGNX                          WGZGNX
     I              BKZPNX                          WGZPNX
     I              BKW0SX                          WGW0SX
     I              BKUWSX                          WGUWSX
     I              BKUXSX                          WGUXSX
     I              BKV3SX                          WGV3SX
     I              BKAHNY                          WGAHNY
     I              BKAINY                          WGAINY
     I              BKAJNY                          WGAJNY
     I              BKAKNY                          WGAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                              7
      * KEY : PFS Ship Load/Order Sts   Load
      * I : RST PFS Load ID
     I                                        1   70PAZGNX
      *
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WAAIC3
     I              EYC4NB                          WAC4NB
     I              EYQ2NB                          WAQ2NB
     I              EYJPCD                          WAJPCD
     I              EYAUC3                          WAAUC3
     I              EYQ7NB                          WAQ7NB
     I              EYOMST                          WAOMST
     I              EYD2DT                          WAD2DT
     I              EYONST                          WAONST
     I              EYOOST                          WAOOST
     I              EYOPST                          WAOPST
     I              EYAWC3                          WAAWC3
     I              EYQ8NB                          WAQ8NB
     I              EYQ9NB                          WAQ9NB
     I              EYBKC7                          WABKC7
     I              EYUVST                          WAUVST
     I              EYUWST                          WAUWST
     I              EYUXST                          WAUXST
     I              EYAATM                          WAAATM
     I              EYAYNA                          WAAYNA
     I              EYA0NA                          WAA0NA
     I              EYAXDT                          WAAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     IYARDCS      DS                            779
      * Outward parameters
     IPBRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PBAIC3
      * I :  Order Number
     I                                    P   3   60PBC4NB
      * I :  Order Type - Sales
     I                                        7   8 PBJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PBANC7
      * I :  Ship To Customer
     I                                    P  13  160PBBKC7
      * I :  Ship To Name
     I                                       17  46 PBBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PBHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PBHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PBHPNA
      * I :  Ship To City
     I                                      137 156 PBHNNA
      * I :  Ship To State Code
     I                                      157 158 PBDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PBCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PBB0C7
      * I :  Bill to Name
     I                                      174 203 PBAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PBB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PBB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PBB4NA
      * I :  Bill to City
     I                                      294 313 PBB2NA
      * I :  Bill to State Code
     I                                      314 315 PBBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PBC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PBBCNA
      * I :  Order Date
     I                                    P 342 3450PBA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PBA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PBGNDT
      * I :  Cancel Date
     I                                    P 354 3570PBACDT
      * I :  Terms Code
     I                                      358 359 PBAQCD
      * I :  Special Instructions
     I                                      360 399 PBB6NA
      * I :  Special Instructions 2
     I                                      400 439 PBBYNA
      * I :  Carrier Code
     I                                      440 442 PBBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PBGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PBGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PBGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PBQFST
      * I :  Reason Code
     I                                      447 449 PBCQCD
      * I :  Order in Use
     I                                      450 450 PBGJST
      * I :  Header Status
     I                                      451 451 PBGWST
      * I :  Header Status Last
     I                                      452 452 PBGXST
      * I :  Order Type Print Status
     I                                      453 453 PBGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PBAODT
      * I :  User Original Entry
     I                                      458 467 PBAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PBCXDT
      * I :  Order Value Total
     I                                    P 472 4772PBJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PBA1WG
      * I :  Credit Hold
     I                                      484 484 PBXIST
      * I :  Production Hold
     I                                      485 485 PBXJST
      * I :  New Customer Hold
     I                                      486 486 PBXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PBEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PBAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PBE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PBE9CD
      * I :  Load ID
     I                                    P 510 5130PBRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PBTBNB
      * I :  Rated Freight
     I                                    P 517 5222PBR1NB
      * I :  LTL Flag
     I                                      523 523 PBPJST
      * I :  Price Audit
     I                                      524 524 PBU0ST
      * I :  Price Status
     I                                      525 525 PBU1ST
      * I :  Shipping Method
     I                                      526 527 PBQ2CD
      * I :  Export Status
     I                                      528 528 PBU2ST
      * I :  Palletize
     I                                      529 529 PBVEST
      * I :  Shrink Wrap
     I                                      530 530 PBVFST
      * I :  Slip Sheet
     I                                      531 531 PBVGST
      * I :  Age Code
     I                                      532 532 PBRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PBRNNB
      * I :  Load Type
     I                                      536 536 PBVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PBATIN
      * I :  Load Plan Order
     I                                      541 541 PBU4ST
      * I :  Print Pick Slip
     I                                      542 542 PBU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PBRSRN
      * I :  Special Comment 1
     I                                      547 576 PBMHNA
      * I :  Special Comment 2
     I                                      577 606 PBMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PBWBST
      * I :  Sales Route Code
     I                                      608 610 PBR4CD
      * I :  Manager Level Code
     I                                      611 612 PBBFCD
      * I :  VP Level Code
     I                                      613 615 PBQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PBT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PBSICD
      * I :  Invoice Number
     I                                    P 623 6260PBCONB
      * I :  Invoice Suffix
     I                                      627 628 PBCEST
      * I :  Invoice Date
     I                                    P 629 6320PBAWDT
      * I :  Event Code
     I                                      633 634 PBJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PBXUST
      * I :  Modified Flag
     I                                      636 636 PBZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PBVRVA
      * I :  Billing Activity Type
     I                                      643 643 PBOBST
      * I :  Block Order Flag
     I                                      644 644 PBBCST
      * I :  Order Certification Flag
     I                                      645 645 PBBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PBB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PBGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PBGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PBGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PBGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PBFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PBFOSX
      * I :  Order Emailed
     I                                      658 658 PBFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PBFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PBFRSX
      * I :  Broker Order Status
     I                                      661 661 PBFSSX
      * I :  Air Freight Order
     I                                      662 662 PBFTSX
      * I :  Order Requires Review
     I                                      663 664 PBFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PBFVSX
      * I :  Export USDA Approved
     I                                      667 668 PBFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PBFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PBFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PBNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PBNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PBNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PBNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PBNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PBBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PBBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PBBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PBBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PBBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PBH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PBH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PBH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PBH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PBH4NX
      * I :  Claim Number
     I                                    P 745 7480PBC0C7
      * I :  EDI Status 1
     I                                      749 749 PBUVST
      * I :  EDI Status 2
     I                                      750 750 PBUWST
      * I :  EDI Status 3
     I                                      751 751 PBUXST
      * I :  Job Time
     I                                    P 752 7550PBAATM
      * I :  User Id
     I                                      756 765 PBAYNA
      * I :  Job Name
     I                                      766 775 PBA0NA
      * I :  Job Date
     I                                    P 776 7790PBAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     IYBRDCS      DS                            525
      * Outward parameters
     IPCRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PCDXNB
      * I :  Load ID
     I                                    P  11  140PCRMNB
      * I :  Stop/Drop
     I                                    P  15  170PCRVNB
      * I :  Load Change Type
     I                                       18  23 PCRVST
      * I :  Department Control Code
     I                                       24  26 PCUJST
      * I :  Change Log Prior Value
     I                                       27  38 PCMNTX
      * I :  Change Log New Value
     I                                       39  50 PCMOTX
      * I :  User Id
     I                                       51  60 PCAYNA
      * I :  Job Name
     I                                       61  70 PCA0NA
      * I :  Carrier Code
     I                                       71  73 PCBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PCXMCD
      * I :  Company Number
     I                                    P  77  780PCAIC3
      * I :  Order Number
     I                                    P  79  820PCC4NB
      *
     IQPPBK1    E DSPPBKCPL0
      * UPD : PFS Ship Load/Order Sts   Update index
      * Renamed input format fields
     I              BKY1NX                          WFY1NX
     I              BKAID8                          WFAID8
     I              BKAFTS                          WFAFTS
     I              BKBCNY                          WFBCNY
     I              BKVRSX                          WFVRSX
     I              BKZGNX                          WFZGNX
     I              BKZPNX                          WFZPNX
     I              BKW0SX                          WFW0SX
     I              BKUWSX                          WFUWSX
     I              BKUXSX                          WFUXSX
     I              BKV3SX                          WFV3SX
     I              BKAHNY                          WFAHNY
     I              BKAINY                          WFAINY
     I              BKAJNY                          WFAJNY
     I              BKAKNY                          WFAKNY
      *
     IYCRDCS      DS                             75
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * N :  Order Number
     I                                    P   1   40P1C4NB
      * N :  Load ID
     I                                    P   5   80P1RMNB
      * N :  Load Plan Order
     I                                        9   9 P1U4ST
      * N :  Print Pick Slip
     I                                       10  10 P1U5ST
      * N :  Event Code
     I                                       11  12 P1JPCD
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Company Number
     I                                    P   4   50P2AIC3
      * N :  Application Code
     I                                        6  11 P2DNCD
      * N :  Salesperson Code
     I                                       12  14 P2BCCD
      * N :  User Profile Name
     I                                       15  24 P2AJVN
      * N :  Allow Multi-Company
     I                                       25  25 P2I6ST
      * N :  Default Printer
     I                                       26  35 P2MPNA
      * N :  First Time Flag
     I                                       36  36 P2TAST
      * I :  Access Denied (Y/N)
     I                                       37  37 P2WVST
     IP3PARM      DS
      * N :  USR Status (Y/N)
     I                                        1   1 P3E6ST
     IP4PARM      DS
      * N :  Load Status
     I                                        1   1 P4PKST
     IP5PARM      DS
      * N :  USR Ship Y/N
     I                                        1   1 P5YEST
     IP6PARM      DS
      * N :  Event Number
     I                                    P   1   30P6Q2NB
     IP7PARM      DS
      * N :  Live with TPM
     I                                        1   1 P7O1ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0001
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0002
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0003
      * Message data for 'Order Canc/Conf/Complete'
      * *SFLSEL
     I                                        1   1 ZA0004
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0005
      * Message data for 'Order Canc/Conf/Complete'
      * *SFLSEL
     I                                        1   1 ZA0006
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0007
      * Message data for 'Order Canc/Conf/Complete'
      * *SFLSEL
     I                                        1   1 ZA0008
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     I                                        1   1 ZA0009
      * Message data for 'Order Canc/Conf/Complete'
      * *SFLSEL
     I                                        1   1 ZA0010
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0011
      * Application Code
     I                                       11  16 ZA0012
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0013
      * Application Code
     I                                       11  16 ZA0014
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P2WVST    PARM           WP0001  1        Access Denied (
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * First time Through Program
      * CASE: PAR.First Time Flag is Yes
     C           P2TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP2AIC3    #2AIC3           Company Number
     C                     MOVEL'N'       P2TAST           First Time Flag
     C                     END                             *FI
     C                     MOVEL#CV3SX    YL0001           PFS Error Reaso
     C                     MOVEL#CATUS    YL0002           STATUS
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3
     C                     Z-ADD#2C4NB    BEC4NB
     C           KPOS      SETLL@BFCPIE
     C                     READ @BFCPIE                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2A5DT    WZA5DT
     C                     MOVEL#2A5DT    WZA5DT           Requested Ship
     C           *LIKE     DEFN #2U0ST    WZU0ST
     C                     MOVEL#2U0ST    WZU0ST           Price Audit
     C           *LIKE     DEFN #2PJST    WZPJST
     C                     MOVEL#2PJST    WZPJST           LTL Flag
     C           *LIKE     DEFN #2Q2CD    WZQ2CD
     C                     MOVEL#2Q2CD    WZQ2CD           Shipping Method
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2U4ST    WZU4ST
     C                     MOVEL#2U4ST    WZU4ST           Load Plan Order
     C           *LIKE     DEFN #2U5ST    WZU5ST
     C                     MOVEL#2U5ST    WZU5ST           Print Pick Slip
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type - Sa
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2JPCD    WZJPCD
     C                     MOVEL#2JPCD    WZJPCD           Event Code
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2GNDT    WZGNDT
     C                     MOVEL#2GNDT    WZGNDT           Actual Shipped
     C           *LIKE     DEFN #2GJST    WZGJST
     C                     MOVEL#2GJST    WZGJST           Order in Use
     C           *LIKE     DEFN #2XUST    WZXUST
     C                     MOVEL#2XUST    WZXUST           Trans Contol AS
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPIE                  90*
     C  N82                READ @BFCPIE                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,43
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2PJST    IFNE *BLANK                     LTL Flag
     C           BEPJST    CABNE#2PJST    BB020            LTL Flag
     C                     END
     C           #2Q2CD    IFNE *BLANK                     Shipping Method
     C           BEQ2CD    CABNE#2Q2CD    BB020            Shipping Method
     C                     END
     C           #2VDST    IFNE *BLANK                     Load Type
     C           BEVDST    CABNE#2VDST    BB020            Load Type
     C                     END
     C           #2U4ST    IFNE *BLANK                     Load Plan Order
     C           BEU4ST    CABNE#2U4ST    BB020            Load Plan Order
     C                     END
     C           #2U5ST    IFNE *BLANK                     Print Pick Slip
     C           BEU5ST    CABNE#2U5ST    BB020            Print Pick Slip
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           BEC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2JNCD    IFNE *BLANK                     Order Type - Sa
     C           BEJNCD    CABNE#2JNCD    BB020            Order Type - Sa
     C                     END
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           BERMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C           #2JPCD    IFNE *BLANK                     Event Code
     C           BEJPCD    CABNE#2JPCD    BB020            Event Code
     C                     END
     C           #2AODT    IFNE *ZERO                      Scheduled Ship
     C           BEAODT    CABNE#2AODT    BB020            Scheduled Ship
     C                     END
     C           #2GNDT    IFNE *ZERO                      Actual Shipped
     C           BEGNDT    CABNE#2GNDT    BB020            Actual Shipped
     C                     END
     C           #2GJST    IFNE *BLANK                     Order in Use
     C           BEGJST    CABNE#2GJST    BB020            Order in Use
     C                     END
     C           #2XUST    IFNE *BLANK                     Trans Contol AS
     C           BEXUST    CABNE#2XUST    BB020            Trans Contol AS
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * RST:  Company Number
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Company Number EQ DB1.Company Number
      *   |- c2    : CTL.Company Number EQ WRK.ZERO
      *   '-
     C           #2AIC3    IFEQ BEAIC3                     *IF
     C           #2AIC3    OREQ WUW0NB                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Rtv CO Error Reason   RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SARVGN
      * SEL: PFS Error Reason
      * CASE: CTL.PFS Error Reason is *ALL values
     C           #CV3SX    IFEQ @CN,001                    *IF
     C           #CV3SX    OREQ @CN,002
     C           #CV3SX    OREQ @CN,003
     C           #CV3SX    OREQ @CN,004
     C           #CV3SX    OREQ @CN,005
     C           #CV3SX    OREQ 'SHIFT'
     C           #CV3SX    OREQ @CN,006
     C           #CV3SX    OREQ @CN,007
     C           #CV3SX    OREQ @CN,008
     C           #CV3SX    OREQ @CN,009
     C           #CV3SX    OREQ @CN,010
     C           #CV3SX    OREQ @CN,011
     C           #CV3SX    OREQ @CN,012
     C           #CV3SX    OREQ @CN,013
     C           #CV3SX    OREQ @CN,014
     C           #CV3SX    OREQ 'ORDLD'
     C           #CV3SX    OREQ @CN,015
     C           #CV3SX    OREQ @CN,016
     C           #CV3SX    OREQ *BLANK
     C           #CV3SX    OREQ @CN,017
     C           #CV3SX    OREQ @CN,018
     C           #CV3SX    OREQ @CN,019
     C           #CV3SX    OREQ @CN,020
     C           #CV3SX    OREQ 'LDINV'
     C           #CV3SX    OREQ @CN,021
     C           #CV3SX    OREQ @CN,022
     C           #CV3SX    OREQ @CN,023
     C           #CV3SX    OREQ @CN,024
     C           #CV3SX    OREQ @CN,025
     C           #CV3SX    OREQ @CN,026
     C           #CV3SX    OREQ 'WHSCO'
     C           #CV3SX    OREQ @CN,027
     C           #CV3SX    OREQ 'REOPN'
     C           #CV3SX    OREQ @CN,028
     C           #CV3SX    OREQ @CN,029
     C           #CV3SX    OREQ 'RSTIP'
     C           #CV3SX    OREQ @CN,030
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.PFS Error Reason NE RCD.PFS Error Reason
      *   |- c2    : CTL.PFS Error Reason NE WRK.BLANK
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CV3SX    IFNE #RV3SX                     *IF
     C           #CV3SX    IFNE WUGSTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Order Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Order Type - Sales is Not a Transfer Order
      *   |- c2    : RCD.Order Type - Sales is Not Regular Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1JNCD    IFNE 'TR'                       *IF
     C           #1JNCD    IFNE 'OR'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Rtv Ord Dups Found    RT - Order Detail  * 
     C                     EXSR SBRVGN
      * SEL: DUP Cases
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.STATUS is Y/N
      *   |- c2    : CTL.STATUS NE RCD.STATUS
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CATUS    IFEQ 'N'                        *IF
     C           #CATUS    OREQ 'Y'
     C           #CATUS    IFNE #RATUS                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPIE                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,031                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,031                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Actual Shipped Date
      * External date
     C                     Z-ADDV2GNDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     Z-ADDXDINDT    #2GNDT
      * Validate PFS Error Reason
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#CV3SX    W0NSRQ  1        PFS Error Reaso
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#CV3SX'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1734913   Y2LSNO  70
     C           #CV3SX    PARM #CV3SX    W0EXVL 25        PFS Error Reaso
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate STATUS
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CATUS'  IFEQ YPMTFD
      * STATUS
     C                     MOVEL#CATUS    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFATUS
     C                     SELEC
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD1         ZFATUS
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZFATUS
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD3         ZFATUS
     C                     ENDSL
     C                     EXFMTZEATUS
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFATUS    WHEQ 1
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZFATUS    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFATUS    WHEQ 3
     C                     MOVEL'N'       W0INVL           N
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CATUS
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Order in Use
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2GJST    W0NSRQ  1        Order in Use
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2GJST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1106245   Y2LSNO  70
     C           #2GJST    PARM #2GJST    W0EXVL 25        Order in Use
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Trans Contol AS400/Plant
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#2XUST    W0NSRQ  1        Trans Contol AS
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#2XUST'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1292548   Y2LSNO  70
     C           #2XUST    PARM #2XUST    W0EXVL 25        Trans Contol AS
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,031                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZJNCD    CASNE#2JNCD    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZJPCD    CASNE#2JPCD    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZGNDT    CASNE#2GNDT    FBRQRL
     C           WZGJST    CASNE#2GJST    FBRQRL
     C           WZXUST    CASNE#2XUST    FBRQRL
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * Prompt
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Event Code
     C           W0CFL     IFEQ '#2JPCD'                   *IF
      * SEL Event Types Active SR - OP Event Types  * 
     C                     CALL 'PDEQSRR'              90  SEL Event Types
     C                     PARM *BLANK    W0RTN   7
     C           #2JPCD    PARM #2JPCD    WQ0001  2        Event Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CTL.PFS Error Reason NE LCL.PFS Error Reason
     C           #CV3SX    IFNE YL0001                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * CASE: CTL.STATUS NE LCL.STATUS
     C           #CATUS    IFNE YL0002                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     Z-ADD#2RMNB    P1RMNB           Load ID
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: Process command keys
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,43
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * 2=Upd TR Departure Date/Time  Disable when Live w/TPM=Y  E004019
      * CASE: RCD.*SFLSEL is Option 2
     C           #1SEL     IFEQ '2'                        *IF
     C           #1SEL     OREQ ' 2'
      * 05/23/16 RMC E4119 remove live with tpm check
      * CASE: RCD.Order Type - Sales is Transfer Order
     C           #1JNCD    IFEQ 'TR'                       *IF
      * EDT Cst Srv/Dispatcher XF - Load Header  * 
     C                     CALL 'PDE4XFR'              90  EDT Cst Srv/Dis
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0002  30       Company Number
     C           #1RMNB    PARM #1RMNB    WQ0003  70       Load ID
     C                     PARM *BLANK    WQ0004  1        Warehouse Speci
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0001           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * 5=Display Load/Order Status
      * CASE: RCD.*SFLSEL is Option 5
     C           #1SEL     IFEQ ' 5'                       *IF
     C           #1SEL     OREQ '5'
      * WW Ship Load/Order- 1 DF - PFS Ship Load/Order Sts  * 
     C                     CLEARPARC
     C                     Z-ADD#1RMNB    PAZGNX           PFS Load ID
      *
     C                     CALL 'PPYVDFR'              90  WW Ship Load/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: PFS Ship L
     C                     PARM P2WVST    WQ0005  1        Access Denied (
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPYVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * 8=Display Order Vs. Ship  Not available after Live w/TPM  E004119
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * 05/23/16 RMC E4119 remove live with tpm check
      * DSP Order vs. Ship Dtl DF - Order Detail  * 
     C                     CALL 'PDP7DFR'              90  DSP Order vs. S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0006  30       Company Number
     C                     PARM #1C4NB    WQ0007  70       Order Number
     C                     PARM #1JNCD    WQ0008  2        Order Type - Sa
     C                     PARM #1BKC7    WQ0009  70       Ship To Custome
     C                     PARM #1BRTX    WQ0010 30        Ship To Name
     C                     PARM #1BCNA    WQ0011 15        Customer Purcha
     C                     PARM #1A0DT    WQ0012  70       Order Date
     C                     PARM #1GNDT    WQ0013  70       Actual Shipped
     C                     PARM #1GWST    WQ0014  1        Header Status
     C           #1XIST    PARM #1XIST    WQ0015  1        Credit Hold
     C           #1XJST    PARM #1XJST    WQ0016  1        Production Hold
     C           #1XKST    PARM #1XKST    WQ0017  1        New Customer Ho
     C                     PARM #1R4CD    WQ0018  3        Sales Route Cod
     C                     PARM P2DNCD    WQ0019  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP7DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * 7=Select Orders to change Order in use flag
      * CASE: RCD.*SFLSEL is Edit Opt7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * CASE: PAR.Access Denied (Y/N) is yes
     C           P2WVST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0002           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * EDT Ord Chg In Use Flg E1 - OP Order Header  * 
     C                     CALL 'PDL2E1R'              90  EDT Ord Chg In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0020  30       Company Number
     C                     PARM #1C4NB    WQ0021  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL2E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * 9=Select Orders to change AS400/Plant Floor flag
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * CASE: PAR.Access Denied (Y/N) is yes
     C           P2WVST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0003           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Header Status is Avail/Alloc/Enter/Hold
     C           #1GWST    IFEQ 'L'                        *IF
     C           #1GWST    OREQ 'A'
     C           #1GWST    OREQ 'E'
     C           #1GWST    OREQ 'H'
      * EDT Ord Chg AS400/Plnt E1 - OP Order Header  * 
     C                     CALL 'PDL3E1R'              90  EDT Ord Chg AS4
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0022  30       Company Number
     C                     PARM #1C4NB    WQ0023  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL3E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0004           *SFLSEL
      * Send message 'Order Canc/Conf/Complete'
     C                     MOVEL'USR2324' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 12=Select Orders to unpick 12=Unpick Chg OH/OD/OE Only
      * CASE: RCD.*SFLSEL is Option 12
     C           #1SEL     IFEQ '12'                       *IF
      * CASE: PAR.Access Denied (Y/N) is yes
     C           P2WVST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0005           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Header Status is Avail/Alloc/Enter/Hold
      *   |- c2    : RCD.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GWST    IFEQ 'L'                        *IF
     C           #1GWST    OREQ 'A'
     C           #1GWST    OREQ 'E'
     C           #1GWST    OREQ 'H'
     C           #1JPCD    IFGE '01'                       *IF
     C           #1JPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * DLT Specific Event Cde RT - OP Order Events  * 
     C                     EXSR SDRVGN
      * RTV Last Event Code    RT - OP Order Events  * 
     C                     EXSR SFRVGN
      * CHG Evt,Sts,ShpDte,Mod CH - PD Order Header  * 
     C                     EXSR SGCHRC
      * CHG Event Code ALL     RT - PD Order Detail  * 
     C                     EXSR SHRVGN
      * S00930 RMC 9/03/09 Crt Change log for unpick
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
     C                     Z-ADD*ZERO     PCRVNB           Stop/Drop
     C                     MOVEL'UNPOMS'  PCRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PCUJST    P      Department Cont
     C                     MOVEL'03'      PCMNTX    P      Change Log Prio
     C                     MOVEL'02'      PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#1BZNA    PCBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD#1C4NB    PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0006           *SFLSEL
      * Send message 'Order Canc/Conf/Complete'
     C                     MOVEL'USR2324' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 10=Select Orders to unpick- PFS Ship Load/Order Sts  ONLY * 6/15/
      * CASE: RCD.*SFLSEL is Option 10
     C           #1SEL     IFEQ '10'                       *IF
      * CASE: PAR.Access Denied (Y/N) is yes
     C           P2WVST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0007           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      *  THIS IS NOT A FULL UNPICK PROCESS. IT JUST SETS THE PFS UPLOADED
      *  RECORD "PO" TO "XO" SO SALES/SCHED CAN DO SOMETHING.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Header Status is Avail/Alloc/Enter/Hold
      *   |- c2    : RCD.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GWST    IFEQ 'L'                        *IF
     C           #1GWST    OREQ 'A'
     C           #1GWST    OREQ 'E'
     C           #1GWST    OREQ 'H'
     C           #1JPCD    IFGE '01'                       *IF
     C           #1JPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Upd Status -Pick Ord  RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SJRVGN
      * S00930 RMC 9/03/09 Crt Change log for unpick
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
     C                     Z-ADD*ZERO     PCRVNB           Stop/Drop
     C                     MOVEL'UNPCAR'  PCRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PCUJST    P      Department Cont
     C                     MOVEL'PO'      PCMNTX    P      Change Log Prio
     C                     MOVEL'XO'      PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#1BZNA    PCBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD#1C4NB    PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
      * Send message 'Order Canc/Conf/Complete'
     C                     MOVEL'USR2324' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 11=Select Orders to pick- PFS Ship Load/Order Sts  ONLY * 6/15/06
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * CASE: PAR.Access Denied (Y/N) is yes
     C           P2WVST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0009           *SFLSEL
      * Send message 'Option Not Allowed'
     C                     MOVEL'USR2262' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      *  THIS IS NOT A FULL PICK PROCESS. IT JUST SETS THE PFS UPLOADED
      *  RECORD "XO" TO "PO" after SALES/SCHED did SOMETHING.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Header Status is Avail/Alloc/Enter/Hold
      *   |- c2    : RCD.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1GWST    IFEQ 'L'                        *IF
     C           #1GWST    OREQ 'A'
     C           #1GWST    OREQ 'E'
     C           #1GWST    OREQ 'H'
     C           #1JPCD    IFGE '01'                       *IF
     C           #1JPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'XO'      WUHKT1           Text 2
      * Upd Status-rePick Ord RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SLRVGN
      * S00930 RMC 9/03/09 Crt Change log for pick
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPCRC
     C                     Z-ADD#1RMNB    PCRMNB           Load ID
     C                     Z-ADD*ZERO     PCRVNB           Stop/Drop
     C                     MOVEL'PCKCAR'  PCRVST    P      Load Change Typ
     C                     MOVEL'SLS'     PCUJST    P      Department Cont
     C                     MOVEL'XO'      PCMNTX    P      Change Log Prio
     C                     MOVEL'PO'      PCMOTX    P      Change Log New
     C                     MOVEL##USR     PCAYNA    P      User Id
     C                     MOVEL##PGM     PCA0NA    P      Job Name
     C                     MOVEL#1BZNA    PCBZNA    P      Carrier Code
     C                     Z-ADD#1AIC3    PCAIC3           Company Number
     C                     Z-ADD#1C4NB    PCC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0010           *SFLSEL
      * Send message 'Order Canc/Conf/Complete'
     C                     MOVEL'USR2324' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9843  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 13=Delete Dup Cases
      * CASE: RCD.*SFLSEL is Option 13
     C           #1SEL     IFEQ '13'                       *IF
      * Fix DUP Serial Nos    XF - Manifest Detail  * 
     C                     CALL 'PPX1XFR'              90  Fix DUP Serial
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0024  30       Company Number
     C                     PARM #1C4NB    WQ0025  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPX1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P2WVST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P2I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPIE fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V1GNDT
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1A5DT
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RV3SX           PFS Error Reaso
     C                     MOVEL*BLANK    #RATUS           STATUS
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADD*ZERO     #2A5DT           Requested Ship
     C                     MOVEL*BLANK    #2U0ST           Price Audit
     C                     MOVEL*BLANK    #2PJST           LTL Flag
     C                     MOVEL*BLANK    #2Q2CD           Shipping Method
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     MOVEL*BLANK    #2U4ST           Load Plan Order
     C                     MOVEL*BLANK    #2U5ST           Print Pick Slip
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVEL*BLANK    #2JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     MOVEL*BLANK    #2JPCD           Event Code
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #2GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V2GNDT
     C                     MOVEL*BLANK    #CV3SX           PFS Error Reaso
     C                     MOVEL*BLANK    #CATUS           STATUS
     C                     MOVEL*BLANK    #2GJST           Order in Use
     C                     MOVEL*BLANK    #2XUST           Trans Contol AS
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #1GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1GNDT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  #1A5DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1A5DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #2GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2GNDT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv CO Error Reason   RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #RV3SX           PFS Error Reaso
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKY1NX    WQSA01           PFS Company Num
     C           *LIKE     DEFN BKZPNX    WQSA02           PFS Order Numbe
     C           *LIKE     DEFN BKVRSX    WQSA03           PFS Ship Status
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           PFS Company Num
     C                     KFLD           WQSA02           PFS Order Numbe
     C                     KFLD           WQSA03           PFS Ship Status
      * Setup key
     C                     Z-ADD#1AIC3    WQSA01           PFS Company Num
     C                     Z-ADD#1C4NB    WQSA02           PFS Order Numbe
     C                     MOVEL'CO'      WQSA03           PFS Ship Status
      * Establish starting position
     C           KRSSA     SETLL@BKCPC3                    *
     C           KRSSA     READE@BKCPC3                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBKV3SX    #RV3SX           PFS Error Reaso
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@BKCPC3                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Ord Dups Found    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    #RATUS           STATUS
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSB01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSB02           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSB01           Company Number
     C                     Z-ADD#1C4NB    WQSB02           Order Number
      * Establish starting position
     C           KRSSB     SETLL@BGWKL1                    *
     C           KRSSB     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Ord Dups Found    RT - Manifest Detail  * 
     C                     EXSR SCRVGN
      * CASE: LCL.STATUS is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       #RATUS           STATUS
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSB     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Ord Dups Found    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0004           First Time Flag
     C                     MOVEL'N'       YL0003           STATUS
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSC01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSC02           Order Number
     C           *LIKE     DEFN FNDPNB    WQSC03           Order Sequence
     C           *LIKE     DEFN FNUENB    WQSC04           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Order Sequence
     C                     KFLD           WQSC04           Order Secondary
      * Setup key
     C                     Z-ADDOMAIC3    WQSC01           Company Number
     C                     Z-ADDOMC4NB    WQSC02           Order Number
     C                     Z-ADDOMDPNB    WQSC03           Order Sequence
     C                     Z-ADDOMUENB    WQSC04           Order Secondary
      * Establish starting position
     C           KRSSC     SETLL@FNCPH9                    *
     C           KRSSC     READE@FNCPH9                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag is Yes
     C           YL0004    IFEQ 'Y'                        *IF
     C                     Z-ADDFNPFNX    YL0005           PT Serial Numbe
     C                     Z-ADDFNELDT    YL0006           Production Date
     C                     MOVEL'N'       YL0004           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.PT Serial Number EQ DB1.PT Serial Number
      *   |- c2    : LCL.Production Date EQ DB1.Production Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFEQ FNPFNX                     *IF
     C           YL0006    IFEQ FNELDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0003           STATUS
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFNPFNX    YL0005           PT Serial Numbe
     C                     Z-ADDFNELDT    YL0006           Production Date
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@FNCPH9                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * DLT Specific Event Cde RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EYAIC3    WQSD01           Company Number
     C           *LIKE     DEFN EYC4NB    WQSD02           Order Number
     C           *LIKE     DEFN EYJPCD    WQSD03           Event Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Event Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSD01           Company Number
     C                     Z-ADD#1C4NB    WQSD02           Order Number
     C                     MOVEL'03'      WQSD03           Event Code
      * Establish starting position
     C           KRSSD     SETLL@EYCPZE                    *
     C           KRSSD     READE@EYCPZE                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT OP Order Events    DL - OP Order Events  * 
     C                     EXSR SEDLRC
     C           KRSSD     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * DLT OP Order Events    DL - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
     C                     Z-ADDEYAIC3    WAAIC3           Company Number
     C                     Z-ADDEYC4NB    WAC4NB           Order Number
     C                     Z-ADDEYQ2NB    WAQ2NB           Event Number
      *
     C           KLDLSE    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WAQ2NB           Event Number
     C           KLDLSE    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPEYCPL0'MDACP
     C                     MOVEL'@EYCPY3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Last Event Code    RT - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSF02           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSF01           Company Number
     C                     Z-ADD#1C4NB    WQSF02           Order Number
      * Establish starting position
     C           KRSSF     SETLL@EYCPY2                    *
     C           KRSSF     READE@EYCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBQ2NB    WUQ2NB           Event Number
     C                     MOVELWBJPCD    WUJPCD           Event Code
     C           KRSSF     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * CHG Evt,Sts,ShpDte,Mod CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0002  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     MOVEL*BLANK    WN0004 30        Ship To Name
     C                     MOVEL*BLANK    WN0005 30        Ship To Address
     C                     MOVEL*BLANK    WN0006 30        Ship To Address
     C                     MOVEL*BLANK    WN0007 30        Ship To Address
     C                     MOVEL*BLANK    WN0008 20        Ship To City
     C                     MOVEL*BLANK    WN0009  2        Ship To State C
     C                     MOVEL*BLANK    WN0010 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0011  70       Bill to Custome
     C                     MOVEL*BLANK    WN0012 30        Bill to Name
     C                     MOVEL*BLANK    WN0013 30        Bill to Address
     C                     MOVEL*BLANK    WN0014 30        Bill to Address
     C                     MOVEL*BLANK    WN0015 30        Bill to Address
     C                     MOVEL*BLANK    WN0016 20        Bill to City
     C                     MOVEL*BLANK    WN0017  2        Bill to State C
     C                     MOVEL*BLANK    WN0018 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0019 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0020  70       Order Date
     C                     Z-ADD*ZERO     WN0021  70       Requested Ship
     C                     Z-ADD*ZERO     WN0022  70       Cancel Date
     C                     MOVEL*BLANK    WN0023  2        Terms Code
     C                     MOVEL*BLANK    WN0024 40        Special Instruc
     C                     MOVEL*BLANK    WN0025 40        Special Instruc
     C                     MOVEL*BLANK    WN0026  3        Carrier Code
     C                     MOVEL*BLANK    WN0027  1        Comment Print A
     C                     MOVEL*BLANK    WN0028  1        Comment Print I
     C                     MOVEL*BLANK    WN0029  1        Comment Print P
     C                     MOVEL*BLANK    WN0030  1        Comment Print S
     C                     MOVEL*BLANK    WN0031  3        Reason Code
     C                     MOVEL*BLANK    WN0032  1        Order in Use
     C                     MOVEL*BLANK    WN0033  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0034  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0035 10        User Original E
     C                     Z-ADD*ZERO     WN0036  70       Date of Origina
     C                     Z-ADD*ZERO     WN0037 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0038 112       Order Weight To
     C                     MOVEL*BLANK    WN0039  1        Credit Hold
     C                     MOVEL*BLANK    WN0040  1        Production Hold
     C                     MOVEL*BLANK    WN0041  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0042  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0043  40       Requested Deliv
     C                     MOVEL*BLANK    WN0044  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0045 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0046  70       Load ID
     C                     Z-ADD*ZERO     WN0047  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0048 112       Rated Freight
     C                     MOVEL*BLANK    WN0049  1        LTL Flag
     C                     MOVEL*BLANK    WN0050  1        Price Audit
     C                     MOVEL*BLANK    WN0051  1        Price Status
     C                     MOVEL*BLANK    WN0052  2        Shipping Method
     C                     MOVEL*BLANK    WN0053  1        Export Status
     C                     MOVEL*BLANK    WN0054  1        Palletize
     C                     MOVEL*BLANK    WN0055  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0056  1        Slip Sheet
     C                     MOVEL*BLANK    WN0057  1        Age Code
     C                     Z-ADD*ZERO     WN0058  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0059  1        Load Type
     C                     Z-ADD*ZERO     WN0060  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0061  1        Load Plan Order
     C                     MOVEL*BLANK    WN0062  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0063  70       Resell Referenc
     C                     MOVEL*BLANK    WN0064 30        Special Comment
     C                     MOVEL*BLANK    WN0065 30        Special Comment
     C                     MOVEL*BLANK    WN0066  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0067  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0068  2        Manager Level C
     C                     MOVEL*BLANK    WN0069  3        VP Level Code
     C                     Z-ADD*ZERO     WN0070  70       Attach to Order
     C                     MOVEL*BLANK    WN0071  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0072  70       Invoice Number
     C                     MOVEL*BLANK    WN0073  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0074  70       Invoice Date
     C                     MOVEL*BLANK    WN0075  1        Trans Contol AS
     C                     Z-ADD*ZERO     WN0076 112       A/R order Value
     C                     MOVEL*BLANK    WN0077  1        Billing Activit
     C                     MOVEL*BLANK    WN0078  1        Block Order Fla
     C                     MOVEL*BLANK    WN0079  1        Order Certifica
     C                     Z-ADD*ZERO     WN0080 112       Invoice Order V
     C                     MOVEL*BLANK    WN0081  1        Process Sts for
     C                     MOVEL*BLANK    WN0082  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0083  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0084  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0085  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0086  1        Email Cust On O
     C                     MOVEL*BLANK    WN0087  1        Order Emailed
     C                     MOVEL*BLANK    WN0088  1        Export Docs Go
     C                     MOVEL*BLANK    WN0089  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0090  1        Broker Order St
     C                     MOVEL*BLANK    WN0091  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0092  2        Order Requires
     C                     MOVEL*BLANK    WN0093  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0094  2        Export USDA App
     C                     MOVEL*BLANK    WN0095  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0096  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0097  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0098  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0099  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0100  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0101  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0102  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0103  60       Time of Origina
     C                     Z-ADD*ZERO     WN0104  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0105  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0106  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0107 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0108 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0109 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0110 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0111 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0112  70       Claim Number
     C                     MOVEL*BLANK    WN0113  1        EDI Status 1
     C                     MOVEL*BLANK    WN0114  1        EDI Status 2
     C                     MOVEL*BLANK    WN0115  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0116  60       Job Time
     C                     MOVEL*BLANK    WN0117 10        User Id
     C                     MOVEL*BLANK    WN0118 10        Job Name
     C                     Z-ADD*ZERO     WN0119  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADD#1AIC3    WCAIC3           Company Number
     C                     Z-ADD#1C4NB    WCC4NB           Order Number
      *
     C           KLCHSG    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C           KLCHSG    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD#1GNDT    WCGNDT           Actual Shipped
     C                     MOVEL#1GWST    WCGWST    P      Header Status
     C                     MOVEL#1GXST    WCGXST    P      Header Status L
     C                     MOVELWUJPCD    WCJPCD    P      Event Code
     C                     MOVEL#1Z1ST    WCZ1ST    P      Modified Flag
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                     CLEARPBRC
     C                     Z-ADDWCAIC3    PBAIC3           Company Number
     C                     Z-ADDWCC4NB    PBC4NB           Order Number
     C                     MOVELWCJNCD    PBJNCD    P      Order Type - Sa
     C                     Z-ADDWCANC7    PBANC7           A/R Customer Nu
     C                     Z-ADDWCBKC7    PBBKC7           Ship To Custome
     C                     MOVELWCBRTX    PBBRTX    P      Ship To Name
     C                     MOVELWCHMNA    PBHMNA    P      Ship To Address
     C                     MOVELWCHONA    PBHONA    P      Ship To Address
     C                     MOVELWCHPNA    PBHPNA    P      Ship To Address
     C                     MOVELWCHNNA    PBHNNA    P      Ship To City
     C                     MOVELWCDBCD    PBDBCD    P      Ship To State C
     C                     MOVELWCCKTX    PBCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWCB0C7    PBB0C7           Bill to Custome
     C                     MOVELWCAETX    PBAETX    P      Bill to Name
     C                     MOVELWCB1NA    PBB1NA    P      Bill to Address
     C                     MOVELWCB3NA    PBB3NA    P      Bill to Address
     C                     MOVELWCB4NA    PBB4NA    P      Bill to Address
     C                     MOVELWCB2NA    PBB2NA    P      Bill to City
     C                     MOVELWCBHCD    PBBHCD    P      Bill to State C
     C                     MOVELWCC8TX    PBC8TX    P      Bill to Zip/Pos
     C                     MOVELWCBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDWCA0DT    PBA0DT           Order Date
     C                     Z-ADDWCA5DT    PBA5DT           Requested Ship
     C                     Z-ADDWCGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDWCACDT    PBACDT           Cancel Date
     C                     MOVELWCAQCD    PBAQCD    P      Terms Code
     C                     MOVELWCB6NA    PBB6NA    P      Special Instruc
     C                     MOVELWCBYNA    PBBYNA    P      Special Instruc
     C                     MOVELWCBZNA    PBBZNA    P      Carrier Code
     C                     MOVELWCGTST    PBGTST    P      Comment Print A
     C                     MOVELWCGVST    PBGVST    P      Comment Print I
     C                     MOVELWCGUST    PBGUST    P      Comment Print P
     C                     MOVELWCQFST    PBQFST    P      Comment Print S
     C                     MOVELWCCQCD    PBCQCD    P      Reason Code
     C                     MOVELWCGJST    PBGJST    P      Order in Use
     C                     MOVELWCGWST    PBGWST    P      Header Status
     C                     MOVELWCGXST    PBGXST    P      Header Status L
     C                     MOVELWCGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDWCAODT    PBAODT           Scheduled Ship
     C                     MOVELWCAIVN    PBAIVN    P      User Original E
     C                     Z-ADDWCCXDT    PBCXDT           Date of Origina
     C                     Z-ADDWCJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDWCA1WG    PBA1WG           Order Weight To
     C                     MOVELWCXIST    PBXIST    P      Credit Hold
     C                     MOVELWCXJST    PBXJST    P      Production Hold
     C                     MOVELWCXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDWCEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDWCAFTM    PBAFTM           Requested Deliv
     C                     MOVELWCE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELWCE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDWCRMNB    PBRMNB           Load ID
     C                     Z-ADDWCTBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDWCR1NB    PBR1NB           Rated Freight
     C                     MOVELWCPJST    PBPJST    P      LTL Flag
     C                     MOVELWCU0ST    PBU0ST    P      Price Audit
     C                     MOVELWCU1ST    PBU1ST    P      Price Status
     C                     MOVELWCQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELWCU2ST    PBU2ST    P      Export Status
     C                     MOVELWCVEST    PBVEST    P      Palletize
     C                     MOVELWCVFST    PBVFST    P      Shrink Wrap
     C                     MOVELWCVGST    PBVGST    P      Slip Sheet
     C                     MOVELWCRPCD    PBRPCD    P      Age Code
     C                     Z-ADDWCRNNB    PBRNNB           Reefer Temperat
     C                     MOVELWCVDST    PBVDST    P      Load Type
     C                     Z-ADDWCATIN    PBATIN           Attach to Invoi
     C                     MOVELWCU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELWCU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDWCRSRN    PBRSRN           Resell Referenc
     C                     MOVELWCMHNA    PBMHNA    P      Special Comment
     C                     MOVELWCMINA    PBMINA    P      Special Comment
     C                     MOVELWCWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELWCR4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELWCBFCD    PBBFCD    P      Manager Level C
     C                     MOVELWCQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDWCT3NB    PBT3NB           Attach to Order
     C                     MOVELWCSICD    PBSICD    P      Reason for Pric
     C                     Z-ADDWCCONB    PBCONB           Invoice Number
     C                     MOVELWCCEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDWCAWDT    PBAWDT           Invoice Date
     C                     MOVELWCJPCD    PBJPCD    P      Event Code
     C                     MOVELWCXUST    PBXUST    P      Trans Contol AS
     C                     MOVELWCZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDWCVRVA    PBVRVA           A/R order Value
     C                     MOVELWCOBST    PBOBST    P      Billing Activit
     C                     MOVELWCBCST    PBBCST    P      Block Order Fla
     C                     MOVELWCBDST    PBBDST    P      Order Certifica
     C                     Z-ADDWCB7VL    PBB7VL           Invoice Order V
     C                     MOVELWCGASX    PBGASX    P      Process Sts for
     C                     MOVELWCGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELWCGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELWCGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELWCFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELWCFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELWCFPSX    PBFPSX    P      Order Emailed
     C                     MOVELWCFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELWCFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELWCFSSX    PBFSSX    P      Broker Order St
     C                     MOVELWCFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELWCFUSX    PBFUSX    P      Order Requires
     C                     MOVELWCFVSX    PBFVSX    P      OH Load Plan Re
     C                     MOVELWCFWSX    PBFWSX    P      Export USDA App
     C                     MOVELWCFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELWCFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDWCNODT    PBNODT           OH Appt Confirm
     C                     Z-ADDWCNPDT    PBNPDT           JPN Invoice Iss
     C                     Z-ADDWCNQDT    PBNQDT           Load Actual Shi
     C                     Z-ADDWCNRDT    PBNRDT           Load BOL Comple
     C                     Z-ADDWCNSDT    PBNSDT           Load Truck Depa
     C                     Z-ADDWCBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDWCBQTM    PBBQTM           Time of Origina
     C                     Z-ADDWCBRTM    PBBRTM           OH Appt Confirm
     C                     Z-ADDWCBSTM    PBBSTM           Load BOL Comple
     C                     Z-ADDWCBTTM    PBBTTM           Load Truck Depa
     C                     Z-ADDWCH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDWCH1NX    PBH1NX           Act Non-Ref Frt
     C                     Z-ADDWCH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDWCH3NX    PBH3NX           OH Total Non-Re
     C                     Z-ADDWCH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDWCC0C7    PBC0C7           Claim Number
     C                     MOVELWCUVST    PBUVST    P      EDI Status 1
     C                     MOVELWCUWST    PBUWST    P      EDI Status 2
     C                     MOVELWCUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDWCAATM    PBAATM           Job Time
     C                     MOVELWCAYNA    PBAYNA    P      User Id
     C                     MOVELWCA0NA    PBA0NA    P      Job Name
     C                     Z-ADDWCAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * CHG Event Code ALL     RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSH01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSH02           Order Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSH01           Company Number
     C                     Z-ADD#1C4NB    WQSH02           Order Number
      * Establish starting position
     C           KRSSH     SETLL@BGWKL1                    *
     C           KRSSH     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Event Code         CH - Order Detail  * 
     C                     EXSR SICHRC
     C           KRSSH     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG Event Code         CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0120  70       Item Code
     C                     MOVEL*BLANK    WN0121  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0122  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0123  70       Order Group Cod
     C                     MOVEL*BLANK    WN0124  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0125  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0126 112       Billing Detail
     C                     Z-ADD*ZERO     WN0127 112       Billing Detail
     C                     Z-ADD*ZERO     WN0128 112       Billing Detail
     C                     Z-ADD*ZERO     WN0129 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0130  1        Comment Print A
     C                     MOVEL*BLANK    WN0131  1        Comment Print I
     C                     MOVEL*BLANK    WN0132  1        Comment Print P
     C                     MOVEL*BLANK    WN0133  1        Comment Print S
     C                     Z-ADD*ZERO     WN0134 112       Extended Amount
     C                     Z-ADD*ZERO     WN0135  70       Market Pricing
     C                     MOVEL*BLANK    WN0136  3        Commodity Marke
     C                     MOVEL*BLANK    WN0137  3        Date Method Cod
     C                     MOVEL*BLANK    WN0138  3        Price Method Co
     C                     Z-ADD*ZERO     WN0139 114       Price Overage O
     C                     Z-ADD*ZERO     WN0140  70       Contract Number
     C                     MOVEL*BLANK    WN0141  1        Price Status
     C                     Z-ADD*ZERO     WN0142  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0143  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0144  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0145  1        Work Confirm St
     C                     MOVEL*BLANK    WN0146  1        Work Over/Short
     C                     MOVEL*BLANK    WN0147  1        OD Production P
     C                     MOVEL*BLANK    WN0148 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0149 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0150  1        Age Code
     C                     MOVEL*BLANK    WN0151  1        Palletize
     C                     MOVEL*BLANK    WN0152  1        Slip Sheet
     C                     MOVEL*BLANK    WN0153  1        Catch Weight St
     C                     MOVEL*BLANK    WN0154  1        Price Audit
     C                     MOVEL*BLANK    WN0155  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0156  1        Production Date
     C                     Z-ADD*ZERO     WN0157 112       Rated Freight
     C                     Z-ADD*ZERO     WN0158 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0159 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0160 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0161 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0162 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0163 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0164 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0165 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0166 114       Unit Price
     C                     Z-ADD*ZERO     WN0167 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0168 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0169 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0170 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0171  70       Requested Ship
     C                     Z-ADD*ZERO     WN0172  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0173  70       Actual Shipped
     C                     MOVEL*BLANK    WN0174  1        Affect Inventor
     C                     MOVEL*BLANK    WN0175  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0176  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0177  30       Item Structure
     C                     Z-ADD*ZERO     WN0178  30       Item Structure
     C                     Z-ADD*ZERO     WN0179  30       Item Structure
     C                     MOVEL*BLANK    WN0180  2        Item Level
     C                     MOVEL*BLANK    WN0181  2        Quality Level
     C                     MOVEL*BLANK    WN0182  2        Pricing Product
     C                     MOVEL*BLANK    WN0183  2        Season Product
     C                     Z-ADD*ZERO     WN0184  70       Date of Origina
     C                     MOVEL*BLANK    WN0185 10        User Profile Na
     C                     MOVEL*BLANK    WN0186  6        Country Code
     C                     MOVEL*BLANK    WN0187  3        Reason Code
     C                     MOVEL*BLANK    WN0188  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0189  1        Modified Flag
     C                     MOVEL*BLANK    WN0190  1        Substituted Fla
     C                     MOVEL*BLANK    WN0191  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0192 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0193 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0194  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0195  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0196  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0197  1        Affect Commissi
     C                     MOVEL*BLANK    WN0198  1        Affect Pricing
     C                     MOVEL*BLANK    WN0199  1        Released by Use
     C                     MOVEL*BLANK    WN0200  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0201  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0202  3        Production Ware
     C                     MOVEL*BLANK    WN0203  3        OD Price Type
     C                     Z-ADD*ZERO     WN0204  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0205  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0206  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0207  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0208  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0209  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0210  60       Price Code
     C                     Z-ADD*ZERO     WN0211  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0212  60       Substitution Li
     C                     Z-ADD*ZERO     WN0213  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0214 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0215 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0216 112       OD Item Target
     C                     Z-ADD*ZERO     WN0217 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0218 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0219 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0220 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0221 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0222 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0223 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0224 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0225 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0226 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0227  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0228  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0229  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0230 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0231  40       Item Age Days
     C                     Z-ADD*ZERO     WN0232  70       Production Ovr
     C                     Z-ADD*ZERO     WN0233  70       Production Ovr
     C                     MOVEL*BLANK    WN0234  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0235  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0236  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0237  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0238  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0239  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0240  1        EDI Status 1
     C                     MOVEL*BLANK    WN0241  1        EDI Status 2
     C                     MOVEL*BLANK    WN0242  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0243  60       Job Time
     C                     MOVEL*BLANK    WN0244 10        User Id
     C                     MOVEL*BLANK    WN0245 10        Job Name
     C                     Z-ADD*ZERO     WN0246  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WDAIC3           Company Number
     C                     Z-ADDOMC4NB    WDC4NB           Order Number
     C                     Z-ADDOMDPNB    WDDPNB           Order Sequence
     C                     Z-ADDOMUENB    WDUENB           Order Secondary
      *
     C           KLCHSI    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSI    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWUJPCD    WDJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##PGM     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Upd Status -Pick Ord  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEZGNX    WQSJ01           PFS Load ID
     C           *LIKE     DEFN WEZPNX    WQSJ02           PFS Order Numbe
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           PFS Load ID
     C                     KFLD           WQSJ02           PFS Order Numbe
      * Setup key
     C                     Z-ADD#1RMNB    WQSJ01           PFS Load ID
     C                     Z-ADD#1C4NB    WQSJ02           PFS Order Numbe
      * Establish starting position
     C           KRSSJ     SETLL@BKCPEK                    *
     C           KRSSJ     READE@BKCPEK                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'XO'      WUHKT1           Text 2
      * Chg Pick Ord to XO    CH - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEY1NX    WL0001           PFS Company Num
     C                     Z-ADDWEAID8    WL0002           PFS Transaction
     C                     Z-ADDWEAFTS    WL0003           PFS Transaction
     C                     Z-ADDWEBCNY    WL0004           PFS Transaction
     C                     MOVELWUHKT1    WL0005    P      PFS Ship Status
     C                     EXSR SKCHRC
     C           KRSSJ     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Pick Ord to XO    CH - PFS Ship Load/Order Sts  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0247  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0248  70       PFS Order Numbe
     C                     MOVEL*BLANK    WN0249  1        PFS Export USDA
     C                     MOVEL*BLANK    WN0250  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0251  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0252  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0253  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0254  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0255  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0256  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BKCPZU
     C                     Z-ADDWL0001    WFY1NX           PFS Company Num
     C                     Z-ADDWL0002    WFAID8           PFS Transaction
     C                     Z-ADDWL0003    WFAFTS           PFS Transaction
     C                     Z-ADDWL0004    WFBCNY           PFS Transaction
      *
     C           KLCHSK    KLIST
     C                     KFLD           WFY1NX           PFS Company Num
     C                     KFLD           WFAID8           PFS Transaction
     C                     KFLD           WFAFTS           PFS Transaction
     C                     KFLD           WFBCNY           PFS Transaction
     C           KLCHSK    CHAIN@BKCPZU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBKCPL0'MDACP
     C                     MOVEL'@BKCPZU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBK1    YCRDCS
      * Move non-key fields to @BKCPZU
     C                     MOVELWL0005    WFVRSX    P      PFS Ship Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBK1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WFAJNY           PFS Change Date
     C                     Z-ADD##JTM     WFAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBK1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BKCPZU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Upd Status-rePick Ord RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGY1NX    WQSL01           PFS Company Num
     C           *LIKE     DEFN WGZGNX    WQSL02           PFS Load ID
     C           *LIKE     DEFN WGZPNX    WQSL03           PFS Order Numbe
     C           *LIKE     DEFN WGVRSX    WQSL04           PFS Ship Status
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           PFS Company Num
     C                     KFLD           WQSL02           PFS Load ID
     C                     KFLD           WQSL03           PFS Order Numbe
     C                     KFLD           WQSL04           PFS Ship Status
      * Setup key
     C                     Z-ADD#1AIC3    WQSL01           PFS Company Num
     C                     Z-ADD#1RMNB    WQSL02           PFS Load ID
     C                     Z-ADD#1C4NB    WQSL03           PFS Order Numbe
     C                     MOVELWUHKT1    WQSL04           PFS Ship Status
      * Establish starting position
     C           KRSSL     SETLL@BKCPGZ                    *
     C           KRSSL     READE@BKCPGZ                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * change XO back to PO
      * Chg Pick Ord to XO    CH - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGY1NX    WL0001           PFS Company Num
     C                     Z-ADDWGAID8    WL0002           PFS Transaction
     C                     Z-ADDWGAFTS    WL0003           PFS Transaction
     C                     Z-ADDWGBCNY    WL0004           PFS Transaction
     C                     MOVEL'PO'      WL0005    P      PFS Ship Status
     C                     EXSR SKCHRC
     C           KRSSL     READE@BKCPGZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0257    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSM     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0007           Company Number
     C                     MOVELDRBUVN    WN0258           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0006    DTAJVN           User Profile Na
     C                     MOVELWL0007    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSN     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0008           Company Number
     C                     MOVELDTAJCD    WL0009           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSO01           Application Cod
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSO01           Application Cod
     C                     MOVEL'OMS'     WQSO01           Application Cod
      * Establish starting position
     C           KRSSO     SETLL@DNRESF                    *
     C           KRSSO     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C           KRSSO     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSP01           Application Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSP01           Application Cod
      * Establish starting position
     C           KRSSP     SETLL@DNRESF                    *
     C           KRSSP     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log
      *================================================================
      * *****
      * 05/23/16 RMC E4119 remove live with tpm check
      * ** 04/13/1015 LJB E004019  Disable 2=Edt Truck Departure
      * ** 09/02/2009 RMC S00930 Crt chg log for unpick events
      * ** 03/09/2006 LJB  T00012
      * ** F2 to change Actual Ship Date removed-See WW Shipped Orders
      * 05/12/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co fr
      * *****
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 02816
     C           ZINPOS    ANDLE05376
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  11        W0CSRR  50
     C           ZZSFM     IFEQ '0'
     C                     DIV  02        W0CSRR
     C                     MVR            ZINPOS
     C                     ELSE
     C                     Z-ADD0         ZINPOS
     C                     ENDIF
     C                     ADD  11        ZINPOS
     C                     MULT 256       ZINPOS
     C                     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD11        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C           ZZSFM     IFEQ '0'
     C                     Z-ADD2         ZHRLEN  40
     C                     ELSE
     C                     Z-ADD1         ZHRLEN
     C                     ENDIF
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDGE050
     C           ZHCSCL    ANDLE055
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CV3SX'  YPMTFD           PFS Error Reaso
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ058
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CATUS'  YPMTFD           STATUS
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ062
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2GJST'  YPMTFD           Order in Use
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ066
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2XUST'  YPMTFD           Trans Contol AS
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1C4NB           Order Number
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P1U4ST           Load Plan Order
     C                     MOVEL*BLANK    P1U5ST           Print Pick Slip
     C                     MOVEL*BLANK    P1JPCD           Event Code
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P2AIC3           Company Number
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P3E6ST           USR Status (Y/N
     C                     MOVEL*BLANK    P4PKST           Load Status
     C                     MOVEL*BLANK    P5YEST           USR Ship Y/N
     C                     Z-ADD*ZERO     P6Q2NB           Event Number
     C                     MOVEL*BLANK    P7O1ST           Live with TPM
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAQ2NB           Event Number
     C                     Z-ADD*ZERO     WAAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WAQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WAD2DT           Event Date
     C                     Z-ADD*ZERO     WAAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WAQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WAQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Define work field Event Code
     C                     MOVEL*BLANK    WUJPCD  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WDGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WEAID8           PFS Transaction
     C                     Z-ADD*ZERO     WEAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WEBCNY           PFS Transaction
     C                     Z-ADD*ZERO     WEZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WEZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WEUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WEAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WEAINY           PFS Create Time
     C                     Z-ADD*ZERO     WEAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WEAKNY           PFS Change time
      * Define work field Text 2
     C                     MOVEL*BLANK    WUHKT1  2
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SKCHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  80
     C                     Z-ADD*ZERO     WL0003  60
     C                     Z-ADD*ZERO     WL0004  50
     C                     MOVEL*BLANK    WL0005  2
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0006 10
     C                     MOVEL*BLANK    WL0007  6
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
      * Define local work field PFS Error Reason
     C                     MOVEL*BLANK    YL0001  6
      * Define local work field STATUS
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field STATUS
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field PT Serial Number
     C                     Z-ADD*ZERO     YL0005  80
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0008  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD10        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0257 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0257           User Profile Na
      *
     C                     MOVEL*BLANK    WN0258 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SMRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,032                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0257    ZA0011           User Profile Na
     C                     MOVEL'OMS'     ZA0012           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0258    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0257    WL0006    P      User Profile Na
     C                     MOVEL'OMS'     WL0007    P      Application Cod
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    P2AIC3           Company Number
     C                     MOVELWL0009    YL0008    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0258    WL0006    P      User Profile Na
     C                     MOVEL'OMS'     WL0007    P      Application Cod
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    P2AIC3           Company Number
     C                     MOVELWL0009    YL0008    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0008    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0257    ZA0013           User Profile Na
     C                     MOVEL'OMS'     ZA0014           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0007    IFNE 0                          *IF
     C                     Z-ADDYL0007    P2AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0008    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0026  3        Warehouse Code
     C                     PARM YL0007    WQ0027  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SORVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       P2TAST           First Time Flag
     C                     Z-ADD999999    W0SLM            *Scan limit
     C                     MOVEL'1'       ZZSFM            *Subfile mode
      * ***** Change Log
     C                     EXSR UASUBR                     ***** Change Lo
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01026025650256902577025800258802592
02601026100261802622026260262902632
02818028210282502833028360284402848
02857028660287402878028820288502888
03104
** W0END
01103025670257502578025860258902599
02608026150261802622026260262902638
02819028230283102834028420284502855
02864028710287402878028820288502894
03111
** W0NAM
**SPT     V2AIC3    V2C4NB    #2JNCD    #2RMNB    #2JPCD    V2AODT
V2GNDT    #CV3SX    #CATUS    #2GJST    #2XUST    #2GWST    V2BKC7
#1SEL     V1AIC3    V1C4NB    #1JNCD    #1RMNB    #1JPCD    V1AODT
V1GNDT    #RV3SX    #RATUS    #1GJST    #1XUST    #1GWST    V1BKC7
V1A5DT
** @CN
00001 WHSCDE
00002 ITMCDE
00003 PRDDTE
00004 LBLDTE
00005 ITMBAL
00006 TSTLBL
00007 LOCCDE
00008 LOCDTE
00009 ORDNUM
00010 ORDSTS
00011 ORDEVT
00012 TFRWHS
00013 TFRLOC
00014 TRKTYP
00015 SHPQTY
00016 SHPWGT
00017 SHPRSN
00018 ORDDTL
00019 ORDTNF
00020 LOADNF
00021 TRNTYP
00022 WIPCDE
00023 INACTV
00024 ORDSHP
00025 ORDWHS
00026 CLCPDT
00027 LNEITM
00028 DUPCSE
00029 DTLCAN
00030 DUPPUT
00031 USR0752
00032 Y2U0005
