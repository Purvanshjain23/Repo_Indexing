     H/TITLE EDT Confirm Ship Detl  DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 10/27/24  Time  : 02:48:40
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDL8DFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: EDT Confirm Ship Detl  DF Display file
      *
     FOPBGWKL6IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Detail              Co/Order/Item
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPMCCCPL3IF  E           K        DISK
      * RSQ : COA Batch Header          Comp, Whse, Batch Hdr St
      *
     FPDL8CPL1IF  E           K        DISK
      * RTV : Order Inv Allocation      Retrieval index
      *
     FPMCCCPL5IF  E           K        DISK
      * RSQ : COA Batch Header          Comp/Batch
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier Info              Active records
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPNGJREL1IF  E           K        DISK
      * RTV : RFS API Volume Corr Table Retrieval index
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FPMCAREL1IF  E           K        DISK
      * RTV : COA Property Define Hdr   Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDIMCPL1IF  E           K        DISK
      * RTV : Order Detail Pricing      Retrieval index
      *
     FPDJKCPL1IF  E           K        DISK
      * RTV : Order Dtl Formula Dtl     Retrieval index
      *
     FOMFNCPL2IF  E           K        DISK
      * RSQ : Manifest Detail           RSQ for Order Confirm
      *
     FOMCRWKL1IF  E           K        DISK
      * RTV : Order Detail Fin          Retrieval index
      *
     FPDMSREL2IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPMAMREL0UF  E           K        DISK
      * UPD : Order Header Extension    Update index
      *
     FOMFNCPL0UF  E           K        DISK
      * UPD : Manifest Detail           Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDIMCPL0UF  E           K        DISK
      * UPD : Order Detail Pricing      Update index
      *
     FPDJKCPL0UF  E           K        DISK
      * UPD : Order Dtl Formula Dtl     Update index
      *
     FOMCRWKL0UF  E           K        DISK
      * UPD : Order Detail Fin          Update index
      *
     FPDL8CPL0UF  E           K        DISK
      * UPD : Order Inv Allocation      Update index
      *
     FPDMSREL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 033  5 0A
     E                    W0END   7 033  5 0A
     E                    W0NAM   7 033 10
      * Long constants
     E                    @CN#    1  15  6   @CN    25
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WBRMNB
     I              FJAIC3                          WBAIC3
     I              FJAODT                          WBAODT
     I              FJPJST                          WBPJST
     I              FJPKST                          WBPKST
     I              FJRNNB                          WBRNNB
     I              FJDMTX                          WBDMTX
     I              FJDNTX                          WBDNTX
     I              FJDOTX                          WBDOTX
     I              FJWTTX                          WBWTTX
     I              FJWUTX                          WBWUTX
     I              FJRPNB                          WBRPNB
     I              FJFLAM                          WBFLAM
     I              FJXQST                          WBXQST
     I              FJRRNB                          WBRRNB
     I              FJDXTX                          WBDXTX
     I              FJDYTX                          WBDYTX
     I              FJSBNB                          WBSBNB
     I              FJBZNA                          WBBZNA
     I              FJRONB                          WBRONB
     I              FJSQNB                          WBSQNB
     I              FJR1NB                          WBR1NB
     I              FJVCST                          WBVCST
     I              FJVDST                          WBVDST
     I              FJSDNB                          WBSDNB
     I              FJPAOU                          WBPAOU
     I              FJDGWG                          WBDGWG
     I              FJSXNB                          WBSXNB
     I              FJHADT                          WBHADT
     I              FJAART                          WBAART
     I              FJDHWG                          WBDHWG
     I              FJDIWG                          WBDIWG
     I              FJAQDT                          WBAQDT
     I              FJS6NB                          WBS6NB
     I              FJT4NB                          WBT4NB
     I              FJPRTM                          WBPRTM
     I              FJNPSV                          WBNPSV
     I              FJJ8TX                          WBJ8TX
     I              FJTLMI                          WBTLMI
     I              FJJ9TX                          WBJ9TX
     I              FJQ2CD                          WBQ2CD
     I              FJVPCD                          WBVPCD
     I              FJDBCD                          WBDBCD
     I              FJGRWE                          WBGRWE
     I              FJXCCD                          WBXCCD
     I              FJU2ST                          WBU2ST
     I              FJF9DT                          WBF9DT
     I              FJONTM                          WBONTM
     I              FJJ4DT                          WBJ4DT
     I              FJTRTM                          WBTRTM
     I              FJJ5DT                          WBJ5DT
     I              FJSPTM                          WBSPTM
     I              FJJ6DT                          WBJ6DT
     I              FJLFTM                          WBLFTM
     I              FJJ7DT                          WBJ7DT
     I              FJBOTM                          WBBOTM
     I              FJJ8DT                          WBJ8DT
     I              FJBLTM                          WBBLTM
     I              FJKIDT                          WBKIDT
     I              FJASTM                          WBASTM
     I              FJKADT                          WBKADT
     I              FJAJCM                          WBAJCM
     I              FJXACD                          WBXACD
     I              FJOANA                          WBOANA
     I              FJK4TX                          WBK4TX
     I              FJVOAG                          WBVOAG
     I              FJKBDT                          WBKBDT
     I              FJNBBO                          WBNBBO
     I              FJW4CD                          WBW4CD
     I              FJEFDT                          WBEFDT
     I              FJCNTN                          WBCNTN
     I              FJKCDT                          WBKCDT
     I              FJTMIN                          WBTMIN
     I              FJKDDT                          WBKDDT
     I              FJVMNB                          WBVMNB
     I              FJOCFR                          WBOCFR
     I              FJKJDT                          WBKJDT
     I              FJATTM                          WBATTM
     I              FJOTRS                          WBOTRS
     I              FJRNST                          WBRNST
     I              FJBRBK                          WBBRBK
     I              FJEIDT                          WBEIDT
     I              FJRMST                          WBRMST
     I              FJAJCD                          WBAJCD
     I              FJKKDT                          WBKKDT
     I              FJAVTM                          WBAVTM
     I              FJKZDT                          WBKZDT
     I              FJAXTM                          WBAXTM
     I              FJLHOS                          WBLHOS
     I              FJLHOR                          WBLHOR
     I              FJWNTX                          WBWNTX
     I              FJOITX                          WBOITX
     I              FJOJTX                          WBOJTX
     I              FJLLDT                          WBLLDT
     I              FJLSHG                          WBLSHG
     I              FJYPST                          WBYPST
     I              FJK0DT                          WBK0DT
     I              FJAYTM                          WBAYTM
     I              FJKNNX                          WBKNNX
     I              FJICWG                          WBICWG
     I              FJIDWG                          WBIDWG
     I              FJH9SX                          WBH9SX
     I              FJWOTX                          WBWOTX
     I              FJK1DT                          WBK1DT
     I              FJAZTM                          WBAZTM
     I              FJK2DT                          WBK2DT
     I              FJA0TM                          WBA0TM
     I              FJROST                          WBROST
     I              FJRPST                          WBRPST
     I              FJRQST                          WBRQST
     I              FJRRST                          WBRRST
     I              FJZBVA                          WBZBVA
     I              FJWPTX                          WBWPTX
     I              FJWQTX                          WBWQTX
     I              FJWRTX                          WBWRTX
     I              FJWSTX                          WBWSTX
     I              FJRVSX                          WBRVSX
     I              FJRUSX                          WBRUSX
     I              FJRWSX                          WBRWSX
     I              FJRXSX                          WBRXSX
     I              FJRYSX                          WBRYSX
     I              FJRZSX                          WBRZSX
     I              FJR0SX                          WBR0SX
     I              FJR1SX                          WBR1SX
     I              FJR2SX                          WBR2SX
     I              FJR3SX                          WBR3SX
     I              FJR4SX                          WBR4SX
     I              FJPYDT                          WBPYDT
     I              FJCKTM                          WBCKTM
     I              FJPZDT                          WBPZDT
     I              FJCLTM                          WBCLTM
     I              FJP0DT                          WBP0DT
     I              FJCMTM                          WBCMTM
     I              FJP1DT                          WBP1DT
     I              FJCNTM                          WBCNTM
     I              FJP2DT                          WBP2DT
     I              FJCOTM                          WBCOTM
     I              FJP3DT                          WBP3DT
     I              FJCQTM                          WBCQTM
     I              FJUVST                          WBUVST
     I              FJUWST                          WBUWST
     I              FJUXST                          WBUXST
     I              FJAATM                          WBAATM
     I              FJAYNA                          WBAYNA
     I              FJA0NA                          WBA0NA
     I              FJAXDT                          WBAXDT
      *
     I@CCCPDJ
      * COA Batch Header          Comp/Batch
      * Renamed input format fields
     I              CCAIC3                          WCAIC3
     I              CCL6T1                          WCL6T1
     I              CCI3NY                          WCI3NY
     I              CCIKAA                          WCIKAA
     I              CCIDAA                          WCIDAA
     I              CCRFDT                          WCRFDT
     I              CCC2TM                          WCC2TM
     I              CCMHT1                          WCMHT1
     I              CCRGDT                          WCRGDT
     I              CCC3TM                          WCC3TM
     I              CCMKT1                          WCMKT1
     I              CCJHNY                          WCJHNY
     I              CCR1NA                          WCR1NA
     I              CCRHDT                          WCRHDT
     I              CCC4TM                          WCC4TM
     I              CCMIT1                          WCMIT1
     I              CCMJT1                          WCMJT1
     I              CCHXTX                          WCHXTX
     I              CCHJTX                          WCHJTX
     I              CCHYTX                          WCHYTX
     I              CCJENY                          WCJENY
     I              CCJVNY                          WCJVNY
     I              CCJWNY                          WCJWNY
     I              CCIMTX                          WCIMTX
     I              CCFEDS                          WCFEDS
     I              CCMTT1                          WCMTT1
     I              CCJXNY                          WCJXNY
     I              CCJ1NY                          WCJ1NY
     I              CCJCNY                          WCJCNY
     I              CCJDNY                          WCJDNY
     I              CCJ3NY                          WCJ3NY
     I              CCRLDT                          WCRLDT
     I              CCMSAA                          WCMSAA
     I              CCMTAA                          WCMTAA
     I              CCMUAA                          WCMUAA
     I              CCL8T1                          WCL8T1
     I              CCR0NY                          WCR0NY
     I              CCL7T1                          WCL7T1
     I              CCJQST                          WCJQST
     I              CCWUT1                          WCWUT1
     I              CCWVT1                          WCWVT1
     I              CCJZST                          WCJZST
     I              CCJ0ST                          WCJ0ST
     I              CCTTDT                          WCTTDT
     I              CCDRTM                          WCDRTM
     I              CCWYT1                          WCWYT1
     I              CCJUST                          WCJUST
     I              CCR4NY                          WCR4NY
     I              CCMZAA                          WCMZAA
     I              CCTUDT                          WCTUDT
     I              CCDSTM                          WCDSTM
     I              CCWZT1                          WCWZT1
     I              CCM0AA                          WCM0AA
     I              CCSANY                          WCSANY
     I              CCKJST                          WCKJST
     I              CCKKST                          WCKKST
     I              CCGZPC                          WCGZPC
     I              CCW2T1                          WCW2T1
     I              CCM1AA                          WCM1AA
     I              CCSBNY                          WCSBNY
     I              CCKLST                          WCKLST
     I              CCKPST                          WCKPST
     I              CCG0PC                          WCG0PC
     I              CCW3T1                          WCW3T1
     I              CCM2AA                          WCM2AA
     I              CCSCNY                          WCSCNY
     I              CCKQST                          WCKQST
     I              CCKRST                          WCKRST
     I              CCG1PC                          WCG1PC
     I              CCW4T1                          WCW4T1
     I              CCVSST                          WCVSST
     I              CCMJDT                          WCMJDT
     I              CCBETM                          WCBETM
     I              CCCCVN                          WCCCVN
     I              CCCDVN                          WCCDVN
     I              CCMKDT                          WCMKDT
     I              CCBFTM                          WCBFTM
     I              CCCEVN                          WCCEVN
     I              CCCFVN                          WCCFVN
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WGAIC3
     I              AMC4NB                          WGC4NB
     I              AMRMNB                          WGRMNB
     I              AMRUNB                          WGRUNB
     I              AMXACD                          WGXACD
     I              AMOANA                          WGOANA
     I              AMHBAA                          WGHBAA
     I              AMJ0T1                          WGJ0T1
     I              AMGENY                          WGGENY
     I              AMJ1T1                          WGJ1T1
     I              AMHCAA                          WGHCAA
     I              AMQWDT                          WGQWDT
     I              AMQXDT                          WGQXDT
     I              AMQYDT                          WGQYDT
     I              AMHDAA                          WGHDAA
     I              AMCCTX                          WGCCTX
     I              AMJ2T1                          WGJ2T1
     I              AMRLNA                          WGRLNA
     I              AMRMNA                          WGRMNA
     I              AMGINY                          WGGINY
     I              AMGFNY                          WGGFNY
     I              AMGGNY                          WGGGNY
     I              AMGHNY                          WGGHNY
     I              AMHEVL                          WGHEVL
     I              AMHFVL                          WGHFVL
     I              AMHGVL                          WGHGVL
     I              AMQZDT                          WGQZDT
     I              AMQ0DT                          WGQ0DT
     I              AMQ1DT                          WGQ1DT
     I              AMQ2DT                          WGQ2DT
     I              AMC2TX                          WGC2TX
     I              AMC3TX                          WGC3TX
     I              AMC6TX                          WGC6TX
     I              AMCHTX                          WGCHTX
     I              AMCITX                          WGCITX
     I              AMCLTX                          WGCLTX
     I              AMB4TX                          WGB4TX
     I              AMCUTX                          WGCUTX
     I              AMCVTX                          WGCVTX
     I              AMB9TX                          WGB9TX
     I              AMJWSC                          WGJWSC
     I              AMITNY                          WGITNY
     I              AMLMT1                          WGLMT1
     I              AMLWAA                          WGLWAA
     I              AMFVST                          WGFVST
     I              AMF0ST                          WGF0ST
     I              AMF2ST                          WGF2ST
     I              AMF3ST                          WGF3ST
     I              AMJUSC                          WGJUSC
     I              AMJVSC                          WGJVSC
     I              AMV3T1                          WGV3T1
     I              AMV4T1                          WGV4T1
     I              AMV5T1                          WGV5T1
     I              AMV6T1                          WGV6T1
     I              AMV7T1                          WGV7T1
     I              AMV8T1                          WGV8T1
     I              AMV9T1                          WGV9T1
     I              AMWAT1                          WGWAT1
     I              AMWBT1                          WGWBT1
     I              AMWCT1                          WGWCT1
     I              AMWDT1                          WGWDT1
     I              AMQJNY                          WGQJNY
     I              AMQKNY                          WGQKNY
     I              AMQLNY                          WGQLNY
     I              AMP8NY                          WGP8NY
     I              AMP9NY                          WGP9NY
     I              AMQANY                          WGQANY
     I              AMQCNY                          WGQCNY
     I              AMQDNY                          WGQDNY
     I              AMQENY                          WGQENY
     I              AMQFNY                          WGQFNY
     I              AMQGNY                          WGQGNY
     I              AMQHNY                          WGQHNY
     I              AMQINY                          WGQINY
     I              AMQMNY                          WGQMNY
     I              AMMYU1                          WGMYU1
     I              AMJXSC                          WGJXSC
     I              AMJYSC                          WGJYSC
     I              AMJZSC                          WGJZSC
     I              AMJ0SC                          WGJ0SC
     I              AMMZU1                          WGMZU1
     I              AMM0U1                          WGM0U1
     I              AMM1U1                          WGM1U1
     I              AMM2U1                          WGM2U1
     I              AMM3U1                          WGM3U1
     I              AMW5DT                          WGW5DT
     I              AMW6DT                          WGW6DT
     I              AMUVST                          WGUVST
     I              AMUWST                          WGUWST
     I              AMUXST                          WGUXST
     I              AMVSST                          WGVSST
     I              AMAATM                          WGAATM
     I              AMAYNA                          WGAYNA
     I              AMA0NA                          WGA0NA
     I              AMAXDT                          WGAXDT
      *
     I@FNCPCS
      * Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WHAIC3
     I              FNC4NB                          WHC4NB
     I              FNDPNB                          WHDPNB
     I              FNUENB                          WHUENB
     I              FNRZNB                          WHRZNB
     I              FNFOQT                          WHFOQT
     I              FNR0NB                          WHR0NB
     I              FNPMST                          WHPMST
     I              FNK7DT                          WHK7DT
     I              FNPFNX                          WHPFNX
     I              FNHGCD                          WHHGCD
     I              FNAJCD                          WHAJCD
     I              FNELDT                          WHELDT
     I              FNN5WG                          WHN5WG
     I              FNRZNA                          WHRZNA
     I              FNH5NY                          WHH5NY
     I              FNH6NY                          WHH6NY
     I              FNH7NY                          WHH7NY
     I              FNGBTX                          WHGBTX
     I              FNN6WG                          WHN6WG
     I              FNN7WG                          WHN7WG
     I              FNGCTX                          WHGCTX
     I              FNGDTX                          WHGDTX
     I              FNRBDT                          WHRBDT
     I              FNITNY                          WHITNY
     I              FNIVNY                          WHIVNY
     I              FNIUNY                          WHIUNY
     I              FNIWNY                          WHIWNY
     I              FNIXNY                          WHIXNY
     I              FNIYNY                          WHIYNY
     I              FNUVST                          WHUVST
     I              FNUWST                          WHUWST
     I              FNUXST                          WHUXST
     I              FNVSST                          WHVSST
     I              FNAATM                          WHAATM
     I              FNAYNA                          WHAYNA
     I              FNA0NA                          WHA0NA
     I              FNAXDT                          WHAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@IMCPSD
      * Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WJAIC3
     I              IMC4NB                          WJC4NB
     I              IMDPNB                          WJDPNB
     I              IMUENB                          WJUENB
     I              IMQ9CD                          WJQ9CD
     I              IMPDSQ                          WJPDSQ
     I              IMBNPR                          WJBNPR
     I              IMU6ST                          WJU6ST
     I              IMUVST                          WJUVST
     I              IMUWST                          WJUWST
     I              IMUXST                          WJUXST
     I              IMAATM                          WJAATM
     I              IMAYNA                          WJAYNA
     I              IMA0NA                          WJA0NA
     I              IMAXDT                          WJAXDT
      *
     I@JKCPYE
      * Order Dtl Formula Dtl     Update index
      * Renamed input format fields
     I              JKAIC3                          WKAIC3
     I              JKC4NB                          WKC4NB
     I              JKDPNB                          WKDPNB
     I              JKUENB                          WKUENB
     I              JKQ9CD                          WKQ9CD
     I              JKHGCD                          WKHGCD
     I              JKZXNB                          WKZXNB
     I              JKBOPR                          WKBOPR
     I              JKCDPR                          WKCDPR
     I              JKCEPR                          WKCEPR
     I              JKU6ST                          WKU6ST
     I              JKUVST                          WKUVST
     I              JKUWST                          WKUWST
     I              JKUXST                          WKUXST
     I              JKAATM                          WKAATM
     I              JKAYNA                          WKAYNA
     I              JKA0NA                          WKA0NA
     I              JKAXDT                          WKAXDT
      *
     I@FNCPE5
      * Manifest Detail           RSQ for Order Confirm
      * Renamed input format fields
     I              FNAIC3                          WLAIC3
     I              FNC4NB                          WLC4NB
     I              FNDPNB                          WLDPNB
     I              FNUENB                          WLUENB
     I              FNRZNB                          WLRZNB
     I              FNFOQT                          WLFOQT
     I              FNR0NB                          WLR0NB
     I              FNPMST                          WLPMST
     I              FNK7DT                          WLK7DT
     I              FNPFNX                          WLPFNX
     I              FNHGCD                          WLHGCD
     I              FNAJCD                          WLAJCD
     I              FNELDT                          WLELDT
     I              FNN5WG                          WLN5WG
     I              FNRZNA                          WLRZNA
     I              FNH5NY                          WLH5NY
     I              FNH6NY                          WLH6NY
     I              FNH7NY                          WLH7NY
     I              FNGBTX                          WLGBTX
     I              FNN6WG                          WLN6WG
     I              FNN7WG                          WLN7WG
     I              FNGCTX                          WLGCTX
     I              FNGDTX                          WLGDTX
     I              FNRBDT                          WLRBDT
     I              FNITNY                          WLITNY
     I              FNIVNY                          WLIVNY
     I              FNIUNY                          WLIUNY
     I              FNIWNY                          WLIWNY
     I              FNIXNY                          WLIXNY
     I              FNIYNY                          WLIYNY
     I              FNUVST                          WLUVST
     I              FNUWST                          WLUWST
     I              FNUXST                          WLUXST
     I              FNVSST                          WLVSST
     I              FNAATM                          WLAATM
     I              FNAYNA                          WLAYNA
     I              FNA0NA                          WLA0NA
     I              FNAXDT                          WLAXDT
      *
     I@CRWKL0
      * Order Detail Fin          Update index
      * Renamed input format fields
     I              N1AIC3                          WMAIC3
     I              N1C4NB                          WMC4NB
     I              N1DPNB                          WMDPNB
     I              N1UENB                          WMUENB
     I              N1DXNB                          WMDXNB
     I              N1G4ST                          WMG4ST
     I              N1BSVA                          WMBSVA
     I              N1G5NA                          WMG5NA
     I              N1DQCD                          WMDQCD
     I              N1DRCD                          WMDRCD
     I              N1AVNB                          WMAVNB
     I              N1DSCD                          WMDSCD
     I              N1GFST                          WMGFST
     I              N1SANB                          WMSANB
     I              N1OJCD                          WMOJCD
     I              N1UVCD                          WMUVCD
     I              N1CKNB                          WMCKNB
     I              N1BMST                          WMBMST
     I              N1UVST                          WMUVST
     I              N1UWST                          WMUWST
     I              N1UXST                          WMUXST
     I              N1AATM                          WMAATM
     I              N1AYNA                          WMAYNA
     I              N1A0NA                          WMA0NA
     I              N1AXDT                          WMAXDT
      *
     I@L8CPSX
      * Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WOAIC3
     I              L8C4NB                          WOC4NB
     I              L8DPNB                          WODPNB
     I              L8UENB                          WOUENB
     I              L8ALSW                          WOALSW
     I              L8J6QT                          WOJ6QT
     I              L8G9WG                          WOG9WG
     I              L8J9QT                          WOJ9QT
     I              L8HAWG                          WOHAWG
     I              L8IOSE                          WOIOSE
     I              L8OIMN                          WOOIMN
     I              L8SOAS                          WOSOAS
     I              L8ARSX                          WOARSX
     I              L8OTUS                          WOOTUS
     I              L8OTMP                          WOOTMP
     I              L8HGCD                          WOHGCD
     I              L8AJCD                          WOAJCD
     I              L8ELDT                          WOELDT
     I              L8LXNM                          WOLXNM
     I              L8YMCD                          WOYMCD
     I              L8YNCD                          WOYNCD
     I              L8UVST                          WOUVST
     I              L8UWST                          WOUWST
     I              L8UXST                          WOUXST
     I              L8VSST                          WOVSST
     I              L8AATM                          WOAATM
     I              L8AYNA                          WOAYNA
     I              L8A0NA                          WOA0NA
     I              L8AXDT                          WOAXDT
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WRAIC3
     I              MSC4NB                          WRC4NB
     I              MSDGSX                          WRDGSX
     I              MSKXCD                          WRKXCD
     I              MSDPNB                          WRDPNB
     I              MSUENB                          WRUENB
     I              MSDIC7                          WRDIC7
     I              MSO3NA                          WRO3NA
     I              MSO4NA                          WRO4NA
     I              MSRMTX                          WRRMTX
     I              MSPTTX                          WRPTTX
     I              MSHJWG                          WRHJWG
     I              MSHKWG                          WRHKWG
     I              MSRNTX                          WRRNTX
     I              MSAONX                          WRAONX
     I              MSROTX                          WRROTX
     I              MSORNA                          WRORNA
     I              MSAMNX                          WRAMNX
     I              MSANNX                          WRANNX
     I              MSAPNX                          WRAPNX
     I              MSDKPR                          WRDKPR
     I              MSA9VL                          WRA9VL
     I              MSC8SX                          WRC8SX
     I              MSRATX                          WRRATX
     I              MSRBTX                          WRRBTX
     I              MSAJNX                          WRAJNX
     I              MSZWTX                          WRZWTX
     I              MSZXTX                          WRZXTX
     I              MSZYTX                          WRZYTX
     I              MSZZTX                          WRZZTX
     I              MSK0U1                          WRK0U1
     I              MSK1U1                          WRK1U1
     I              MSIJSC                          WRIJSC
     I              MSIKSC                          WRIKSC
     I              MSK2U1                          WRK2U1
     I              MSW0DT                          WRW0DT
     I              MSUVST                          WRUVST
     I              MSUWST                          WRUWST
     I              MSUXST                          WRUXST
     I              MSVSST                          WRVSST
     I              MSAATM                          WRAATM
     I              MSAYNA                          WRAYNA
     I              MSA0NA                          WRA0NA
     I              MSAXDT                          WRAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     IYBRDCS      DS                            793
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WGAIC3
     I              AMC4NB                          WGC4NB
     I              AMRMNB                          WGRMNB
     I              AMRUNB                          WGRUNB
     I              AMXACD                          WGXACD
     I              AMOANA                          WGOANA
     I              AMHBAA                          WGHBAA
     I              AMJ0T1                          WGJ0T1
     I              AMGENY                          WGGENY
     I              AMJ1T1                          WGJ1T1
     I              AMHCAA                          WGHCAA
     I              AMQWDT                          WGQWDT
     I              AMQXDT                          WGQXDT
     I              AMQYDT                          WGQYDT
     I              AMHDAA                          WGHDAA
     I              AMCCTX                          WGCCTX
     I              AMJ2T1                          WGJ2T1
     I              AMRLNA                          WGRLNA
     I              AMRMNA                          WGRMNA
     I              AMGINY                          WGGINY
     I              AMGFNY                          WGGFNY
     I              AMGGNY                          WGGGNY
     I              AMGHNY                          WGGHNY
     I              AMHEVL                          WGHEVL
     I              AMHFVL                          WGHFVL
     I              AMHGVL                          WGHGVL
     I              AMQZDT                          WGQZDT
     I              AMQ0DT                          WGQ0DT
     I              AMQ1DT                          WGQ1DT
     I              AMQ2DT                          WGQ2DT
     I              AMC2TX                          WGC2TX
     I              AMC3TX                          WGC3TX
     I              AMC6TX                          WGC6TX
     I              AMCHTX                          WGCHTX
     I              AMCITX                          WGCITX
     I              AMCLTX                          WGCLTX
     I              AMB4TX                          WGB4TX
     I              AMCUTX                          WGCUTX
     I              AMCVTX                          WGCVTX
     I              AMB9TX                          WGB9TX
     I              AMJWSC                          WGJWSC
     I              AMITNY                          WGITNY
     I              AMLMT1                          WGLMT1
     I              AMLWAA                          WGLWAA
     I              AMFVST                          WGFVST
     I              AMF0ST                          WGF0ST
     I              AMF2ST                          WGF2ST
     I              AMF3ST                          WGF3ST
     I              AMJUSC                          WGJUSC
     I              AMJVSC                          WGJVSC
     I              AMV3T1                          WGV3T1
     I              AMV4T1                          WGV4T1
     I              AMV5T1                          WGV5T1
     I              AMV6T1                          WGV6T1
     I              AMV7T1                          WGV7T1
     I              AMV8T1                          WGV8T1
     I              AMV9T1                          WGV9T1
     I              AMWAT1                          WGWAT1
     I              AMWBT1                          WGWBT1
     I              AMWCT1                          WGWCT1
     I              AMWDT1                          WGWDT1
     I              AMQJNY                          WGQJNY
     I              AMQKNY                          WGQKNY
     I              AMQLNY                          WGQLNY
     I              AMP8NY                          WGP8NY
     I              AMP9NY                          WGP9NY
     I              AMQANY                          WGQANY
     I              AMQCNY                          WGQCNY
     I              AMQDNY                          WGQDNY
     I              AMQENY                          WGQENY
     I              AMQFNY                          WGQFNY
     I              AMQGNY                          WGQGNY
     I              AMQHNY                          WGQHNY
     I              AMQINY                          WGQINY
     I              AMQMNY                          WGQMNY
     I              AMMYU1                          WGMYU1
     I              AMJXSC                          WGJXSC
     I              AMJYSC                          WGJYSC
     I              AMJZSC                          WGJZSC
     I              AMJ0SC                          WGJ0SC
     I              AMMZU1                          WGMZU1
     I              AMM0U1                          WGM0U1
     I              AMM1U1                          WGM1U1
     I              AMM2U1                          WGM2U1
     I              AMM3U1                          WGM3U1
     I              AMW5DT                          WGW5DT
     I              AMW6DT                          WGW6DT
     I              AMUVST                          WGUVST
     I              AMUWST                          WGUWST
     I              AMUXST                          WGUXST
     I              AMVSST                          WGVSST
     I              AMAATM                          WGAATM
     I              AMAYNA                          WGAYNA
     I              AMA0NA                          WGA0NA
     I              AMAXDT                          WGAXDT
      *
     IYCRDCS      DS                            894
     IQOMFN1    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WHAIC3
     I              FNC4NB                          WHC4NB
     I              FNDPNB                          WHDPNB
     I              FNUENB                          WHUENB
     I              FNRZNB                          WHRZNB
     I              FNFOQT                          WHFOQT
     I              FNR0NB                          WHR0NB
     I              FNPMST                          WHPMST
     I              FNK7DT                          WHK7DT
     I              FNPFNX                          WHPFNX
     I              FNHGCD                          WHHGCD
     I              FNAJCD                          WHAJCD
     I              FNELDT                          WHELDT
     I              FNN5WG                          WHN5WG
     I              FNRZNA                          WHRZNA
     I              FNH5NY                          WHH5NY
     I              FNH6NY                          WHH6NY
     I              FNH7NY                          WHH7NY
     I              FNGBTX                          WHGBTX
     I              FNN6WG                          WHN6WG
     I              FNN7WG                          WHN7WG
     I              FNGCTX                          WHGCTX
     I              FNGDTX                          WHGDTX
     I              FNRBDT                          WHRBDT
     I              FNITNY                          WHITNY
     I              FNIVNY                          WHIVNY
     I              FNIUNY                          WHIUNY
     I              FNIWNY                          WHIWNY
     I              FNIXNY                          WHIXNY
     I              FNIYNY                          WHIYNY
     I              FNUVST                          WHUVST
     I              FNUWST                          WHUWST
     I              FNUXST                          WHUXST
     I              FNVSST                          WHVSST
     I              FNAATM                          WHAATM
     I              FNAYNA                          WHAYNA
     I              FNA0NA                          WHA0NA
     I              FNAXDT                          WHAXDT
      *
     IYDRDCS      DS                            159
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     IYERDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type_Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip_Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip_Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv_Cr_Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv_Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv_Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A_R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w_Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C_F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non_Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non_Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQPDIM1    E DSPDIMCPL0
      * UPD : Order Detail Pricing      Update index
      * Renamed input format fields
     I              IMAIC3                          WJAIC3
     I              IMC4NB                          WJC4NB
     I              IMDPNB                          WJDPNB
     I              IMUENB                          WJUENB
     I              IMQ9CD                          WJQ9CD
     I              IMPDSQ                          WJPDSQ
     I              IMBNPR                          WJBNPR
     I              IMU6ST                          WJU6ST
     I              IMUVST                          WJUVST
     I              IMUWST                          WJUWST
     I              IMUXST                          WJUXST
     I              IMAATM                          WJAATM
     I              IMAYNA                          WJAYNA
     I              IMA0NA                          WJA0NA
     I              IMAXDT                          WJAXDT
      *
     IQPDJK1    E DSPDJKCPL0
      * UPD : Order Dtl Formula Dtl     Update index
      * Renamed input format fields
     I              JKAIC3                          WKAIC3
     I              JKC4NB                          WKC4NB
     I              JKDPNB                          WKDPNB
     I              JKUENB                          WKUENB
     I              JKQ9CD                          WKQ9CD
     I              JKHGCD                          WKHGCD
     I              JKZXNB                          WKZXNB
     I              JKBOPR                          WKBOPR
     I              JKCDPR                          WKCDPR
     I              JKCEPR                          WKCEPR
     I              JKU6ST                          WKU6ST
     I              JKUVST                          WKUVST
     I              JKUWST                          WKUWST
     I              JKUXST                          WKUXST
     I              JKAATM                          WKAATM
     I              JKAYNA                          WKAYNA
     I              JKA0NA                          WKA0NA
     I              JKAXDT                          WKAXDT
      *
     IQOMCR1    E DSOMCRWKL0
      * UPD : Order Detail Fin          Update index
      * Renamed input format fields
     I              N1AIC3                          WMAIC3
     I              N1C4NB                          WMC4NB
     I              N1DPNB                          WMDPNB
     I              N1UENB                          WMUENB
     I              N1DXNB                          WMDXNB
     I              N1G4ST                          WMG4ST
     I              N1BSVA                          WMBSVA
     I              N1G5NA                          WMG5NA
     I              N1DQCD                          WMDQCD
     I              N1DRCD                          WMDRCD
     I              N1AVNB                          WMAVNB
     I              N1DSCD                          WMDSCD
     I              N1GFST                          WMGFST
     I              N1SANB                          WMSANB
     I              N1OJCD                          WMOJCD
     I              N1UVCD                          WMUVCD
     I              N1CKNB                          WMCKNB
     I              N1BMST                          WMBMST
     I              N1UVST                          WMUVST
     I              N1UWST                          WMUWST
     I              N1UXST                          WMUXST
     I              N1AATM                          WMAATM
     I              N1AYNA                          WMAYNA
     I              N1A0NA                          WMA0NA
     I              N1AXDT                          WMAXDT
      *
     IQPDL81    E DSPDL8CPL0
      * UPD : Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WOAIC3
     I              L8C4NB                          WOC4NB
     I              L8DPNB                          WODPNB
     I              L8UENB                          WOUENB
     I              L8ALSW                          WOALSW
     I              L8J6QT                          WOJ6QT
     I              L8G9WG                          WOG9WG
     I              L8J9QT                          WOJ9QT
     I              L8HAWG                          WOHAWG
     I              L8IOSE                          WOIOSE
     I              L8OIMN                          WOOIMN
     I              L8SOAS                          WOSOAS
     I              L8ARSX                          WOARSX
     I              L8OTUS                          WOOTUS
     I              L8OTMP                          WOOTMP
     I              L8HGCD                          WOHGCD
     I              L8AJCD                          WOAJCD
     I              L8ELDT                          WOELDT
     I              L8LXNM                          WOLXNM
     I              L8YMCD                          WOYMCD
     I              L8YNCD                          WOYNCD
     I              L8UVST                          WOUVST
     I              L8UWST                          WOUWST
     I              L8UXST                          WOUXST
     I              L8VSST                          WOVSST
     I              L8AATM                          WOAATM
     I              L8AYNA                          WOAYNA
     I              L8A0NA                          WOA0NA
     I              L8AXDT                          WOAXDT
      *
     IYFRDCS      DS                            525
     IQPDMS1    E DSPDMSREL0
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WRAIC3
     I              MSC4NB                          WRC4NB
     I              MSDGSX                          WRDGSX
     I              MSKXCD                          WRKXCD
     I              MSDPNB                          WRDPNB
     I              MSUENB                          WRUENB
     I              MSDIC7                          WRDIC7
     I              MSO3NA                          WRO3NA
     I              MSO4NA                          WRO4NA
     I              MSRMTX                          WRRMTX
     I              MSPTTX                          WRPTTX
     I              MSHJWG                          WRHJWG
     I              MSHKWG                          WRHKWG
     I              MSRNTX                          WRRNTX
     I              MSAONX                          WRAONX
     I              MSROTX                          WRROTX
     I              MSORNA                          WRORNA
     I              MSAMNX                          WRAMNX
     I              MSANNX                          WRANNX
     I              MSAPNX                          WRAPNX
     I              MSDKPR                          WRDKPR
     I              MSA9VL                          WRA9VL
     I              MSC8SX                          WRC8SX
     I              MSRATX                          WRRATX
     I              MSRBTX                          WRRBTX
     I              MSAJNX                          WRAJNX
     I              MSZWTX                          WRZWTX
     I              MSZXTX                          WRZXTX
     I              MSZYTX                          WRZYTX
     I              MSZZTX                          WRZZTX
     I              MSK0U1                          WRK0U1
     I              MSK1U1                          WRK1U1
     I              MSIJSC                          WRIJSC
     I              MSIKSC                          WRIKSC
     I              MSK2U1                          WRK2U1
     I              MSW0DT                          WRW0DT
     I              MSUVST                          WRUVST
     I              MSUWST                          WRUWST
     I              MSUXST                          WRUXST
     I              MSVSST                          WRVSST
     I              MSAATM                          WRAATM
     I              MSAYNA                          WRAYNA
     I              MSA0NA                          WRA0NA
     I              MSAXDT                          WRAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Event Number
     I                                    P   1   30P1Q2NB
      * N :  USR Case Quantity
     I                                    P   4   60P1FYQT
      * N :  USR Case Weight
     I                                    P   7  122P1ZPNB
      * N :  USR Status (Y/N)
     I                                       13  13 P1E6ST
      * N :  Email User ID
     I                                       14  21 P1PFNA
      * N :  Order Number 1  PASS  USR
     I                                    P  22  295P1AJAE
     IP2PARM      DS
      * FLD: Company Defaults Internal
      * N :  Allow Mult Whse to Order
     I                                        1   1 P2HSST
      * N :  Company Organization
     I                                        2   2 P2YJSX
     IP3PARM      DS
      * FLD: Order Detail
      * I : RST Company Number
     I                                    P   1   20P3AIC3
      * I : RST Order Number
     I                                    P   3   60P3C4NB
      * I :  Actual Shipped Date
     I                                    P   7  100P3GNDT
     IP4PARM      DS
      * FLD: Order Header TRG
      * N : MAP Order Type_Sales
     I                                        1   2 P4JNCD
      * N :  Ship To Customer
     I                                    P   3   60P4BKC7
      * N :  Ship To Name
     I                                        7  36 P4BRTX
      * N : MAP Customer Purchase Order #
     I                                       37  51 P4BCNA
      * N : MAP Order Date
     I                                    P  52  550P4A0DT
      * N : MAP Requested Ship Date
     I                                    P  56  590P4A5DT
      * N : MAP Special Instructions
     I                                       60  99 P4B6NA
      * N : MAP Special Instructions 2
     I                                      100 139 P4BYNA
      * N : MAP Carrier Code
     I                                      140 142 P4BZNA
      * N : MAP Order Type Print Status
     I                                      143 143 P4GYST
      * N :  Scheduled Ship Date
     I                                    P 144 1470P4AODT
      * N : MAP Order Value Total
     I                                    P 148 1532P4JZVA
      * N : MAP Order Weight Total
     I                                    P 154 1592P4A1WG
      * N : MAP Load ID
     I                                    P 160 1630P4RMNB
      * N : MAP Export Status
     I                                      164 164 P4U2ST
      * N : MAP Palletize
     I                                      165 165 P4VEST
      * N : MAP Shrink Wrap
     I                                      166 166 P4VFST
      * N : MAP Slip Sheet
     I                                      167 167 P4VGST
      * N : MAP Reefer Temperature
     I                                    P 168 1702P4RNNB
      * N :  Billing Activity Type
     I                                      171 171 P4OBST
      * N :  Email Cust On Order Ship
     I                                      172 172 P4FOSX
      * N :  Order Emailed
     I                                      173 173 P4FPSX
     IP5PARM      DS
      * FLD: *Arrays
      * I :  Warehouse Code
     I                                        1   3 P5AJCD
      * N :  Salesperson Code
     I                                        4   6 P5BCCD
      * N :  Allow Multi_Company
     I                                        7   7 P5I6ST
      * N :  Allow Multi Warehouse
     I                                        8   8 P5I8ST
      * N :  Default Printer
     I                                        9  18 P5MPNA
      * N :  First Time Flag
     I                                       19  19 P5TAST
      * N :  Access Denied (Y/N)
     I                                       20  20 P5WVST
      * N :  Access Limited Sts USR
     I                                       21  21 P5HHST
     IP6PARM      DS
      * FLD: Warehouse Codes
      * N :  Lot Tracking Flag
     I                                        1   1 P6VHST
     IP7PARM      DS
      * N :  Status Flag 1  Y/N
     I                                        1   1 P7Q1ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Warehouse not allowed'
      * Warehouse Code
     I                                        1   3 ZA0001
      * Message data for 'COA Batch not frm sam tnk'
      * COA Batch Number
     I                                    P   1   30ZA0002
      * Message data for 'COA Batch is closed/NF'
      * COA Batch Number
     I                                    P   1   30ZA0003
      * Message data for 'Carrier broker not found'
      * Carrier Broker
     I                                        1   3 ZA0004
      * Message data for 'COA Temp Loadout invalid'
      * COA Temperature Loadout
     I                                    P   1   20ZA0005
      * Message data for 'Order is Not Shipped'
      * Order Number
     I                                        1   7 ZA0006
      * Message data for 'Order is Confirmed for'
      * Order Number
     I                                        1   7 ZA0007
      * Message data for 'Cannot Change Whse'
      * Warehouse Code
     I                                        1   3 ZA0008
      * Message data for 'Item is Confirmed and can'
      * Item Code
     I                                        1   7 ZA0009
      * Message data for 'Can't Subst a Substitute'
      * *SFLSEL
     I                                        1   1 ZA0010
      * Message data for 'Item is not Co-Pack'
      * Item Code
     I                                        1   7 ZA0011
      * Message data for 'COA Temp Loadout invalid'
      * COA Temperature Loadout
     I                                    P   1   20ZA0012
      * Message data for 'Can't Delete Confirmed'
      * *SFLSEL
     I                                        1   1 ZA0013
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0014
      * Application Code
     I                                       11  16 ZA0015
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0016
      * Application Code
     I                                       11  16 ZA0017
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P3AIC3    PARM           WP0001  30       Company Number
     C           P3C4NB    PARM           WP0002  70       Order Number
     C           P3GNDT    PARM           WP0003  70       Actual Shipped
     C           P5AJCD    PARM           WP0004  3        Warehouse Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * First Time Through Program
      * CASE: PAR.First Time Flag is Yes
     C           P5TAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       P5TAST           First Time Flag
     C                     Z-ADDP3AIC3    #2AIC3           Company Number
     C                     Z-ADDP3C4NB    #2C4NB           Order Number
     C                     MOVELP5AJCD    #2AJCD           Warehouse Code
     C                     Z-ADDP3GNDT    #2GNDT           Actual Shipped
      * RTV Ship Header        RT - Order Header TRG  * 
     C                     EXSR SARVGN
     C                     MOVEL'Y'       WUE6ST           USR Status (Y/N
      * RTV Check Ship Confirm RT - Order Detail  * 
     C                     EXSR SBRVGN
     C                     MOVEL'Y'       WUE6ST           USR Status (Y/N
      * RTV Deadln DepartDT/TM RT - Load Header  * 
     C                     EXSR SCRVGN
     C                     MOVEL'N'       YL0003           WHS Req Meter R
      * FP1110 RMC 4/11/08 HPB only get prod temp which is loadout temp
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P2YJSX    IFEQ 'H'                        *IF
      * RMC force to NO for hpb so they cant change the ctl warehouse.
     C                     MOVEL'N'       P5I8ST           Allow Multi War
      * Rtv HPB fields        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2AJCD    WL0001    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0004    P      Production Ware
     C                     MOVELWL0003    YL0005    P      Warehouse Locat
     C                     MOVELWL0004    YL0003    P      WHS Req Meter R
      * CASE: LCL.WHS Req Meter Reading Shp is Yes
     C           YL0003    IFEQ 'Y'                        *IF
      * RTV HPB-temp,CarrBrk  RT - Load Header  * 
     C                     EXSR SERVGN
      * CASE: CTL.Carrier Broker is not entered
     C           #CXCCD    IFEQ *BLANK                     *IF
      * CASE: CTL.Carrier Code is Not Buyer's Truck
     C           #PBZNA    IFNE 'BUY'                      *IF
     C                     MOVEL#PBZNA    #CXCCD           Carrier Broker
     C                     END                             *FI
     C                     END                             *FI
      * *Set Cursor: CTL.COA Temperature Loadout  (*Override=*YES)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD007       W0ROW0
     C                     Z-ADD075       W0COL0
     C                     MOVEL'1'       W0OVR0           *YES
      * CASE: CTL.Carrier Code is Buyer's Truck
     C           #PBZNA    IFEQ 'BUY'                      *IF
     C                     MOVEL'Y'       P7Q1ST           Status Flag 1
      * *Set Cursor: CTL.Carrier Broker  (*Override=*YES)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD007       W0ROW0
     C                     Z-ADD046       W0COL0
     C                     MOVEL'1'       W0OVR0           *YES
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       P7Q1ST           Status Flag 1
     C                     END                             *FI
      * RTV HPB fields         RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0005           Company Number
     C                     Z-ADD#2C4NB    WL0006           Order Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0006           HPB COA Batch N
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.HPB COA Batch Number is Not entered
      *   |- c2    : LCL.Warehouse Location is Internal (Plant)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0006    IFEQ *ZERO                      *IF
     C           YL0005    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * FP1322 chk for an open tank per prod whse on the order's whse
      * Rtv Acct Co          RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0004    WL0008    P      Warehouse Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0007           Accounting Comp
      * RTV Get Open Batch    RT - COA Batch Header  * get open batch
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     Z-ADDYL0006    #CI3NY           COA Batch Numbe
     C                     Z-ADDWUPRTM    #CJENY           COA Temperature
     C                     Z-ADD#CJENY    WUJENY           COA Temperature
     C                     MOVEL#CXCCD    YL0008           Carrier Broker
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMHGCD           Item Code
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C                     MOVEL*ZERO     OMHGCD           Item Code
     C           KPOS      SETLL@BGWKZL
     C           KRST      KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    OMAIC3
     C                     Z-ADD#2C4NB    OMC4NB
     C           KRST      READE@BGWKZL                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2XIST    WZXIST
     C                     MOVEL#2XIST    WZXIST           Credit Hold
     C           *LIKE     DEFN #2XJST    WZXJST
     C                     MOVEL#2XJST    WZXJST           Production Hold
     C           *LIKE     DEFN #2GWST    WZGWST
     C                     MOVEL#2GWST    WZGWST           Header Status
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type_Sale
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2HNNA    WZHNNA
     C                     MOVEL#2HNNA    WZHNNA           Ship To City
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2AFTM    WZAFTM
     C                     MOVEL#2AFTM    WZAFTM           Requested Deliv
     C           *LIKE     DEFN #2GJST    WZGJST
     C                     MOVEL#2GJST    WZGJST           Order in Use
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2U2ST    WZU2ST
     C                     MOVEL#2U2ST    WZU2ST           Export Status
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2AJCD    WZAJCD
     C                     MOVEL#2AJCD    WZAJCD           Warehouse Code
     C           *LIKE     DEFN #2GNDT    WZGNDT
     C                     MOVEL#2GNDT    WZGNDT           Actual Shipped
     C           *LIKE     DEFN #2VEST    WZVEST
     C                     MOVEL#2VEST    WZVEST           Palletize
     C           *LIKE     DEFN #2VGST    WZVGST
     C                     MOVEL#2VGST    WZVGST           Slip Sheet
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BGWKZL                  90*
     C  N82                READ @BGWKZL                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,35
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           OMBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Subfile Record Selection
      * CASE: DB1.Detail Line Status is Not closed or cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C                     MOVEL'Y'       WUE6ST           USR Status (Y/N
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Transaction - Ship Date
      * CASE: CTL.Actual Shipped Date is not entered
     C           #2GNDT    IFEQ *ZERO                      *IF
     C                     Z-ADDOMGNDT    #2GNDT           Actual Shipped
     C                     END                             *FI
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0010    P      Warehouse Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    #RVHST    P      Lot Tracking Fl
      * CASE: RCD.Lot Tracking Flag is yes
     C           #RVHST    IFEQ 'Y'                        *IF
      * Rtv Item Alloc Qty    RT - PD Order Inv Allocation  * 
     C                     EXSR SJRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDOMCBQT    #RC0QT           USR Quantity Co
     C                     Z-ADDOMATWG    #RA7WG           USR Weight Conf
     C                     END                             *FI
     C                     MOVEL*BLANK    #RENTX           USR Confirm Sta
     C                     MOVEL*BLANK    #REOTX           USR Line Status
      * Line Status Description
      * Line Status Description
      * CASE: DB1.Detail Line Status is Available
     C           OMGMST    IFEQ 'A'                        *IF
     C                     MOVEL'AVAIL'   #REOTX           USR Line Status
     C                     ELSE
      * CASE: DB1.Detail Line Status is Complete
     C           OMGMST    IFEQ 'C'                        *IF
     C                     MOVEL'COMPL'   #REOTX           USR Line Status
     C                     ELSE
      * CASE: DB1.Detail Line Status is Confirmed
     C           OMGMST    IFEQ 'R'                        *IF
     C                     MOVEL'CONFM'   #REOTX           USR Line Status
     C                     ELSE
      * CASE: DB1.Detail Line Status is Entered
     C           OMGMST    IFEQ 'E'                        *IF
     C                     MOVEL'ENTER'   #REOTX           USR Line Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Confirm Status on screen
      * over status
      * CASE: DB1.Work Over/Short Status is Overage
     C           OMR0ST    IFEQ 'O'                        *IF
     C                     MOVEL*BLANK    #RENTX           USR Confirm Sta
     C                     MOVEL'OVER'    #RENTX           USR Confirm Sta
     C                     END                             *FI
      * Short status
      * CASE: DB1.Work Over/Short Status is Short
     C           OMR0ST    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    #RENTX           USR Confirm Sta
     C                     MOVEL'SHORT'   #RENTX           USR Confirm Sta
     C                     END                             *FI
      * Substitution
      * CASE: DB1.Order Secondary Line Seq is GT 1
     C           OMUENB    IFGT 1                          *IF
     C                     MOVEL*BLANK    #RENTX           USR Confirm Sta
     C                     MOVEL'SUBST'   #RENTX           USR Confirm Sta
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@BGWKZL                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAJCD    CASNE#2AJCD    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
     C                     MOVEL*BLANK    WUR5ST           Create Requeste
      * HPB ONLY          9/17/08
      * CASE:
      *  - c3 AND(c1ORc2ORc4ORc5ORc6)
      *   |- c3    : PAR.Company Organization is High Plains Biodiesel
      *   |- c1    : CTL.COA Batch Number NE LCL.HPB COA Batch Number
      *   |- c2    : CTL.Warehouse Code NE PAR.Warehouse Code
      *   |- c4    : CTL.Carrier Broker is Buyer's Truck
      *   |- c5    : CTL.Carrier Broker NE LCL.Carrier Broker
      *   |- c6    : CTL.Carrier Broker is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2YJSX    IFEQ 'H'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #CI3NY    IFNE YL0006                     *IF
     C           #2AJCD    ORNE P5AJCD                     *OR
     C           #CXCCD    OREQ 'BUY'                      *OR
     C           #CXCCD    ORNE YL0008                     *OR
     C           #CXCCD    OREQ *BLANK                     *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv HPB fields        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#2AJCD    WL0001    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0004    P      Production Ware
     C                     MOVELWL0003    YL0005    P      Warehouse Locat
     C                     MOVELWL0004    YL0003    P      WHS Req Meter R
      * FP1322 chk for an open tank per prod whse on the order's whse
      * Rtv Acct Co          RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0004    WL0008    P      Warehouse Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0007           Accounting Comp
      * CASE: LCL.Warehouse Location is Internal (Plant)
     C           YL0005    IFEQ 'I'                        *IF
      * if whse was chgd from a non-meter reading to a meter reading -> e
      * CASE: LCL.WHS Req Meter Reading Shp is Yes
     C           YL0003    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.COA Batch Number is Equal zero
      *   |- c2    : LCL.COA Batch Number is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CI3NY    IFEQ *ZERO                      *IF
     C           YL0009    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#2AJCD    ZA0001           Warehouse Code
      * Send message 'Warehouse not allowed'
     C                     MOVEL'USR4093' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.HPB COA Batch Number is Entered
     C           YL0006    IFGT *ZERO                      *IF
      * CASE: LCL.Warehouse Location is Internal (Plant)
     C           YL0005    IFEQ 'I'                        *IF
      * RTV Chk for Batch Opn RT - COA Batch Header  * get open batch
     C                     EXSR SKRVGN
      * validate batch for warehouse
      * CASE: LCL.COA Batch Header Sts is Open for shipping
     C           YL0011    IFEQ 'O'                        *IF
      * CASE: LCL.Warehouse Code Assigned NE LCL.Production Warehouse Cod
     C           YL0010    IFNE YL0004                     *IF
      * Setup message data for message
     C                     Z-ADD#CI3NY    ZA0002           COA Batch Numbe
      * Send message 'COA Batch not frm sam tnk'
     C                     MOVEL'USR4024' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#CI3NY    ZA0003           COA Batch Numbe
      * Send message 'COA Batch is closed/NF'
     C                     MOVEL'USR4023' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Carrier broker req
      * CASE: LCL.WHS Req Meter Reading Shp is Yes
     C           YL0003    IFEQ 'Y'                        *IF
      * Val Carrier Active     RT - Carrier  * 
     C                     EXSR SLRVGN
      * CASE:
      *  - c1ORc2
      *   |- c1    : PGM.*Return code is *Record does not exist
      *   |- c2    : CTL.Carrier Broker is Buyer's Truck
      *   '-
     C           W0RTN     IFEQ @CN,001                    *IF
     C           #CXCCD    OREQ 'BUY'                      *OR
      * Setup message data for message
     C                     MOVEL#CXCCD    ZA0004           Carrier Broker
      * Send message 'Carrier broker not found'
     C                     MOVEL'USR2428' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * F4 on Carrier broker - new FP1110 8/28/08 RMC
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Carrier Broker
     C           W0CFL     IFEQ '#CXCCD'                   *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #CXCCD    PARM #CXCCD    WQ0001  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Process Command Key Actions
      * CASE: CTL.*CMD key is *Comments
     C           *IN18     IFEQ '1'                        *IF
      * EDT OP Order Comment   EF - OP Order Comment  * 
     C                     CALL 'PDAGEFR'              90  EDT OP Order Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0002  30       Company Number
     C                     PARM #2C4NB    WQ0003  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAGEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     GOTO DAEXIT                     *QUIT
      * ==============================================================
     C                     ELSE
      * CASE: CTL.*CMD key is *Create
     C           *IN06     IFEQ '1'                        *IF
      * ADD Ship Line Item     E1 - Order Detail  * 
     C                     CALL 'PDN6E1R'              90  ADD Ship Line I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0004  30       Company Number
     C                     PARM #2C4NB    WQ0005  70       Order Number
     C                     PARM *ZERO     WQ0006  30       Order Sequence
     C                     PARM *ZERO     WQ0007  30       Order Secondary
     C                     PARM #2AJCD    WQ0008  3        Warehouse Code
     C                     PARM P3GNDT    WQ0009  70       Actual Shipped
     C                     PARM YL0001    WQ0010  70       Deadline Depart
     C                     PARM YL0002    WQ0011  60       Deadline Depart
     C                     PARM P2HSST    WQ0012  1        Allow Mult Whse
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN6E1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Reset allow update to warehouse
      * CASE: PAR.Allow Mult Whse to Order is yes
     C           P2HSST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Warehouse      RT - OM Shipping Detail  * 
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
      * ==============================================================
     C                     ELSE
      * CASE: CTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
      * FP1110 - RMC 4/11/08 HPB Only - and if whs requires meter reading
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Company Organization is High Plains Biodiesel
      *   |- c2    : LCL.WHS Req Meter Reading Shp is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2YJSX    IFEQ 'H'                        *IF
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: LCL.Warehouse Location is Internal (Plant)
     C           YL0005    IFEQ 'I'                        *IF
     C                     Z-ADD#CJENY    YL0012           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD30        WL0012           RFS API Gravity
     C                     Z-ADDYL0012    WL0013           RFS Loadout Tem
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    WUSUNY           RFS API Vol Cor
      * hpb updates for internal warehouse order
      * CASE: WRK.RFS API Vol Corr Factor is Not Found
     C           WUSUNY    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#CJENY    ZA0005           COA Temperature
      * Send message 'COA Temp Loadout invalid'
     C                     MOVEL'USR3925' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9933  *
      *
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Upd Load Header and Manif Dtl and Ord dtl if there
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : CTL.COA Temperature Loadout NE WRK.COA Temperature L
      *   |- c2    : CTL.COA Batch Number NE LCL.HPB COA Batch Number
      *   |- c3    : CTL.Carrier Broker NE LCL.Carrier Broker
      *   '-
     C           #CJENY    IFNE WUJENY                     *IF
     C           #CI3NY    ORNE YL0006                     *OR
     C           #CXCCD    ORNE YL0008                     *OR
      * RTV HPB Recalc Nt/Upd RT - Manifest Detail  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * data is updated thru selection of rin process.
      * RTV Chg Batch if 0    RT - Order Header Extension  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
     C                     END                             *FI
      * WI517 DN 10/12/23-Setup Eradani's Environment Libraries.
      * Upd Setup Eradani Libs CL - /UT User Programs  * 
     C                     CALL 'PVBFUPC'              90  Upd Setup Erada
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVBFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/04/23-Initialize 'Send Email f/Failed API U'.
     C                     MOVEL'N'       YL0033           Send Email f/Fa
      * WI517 DN 10/04/23-Added 'Called From Program' Input Parm.
      * - Added 'Send Email f/Failed API U' Output Parm.
      * ADD Ready to Confirm   XF - Order Detail  * 
     C                     CALL 'PDN2XFR'              90  ADD Ready to Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0013  30       Company Number
     C                     PARM #2C4NB    WQ0014  70       Order Number
     C                     PARM P3GNDT    WQ0015  70       Actual Shipped
     C           P5WVST    PARM P5WVST    WQ0016  1        Access Denied (
     C                     PARM P4AODT    WQ0017  70       Scheduled Ship
     C                     PARM @CN,002   WQ0018 10        Called From Pro
     C           YL0033    PARM *BLANK    WQ0019  1        Send Email f/Fa
     C                     PARM *BLANK    WQ0020  1        SSCC Pallet ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDN2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * WI517 DN 10/04/23-If 'Send Email f/Failed API U=Yes' Then Send Em
      * CASE: LCL.Send Email f/Failed API U is Yes
     C           YL0033    IFEQ 'Y'                        *IF
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                     CALL 'PVA9XFR'              90  Prc Eml Shippin
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,002   WQ0021 10        Called From Pro
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * If order not shipped display message, else display shipped messag
      * CASE: PAR.Access Denied (Y/N) is yes
     C           P5WVST    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0006           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order is Not Shipped'
     C                     MOVEL'USR1363' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0007           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0007           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Order is Confirmed for'
     C                     MOVEL'USR1960' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * View Shipping Instructions
      * CASE: CTL.*CMD key is CF19
     C           *IN19     IFEQ '1'                        *IF
      * DSP Shipping Inst.     DF - PD Shipping Instructions  * 
     C                     CALL 'PDNADFR'              90  DSP Shipping In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0022  30       Company Number
     C                     PARM #2C4NB    WQ0023  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNADFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * CASE: PAR.USR Status (Y/N) is yes
     C           P1E6ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL'N'       P1E6ST           USR Status (Y/N
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,35
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * Process Action Selections
      * Change Warehouse  - chg for HPB 09/05/08
      * CASE: RCD.*SFLSEL is *Change
     C           #1SEL     IFEQ '2'                        *IF
      * CASE: PAR.Company Organization is Not HPB
     C           P2YJSX    IFEQ 'D'                        *IF
     C           P2YJSX    OREQ 'S'
      * Option not allowed if company has 1 whse per order
      * CASE: PAR.Allow Mult Whse to Order is Not Yes
     C           P2HSST    IFEQ *BLANK                     *IF
     C           P2HSST    OREQ 'N'
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0008           *SFLSEL
      * Send message 'Cannot Change Whse'
     C                     MOVEL'USR2148' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * EDT Change Whse Code   E1 - OM Shipping Detail  * 
     C                     CALL 'PDMTE1R'              90  EDT Change Whse
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0024  30       Company Number
     C                     PARM #1C4NB    WQ0025  70       Order Number
     C                     PARM #1DPNB    WQ0026  30       Order Sequence
     C           #1UENB    PARM #1UENB    WQ0027  30       Order Secondary
     C           #1AJCD    PARM #1AJCD    WQ0028  3        Warehouse Code
     C                     PARM P3GNDT    WQ0029  70       Actual Shipped
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMTE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * HPB ONLY-allow whse change  RMC 09/05/08
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0045           Company Number
     C                     Z-ADD#1C4NB    WL0046           Order Number
     C                     MOVEL'N'       WL0047    P      Order in Use
     C                     EXSR TACHRC
      * ** Access Limited parm added                     W288
      * EDT Schd Shp Dte/Whse  E1 - Order Header TRG  * 
     C                     CALL 'PDLQE1R'              90  EDT Schd Shp Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0030  30       Company Number
     C                     PARM #1C4NB    WQ0031  70       Order Number
     C                     PARM P5HHST    WQ0032  1        Access Limited
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLQE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * RTV Whse/Non Cancelled RT - Order Detail  * 
     C                     EXSR TBRVGN
     C                     MOVEL#1AJCD    #2AJCD           Warehouse Code
      * CHG Order in Use       CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0045           Company Number
     C                     Z-ADD#1C4NB    WL0046           Order Number
     C                     MOVEL'Y'       WL0047    P      Order in Use
     C                     EXSR TACHRC
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * Substitution
      * CASE: RCD.*SFLSEL is Opt 7
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * CASE: RCD.Detail Line Status is Confirmed
     C           #1GMST    IFEQ 'R'                        *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0009           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0009           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item is Confirmed and can'
     C                     MOVEL'USR1961' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: RCD.Order Secondary Line Seq is GT 1
     C           #1UENB    IFGT 1                          *IF
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0010           *SFLSEL
      * Send message 'Can't Subst a Substitute'
     C                     MOVEL'USR2407' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * used to call PDN7E1R, EDT Subst. Ship Item E1;parms=RCD,
      *    except Allow Mult Whse=PAR
      * WW Order Substitutions EF - PD Order Detail  * 
     C                     CALL 'PDR7EFR'              90  WW Order Substi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0033  30       Company Number
     C                     PARM #1C4NB    WQ0034  70       Order Number
     C                     PARM #1DPNB    WQ0035  30       Order Sequence
     C                     PARM #1UENB    WQ0036  30       Order Secondary
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDR7EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
      * Substitution
      * CASE: RCD.Order Secondary Line Seq is GT 1
     C           #1UENB    IFGT 1                          *IF
     C                     MOVEL*BLANK    #RENTX           USR Confirm Sta
     C                     MOVEL'SUBST'   #RENTX           USR Confirm Sta
     C                     END                             *FI
     C                     END                             *FI
      * 8=WW Manifest OR Edit Lot/Location Shipping Detail (process line)
      * CASE: RCD.*SFLSEL is *8
     C           #1SEL     IFEQ '8'                        *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1AJCD    WL0010    P      Warehouse Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    P6VHST    P      Lot Tracking Fl
      * CASE: PAR.Lot Tracking Flag is yes
     C           P6VHST    IFEQ 'Y'                        *IF
      * CASE: JOB.*USER is All IS DEV/PRD & Prktest
     C           ##USR     IFEQ @CN,003                    *IF
     C           ##USR     OREQ @CN,004
     C           ##USR     OREQ @CN,005
     C           ##USR     OREQ @CN,006
     C           ##USR     OREQ @CN,007
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
      * Edt Lot/Loc Ship Dtl  ET - PD Order Detail  * 
     C                     CALL 'PDH8ETR'              90  Edt Lot/Loc Shi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0037  30       Company Number
     C                     PARM #1C4NB    WQ0038  70       Order Number
     C                     PARM #1DPNB    WQ0039  30       Order Sequence
     C                     PARM #1UENB    WQ0040  30       Order Secondary
     C           P1FYQT    PARM P1FYQT    WQ0041  50       USR Case Quanti
     C           P1ZPNB    PARM P1ZPNB    WQ0042 112       USR Case Weight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDH8ETR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
     C                     EXSR TCRVGN
      * VAL: Co-Pack
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.Warehouse Code is Cloverleaf Freezer
      *   |- c2    : LCL.Item Structure Type Code is NE 900
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AJCD    IFEQ 'CF1'                      *IF
     C           YL0036    IFNE 900                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0011           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0011           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item is not Co-Pack'
     C                     MOVEL'USR3592' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edt Lot/Loc Ship Dtl  ET - Order Detail  * 
     C                     CALL 'PDH8ETR'              90  Edt Lot/Loc Shi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0043  30       Company Number
     C                     PARM #1C4NB    WQ0044  70       Order Number
     C                     PARM #1DPNB    WQ0045  30       Order Sequence
     C                     PARM #1UENB    WQ0046  30       Order Secondary
     C           P1FYQT    PARM P1FYQT    WQ0047  50       USR Case Quanti
     C           P1ZPNB    PARM P1ZPNB    WQ0048 112       USR Case Weight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDH8ETR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Company Organization is Not HPB
     C           P2YJSX    IFEQ 'D'                        *IF
     C           P2YJSX    OREQ 'S'
      * WW Manifest Detail     EF - Manifest Detail  * 
     C                     CALL 'PDMYEFR'              90  WW Manifest Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0049  30       Company Number
     C                     PARM #1C4NB    WQ0050  70       Order Number
     C                     PARM #1DPNB    WQ0051  30       Order Sequence
     C                     PARM #1UENB    WQ0052  30       Order Secondary
     C                     PARM #1HGCD    WQ0053  70       Item Code
     C                     PARM #1AJCD    WQ0054  3        Warehouse Code
     C                     PARM #CI3NY    WQ0055  50       HPB COA Batch N
     C                     PARM #1G7NA    WQ0056 30        Order Desc_Line
     C                     PARM #1CCQT    WQ0057 112       Quantity Schedu
     C                     PARM #1AUWG    WQ0058 112       Weight Schedule
     C           P1FYQT    PARM P1FYQT    WQ0059  50       USR Case Quanti
     C           P1ZPNB    PARM P1ZPNB    WQ0060 112       USR Case Weight
     C                     PARM #2BKC7    WQ0061  70       Ship To Custome
     C                     PARM #CBRTX    WQ0062 30        Ship To Name
     C                     PARM #PBCNA    WQ0063 15        Customer Purcha
     C                     PARM #2RMNB    WQ0064  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9834  *
     C                     END
     C                     END                             *FI
      * FP1322 HPB Processing only
      * CASE: PAR.Company Organization is High Plains Biodiesel
     C           P2YJSX    IFEQ 'H'                        *IF
      * HPB Only - Loadout temp required  - if warehouse loc is Internal
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.WHS Req Meter Reading Shp is Yes
      *   |- c2    : LCL.Warehouse Location is Internal (Plant)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0003    IFEQ 'Y'                        *IF
     C           YL0005    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD#CJENY    YL0012           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD30        WL0012           RFS API Gravity
     C                     Z-ADDYL0012    WL0013           RFS Loadout Tem
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    WUSUNY           RFS API Vol Cor
      * CASE: WRK.RFS API Vol Corr Factor is Not Found
     C           WUSUNY    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#CJENY    ZA0012           COA Temperature
      * Send message 'COA Temp Loadout invalid'
     C                     MOVEL'USR3925' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     GOTO DCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Prod Temp-HPB     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0039           Load ID
     C                     Z-ADD#CJENY    WL0040           Product Tempera
     C                     MOVEL#CXCCD    WL0041    P      Carrier Broker
     C                     EXSR STCHRC
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Warehouse Location is Internal (Plant)
     C           YL0005    IFEQ 'I'                        *IF
      * WW Manifest Detail     EF - Manifest Detail  * 
     C                     CALL 'PDMYEFR'              90  WW Manifest Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0065  30       Company Number
     C                     PARM #1C4NB    WQ0066  70       Order Number
     C                     PARM #1DPNB    WQ0067  30       Order Sequence
     C                     PARM #1UENB    WQ0068  30       Order Secondary
     C                     PARM #1HGCD    WQ0069  70       Item Code
     C                     PARM #1AJCD    WQ0070  3        Warehouse Code
     C                     PARM #CI3NY    WQ0071  50       HPB COA Batch N
     C                     PARM #1G7NA    WQ0072 30        Order Desc_Line
     C                     PARM #1CCQT    WQ0073 112       Quantity Schedu
     C                     PARM #1AUWG    WQ0074 112       Weight Schedule
     C           P1FYQT    PARM P1FYQT    WQ0075  50       USR Case Quanti
     C           P1ZPNB    PARM P1ZPNB    WQ0076 112       USR Case Weight
     C                     PARM #2BKC7    WQ0077  70       Ship To Custome
     C                     PARM #CBRTX    WQ0078 30        Ship To Name
     C                     PARM #PBCNA    WQ0079 15        Customer Purcha
     C                     PARM #2RMNB    WQ0080  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9834  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * User selects RIN to SEL from external warehouses
      * WW Manifest Detail-HPB EF - Manifest Detail  * 
     C                     CALL 'PNM9EFR'              90  WW Manifest Det
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0081  30       Company Number
     C                     PARM #1C4NB    WQ0082  70       Order Number
     C                     PARM #1DPNB    WQ0083  30       Order Sequence
     C                     PARM #1UENB    WQ0084  30       Order Secondary
     C                     PARM #1HGCD    WQ0085  70       Item Code
     C                     PARM #1AJCD    WQ0086  3        Warehouse Code
     C                     PARM #1G7NA    WQ0087 30        Order Desc_Line
     C                     PARM #1CCQT    WQ0088 112       Quantity Schedu
     C                     PARM #1AUWG    WQ0089 112       Weight Schedule
     C           P1FYQT    PARM P1FYQT    WQ0090  50       USR Case Quanti
     C           P1ZPNB    PARM P1ZPNB    WQ0091 112       USR Case Weight
     C                     PARM #CXCCD    WQ0092  3        Carrier Broker
     C           #CJENY    PARM #CJENY    WQ0093  30       COA Temperature
     C                     PARM #1BKC7    WQ0094  70       Ship To Custome
     C                     PARM #CBRTX    WQ0095 30        Ship To Name
     C                     PARM #PBCNA    WQ0096 15        Customer Purcha
     C                     PARM #2RMNB    WQ0097  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNM9EFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     983233*
     C                     END
      * RTV Prod Temp-HPB     RT - Load Header  * 
     C                     EXSR TDRVGN
      * RTV HPB fields         RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0005           Company Number
     C                     Z-ADD#2C4NB    WL0006           Order Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    #CI3NY           HPB COA Batch N
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       P1E6ST           USR Status (Y/N
     C                     END                             *FI
      * Delete Request
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Open Line Item
      * CASE: RCD.Detail Line Status is Open Types
     C           #1GMST    IFEQ 'L'                        *IF
     C           #1GMST    OREQ 'A'
     C           #1GMST    OREQ 'E'
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1SEL     ZA0013           *SFLSEL
      * Send message 'Can't Delete Confirmed'
     C                     MOVEL'USR1937' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9835  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Comments
      * CASE: RCD.*SFLSEL is Opt 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
      * EDT Detail Comments    EF - OP Order Detail Comment  * 
     C                     CALL 'PDDWEFR'              90  EDT Detail Comm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0098  30       Company Number
     C                     PARM #2C4NB    WQ0099  70       Order Number
     C                     PARM #1DPNB    WQ0100  30       Order Sequence
     C                     PARM #1UENB    WQ0101  30       Order Secondary
     C                     PARM #1HGCD    WQ0102  70       Item Code
     C                     PARM P4BRTX    WQ0103 30        Ship To Name
     C                     PARM #1A5DT    WQ0104  70       Requested Ship
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDWEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,35
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * Delete Request
      * CASE: RCD.*SFLSEL is *Delete request
     C           #1SEL     IFEQ '4'                        *IF
     C           #1SEL     OREQ ' 4'
      * Open Line Item
      * CASE: RCD.Detail Line Status is Open Types
     C           #1GMST    IFEQ 'L'                        *IF
     C           #1GMST    OREQ 'A'
     C           #1GMST    OREQ 'E'
      * RTV Delete NonConfirm  RT - Order Detail  * 
     C                     EXSR TERVGN
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P5I8ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P7Q1ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0003    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BGWKZL fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     Z-ADDOMAIC3    #1AIC3           Company Number
     C                     Z-ADDOMC4NB    #1C4NB           Order Number
     C                     Z-ADDOMAVQT    #1AVQT           Quantity Ordere
     C                     Z-ADDOMD0WG    #1D0WG           Weight Ordered
     C                     Z-ADDOMAKPR    #1AKPR           Unit Price
     C                     Z-ADDOMALPR    #1ALPR           Unit Price_Cred
     C                     Z-ADDOMAUPR    #1AUPR           Unit Price Orde
     C                     MOVELOMG7NA    #1G7NA           Order Desc_Line
     C                     MOVELOMG8NA    #1G8NA           Order Desc_Line
     C                     Z-ADDOMA5DT    #1A5DT           Requested Ship
     C                     MOVELOMCRCD    #1CRCD           U_M_Base Price
     C                     MOVELOMJPCD    #1JPCD           Event Code
     C                     MOVELOMZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDOMAODT    #1AODT           Scheduled Ship
     C                     MOVELOMZ3ST    #1Z3ST           Substituted Fla
     C                     MOVELOMZ4ST    #1Z4ST           OD Schedule Ove
     C                     Z-ADDOMDUPR    #1DUPR           Invoice Unit Pr
     C                     Z-ADDOMB6VL    #1B6VL           Invoice Extende
     C                     Z-ADDOMA1AA    #1A1AA           Ham Group Numbe
     C                     MOVELOMFZSX    #1FZSX           OD Adj Type Ove
     C                     MOVELOMF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELOMF1SX    #1F1SX           Affect Commissi
     C                     MOVELOMF2SX    #1F2SX           Affect Pricing
     C                     MOVELOMF3SX    #1F3SX           Released by Use
     C                     MOVELOMF4SX    #1F4SX           Ord TF Exempt C
     C                     MOVELOMF5SX    #1F5SX           OD Pallet Type
     C                     MOVELOMF6SX    #1F6SX           Production Ware
     C                     MOVELOMF7SX    #1F7SX           OD Price Type
     C                     Z-ADDOMNTDT    #1NTDT           Warehouse Palle
     C                     Z-ADDOMNUDT    #1NUDT           Consumed Item C
     C                     Z-ADDOMNVDT    #1NVDT           Deadline Depart
     C                     Z-ADDOMNWDT    #1NWDT           OD Price Type R
     C                     Z-ADDOMNXDT    #1NXDT           OD Firm Date
     C                     Z-ADDOMBUTM    #1BUTM           Deadline Depart
     C                     Z-ADDOMBVTM    #1BVTM           Price Code
     C                     Z-ADDOMBWTM    #1BWTM           Maximum Net Wei
     C                     Z-ADDOMBXTM    #1BXTM           Substitution Li
     C                     Z-ADDOMBYTM    #1BYTM           Max Qty to sche
     C                     Z-ADDOMH5NX    #1H5NX           Warehouse Palle
     C                     Z-ADDOMH6NX    #1H6NX           Warehouse Avg P
     C                     Z-ADDOMH7NX    #1H7NX           OD Item Target
     C                     Z-ADDOMH8NX    #1H8NX           OD Estimated Gr
     C                     Z-ADDOMH9NX    #1H9NX           OD Maximum Unit
     C                     Z-ADDOMDVPR    #1DVPR           Order Gate_Fina
     C                     Z-ADDOMDWPR    #1DWPR           OD Ceiling Pric
     C                     Z-ADDOMDXPR    #1DXPR           OD Gate_Final P
     C                     Z-ADDOMDYPR    #1DYPR           OD Weighted Avg
     C                     Z-ADDOMDZPR    #1DZPR           OD Original Ord
     C                     Z-ADDOMGSPR    #1GSPR           OD Cancel Date
     C                     Z-ADDOMGTPR    #1GTPR           OD Unused Prc 7
     C                     Z-ADDOMGUPR    #1GUPR           OD Unused Prc 8
     C                     MOVELOMHOST    #1HOST           OD MPR Sent to
     C                     MOVELOMHPST    #1HPST           OD MPR Prc Read
     C                     MOVELOMIOST    #1IOST           OD UnUsed Price
     C                     Z-ADDOMPEWG    #1PEWG           Weight Amount E
     C                     Z-ADDOMRINY    #1RINY           Item Age Days
     C                     Z-ADDOMTIDT    #1TIDT           Production Ovr
     C                     Z-ADDOMTJDT    #1TJDT           Production Ovr
     C                     MOVELOMH2ST    #1H2ST           OD Spot Buy
     C                     MOVELOMH0ST    #1H0ST           OD Clm Full Ret
     C                     MOVELOMH1ST    #1H1ST           Order Line Erro
     C                     Z-ADDOMTKDT    #1TKDT           OD Market Begin
     C                     Z-ADDOMTLDT    #1TLDT           OD Market Endin
     C                     Z-ADDOMTMDT    #1TMDT           OD Atch to Ord
     C                     MOVELOMUVST    #1UVST           EDI Status 1
     C                     MOVELOMUWST    #1UWST           EDI Status 2
     C                     MOVELOMUXST    #1UXST           EDI Status 3
     C                     Z-ADDOMAGCS    #1AGCS           Unit Cost Per P
     C                     Z-ADDOMAQCS    #1AQCS           Unit Cost Prici
     C                     Z-ADDOMAVWG    #1AVWG           Unit Weight Ord
     C                     MOVELOMCQCD    #1CQCD           Reason Code
     C                     MOVELOMHICD    #1HICD           Quality Level
     C                     MOVELOMRNCD    #1RNCD           Pricing Product
     C                     MOVELOMROCD    #1ROCD           Season Product
     C                     Z-ADDOMCXDT    #1CXDT           Date of Origina
     C                     MOVELOMRBCD    #1RBCD           Item Level
     C                     Z-ADDOMAYVA    #1AYVA           Extended Amount
     C                     MOVELOMAMST    #1AMST           Affect Inventor
     C                     MOVELOMANST    #1ANST           Affect Sales Do
     C                     MOVELOMVAST    #1VAST           Affect Sales Pn
     C                     Z-ADDOML6NB    #1L6NB           Contract Number
     C                     Z-ADDOMCBQT    #1CBQT           Quantity Shippe
     C                     Z-ADDOMATWG    #1ATWG           Weight Shipped
     C                     Z-ADDOMCCQT    #1CCQT           Quantity Schedu
     C                     Z-ADDOMAUWG    #1AUWG           Weight Schedule
     C                     Z-ADDOMBKC7    #1BKC7           Ship To Custome
     C                     Z-ADDOMCFC7    #1CFC7           Order Group Cod
     C                     MOVELOMGMST    #1GMST           Detail Line Sta
     C                     MOVELOMGNST    #1GNST           Detail Line Sta
     C                     MOVELOMR4CD    #1R4CD           Sales Route Cod
     C                     MOVELOMGTST    #1GTST           Comment Print A
     C                     MOVELOMGVST    #1GVST           Comment Print I
     C                     MOVELOMGUST    #1GUST           Comment Print P
     C                     MOVELOMQFST    #1QFST           Comment Print S
     C                     MOVELOMKXCD    #1KXCD           Country Code
     C                     Z-ADDOMR1NB    #1R1NB           Rated Freight
     C                     Z-ADDOMRGNB    #1RGNB           Item Structure
     C                     Z-ADDOMRHNB    #1RHNB           Item Structure
     C                     Z-ADDOMRINB    #1RINB           Item Structure
     C                     Z-ADDOMGIDT    #1GIDT           Pricing Date Us
     C                     Z-ADDOMGNDT    #1GNDT           Actual Shipped
     C                     MOVELOMRZST    #1RZST           Work Confirm St
     C                     MOVELOMR0ST    #1R0ST           Work Over_Short
     C                     MOVELOMR1ST    #1R1ST           OD Production P
     C                     Z-ADDOMEXDT    #1EXDT           Market Pricing
     C                     Z-ADDOMBZPR    #1BZPR           Price Overage O
     C                     MOVELOMU1ST    #1U1ST           Price Status
     C                     MOVELOMU0ST    #1U0ST           Price Audit
     C                     MOVELOMRFCD    #1RFCD           Price Audit Rea
     C                     MOVELOMFZST    #1FZST           Production Date
     C                     MOVELOMRPCD    #1RPCD           Age Code
     C                     MOVELOMVEST    #1VEST           Palletize
     C                     Z-ADDOMMAVA    #1MAVA           Billing Detail
     C                     Z-ADDOMKDVA    #1KDVA           Billing Detail
     C                     MOVELOMAJVN    #1AJVN           User Profile Na
     C                     MOVELOMVGST    #1VGST           Slip Sheet
     C                     Z-ADDOML8VA    #1L8VA           Billing Detail
     C                     Z-ADDOML9VA    #1L9VA           Quantity to Sub
     C                     Z-ADDOMA4WG    #1A4WG           Tare Weight Tot
     C                     MOVELOMRDCD    #1RDCD           Date Method Cod
     C                     MOVELOMQ7CD    #1Q7CD           Price Method Co
     C                     MOVELOMLQCD    #1LQCD           Commodity Marke
     C                     Z-ADDOMAATM    #1AATM           Job Time
     C                     MOVELOMAYNA    #1AYNA           User Id
     C                     MOVELOMA0NA    #1A0NA           Job Name
     C                     Z-ADDOMAXDT    #1AXDT           Job Date
     C                     MOVELOMAGCD    #1AGCD           U_M_Ordered
     C                     Z-ADDOMHGCD    #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
     C                     MOVELOMAJCD    #1AJCD           Warehouse Code
     C                     MOVELOMAVST    #1AVST           Catch Weight St
     C                     Z-ADDOMDPNB    #1DPNB           Order Sequence
     C                     Z-ADDOMUENB    #1UENB           Order Secondary
     C                     Z-ADD*ZERO     #RC6QT           USR Quantity to
     C                     MOVEL*BLANK    #RIFST           Allow Weight In
     C                     MOVEL*BLANK    #RIHST           Allow Quantity
     C                     MOVEL*BLANK    #RKMST           USR Warehouse S
     C                     MOVEL*BLANK    #RORST           USR Allow Alloc
     C                     MOVEL*BLANK    #RIGST           USR Detail Conf
     C                     MOVEL*BLANK    #RH4ST           Select Detail F
     C                     MOVEL*BLANK    #RVHST           Lot Tracking Fl
     C                     MOVEL*BLANK    #RENTX           USR Confirm Sta
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RC0QT           USR Quantity Co
     C                     Z-ADD*ZERO     #RA7WG           USR Weight Conf
     C                     MOVEL*BLANK    #REOTX           USR Line Status
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVELP4GYST    #PGYST           Order Type Prin
     C                     MOVEL*BLANK    #CEPTX           USR Order Statu
     C                     Z-ADDP4A0DT    #PA0DT           Order Date
     C                     MOVEL*BLANK    #2XIST           Credit Hold
     C                     MOVEL*BLANK    #2XJST           Production Hold
     C                     MOVEL*BLANK    #2GWST           Header Status
     C                     MOVELP4JNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDP4RMNB    #2RMNB           Load ID
     C                     MOVEL*BLANK    #2HNNA           Ship To City
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
     C                     Z-ADD*ZERO     #2AFTM           Requested Deliv
     C                     MOVEL*BLANK    #2GJST           Order in Use
     C                     MOVEL*BLANK    #CM2CD           USR Shipping Ro
     C                     Z-ADDP4JZVA    #PJZVA           Order Value Tot
     C                     Z-ADDP3AIC3    #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADDP3C4NB    #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVELP4U2ST    #2U2ST           Export Status
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     MOVEL*BLANK    #CBRTX           Ship To Name
     C                     Z-ADDP4A1WG    #PA1WG           Order Weight To
     C                     MOVELP4B6NA    #PB6NA           Special Instruc
     C                     MOVELP4BYNA    #PBYNA           Special Instruc
     C                     MOVEL*BLANK    #2AJCD           Warehouse Code
     C                     MOVELP4BZNA    #PBZNA           Carrier Code
     C                     MOVEL*BLANK    #CXCCD           Carrier Broker
     C                     Z-ADD*ZERO     #CJENY           COA Temperature
     C                     MOVELP4BCNA    #PBCNA           Customer Purcha
     C                     Z-ADD*ZERO     #2GNDT           Actual Shipped
      * Clear external version also
     C                     Z-ADD*ZERO     V2GNDT
     C                     Z-ADD*ZERO     #CI3NY           COA Batch Numbe
     C                     Z-ADDP4RNNB    #PRNNB           Reefer Temperat
     C                     MOVEL*BLANK    #CFRSX           Shipping Temp C
     C                     MOVELP4VFST    #PVFST           Shrink Wrap
     C                     MOVELP4VEST    #2VEST           Palletize
     C                     MOVELP4VGST    #2VGST           Slip Sheet
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Actual Shipped Date to display format
      * Convert date
     C           1000000   ADD  #2GNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2GNDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Ship Header        RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDP3AIC3    BEAIC3           Company Number
     C                     Z-ADDP3C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEJNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDBEBKC7    #2BKC7           Ship To Custome
     C                     MOVELBEBRTX    #CBRTX           Ship To Name
     C                     MOVELBEBCNA    #PBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    P4A0DT           Order Date
     C                     Z-ADDBEA5DT    P4A5DT           Requested Ship
     C                     MOVELBEB6NA    #PB6NA           Special Instruc
     C                     MOVELBEBYNA    #PBYNA           Special Instruc
     C                     MOVELBEBZNA    #PBZNA           Carrier Code
     C                     MOVELBEGYST    #PGYST           Order Type Prin
     C                     Z-ADDBEAODT    P4AODT           Scheduled Ship
     C                     Z-ADDBEJZVA    #PJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #PA1WG           Order Weight To
     C                     Z-ADDBERMNB    #2RMNB           Load ID
     C                     MOVELBEU2ST    #2U2ST           Export Status
     C                     MOVELBEVEST    #2VEST           Palletize
     C                     MOVELBEVFST    #PVFST           Shrink Wrap
     C                     MOVELBEVGST    #2VGST           Slip Sheet
     C                     Z-ADDBERNNB    #PRNNB           Reefer Temperat
     C                     MOVELBEOBST    P4OBST           Billing Activit
     C                     MOVELBEFOSX    P4FOSX           Email Cust On O
     C                     MOVELBEFPSX    P4FPSX           Order Emailed
     C                     MOVELBEFRSX    #CFRSX           Shipping Temp C
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Check Ship Confirm RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUE6ST           USR Status (Y/N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSB02           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSB01           Company Number
     C                     Z-ADD#2C4NB    WQSB02           Order Number
      * Establish starting position
     C           KRSSB     SETLL@BGWKL1                    *
     C           KRSSB     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUE6ST           USR Status (Y/N
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Work Confirm Status is Open
     C           WARZST    IFEQ *BLANK                     *IF
      * CASE: DB1.Detail Line Status is Not closed or cancelled
     C           WAGMST    IFEQ 'L'                        *IF
     C           WAGMST    OREQ 'A'
     C           WAGMST    OREQ 'R'
     C           WAGMST    OREQ 'E'
     C           WAGMST    OREQ 'H'
     C                     MOVEL'N'       WUE6ST           USR Status (Y/N
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Deadln DepartDT/TM RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJRMNB    WQSC02           Load ID
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC02           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WQSC02           Load ID
      * Establish starting position
     C           KRSSC     SETLL@FJCPSB                    *
     C           KRSSC     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           Deadline Depart
     C                     Z-ADD*ZERO     YL0002           Deadline Depart
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJKZDT    YL0001           Deadline Depart
     C                     Z-ADDFJAXTM    YL0002           Deadline Depart
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv HPB fields        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Production Ware
     C                     MOVEL*BLANK    WL0003           Warehouse Locat
     C                     MOVEL*BLANK    WL0004           WHS Req Meter R
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAOCD    WL0002           Production Ware
     C                     MOVELADT0ST    WL0003           Warehouse Locat
     C                     MOVELADRTSX    WL0004           WHS Req Meter R
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV HPB-temp,CarrBrk  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBPRTM    WUPRTM           Product Tempera
     C                     MOVELWBXCCD    #CXCCD           Carrier Broker
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV HPB fields         RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0005    AMAIC3           Company Number
     C                     Z-ADDWL0006    AMC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0007           HPB COA Batch N
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAMITNY    WL0007           HPB COA Batch N
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0008    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0009           Accounting Comp
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    WL0009           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Get Open Batch    RT - COA Batch Header  * get open batch
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0006           COA Batch Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN CCAIC3    WQSH01           Company Number
     C           *LIKE     DEFN CCIKAA    WQSH02           COA Active Whse
     C           *LIKE     DEFN CCHXTX    WQSH03           COA Batch Heade
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           COA Active Whse
     C                     KFLD           WQSH03           COA Batch Heade
      * Setup key
     C                     Z-ADDYL0007    WQSH01           Company Number
     C                     MOVELYL0004    WQSH02           COA Active Whse
     C                     MOVEL'O'       WQSH03           COA Batch Heade
      * Establish starting position
     C           KRSSH     SETLL@CCCPPD                    *
     C           KRSSH     READE@CCCPPD                  90*
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDCCI3NY    YL0006           COA Batch Numbe
      * There should only ever be one record found, but quit just in case
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@CCCPPD                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0010    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSI     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0011           Lot Tracking Fl
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADVHST    WL0011           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Item Alloc Qty    RT - PD Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #RC0QT           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     #RA7WG           OIA Alloc_Shipp
      * Declare restrictor key work fields
     C           *LIKE     DEFN L8AIC3    WQSJ01           Company Number
     C           *LIKE     DEFN L8C4NB    WQSJ02           Order Number
     C           *LIKE     DEFN L8DPNB    WQSJ03           Order Sequence
     C           *LIKE     DEFN L8UENB    WQSJ04           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WQSJ03           Order Sequence
     C                     KFLD           WQSJ04           Order Secondary
      * Setup key
     C                     Z-ADD#1AIC3    WQSJ01           Company Number
     C                     Z-ADD#1C4NB    WQSJ02           Order Number
     C                     Z-ADD#1DPNB    WQSJ03           Order Sequence
     C                     Z-ADD#1UENB    WQSJ04           Order Secondary
      * Establish starting position
     C           KRSSJ     SETLL@L8CPSY                    *
     C           KRSSJ     READE@L8CPSY                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  L8J6QT    #RC0QT           OIA Alloc_Shipp
     C                     ADD  L8G9WG    #RA7WG           OIA Alloc_Shipp
     C           KRSSJ     READE@L8CPSY                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Chk for Batch Opn RT - COA Batch Header  * get open batch
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           COA Active Whse
     C                     MOVEL*BLANK    YL0011           COA Batch Heade
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WCI3NY    WQSK02           COA Batch Numbe
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           COA Batch Numbe
      * Setup key
     C                     Z-ADDYL0007    WQSK01           Company Number
     C                     Z-ADD#CI3NY    WQSK02           COA Batch Numbe
      * Establish starting position
     C           KRSSK     SETLL@CCCPDJ                    *
     C           KRSSK     READE@CCCPDJ                  90*
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCIKAA    YL0010           COA Active Whse
     C                     MOVELWCHXTX    YL0011           COA Batch Heade
      * There should only ever be one record found, but quit just in case
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@CCCPDJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Val Carrier Active     RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL#CXCCD    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSL     CHAIN@FFREUG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse      RT - OM Shipping Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADDP3AIC3    WQSM01           Company Number
     C                     Z-ADDP3C4NB    WQSM02           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
      * Establish starting position
     C           KPSSM     SETLL@BGWKAE                    *
     C           KRSSM     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #2AJCD           Warehouse Code
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SNRVGN
      * PAR = DB1 By name
     C                     MOVELWDAJCD    #2AJCD           Warehouse Code
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWDAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    WUXUST           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           GJSSNY           RFS API Gravity
     C                     KFLD           GJSTNY           RFS Loadout Tem
      * Setup key
     C                     Z-ADDWL0012    GJSSNY           RFS API Gravity
     C                     Z-ADDWL0013    GJSTNY           RFS Loadout Tem
      * Establish starting position
     C           KRSSO     CHAIN@GJREHH              90    *
      * Data record not found
     C   90                MOVEL'USR4345' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDGJSUNY    WL0014           RFS API Vol Cor
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV HPB Recalc Nt/Upd RT - Manifest Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        RFS Volume Corr
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
     C                     Z-ADD*ZERO     YL0013           Order Sequence
     C                     Z-ADD0         YL0014           Order Secondary
     C                     MOVEL'A'       WN0001           RFS Volume Corr
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSP01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSP02           Order Number
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WQSP01           Company Number
     C                     Z-ADD#2C4NB    WQSP02           Order Number
     C                     Z-ADD1         FNDPNB           Order Sequence
     C                     Z-ADD1         FNUENB           Order Secondary
      * Establish starting position
     C           KPSSP     SETLL@FNCPCT                    *
     C           KRSSP     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Order Detail at Seq Level Break
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Order Sequence Number NE LCL.Order Sequence Numb
      *   |- c2    : DB1.Order Secondary Line Seq NE LCL.Order Secondary
      *   '-
     C           FNDPNB    IFNE YL0013                     *IF
     C           FNUENB    ORNE YL0014                     *OR
      * CASE: LCL.Order Sequence Number is not equal to zero
     C           YL0013    IFNE 0                          *IF
      * CHG ORDER DETAIL NET WEIGHT AND QTY -->WEIGHT SHIPPED AND QTY SHI
     C                     Z-ADD*ZERO     WURZNB           Case Sequence N
      * RTV Total Confirmed    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFNAIC3    WL0015           Company Number
     C                     Z-ADDFNC4NB    WL0016           Order Number
     C                     Z-ADDYL0013    WL0017           Order Sequence
     C                     Z-ADDYL0014    WL0018           Order Secondary
     C                     Z-ADDWURZNB    WL0019           Case Sequence N
     C                     Z-ADDWUFYQT    WL0020           USR Case Quanti
     C                     Z-ADDWUZPNB    WL0021           USR Case Weight
     C                     Z-ADDYL0015    WL0022           HPB Meter Net G
     C                     Z-ADDYL0016    WL0023           HPB Meter Net W
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WUFYQT           USR Case Quanti
     C                     Z-ADDWL0021    WUZPNB           USR Case Weight
     C                     Z-ADDWL0022    YL0015           HPB Meter Net G
     C                     Z-ADDWL0023    YL0016           HPB Meter Net W
      * Rtv Chg Ship Qty      RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFNAIC3    WL0024           Company Number
     C                     Z-ADDFNC4NB    WL0025           Order Number
     C                     Z-ADDYL0013    WL0026           Order Sequence
     C                     Z-ADDYL0014    WL0027           Order Secondary
     C                     Z-ADDYL0015    WL0028           Quantity Shippe
     C                     Z-ADDYL0016    WL0029           Weight Shipped
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     Z-ADDFNDPNB    YL0013           Order Sequence
     C                     Z-ADDFNUENB    YL0014           Order Secondary
     C                     END                             *FI
      * CHG Prod Temp-HPB     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2RMNB    WL0039           Load ID
     C                     Z-ADD#CJENY    WL0040           Product Tempera
     C                     MOVEL#CXCCD    WL0041    P      Carrier Broker
     C                     EXSR STCHRC
      * RTV HPB fields         RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0005           Company Number
     C                     Z-ADD#2C4NB    WL0006           Order Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    YL0017           HPB COA Batch N
      * CASE: LCL.HPB COA Batch Number NE PAR.COA Batch Number
     C           YL0017    IFNE #CI3NY                     *IF
      * CHG HPB Batch only    CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0042           Company Number
     C                     Z-ADD#2C4NB    WL0043           Order Number
     C                     Z-ADD#CI3NY    WL0044           HPB COA Batch N
     C                     EXSR SUCHRC
     C                     END                             *FI
      * Net Gallons = Meter Total Gallon * (-.000436 * (Loadout Temp-60F)
      * R6965 RMC New hpb plant 8/22/16
      * Rtv HPB fields        RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELFNAJCD    WL0001    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0018    P      Production Ware
     C                     MOVELWL0003    YL0019    P      Warehouse Locat
     C                     MOVELWL0004    YL0020    P      WHS Req Meter R
      * Rtv Acct Co          RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0018    WL0008    P      Warehouse Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0021           Accounting Comp
      * Rtv FuelCd,Dnst f/bt  RT - COA Batch Header  * 
     C                     EXSR SVRVGN
      * RTV Temp Reference    RT - COA Property Define Hdr  * 
     C                     EXSR SWRVGN
      * New formula - after 6/27/10 -  goes in with RFS2/EMTS    P000579
      * CASE: PAR.RFS Volume Corr Mthd  USR is Calculate factor per Prop
     C           WN0001    IFEQ 'C'                        *IF
     C                     Z-ADD-.00045767WUJQNY           COA Temp Conv F
     C                     Z-ADD1.02746025WUJRNY           COA Temp Conv F
      * Compute: temp adj
      * WRK.HPB Temperature Adjustmnt =
      *    *COMPUTE ((x2 * x3 +x4)*x5)
      * x2    : WRK.COA Temp Conv Factor 1
      * *     : PGM.*Synon (17,9) work field *Rounded
      * x3    : PAR.COA Temperature Loadout
      * +     : PGM.*Synon (17,9) work field
      * x4    : WRK.COA Temp Conv Factor 2
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x5    : CON.1
     C           WUJQNY    MULT #CJENY    W0WE02           *Synon (17,9) w
     C           W0WE02    ADD  WUJRNY    W0WE01           *Synon (17,9) w
     C           W0WE01    MULT 1         W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUJSNY           HPB Temperature
     C                     ELSE
      * CASE: PAR.RFS Volume Corr Mthd  USR is API Volume Corr Table
     C           WN0001    IFEQ 'A'                        *IF
     C                     Z-ADD#CJENY    YL0025           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD30        WL0012           RFS API Gravity
     C                     Z-ADDYL0025    WL0013           RFS Loadout Tem
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    YL0026           RFS API Vol Cor
     C                     Z-ADDYL0026    WUJSNY           HPB Temperature
     C                     END                             *FI
     C                     END                             *FI
      * Compute: Net gallons
      * WRK.Quantity 7.0 USR =
      *    *COMPUTE (x1* x2)
      * x1    : DB1.HPB Meter Total Gallon
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : WRK.HPB Temperature Adjustmnt
     C           FNIWNY    MULT WUJSNY    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUTQTC           Quantity 7.0 US
     C                     Z-ADDWUTQTC    YL0015           HPB Meter Net G
      * Compute: density ref NEW
      * WRK.COA Density Ref Adj 4 dec =
      *    *COMPUTE (x1 * x5)
      * x1    : WRK.HPB Temperature Adjustmnt
      * *     : PGM.*Synon (17,5) work field *Rounded
      * x5    : LCL.COA Density Loadout
     C           WUJSNY    MULT YL0023    W0WC00    H      *Synon (17,5) w
     C                     Z-ADDW0WC00    WULRNY           COA Density Ref
     C                     Z-ADDWULRNY    YL0027           HPB Density Ref
      * Calc Net weight from density loadout and other factor
      * Compute: Net Fuel Weight
      * LCL.HPB Meter Net Weight =
      *    *COMPUTE (x1*x2*x3)
      * x1    : LCL.HPB Meter Net Gallon
      * *     : PGM.*Synon (17,7) work field *
      * x2    : LCL.COA Density Loadout
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.8.33
     C           YL0015    MULT YL0023    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 8.33      W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0016           HPB Meter Net W
      * CHG Manifest for HPB  CH - Manifest Detail  * 
     C                     EXSR SXCHRC
     C           KRSSP     READE@FNCPCT                  90*
     C                     ENDDO
      * USER: Exit processing
      * LAst record
      * CASE: LCL.Order Sequence Number is not equal to zero
     C           YL0013    IFNE 0                          *IF
      * RTV Total Confirmed    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFNAIC3    WL0015           Company Number
     C                     Z-ADDFNC4NB    WL0016           Order Number
     C                     Z-ADDYL0013    WL0017           Order Sequence
     C                     Z-ADDYL0014    WL0018           Order Secondary
     C                     Z-ADD*ZERO     WL0019           Case Sequence N
     C                     Z-ADDWUFYQT    WL0020           USR Case Quanti
     C                     Z-ADDWUZPNB    WL0021           USR Case Weight
     C                     Z-ADDYL0015    WL0022           HPB Meter Net G
     C                     Z-ADDYL0016    WL0023           HPB Meter Net W
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WUFYQT           USR Case Quanti
     C                     Z-ADDWL0021    WUZPNB           USR Case Weight
     C                     Z-ADDWL0022    YL0015           HPB Meter Net G
     C                     Z-ADDWL0023    YL0016           HPB Meter Net W
      * Rtv Chg Ship Qty      RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFNAIC3    WL0024           Company Number
     C                     Z-ADDFNC4NB    WL0025           Order Number
     C                     Z-ADDYL0013    WL0026           Order Sequence
     C                     Z-ADDYL0014    WL0027           Order Secondary
     C                     Z-ADDYL0015    WL0028           Quantity Shippe
     C                     Z-ADDYL0016    WL0029           Weight Shipped
     C                     EXSR SRRVGN
     C                     END                             *FI
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Total Confirmed    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0020           USR Case Quanti
     C                     Z-ADD*ZERO     WL0021           USR Case Weight
     C                     Z-ADD*ZERO     WL0022           HPB Meter Net G
     C                     Z-ADD*ZERO     WL0023           HPB Meter Net W
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSQ02           Order Number
     C           *LIKE     DEFN FNDPNB    WQSQ03           Order Sequence
     C           *LIKE     DEFN FNUENB    WQSQ04           Order Secondary
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
     C                     KFLD           WQSQ03           Order Sequence
     C                     KFLD           WQSQ04           Order Secondary
     C                     KFLD           FNRZNB           Case Sequence N
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
     C                     KFLD           WQSQ03           Order Sequence
     C                     KFLD           WQSQ04           Order Secondary
      * Setup key
     C                     Z-ADDWL0015    WQSQ01           Company Number
     C                     Z-ADDWL0016    WQSQ02           Order Number
     C                     Z-ADDWL0017    WQSQ03           Order Sequence
     C                     Z-ADDWL0018    WQSQ04           Order Secondary
     C                     Z-ADDWL0019    FNRZNB           Case Sequence N
      * Establish starting position
     C           KPSSQ     SETLL@FNCPCT                    *
     C           KRSSQ     READE@FNCPCT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  FNFOQT    WL0020           USR Case Quanti
     C                     ADD  FNR0NB    WL0021           USR Case Weight
      * Only HPB will have these   4/14/08
     C                     ADD  FNN6WG    WL0022           HPB Meter Net G
     C                     ADD  FNIXNY    WL0023           HPB Meter Net W
     C           KRSSQ     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Chg Ship Qty      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0024    WAAIC3           Company Number
     C                     Z-ADDWL0025    WAC4NB           Order Number
     C                     Z-ADDWL0026    WADPNB           Order Sequence
     C                     Z-ADDWL0027    WAUENB           Order Secondary
      * Establish starting position
     C           KRSSR     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity Scheduled LT PAR.Quantity Shipped Total
     C           WACCQT    IFLT WL0028                     *IF
      * Work Over/Short Flag as Overage
      * Chg Ship Qty & Weight  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0030           Company Number
     C                     Z-ADDWAC4NB    WL0031           Order Number
     C                     Z-ADDWADPNB    WL0032           Order Sequence
     C                     Z-ADDWAUENB    WL0033           Order Secondary
     C                     MOVEL'P'       WL0034    P      Work Confirm St
     C                     MOVEL'O'       WL0035    P      Work Over_Short
     C                     Z-ADDWL0028    WL0036           Quantity Shippe
     C                     Z-ADDWL0029    WL0037           Weight Shipped
     C                     Z-ADDWAGNDT    WL0038           Actual Shipped
     C                     EXSR SSCHRC
     C                     ELSE
      * CASE: DB1.Quantity Scheduled GT PAR.Quantity Shipped Total
     C           WACCQT    IFGT WL0028                     *IF
      * Work Over/Short Flag as Short
      * Chg Ship Qty & Weight  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0030           Company Number
     C                     Z-ADDWAC4NB    WL0031           Order Number
     C                     Z-ADDWADPNB    WL0032           Order Sequence
     C                     Z-ADDWAUENB    WL0033           Order Secondary
     C                     MOVEL'P'       WL0034    P      Work Confirm St
     C                     MOVEL'S'       WL0035    P      Work Over_Short
     C                     Z-ADDWL0028    WL0036           Quantity Shippe
     C                     Z-ADDWL0029    WL0037           Weight Shipped
     C                     Z-ADDWAGNDT    WL0038           Actual Shipped
     C                     EXSR SSCHRC
     C                     ELSE
      * CASE: DB1.Quantity Scheduled EQ PAR.Quantity Shipped Total
     C           WACCQT    IFEQ WL0028                     *IF
      * Work Over/Short Flag as Blank
      * Chg Ship Qty & Weight  CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0030           Company Number
     C                     Z-ADDWAC4NB    WL0031           Order Number
     C                     Z-ADDWADPNB    WL0032           Order Sequence
     C                     Z-ADDWAUENB    WL0033           Order Secondary
     C                     MOVEL'P'       WL0034    P      Work Confirm St
     C                     MOVEL*BLANK    WL0035           Work Over_Short
     C                     Z-ADDWL0028    WL0036           Quantity Shippe
     C                     Z-ADDWL0029    WL0037           Weight Shipped
     C                     Z-ADDWAGNDT    WL0038           Actual Shipped
     C                     EXSR SSCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Ship Qty & Weight  CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       Item Code
     C                     MOVEL*BLANK    WN0003  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0004  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0005  70       Order Group Cod
     C                     MOVEL*BLANK    WN0006  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0007  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0008 112       Billing Detail
     C                     Z-ADD*ZERO     WN0009 112       Billing Detail
     C                     Z-ADD*ZERO     WN0010 112       Billing Detail
     C                     Z-ADD*ZERO     WN0011 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0012  1        Comment Print A
     C                     MOVEL*BLANK    WN0013  1        Comment Print I
     C                     MOVEL*BLANK    WN0014  1        Comment Print P
     C                     MOVEL*BLANK    WN0015  1        Comment Print S
     C                     Z-ADD*ZERO     WN0016 112       Extended Amount
     C                     Z-ADD*ZERO     WN0017  70       Market Pricing
     C                     MOVEL*BLANK    WN0018  3        Commodity Marke
     C                     MOVEL*BLANK    WN0019  3        Date Method Cod
     C                     MOVEL*BLANK    WN0020  3        Price Method Co
     C                     Z-ADD*ZERO     WN0021 114       Price Overage O
     C                     Z-ADD*ZERO     WN0022  70       Contract Number
     C                     MOVEL*BLANK    WN0023  1        Price Status
     C                     Z-ADD*ZERO     WN0024  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0025  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0026  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0027  1        OD Production P
     C                     MOVEL*BLANK    WN0028 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0029 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0030  1        Age Code
     C                     MOVEL*BLANK    WN0031  1        Palletize
     C                     MOVEL*BLANK    WN0032  1        Slip Sheet
     C                     MOVEL*BLANK    WN0033  1        Catch Weight St
     C                     MOVEL*BLANK    WN0034  1        Price Audit
     C                     MOVEL*BLANK    WN0035  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0036  1        Production Date
     C                     Z-ADD*ZERO     WN0037 112       Rated Freight
     C                     Z-ADD*ZERO     WN0038 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0039 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0040 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0041 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0042 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0043 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0044 114       Unit Price
     C                     Z-ADD*ZERO     WN0045 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0046 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0047 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0048 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0049  70       Requested Ship
     C                     Z-ADD*ZERO     WN0050  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0051  1        Affect Inventor
     C                     MOVEL*BLANK    WN0052  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0053  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0054  30       Item Structure
     C                     Z-ADD*ZERO     WN0055  30       Item Structure
     C                     Z-ADD*ZERO     WN0056  30       Item Structure
     C                     MOVEL*BLANK    WN0057  2        Item Level
     C                     MOVEL*BLANK    WN0058  2        Quality Level
     C                     MOVEL*BLANK    WN0059  2        Pricing Product
     C                     MOVEL*BLANK    WN0060  2        Season Product
     C                     Z-ADD*ZERO     WN0061  70       Date of Origina
     C                     MOVEL*BLANK    WN0062 10        User Profile Na
     C                     MOVEL*BLANK    WN0063  6        Country Code
     C                     MOVEL*BLANK    WN0064  2        Event Code
     C                     MOVEL*BLANK    WN0065  3        Reason Code
     C                     MOVEL*BLANK    WN0066  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0067  1        Modified Flag
     C                     MOVEL*BLANK    WN0068  1        Substituted Fla
     C                     MOVEL*BLANK    WN0069  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0070 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0071 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0072  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0073  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0074  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0075  1        Affect Commissi
     C                     MOVEL*BLANK    WN0076  1        Affect Pricing
     C                     MOVEL*BLANK    WN0077  1        Released by Use
     C                     MOVEL*BLANK    WN0078  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0079  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0080  3        Production Ware
     C                     MOVEL*BLANK    WN0081  3        OD Price Type
     C                     Z-ADD*ZERO     WN0082  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0083  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0084  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0085  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0086  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0087  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0088  60       Price Code
     C                     Z-ADD*ZERO     WN0089  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0090  60       Substitution Li
     C                     Z-ADD*ZERO     WN0091  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0092 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0093 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0094 112       OD Item Target
     C                     Z-ADD*ZERO     WN0095 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0096 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0097 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0098 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0099 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0100 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0101 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0102 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0103 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0104 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0105  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0106  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0107  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0108 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0109  40       Item Age Days
     C                     Z-ADD*ZERO     WN0110  70       Production Ovr
     C                     Z-ADD*ZERO     WN0111  70       Production Ovr
     C                     MOVEL*BLANK    WN0112  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0113  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0114  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0115  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0116  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0117  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0118  1        EDI Status 1
     C                     MOVEL*BLANK    WN0119  1        EDI Status 2
     C                     MOVEL*BLANK    WN0120  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0121  60       Job Time
     C                     MOVEL*BLANK    WN0122 10        User Id
     C                     MOVEL*BLANK    WN0123 10        Job Name
     C                     Z-ADD*ZERO     WN0124  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0030    WEAIC3           Company Number
     C                     Z-ADDWL0031    WEC4NB           Order Number
     C                     Z-ADDWL0032    WEDPNB           Order Sequence
     C                     Z-ADDWL0033    WEUENB           Order Secondary
      *
     C           KLCHSS    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHSS    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0034    WERZST    P      Work Confirm St
     C                     MOVELWL0035    WER0ST    P      Work Over_Short
     C                     Z-ADDWL0036    WECBQT           Quantity Shippe
     C                     Z-ADDWL0037    WEATWG           Weight Shipped
     C                     Z-ADDWL0038    WEGNDT           Actual Shipped
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * CHG Prod Temp-HPB     CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0125  30       Company Number
     C                     Z-ADD*ZERO     WN0126  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0127  1        LTL Flag
     C                     MOVEL*BLANK    WN0128  1        Load Status
     C                     Z-ADD*ZERO     WN0129  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0130 15        Seal 1
     C                     MOVEL*BLANK    WN0131 15        Seal 2
     C                     MOVEL*BLANK    WN0132 15        Seal 3
     C                     MOVEL*BLANK    WN0133 15        Seal 4
     C                     MOVEL*BLANK    WN0134 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0135  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0136 112       Flat Amount
     C                     MOVEL*BLANK    WN0137  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0138  50       Total Stops
     C                     MOVEL*BLANK    WN0139 20        Trailer Id
     C                     MOVEL*BLANK    WN0140  3        Transloader Car
     C                     Z-ADD*ZERO     WN0141  40       BOL Time
     C                     MOVEL*BLANK    WN0142  3        Carrier Code
     C                     MOVEL*BLANK    WN0143  7        Truck Size
     C                     Z-ADD*ZERO     WN0144  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0145 112       Rated Freight
     C                     MOVEL*BLANK    WN0146  1        Ship Status
     C                     MOVEL*BLANK    WN0147  1        Load Type
     C                     Z-ADD*ZERO     WN0148  50       Number Pallets
     C                     Z-ADD*ZERO     WN0149  50       Number Pallets
     C                     Z-ADD*ZERO     WN0150 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0151  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0152  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0153  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0154 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0155 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0156  70       Actual Departur
     C                     Z-ADD*ZERO     WN0157  40       Departure Time
     C                     Z-ADD*ZERO     WN0158  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0159  50       Number Spacers
     C                     MOVEL*BLANK    WN0160 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0161  70       Total Load Mile
     C                     MOVEL*BLANK    WN0162 12        Recorder ID
     C                     MOVEL*BLANK    WN0163  2        Shipping Method
     C                     MOVEL*BLANK    WN0164  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0165  2        Ship To State C
     C                     Z-ADD*ZERO     WN0166  70       Gross Weight
     C                     MOVEL*BLANK    WN0167  1        Export Status
     C                     Z-ADD*ZERO     WN0168  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0169  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0170  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0171  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0172  70       Spotted Date
     C                     Z-ADD*ZERO     WN0173  60       Spotted Time
     C                     Z-ADD*ZERO     WN0174  70       Load Finished D
     C                     Z-ADD*ZERO     WN0175  60       Load Finished T
     C                     Z-ADD*ZERO     WN0176  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0177  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0178  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0179  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0180  70       Truck Departure
     C                     Z-ADD*ZERO     WN0181  60       Truck Departure
     C                     Z-ADD*ZERO     WN0182  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0183  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0184  3        Shipping Line
     C                     MOVEL*BLANK    WN0185 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0186 30        Vessel Name
     C                     Z-ADD*ZERO     WN0187  50       Voyage
     C                     Z-ADD*ZERO     WN0188  70       Sail Date
     C                     MOVEL*BLANK    WN0189 12        Booking Number
     C                     MOVEL*BLANK    WN0190 20        Discharge Port
     C                     Z-ADD*ZERO     WN0191  70       Arrival Date
     C                     MOVEL*BLANK    WN0192 12        Container Numbe
     C                     Z-ADD*ZERO     WN0193  70       Date In
     C                     Z-ADD*ZERO     WN0194  60       Time In
     C                     Z-ADD*ZERO     WN0195  70       Date Out
     C                     Z-ADD*ZERO     WN0196  60       Time Out
     C                     Z-ADD*ZERO     WN0197 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0198  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0199  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0200  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0201  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0202  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0203  70       Requested Deliv
     C                     MOVEL*BLANK    WN0204  1        Load Acceptance
     C                     MOVEL*BLANK    WN0205  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0206  70       On Yard Date
     C                     Z-ADD*ZERO     WN0207  60       On Yard Time
     C                     Z-ADD*ZERO     WN0208  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0209  60       Deadline Depart
     C                     MOVEL*BLANK    WN0210  1        Load Held Over
     C                     MOVEL*BLANK    WN0211  1        Load Held Over
     C                     MOVEL*BLANK    WN0212 15        Load Held Over
     C                     MOVEL*BLANK    WN0213 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0214 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0215  70       Express Mail Da
     C                     MOVEL*BLANK    WN0216  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0217  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0218  70       Product Complet
     C                     Z-ADD*ZERO     WN0219  60       Product Complet
     C                     Z-ADD*ZERO     WN0220  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0221  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0222  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0223  1        Load Confirmed
     C                     MOVEL*BLANK    WN0224 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0225  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0226  60       Load Door 1
     C                     Z-ADD*ZERO     WN0227  70       Override Total
     C                     Z-ADD*ZERO     WN0228  60       Load Door 2
     C                     MOVEL*BLANK    WN0229  1        Partial Load
     C                     MOVEL*BLANK    WN0230  1        Load Confirmati
     C                     MOVEL*BLANK    WN0231  1        Export Load USD
     C                     MOVEL*BLANK    WN0232  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0233 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0234 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0235 15        Late Billing Em
     C                     MOVEL*BLANK    WN0236 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0237 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0238  1        Multi Company L
     C                     MOVEL*BLANK    WN0239  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0240  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0241  1        LH Power Only L
     C                     MOVEL*BLANK    WN0242  1        MG Created Load
     C                     MOVEL*BLANK    WN0243  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0244  2        Load U_M
     C                     MOVEL*BLANK    WN0245  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0246  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0247  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0248  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0249  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0250  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0251  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0252  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0253  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0254  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0255  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0256  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0257  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0258  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0259  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0260  60       LH Unused Time
     C                     MOVEL*BLANK    WN0261  1        EDI Status 1
     C                     MOVEL*BLANK    WN0262  1        EDI Status 2
     C                     MOVEL*BLANK    WN0263  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0264  60       Job Time
     C                     MOVEL*BLANK    WN0265 10        User Id
     C                     MOVEL*BLANK    WN0266 10        Job Name
     C                     Z-ADD*ZERO     WN0267  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0039    WFRMNB           Load ID
      *
     C           KLCHST    KLIST
     C                     KFLD           WFRMNB           Load ID
     C           KLCHST    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0040    WFPRTM           Product Tempera
     C                     MOVELWL0041    WFXCCD    P      Carrier Broker
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG HPB Batch only    CH - Order Header Extension  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0268  70       Load ID
     C                     Z-ADD*ZERO     WN0269  50       Stop_Drop Seque
     C                     MOVEL*BLANK    WN0270  3        Shipping Line
     C                     MOVEL*BLANK    WN0271 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0272 25        OHE City
     C                     MOVEL*BLANK    WN0273 30        OHE Vessel_Airl
     C                     MOVEL*BLANK    WN0274 15        OHE Voyage_Flig
     C                     MOVEL*BLANK    WN0275 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0276 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0277  70       OHE Sail_Flight
     C                     Z-ADD*ZERO     WN0278  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0279  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0280  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0281  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0282 12        OHE Container N
     C                     MOVEL*BLANK    WN0283 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0284 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0285 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0286 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0287 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0288 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0289 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0290 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0291 112       Transload Termi
     C                     Z-ADD*ZERO     WN0292  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0293  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0294  70       OHE Port_Pier P
     C                     Z-ADD*ZERO     WN0295  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0296  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0297  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0298  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0299  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0300  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0301  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0302  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0303  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0304  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0305  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0306  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0307 38        Delivery P_O  N
     C                     MOVEL*BLANK    WN0308  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0309  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0310  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0311  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0312  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0313  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0314  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0315 10        OHE Transload S
     C                     MOVEL*BLANK    WN0316 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0317 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0318 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0319 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0320 15        OHE Transload C
     C                     MOVEL*BLANK    WN0321 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0322 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0323 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0324 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0325 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0326  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0327  30       LD Stop_Drop
     C                     Z-ADD*ZERO     WN0328  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0329  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0330  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0331  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0332  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0333  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0334  60       Original Appoin
     C                     Z-ADD*ZERO     WN0335  60       Original Appoin
     C                     Z-ADD*ZERO     WN0336  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0337  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0338  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0339  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0340 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0341  1        OHE Email BOL_S
     C                     MOVEL*BLANK    WN0342  1        OHE EDI Order A
     C                     MOVEL*BLANK    WN0343  2        OHE EDI 601 Act
     C                     MOVEL*BLANK    WN0344  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0345  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0346  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0347 15        OHE Customer Ve
     C                     MOVEL*BLANK    WN0348 15        OHE EDI 824 AES
     C                     MOVEL*BLANK    WN0349 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0350  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0351  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0352  1        EDI Status 1
     C                     MOVEL*BLANK    WN0353  1        EDI Status 2
     C                     MOVEL*BLANK    WN0354  1        EDI Status 3
     C                     MOVEL*BLANK    WN0355  1        Record Status
     C                     Z-ADD*ZERO     WN0356  60       Job Time
     C                     MOVEL*BLANK    WN0357 10        User Id
     C                     MOVEL*BLANK    WN0358 10        Job Name
     C                     Z-ADD*ZERO     WN0359  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWL0042    WGAIC3           Company Number
     C                     Z-ADDWL0043    WGC4NB           Order Number
      *
     C           KLCHSU    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C           KLCHSU    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YCRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWL0044    WGITNY           HPB COA Batch N
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     MOVEL##USR     WGAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv FuelCd,Dnst f/bt  RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WCI3NY    WQSV02           COA Batch Numbe
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           COA Batch Numbe
      * Setup key
     C                     Z-ADDYL0021    WQSV01           Company Number
     C                     Z-ADD#CI3NY    WQSV02           COA Batch Numbe
      * Establish starting position
     C           KRSSV     SETLL@CCCPDJ                    *
     C           KRSSV     READE@CCCPDJ                  90*
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCIDAA    YL0022           COA Bio-diesel
     C                     Z-ADDWCJCNY    YL0023           COA Density Loa
     C           KRSSV     READE@CCCPDJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Temp Reference    RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           CAAIC3           Company Number
     C                     KFLD           CAIDAA           COA Bio-diesel
      * Setup key
     C                     Z-ADDYL0021    CAAIC3           Company Number
     C                     MOVELYL0022    CAIDAA           COA Bio-diesel
      * Establish starting position
     C           KRSSW     CHAIN@CAREOB              90    *
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDCAJFNY    YL0024           COA Temperature
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * CHG Manifest for HPB  CH - Manifest Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0360  50       Case Quantity
     C                     Z-ADD*ZERO     WN0361 112       Case Weight
     C                     MOVEL*BLANK    WN0362  1        Inventory Updat
     C                     Z-ADD*ZERO     WN0363  70       Label Date
     C                     Z-ADD*ZERO     WN0364  80       PT Serial Numbe
     C                     Z-ADD*ZERO     WN0365  70       Item Code
     C                     MOVEL*BLANK    WN0366  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0367  70       Production Date
     C                     Z-ADD*ZERO     WN0368 112       Manifest Gross
     C                     MOVEL*BLANK    WN0369 10        Manifest Lot ID
     C                     Z-ADD*ZERO     WN0370  82       Manifest Total
     C                     Z-ADD*ZERO     WN0371  50       Manifest Co_Par
     C                     Z-ADD*ZERO     WN0372  90       Manifest Pallet
     C                     MOVEL*BLANK    WN0373  1        Manifest Shift
     C                     Z-ADD*ZERO     WN0374 112       Manifest Net We
     C                     MOVEL*BLANK    WN0375  1        Manifest Unused
     C                     MOVEL*BLANK    WN0376  1        Manifest Unused
     C                     Z-ADD*ZERO     WN0377  70       Manifest Unused
     C                     Z-ADD*ZERO     WN0378  80       HPB Meter Start
     C                     Z-ADD*ZERO     WN0379  80       HPB Meter Endin
     C                     Z-ADD*ZERO     WN0380  80       HPB Meter Total
     C                     MOVEL*BLANK    WN0381  1        EDI Status 1
     C                     MOVEL*BLANK    WN0382  1        EDI Status 2
     C                     MOVEL*BLANK    WN0383  1        EDI Status 3
     C                     MOVEL*BLANK    WN0384  1        Record Status
     C                     Z-ADD*ZERO     WN0385  60       Job Time
     C                     MOVEL*BLANK    WN0386 10        User Id
     C                     MOVEL*BLANK    WN0387 10        Job Name
     C                     Z-ADD*ZERO     WN0388  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FNCPCS
     C                     Z-ADDFNAIC3    WHAIC3           Company Number
     C                     Z-ADDFNC4NB    WHC4NB           Order Number
     C                     Z-ADDFNDPNB    WHDPNB           Order Sequence
     C                     Z-ADDFNUENB    WHUENB           Order Secondary
     C                     Z-ADDFNRZNB    WHRZNB           Case Sequence N
      *
     C           KLCHSX    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHRZNB           Case Sequence N
     C           KLCHSX    CHAIN@FNCPCS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFN1    YDRDCS
      * Move non-key fields to @FNCPCS
     C                     Z-ADDYL0015    WHN6WG           HPB Meter Net G
     C                     Z-ADD#CI3NY    WHITNY           HPB COA Batch N
     C                     Z-ADDYL0016    WHIXNY           HPB Meter Net W
     C                     Z-ADDYL0027    WHIYNY           HPB Density Ref
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFN1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WHAATM' defaulted for 'Job Time'.
      * Field '(DB1) WHAYNA' defaulted for 'User Id'.
      * Field '(DB1) WHA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WHAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFN1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FNCPCS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Chg Batch if 0    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    AMAIC3           Company Number
     C                     Z-ADD#2C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSY     CHAIN@AMREJF              90    *
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.HPB COA Batch Number is Not entered
     C           AMITNY    IFEQ 0                          *IF
      * RTV HPB 1st batch#    RT - Manifest Detail  * 
     C                     EXSR SZRVGN
      * CHG HPB Batch only    CH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDAMAIC3    WL0042           Company Number
     C                     Z-ADDAMC4NB    WL0043           Order Number
     C                     Z-ADDYL0028    WL0044           HPB COA Batch N
     C                     EXSR SUCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV HPB 1st batch#    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSZ02           Order Number
      * Define keylist
     C           KPSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Order Number
      * Setup key
     C                     Z-ADDAMAIC3    WQSZ01           Company Number
     C                     Z-ADDAMC4NB    WQSZ02           Order Number
     C                     Z-ADD*ZERO     FNDPNB           Order Sequence
     C                     Z-ADD*ZERO     FNUENB           Order Secondary
      * Establish starting position
     C           KPSSZ     SETLL@FNCPCT                    *
     C           KRSSZ     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.HPB COA Batch Number is Entered
     C           FNITNY    IFGT 0                          *IF
     C                     Z-ADDFNITNY    YL0028           COA Batch Numbe
     C                     GOTO SZEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSZ     READE@FNCPCT                  90*
     C                     ENDDO
      * USER: Exit processing
      * LAst record
      * CASE: LCL.Order Sequence Number is not equal to zero
     C           YL0029    IFNE 0                          *IF
      * RTV Total Confirmed    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFNAIC3    WL0015           Company Number
     C                     Z-ADDFNC4NB    WL0016           Order Number
     C                     Z-ADDYL0029    WL0017           Order Sequence
     C                     Z-ADDYL0030    WL0018           Order Secondary
     C                     Z-ADD*ZERO     WL0019           Case Sequence N
     C                     Z-ADDWUFYQT    WL0020           USR Case Quanti
     C                     Z-ADDWUZPNB    WL0021           USR Case Weight
     C                     Z-ADDYL0031    WL0022           HPB Meter Net G
     C                     Z-ADDYL0032    WL0023           HPB Meter Net W
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WUFYQT           USR Case Quanti
     C                     Z-ADDWL0021    WUZPNB           USR Case Weight
     C                     Z-ADDWL0022    YL0031           HPB Meter Net G
     C                     Z-ADDWL0023    YL0032           HPB Meter Net W
      * Rtv Chg Ship Qty      RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDFNAIC3    WL0024           Company Number
     C                     Z-ADDFNC4NB    WL0025           Order Number
     C                     Z-ADDYL0029    WL0026           Order Sequence
     C                     Z-ADDYL0030    WL0027           Order Secondary
     C                     Z-ADDYL0031    WL0028           Quantity Shippe
     C                     Z-ADDYL0032    WL0029           Weight Shipped
     C                     EXSR SRRVGN
     C                     END                             *FI
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * CHG Order in Use       CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0389  2        Order Type_Sale
     C                     Z-ADD*ZERO     WN0390  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0391  70       Ship To Custome
     C                     MOVEL*BLANK    WN0392 30        Ship To Name
     C                     MOVEL*BLANK    WN0393 30        Ship To Address
     C                     MOVEL*BLANK    WN0394 30        Ship To Address
     C                     MOVEL*BLANK    WN0395 30        Ship To Address
     C                     MOVEL*BLANK    WN0396 20        Ship To City
     C                     MOVEL*BLANK    WN0397  2        Ship To State C
     C                     MOVEL*BLANK    WN0398 11        Ship To Zip_Pos
     C                     Z-ADD*ZERO     WN0399  70       Bill to Custome
     C                     MOVEL*BLANK    WN0400 30        Bill to Name
     C                     MOVEL*BLANK    WN0401 30        Bill to Address
     C                     MOVEL*BLANK    WN0402 30        Bill to Address
     C                     MOVEL*BLANK    WN0403 30        Bill to Address
     C                     MOVEL*BLANK    WN0404 20        Bill to City
     C                     MOVEL*BLANK    WN0405  2        Bill to State C
     C                     MOVEL*BLANK    WN0406 11        Bill to Zip_Pos
     C                     MOVEL*BLANK    WN0407 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0408  70       Order Date
     C                     Z-ADD*ZERO     WN0409  70       Requested Ship
     C                     Z-ADD*ZERO     WN0410  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0411  70       Cancel Date
     C                     MOVEL*BLANK    WN0412  2        Terms Code
     C                     MOVEL*BLANK    WN0413 40        Special Instruc
     C                     MOVEL*BLANK    WN0414 40        Special Instruc
     C                     MOVEL*BLANK    WN0415  3        Carrier Code
     C                     MOVEL*BLANK    WN0416  1        Comment Print A
     C                     MOVEL*BLANK    WN0417  1        Comment Print I
     C                     MOVEL*BLANK    WN0418  1        Comment Print P
     C                     MOVEL*BLANK    WN0419  1        Comment Print S
     C                     MOVEL*BLANK    WN0420  3        Reason Code
     C                     MOVEL*BLANK    WN0421  1        Header Status
     C                     MOVEL*BLANK    WN0422  1        Header Status L
     C                     MOVEL*BLANK    WN0423  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0424  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0425 10        User Original E
     C                     Z-ADD*ZERO     WN0426  70       Date of Origina
     C                     Z-ADD*ZERO     WN0427 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0428 112       Order Weight To
     C                     MOVEL*BLANK    WN0429  1        Credit Hold
     C                     MOVEL*BLANK    WN0430  1        Production Hold
     C                     MOVEL*BLANK    WN0431  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0432  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0433  40       Requested Deliv
     C                     MOVEL*BLANK    WN0434  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0435 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0436  70       Load ID
     C                     Z-ADD*ZERO     WN0437  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0438 112       Rated Freight
     C                     MOVEL*BLANK    WN0439  1        LTL Flag
     C                     MOVEL*BLANK    WN0440  1        Price Audit
     C                     MOVEL*BLANK    WN0441  1        Price Status
     C                     MOVEL*BLANK    WN0442  2        Shipping Method
     C                     MOVEL*BLANK    WN0443  1        Export Status
     C                     MOVEL*BLANK    WN0444  1        Palletize
     C                     MOVEL*BLANK    WN0445  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0446  1        Slip Sheet
     C                     MOVEL*BLANK    WN0447  1        Age Code
     C                     Z-ADD*ZERO     WN0448  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0449  1        Load Type
     C                     Z-ADD*ZERO     WN0450  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0451  1        Load Plan Order
     C                     MOVEL*BLANK    WN0452  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0453  70       Resell Referenc
     C                     MOVEL*BLANK    WN0454 30        Special Comment
     C                     MOVEL*BLANK    WN0455 30        Special Comment
     C                     MOVEL*BLANK    WN0456  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0457  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0458  2        Manager Level C
     C                     MOVEL*BLANK    WN0459  3        VP Level Code
     C                     Z-ADD*ZERO     WN0460  70       Attach to Order
     C                     MOVEL*BLANK    WN0461  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0462  70       Invoice Number
     C                     MOVEL*BLANK    WN0463  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0464  70       Invoice Date
     C                     MOVEL*BLANK    WN0465  2        Event Code
     C                     MOVEL*BLANK    WN0466  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0467  1        Modified Flag
     C                     Z-ADD*ZERO     WN0468 112       A_R order Value
     C                     MOVEL*BLANK    WN0469  1        Billing Activit
     C                     MOVEL*BLANK    WN0470  1        Block Order Fla
     C                     MOVEL*BLANK    WN0471  1        Order Certifica
     C                     Z-ADD*ZERO     WN0472 112       Invoice Order V
     C                     MOVEL*BLANK    WN0473  1        Process Sts for
     C                     MOVEL*BLANK    WN0474  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0475  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0476  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0477  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0478  1        Email Cust On O
     C                     MOVEL*BLANK    WN0479  1        Order Emailed
     C                     MOVEL*BLANK    WN0480  1        Export Docs Go
     C                     MOVEL*BLANK    WN0481  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0482  1        Broker Order St
     C                     MOVEL*BLANK    WN0483  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0484  2        Order Requires
     C                     MOVEL*BLANK    WN0485  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0486  2        Export USDA App
     C                     MOVEL*BLANK    WN0487  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0488  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0489  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0490  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0491  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0492  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0493  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0494  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0495  60       Time of Origina
     C                     Z-ADD*ZERO     WN0496  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0497  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0498  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0499 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0500 112       Act Non_Ref Frt
     C                     Z-ADD*ZERO     WN0501 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0502 112       OH Total Non_Re
     C                     Z-ADD*ZERO     WN0503 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0504  70       Claim Number
     C                     MOVEL*BLANK    WN0505  1        EDI Status 1
     C                     MOVEL*BLANK    WN0506  1        EDI Status 2
     C                     MOVEL*BLANK    WN0507  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0508  60       Job Time
     C                     MOVEL*BLANK    WN0509 10        User Id
     C                     MOVEL*BLANK    WN0510 10        Job Name
     C                     Z-ADD*ZERO     WN0511  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0045    WIAIC3           Company Number
     C                     Z-ADDWL0046    WIC4NB           Order Number
      *
     C           KLCHTA    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C           KLCHTA    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YERDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWL0047    WIGJST    P      Order in Use
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWIAIC3    PAAIC3           Company Number
     C                     Z-ADDWIC4NB    PAC4NB           Order Number
     C                     MOVELWIJNCD    PAJNCD    P      Order Type_Sale
     C                     Z-ADDWIANC7    PAANC7           AR Customer Num
     C                     Z-ADDWIBKC7    PABKC7           Ship To Custome
     C                     MOVELWIBRTX    PABRTX    P      Ship To Name
     C                     MOVELWIHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWIHONA    PAHONA    P      Ship To Address
     C                     MOVELWIHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWIHNNA    PAHNNA    P      Ship To City
     C                     MOVELWIDBCD    PADBCD    P      Ship To State C
     C                     MOVELWICKTX    PACKTX    P      Ship To Zip_Pos
     C                     Z-ADDWIB0C7    PAB0C7           Bill to Custome
     C                     MOVELWIAETX    PAAETX    P      Bill to Name
     C                     MOVELWIB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWIB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWIB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWIB2NA    PAB2NA    P      Bill to City
     C                     MOVELWIBHCD    PABHCD    P      Bill to State C
     C                     MOVELWIC8TX    PAC8TX    P      Bill to Zip_Pos
     C                     MOVELWIBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWIA0DT    PAA0DT           Order Date
     C                     Z-ADDWIA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWIGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWIACDT    PAACDT           Cancel Date
     C                     MOVELWIAQCD    PAAQCD    P      Terms Code
     C                     MOVELWIB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWIBYNA    PABYNA    P      Special Instruc
     C                     MOVELWIBZNA    PABZNA    P      Carrier Code
     C                     MOVELWIGTST    PAGTST    P      Comment Print A
     C                     MOVELWIGVST    PAGVST    P      Comment Print I
     C                     MOVELWIGUST    PAGUST    P      Comment Print P
     C                     MOVELWIQFST    PAQFST    P      Comment Print S
     C                     MOVELWICQCD    PACQCD    P      Reason Code
     C                     MOVELWIGJST    PAGJST    P      Order in Use
     C                     MOVELWIGWST    PAGWST    P      Header Status
     C                     MOVELWIGXST    PAGXST    P      Header Status L
     C                     MOVELWIGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWIAODT    PAAODT           Scheduled Ship
     C                     MOVELWIAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWICXDT    PACXDT           Date of Origina
     C                     Z-ADDWIJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWIA1WG    PAA1WG           Order Weight To
     C                     MOVELWIXIST    PAXIST    P      Credit Hold
     C                     MOVELWIXJST    PAXJST    P      Production Hold
     C                     MOVELWIXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWIEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWIAFTM    PAAFTM           Requested Deliv
     C                     MOVELWIE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWIE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWIRMNB    PARMNB           Load ID
     C                     Z-ADDWITBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWIR1NB    PAR1NB           Rated Freight
     C                     MOVELWIPJST    PAPJST    P      LTL Flag
     C                     MOVELWIU0ST    PAU0ST    P      Price Audit
     C                     MOVELWIU1ST    PAU1ST    P      Price Status
     C                     MOVELWIQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWIU2ST    PAU2ST    P      Export Status
     C                     MOVELWIVEST    PAVEST    P      Palletize
     C                     MOVELWIVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWIVGST    PAVGST    P      Slip Sheet
     C                     MOVELWIRPCD    PARPCD    P      Age Code
     C                     Z-ADDWIRNNB    PARNNB           Reefer Temperat
     C                     MOVELWIVDST    PAVDST    P      Load Type
     C                     Z-ADDWIATIN    PAATIN           Attach to Invoi
     C                     MOVELWIU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWIU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWIRSRN    PARSRN           Resell Referenc
     C                     MOVELWIMHNA    PAMHNA    P      Special Comment
     C                     MOVELWIMINA    PAMINA    P      Special Comment
     C                     MOVELWIWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWIR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWIBFCD    PABFCD    P      Manager Level C
     C                     MOVELWIQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWIT3NB    PAT3NB           Attach to Order
     C                     MOVELWISICD    PASICD    P      Reason for Pric
     C                     Z-ADDWICONB    PACONB           Invoice Number
     C                     MOVELWICEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWIAWDT    PAAWDT           Invoice Date
     C                     MOVELWIJPCD    PAJPCD    P      Event Code
     C                     MOVELWIXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWIZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWIVRVA    PAVRVA           A_R order Value
     C                     MOVELWIOBST    PAOBST    P      Billing Activit
     C                     MOVELWIBCST    PABCST    P      Block Order Fla
     C                     MOVELWIBDST    PABDST    P      Order Certifica
     C                     Z-ADDWIB7VL    PAB7VL           Invoice Order V
     C                     MOVELWIGASX    PAGASX    P      Process Sts for
     C                     MOVELWIGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWIGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWIGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWIFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWIFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWIFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWIFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWIFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWIFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWIFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWIFUSX    PAFUSX    P      Order Requires
     C                     MOVELWIFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWIFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWIFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWIFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWINODT    PANODT           OH Appt Confirm
     C                     Z-ADDWINPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWINQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWINRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWINSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWIBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWIBQTM    PABQTM           Time of Origina
     C                     Z-ADDWIBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWIBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWIBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWIH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWIH1NX    PAH1NX           Act Non_Ref Frt
     C                     Z-ADDWIH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWIH3NX    PAH3NX           OH Total Non_Re
     C                     Z-ADDWIH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWIC0C7    PAC0C7           Claim Number
     C                     MOVELWIUVST    PAUVST    P      EDI Status 1
     C                     MOVELWIUWST    PAUWST    P      EDI Status 2
     C                     MOVELWIUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWIAATM    PAAATM           Job Time
     C                     MOVELWIAYNA    PAAYNA    P      User Id
     C                     MOVELWIA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWIAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQTB01           Company Number
     C           *LIKE     DEFN WAC4NB    WQTB02           Order Number
      * Define keylist
     C           KPSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQTB01           Company Number
     C                     Z-ADD#1C4NB    WQTB02           Order Number
     C                     Z-ADD#1DPNB    WADPNB           Order Sequence
     C                     Z-ADD#1UENB    WAUENB           Order Secondary
      * Establish starting position
     C           KPSTB     SETLL@BGWKL1                    *
     C           KRSTB     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1AJCD           Warehouse Code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WAGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWAAJCD    #1AJCD           Warehouse Code
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTB     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3           Company Number
     C                     Z-ADD#1HGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSTC     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZRINB    YL0034           Item Structure
     C                     Z-ADDBZRHNB    YL0035           Item Structure
     C                     Z-ADDBZRGNB    YL0036           Item Structure
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV Prod Temp-HPB     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WBRMNB           Load ID
      * Setup key
     C                     Z-ADD#2RMNB    WBRMNB           Load ID
      * Establish starting position
     C           KRSTD     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBPRTM    #CJENY           Product Tempera
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV Delete NonConfirm  RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0512  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * allow high plains delete after unship  2/16/10 rmc
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADPNB           Order Sequence
     C                     KFLD           WAUENB           Order Secondary
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3           Company Number
     C                     Z-ADD#1C4NB    WAC4NB           Order Number
     C                     Z-ADD#1DPNB    WADPNB           Order Sequence
     C                     Z-ADD#1UENB    WAUENB           Order Secondary
      * Establish starting position
     C           KRSTE     CHAIN@BGWKL1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Delete if Not Confirmed
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Work Confirm Status is Open
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C           WARZST    IFEQ *BLANK                     *IF
     C           P2YJSX    OREQ 'H'                        *OR
      * DEL Ship Detail Pricng RT - PD Ship Detail Pricing  * 
     C                     EXSR TFRVGN
      * DEL Unship Dtl Formula RT - PD Ship Dtl Formula Dtl  * 
     C                     EXSR THRVGN
      * RTV Delete Indiv Man.  RT - OM Manifest Detail  * 
     C                     EXSR TJRVGN
      * DLT Shipping Fin       RT - PD Order Detail Fin  * 
     C                     EXSR TLRVGN
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAAJCD    WL0010    P      Warehouse Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0011    WN0512    P      Lot Tracking Fl
      * Delect Order Inv Allocation
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0512    IFEQ 'Y'                        *IF
      * Del OrdDtl Inv Alloc  RT - PD Order Inv Allocation  * 
     C                     EXSR TNRVGN
     C                     END                             *FI
     C                     MOVELWAGMST    WUGNST           Detail Line Sta
      * CHG DtlSts/Cancel Item CH - PD Order Detail  * 
     C                     EXSR TPCHRC
      * CASE: PAR.Export Status is yes
     C           #2U2ST    IFEQ 'Y'                        *IF
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
     C                     EXSR TQRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * DEL Ship Detail Pricng RT - PD Ship Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN IMAIC3    WQTF01           Company Number
     C           *LIKE     DEFN IMC4NB    WQTF02           Order Number
     C           *LIKE     DEFN IMDPNB    WQTF03           Order Sequence
     C           *LIKE     DEFN IMUENB    WQTF04           Order Secondary
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WQTF02           Order Number
     C                     KFLD           WQTF03           Order Sequence
     C                     KFLD           WQTF04           Order Secondary
      * Setup key
     C                     Z-ADDWAAIC3    WQTF01           Company Number
     C                     Z-ADDWAC4NB    WQTF02           Order Number
     C                     Z-ADDWADPNB    WQTF03           Order Sequence
     C                     Z-ADDWAUENB    WQTF04           Order Secondary
      * Establish starting position
     C           KRSTF     SETLL@IMCPSE                    *
     C           KRSTF     READE@IMCPSE                  90*
      * Data record not found
     C   90                MOVEL'USR1675' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Ship Detail Pricng DL - PD Ship Detail Pricing  * 
     C                     EXSR TGDLRC
     C           KRSTF     READE@IMCPSE                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGDLRC    BEGSR
      *================================================================
      * DEL Ship Detail Pricng DL - PD Ship Detail Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @IMCPSD
     C                     Z-ADDIMAIC3    WJAIC3           Company Number
     C                     Z-ADDIMC4NB    WJC4NB           Order Number
     C                     Z-ADDIMDPNB    WJDPNB           Order Sequence
     C                     Z-ADDIMUENB    WJUENB           Order Secondary
     C                     MOVELIMQ9CD    WJQ9CD           Price Method Co
      *
     C           KLDLTG    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
     C                     KFLD           WJQ9CD           Price Method Co
     C           KLDLTG    CHAIN@IMCPSD              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDIMCPL0'MDACP
     C                     MOVEL'@IMCPSD' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@IMCPSD                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * DEL Unship Dtl Formula RT - PD Ship Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN JKAIC3    WQTH01           Company Number
     C           *LIKE     DEFN JKC4NB    WQTH02           Order Number
      * Define keylist
     C           KPSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WQTH02           Order Number
     C                     KFLD           JKDPNB           Order Sequence
     C                     KFLD           JKUENB           Order Secondary
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           Company Number
     C                     KFLD           WQTH02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQTH01           Company Number
     C                     Z-ADDWAC4NB    WQTH02           Order Number
     C                     Z-ADDWADPNB    JKDPNB           Order Sequence
     C                     Z-ADDWAUENB    JKUENB           Order Secondary
      * Establish starting position
     C           KPSTH     SETLL@JKCPYF                    *
     C           KRSTH     READE@JKCPYF                  90*
      * Data record not found
     C   90                MOVEL'USR1870' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ship Dtl Formula   DL - PD Order Dtl Formula Dtl  * 
     C                     EXSR TIDLRC
     C           KRSTH     READE@JKCPYF                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIDLRC    BEGSR
      *================================================================
      * DLT Ship Dtl Formula   DL - PD Order Dtl Formula Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JKCPYE
     C                     Z-ADDJKAIC3    WKAIC3           Company Number
     C                     Z-ADDJKC4NB    WKC4NB           Order Number
     C                     Z-ADDJKDPNB    WKDPNB           Order Sequence
     C                     Z-ADDJKUENB    WKUENB           Order Secondary
     C                     MOVELJKQ9CD    WKQ9CD           Price Method Co
     C                     Z-ADDJKHGCD    WKHGCD           Item Code
     C                     Z-ADDJKZXNB    WKZXNB           Pricing Sequenc
      *
     C           KLDLTI    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C                     KFLD           WKQ9CD           Price Method Co
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKZXNB           Pricing Sequenc
     C           KLDLTI    CHAIN@JKCPYE              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJKCPL0'MDACP
     C                     MOVEL'@JKCPYE' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JKCPYE                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * RTV Delete Indiv Man.  RT - OM Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQTJ01           Company Number
     C           *LIKE     DEFN WLC4NB    WQTJ02           Order Number
     C           *LIKE     DEFN WLDPNB    WQTJ03           Order Sequence
     C           *LIKE     DEFN WLUENB    WQTJ04           Order Secondary
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Order Number
     C                     KFLD           WQTJ03           Order Sequence
     C                     KFLD           WQTJ04           Order Secondary
      * Setup key
     C                     Z-ADDWAAIC3    WQTJ01           Company Number
     C                     Z-ADDWAC4NB    WQTJ02           Order Number
     C                     Z-ADDWADPNB    WQTJ03           Order Sequence
     C                     Z-ADDWAUENB    WQTJ04           Order Secondary
      * Establish starting position
     C           KRSTJ     SETLL@FNCPE5                    *
     C           KRSTJ     READE@FNCPE5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete OM Manifest Detail - OM Manifest Detail  * 
     C                     EXSR TKDLRC
     C           KRSTJ     READE@FNCPE5                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKDLRC    BEGSR
      *================================================================
      * Delete OM Manifest Detail - OM Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FNCPCS
     C                     Z-ADDWLAIC3    WHAIC3           Company Number
     C                     Z-ADDWLC4NB    WHC4NB           Order Number
     C                     Z-ADDWLDPNB    WHDPNB           Order Sequence
     C                     Z-ADDWLUENB    WHUENB           Order Secondary
     C                     Z-ADDWLRZNB    WHRZNB           Case Sequence N
      *
     C           KLDLTK    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHRZNB           Case Sequence N
     C           KLDLTK    CHAIN@FNCPCS              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFNCPL0'MDACP
     C                     MOVEL'@FNCPCS' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FNCPCS                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * DLT Shipping Fin       RT - PD Order Detail Fin  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN N1AIC3    WQTL01           Company Number
     C           *LIKE     DEFN N1C4NB    WQTL02           Order Number
      * Define keylist
     C           KPSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Order Number
     C                     KFLD           N1DPNB           Order Sequence
     C                     KFLD           N1UENB           Order Secondary
     C                     KFLD           N1DXNB           Sequence Number
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQTL01           Company Number
     C                     Z-ADDWAC4NB    WQTL02           Order Number
     C                     Z-ADDWADPNB    N1DPNB           Order Sequence
     C                     Z-ADDWAUENB    N1UENB           Order Secondary
     C                     Z-ADD*ZERO     N1DXNB           Sequence Number
      * Establish starting position
     C           KPSTL     SETLL@CRWKL1                    *
     C           KRSTL     READE@CRWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1317' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Shipping Detail    DC - OM Shipping Detail Fin  * 
     C                     EXSR TMDLRC
     C           KRSTL     READE@CRWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMDLRC    BEGSR
      *================================================================
      * DLT Shipping Detail    DC - OM Shipping Detail Fin  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CRWKL0
     C                     Z-ADDN1AIC3    WMAIC3           Company Number
     C                     Z-ADDN1C4NB    WMC4NB           Order Number
     C                     Z-ADDN1DPNB    WMDPNB           Order Sequence
     C                     Z-ADDN1UENB    WMUENB           Order Secondary
     C                     Z-ADDN1DXNB    WMDXNB           Sequence Number
      *
     C           KLDLTM    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
     C                     KFLD           WMDPNB           Order Sequence
     C                     KFLD           WMUENB           Order Secondary
     C                     KFLD           WMDXNB           Sequence Number
     C           KLDLTM    CHAIN@CRWKL0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMCRWKL0'MDACP
     C                     MOVEL'@CRWKL0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CRWKL0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Del OrdDtl Inv Alloc  RT - PD Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN L8AIC3    WQTN01           Company Number
     C           *LIKE     DEFN L8C4NB    WQTN02           Order Number
     C           *LIKE     DEFN L8DPNB    WQTN03           Order Sequence
     C           *LIKE     DEFN L8UENB    WQTN04           Order Secondary
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           WQTN02           Order Number
     C                     KFLD           WQTN03           Order Sequence
     C                     KFLD           WQTN04           Order Secondary
      * Setup key
     C                     Z-ADDWAAIC3    WQTN01           Company Number
     C                     Z-ADDWAC4NB    WQTN02           Order Number
     C                     Z-ADDWADPNB    WQTN03           Order Sequence
     C                     Z-ADDWAUENB    WQTN04           Order Secondary
      * Establish starting position
     C           KRSTN     SETLL@L8CPSY                    *
     C           KRSTN     READE@L8CPSY                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
     C                     EXSR TODLRC
     C           KRSTN     READE@L8CPSY                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TODLRC    BEGSR
      *================================================================
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L8CPSX
     C                     Z-ADDL8AIC3    WOAIC3           Company Number
     C                     Z-ADDL8C4NB    WOC4NB           Order Number
     C                     Z-ADDL8DPNB    WODPNB           Order Sequence
     C                     Z-ADDL8UENB    WOUENB           Order Secondary
     C                     Z-ADDL8ALSW    WOALSW           Allocation Seq
      *
     C           KLDLTO    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOC4NB           Order Number
     C                     KFLD           WODPNB           Order Sequence
     C                     KFLD           WOUENB           Order Secondary
     C                     KFLD           WOALSW           Allocation Seq
     C           KLDLTO    CHAIN@L8CPSX              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L8CPSX                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCHRC    BEGSR
      *================================================================
      * CHG DtlSts/Cancel Item CH - PD Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0513  70       Item Code
     C                     MOVEL*BLANK    WN0514  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0515  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0516  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0517 112       Billing Detail
     C                     Z-ADD*ZERO     WN0518 112       Billing Detail
     C                     Z-ADD*ZERO     WN0519 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0520  1        Comment Print A
     C                     MOVEL*BLANK    WN0521  1        Comment Print I
     C                     MOVEL*BLANK    WN0522  1        Comment Print P
     C                     MOVEL*BLANK    WN0523  1        Comment Print S
     C                     Z-ADD*ZERO     WN0524  70       Market Pricing
     C                     MOVEL*BLANK    WN0525  3        Commodity Marke
     C                     MOVEL*BLANK    WN0526  3        Date Method Cod
     C                     MOVEL*BLANK    WN0527  3        Price Method Co
     C                     Z-ADD*ZERO     WN0528 114       Price Overage O
     C                     Z-ADD*ZERO     WN0529  70       Contract Number
     C                     MOVEL*BLANK    WN0530  1        Price Status
     C                     Z-ADD*ZERO     WN0531  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0532  2        U_M_Base Price
     C                     MOVEL*BLANK    WN0533  2        U_M_Ordered
     C                     MOVEL*BLANK    WN0534  1        Work Confirm St
     C                     MOVEL*BLANK    WN0535  1        Work Over_Short
     C                     MOVEL*BLANK    WN0536  1        OD Production P
     C                     MOVEL*BLANK    WN0537 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0538 30        Order Desc_Line
     C                     MOVEL*BLANK    WN0539  1        Age Code
     C                     MOVEL*BLANK    WN0540  1        Palletize
     C                     MOVEL*BLANK    WN0541  1        Slip Sheet
     C                     MOVEL*BLANK    WN0542  1        Catch Weight St
     C                     MOVEL*BLANK    WN0543  1        Price Audit
     C                     MOVEL*BLANK    WN0544  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0545  1        Production Date
     C                     Z-ADD*ZERO     WN0546 112       Rated Freight
     C                     Z-ADD*ZERO     WN0547 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0548 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0549 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0550 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0551 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0552 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0553 114       Unit Price
     C                     Z-ADD*ZERO     WN0554 114       Unit Price_Cred
     C                     Z-ADD*ZERO     WN0555 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0556 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0557 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0558  70       Requested Ship
     C                     Z-ADD*ZERO     WN0559  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0560  70       Actual Shipped
     C                     MOVEL*BLANK    WN0561  1        Affect Inventor
     C                     MOVEL*BLANK    WN0562  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0563  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0564  30       Item Structure
     C                     Z-ADD*ZERO     WN0565  30       Item Structure
     C                     Z-ADD*ZERO     WN0566  30       Item Structure
     C                     MOVEL*BLANK    WN0567  2        Item Level
     C                     MOVEL*BLANK    WN0568  2        Quality Level
     C                     MOVEL*BLANK    WN0569  2        Pricing Product
     C                     MOVEL*BLANK    WN0570  2        Season Product
     C                     Z-ADD*ZERO     WN0571  70       Date of Origina
     C                     MOVEL*BLANK    WN0572 10        User Profile Na
     C                     MOVEL*BLANK    WN0573  6        Country Code
     C                     MOVEL*BLANK    WN0574  2        Event Code
     C                     MOVEL*BLANK    WN0575  3        Reason Code
     C                     MOVEL*BLANK    WN0576  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0577  1        Modified Flag
     C                     MOVEL*BLANK    WN0578  1        Substituted Fla
     C                     MOVEL*BLANK    WN0579  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0580 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0581 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0582  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0583  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0584  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0585  1        Affect Commissi
     C                     MOVEL*BLANK    WN0586  1        Affect Pricing
     C                     MOVEL*BLANK    WN0587  1        Released by Use
     C                     MOVEL*BLANK    WN0588  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0589  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0590  3        Production Ware
     C                     MOVEL*BLANK    WN0591  3        OD Price Type
     C                     Z-ADD*ZERO     WN0592  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0593  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0594  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0595  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0596  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0597  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0598  60       Price Code
     C                     Z-ADD*ZERO     WN0599  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0600  60       Substitution Li
     C                     Z-ADD*ZERO     WN0601  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0602 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0603 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0604 112       OD Item Target
     C                     Z-ADD*ZERO     WN0605 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0606 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0607 114       Order Gate_Fina
     C                     Z-ADD*ZERO     WN0608 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0609 114       OD Gate_Final P
     C                     Z-ADD*ZERO     WN0610 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0611 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0612 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0613 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0614 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0615  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0616  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0617  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0618 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0619  40       Item Age Days
     C                     Z-ADD*ZERO     WN0620  70       Production Ovr
     C                     Z-ADD*ZERO     WN0621  70       Production Ovr
     C                     MOVEL*BLANK    WN0622  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0623  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0624  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0625  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0626  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0627  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0628  1        EDI Status 1
     C                     MOVEL*BLANK    WN0629  1        EDI Status 2
     C                     MOVEL*BLANK    WN0630  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0631  60       Job Time
     C                     MOVEL*BLANK    WN0632 10        User Id
     C                     MOVEL*BLANK    WN0633 10        Job Name
     C                     Z-ADD*ZERO     WN0634  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWAAIC3    WEAIC3           Company Number
     C                     Z-ADDWAC4NB    WEC4NB           Order Number
     C                     Z-ADDWADPNB    WEDPNB           Order Sequence
     C                     Z-ADDWAUENB    WEUENB           Order Secondary
      *
     C           KLCHTP    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHTP    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YFRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL'X'       WEGMST    P      Detail Line Sta
     C                     MOVELWAGNST    WEGNST    P      Detail Line Sta
     C                     Z-ADD*ZERO     WEKDVA           Billing Detail
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WECBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WEATWG           Weight Shipped
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQRVGN    BEGSR
      *================================================================
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN MSAIC3    WQTQ01           Company Number
     C           *LIKE     DEFN MSC4NB    WQTQ02           Order Number
     C           *LIKE     DEFN MSDPNB    WQTQ03           Order Sequence
     C           *LIKE     DEFN MSUENB    WQTQ04           Order Secondary
      * Define keylist
     C           KRSTQ     KLIST
     C                     KFLD           WQTQ01           Company Number
     C                     KFLD           WQTQ02           Order Number
     C                     KFLD           WQTQ03           Order Sequence
     C                     KFLD           WQTQ04           Order Secondary
      * Setup key
     C                     Z-ADDWAAIC3    WQTQ01           Company Number
     C                     Z-ADDWAC4NB    WQTQ02           Order Number
     C                     Z-ADDWADPNB    WQTQ03           Order Sequence
     C                     Z-ADDWAUENB    WQTQ04           Order Secondary
      * Establish starting position
     C           KRSTQ     SETLL@MSREX2                    *
     C           KRSTQ     READE@MSREX2                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
     C                     EXSR TRDLRC
     C           KRSTQ     READE@MSREX2                  90*
     C                     ENDDO
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRDLRC    BEGSR
      *================================================================
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @MSREW4
     C                     Z-ADDMSAIC3    WRAIC3           Company Number
     C                     Z-ADDMSC4NB    WRC4NB           Order Number
     C                     MOVELMSDGSX    WRDGSX           ED Export Docum
     C                     MOVELMSKXCD    WRKXCD           Country Code
     C                     Z-ADDMSDPNB    WRDPNB           Order Sequence
     C                     Z-ADDMSUENB    WRUENB           Order Secondary
      *
     C           KLDLTR    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C                     KFLD           WRDGSX           ED Export Docum
     C                     KFLD           WRKXCD           Country Code
     C                     KFLD           WRDPNB           Order Sequence
     C                     KFLD           WRUENB           Order Secondary
     C           KLDLTR    CHAIN@MSREW4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMSREL0'MDACP
     C                     MOVEL'@MSREW4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@MSREW4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0635    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTS     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P5I6ST           Allow Multi_Com
     C                     MOVELDRMPNA    P5MPNA           Default Printer
     C                     MOVELDRBCCD    P5BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0037           Company Number
     C                     MOVELDRBUVN    WN0636           User Code Model
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0048    DTAJVN           User Profile Na
     C                     MOVELWL0049    DTDNCD           Application Cod
      * Establish starting position
     C           KRSTT     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0050           Company Number
     C                     MOVELDTAJCD    WL0051           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTU01           Application Cod
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WQTU01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTU01           Application Cod
     C                     MOVEL'OMS'     WQTU01           Application Cod
      * Establish starting position
     C           KRSTU     SETLL@DNRESF                    *
     C           KRSTU     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TVRVGN
     C                     END                             *FI
     C           KRSTU     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTV01           Application Cod
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WQTV01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTV01           Application Cod
      * Establish starting position
     C           KRSTV     SETLL@DNRESF                    *
     C           KRSTV     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTV     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSTW     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P5I8ST           Allow Multi War
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI8ST    P5I8ST           Allow Multi War
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * P000579 RMC 07/12/2010 HPB - get API Temp corr factor from file,
      *           instead of calculating it
      * P000579 RMC 06/24/2010 HPB diff formula
      * E00157 LJB 08/26/2009-Prompt OHE for newly added parms
      * FP1110 RMC 5/1/08 output Density REf Gravity to MAnifest detail
      * FP1110 RMC 8/28/08 update carrier broker in load header
      * S00464 RMC 9/17/08 update batch. it may be diff
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2AIC3    WK1X01  1
     C                     MOVELV2C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#2AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#2C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2AIC3' defaulted for 'Company Number'.
      * Field '(CTL) #2C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0105  30       Company Number
     C           #2C4NB    PARM #2C4NB    WQ0106  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVABE    KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    BEAIC3
     C                     Z-ADD#2C4NB    BEC4NB
     C           KLVABE    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     MOVELBEXIST    #2XIST           Credit Hold
     C                     MOVELBEXJST    #2XJST           Production Hold
     C                     MOVELBEGWST    #2GWST           Header Status
     C                     MOVELBEJNCD    #2JNCD           Order Type_Sale
     C                     Z-ADDBERMNB    #2RMNB           Load ID
     C                     MOVELBEU2ST    #2U2ST           Export Status
     C                     MOVELBEHNNA    #2HNNA           Ship To City
     C                     MOVELBEDBCD    #2DBCD           Ship To State C
     C                     Z-ADDBEEIDT    #2EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #2AFTM           Requested Deliv
     C                     MOVELBEGJST    #2GJST           Order in Use
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03840
     C           ZINPOS    ANDLE05632
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  15        W0CSRR  50
     C           03840     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD15        ZHSTRW  40
     C                     Z-ADD21        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * Disable *Exit key
      * CASE: CTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
      * HPB only  4/23/08
      * CASE: CTL.COA Temperature Loadout NE WRK.COA Temperature Loadout
     C           #CJENY    IFNE WUJENY                     *IF
      * Send message 'Exit not allwd-temp chg'
     C                     MOVEL'USR3935' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO ZXEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1Q2NB           Event Number
     C                     Z-ADD*ZERO     P1FYQT           USR Case Quanti
     C                     Z-ADD*ZERO     P1ZPNB           USR Case Weight
     C                     MOVEL*BLANK    P1E6ST           USR Status (Y/N
     C                     MOVEL*BLANK    P1PFNA           Email User ID
     C                     Z-ADD*ZERO     P1AJAE           Order Number 1
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2HSST           Allow Mult Whse
     C                     MOVEL*BLANK    P2YJSX           Company Organiz
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4JNCD           Order Type_Sale
     C                     Z-ADD*ZERO     P4BKC7           Ship To Custome
     C                     MOVEL*BLANK    P4BRTX           Ship To Name
     C                     MOVEL*BLANK    P4BCNA           Customer Purcha
     C                     Z-ADD*ZERO     P4A0DT           Order Date
     C                     Z-ADD*ZERO     P4A5DT           Requested Ship
     C                     MOVEL*BLANK    P4B6NA           Special Instruc
     C                     MOVEL*BLANK    P4BYNA           Special Instruc
     C                     MOVEL*BLANK    P4BZNA           Carrier Code
     C                     MOVEL*BLANK    P4GYST           Order Type Prin
     C                     Z-ADD*ZERO     P4AODT           Scheduled Ship
     C                     Z-ADD*ZERO     P4JZVA           Order Value Tot
     C                     Z-ADD*ZERO     P4A1WG           Order Weight To
     C                     Z-ADD*ZERO     P4RMNB           Load ID
     C                     MOVEL*BLANK    P4U2ST           Export Status
     C                     MOVEL*BLANK    P4VEST           Palletize
     C                     MOVEL*BLANK    P4VFST           Shrink Wrap
     C                     MOVEL*BLANK    P4VGST           Slip Sheet
     C                     Z-ADD*ZERO     P4RNNB           Reefer Temperat
     C                     MOVEL*BLANK    P4OBST           Billing Activit
     C                     MOVEL*BLANK    P4FOSX           Email Cust On O
     C                     MOVEL*BLANK    P4FPSX           Order Emailed
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P5I6ST           Allow Multi_Com
     C                     MOVEL*BLANK    P5I8ST           Allow Multi War
     C                     MOVEL*BLANK    P5MPNA           Default Printer
     C                     MOVEL*BLANK    P5TAST           First Time Flag
     C                     MOVEL*BLANK    P5WVST           Access Denied (
     C                     MOVEL*BLANK    P5HHST           Access Limited
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6VHST           Lot Tracking Fl
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7Q1ST           Status Flag 1
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field USR Status (Y/N)
     C                     MOVEL*BLANK    WUE6ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price_Cred
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate_Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate_Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Product Temperature
     C                     Z-ADD*ZERO     WUPRTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WBFLAM           Flat Amount
     C                     Z-ADD*ZERO     WBRRNB           Total Stops
     C                     Z-ADD*ZERO     WBSBNB           BOL Time
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBSDNB           Number Pallets
     C                     Z-ADD*ZERO     WBPAOU           Number Pallets
     C                     Z-ADD*ZERO     WBDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBHADT           Actual Arrival
     C                     Z-ADD*ZERO     WBAART           Actual Arrival
     C                     Z-ADD*ZERO     WBDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WBDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WBAQDT           Actual Departur
     C                     Z-ADD*ZERO     WBS6NB           Departure Time
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBPRTM           Product Tempera
     C                     Z-ADD*ZERO     WBNPSV           Number Spacers
     C                     Z-ADD*ZERO     WBTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WBGRWE           Gross Weight
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WBTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WBJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WBSPTM           Spotted Time
     C                     Z-ADD*ZERO     WBJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WBLFTM           Load Finished T
     C                     Z-ADD*ZERO     WBJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WBBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WBJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WBBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WBKIDT           Truck Departure
     C                     Z-ADD*ZERO     WBASTM           Truck Departure
     C                     Z-ADD*ZERO     WBKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WBAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WBVOAG           Voyage
     C                     Z-ADD*ZERO     WBKBDT           Sail Date
     C                     Z-ADD*ZERO     WBEFDT           Arrival Date
     C                     Z-ADD*ZERO     WBKCDT           Date In
     C                     Z-ADD*ZERO     WBTMIN           Time In
     C                     Z-ADD*ZERO     WBKDDT           Date Out
     C                     Z-ADD*ZERO     WBVMNB           Time Out
     C                     Z-ADD*ZERO     WBOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WBK0DT           Product Complet
     C                     Z-ADD*ZERO     WBAYTM           Product Complet
     C                     Z-ADD*ZERO     WBKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WBICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WBIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WBK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WBAZTM           Load Door 1
     C                     Z-ADD*ZERO     WBK2DT           Override Total
     C                     Z-ADD*ZERO     WBA0TM           Load Door 2
     C                     Z-ADD*ZERO     WBZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WBPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WBCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WBPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WBCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WBP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WBCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WBP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WBCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WBP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WBCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field COA Temperature Loadout
     C                     Z-ADD*ZERO     WUJENY  30
      * Define work field Create Requested
     C                     MOVEL*BLANK    WUR5ST  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WCRFDT           COA Date Open f
     C                     Z-ADD*ZERO     WCC2TM           COA Time Open f
     C                     Z-ADD*ZERO     WCRGDT           COA Date Close
     C                     Z-ADD*ZERO     WCC3TM           COA Time Close
     C                     Z-ADD*ZERO     WCJHNY           COA Gallons Use
     C                     Z-ADD*ZERO     WCRHDT           COA Batch Produ
     C                     Z-ADD*ZERO     WCC4TM           COA Batch Unuse
     C                     Z-ADD*ZERO     WCJENY           COA Temperature
     C                     Z-ADD*ZERO     WCJVNY           COA Batch Volum
     C                     Z-ADD*ZERO     WCJWNY           COA Batch Denat
     C                     Z-ADD*ZERO     WCJXNY           COA Batch Expor
     C                     Z-ADD*ZERO     WCJ1NY           COA Last RIN EE
     C                     Z-ADD*ZERO     WCJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WCJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WCJ3NY           COA RIN Equival
     C                     Z-ADD*ZERO     WCRLDT           COA Batch Unuse
     C                     Z-ADD*ZERO     WCR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WCTTDT           COA BH EMTS Dat
     C                     Z-ADD*ZERO     WCDRTM           COA BH EMTS Tim
     C                     Z-ADD*ZERO     WCR4NY           COA BH Yield Pe
     C                     Z-ADD*ZERO     WCTUDT           COA Sample Date
     C                     Z-ADD*ZERO     WCDSTM           COA Sample Time
     C                     Z-ADD*ZERO     WCSANY           COA BH Feedstck
     C                     Z-ADD*ZERO     WCGZPC           COA BH Feedstck
     C                     Z-ADD*ZERO     WCSBNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WCG0PC           COA BH Feedstck
     C                     Z-ADD*ZERO     WCSCNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WCG1PC           cOA BH Feedstck
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field RFS API Vol Corr Factor
     C                     Z-ADD*ZERO     WUSUNY  54
      * Define work field Case Sequence Number
     C                     Z-ADD*ZERO     WURZNB  50
      * Define work field USR Case Quantity
     C                     Z-ADD*ZERO     WUFYQT  50
      * Define work field USR Case Weight
     C                     Z-ADD*ZERO     WUZPNB 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGRUNB           Stop_Drop Seque
     C                     Z-ADD*ZERO     WGQWDT           OHE Sail_Flight
     C                     Z-ADD*ZERO     WGQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WGQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WGGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WGHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WGHGVL           Transload Termi
     C                     Z-ADD*ZERO     WGQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WGQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WGQ1DT           OHE Port_Pier P
     C                     Z-ADD*ZERO     WGQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WGITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WGQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WGQKNY           LD Stop_Drop
     C                     Z-ADD*ZERO     WGQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WGP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WGP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WGQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WGQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WGQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WGQENY           Original Appoin
     C                     Z-ADD*ZERO     WGQFNY           Original Appoin
     C                     Z-ADD*ZERO     WGQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WGQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WGQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WGQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WGW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WGW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field COA Temp Conv Factor 1
     C                     Z-ADD*ZERO     WUJQNY 118
      * Define work field COA Temp Conv Factor 2
     C                     Z-ADD*ZERO     WUJRNY 118
      * Define work field HPB Temperature Adjustmnt
     C                     Z-ADD*ZERO     WUJSNY  96
      * Define work field Quantity 7.0 USR
     C                     Z-ADD*ZERO     WUTQTC  70
      * Define work field COA Density Ref Adj 4 dec
     C                     Z-ADD*ZERO     WULRNY  64
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WHFOQT           Case Quantity
     C                     Z-ADD*ZERO     WHR0NB           Case Weight
     C                     Z-ADD*ZERO     WHK7DT           Label Date
     C                     Z-ADD*ZERO     WHPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WHH5NY           Manifest Total
     C                     Z-ADD*ZERO     WHH6NY           Manifest Co_Par
     C                     Z-ADD*ZERO     WHH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WHN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WHN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WHRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WHITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WHIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WHIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WHIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WHIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WHIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIANC7           AR Customer Num
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WIB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WIA0DT           Order Date
     C                     Z-ADD*ZERO     WIA5DT           Requested Ship
     C                     Z-ADD*ZERO     WIGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WIACDT           Cancel Date
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WICXDT           Date of Origina
     C                     Z-ADD*ZERO     WIJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WIA1WG           Order Weight To
     C                     Z-ADD*ZERO     WIEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WIAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WITBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WIRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WIATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WIRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WIT3NB           Attach to Order
     C                     Z-ADD*ZERO     WICONB           Invoice Number
     C                     Z-ADD*ZERO     WIAWDT           Invoice Date
     C                     Z-ADD*ZERO     WIVRVA           A_R order Value
     C                     Z-ADD*ZERO     WIB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WINODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WINPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WINQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WINRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WINSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WIBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WIBQTM           Time of Origina
     C                     Z-ADD*ZERO     WIBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WIBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WIBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WIH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WIH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WIH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WIH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WIH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WIC0C7           Claim Number
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDPNB           Order Sequence
     C                     Z-ADD*ZERO     WJUENB           Order Secondary
     C                     Z-ADD*ZERO     WJPDSQ           Price Detail Se
     C                     Z-ADD*ZERO     WJBNPR           Componant Price
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKZXNB           Pricing Sequenc
     C                     Z-ADD*ZERO     WKBOPR           Sales Yield
     C                     Z-ADD*ZERO     WKCDPR           Market Value
     C                     Z-ADD*ZERO     WKCEPR           Credit Value
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMDPNB           Order Sequence
     C                     Z-ADD*ZERO     WMUENB           Order Secondary
     C                     Z-ADD*ZERO     WMDXNB           Sequence Number
     C                     Z-ADD*ZERO     WMBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WMSANB           Special Charge
     C                     Z-ADD*ZERO     WMCKNB           GL Document Num
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOC4NB           Order Number
     C                     Z-ADD*ZERO     WODPNB           Order Sequence
     C                     Z-ADD*ZERO     WOUENB           Order Secondary
     C                     Z-ADD*ZERO     WOALSW           Allocation Seq
     C                     Z-ADD*ZERO     WOJ6QT           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WOG9WG           OIA Alloc_Shipp
     C                     Z-ADD*ZERO     WOJ9QT           OIA Co-Packer L
     C                     Z-ADD*ZERO     WOHAWG           OIA Serial Numb
     C                     Z-ADD*ZERO     WOHGCD           Item Code
     C                     Z-ADD*ZERO     WOELDT           Production Date
     C                     Z-ADD*ZERO     WOLXNM           Lot Number
     C                     Z-ADD*ZERO     WOYNCD           Location Level
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field Detail Line Status Last
     C                     MOVEL*BLANK    WUGNST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRC4NB           Order Number
     C                     Z-ADD*ZERO     WRDPNB           Order Sequence
     C                     Z-ADD*ZERO     WRUENB           Order Secondary
     C                     Z-ADD*ZERO     WRDIC7           ED Item Code
     C                     Z-ADD*ZERO     WRHJWG           ED Product Net
     C                     Z-ADD*ZERO     WRHKWG           ED Product Net
     C                     Z-ADD*ZERO     WRAONX           ED Product Nbr
     C                     Z-ADD*ZERO     WRAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     WRANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     WRAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     WRDKPR           ED Product Unit
     C                     Z-ADD*ZERO     WRA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     WRAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WRW0DT           ED Nbr of Packi
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0WE02 179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WE01 179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WC00 175       *Synon (17,5) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  50
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0008  3
     C                     Z-ADD*ZERO     WL0009  30
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0010  3
     C                     MOVEL*BLANK    WL0011  1
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0012  41
     C                     Z-ADD*ZERO     WL0013  41
     C                     Z-ADD*ZERO     WL0014  54
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  50
     C                     Z-ADD*ZERO     WL0020  50
     C                     Z-ADD*ZERO     WL0021 112
     C                     Z-ADD*ZERO     WL0022 112
     C                     Z-ADD*ZERO     WL0023  80
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028 112
     C                     Z-ADD*ZERO     WL0029 112
      * Define local variables for subroutine SSCHRC.
     C                     Z-ADD*ZERO     WL0030  30
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  30
     C                     Z-ADD*ZERO     WL0033  30
     C                     MOVEL*BLANK    WL0034  1
     C                     MOVEL*BLANK    WL0035  1
     C                     Z-ADD*ZERO     WL0036 112
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038  70
      * Define local variables for subroutine STCHRC.
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040  52
     C                     MOVEL*BLANK    WL0041  3
      * Define local variables for subroutine SUCHRC.
     C                     Z-ADD*ZERO     WL0042  30
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  50
      * Define local variables for subroutine TACHRC.
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  70
     C                     MOVEL*BLANK    WL0047  1
      * Define local variables for subroutine TTRVGN.
     C                     MOVEL*BLANK    WL0048 10
     C                     MOVEL*BLANK    WL0049  6
     C                     Z-ADD*ZERO     WL0050  30
     C                     MOVEL*BLANK    WL0051  3
      * Define local work field Deadline Departure Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Deadline Departure Time
     C                     Z-ADD*ZERO     YL0002  60
      * Define local work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field HPB COA Batch Number
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field Carrier Broker
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field COA Batch Number
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field Warehouse Code Assigned
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field COA Batch Header Sts
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field RFS Loadout Temperature
     C                     Z-ADD*ZERO     YL0012  41
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0013  30
      * Define local work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YL0014  30
      * Define local work field HPB Meter Net Gallon
     C                     Z-ADD*ZERO     YL0015 112
      * Define local work field HPB Meter Net Weight
     C                     Z-ADD*ZERO     YL0016  80
      * Define local work field HPB COA Batch Number
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0018  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0021  30
      * Define local work field COA Bio-diesel Fuel Code
     C                     MOVEL*BLANK    YL0022  6
      * Define local work field COA Density Loadout
     C                     Z-ADD*ZERO     YL0023  75
      * Define local work field COA Temperature Ref
     C                     Z-ADD*ZERO     YL0024  30
      * Define local work field RFS Loadout Temperature
     C                     Z-ADD*ZERO     YL0025  41
      * Define local work field RFS API Vol Corr Factor
     C                     Z-ADD*ZERO     YL0026  54
      * Define local work field HPB Density Ref Gravity
     C                     Z-ADD*ZERO     YL0027  74
      * Define local work field COA Batch Number
     C                     Z-ADD*ZERO     YL0028  50
      * Define local work field Order Sequence Number
     C                     Z-ADD*ZERO     YL0029  30
      * Define local work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     YL0030  30
      * Define local work field HPB Meter Net Gallon
     C                     Z-ADD*ZERO     YL0031 112
      * Define local work field HPB Meter Net Weight
     C                     Z-ADD*ZERO     YL0032  80
      * Define local work field Send Email f/Failed API U
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field Item Structure Class Code
     C                     Z-ADD*ZERO     YL0034  30
      * Define local work field Item Structure Group Code
     C                     Z-ADD*ZERO     YL0035  30
      * Define local work field Item Structure Type Code
     C                     Z-ADD*ZERO     YL0036  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0037  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0038  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD07        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL'N'       P7Q1ST           Status Flag 1
      *
     C                     MOVEL*BLANK    WN0635 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0635           User Profile Na
      *
     C                     MOVEL*BLANK    WN0636 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR TSRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0635    ZA0014           User Profile Na
     C                     MOVEL'OMS'     ZA0015           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0636    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0635    WL0048    P      User Profile Na
     C                     MOVEL'OMS'     WL0049    P      Application Cod
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0050    WUAIC3           Company Number
     C                     MOVELWL0051    YL0038    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0636    WL0048    P      User Profile Na
     C                     MOVEL'OMS'     WL0049    P      Application Cod
     C                     EXSR TTRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0050    WUAIC3           Company Number
     C                     MOVELWL0051    YL0038    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0038    WUAJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0635    ZA0016           User Profile Na
     C                     MOVEL'OMS'     ZA0017           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0037    IFNE 0                          *IF
     C                     Z-ADDYL0037    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0038    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           WUAJCD    PARM *BLANK    WQ0107  3        Warehouse Code
     C                     PARM YL0037    WQ0108  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TURVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'Y'       P5TAST           First Time Flag
     C                     MOVEL'N'       P1E6ST           USR Status (Y/N
     C                     MOVEL'Y'       WUGGST           USR Display fie
      * RTV Co. Dflt Int All,O XF - Company Defaults Internal  * 
     C                     CALL 'PMRMXFR'              90  RTV Co. Dflt In
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3AIC3    WQ0109  30       Company Number
     C           WUG0TX    PARM *BLANK    WQ0110  2        Shipping Method
     C           WUG0TX    PARM *BLANK    WQ0111  1        Load Type Dft
     C           WUG0TX    PARM *BLANK    WQ0112  1        LTL Flag Dft
     C           WUG0TX    PARM *BLANK    WQ0113  1        Export Status D
     C           WUG0TX    PARM *BLANK    WQ0114  1        Shrink Wrap Dft
     C           WUNFNN    PARM *ZERO     WQ0115  40       Departure Time
     C           WUG0TX    PARM *BLANK    WQ0116  6        Export Code Dft
     C           P2HSST    PARM *BLANK    WQ0117  1        Allow Mult Whse
     C           WUG0TX    PARM *BLANK    WQ0118  1        Allow Multi Exp
     C           WUG0TX    PARM *BLANK    WQ0119  1        Slip Sheet Dft
     C           WUG0TX    PARM *BLANK    WQ0120  1        Palletize Dft
     C           P2YJSX    PARM *BLANK    WQ0121  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMRMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
     C                     EXSR TWRVGN
      * ** Set Access Limited parm                         W288
     C                     MOVEL'Y'       P5HHST           Access Limited
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01035010550107801291012990134501538
01580018030181901838018670205902091
02115023220233002367023690237102562
02818038420384903851038650386903883
0389203897039000390503911
** W0END
01037010610107801297013280135701577
01614018050182101840018690207302098
02119023280233002367023690237102639
02895038470384903863038660388103889
0389403897039020390703915
** W0NAM
V2AIC3    V2C4NB    #2U2ST    V2BKC7    #CBRTX    #PA1WG    #PB6NA
#PBYNA    #2AJCD    #PBZNA    #CXCCD    #CJENY    #PBCNA    V2GNDT
#CI3NY    #PRNNB    #CFRSX    #PVFST    #2VEST    #2VGST    **SPT
#2ST1     #RENTX    #1SEL     #RC0QT    #1AGCD    #RA7WG    V1HGCD
#1AJCD    #1AVST    #1DPNB    #1UENB    #REOTX
** @CN
00001 Y2U0005
00002 PDL8DFR
00003 ALICEB
00004 ISALICEB
00005 PRKTEST
00006 ISPURVAP
00007 ISPPATE
00008 ISROSEM
00009 ISRCENT
00010 ISSMASO
00011 ISSUSANM
00012 ISLBUSE
00013 ISLARAB
00014 ISWGAUS
00015 ISELOUC
