     H/TITLE EXC SH-BOL f/Custs    XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 05/06/20  Time  : 21:22:11
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNF7REL5IF  E           K        DISK
      * RSQ : Cust Distribution Entry   Code/Type/Dest
      *
     FOPBFCPHGIF  E           K        DISK
      * RSQ : Order Header TRG          Ship To/Load/Ord Sel R/C
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPMAMRELKIF  E           K        DISK
      * RSQ : Order Header Extension    Sel Email Bol - Process
      *
     FPMAMREL0UF  E           K        DISK
      * UPD : Order Header Extension    Update index
      *
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@F7REHI
      * Cust Distribution Entry   Code/Type/Dest
      * Renamed input format fields
     I              F7BKC7                          WABKC7
     I              F7MNAA                          WAMNAA
     I              F7RNNY                          WARNNY
     I              F7WLT1                          WAWLT1
     I              F7IRST                          WAIRST
     I              F7WMT1                          WAWMT1
     I              F7VSST                          WAVSST
     I              F7MJDT                          WAMJDT
     I              F7BETM                          WABETM
     I              F7CCVN                          WACCVN
     I              F7CDVN                          WACDVN
     I              F7MKDT                          WAMKDT
     I              F7BFTM                          WABFTM
     I              F7CEVN                          WACEVN
     I              F7CFVN                          WACFVN
      *
     I@BFCPHH
      * Order Header TRG          Ship To/Load/Ord Sel R/C
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WCAIC3
     I              AMC4NB                          WCC4NB
     I              AMRMNB                          WCRMNB
     I              AMRUNB                          WCRUNB
     I              AMXACD                          WCXACD
     I              AMOANA                          WCOANA
     I              AMHBAA                          WCHBAA
     I              AMJ0T1                          WCJ0T1
     I              AMGENY                          WCGENY
     I              AMJ1T1                          WCJ1T1
     I              AMHCAA                          WCHCAA
     I              AMQWDT                          WCQWDT
     I              AMQXDT                          WCQXDT
     I              AMQYDT                          WCQYDT
     I              AMHDAA                          WCHDAA
     I              AMCCTX                          WCCCTX
     I              AMJ2T1                          WCJ2T1
     I              AMRLNA                          WCRLNA
     I              AMRMNA                          WCRMNA
     I              AMGINY                          WCGINY
     I              AMGFNY                          WCGFNY
     I              AMGGNY                          WCGGNY
     I              AMGHNY                          WCGHNY
     I              AMHEVL                          WCHEVL
     I              AMHFVL                          WCHFVL
     I              AMHGVL                          WCHGVL
     I              AMQZDT                          WCQZDT
     I              AMQ0DT                          WCQ0DT
     I              AMQ1DT                          WCQ1DT
     I              AMQ2DT                          WCQ2DT
     I              AMC2TX                          WCC2TX
     I              AMC3TX                          WCC3TX
     I              AMC6TX                          WCC6TX
     I              AMCHTX                          WCCHTX
     I              AMCITX                          WCCITX
     I              AMCLTX                          WCCLTX
     I              AMB4TX                          WCB4TX
     I              AMCUTX                          WCCUTX
     I              AMCVTX                          WCCVTX
     I              AMB9TX                          WCB9TX
     I              AMJWSC                          WCJWSC
     I              AMITNY                          WCITNY
     I              AMLMT1                          WCLMT1
     I              AMLWAA                          WCLWAA
     I              AMFVST                          WCFVST
     I              AMF0ST                          WCF0ST
     I              AMF2ST                          WCF2ST
     I              AMF3ST                          WCF3ST
     I              AMJUSC                          WCJUSC
     I              AMJVSC                          WCJVSC
     I              AMV3T1                          WCV3T1
     I              AMV4T1                          WCV4T1
     I              AMV5T1                          WCV5T1
     I              AMV6T1                          WCV6T1
     I              AMV7T1                          WCV7T1
     I              AMV8T1                          WCV8T1
     I              AMV9T1                          WCV9T1
     I              AMWAT1                          WCWAT1
     I              AMWBT1                          WCWBT1
     I              AMWCT1                          WCWCT1
     I              AMWDT1                          WCWDT1
     I              AMQJNY                          WCQJNY
     I              AMQKNY                          WCQKNY
     I              AMQLNY                          WCQLNY
     I              AMP8NY                          WCP8NY
     I              AMP9NY                          WCP9NY
     I              AMQANY                          WCQANY
     I              AMQCNY                          WCQCNY
     I              AMQDNY                          WCQDNY
     I              AMQENY                          WCQENY
     I              AMQFNY                          WCQFNY
     I              AMQGNY                          WCQGNY
     I              AMQHNY                          WCQHNY
     I              AMQINY                          WCQINY
     I              AMQMNY                          WCQMNY
     I              AMMYU1                          WCMYU1
     I              AMJXSC                          WCJXSC
     I              AMJYSC                          WCJYSC
     I              AMJZSC                          WCJZSC
     I              AMJ0SC                          WCJ0SC
     I              AMMZU1                          WCMZU1
     I              AMM0U1                          WCM0U1
     I              AMM1U1                          WCM1U1
     I              AMM2U1                          WCM2U1
     I              AMM3U1                          WCM3U1
     I              AMW5DT                          WCW5DT
     I              AMW6DT                          WCW6DT
     I              AMUVST                          WCUVST
     I              AMUWST                          WCUWST
     I              AMUXST                          WCUXST
     I              AMVSST                          WCVSST
     I              AMAATM                          WCAATM
     I              AMAYNA                          WCAYNA
     I              AMA0NA                          WCA0NA
     I              AMAXDT                          WCAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WEAIC3
     I              KMV8CD                          WEV8CD
     I              KMAUNA                          WEAUNA
     I              KMI5ST                          WEI5ST
     I              KMBXTX                          WEBXTX
     I              KMM8NB                          WEM8NB
     I              KMUVST                          WEUVST
     I              KMUWST                          WEUWST
     I              KMUXST                          WEUXST
     I              KMVSST                          WEVSST
     I              KMAATM                          WEAATM
     I              KMAYNA                          WEAYNA
     I              KMA0NA                          WEA0NA
     I              KMAXDT                          WEAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@AMREHJ
      * Order Header Extension    Sel Email Bol - Process
      * Renamed input format fields
     I              AMAIC3                          WHAIC3
     I              AMC4NB                          WHC4NB
     I              AMRMNB                          WHRMNB
     I              AMRUNB                          WHRUNB
     I              AMXACD                          WHXACD
     I              AMOANA                          WHOANA
     I              AMHBAA                          WHHBAA
     I              AMJ0T1                          WHJ0T1
     I              AMGENY                          WHGENY
     I              AMJ1T1                          WHJ1T1
     I              AMHCAA                          WHHCAA
     I              AMQWDT                          WHQWDT
     I              AMQXDT                          WHQXDT
     I              AMQYDT                          WHQYDT
     I              AMHDAA                          WHHDAA
     I              AMCCTX                          WHCCTX
     I              AMJ2T1                          WHJ2T1
     I              AMRLNA                          WHRLNA
     I              AMRMNA                          WHRMNA
     I              AMGINY                          WHGINY
     I              AMGFNY                          WHGFNY
     I              AMGGNY                          WHGGNY
     I              AMGHNY                          WHGHNY
     I              AMHEVL                          WHHEVL
     I              AMHFVL                          WHHFVL
     I              AMHGVL                          WHHGVL
     I              AMQZDT                          WHQZDT
     I              AMQ0DT                          WHQ0DT
     I              AMQ1DT                          WHQ1DT
     I              AMQ2DT                          WHQ2DT
     I              AMC2TX                          WHC2TX
     I              AMC3TX                          WHC3TX
     I              AMC6TX                          WHC6TX
     I              AMCHTX                          WHCHTX
     I              AMCITX                          WHCITX
     I              AMCLTX                          WHCLTX
     I              AMB4TX                          WHB4TX
     I              AMCUTX                          WHCUTX
     I              AMCVTX                          WHCVTX
     I              AMB9TX                          WHB9TX
     I              AMJWSC                          WHJWSC
     I              AMITNY                          WHITNY
     I              AMLMT1                          WHLMT1
     I              AMLWAA                          WHLWAA
     I              AMFVST                          WHFVST
     I              AMF0ST                          WHF0ST
     I              AMF2ST                          WHF2ST
     I              AMF3ST                          WHF3ST
     I              AMJUSC                          WHJUSC
     I              AMJVSC                          WHJVSC
     I              AMV3T1                          WHV3T1
     I              AMV4T1                          WHV4T1
     I              AMV5T1                          WHV5T1
     I              AMV6T1                          WHV6T1
     I              AMV7T1                          WHV7T1
     I              AMV8T1                          WHV8T1
     I              AMV9T1                          WHV9T1
     I              AMWAT1                          WHWAT1
     I              AMWBT1                          WHWBT1
     I              AMWCT1                          WHWCT1
     I              AMWDT1                          WHWDT1
     I              AMQJNY                          WHQJNY
     I              AMQKNY                          WHQKNY
     I              AMQLNY                          WHQLNY
     I              AMP8NY                          WHP8NY
     I              AMP9NY                          WHP9NY
     I              AMQANY                          WHQANY
     I              AMQCNY                          WHQCNY
     I              AMQDNY                          WHQDNY
     I              AMQENY                          WHQENY
     I              AMQFNY                          WHQFNY
     I              AMQGNY                          WHQGNY
     I              AMQHNY                          WHQHNY
     I              AMQINY                          WHQINY
     I              AMQMNY                          WHQMNY
     I              AMMYU1                          WHMYU1
     I              AMJXSC                          WHJXSC
     I              AMJYSC                          WHJYSC
     I              AMJZSC                          WHJZSC
     I              AMJ0SC                          WHJ0SC
     I              AMMZU1                          WHMZU1
     I              AMM0U1                          WHM0U1
     I              AMM1U1                          WHM1U1
     I              AMM2U1                          WHM2U1
     I              AMM3U1                          WHM3U1
     I              AMW5DT                          WHW5DT
     I              AMW6DT                          WHW6DT
     I              AMUVST                          WHUVST
     I              AMUWST                          WHUWST
     I              AMUXST                          WHUXST
     I              AMVSST                          WHVSST
     I              AMAATM                          WHAATM
     I              AMAYNA                          WHAYNA
     I              AMA0NA                          WHA0NA
     I              AMAXDT                          WHAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WIAIC3
     I              AMC4NB                          WIC4NB
     I              AMRMNB                          WIRMNB
     I              AMRUNB                          WIRUNB
     I              AMXACD                          WIXACD
     I              AMOANA                          WIOANA
     I              AMHBAA                          WIHBAA
     I              AMJ0T1                          WIJ0T1
     I              AMGENY                          WIGENY
     I              AMJ1T1                          WIJ1T1
     I              AMHCAA                          WIHCAA
     I              AMQWDT                          WIQWDT
     I              AMQXDT                          WIQXDT
     I              AMQYDT                          WIQYDT
     I              AMHDAA                          WIHDAA
     I              AMCCTX                          WICCTX
     I              AMJ2T1                          WIJ2T1
     I              AMRLNA                          WIRLNA
     I              AMRMNA                          WIRMNA
     I              AMGINY                          WIGINY
     I              AMGFNY                          WIGFNY
     I              AMGGNY                          WIGGNY
     I              AMGHNY                          WIGHNY
     I              AMHEVL                          WIHEVL
     I              AMHFVL                          WIHFVL
     I              AMHGVL                          WIHGVL
     I              AMQZDT                          WIQZDT
     I              AMQ0DT                          WIQ0DT
     I              AMQ1DT                          WIQ1DT
     I              AMQ2DT                          WIQ2DT
     I              AMC2TX                          WIC2TX
     I              AMC3TX                          WIC3TX
     I              AMC6TX                          WIC6TX
     I              AMCHTX                          WICHTX
     I              AMCITX                          WICITX
     I              AMCLTX                          WICLTX
     I              AMB4TX                          WIB4TX
     I              AMCUTX                          WICUTX
     I              AMCVTX                          WICVTX
     I              AMB9TX                          WIB9TX
     I              AMJWSC                          WIJWSC
     I              AMITNY                          WIITNY
     I              AMLMT1                          WILMT1
     I              AMLWAA                          WILWAA
     I              AMFVST                          WIFVST
     I              AMF0ST                          WIF0ST
     I              AMF2ST                          WIF2ST
     I              AMF3ST                          WIF3ST
     I              AMJUSC                          WIJUSC
     I              AMJVSC                          WIJVSC
     I              AMV3T1                          WIV3T1
     I              AMV4T1                          WIV4T1
     I              AMV5T1                          WIV5T1
     I              AMV6T1                          WIV6T1
     I              AMV7T1                          WIV7T1
     I              AMV8T1                          WIV8T1
     I              AMV9T1                          WIV9T1
     I              AMWAT1                          WIWAT1
     I              AMWBT1                          WIWBT1
     I              AMWCT1                          WIWCT1
     I              AMWDT1                          WIWDT1
     I              AMQJNY                          WIQJNY
     I              AMQKNY                          WIQKNY
     I              AMQLNY                          WIQLNY
     I              AMP8NY                          WIP8NY
     I              AMP9NY                          WIP9NY
     I              AMQANY                          WIQANY
     I              AMQCNY                          WIQCNY
     I              AMQDNY                          WIQDNY
     I              AMQENY                          WIQENY
     I              AMQFNY                          WIQFNY
     I              AMQGNY                          WIQGNY
     I              AMQHNY                          WIQHNY
     I              AMQINY                          WIQINY
     I              AMQMNY                          WIQMNY
     I              AMMYU1                          WIMYU1
     I              AMJXSC                          WIJXSC
     I              AMJYSC                          WIJYSC
     I              AMJZSC                          WIJZSC
     I              AMJ0SC                          WIJ0SC
     I              AMMZU1                          WIMZU1
     I              AMM0U1                          WIM0U1
     I              AMM1U1                          WIM1U1
     I              AMM2U1                          WIM2U1
     I              AMM3U1                          WIM3U1
     I              AMW5DT                          WIW5DT
     I              AMW6DT                          WIW6DT
     I              AMUVST                          WIUVST
     I              AMUWST                          WIUWST
     I              AMUXST                          WIUXST
     I              AMVSST                          WIVSST
     I              AMAATM                          WIAATM
     I              AMAYNA                          WIAYNA
     I              AMA0NA                          WIA0NA
     I              AMAXDT                          WIAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WIAIC3
     I              AMC4NB                          WIC4NB
     I              AMRMNB                          WIRMNB
     I              AMRUNB                          WIRUNB
     I              AMXACD                          WIXACD
     I              AMOANA                          WIOANA
     I              AMHBAA                          WIHBAA
     I              AMJ0T1                          WIJ0T1
     I              AMGENY                          WIGENY
     I              AMJ1T1                          WIJ1T1
     I              AMHCAA                          WIHCAA
     I              AMQWDT                          WIQWDT
     I              AMQXDT                          WIQXDT
     I              AMQYDT                          WIQYDT
     I              AMHDAA                          WIHDAA
     I              AMCCTX                          WICCTX
     I              AMJ2T1                          WIJ2T1
     I              AMRLNA                          WIRLNA
     I              AMRMNA                          WIRMNA
     I              AMGINY                          WIGINY
     I              AMGFNY                          WIGFNY
     I              AMGGNY                          WIGGNY
     I              AMGHNY                          WIGHNY
     I              AMHEVL                          WIHEVL
     I              AMHFVL                          WIHFVL
     I              AMHGVL                          WIHGVL
     I              AMQZDT                          WIQZDT
     I              AMQ0DT                          WIQ0DT
     I              AMQ1DT                          WIQ1DT
     I              AMQ2DT                          WIQ2DT
     I              AMC2TX                          WIC2TX
     I              AMC3TX                          WIC3TX
     I              AMC6TX                          WIC6TX
     I              AMCHTX                          WICHTX
     I              AMCITX                          WICITX
     I              AMCLTX                          WICLTX
     I              AMB4TX                          WIB4TX
     I              AMCUTX                          WICUTX
     I              AMCVTX                          WICVTX
     I              AMB9TX                          WIB9TX
     I              AMJWSC                          WIJWSC
     I              AMITNY                          WIITNY
     I              AMLMT1                          WILMT1
     I              AMLWAA                          WILWAA
     I              AMFVST                          WIFVST
     I              AMF0ST                          WIF0ST
     I              AMF2ST                          WIF2ST
     I              AMF3ST                          WIF3ST
     I              AMJUSC                          WIJUSC
     I              AMJVSC                          WIJVSC
     I              AMV3T1                          WIV3T1
     I              AMV4T1                          WIV4T1
     I              AMV5T1                          WIV5T1
     I              AMV6T1                          WIV6T1
     I              AMV7T1                          WIV7T1
     I              AMV8T1                          WIV8T1
     I              AMV9T1                          WIV9T1
     I              AMWAT1                          WIWAT1
     I              AMWBT1                          WIWBT1
     I              AMWCT1                          WIWCT1
     I              AMWDT1                          WIWDT1
     I              AMQJNY                          WIQJNY
     I              AMQKNY                          WIQKNY
     I              AMQLNY                          WIQLNY
     I              AMP8NY                          WIP8NY
     I              AMP9NY                          WIP9NY
     I              AMQANY                          WIQANY
     I              AMQCNY                          WIQCNY
     I              AMQDNY                          WIQDNY
     I              AMQENY                          WIQENY
     I              AMQFNY                          WIQFNY
     I              AMQGNY                          WIQGNY
     I              AMQHNY                          WIQHNY
     I              AMQINY                          WIQINY
     I              AMQMNY                          WIQMNY
     I              AMMYU1                          WIMYU1
     I              AMJXSC                          WIJXSC
     I              AMJYSC                          WIJYSC
     I              AMJZSC                          WIJZSC
     I              AMJ0SC                          WIJ0SC
     I              AMMZU1                          WIMZU1
     I              AMM0U1                          WIM0U1
     I              AMM1U1                          WIM1U1
     I              AMM2U1                          WIM2U1
     I              AMM3U1                          WIM3U1
     I              AMW5DT                          WIW5DT
     I              AMW6DT                          WIW6DT
     I              AMUVST                          WIUVST
     I              AMUWST                          WIUWST
     I              AMUXST                          WIUXST
     I              AMVSST                          WIVSST
     I              AMAATM                          WIAATM
     I              AMAYNA                          WIAYNA
     I              AMA0NA                          WIA0NA
     I              AMAXDT                          WIAXDT
      *
     IYARDCS      DS                            894
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EXC SH-BOL f/Custs    XF
      * RMC 4/17/20 R16455
      * Monitor to run for customers set up with SH-BOL, to email their B
      *   1. Orders must be Shipped or Invoiced
      *   2. OHE BOL Sts must be "Y"
      *   3. Truck Departure Date/Time must be at least 4 hours ago
      *   4. If all TRUE: Email the BOL, and update the OHE STS with "S"
      * RTV Eml Ords SH-BOL  RT - Cust Distribution Entry  * 
     C                     EXSR SARVGN
      * Mark all orders with Processing Sts to SENT
      * RTV Chg for Eml to snt RT - Order Header Extension  * 
     C                     EXSR SHRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Eml Ords SH-BOL  RT - Cust Distribution Entry  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAMNAA    WQSA01           Distribution Co
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Distribution Co
      * Setup key
     C                     MOVE *BLANK    WQSA01           Distribution Co
     C                     MOVEL'SH-BOL'  WQSA01           Distribution Co
      * Establish starting position
     C           KRSSA     SETLL@F7REHI                    *
     C           KRSSA     READE@F7REHI                  90*
      * Data record not found
     C   90                MOVEL'USR4289' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Distribution Code is Shipping Bill of Lading
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAMNAA    IFEQ @CN,001                    *IF
     C           WAVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Cust Ord-BOL Email RT - Order Header TRG  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@F7REHI                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Cust Ord-BOL Email RT - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  20       Hour 1 USR
     C                     Z-ADD*ZERO     WN0002  20       Hour 2 usr
     C                     Z-ADD*ZERO     WN0003  20       Hour 3 USR
     C                     Z-ADD*ZERO     WN0004 155       System Value Nu
     C                     MOVEL*BLANK    WN0005 10        Distribution Co
     C                     Z-ADD*ZERO     WN0006  70       Load Id 1
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WN0006           Load Id 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSB01           Ship To Custome
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSB01           Ship To Custome
      * Establish starting position
     C           KRSSB     SETLL@BFCPHH                    *
     C           KRSSB     READE@BFCPHH                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Header Status is Confirmed & Complete
      *   |- c2    : DB1.Load ID is Entered
      *   |- c3    : DB1.Order Type - Sales is Regular Order
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBGWST    IFEQ 'C'                        *IF
     C           WBGWST    OREQ 'R'
     C           WBRMNB    IFNE 0                          *IF
     C           WBJNCD    IFEQ 'OR'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Call Email job once for the load/cust
      * CASE: DB1.Load ID NE PAR.Load Id 1
     C           WBRMNB    IFNE WN0006                     *IF
      * RTV EMAIL BOL Sts     RT - Order Header Extension  * 
     C                     EXSR SCRVGN
      * Check delay time
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.OHE Email BOL/Sent is Need to Send
      *   |- c2    : LCL.OHE Email BOL/Sent is Processing
      *   '-
     C           YL0001    IFEQ 'Y'                        *IF
     C           YL0001    OREQ 'P'                        *OR
      * RTV Departure DT/TM   RT - Load Header  * 
     C                     EXSR SDRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Truck Departure Date is GT Zero
      *   |- c2    : LCL.Truck Departure Time is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFGT 0                          *IF
     C           YL0003    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD0         WN0003           Hour 3 USR
      * ** Retrieve the appropriate delay time from Company Values file
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SERVGN
      * PAR.Hour 2 usr = JOB.*Job time *HOURS
     C                     Z-ADD##JTM     XTTIM
     C                     Z-ADDXTHH      WN0002
      * PAR.Hour 1 USR = LCL.Truck Departure Time *HOURS
     C                     Z-ADDYL0003    XTTIM
     C                     Z-ADDXTHH      WN0001
      * CASE: LCL.Truck Departure Date EQ JOB.*Job date
     C           YL0002    IFEQ ##JDT                      *IF
     C           WN0002    SUB  WN0001    WN0003           Hour 3 USR
      * ** If time is => than 4 hours - Then Email bol
      * CASE: PAR.Hour 3 USR GE PAR.System Value Numeric
     C           WN0003    IFGE WN0004                     *IF
     C           ##JNO     MULT 10        YL0004           Number Value -
     C                     ADD  YL0005    YL0004           Number Value -
     C                     MOVEL*BLANK    YL0006           Text USR 7
     C                     MOVELYL0004    YL0006           Text USR 7
     C                     Z-ADD0         ZQ      50
     C           'BOL'     CAT  YL0006:ZQ YL0007    P      Job Name CDE
     C                     MOVELWBRMNB    YL0008           Load ID Alpha U
     C                     MOVEL*BLANK    YL0009           Ship To Custome
     C                     MOVELWBBKC7    YL0009           Ship To Custome
      * RTV Whse Acct Co      RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADD0         WL0003           Order Sequence
     C                     Z-ADD0         WL0004           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0010           Accounting Comp
      * EMAIL / FAX
      * CASE: PAR.CDE Destination Type is Email
     C           WAIRST    IFEQ 'E'                        *IF
      * submit job to email per jobname
     C                     MOVEL'BE'      YL0011           CDD Type
     C                     MOVEL*BLANK    YL0012           CDD Department
     C                     MOVEL'TRAFF'   YL0012           CDD Department
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0001  30       Company Number
     C                     PARM YL0011    WQ0002  2        CDD Type
     C                     PARM YL0012    WQ0003  6        CDD Department
     C           YL0013    PARM *BLANK    WQ0004  8        CDD Name of Ove
     C           YL0014    PARM *BLANK    WQ0005 10        CDD Program Nam
     C           YL0015    PARM *BLANK    WQ0006 10        CDD Printer Fil
     C           YL0016    PARM *BLANK    WQ0007 10        CDD Additional
     C           YL0017    PARM *BLANK    WQ0008 25        CDD Sender Phon
     C           YL0018    PARM *BLANK    WQ0009 25        CDD Sender Fax
     C           YL0019    PARM *BLANK    WQ0010 10        Output Queue
     C           YL0020    PARM *BLANK    WQ0011  4        Hold File
     C           YL0021    PARM *BLANK    WQ0012  4        Save File
     C           YL0022    PARM *ZERO     WQ0013  30       Source Drawer
     C           YL0023    PARM *BLANK    WQ0014 10        Printer Device
     C           YL0024    PARM *ZERO     WQ0015  30       Page Length 2
     C           YL0025    PARM *ZERO     WQ0016  30       Page Width 2
     C           YL0026    PARM *ZERO     WQ0017  30       Page LPI
     C           YL0027    PARM *ZERO     WQ0018  31       Page CPI
     C           YL0028    PARM *ZERO     WQ0019  30       Page Overflow
     C           YL0029    PARM *BLANK    WQ0020  5        Page Rotation
     C           YL0030    PARM *BLANK    WQ0021 50        CDD Comment 1
     C           YL0031    PARM *BLANK    WQ0022 50        CDD Comment 2
     C           YL0032    PARM *BLANK    WQ0023 50        CDD Comment 3
     C           YL0033    PARM *BLANK    WQ0024 50        CDD Comment 4
     C           YL0034    PARM *BLANK    WQ0025 50        CDD Comment 5
     C           YL0035    PARM *BLANK    WQ0026  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    YL0036           CDD Name of Ove
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0027  30       Company Number
     C                     PARM 'BK'      WQ0028  2        CDD Type
     C                     PARM 'TRAFF'   WQ0029  6        CDD Department
     C           YL0036    PARM *BLANK    WQ0030  8        CDD Name of Ove
     C                     PARM *BLANK    WQ0031 10        CDD Program Nam
     C                     PARM *BLANK    WQ0032 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0033 10        CDD Additional
     C                     PARM *BLANK    WQ0034 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0035 25        CDD Sender Fax
     C                     PARM *BLANK    WQ0036 10        Output Queue
     C                     PARM *BLANK    WQ0037  4        Hold File
     C                     PARM *BLANK    WQ0038  4        Save File
     C                     PARM *ZERO     WQ0039  30       Source Drawer
     C                     PARM *BLANK    WQ0040 10        Printer Device
     C                     PARM *ZERO     WQ0041  30       Page Length 2
     C                     PARM *ZERO     WQ0042  30       Page Width 2
     C                     PARM *ZERO     WQ0043  30       Page LPI
     C                     PARM *ZERO     WQ0044  31       Page CPI
     C                     PARM *ZERO     WQ0045  30       Page Overflow
     C                     PARM *BLANK    WQ0046  5        Page Rotation
     C                     PARM *BLANK    WQ0047 50        CDD Comment 1
     C                     PARM *BLANK    WQ0048 50        CDD Comment 2
     C                     PARM *BLANK    WQ0049 50        CDD Comment 3
     C                     PARM *BLANK    WQ0050 50        CDD Comment 4
     C                     PARM *BLANK    WQ0051 50        CDD Comment 5
     C                     PARM *BLANK    WQ0052  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD2         ZQ      50
     C           @CN,003   CAT  YL0008:ZQ YL0037    P      Subject Line US
      * CLP ESNDMAIL BOL-SBD  UP - /UT User Programs  * 
     C                     CALL 'PUQPUPC'              90  CLP ESNDMAIL BO
     C                     PARM *BLANK    WQ0053  7        Return Code Usr
     C                     PARM WAWMT1    WQ0054 50        Email Address
     C                     PARM YL0037    WQ0055100        Subject Line US
     C                     PARM @CN,004   WQ0056256        Pager Msg 256 U
     C                     PARM YL0007    WQ0057 10        Job Name CDE
     C                     PARM YL0013    WQ0058  8        Generic Heading
     C                     PARM YL0036    WQ0059  8        CDD Name of Ove
     C                     PARM YL0008    WQ0060  7        Load ID Alpha U
     C                     PARM YL0009    WQ0061  7        Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUQPUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.CDE Destination Type is Fax
     C           WAIRST    IFEQ 'F'                        *IF
      * get fax bol cover sheet pgm
     C                     MOVEL'TRAFFX'  YL0012           CDD Department
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0062  30       Company Number
     C                     PARM YL0011    WQ0063  2        CDD Type
     C                     PARM YL0012    WQ0064  6        CDD Department
     C           YL0038    PARM *BLANK    WQ0065  8        CDD Name of Ove
     C           YL0014    PARM *BLANK    WQ0066 10        CDD Program Nam
     C           YL0015    PARM *BLANK    WQ0067 10        CDD Printer Fil
     C           YL0016    PARM *BLANK    WQ0068 10        CDD Additional
     C           YL0017    PARM *BLANK    WQ0069 25        CDD Sender Phon
     C           YL0018    PARM *BLANK    WQ0070 25        CDD Sender Fax
     C           YL0019    PARM *BLANK    WQ0071 10        Output Queue
     C           YL0020    PARM *BLANK    WQ0072  4        Hold File
     C           YL0021    PARM *BLANK    WQ0073  4        Save File
     C           YL0022    PARM *ZERO     WQ0074  30       Source Drawer
     C           YL0023    PARM *BLANK    WQ0075 10        Printer Device
     C           YL0024    PARM *ZERO     WQ0076  30       Page Length 2
     C           YL0025    PARM *ZERO     WQ0077  30       Page Width 2
     C           YL0026    PARM *ZERO     WQ0078  30       Page LPI
     C           YL0027    PARM *ZERO     WQ0079  31       Page CPI
     C           YL0028    PARM *ZERO     WQ0080  30       Page Overflow
     C           YL0029    PARM *BLANK    WQ0081  5        Page Rotation
     C           YL0030    PARM *BLANK    WQ0082 50        CDD Comment 1
     C           YL0031    PARM *BLANK    WQ0083 50        CDD Comment 2
     C           YL0032    PARM *BLANK    WQ0084 50        CDD Comment 3
     C           YL0033    PARM *BLANK    WQ0085 50        CDD Comment 4
     C           YL0034    PARM *BLANK    WQ0086 50        CDD Comment 5
     C           YL0035    PARM *BLANK    WQ0087  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * get fax bol overlay name
     C                     MOVEL'BE'      YL0011           CDD Type
     C                     MOVEL'TRAFFX'  YL0012           CDD Department
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0088  30       Company Number
     C                     PARM YL0011    WQ0089  2        CDD Type
     C                     PARM YL0012    WQ0090  6        CDD Department
     C           YL0013    PARM *BLANK    WQ0091  8        CDD Name of Ove
     C           YL0014    PARM *BLANK    WQ0092 10        CDD Program Nam
     C           YL0015    PARM *BLANK    WQ0093 10        CDD Printer Fil
     C           YL0016    PARM *BLANK    WQ0094 10        CDD Additional
     C           YL0017    PARM *BLANK    WQ0095 25        CDD Sender Phon
     C           YL0018    PARM *BLANK    WQ0096 25        CDD Sender Fax
     C           YL0019    PARM *BLANK    WQ0097 10        Output Queue
     C           YL0020    PARM *BLANK    WQ0098  4        Hold File
     C           YL0021    PARM *BLANK    WQ0099  4        Save File
     C           YL0022    PARM *ZERO     WQ0100  30       Source Drawer
     C           YL0023    PARM *BLANK    WQ0101 10        Printer Device
     C           YL0024    PARM *ZERO     WQ0102  30       Page Length 2
     C           YL0025    PARM *ZERO     WQ0103  30       Page Width 2
     C           YL0026    PARM *ZERO     WQ0104  30       Page LPI
     C           YL0027    PARM *ZERO     WQ0105  31       Page CPI
     C           YL0028    PARM *ZERO     WQ0106  30       Page Overflow
     C           YL0029    PARM *BLANK    WQ0107  5        Page Rotation
     C           YL0030    PARM *BLANK    WQ0108 50        CDD Comment 1
     C           YL0031    PARM *BLANK    WQ0109 50        CDD Comment 2
     C           YL0032    PARM *BLANK    WQ0110 50        CDD Comment 3
     C           YL0033    PARM *BLANK    WQ0111 50        CDD Comment 4
     C           YL0034    PARM *BLANK    WQ0112 50        CDD Comment 5
     C           YL0035    PARM *BLANK    WQ0113  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    YL0036           CDD Name of Ove
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0114  30       Company Number
     C                     PARM 'BK'      WQ0115  2        CDD Type
     C                     PARM 'TRAFF'   WQ0116  6        CDD Department
     C           YL0036    PARM *BLANK    WQ0117  8        CDD Name of Ove
     C                     PARM *BLANK    WQ0118 10        CDD Program Nam
     C                     PARM *BLANK    WQ0119 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0120 10        CDD Additional
     C                     PARM *BLANK    WQ0121 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0122 25        CDD Sender Fax
     C                     PARM *BLANK    WQ0123 10        Output Queue
     C                     PARM *BLANK    WQ0124  4        Hold File
     C                     PARM *BLANK    WQ0125  4        Save File
     C                     PARM *ZERO     WQ0126  30       Source Drawer
     C                     PARM *BLANK    WQ0127 10        Printer Device
     C                     PARM *ZERO     WQ0128  30       Page Length 2
     C                     PARM *ZERO     WQ0129  30       Page Width 2
     C                     PARM *ZERO     WQ0130  30       Page LPI
     C                     PARM *ZERO     WQ0131  31       Page CPI
     C                     PARM *ZERO     WQ0132  30       Page Overflow
     C                     PARM *BLANK    WQ0133  5        Page Rotation
     C                     PARM *BLANK    WQ0134 50        CDD Comment 1
     C                     PARM *BLANK    WQ0135 50        CDD Comment 2
     C                     PARM *BLANK    WQ0136 50        CDD Comment 3
     C                     PARM *BLANK    WQ0137 50        CDD Comment 4
     C                     PARM *BLANK    WQ0138 50        CDD Comment 5
     C                     PARM *BLANK    WQ0139  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * submit job to fax bols per jobname
     C                     Z-ADDYL0010    YL0039           Company Number
     C                     Z-ADD2         ZQ      50
     C           @CN,003   CAT  YL0008:ZQ YL0037    P      Subject Line US
      * CLP ESNDMAIL BOL-SBD  UP - /UT User Programs  * 
     C                     CALL 'PUQPUPC'              90  CLP ESNDMAIL BO
     C                     PARM *BLANK    WQ0140  7        Return Code Usr
     C                     PARM WAWMT1    WQ0141 50        Email Address
     C                     PARM YL0037    WQ0142100        Subject Line US
     C                     PARM @CN,004   WQ0143256        Pager Msg 256 U
     C                     PARM YL0007    WQ0144 10        Job Name CDE
     C                     PARM YL0013    WQ0145  8        Generic Heading
     C                     PARM YL0036    WQ0146  8        CDD Name of Ove
     C                     PARM YL0008    WQ0147  7        Load ID Alpha U
     C                     PARM YL0009    WQ0148  7        Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUQPUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWBRMNB    WN0006           Load Id 1
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Truck Departure Date LT JOB.*Job date
     C           YL0002    IFLT ##JDT                      *IF
      * LCL.Days = JOB.*Job date - LCL.Truck Departure Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0002    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0040
     C                     ELSE
     C           XDURR     MULT -1        YL0040
     C                     END
      * CASE: LCL.Days is gt 1 day
     C           YL0040    IFGT 1                          *IF
     C                     Z-ADDWN0004    WN0003           Hour 3 USR
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If curr time is => 4am, Then Email bol
      * CASE: PAR.Hour 2 usr GE PAR.System Value Numeric
     C           WN0002    IFGE WN0004                     *IF
     C                     Z-ADDWN0004    WN0003           Hour 3 USR
     C                     END                             *FI
      * ** If curr time is <  4am, Then check against depart time
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.Hour 2 usr GE PAR.System Value Numeric
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0002    IFGE WN0004                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Hour 1 USR GT PAR.Hour 2 usr
     C           WN0001    IFGT WN0002                     *IF
     C           WN0001    SUB  WN0002    WN0003           Hour 3 USR
     C           24        SUB  WN0003    WN0003           Hour 3 USR
     C                     ELSE
      * CASE: *OTHERWISE
      * more than 24 hours has passed
     C                     Z-ADDWN0004    WN0003           Hour 3 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Hour 3 IFGE the delay then Email the BOL
      * CASE: PAR.Hour 3 USR GE PAR.System Value Numeric
     C           WN0003    IFGE WN0004                     *IF
     C           ##JNO     MULT 10        YL0004           Number Value -
     C                     ADD  YL0005    YL0004           Number Value -
     C                     MOVEL*BLANK    YL0006           Text USR 7
     C                     MOVELYL0004    YL0006           Text USR 7
     C                     Z-ADD0         ZQ      50
     C           'BOL'     CAT  YL0006:ZQ YL0007    P      Job Name CDE
     C                     MOVELWBRMNB    YL0008           Load ID Alpha U
     C                     MOVEL*BLANK    YL0009           Ship To Custome
     C                     MOVELWBBKC7    YL0009           Ship To Custome
      * RTV Whse Acct Co      RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBC4NB    WL0002           Order Number
     C                     Z-ADD0         WL0003           Order Sequence
     C                     Z-ADD0         WL0004           Order Secondary
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0010           Accounting Comp
      * EMAIL / FAX
      * CASE: PAR.CDE Destination Type is Email
     C           WAIRST    IFEQ 'E'                        *IF
      * submit job to email per jobname
     C                     MOVEL'BE'      YL0011           CDD Type
     C                     MOVEL*BLANK    YL0012           CDD Department
     C                     MOVEL'TRAFF'   YL0012           CDD Department
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0149  30       Company Number
     C                     PARM YL0011    WQ0150  2        CDD Type
     C                     PARM YL0012    WQ0151  6        CDD Department
     C           YL0013    PARM *BLANK    WQ0152  8        CDD Name of Ove
     C           YL0014    PARM *BLANK    WQ0153 10        CDD Program Nam
     C           YL0015    PARM *BLANK    WQ0154 10        CDD Printer Fil
     C           YL0016    PARM *BLANK    WQ0155 10        CDD Additional
     C           YL0017    PARM *BLANK    WQ0156 25        CDD Sender Phon
     C           YL0018    PARM *BLANK    WQ0157 25        CDD Sender Fax
     C           YL0019    PARM *BLANK    WQ0158 10        Output Queue
     C           YL0020    PARM *BLANK    WQ0159  4        Hold File
     C           YL0021    PARM *BLANK    WQ0160  4        Save File
     C           YL0022    PARM *ZERO     WQ0161  30       Source Drawer
     C           YL0023    PARM *BLANK    WQ0162 10        Printer Device
     C           YL0024    PARM *ZERO     WQ0163  30       Page Length 2
     C           YL0025    PARM *ZERO     WQ0164  30       Page Width 2
     C           YL0026    PARM *ZERO     WQ0165  30       Page LPI
     C           YL0027    PARM *ZERO     WQ0166  31       Page CPI
     C           YL0028    PARM *ZERO     WQ0167  30       Page Overflow
     C           YL0029    PARM *BLANK    WQ0168  5        Page Rotation
     C           YL0030    PARM *BLANK    WQ0169 50        CDD Comment 1
     C           YL0031    PARM *BLANK    WQ0170 50        CDD Comment 2
     C           YL0032    PARM *BLANK    WQ0171 50        CDD Comment 3
     C           YL0033    PARM *BLANK    WQ0172 50        CDD Comment 4
     C           YL0034    PARM *BLANK    WQ0173 50        CDD Comment 5
     C           YL0035    PARM *BLANK    WQ0174  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    YL0036           CDD Name of Ove
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0175  30       Company Number
     C                     PARM 'BK'      WQ0176  2        CDD Type
     C                     PARM 'TRAFF'   WQ0177  6        CDD Department
     C           YL0036    PARM *BLANK    WQ0178  8        CDD Name of Ove
     C                     PARM *BLANK    WQ0179 10        CDD Program Nam
     C                     PARM *BLANK    WQ0180 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0181 10        CDD Additional
     C                     PARM *BLANK    WQ0182 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0183 25        CDD Sender Fax
     C                     PARM *BLANK    WQ0184 10        Output Queue
     C                     PARM *BLANK    WQ0185  4        Hold File
     C                     PARM *BLANK    WQ0186  4        Save File
     C                     PARM *ZERO     WQ0187  30       Source Drawer
     C                     PARM *BLANK    WQ0188 10        Printer Device
     C                     PARM *ZERO     WQ0189  30       Page Length 2
     C                     PARM *ZERO     WQ0190  30       Page Width 2
     C                     PARM *ZERO     WQ0191  30       Page LPI
     C                     PARM *ZERO     WQ0192  31       Page CPI
     C                     PARM *ZERO     WQ0193  30       Page Overflow
     C                     PARM *BLANK    WQ0194  5        Page Rotation
     C                     PARM *BLANK    WQ0195 50        CDD Comment 1
     C                     PARM *BLANK    WQ0196 50        CDD Comment 2
     C                     PARM *BLANK    WQ0197 50        CDD Comment 3
     C                     PARM *BLANK    WQ0198 50        CDD Comment 4
     C                     PARM *BLANK    WQ0199 50        CDD Comment 5
     C                     PARM *BLANK    WQ0200  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD2         ZQ      50
     C           @CN,003   CAT  YL0008:ZQ YL0037    P      Subject Line US
      * CLP ESNDMAIL BOL-SBD  UP - /UT User Programs  * 
     C                     CALL 'PUQPUPC'              90  CLP ESNDMAIL BO
     C                     PARM *BLANK    WQ0201  7        Return Code Usr
     C                     PARM WAWMT1    WQ0202 50        Email Address
     C                     PARM YL0037    WQ0203100        Subject Line US
     C                     PARM @CN,004   WQ0204256        Pager Msg 256 U
     C                     PARM YL0007    WQ0205 10        Job Name CDE
     C                     PARM YL0013    WQ0206  8        Generic Heading
     C                     PARM YL0036    WQ0207  8        CDD Name of Ove
     C                     PARM YL0008    WQ0208  7        Load ID Alpha U
     C                     PARM YL0009    WQ0209  7        Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUQPUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.CDE Destination Type is Fax
     C           WAIRST    IFEQ 'F'                        *IF
      * get fax bol cover sheet pgm
     C                     MOVEL'TRAFFX'  YL0012           CDD Department
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0210  30       Company Number
     C                     PARM YL0011    WQ0211  2        CDD Type
     C                     PARM YL0012    WQ0212  6        CDD Department
     C           YL0038    PARM *BLANK    WQ0213  8        CDD Name of Ove
     C           YL0014    PARM *BLANK    WQ0214 10        CDD Program Nam
     C           YL0015    PARM *BLANK    WQ0215 10        CDD Printer Fil
     C           YL0016    PARM *BLANK    WQ0216 10        CDD Additional
     C           YL0017    PARM *BLANK    WQ0217 25        CDD Sender Phon
     C           YL0018    PARM *BLANK    WQ0218 25        CDD Sender Fax
     C           YL0019    PARM *BLANK    WQ0219 10        Output Queue
     C           YL0020    PARM *BLANK    WQ0220  4        Hold File
     C           YL0021    PARM *BLANK    WQ0221  4        Save File
     C           YL0022    PARM *ZERO     WQ0222  30       Source Drawer
     C           YL0023    PARM *BLANK    WQ0223 10        Printer Device
     C           YL0024    PARM *ZERO     WQ0224  30       Page Length 2
     C           YL0025    PARM *ZERO     WQ0225  30       Page Width 2
     C           YL0026    PARM *ZERO     WQ0226  30       Page LPI
     C           YL0027    PARM *ZERO     WQ0227  31       Page CPI
     C           YL0028    PARM *ZERO     WQ0228  30       Page Overflow
     C           YL0029    PARM *BLANK    WQ0229  5        Page Rotation
     C           YL0030    PARM *BLANK    WQ0230 50        CDD Comment 1
     C           YL0031    PARM *BLANK    WQ0231 50        CDD Comment 2
     C           YL0032    PARM *BLANK    WQ0232 50        CDD Comment 3
     C           YL0033    PARM *BLANK    WQ0233 50        CDD Comment 4
     C           YL0034    PARM *BLANK    WQ0234 50        CDD Comment 5
     C           YL0035    PARM *BLANK    WQ0235  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * get fax bol overlay name
     C                     MOVEL'BE'      YL0011           CDD Type
     C                     MOVEL'TRAFFX'  YL0012           CDD Department
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0236  30       Company Number
     C                     PARM YL0011    WQ0237  2        CDD Type
     C                     PARM YL0012    WQ0238  6        CDD Department
     C           YL0013    PARM *BLANK    WQ0239  8        CDD Name of Ove
     C           YL0014    PARM *BLANK    WQ0240 10        CDD Program Nam
     C           YL0015    PARM *BLANK    WQ0241 10        CDD Printer Fil
     C           YL0016    PARM *BLANK    WQ0242 10        CDD Additional
     C           YL0017    PARM *BLANK    WQ0243 25        CDD Sender Phon
     C           YL0018    PARM *BLANK    WQ0244 25        CDD Sender Fax
     C           YL0019    PARM *BLANK    WQ0245 10        Output Queue
     C           YL0020    PARM *BLANK    WQ0246  4        Hold File
     C           YL0021    PARM *BLANK    WQ0247  4        Save File
     C           YL0022    PARM *ZERO     WQ0248  30       Source Drawer
     C           YL0023    PARM *BLANK    WQ0249 10        Printer Device
     C           YL0024    PARM *ZERO     WQ0250  30       Page Length 2
     C           YL0025    PARM *ZERO     WQ0251  30       Page Width 2
     C           YL0026    PARM *ZERO     WQ0252  30       Page LPI
     C           YL0027    PARM *ZERO     WQ0253  31       Page CPI
     C           YL0028    PARM *ZERO     WQ0254  30       Page Overflow
     C           YL0029    PARM *BLANK    WQ0255  5        Page Rotation
     C           YL0030    PARM *BLANK    WQ0256 50        CDD Comment 1
     C           YL0031    PARM *BLANK    WQ0257 50        CDD Comment 2
     C           YL0032    PARM *BLANK    WQ0258 50        CDD Comment 3
     C           YL0033    PARM *BLANK    WQ0259 50        CDD Comment 4
     C           YL0034    PARM *BLANK    WQ0260 50        CDD Comment 5
     C           YL0035    PARM *BLANK    WQ0261  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    YL0036           CDD Name of Ove
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0010    WQ0262  30       Company Number
     C                     PARM 'BK'      WQ0263  2        CDD Type
     C                     PARM 'TRAFF'   WQ0264  6        CDD Department
     C           YL0036    PARM *BLANK    WQ0265  8        CDD Name of Ove
     C                     PARM *BLANK    WQ0266 10        CDD Program Nam
     C                     PARM *BLANK    WQ0267 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0268 10        CDD Additional
     C                     PARM *BLANK    WQ0269 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0270 25        CDD Sender Fax
     C                     PARM *BLANK    WQ0271 10        Output Queue
     C                     PARM *BLANK    WQ0272  4        Hold File
     C                     PARM *BLANK    WQ0273  4        Save File
     C                     PARM *ZERO     WQ0274  30       Source Drawer
     C                     PARM *BLANK    WQ0275 10        Printer Device
     C                     PARM *ZERO     WQ0276  30       Page Length 2
     C                     PARM *ZERO     WQ0277  30       Page Width 2
     C                     PARM *ZERO     WQ0278  30       Page LPI
     C                     PARM *ZERO     WQ0279  31       Page CPI
     C                     PARM *ZERO     WQ0280  30       Page Overflow
     C                     PARM *BLANK    WQ0281  5        Page Rotation
     C                     PARM *BLANK    WQ0282 50        CDD Comment 1
     C                     PARM *BLANK    WQ0283 50        CDD Comment 2
     C                     PARM *BLANK    WQ0284 50        CDD Comment 3
     C                     PARM *BLANK    WQ0285 50        CDD Comment 4
     C                     PARM *BLANK    WQ0286 50        CDD Comment 5
     C                     PARM *BLANK    WQ0287  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * submit job to fax bols per jobname
     C                     Z-ADDYL0010    YL0039           Company Number
     C                     Z-ADD2         ZQ      50
     C           @CN,003   CAT  YL0008:ZQ YL0037    P      Subject Line US
      * CLP ESNDMAIL BOL-SBD  UP - /UT User Programs  * 
     C                     CALL 'PUQPUPC'              90  CLP ESNDMAIL BO
     C                     PARM *BLANK    WQ0288  7        Return Code Usr
     C                     PARM WAWMT1    WQ0289 50        Email Address
     C                     PARM YL0037    WQ0290100        Subject Line US
     C                     PARM @CN,004   WQ0291256        Pager Msg 256 U
     C                     PARM YL0007    WQ0292 10        Job Name CDE
     C                     PARM YL0013    WQ0293  8        Generic Heading
     C                     PARM YL0036    WQ0294  8        CDD Name of Ove
     C                     PARM YL0008    WQ0295  7        Load ID Alpha U
     C                     PARM YL0009    WQ0296  7        Ship To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUQPUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWBRMNB    WN0006           Load Id 1
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BFCPHH                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV EMAIL BOL Sts     RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           OHE Email BOL/S
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCJXSC    YL0001           OHE Email BOL/S
     C                     GOTO SCEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Departure DT/TM   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSD02           Load ID
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD02           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSD02           Load ID
      * Establish starting position
     C           KRSSD     SETLL@FJCPSB                    *
     C           KRSSD     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Truck Departure
     C                     Z-ADD*ZERO     YL0003           Truck Departure
     C                     GOTO SDEXIT                     *QUIT
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDKIDT    YL0002           Truck Departure
     C                     Z-ADDWDASTM    YL0003           Truck Departure
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV8CD           Company Value C
      * Setup key
     C                     Z-ADDWBAIC3    WEAIC3           Company Number
     C                     MOVEL@CN,002   WEV8CD           Company Value C
      * Establish starting position
     C           KRSSE     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEM8NB    WN0004           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Whse Acct Co      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSF02           Order Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSF01           Company Number
     C                     Z-ADDWL0002    WQSF02           Order Number
     C                     Z-ADDWL0003    WFDPNB           Order Sequence
     C                     Z-ADDWL0004    WFUENB           Order Secondary
      * Establish starting position
     C           KPSSF     SETLL@BGWKAE                    *
     C           KRSSF     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Accounting Comp
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR SGRVGN
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     MOVELWFAJCD    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Accounting Comp
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGBTC3    WL0005           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Chg for Eml to snt RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHJXSC    WQSH01           OHE Email BOL/S
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           OHE Email BOL/S
      * Setup key
     C                     MOVEL'P'       WQSH01           OHE Email BOL/S
      * Establish starting position
     C           KRSSH     SETLL@AMREHJ                    *
     C           KRSSH     READE@AMREHJ                  90*
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.OHE Email BOL/Sent is Processing
     C           'P'       IFEQ 'P'                        *IF
      * CHG OHE Email BOL      CH - Order Header Extension  * 
     C                     EXSR SICHRC
     C                     END                             *FI
     C           KRSSH     READE@AMREHJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG OHE Email BOL      CH - Order Header Extension  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0007  70       Load ID
     C                     Z-ADD*ZERO     WN0008  50       Stop/Drop Seque
     C                     MOVEL*BLANK    WN0009  3        Shipping Line
     C                     MOVEL*BLANK    WN0010 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0011 25        OHE City
     C                     MOVEL*BLANK    WN0012 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0013 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0014 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0015 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0016  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0017  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0018  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0019  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0020  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0021 12        OHE Container N
     C                     MOVEL*BLANK    WN0022 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0023 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0024 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0025 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0026 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0027 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0028 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0029 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0030 112       Transload Termi
     C                     Z-ADD*ZERO     WN0031  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0032  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0033  70       OHE Port/Pier P
     C                     Z-ADD*ZERO     WN0034  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0035  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0036  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0037  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0038  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0039  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0040  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0041  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0042  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0043  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0044  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0045  5        OHE EDI Error R
     C                     Z-ADD*ZERO     WN0046  50       HPB COA Batch N
     C                     MOVEL*BLANK    WN0047 38        Delivery P.O. N
     C                     MOVEL*BLANK    WN0048  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0049  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0050  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0051  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0052  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0053  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0054  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0055 10        OHE Transload S
     C                     MOVEL*BLANK    WN0056 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0057 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0058 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0059 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0060 15        OHE Transload C
     C                     MOVEL*BLANK    WN0061 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0062 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0063 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0064 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0065 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0066  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0067  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0068  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0069  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0070  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0071  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0072  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0073  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0074  60       Original Appoin
     C                     Z-ADD*ZERO     WN0075  60       Original Appoin
     C                     Z-ADD*ZERO     WN0076  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0077  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0078  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0079  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0080 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0081  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0082  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0083  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0084  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0085  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0086 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0087 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0088 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0089  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0090  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0091  1        EDI Status 1
     C                     MOVEL*BLANK    WN0092  1        EDI Status 2
     C                     MOVEL*BLANK    WN0093  1        EDI Status 3
     C                     MOVEL*BLANK    WN0094  1        Record Status
     C                     Z-ADD*ZERO     WN0095  60       Job Time
     C                     MOVEL*BLANK    WN0096 10        User Id
     C                     MOVEL*BLANK    WN0097 10        Job Name
     C                     Z-ADD*ZERO     WN0098  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
      *
     C           KLCHSI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C           KLCHSI    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YARDCS
      * Move non-key fields to @AMREJE
     C                     MOVEL'S'       WIJXSC    P      OHE Email BOL/S
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C                     MOVEL##PGM     WIA0NA           Job Name
     C                     MOVEL##USR     WIAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WARNNY           CDE Sequence Nu
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WCQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WCQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WCGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WCHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WCHGVL           Transload Termi
     C                     Z-ADD*ZERO     WCQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WCQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WCQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WCQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WCQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WCQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WCP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WCQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WCQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WCQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WCQENY           Original Appoin
     C                     Z-ADD*ZERO     WCQFNY           Original Appoin
     C                     Z-ADD*ZERO     WCQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WCQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WCQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WCW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WDFLAM           Flat Amount
     C                     Z-ADD*ZERO     WDRRNB           Total Stops
     C                     Z-ADD*ZERO     WDSBNB           BOL Time
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDSDNB           Number Pallets
     C                     Z-ADD*ZERO     WDPAOU           Number Pallets
     C                     Z-ADD*ZERO     WDDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDHADT           Actual Arrival
     C                     Z-ADD*ZERO     WDAART           Actual Arrival
     C                     Z-ADD*ZERO     WDDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WDDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WDAQDT           Actual Departur
     C                     Z-ADD*ZERO     WDS6NB           Departure Time
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDPRTM           Product Tempera
     C                     Z-ADD*ZERO     WDNPSV           Number Spacers
     C                     Z-ADD*ZERO     WDTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WDGRWE           Gross Weight
     C                     Z-ADD*ZERO     WDF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WDJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WDTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WDJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WDSPTM           Spotted Time
     C                     Z-ADD*ZERO     WDJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WDLFTM           Load Finished T
     C                     Z-ADD*ZERO     WDJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WDBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WDJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WDBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WDKIDT           Truck Departure
     C                     Z-ADD*ZERO     WDASTM           Truck Departure
     C                     Z-ADD*ZERO     WDKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WDAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WDVOAG           Voyage
     C                     Z-ADD*ZERO     WDKBDT           Sail Date
     C                     Z-ADD*ZERO     WDEFDT           Arrival Date
     C                     Z-ADD*ZERO     WDKCDT           Date In
     C                     Z-ADD*ZERO     WDTMIN           Time In
     C                     Z-ADD*ZERO     WDKDDT           Date Out
     C                     Z-ADD*ZERO     WDVMNB           Time Out
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WDK0DT           Product Complet
     C                     Z-ADD*ZERO     WDAYTM           Product Complet
     C                     Z-ADD*ZERO     WDKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WDICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WDIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WDK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WDAZTM           Load Door 1
     C                     Z-ADD*ZERO     WDK2DT           Override Total
     C                     Z-ADD*ZERO     WDA0TM           Load Door 2
     C                     Z-ADD*ZERO     WDZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WDPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WDCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WDPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WDCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WDP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WDCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WDP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WDCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WDP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WDCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEM8NB           System Value Nu
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WFMAVA           Billing Detail
     C                     Z-ADD*ZERO     WFKDVA           Billing Detail
     C                     Z-ADD*ZERO     WFL8VA           Billing Detail
     C                     Z-ADD*ZERO     WFL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WFAYVA           Extended Amount
     C                     Z-ADD*ZERO     WFEXDT           Market Pricing
     C                     Z-ADD*ZERO     WFBZPR           Price Overage O
     C                     Z-ADD*ZERO     WFL6NB           Contract Number
     C                     Z-ADD*ZERO     WFGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WFD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WFCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WFAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WFCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WFATWG           Weight Shipped
     C                     Z-ADD*ZERO     WFAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WFAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WFAKPR           Unit Price
     C                     Z-ADD*ZERO     WFALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WFAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WFAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WFA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WFA5DT           Requested Ship
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFCXDT           Date of Origina
     C                     Z-ADD*ZERO     WFDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WFB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WFA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WFNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WFNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WFBXTM           Substitution Li
     C                     Z-ADD*ZERO     WFBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WFH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WFH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WFH7NX           OD Item Target
     C                     Z-ADD*ZERO     WFH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WFH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WFDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WFDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WFDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WFDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WFDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WFGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WFGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WFGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WFPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WFRINY           Item Age Days
     C                     Z-ADD*ZERO     WFTIDT           Production Ovr
     C                     Z-ADD*ZERO     WFTJDT           Production Ovr
     C                     Z-ADD*ZERO     WFTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WFTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WFTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WGBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WGBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WGBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WGBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  30
      * Define local work field OHE Email BOL/Sent
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Truck Departure Date
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Truck Departure Time
     C                     Z-ADD*ZERO     YL0003  60
      * Define local work field Number Value - 7
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0005  50
      * Define local work field Text USR 7
     C                     MOVEL*BLANK    YL0006  7
      * Define local work field Job Name CDE
     C                     MOVEL*BLANK    YL0007 10
      * Define local work field Load ID Alpha USR
     C                     MOVEL*BLANK    YL0008  7
      * Define local work field Ship To Customer TXT
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field CDD Type
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field CDD Department Code
     C                     MOVEL*BLANK    YL0012  6
      * Define local work field Generic Heading
     C                     MOVEL*BLANK    YL0013  8
      * Define local work field CDD Program Name
     C                     MOVEL*BLANK    YL0014 10
      * Define local work field CDD Printer File Name
     C                     MOVEL*BLANK    YL0015 10
      * Define local work field CDD Additional Object
     C                     MOVEL*BLANK    YL0016 10
      * Define local work field CDD Sender Phone
     C                     MOVEL*BLANK    YL0017 25
      * Define local work field CDD Sender Fax
     C                     MOVEL*BLANK    YL0018 25
      * Define local work field Output Queue
     C                     MOVEL*BLANK    YL0019 10
      * Define local work field Hold File
     C                     MOVEL*BLANK    YL0020  4
      * Define local work field Save File
     C                     MOVEL*BLANK    YL0021  4
      * Define local work field Source Drawer
     C                     Z-ADD*ZERO     YL0022  30
      * Define local work field Printer Device Type
     C                     MOVEL*BLANK    YL0023 10
      * Define local work field Page Length 2
     C                     Z-ADD*ZERO     YL0024  30
      * Define local work field Page Width 2
     C                     Z-ADD*ZERO     YL0025  30
      * Define local work field Page LPI
     C                     Z-ADD*ZERO     YL0026  30
      * Define local work field Page CPI
     C                     Z-ADD*ZERO     YL0027  31
      * Define local work field Page Overflow
     C                     Z-ADD*ZERO     YL0028  30
      * Define local work field Page Rotation
     C                     MOVEL*BLANK    YL0029  5
      * Define local work field CDD Comment 1
     C                     MOVEL*BLANK    YL0030 50
      * Define local work field CDD Comment 2
     C                     MOVEL*BLANK    YL0031 50
      * Define local work field CDD Comment 3
     C                     MOVEL*BLANK    YL0032 50
      * Define local work field CDD Comment 4
     C                     MOVEL*BLANK    YL0033 50
      * Define local work field CDD Comment 5
     C                     MOVEL*BLANK    YL0034 50
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field CDD Name of Overlay Back
     C                     MOVEL*BLANK    YL0036  8
      * Define null work field CDD Program Name
     C                     MOVEL*BLANK    YN0001 10
      * Define null work field CDD Printer File Name
     C                     MOVEL*BLANK    YN0002 10
      * Define null work field CDD Additional Object
     C                     MOVEL*BLANK    YN0003 10
      * Define null work field CDD Sender Phone
     C                     MOVEL*BLANK    YN0004 25
      * Define null work field CDD Sender Fax
     C                     MOVEL*BLANK    YN0005 25
      * Define null work field Output Queue
     C                     MOVEL*BLANK    YN0006 10
      * Define null work field Hold File
     C                     MOVEL*BLANK    YN0007  4
      * Define null work field Save File
     C                     MOVEL*BLANK    YN0008  4
      * Define null work field Source Drawer
     C                     Z-ADD*ZERO     YN0009  30
      * Define null work field Printer Device Type
     C                     MOVEL*BLANK    YN0010 10
      * Define null work field Page Length 2
     C                     Z-ADD*ZERO     YN0011  30
      * Define null work field Page Width 2
     C                     Z-ADD*ZERO     YN0012  30
      * Define null work field Page LPI
     C                     Z-ADD*ZERO     YN0013  30
      * Define null work field Page CPI
     C                     Z-ADD*ZERO     YN0014  31
      * Define null work field Page Overflow
     C                     Z-ADD*ZERO     YN0015  30
      * Define null work field Page Rotation
     C                     MOVEL*BLANK    YN0016  5
      * Define null work field CDD Comment 1
     C                     MOVEL*BLANK    YN0017 50
      * Define null work field CDD Comment 2
     C                     MOVEL*BLANK    YN0018 50
      * Define null work field CDD Comment 3
     C                     MOVEL*BLANK    YN0019 50
      * Define null work field CDD Comment 4
     C                     MOVEL*BLANK    YN0020 50
      * Define null work field CDD Comment 5
     C                     MOVEL*BLANK    YN0021 50
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0022  1
      * Define local work field Subject Line USR
     C                     MOVEL*BLANK    YL0037100
      * Define local work field CDD Name of Overlay
     C                     MOVEL*BLANK    YL0038  8
      * Define local work field Company Number Pass   USR
     C                     Z-ADD*ZERO     YL0039 155
      * Define local work field Days
     C                     Z-ADD*ZERO     YL0040  50
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 SH-BOL
00002 INVDELAY
00003 Bill of Lading for Load
00004 Bill of Lading
