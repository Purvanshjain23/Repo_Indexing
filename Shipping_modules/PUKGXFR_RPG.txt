     H/TITLE Rtv Dlt OD Files/CanclXF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 11/29/18  Time  : 10:35:22
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMSREL2IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FPOB5CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Inv    Retrieval index
      *
     FPDMSREL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     FPDKNCPL0UF  E           K        DISK
      * UPD : Order Detail Schedule     Update index
      *
     FPOB5CPL0UF  E           K        DISK
      * UPD : Order Detail Sched-Inv    Update index
      *
     I@MSREX2
      * Export Doc Order Dtl      Co/Order/Seq
      * Renamed input format fields
     I              MSAIC3                          WAAIC3
     I              MSC4NB                          WAC4NB
     I              MSDGSX                          WADGSX
     I              MSKXCD                          WAKXCD
     I              MSDPNB                          WADPNB
     I              MSUENB                          WAUENB
     I              MSDIC7                          WADIC7
     I              MSO3NA                          WAO3NA
     I              MSO4NA                          WAO4NA
     I              MSRMTX                          WARMTX
     I              MSPTTX                          WAPTTX
     I              MSHJWG                          WAHJWG
     I              MSHKWG                          WAHKWG
     I              MSRNTX                          WARNTX
     I              MSAONX                          WAAONX
     I              MSROTX                          WAROTX
     I              MSORNA                          WAORNA
     I              MSAMNX                          WAAMNX
     I              MSANNX                          WAANNX
     I              MSAPNX                          WAAPNX
     I              MSDKPR                          WADKPR
     I              MSA9VL                          WAA9VL
     I              MSC8SX                          WAC8SX
     I              MSRATX                          WARATX
     I              MSRBTX                          WARBTX
     I              MSAJNX                          WAAJNX
     I              MSZWTX                          WAZWTX
     I              MSZXTX                          WAZXTX
     I              MSZYTX                          WAZYTX
     I              MSZZTX                          WAZZTX
     I              MSK0U1                          WAK0U1
     I              MSK1U1                          WAK1U1
     I              MSIJSC                          WAIJSC
     I              MSIKSC                          WAIKSC
     I              MSK2U1                          WAK2U1
     I              MSW0DT                          WAW0DT
     I              MSUVST                          WAUVST
     I              MSUWST                          WAUWST
     I              MSUXST                          WAUXST
     I              MSVSST                          WAVSST
     I              MSAATM                          WAAATM
     I              MSAYNA                          WAAYNA
     I              MSA0NA                          WAA0NA
     I              MSAXDT                          WAAXDT
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WBAIC3
     I              MSC4NB                          WBC4NB
     I              MSDGSX                          WBDGSX
     I              MSKXCD                          WBKXCD
     I              MSDPNB                          WBDPNB
     I              MSUENB                          WBUENB
     I              MSDIC7                          WBDIC7
     I              MSO3NA                          WBO3NA
     I              MSO4NA                          WBO4NA
     I              MSRMTX                          WBRMTX
     I              MSPTTX                          WBPTTX
     I              MSHJWG                          WBHJWG
     I              MSHKWG                          WBHKWG
     I              MSRNTX                          WBRNTX
     I              MSAONX                          WBAONX
     I              MSROTX                          WBROTX
     I              MSORNA                          WBORNA
     I              MSAMNX                          WBAMNX
     I              MSANNX                          WBANNX
     I              MSAPNX                          WBAPNX
     I              MSDKPR                          WBDKPR
     I              MSA9VL                          WBA9VL
     I              MSC8SX                          WBC8SX
     I              MSRATX                          WBRATX
     I              MSRBTX                          WBRBTX
     I              MSAJNX                          WBAJNX
     I              MSZWTX                          WBZWTX
     I              MSZXTX                          WBZXTX
     I              MSZYTX                          WBZYTX
     I              MSZZTX                          WBZZTX
     I              MSK0U1                          WBK0U1
     I              MSK1U1                          WBK1U1
     I              MSIJSC                          WBIJSC
     I              MSIKSC                          WBIKSC
     I              MSK2U1                          WBK2U1
     I              MSW0DT                          WBW0DT
     I              MSUVST                          WBUVST
     I              MSUWST                          WBUWST
     I              MSUXST                          WBUXST
     I              MSVSST                          WBVSST
     I              MSAATM                          WBAATM
     I              MSAYNA                          WBAYNA
     I              MSA0NA                          WBA0NA
     I              MSAXDT                          WBAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WCAIC3
     I              KNC4NB                          WCC4NB
     I              KNDPNB                          WCDPNB
     I              KNUENB                          WCUENB
     I              KNJGDT                          WCJGDT
     I              KNAODT                          WCAODT
     I              KNAJCD                          WCAJCD
     I              KNAYAA                          WCAYAA
     I              KNHGCD                          WCHGCD
     I              KNIGQT                          WCIGQT
     I              KNFLWG                          WCFLWG
     I              KNIUQT                          WCIUQT
     I              KNF3WG                          WCF3WG
     I              KNIVQT                          WCIVQT
     I              KNF4WG                          WCF4WG
     I              KNP7ST                          WCP7ST
     I              KNP8ST                          WCP8ST
     I              KNQAST                          WCQAST
     I              KNUVST                          WCUVST
     I              KNUWST                          WCUWST
     I              KNUXST                          WCUXST
     I              KNVSST                          WCVSST
     I              KNAATM                          WCAATM
     I              KNAYNA                          WCAYNA
     I              KNA0NA                          WCA0NA
     I              KNAXDT                          WCAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WDAIC3
     I              KNC4NB                          WDC4NB
     I              KNDPNB                          WDDPNB
     I              KNUENB                          WDUENB
     I              KNJGDT                          WDJGDT
     I              KNAODT                          WDAODT
     I              KNAJCD                          WDAJCD
     I              KNAYAA                          WDAYAA
     I              KNHGCD                          WDHGCD
     I              KNIGQT                          WDIGQT
     I              KNFLWG                          WDFLWG
     I              KNIUQT                          WDIUQT
     I              KNF3WG                          WDF3WG
     I              KNIVQT                          WDIVQT
     I              KNF4WG                          WDF4WG
     I              KNP7ST                          WDP7ST
     I              KNP8ST                          WDP8ST
     I              KNQAST                          WDQAST
     I              KNUVST                          WDUVST
     I              KNUWST                          WDUWST
     I              KNUXST                          WDUXST
     I              KNVSST                          WDVSST
     I              KNAATM                          WDAATM
     I              KNAYNA                          WDAYNA
     I              KNA0NA                          WDA0NA
     I              KNAXDT                          WDAXDT
      *
     I@B5CPM2
      * Order Detail Sched-Inv    Retrieval index
      * Renamed input format fields
     I              B5AIC3                          WEAIC3
     I              B5C4NB                          WEC4NB
     I              B5DPNB                          WEDPNB
     I              B5UENB                          WEUENB
     I              B5JGDT                          WEJGDT
     I              B5AODT                          WEAODT
     I              B5AJCD                          WEAJCD
     I              B5HGCD                          WEHGCD
     I              B5IUQT                          WEIUQT
     I              B5F3WG                          WEF3WG
     I              B5UVST                          WEUVST
     I              B5UWST                          WEUWST
     I              B5UXST                          WEUXST
     I              B5VSST                          WEVSST
     I              B5AATM                          WEAATM
     I              B5AYNA                          WEAYNA
     I              B5A0NA                          WEA0NA
     I              B5AXDT                          WEAXDT
      *
     I@B5CPM1
      * Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WFAIC3
     I              B5C4NB                          WFC4NB
     I              B5DPNB                          WFDPNB
     I              B5UENB                          WFUENB
     I              B5JGDT                          WFJGDT
     I              B5AODT                          WFAODT
     I              B5AJCD                          WFAJCD
     I              B5HGCD                          WFHGCD
     I              B5IUQT                          WFIUQT
     I              B5F3WG                          WFF3WG
     I              B5UVST                          WFUVST
     I              B5UWST                          WFUWST
     I              B5UXST                          WFUXST
     I              B5VSST                          WFVSST
     I              B5AATM                          WFAATM
     I              B5AYNA                          WFAYNA
     I              B5A0NA                          WFA0NA
     I              B5AXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDMS1    E DSPDMSREL0
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          WBAIC3
     I              MSC4NB                          WBC4NB
     I              MSDGSX                          WBDGSX
     I              MSKXCD                          WBKXCD
     I              MSDPNB                          WBDPNB
     I              MSUENB                          WBUENB
     I              MSDIC7                          WBDIC7
     I              MSO3NA                          WBO3NA
     I              MSO4NA                          WBO4NA
     I              MSRMTX                          WBRMTX
     I              MSPTTX                          WBPTTX
     I              MSHJWG                          WBHJWG
     I              MSHKWG                          WBHKWG
     I              MSRNTX                          WBRNTX
     I              MSAONX                          WBAONX
     I              MSROTX                          WBROTX
     I              MSORNA                          WBORNA
     I              MSAMNX                          WBAMNX
     I              MSANNX                          WBANNX
     I              MSAPNX                          WBAPNX
     I              MSDKPR                          WBDKPR
     I              MSA9VL                          WBA9VL
     I              MSC8SX                          WBC8SX
     I              MSRATX                          WBRATX
     I              MSRBTX                          WBRBTX
     I              MSAJNX                          WBAJNX
     I              MSZWTX                          WBZWTX
     I              MSZXTX                          WBZXTX
     I              MSZYTX                          WBZYTX
     I              MSZZTX                          WBZZTX
     I              MSK0U1                          WBK0U1
     I              MSK1U1                          WBK1U1
     I              MSIJSC                          WBIJSC
     I              MSIKSC                          WBIKSC
     I              MSK2U1                          WBK2U1
     I              MSW0DT                          WBW0DT
     I              MSUVST                          WBUVST
     I              MSUWST                          WBUWST
     I              MSUXST                          WBUXST
     I              MSVSST                          WBVSST
     I              MSAATM                          WBAATM
     I              MSAYNA                          WBAYNA
     I              MSA0NA                          WBA0NA
     I              MSAXDT                          WBAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WDAIC3
     I              KNC4NB                          WDC4NB
     I              KNDPNB                          WDDPNB
     I              KNUENB                          WDUENB
     I              KNJGDT                          WDJGDT
     I              KNAODT                          WDAODT
     I              KNAJCD                          WDAJCD
     I              KNAYAA                          WDAYAA
     I              KNHGCD                          WDHGCD
     I              KNIGQT                          WDIGQT
     I              KNFLWG                          WDFLWG
     I              KNIUQT                          WDIUQT
     I              KNF3WG                          WDF3WG
     I              KNIVQT                          WDIVQT
     I              KNF4WG                          WDF4WG
     I              KNP7ST                          WDP7ST
     I              KNP8ST                          WDP8ST
     I              KNQAST                          WDQAST
     I              KNUVST                          WDUVST
     I              KNUWST                          WDUWST
     I              KNUXST                          WDUXST
     I              KNVSST                          WDVSST
     I              KNAATM                          WDAATM
     I              KNAYNA                          WDAYNA
     I              KNA0NA                          WDA0NA
     I              KNAXDT                          WDAXDT
      *
     IQPOB51    E DSPOB5CPL0
      * UPD : Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WFAIC3
     I              B5C4NB                          WFC4NB
     I              B5DPNB                          WFDPNB
     I              B5UENB                          WFUENB
     I              B5JGDT                          WFJGDT
     I              B5AODT                          WFAODT
     I              B5AJCD                          WFAJCD
     I              B5HGCD                          WFHGCD
     I              B5IUQT                          WFIUQT
     I              B5F3WG                          WFF3WG
     I              B5UVST                          WFUVST
     I              B5UWST                          WFUWST
     I              B5UXST                          WFUXST
     I              B5VSST                          WFVSST
     I              B5AATM                          WFAATM
     I              B5AYNA                          WFAYNA
     I              B5A0NA                          WFA0NA
     I              B5AXDT                          WFAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv Dlt OD Files/CanclXF
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
     C                     EXSR SARVGN
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
     C                     EXSR SCRVGN
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR SERVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv & Dlt for Cncl DtlRT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
     C           *LIKE     DEFN WADPNB    WQSA03           Order Sequence
     C           *LIKE     DEFN WAUENB    WQSA04           Order Secondary
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
     C                     KFLD           WQSA03           Order Sequence
     C                     KFLD           WQSA04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1C4NB    WQSA02           Order Number
     C                     Z-ADDP1DPNB    WQSA03           Order Sequence
     C                     Z-ADDP1UENB    WQSA04           Order Secondary
      * Establish starting position
     C           KRSSA     SETLL@MSREX2                    *
     C           KRSSA     READE@MSREX2                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@MSREX2                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @MSREW4
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
     C                     MOVELWADGSX    WBDGSX           ED Export Docum
     C                     MOVELWAKXCD    WBKXCD           Country Code
     C                     Z-ADDWADPNB    WBDPNB           Order Sequence
     C                     Z-ADDWAUENB    WBUENB           Order Secondary
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDGSX           ED Export Docum
     C                     KFLD           WBKXCD           Country Code
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C           KLDLSB    CHAIN@MSREW4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMSREL0'MDACP
     C                     MOVEL'@MSREW4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@MSREW4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Dlt Ord Dtl Sched     RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
     C           *LIKE     DEFN WCDPNB    WQSC03           Order Sequence
     C           *LIKE     DEFN WCUENB    WQSC04           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           Order Sequence
     C                     KFLD           WQSC04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     Z-ADDP1C4NB    WQSC02           Order Number
     C                     Z-ADDP1DPNB    WQSC03           Order Sequence
     C                     Z-ADDP1UENB    WQSC04           Order Secondary
      * Establish starting position
     C           KRSSC     SETLL@KNCPHO                    *
     C           KRSSC     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
     C                     EXSR SDDLRC
     C           KRSSC     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
     C                     Z-ADDWCDPNB    WDDPNB           Order Sequence
     C                     Z-ADDWCUENB    WDUENB           Order Secondary
     C                     Z-ADDWCJGDT    WDJGDT           OD Production D
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C                     KFLD           WDJGDT           OD Production D
     C           KLDLSD    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSE02           Order Number
     C           *LIKE     DEFN WEDPNB    WQSE03           Order Sequence
     C           *LIKE     DEFN WEUENB    WQSE04           Order Secondary
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           WQSE03           Order Sequence
     C                     KFLD           WQSE04           Order Secondary
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
     C                     Z-ADDP1C4NB    WQSE02           Order Number
     C                     Z-ADDP1DPNB    WQSE03           Order Sequence
     C                     Z-ADDP1UENB    WQSE04           Order Secondary
      * Establish starting position
     C           KRSSE     SETLL@B5CPM2                    *
     C           KRSSE     READE@B5CPM2                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Ord Dtl Sch-Inv   DL - Order Detail Sched-Inv  * 
     C                     EXSR SFDLRC
     C           KRSSE     READE@B5CPM2                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Del Ord Dtl Sch-Inv   DL - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B5CPM1
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEC4NB    WFC4NB           Order Number
     C                     Z-ADDWEDPNB    WFDPNB           Order Sequence
     C                     Z-ADDWEUENB    WFUENB           Order Secondary
     C                     Z-ADDWEJGDT    WFJGDT           OD Production D
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
     C           KLDLSF    CHAIN@B5CPM1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B5CPM1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WADIC7           ED Item Code
     C                     Z-ADD*ZERO     WAHJWG           ED Product Net
     C                     Z-ADD*ZERO     WAHKWG           ED Product Net
     C                     Z-ADD*ZERO     WAAONX           ED Product Nbr
     C                     Z-ADD*ZERO     WAAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     WAANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     WAAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     WADKPR           ED Product Unit
     C                     Z-ADD*ZERO     WAA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     WAAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WAW0DT           ED Unused Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCJGDT           OD Production D
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WCFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WCIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WCF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WCIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WCF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEJGDT           OD Production D
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WEF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
