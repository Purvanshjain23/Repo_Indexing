/********************************************************************/
/*                                                                  */
/* PMEEUPC   - SBM PRT SHPD WHS TR RPTCL                            */
/* SYNOPSIS  - PROMPT JOB CONTROL FOR PRINTER OVERRIDE INFORMATION  */
/*             TO PRINT REPORT OF SHIPPED WAREHOUSE TRANSFERS       */
/*                                                                  */
/* SYSTEM    - ORDER MANAGEMENT SYSTEM                              */
/* DATE      - 03/27/2007                                           */
/* PROGRAMMER- LARA BUSER                                           */
/*                                                                  */
/* PARAMETERS:                                                      */
/*   &RETURN     - RETURN CODE                                      */
/*   &APPLIC     - APPLICATION                                      */
/*   &COMPNYN    - COMPANY NUMBER - BLANK FOR ALL                   */
/*   &FRMDATN    - ORDERS FROM ACTUAL SHIP DATE                     */
/*   &THRDATN    - ORDERS THRU ACTUAL SHIP DATE                     */
/*   &LOADN      - ORDERS ON LOAD                                   */
/*   &DESC       - PRINT PROGRAM DESCRIPTION (FOR PROMPT SCREEN)    */
/*   &OUTQ       - OUTPUT QUEUE                                     */
/*   &HOLD       - HOLD PRINT                                       */
/*   &SAVE       - SAVE PRINT                                       */
/*   &NQSTAT     - NIGHT QUEUE STATUS                               */
/*   &NIGHTQ     - NIGHT OUTPUT QUEUE                               */
/*   &COPYN      - NUMBER OF COPIES                                 */
/*   &CUSTN      - SHIP TO CUSTOMER NUMBER                          */
/*   &JOBNME     - JOB NAME                                         */
/********************************************************************/
/*  MODIFICATIONS:                                                  */
/* ---------------------------------------------------------------- */
/*  07/22/2011 SLM PASS IN THE FROM AND TO WAREHOUSE                */
/*                                                                  */
/********************************************************************/
 PMEEUPC:    PGM        PARM(&RETURN &APPLIC &DESC &OUTQ &HOLD &SAVE +
                          &NQSTAT &NIGHTQ &COMPNYN &FRMDATN +
                          &THRDATN &COPYN &WHSFRM &ORDTYPE &WHSTO)

/* PARMS                                                            */
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7) /* RETURN +
                          CODE */
             DCL        VAR(&APPLIC) TYPE(*CHAR) LEN(6) /* +
                          APPLICATION */
             DCL        VAR(&DESC) TYPE(*CHAR) LEN(25) /* PRT PGM +
                          DESCRIPTION */
             DCL        VAR(&OUTQ) TYPE(*CHAR) LEN(10) /* Output +
                          Queue */
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4) /* Hold +
                          Status */
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4) /* Save +
                          Status */
             DCL        VAR(&NQSTAT) TYPE(*CHAR) LEN(1) /* If MUST +
                          run in night q. */
             DCL        VAR(&NIGHTQ) TYPE(*CHAR) LEN(10) /* Night +
                          Job Queue */
             DCL        VAR(&COMPNYN) TYPE(*DEC) /* Company Number +
                          (Passed) */
             DCL        VAR(&FRMDATN) TYPE(*DEC) /* FROM Ship Date +
                          (Passed)  */
             DCL        VAR(&THRDATN) TYPE(*DEC) /* Thru Ship Date +
                          (Passed) */
             DCL        VAR(&COPYN) TYPE(*DEC) /* No. of Copies  +
                          (Passed) */
             DCL        VAR(&WHSFRM) TYPE(*CHAR) LEN(3) /* NUMBER OF +
                          COPIES */

             DCL        VAR(&ORDTYPE) TYPE(*CHAR) LEN(2) /* NUMBER +
                          OF COPIES */

             DCL        VAR(&WHSTO) TYPE(*CHAR) LEN(3) /* NUMBER OF +
                          COPIES */

             DCL        VAR(&COPY) TYPE(*DEC) LEN(2 0) /* NUMBER OF +
                          COPIES */

/* ERROR MESSAGE FIELDS                                              */
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(512) /* +
                          MESSAGE                  */
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7) /* MESSAGE +
                          ID               */
             DCL        VAR(&MSGL) TYPE(*DEC) LEN(5 0)

/********************************************************************/
/*   INITIALIZE VARIABLES                                           */
/********************************************************************/
             CHGVAR     VAR(&RETURN) VALUE('       ')
             CHGVAR     VAR(&COPY) VALUE(&COPYN)

/********************************************************************/
/*   MONITOR FOR ALL MESSAGES AT PROGRAM LEVEL                      */
/********************************************************************/
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/********************************************************************/
/* PROMPT FOR PRINTER OVERRIDE INFORMATION                          */
/********************************************************************/
 PRINTER:    CALL       PGM(PDG0PVR) PARM(&RETURN &DESC &OUTQ &HOLD +
                          &SAVE &COPY &NQSTAT &NIGHTQ &APPLIC)
             IF         COND(&RETURN *NE ' ') THEN(GOTO +
                          CMDLBL(USERQUIT))

             CHGVAR     VAR(&COPYN) VALUE(&COPY)

/*********************************************************************/
/* SUBMIT THE CL THAT CALLS THE PRINT PROGRAM                        */
/*********************************************************************/
             SBMJOB     CMD(CALL PGM(PMEFUPC) PARM(&RETURN &APPLIC +
                          &DESC &OUTQ &HOLD &SAVE &NQSTAT &NIGHTQ +
                          &COMPNYN &FRMDATN &THRDATN &COPYN +
                          &ORDTYPE &WHSFRM &WHSTO)) JOB(SHPXFRORD)

             GOTO       CMDLBL(END)

/*-------------------------USER QUIT--------------------------------*/
/* USER QUIT REQUESTED                                              */
/*------------------------------------------------------------------*/
 USERQUIT:   CHGVAR     VAR(&RETURN) VALUE('Y2U9999')
             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/

 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             CHGJOB     LOG(4 20 *SECLVL) LOGCLPGM(*YES)

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
