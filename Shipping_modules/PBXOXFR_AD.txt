// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBXOXFR
// ?Date: 14.08.2025 Time: 03:49:41
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?RMC S12448 1/26/18 use system date/time instead of job
// Call program RTV System Date/Time   UP.
CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
PARAMETER(LCL.Current_System_Date);
PARAMETER(LCL.Current_System_Time);

// LCL.Job Date = LCL.Current System Date
LCL.Job_Date = LCL.Current_System_Date;

// LCL.Job Time = LCL.Current System Time
LCL.Job_Time = LCL.Current_System_Time;

EXECUTE FUNCTION(Rtv Crt TMS Load Trg  RT) TYPE(RTVOBJ) FILE(PBBCCPP)           AC2073000;
PARAMETER(LCL.Job_Date);
PARAMETER(LCL.Job_Time);
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.TMS_LH_Load_Str_Company);
PARAMETER(PAR.TMS_LH_Field_Chg_Text);
PARAMETER(PAR.TMS_Record_Status);
PARAMETER(PAR.TMS_Process_Status);
PARAMETER(PAR.TMS_Error_Reason);
PARAMETER(PAR.TMS_Change_Date);
PARAMETER(PAR.TMS_Change_time);
PARAMETER(PAR.Load_Change_Type);
PARAMETER(PAR.Load_Change_Type_2);
PARAMETER(PAR.Load_Change_Type_3);
PARAMETER(PAR.Load_Change_Type_4);
PARAMETER(PAR.Load_Change_Type_5);
{
 //?USER: Processing if Data record not found

 // LCL.Text usr 14 = CONCAT(PAR.Load Change Type,PAR.Load Change Type 2,CON.1)
 LCL.Text_usr_14 = PAR.Load_Change_Type + PAR.Load_Change_Type_2 (1);

 // LCL.Description 14A      USR = CONCAT(PAR.Load Change Type 3,PAR.Load Change Type 4,CON.1)
 LCL.Description_14A_USR = PAR.Load_Change_Type_3 + PAR.Load_Change_Type_4 (1);

 // LCL.TMS LH Field Chg Text = CONCAT(LCL.Text usr 14,LCL.Description 14A      USR,CON.1)
 LCL.TMS_LH_Field_Chg_Text = LCL.Text_usr_14 + LCL.Description_14A_USR (1);

 // Execute function *Move-Right.
 EXECUTE FUNCTION(*Move-Right) TYPE(EXCUSRSRC) ('PDUIUFR');
 PARAMETER(LCL.TMS_LH_Field_Chg_Text);
 PARAMETER(PAR.Load_Change_Type_5);
 {
  C                     MOVE #IPANA    #OO9NA
 }

 EXECUTE FUNCTION(Crt TMS Load Trigger  CR) TYPE(CRTOBJ) FILE(PBBCCPP)           AC2072997;
 PARAMETER(PAR.Job_Date);
 PARAMETER(PAR.Job_Time);
 PARAMETER(PAR.Load_ID);
 PARAMETER(PAR.TMS_LH_Load_Str_Company);
 PARAMETER(LCL.TMS_LH_Field_Chg_Text);
 PARAMETER(PAR.TMS_Record_Status);
 PARAMETER(PAR.TMS_Process_Status);
 PARAMETER(PAR.TMS_Error_Reason);
 PARAMETER(PAR.TMS_Change_Date);
 PARAMETER(PAR.TMS_Change_time);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set TMS Record Stampp IF) TYPE(EXCINTFUN)                      AC2123222;
  PARAMETER(DB1.TMS_Record_Status);
  PARAMETER(DB1.TMS_Change_Date);
  PARAMETER(DB1.TMS_Change_time);
  {
   //?Execute internal function

   // PAR.TMS Change time = JOB.*Job time
   PAR.TMS_Change_time = JOB.*Job_time;

   // PAR.TMS Change Date = JOB.*Job date
   PAR.TMS_Change_Date = JOB.*Job_date;

  }

  // Call program RTV System Date/Time   UP.
  CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
  PARAMETER(DB1.TMS_Change_Date);
  PARAMETER(DB1.TMS_Change_time);

 }

}


